<!-- Screen Location component://coarchy/screen/coarchy/cointernal/Products/EditProductEval.xml --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Evaluate Product" default-menu-index="20" menu-image="fa fa-file" menu-image-type="icon" default-menu-include="false"><parameter name="productEvaluationId" required="true"/><always-actions><if condition="!activeOrgId"><message><![CDATA[${ec.resource.expand('CoarchySelectAnOrg', null)}]]></message><script><![CDATA[sri.sendRedirectAndStopRender('/settings/Organizations')]]></script></if><entity-find-count entity-name="mantle.party.PartyRelationship" count-field="partyRelationshipCount"><date-filter/><econdition field-name="relationshipTypeEnumId" value="PrtMember"/><econdition field-name="toRoleTypeId" value="OrgInternal"/><econdition field-name="fromPartyId" from="ec.user.userAccount.partyId"/><econdition field-name="toPartyId" from="activeOrgId"/></entity-find-count><entity-find-count entity-name="mantle.party.PartyActivation" count-field="partyActivationCount"><date-filter/><econdition field-name="partyId" from="activeOrgId"/></entity-find-count><entity-find-one entity-name="coarchy.product.ProductEvaluation" value-field="productEvaluation"/><if condition="!productEvaluation"><if condition="isVendorView"><script><![CDATA[sri.sendRedirectAndStopRender('/vendor')]]></script><else><script><![CDATA[sri.sendRedirectAndStopRender('/settings/Organizations')]]></script></else></if></if><set field="statusId" from="productEvaluation?.statusId"/><if condition="isVendorView && ['PeRequirementsSelection','PeInviteVendors'].contains(statusId)"><return error="true" message="Not allowed"/></if><set field="showReponseListButton" from="['PeAwaitingVendorResponse','PeCompleted','PeCancelled'].contains(statusId)"/><set field="showVendorRespondButton" from="isVendorView && (statusId == 'PeAwaitingVendorResponse')"/><set field="showInternalRespondButton" from="!isVendorView && (statusId == 'PeAwaitingVendorResponse')"/><entity-find entity-name="coarchy.product.ProductEvaluationParty" list="vendorRepList"><date-filter/><econdition field-name="productEvaluationId"/><econdition field-name="roleTypeId" value="VendorRepresentative"/></entity-find><set field="canInviteVendors" from="['PeRequirementsSelection','PeInviteVendors','PeAwaitingVendorResponse'].contains(statusId)"/><set field="showInviteVendorsSection" from="['PeInviteVendors','PeAwaitingVendorResponse','PeCompleted','PeCancelled'].contains(statusId)"/><service-call name="coarchy.ProductEvaluationServices.get#ProductEvaluationCompleteWarnings" in-map="[productEvaluationId:productEvaluationId]" out-map="context"/></always-actions><transition name="inviteVendor"><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><service-call name="coarchy.ProductEvaluationServices.add#ProductEvaluationParty" in-map="[productEvaluationId:productEvaluationId,emailAddress:emailAddress,firstName:firstName,lastName:lastName,organizationId:activeOrgId]" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="finalizeActivitySelection"><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><service-call name="coarchy.ProductEvaluationServices.finalize#ProductEvaluationActivitySelection" in-map="[productEvaluationId:productEvaluationId]" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="finalizeVendorInvitations"><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><service-call name="coarchy.ProductEvaluationServices.finalize#ProductEvaluationVendorInvitations" in-map="[productEvaluationId:productEvaluationId]" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="reopenActivitySelection"><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><service-call name="coarchy.ProductEvaluationServices.reopen#ProductEvaluationActivitySelection" in-map="[productEvaluationId:productEvaluationId]" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="cancelProductEvaluation"><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><service-call name="coarchy.ProductEvaluationServices.cancel#ProductEvaluation" in-map="[productEvaluationId:productEvaluationId]" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="completeProductEvaluation"><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><service-call name="coarchy.ProductEvaluationServices.complete#ProductEvaluation" in-map="[productEvaluationId:productEvaluationId]" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="reopenProductEvaluation"><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><service-call name="coarchy.ProductEvaluationServices.uncomplete#ProductEvaluation" in-map="[productEvaluationId:productEvaluationId]" out-map="context" multi="parameter"/><default-response url="."/></transition><subscreens default-item="EvalStatements"><subscreens-item name="EvalStatements" menu-include="true" menu-index="10" location="component://coarchy/screen/coarchy/cointernal/Products/EditProductEval/EvalStatements.xml"/><subscreens-item name="EvalProcessStories" menu-include="true" menu-index="20" location="component://coarchy/screen/coarchy/cointernal/Products/EditProductEval/EvalProcessStories.xml"/></subscreens><widgets><subscreens-panel id="ProductEvalPanel" type="tab"/></widgets></screen>