
<!-- Screen Location component://webroot/screen/webroot/vapps.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="false" screen-theme-type-enum-id="STT_INTERNAL" default-menu-title="Applications" allow-extra-path="true"><pre-actions><script><![CDATA[// if user not logged in save current path and params then redirect to Login
        if (!ec.user.userId) { ec.web.saveScreenLastInfo(null, null); sri.sendRedirectAndStopRender('/Login') }

        // jQuery, Bootstrap, Twitter TypeAhead, Form Validation (jquery-validate), Date/Time (Moment, bootstrap-datetimepicker),
        //      Drop-down (Select2, Selectivity), Notify/Growl (Bootstrap Notify), Inline Editable, Sortable Hierarchical List
        // Moqui Library (3rd party lib workarounds, NotificationClient, etc)
        html_scripts.add('/js/CombinedBase.min.js')

        // jquery-validate locale specific scripts
        Map validateScriptsOut = ec.service.sync().name("webroot.LocaleServices.get#ValidateLocaleScripts").call()
        if (validateScriptsOut.messagesLocation) html_scripts.add(validateScriptsOut.messagesLocation)
        if (validateScriptsOut.methodsLocation) html_scripts.add(validateScriptsOut.methodsLocation)

        String instancePurpose = System.getProperty("instance_purpose")
        if (!instancePurpose || instancePurpose == 'production') {
            /* ========== Production Mode ========== */
            footer_scripts.add('/js/CombinedVuet.min.js')
        } else {
            /* ========== Dev Mode ========== */
            // Vue JS
            footer_scripts.add('/libs/vue/vue.js')
            // http-vue-loader
            footer_scripts.add('/js/http-vue-loader/httpVueLoader.js')
            // Webroot Vue instance, in footer so runs after page loaded
            footer_scripts.add('/js/WebrootVue.js')
        }

        // conditional QZ Tray scripts, only include if enabled
        if (ec.user.getPreference("qz.print.enabled") == "true") {
            footer_scripts.add('/js/qz-tray/sha-256.min.js')
            footer_scripts.add('/js/qz-tray/qz-tray.min.js')
            footer_scripts.add('/js/qz-tray/MoquiQzComponent.js')
        }]]></script></pre-actions><widgets><render-mode><text type="html" location="component://webroot/screen/includes/WebrootVue.vuet.ftl"/></render-mode></widgets></screen>
<!-- Screen Location component://webroot/screen/webroot/qapps.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="false" screen-theme-type-enum-id="STT_INTERNAL_QUASAR" default-menu-title="Applications" allow-extra-path="true"><pre-actions><script><![CDATA[// if user not logged in save current path and params then redirect to Login
        if (!ec.user.userId) { ec.web.saveScreenLastInfo(null, null); sri.sendRedirectAndStopRender('/Login') }

        html_scripts.add('/libs/moment.js/moment-with-locales.min.js')
        html_scripts.add('/libs/jquery/jquery.min.js')

        String instancePurpose = System.getProperty("instance_purpose")
        if (!instancePurpose || instancePurpose == 'production') {
            /* ========== Production Mode ========== */
            html_scripts.add('/js/MoquiLib.min.js')
            // Vue JS
            footer_scripts.add('/libs/vue/vue.min.js')
            // http-vue-loader
            footer_scripts.add('/js/http-vue-loader/httpVueLoader.js')
            // Quasar
            footer_scripts.add("/libs/quasar/quasar.umd.min.js")
            // Webroot Quasar-Vue instance, in footer so runs after page loaded
            footer_scripts.add('/js/WebrootVue.qvt.min.js')
        } else {
            /* ========== Dev Mode ========== */
            html_scripts.add('/js/MoquiLib.js')
            // Vue JS
            footer_scripts.add('/libs/vue/vue.js')
            // http-vue-loader
            footer_scripts.add('/js/http-vue-loader/httpVueLoader.js')
            // Quasar
            footer_scripts.add("/libs/quasar/quasar.umd.min.js")
            // Webroot Quasar-Vue instance, in footer so runs after page loaded
            footer_scripts.add('/js/WebrootVue.qvt.js')
        }

        // conditional QZ Tray scripts, only include if enabled
        if (ec.user.getPreference("qz.print.enabled") == "true") {
            footer_scripts.add('/js/qz-tray/sha-256.min.js')
            footer_scripts.add('/js/qz-tray/qz-tray.min.js')
            // TODO migrate MoquiQzComponent.js to MoquiQzComponent.qvt.js
            footer_scripts.add('/js/qz-tray/MoquiQzComponent.js')
        }]]></script></pre-actions><widgets><render-mode><text type="html" location="component://webroot/screen/includes/WebrootVue.qvt.ftl"/></render-mode></widgets></screen>
<!-- Screen Location component://webroot/screen/webroot/apps/AppList.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="true" default-menu-include="false" default-menu-title="App List"><actions><set field="appsLocation" from="sri.getRootScreenDef().getSubscreensItem('apps').location"/><set field="currentScreenDef" from="sri.sfi.getScreenDefinition(appsLocation)"/></actions><widgets><container style="text-center"><label text="Choose an Application" type="h2"/><section-iterate name="ScreenNestedSection" list="currentScreenDef.getMenuSubscreensItems()" entry="currentSubscreensItem"><actions><set field="currentScreenDef" from="sri.sfi.getScreenDefinition(currentSubscreensItem.location)"/><set field="currentScreenPath" value="/apps/${currentSubscreensItem.name}"/><set field="currentUrlInstance" from="sri.buildUrl(currentScreenPath)"/></actions><widgets><section name="ScreenItemRender"><condition><expression><![CDATA[currentScreenDef != null &&
                            !currentScreenDef.getParameterMap() && currentUrlInstance?.isPermitted()]]></expression></condition><widgets><render-mode><text type="html"><![CDATA[<a href="${currentUrlInstance.url}" class="btn btn-primary app-list-link"><#if currentUrlInstance.sui.menuImage?has_content><#if currentUrlInstance.sui.menuImageType == "icon"><i class="${currentUrlInstance.sui.menuImage}" style="padding-right: 8px;"></i><#elseif currentUrlInstance.sui.menuImageType == "url-plain"><img src="${currentUrlInstance.sui.menuImage}" width="18" style="padding-right: 4px;"/><#else><img src="${sri.buildUrl(currentUrlInstance.sui.menuImage).url}" height="18" style="padding-right: 4px;"/></#if><#else><i class="fa fa-link" style="padding-right: 8px;"></i></#if>
                                    ${ec.resource.expand(currentSubscreensItem.menuTitle, "")}
                                </a>]]></text><text type="vuet"><![CDATA[<m-link href="${currentUrlInstance.path}" class="btn btn-primary app-list-link"><#if currentUrlInstance.sui.menuImage?has_content><#if currentUrlInstance.sui.menuImageType == "icon"><i class="${currentUrlInstance.sui.menuImage}" style="padding-right: 8px;"></i><#elseif currentUrlInstance.sui.menuImageType == "url-plain"><img src="${currentUrlInstance.sui.menuImage}" width="18" style="padding-right: 4px;"/><#else><img src="${sri.buildUrl(currentUrlInstance.sui.menuImage).url}" height="18" style="padding-right: 4px;"/></#if><#else><i class="fa fa-link" style="padding-right: 8px;"></i></#if>
                                    ${ec.resource.expand(currentSubscreensItem.menuTitle, "")}
                                </m-link>]]></text><text type="qvt"><![CDATA[<div class="q-my-sm"><q-btn outline no-caps to="${currentUrlInstance.path}" style="min-width:250px"><#if currentUrlInstance.sui.menuImage?has_content><#if currentUrlInstance.sui.menuImageType == "icon"><i class="${currentUrlInstance.sui.menuImage}" style="padding-right: 8px;"></i><#elseif currentUrlInstance.sui.menuImageType == "url-plain"><img src="${currentUrlInstance.sui.menuImage}" width="18" style="padding-right: 4px;"/><#else><img src="${sri.buildUrl(currentUrlInstance.sui.menuImage).url}" height="18" style="padding-right: 4px;"/></#if><#else><i class="fa fa-link" style="padding-right: 8px;"></i></#if>
                                    ${ec.resource.expand(currentSubscreensItem.menuTitle, "")}
                                </q-btn></div>]]></text></render-mode></widgets></section></widgets></section-iterate><render-mode><text type="html"><![CDATA[<p>&nbsp;</p><div>You are using the <strong>standard</strong> UI</div><div><a href="/vapps">Switch to the dynamic Bootstrap UI</a></div><div><a href="/qapps">Switch to the dynamic Material UI</a></div>]]></text><text type="vuet"><![CDATA[<p>&nbsp;</p><div>You are using the <strong>dynamic Bootstrap</strong> UI</div><div><a href="/apps">Switch to the standard UI</a></div><div><a href="/qapps">Switch to the dynamic Material UI</a></div>]]></text><text type="qvt"><![CDATA[<p>&nbsp;</p><div>You are using the <strong>dynamic Material</strong> UI</div><div><a href="/apps">Switch to the standard UI</a></div><div><a href="/vapps">Switch to the dynamic Bootstrap UI</a></div>]]></text></render-mode></container></widgets></screen>
<!-- Screen Location component://webroot/screen/webroot/apps/ScreenTree/ScreenTreeNested.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="false" default-menu-include="false"><actions><set field="parentScreenDef" from="currentScreenDef"/><set field="parentScreenPath" from="currentScreenPath"/></actions><widgets><container style="ScreenTreeNested"><section-iterate name="ScreenNestedSection" list="showAll == 'true' ? parentScreenDef.getSubscreensItemsSorted() : parentScreenDef.getMenuSubscreensItems()" entry="currentSubscreensItem"><actions><set field="currentScreenDef" from="sri.sfi.getScreenDefinition(currentSubscreensItem.location)"/><set field="currentScreenPath" value="${parentScreenPath}/${currentSubscreensItem.name}"/><set field="currentUrlInfo" from="sri.buildUrl(currentScreenPath)"/></actions><widgets><section name="ScreenItemRender"><condition><expression><![CDATA[currentScreenDef != null && currentUrlInfo?.isPermitted() && (showAll == 'true' || !currentScreenDef?.hasRequiredParameters())]]></expression></condition><widgets><section name="LinkOrLabel" condition="!currentScreenDef?.hasRequiredParameters()"><widgets><link url="${currentUrlInfo.path}" link-type="anchor" text="${currentSubscreensItem.menuTitle}"/></widgets><fail-widgets><label text="${currentSubscreensItem.menuTitle}" style="text-muted"/></fail-widgets></section><include-screen location="component://webroot/screen/webroot/apps/ScreenTree/ScreenTreeNested.xml" share-scope="false"/></widgets><fail-widgets><render-mode><text type="html"><![CDATA[<!-- excluding screen at path ${currentScreenPath} -->]]></text></render-mode></fail-widgets></section></widgets></section-iterate></container></widgets></screen>
<!-- Screen Location component://webroot/screen/webroot/apps/ScreenTree.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="true" default-menu-include="false" default-menu-title="Site Map"><parameter name="showAll"/><actions><set field="currentScreenDef" from="sri.getRootScreenDef()"/><set field="currentScreenPath" value=""/></actions><widgets><label text="Site Map" type="h2"/><include-screen location="component://webroot/screen/webroot/apps/ScreenTree/ScreenTreeNested.xml" share-scope="false"/><link url="." text="Show All" parameter-map="[showAll:'true']" link-type="anchor" style="text-muted" condition="showAll != 'true'"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Party/EditParty/UpdateContactInfo.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="partyId" required="true"/><parameter name="postalContactMechId"/><parameter name="postalContactMechPurposeId"/><parameter name="telecomContactMechId"/><parameter name="telecomContactMechPurposeId"/><parameter name="emailContactMechId"/><parameter name="emailContactMechPurposeId"/><parameter name="webContactMechId"/><parameter name="webContactMechPurposeId"/><parameter name="createPostal"/><parameter name="createTelecom"/><parameter name="createEmail"/><parameter name="createWeb"/><parameter name="orderId"/><parameter name="orderPartSeqId"/><parameter name="shipmentId"/><parameter name="shipmentRouteSegmentSeqId"/><parameter name="shipmentSetDest"/><parameter name="shipmentSetOrigin"/><parameter name="facilityId"/><transition name="storeContactInfo"><service-call name="mantle.party.ContactServices.store#PartyContactInfo" in-map="true" out-map="context" multi="parameter"/><default-response url=".."/></transition><transition-include name="getGeoCountryStates" location="component://SimpleScreens/template/party/PartyForms.xml"/><actions><if condition="postalContactMechId || telecomContactMechId || emailContactMechId || webContactMechId"><then><service-call name="mantle.party.ContactServices.get#PartyContactInfo" out-map="contactInfo" in-map="context"/><set field="contactInfoFlat" from="contactInfo + flattenNestedMap(contactInfo)"/></then><else-if condition="postalContactMechPurposeId || telecomContactMechPurposeId || emailContactMechPurposeId || webContactMechPurposeId"><set field="contactInfoFlat" from="[postalContactMechPurposeId:postalContactMechPurposeId,                     telecomContactMechPurposeId:telecomContactMechPurposeId, emailContactMechPurposeId:emailContactMechPurposeId,                     webContactMechPurposeId:webContactMechPurposeId]"/></else-if><else><set field="contactInfoFlat" from="[:]"/></else></if><if condition="createPostal || postalContactMechPurposeId"><entity-find entity-name="mantle.party.contact.PartyContactMechTelecomNumber" list="partyTelecomNumberList"><date-filter/><econdition field-name="partyId"/></entity-find><entity-find entity-name="mantle.party.contact.PartyContactMechInfo" list="partyEmailAddressList"><date-filter/><econdition field-name="partyId"/><econdition field-name="contactMechTypeEnumId" value="CmtEmailAddress"/></entity-find></if></actions><widgets><form-single name="UpdateContactInfo" transition="storeContactInfo" map="contactInfoFlat" extends="component://SimpleScreens/template/party/PartyForms.xml#ContactInfo"><field name="facilityId"><default-field><hidden/></default-field></field><field name="orderId"><default-field><hidden/></default-field></field><field name="orderPartSeqId"><default-field><hidden/></default-field></field><field name="shipmentId"><default-field><hidden/></default-field></field><field name="shipmentRouteSegmentSeqId"><default-field><hidden/></default-field></field><field name="shipmentSetDest"><default-field><hidden/></default-field></field><field name="shipmentSetOrigin"><default-field><hidden/></default-field></field></form-single></widgets></screen>
<!-- Screen Location component://Sales/screen/Sales/Account/ViewAccount.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="View Account" default-menu-index="10" menu-image="/ssstatic/images/Customer.png"><parameter name="partyId" required="true"/><transition name="removeContactInfo"><service-call name="mantle.party.ContactServices.delete#PartyContactMech" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="viewContact"><default-response url="../../Contact/ViewContact"/></transition><transition name="viewOpportunity"><default-response url="../../Opportunity/ViewOpportunity"/></transition><transition name="viewOrder"><default-response url="../../Order/ViewOrder"/></transition><subscreens default-item="Note"><subscreens-item menu-include="false" name="UpdateContactInfo" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty/UpdateContactInfo.xml"/></subscreens><actions><entity-find-one entity-name="mantle.party.PartyDetail" value-field="party"/><if condition="party == null"><return error="true" message="Party not found with ID ${partyId}"/></if></actions><widgets><container-row><row-col lg="3"><section name="PartySummarySection"><actions><service-call name="mantle.party.ContactServices.get#PartyContactInfoList" out-map="contactOut" in-map="[partyId:partyId, getAll:true]"/></actions><widgets><container-box type="default"><box-header title="${party.organizationName?:''}${party.firstName?:''}${party.lastName ? ' ' + party.lastName : ''}"/><box-body><section-iterate name="WebInfoSection" list="contactOut.webAddressList" entry="contactInfo"><widgets><container-row><row-col lg="8"><render-mode><text type="html,vuet,qvt" location="component://SimpleScreens/template/party/ContactInfo.html.gstring"/></render-mode></row-col><row-col lg="4"><dynamic-dialog id="UpdateWebInfo" button-text="" transition="UpdateContactInfo" parameter-map="[partyId:partyId, webContactMechId:contactInfo.webContactMechId,                                         webContactMechPurposeId:contactInfo.webContactMechPurposeId]"/><link url="removeContactInfo" text=" " icon="fa fa-trash" confirmation="Remove Web URL?" parameter-map="[partyId:partyId, contactMechId:contactInfo.webContactMechId,                                         contactMechPurposeId:contactInfo.webContactMechPurposeId]"/></row-col></container-row></widgets></section-iterate><section-iterate name="EmailInfoSection" list="contactOut.emailAddressList" entry="contactInfo"><widgets><container-row><row-col lg="8"><render-mode><text type="html,vuet,qvt" location="component://SimpleScreens/template/party/ContactInfo.html.gstring"/></render-mode></row-col><row-col lg="4"><dynamic-dialog id="UpdateEmailInfo" button-text="" transition="UpdateContactInfo" parameter-map="[partyId:partyId, emailContactMechId:contactInfo.emailContactMechId,                                         emailContactMechPurposeId:contactInfo.emailContactMechPurposeId]"/><link url="removeContactInfo" text=" " icon="fa fa-trash" confirmation="Remove email address?" parameter-map="[partyId:partyId, contactMechId:contactInfo.emailContactMechId,                                         contactMechPurposeId:contactInfo.emailContactMechPurposeId]"/></row-col></container-row></widgets></section-iterate><section-iterate name="PhoneInfoSection" list="contactOut.telecomNumberList" entry="contactInfo"><widgets><container-row><row-col lg="8"><render-mode><text type="html,vuet,qvt" location="component://SimpleScreens/template/party/ContactInfo.html.gstring"/></render-mode></row-col><row-col lg="4"><dynamic-dialog id="UpdatePhoneInfo" button-text="" transition="UpdateContactInfo" parameter-map="[partyId:partyId, telecomContactMechId:contactInfo.telecomContactMechId,                                         telecomContactMechPurposeId:contactInfo.telecomContactMechPurposeId]"/><link url="removeContactInfo" text=" " icon="fa fa-trash" confirmation="Remove phone number?" parameter-map="[partyId:partyId, contactMechId:contactInfo.telecomContactMechId,                                         contactMechPurposeId:contactInfo.telecomContactMechPurposeId]"/></row-col></container-row></widgets></section-iterate><button-menu text="Add New" icon="fa fa-plus"><dynamic-dialog id="AddPhoneInfo" button-text="Phone" transition="UpdateContactInfo" parameter-map="[partyId:partyId, createTelecom:'true']"/><dynamic-dialog id="AddEmailInfo" button-text="Email" transition="UpdateContactInfo" parameter-map="[partyId:partyId, createEmail:'true']"/><dynamic-dialog id="AddWebUrlInfo" button-text="URL" transition="UpdateContactInfo" parameter-map="[partyId:partyId, createWeb:'true']"/></button-menu></box-body></container-box></widgets></section></row-col><row-col lg="6"><subscreens-panel id="CenterPanel" type="tab"><![CDATA[-]]></subscreens-panel></row-col><row-col lg="3"><section name="ContactSection"><actions><entity-find entity-name="mantle.party.PartyRelationship" list="contactList"><econdition field-name="toPartyId" from="partyId"/><econdition field-name="fromRoleTypeId" value="Contact"/><date-filter/></entity-find><entity-find-count entity-name="mantle.party.PartyRelationship" count-field="relationshipCount"><econdition field-name="toPartyId" from="partyId"/><date-filter/><econdition field-name="fromRoleTypeId" value="Contact"/></entity-find-count></actions><widgets><container-box type="default"><box-header title="Contacts"/><box-body><label text="Contacts related to this Sales Account: ${relationshipCount}"/><form-list name="ContactList" list="contactList" skip-header="true"><field name="fromPartyId"><default-field title="Contact Name"><link url="viewContact" entity-name="mantle.party.PartyDetail" text="PartyNameOnlyTemplate" link-type="anchor" parameter-map="[partyId:fromPartyId]"/></default-field></field></form-list></box-body></container-box></widgets></section><section name="OpportunitySection"><actions><entity-find entity-name="mantle.sales.opportunity.SalesOpportunity" list="oppyList"><econdition field-name="accountPartyId" from="partyId"/></entity-find></actions><widgets><container-box><box-header title="Sales Opportunities"/><box-body><form-list name="OppyList" list="oppyList" skip-header="true"><field name="opportunityName"><default-field><link url="viewOpportunity" text="${opportunityName}" link-type="anchor"/></default-field></field><field name="description"><default-field><display/></default-field></field></form-list></box-body></container-box></widgets></section><section name="OrderSection"><actions><entity-find entity-name="mantle.order.OrderHeaderAndPart" list="orderList"><econdition field-name="customerPartyId" from="partyId"/></entity-find></actions><widgets><container-box><box-header title="Sales Orders"/><box-body height="100"><form-list name="OrderList" list="orderList" skip-header="true"><field name="orderId"><default-field><link url="viewOrder" text="${orderId}" link-type="anchor"/></default-field></field><field name="placedDate"><default-field><display format="yyyy-MM-dd"/></default-field></field><field name="statusId"><default-field><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="grandTotal" align="right"><default-field><display currency-unit-field="currencyUomId"/></default-field></field></form-list></box-body></container-box></widgets></section></row-col></container-row></widgets></screen>
<!-- Screen Location component://Sales/screen/Sales/Account.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Accounts" default-menu-index="10" menu-image="/ssstatic/images/Customer.png"><subscreens default-item="FindAccount"/><widgets><subscreens-panel id="account-panel" type="popup"/></widgets></screen>
<!-- Screen Location component://Sales/screen/Sales/Contact/FindContact.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="true" default-menu-title="Find Contact"><transition name="createContact"><service-call name="mantle.sales.AccountServices.create#Contact" in-map="true" out-map="context" multi="parameter"/><default-response url="../ViewContact"/></transition><transition name="viewContact"><default-response url="../ViewContact"/></transition><transition name="viewAccount"><default-response url="../../Account/ViewAccount"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><pre-actions><set field="roleTypeId" value="Contact"/></pre-actions><actions><service-call name="sales.SalesServices.search#Party" in-map="context" out-map="context"/></actions><widgets><container-dialog id="CreateContactDialog" button-text="New Sales Contact"><form-single name="CreateContactForm" transition="createContact"><field name="accountPartyId"><default-field title="Sales Account"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="0" parameter-map="[roleTypeId:'Account']"/></drop-down></default-field></field><field name="firstName"><default-field><text-line size="30"/></default-field></field><field name="lastName"><default-field><text-line size="30"/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="ContactList" list="documentList" skip-form="true" header-dialog="true" select-columns="true" saved-finds="true" show-csv-button="true" show-xlsx-button="true" show-page-size="true" show-all-button="true"><row-actions><entity-find entity-name="mantle.party.contact.PartyContactMechInfo" list="emailList"><date-filter/><econdition field-name="partyId"/><econdition field-name="contactMechPurposeId" value="EmailPrimary"/></entity-find><entity-find entity-name="mantle.party.PartyRelationship" list="accountList"><date-filter/><econdition field-name="fromPartyId" from="partyId"/><econdition field-name="fromRoleTypeId" value="Contact"/><select-field field-name="toPartyId"/></entity-find></row-actions><field name="partyId"><default-field><link url="viewContact" entity-name="mantle.party.PartyDetail" text="PartyNameOnlyTemplate" link-type="anchor" parameter-map="[partyId:partyId]"/></default-field></field><field name="contactEmail"><default-field title="Email Address"><section-iterate name="EmailList" list="emailList" entry="email"><widgets><label text="${email.infoString}"/></widgets></section-iterate></default-field></field><field name="toPartyId"><header-field title="Sales Account"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="0" parameter-map="[roleTypeId:'Account']"/></drop-down></header-field><default-field><section-iterate name="AccountList" list="accountList" entry="account"><actions><entity-find-one entity-name="mantle.party.PartyDetail" value-field="accountDetail"><field-map field-name="partyId" from="account.toPartyId"/></entity-find-one></actions><widgets><link url="viewAccount" text-map="accountDetail" text="PartyNameOnlyTemplate" parameter-map="[partyId:account.toPartyId]" link-type="anchor"/></widgets></section-iterate></default-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field></field></form-list></widgets></screen>
<!-- Screen Location component://Sales/screen/Sales/Contact/ViewContact.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="View Contact"><parameter name="partyId" required="true"/><transition name="removeContactInfo"><service-call name="mantle.party.ContactServices.delete#PartyContactMech" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="viewAccount"><default-response url="../../Account/ViewAccount"/></transition><transition name="addContact"><service-call name="mantle.sales.AccountServices.add#Contact" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="removeContact"><service-call name="mantle.sales.AccountServices.delete#Contact" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><subscreens default-item="Note"><subscreens-item menu-include="false" name="UpdateContactInfo" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty/UpdateContactInfo.xml"/></subscreens><actions><entity-find-one entity-name="mantle.party.PartyDetail" value-field="party"/><if condition="party == null"><return error="true" message="Party not found with ID ${partyId}"/></if></actions><widgets><container-row><row-col lg="3"><section name="PartySummarySection"><actions><service-call name="mantle.party.ContactServices.get#PartyContactInfoList" out-map="contactOut" in-map="[partyId:partyId, getAll:true]"/></actions><widgets><container-box type="default"><box-header title="${party.firstName} ${party.lastName}"/><box-body><section-iterate name="WebInfoSection" list="contactOut.webAddressList" entry="contactInfo"><widgets><container-row><row-col lg="7"><render-mode><text type="html,vuet,qvt" location="component://SimpleScreens/template/party/ContactInfo.html.gstring"/></render-mode></row-col><row-col lg="5"><dynamic-dialog id="UpdateWebInfo" button-text="Update" transition="UpdateContactInfo" parameter-map="[partyId:partyId, webContactMechId:contactInfo.webContactMechId,                                         webContactMechPurposeId:contactInfo.webContactMechPurposeId]"/><link url="removeContactInfo" text=" " icon="fa fa-trash" confirmation="Remove Web URL?" parameter-map="[partyId:partyId, contactMechId:contactInfo.webContactMechId,                                         contactMechPurposeId:contactInfo.webContactMechPurposeId]"/></row-col></container-row></widgets></section-iterate><section-iterate name="EmailInfoSection" list="contactOut.emailAddressList" entry="contactInfo"><widgets><container-row><row-col lg="7"><render-mode><text type="html,vuet,qvt" location="component://SimpleScreens/template/party/ContactInfo.html.gstring"/></render-mode></row-col><row-col lg="5"><dynamic-dialog id="UpdateEmailInfo" button-text="Update" transition="UpdateContactInfo" parameter-map="[partyId:partyId, emailContactMechId:contactInfo.emailContactMechId,                                         emailContactMechPurposeId:contactInfo.emailContactMechPurposeId]"/><link url="removeContactInfo" text=" " icon="fa fa-trash" confirmation="Remove email address?" parameter-map="[partyId:partyId, contactMechId:contactInfo.emailContactMechId,                                         contactMechPurposeId:contactInfo.emailContactMechPurposeId]"/></row-col></container-row></widgets></section-iterate><section-iterate name="PhoneInfoSection" list="contactOut.telecomNumberList" entry="contactInfo"><widgets><container-row><row-col lg="7"><render-mode><text type="html,vuet,qvt" location="component://SimpleScreens/template/party/ContactInfo.html.gstring"/></render-mode></row-col><row-col lg="5"><dynamic-dialog id="UpdatePhoneInfo" button-text="Update" transition="UpdateContactInfo" parameter-map="[partyId:partyId, telecomContactMechId:contactInfo.telecomContactMechId,                                         telecomContactMechPurposeId:contactInfo.telecomContactMechPurposeId]"/><link url="removeContactInfo" text=" " icon="fa fa-trash" confirmation="Remove phone number?" parameter-map="[partyId:partyId, contactMechId:contactInfo.telecomContactMechId,                                         contactMechPurposeId:contactInfo.telecomContactMechPurposeId]"/></row-col></container-row></widgets></section-iterate><button-menu text="Add New" icon="fa fa-plus"><dynamic-dialog id="AddPhoneInfo" button-text="Phone" transition="UpdateContactInfo" parameter-map="[partyId:partyId, createTelecom:'true']"/><dynamic-dialog id="AddEmailInfo" button-text="Email" transition="UpdateContactInfo" parameter-map="[partyId:partyId, createEmail:'true']"/><dynamic-dialog id="AddWebUrlInfo" button-text="URL" transition="UpdateContactInfo" parameter-map="[partyId:partyId, createWeb:'true']"/></button-menu></box-body></container-box></widgets></section></row-col><row-col lg="6"><subscreens-panel id="CenterPanel" type="tab"/></row-col><row-col lg="3"><section name="AccountSection"><actions><entity-find entity-name="mantle.party.PartyRelationship" list="accountList"><econdition field-name="fromPartyId" from="partyId"/><econdition field-name="toRoleTypeId" value="Account"/><date-filter/></entity-find></actions><widgets><container-box type="default"><box-header title="Sales Accounts"/><box-toolbar><container-dialog id="AddSalesAccountDialog" button-text="Add to Sales Account"><form-single name="AddSalesAccount" transition="addContact"><field name="partyId"><default-field><hidden/></default-field></field><field name="accountPartyId"><default-field title="Sales Account"><drop-down><dynamic-options transition="searchPartyList" server-search="true" min-length="0" parameter-map="[roleTypeId:'Account']"/></drop-down></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="AccountList" list="accountList" skip-header="true"><field name="toPartyId"><default-field title="Account Name"><link url="viewAccount" entity-name="mantle.party.PartyDetail" text="PartyNameOnlyTemplate" link-type="anchor" parameter-map="[partyId:toPartyId]"/></default-field></field><field name="removeButton" align="right"><default-field title=""><link url="removeContact" icon="fa fa-trash" parameter-map="[partyRelationshipId:partyRelationshipId]" confirmation="Are you sure you want to remove this contact from the account?"/></default-field></field></form-list></box-body></container-box></widgets></section></row-col></container-row></widgets></screen>
<!-- Screen Location component://Sales/screen/Sales/Contact.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Contacts" default-menu-index="20" menu-image="/ssstatic/images/Customer.png"><subscreens default-item="FindContact"/><widgets><subscreens-panel id="contact-panel" type="popup"/></widgets></screen>
<!-- Screen Location component://Sales/screen/Sales/Opportunity/FindOpportunity.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="true" default-menu-title="Find Opportunity"><transition name="viewAccount"><default-response url="../../Account/ViewAccount"/></transition><transition name="viewOpportunity"><default-response url="../ViewOpportunity"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition name="createOpportunity"><service-call name="sales.SalesServices.create#Opportunity" in-map="true" out-map="context" multi="parameter"/><default-response url="../ViewOpportunity"/></transition><pre-actions/><actions><service-call name="sales.SalesServices.search#Opportunity" in-map="context" out-map="context"/></actions><widgets><container-dialog id="CreateOpportunityDialog" button-text="New Opportunity"><form-single name="CreateOpportunityForm" transition="createOpportunity"><field name="accountPartyId"><default-field title="Sales Account"><drop-down allow-empty="false"><dynamic-options transition="searchPartyList" server-search="true" min-length="0" parameter-map="[roleTypeId:'Account']"/></drop-down></default-field></field><field name="currencyUomId"><default-field title="Currency"><drop-down no-current-selected-key="${ec.user.getPreference('CurrencyDefault') ?: 'USD'}"><entity-options key="${uomId}" text="${description} [${uomId}]"><entity-find entity-name="moqui.basic.Uom"><econdition field-name="uomTypeEnumId" value="UT_CURRENCY_MEASURE"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="estimatedAmount"><default-field title="Amount"><text-line size="10"/></default-field></field><field name="estimatedCloseDate"><default-field title="Close Date"><date-time type="date"/></default-field></field><field name="partyId"><default-field title="Sales Person"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="0" parameter-map="[roleTypeId:'SalesRepresentative']"/></drop-down></default-field></field><field name="opportunityName"><default-field><text-line size="30"/></default-field></field><field name="description"><default-field><text-area/></default-field></field><field name="submitButton"><default-field title="Create Opportunity"><submit/></default-field></field></form-single></container-dialog><form-list name="OpportunityList" list="documentList" skip-form="true" header-dialog="true" select-columns="true" saved-finds="true" show-csv-button="true" show-xlsx-button="true" show-all-button="true"><row-actions><entity-find entity-name="mantle.sales.opportunity.SalesOpportunityParty" list="partyList"><econdition field-name="salesOpportunityId" from="salesOpportunityId"/><econdition field-name="roleTypeId" value="SalesRepresentative"/></entity-find><entity-find entity-name="mantle.party.PartyDetail" list="salesTeamList"><econdition field-name="partyId" operator="in" from="partyList.partyId"/></entity-find></row-actions><field name="accountPartyId"><header-field title="Sales Account" show-order-by="true"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="0" parameter-map="[roleTypeId:'Account']"/></drop-down></header-field><default-field><link url="viewAccount" entity-name="mantle.party.PartyDetail" text="PartyNameOnlyTemplate" link-type="anchor" parameter-map="[partyId:accountPartyId]"/></default-field></field><field name="name"><header-field title="Opportunity" show-order-by="true"><text-line size="40"/></header-field><default-field><link url="viewOpportunity" text="${name}" link-type="anchor" parameter-map="[salesOpportunityId:salesOpportunityId]"/></default-field></field><field name="estimatedAmount" align="right"><header-field title="Amount" show-order-by="true"/><default-field><display currency-unit-field="currencyUomId"/></default-field></field><field name="estimatedCloseDate"><header-field title="Close Date" show-order-by="true"><date-time type="date"/></header-field><conditional-field condition="estimatedCloseDate"><label text="${ec.l10n.format(new Date(estimatedCloseDate), 'yyyy-MM-dd')}"/></conditional-field></field><field name="partyId"><header-field title="Sales Person" show-order-by="true"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="0" parameter-map="[roleTypeId:'SalesRepresentative']"/></drop-down></header-field><default-field><section-iterate name="SalesTeamList" list="salesTeamList" entry="rep"><widgets><display text="PartyNameOnlyTemplate" text-map="rep"/></widgets></section-iterate></default-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field></field></form-list></widgets></screen>
<!-- Screen Location component://Sales/screen/Sales/Opportunity/ViewOpportunity.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="View Opportunity" default-menu-include="false"><parameter name="salesOpportunityId" required="true"/><transition name="updateOpportunity"><service-call name="update#mantle.sales.opportunity.SalesOpportunity" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="addParty"><service-call name="create#mantle.sales.opportunity.SalesOpportunityParty" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="removeParty"><service-call name="delete#mantle.sales.opportunity.SalesOpportunityParty" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><subscreens default-item="Note"/><pre-actions><entity-find-one entity-name="mantle.sales.opportunity.SalesOpportunity" value-field="opportunity"/><if condition="opportunity == null"><return error="true" message="Opportunity not found with ID ${salesOpportunityId}"/></if><entity-find-one entity-name="mantle.party.PartyDetail" value-field="accountDetail"><field-map field-name="partyId" from="opportunity.accountPartyId"/></entity-find-one></pre-actions><actions><entity-find-one entity-name="mantle.sales.opportunity.SalesOpportunityStage" value-field="stage"><field-map field-name="opportunityStageId" from="opportunity.opportunityStageId"/></entity-find-one></actions><widgets><container-row><row-col lg="3"><section name="OpportunitySummarySection"><widgets><container-box><box-header title="${opportunity.opportunityName}"/><box-toolbar><container-dialog id="UpdateOpportunityDialog" button-text="Edit"><form-single name="UpdateOpportunityForm" transition="updateOpportunity" map="opportunity"><field name="salesOpportunityId"><default-field><hidden/></default-field></field><field name="accountPartyId"><default-field title="Sales Account"><drop-down allow-empty="false"><dynamic-options transition="searchPartyList" server-search="true" min-length="0" parameter-map="[roleTypeId:'Account']"/></drop-down></default-field></field><field name="currencyUomId"><default-field title="Currency"><drop-down no-current-selected-key="${ec.user.getPreference('CurrencyDefault') ?: 'USD'}"><entity-options key="${uomId}" text="${description} [${uomId}]"><entity-find entity-name="moqui.basic.Uom"><econdition field-name="uomTypeEnumId" value="UT_CURRENCY_MEASURE"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="estimatedAmount"><default-field title="Amount"><text-line size="10"/></default-field></field><field name="opportunityStageId"><default-field title="Stage"><drop-down><entity-options key="${opportunityStageId}" text="${description}"><entity-find entity-name="mantle.sales.opportunity.SalesOpportunityStage"><order-by field-name="sequenceNum"/></entity-find></entity-options></drop-down></default-field></field><field name="estimatedCloseDate"><default-field title="Close Date"><date-time type="date"/></default-field></field><field name="partyId"><default-field title="Sales Person"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="0" parameter-map="[roleTypeId:'SalesRepresentative']"/></drop-down></default-field></field><field name="opportunityName"><default-field><text-line size="30"/></default-field></field><field name="description"><default-field><text-area/></default-field></field><field name="submitButton"><default-field title="Save"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><container-row style="color:red"><row-col lg="4"><label text="Sales Account: "/></row-col><row-col lg="8"><label text="PartyNameOnlyTemplate" text-map="accountDetail" condition="accountDetail"/></row-col></container-row><container-row><row-col lg="4"><label text="Amount: "/></row-col><row-col lg="8"><label text="${ec.l10n.formatCurrency(opportunity.estimatedAmount ?: 0, opportunity?.currencyUomId)}"/></row-col></container-row><container-row><row-col lg="4"><label text="Stage: "/></row-col><row-col lg="8"><label text="${stage.description}" condition="stage"/></row-col></container-row><container-row><row-col lg="4"><label text="Close Date: "/></row-col><row-col lg="8"><label text="${ec.l10n.format(opportunity.estimatedCloseDate,'yyyy-MM-dd')}"/></row-col></container-row><container-row><row-col lg="4"><label text="Description: "/></row-col><row-col lg="8"><label text="${opportunity.description}" condition="opportunity.description"/></row-col></container-row></box-body></container-box></widgets></section><section name="SalesTeamSection"><actions><entity-find entity-name="mantle.sales.opportunity.SalesOpportunityParty" list="salesTeamList"><econdition field-name="salesOpportunityId" from="salesOpportunityId"/><econdition field-name="roleTypeId" value="SalesRepresentative"/></entity-find></actions><widgets><container-box><box-header title="Sales Team"/><box-toolbar><container-dialog id="AddSalesPerson" button-text="Add Sales Person"><label text="Sales people must first be setup by an administrator to appear in this list."/><form-single name="AddSalesPersonForm" transition="addParty" map="opportunity"><field name="salesOpportunityId"><default-field><hidden/></default-field></field><field name="roleTypeId"><default-field><hidden default-value="SalesRepresentative"/></default-field></field><field name="partyId"><default-field title="Sales Person"><drop-down allow-empty="false"><entity-options key="${partyId}" text="PartyNameOnlyTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="SalesRepresentative"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="SalesTeamList" list="salesTeamList" skip-header="true"><field name="partyId"><default-field title="Sales Representative"><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameOnlyTemplate"/></default-field></field><field name="removeButton" align="right"><default-field><link url="removeParty" icon="fa fa-trash" confirmation="Are you sure you want to remove this sales person?"/></default-field></field></form-list></box-body></container-box></widgets></section></row-col><row-col lg="6"><subscreens-panel id="CenterPanel" type="tab"/></row-col><row-col lg="3"><section name="ContactSection"><actions><entity-find entity-name="mantle.sales.opportunity.SalesOpportunityParty" list="contactList"><econdition field-name="salesOpportunityId" from="salesOpportunityId"/><econdition field-name="roleTypeId" value="Contact"/></entity-find></actions><widgets><container-box><box-header title="Contacts"/><box-toolbar><container-dialog id="AddContact" button-text="Add Contact"><label text="This associates an existing contact with this opportunity. The contact must first be linked to the sales account to appear in this list."/><form-single name="AddContactForm" transition="addParty" map="opportunity"><field name="salesOpportunityId"><default-field><hidden/></default-field></field><field name="roleTypeId"><default-field><hidden default-value="Contact"/></default-field></field><field name="partyId"><default-field title="Contact"><drop-down allow-empty="false"><entity-options key="${fromPartyId}" text="PartyNameOnlyTemplate"><entity-find entity-name="mantle.party.PartyFromAndRelationship"><econdition field-name="toPartyId" from="accountPartyId"/><econdition field-name="fromRoleTypeId" value="Contact"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="ContactList" list="contactList" skip-header="true"><field name="partyId"><default-field title="Contact"><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameOnlyTemplate"/></default-field></field><field name="removeButton" align="right"><default-field><link url="removeParty" icon="fa fa-trash" confirmation="Are you sure you want to remove this contact?"/></default-field></field></form-list></box-body></container-box></widgets></section><section name="AttachmentSection"><widgets><container-box><box-header title="Attachments"/><box-toolbar><container-dialog id="UploadAttachmentDialog" button-text="Upload"/></box-toolbar></container-box></widgets></section></row-col></container-row></widgets></screen>
<!-- Screen Location component://Sales/screen/Sales/Opportunity.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Opportunities" default-menu-index="30" menu-image="/ssstatic/images/Customer.png"><subscreens default-item="FindOpportunity"/><widgets><subscreens-panel id="opportunity-panel" type="popup"/></widgets></screen>
<!-- Screen Location component://Sales/screen/Sales/Agreement/ViewAgreement.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Agreement" default-menu-include="false"><parameter name="agreementId" required="true"/><transition name="updateAgreement"><service-call name="sales.AgreementServices.update#Agreement" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="addAgreementParty"><service-call name="create#mantle.party.agreement.AgreementParty" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="removeAgreementParty"><service-call name="delete#mantle.party.agreement.AgreementParty" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateBillToParty"><service-call name="sales.AgreementServices.update#BillToParty" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateBillToContactMech"><service-call name="sales.AgreementServices.update#BillToContactMech" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateShipToContactMech"><service-call name="sales.AgreementServices.update#ShipToContactMech" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updatePaymentMethod"><service-call name="sales.AgreementServices.update#PaymentMethod" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="addAgreementItem"><service-call name="sales.AgreementServices.create#AgreementItem" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateAgreementItem"><service-call name="sales.AgreementServices.update#AgreementItem" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteAgreementItem"><service-call name="delete#mantle.party.agreement.AgreementItem" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><actions><service-call name="sales.AgreementServices.find#Agreement" in-map="[agreementId:agreementId]" out-map="context"/><service-call name="sales.AgreementServices.find#AgreementItems" in-map="[agreementId:agreementId]" out-map="context"/><service-call name="sales.AgreementServices.find#AgreementParties" in-map="[agreementId:agreementId]" out-map="context"/><service-call name="sales.AgreementServices.find#AgreementSubscriptions" in-map="[agreementId:agreementId]" out-map="context"/><service-call name="sales.AgreementServices.find#PaymentMethod" in-map="[agreementId:agreementId]" out-map="context"/><entity-find-one entity-name="mantle.party.PartyDetail" value-field="customer"><field-map field-name="partyId" from="agreement.otherPartyId"/></entity-find-one></actions><widgets><container-row><row-col lg="6"><container-box><box-header title="Agreement #${agreementId} - ${ec.resource.expand('PartyNameOnlyTemplate','',customer)}"/><box-body><form-single name="HeaderForm" map="agreement" transition="updateAgreement"><field name="agreementId"><default-field><hidden/></default-field></field><field name="organizationPartyId"><default-field title="Transacting Entity"><drop-down allow-empty="true"><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></default-field></field><field name="currencyUomId"><default-field title="Currency"><drop-down no-current-selected-key="${ec.user.getPreference('CurrencyDefault') ?: 'USD'}"><entity-options key="${uomId}" text="${description} [${uomId}]"><entity-find entity-name="moqui.basic.Uom"><econdition field-name="uomTypeEnumId" value="UT_CURRENCY_MEASURE"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="fromDate"><default-field title="Start Date"><date-time type="date"/></default-field></field><field name="thruDate"><default-field title="End Date"><date-time type="date"/></default-field></field><field name="organizationPartyId"><default-field title="Transacting Entity"><drop-down allow-empty="true"><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></default-field></field><field name="description"><default-field><text-line size="40"/></default-field></field><field name="submitButton"><default-field title="Save"><submit/></default-field></field><field-layout><field-col-row><field-col><field-ref name="organizationPartyId"/></field-col><field-col><field-ref name="currencyUomId"/></field-col></field-col-row><field-col-row><field-col><field-ref name="fromDate"/></field-col><field-col><field-ref name="thruDate"/></field-col><field-col><field-ref name="description"/></field-col><field-col><field-ref name="submitButton"/></field-col></field-col-row></field-layout></form-single><section name="SubscriptionSection" condition="agreementSubscriptionList"><widgets><container-box><box-header title="Subscriptions Associated with this Agreement"/><box-body><form-list name="SubscriptionForm" list="agreementSubscriptionList"><field name="description"><default-field><display/></default-field></field><field name="subscriptionId"><default-field title="Internal ID"><display/></default-field></field><field name="resourceInstanceId"><default-field title="External ID"><display/></default-field></field></form-list></box-body></container-box><container-box><box-header title="Agreement Terms"/><box-body><label text="Settlement Term: Net 30" type="p"/><label text="Committed Consumption: Billed annually in advance" type="p"/><label text="Price Rule: Discount applies to usage over committed amount" type="p"/></box-body></container-box><container-box><box-header title="Agreement Parties"/><box-toolbar><container-dialog id="AddPartyDialog" button-text="Add Party"><form-single name="CreateAgreementParty" transition="addAgreementParty" map="agreement"><field name="agreementId"><default-field><hidden/></default-field></field><field name="partyId"><default-field title="Party"><drop-down><dynamic-options transition="searchPartyList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="roleTypeId"><default-field title="Role"><drop-down><entity-options key="${roleTypeId}" text="${description}"><entity-find entity-name="mantle.party.RoleGroupMemberAndType" cache="true"><econdition field-name="roleGroupEnumId" value="RgpAgreement"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="AgreementPartyForm" list="agreementPartyList"><field name="partyId"><default-field title="Party"><link url="viewAccount" entity-name="mantle.party.PartyDetail" text="PartyNameOnlyTemplate" link-type="anchor" parameter-map="[partyId:toPartyId]"/></default-field></field><field name="description"><default-field title="Role"><display/></default-field></field><field name="removeButton" align="right"><default-field title=""><link url="removeAgreementParty" icon="fa fa-trash" parameter-map="[agreementId:agreementId, partyId:partyId, roleTypeId:roleTypeId]" confirmation="Are you sure you want to remove this party from the Agreement?"/></default-field></field></form-list></box-body></container-box></widgets></section></box-body></container-box></row-col><row-col lg="6"><section name="ShipToAddress"><actions><entity-find-one entity-name="mantle.party.agreement.AgreementContactMech" value-field="curShipToContactMech"><field-map field-name="agreementId"/><field-map field-name="contactMechPurposeId" value="PostalShippingDest"/></entity-find-one><if condition="curShipToContactMech"><service-call name="mantle.party.ContactServices.get#PartyContactInfo" out-map="curShipToInfo" in-map="[partyId:agreement.otherPartyId, postalContactMechId:curShipToContactMech.contactMechId]"/></if><service-call name="mantle.party.ContactServices.get#PartyContactInfoList" out-map="customerShipToInfo" in-map="[partyId:agreement.otherPartyId, postalContactMechPurposeId:'PostalShippingDest']"/></actions><widgets><container-box><box-header title="Ship To Address"/><box-toolbar><container-dialog id="SelectShipToAddress" button-text="Select"><form-single name="SetShippingInfoForm" transition="updateShipToContactMech"><field name="agreementId"><default-field><hidden/></default-field></field><field name="shipToPostalContactMechId" from="curShipToContactMech?.contactMechId"><default-field title="Ship To Address"><drop-down><list-options list="customerShipToInfo.postalAddressList" key="${postalContactMechId}" text="PostalAddressInfoTemplate"/></drop-down></default-field></field><field name="submitButton"><default-field title="Submit"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><label text="Please select an address using the 'Select' button.                                            " condition="!curShipToInfo" type="i"/><section name="ShipToAddressDisplay" condition="curShipToInfo"><widgets><text type="html,vuet,qvt" location="component://Sales/template/ShipToContactInfo.html.gstring"/></widgets></section></box-body></container-box></widgets></section><container-box><box-header title="Bill To Party: ${ec.resource.expand('PartyNameOnlyTemplate','',billToParty)}"/><box-toolbar><container-dialog id="BillToDialog" button-text="Change Bill To"><form-single name="BillToForm" transition="updateBillToParty"><field name="agreementId"><default-field><hidden/></default-field></field><field name="partyId"><default-field title="Party"><drop-down><dynamic-options transition="searchPartyList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><section name="BillToAddress"><actions><entity-find-one entity-name="mantle.party.agreement.AgreementContactMech" value-field="curBillToContactMech"><field-map field-name="agreementId"/><field-map field-name="contactMechPurposeId" value="PostalBilling"/></entity-find-one><if condition="curBillToContactMech"><service-call name="mantle.party.ContactServices.get#PartyContactInfo" out-map="curBillToInfo" in-map="[partyId:billToParty.partyId, postalContactMechId:curBillToContactMech.contactMechId]"/></if><service-call name="mantle.party.ContactServices.get#PartyContactInfoList" out-map="customerBillingInfo" in-map="[partyId:billToParty.partyId, postalContactMechPurposeId:'PostalBilling']"/></actions><widgets><container-box><box-header title="Bill To Address"/><box-toolbar><container-dialog id="SelectBillToAddress" button-text="Select"><form-single name="SetBillingInfoForm" transition="updateBillToContactMech"><field name="agreementId"><default-field><hidden/></default-field></field><field name="billToPostalContactMechId" from="curBillToContactMech?.contactMechId"><default-field title="Billing Address"><drop-down><list-options list="customerBillingInfo.postalAddressList" key="${postalContactMechId}" text="PostalAddressInfoTemplate"/></drop-down></default-field></field><field name="submitButton"><default-field title="Submit"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><label text="Please select an address using the 'Select' button.                                                 If none are listed add a new address." condition="!curBillToInfo" type="i"/><section name="BillToAddressDisplay" condition="curBillToInfo"><widgets><text type="html,vuet,qvt" location="component://Sales/template/BillToContactInfo.html.gstring"/></widgets></section></box-body></container-box><container-box><box-header title="Payment Information"/><box-toolbar><container-dialog id="AddPaymentInfo" button-text="Select Payment Method"><form-single name="AddPaymentForm" transition="updatePaymentMethod" focus-field="paymentMethodId"><field name="agreementId"><default-field><hidden/></default-field></field><field name="paymentMethodId"><default-field title="Payment Method"><drop-down allow-empty="true"><entity-options key="${paymentMethodId}" text="PaymentMethodDetailTemplate"><entity-find entity-name="mantle.account.method.PaymentMethodDetail"><date-filter/><econdition field-name="ownerPartyId" from="billToParty.partyId"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Select"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><section name="MethodInfoDisplay" condition="methodInfo"><widgets><text type="html,vuet,qvt" location="component://SimpleScreens/template/party/PaymentMethodInfo.html.gstring"/></widgets></section></box-body></container-box></widgets></section></box-body></container-box></row-col></container-row><container-row><row-col lg="12"><container-box><box-header title="Agreement Items"/><box-toolbar><container-dialog id="AddAgreementItemContainer" button-text="Add Item"><form-single name="AddAgreementItemForm" transition="addAgreementItem" focus-field="productId"><field name="agreementId"><default-field><hidden/></default-field></field><field name="productId"><default-field title="Product"><drop-down><dynamic-options transition="getProductList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="quantity"><default-field><text-line size="8" default-value="1"/></default-field></field><field name="unitAmount"><default-field title="Price" tooltip="Leave empty to use Calc Price"><text-line size="10"/></default-field></field><field name="fromDate"><default-field><date-time type="date"/></default-field></field><field name="thruDate"><default-field><date-time type="date"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="AgreementItemForm" list="agreementItemList" list-entry="agreementItem" transition="updateAgreementItem"><field name="agreementId"><default-field><hidden/></default-field></field><field name="agreementItemSeqId"><default-field><hidden/></default-field></field><field name="productPriceId"><default-field><hidden/></default-field></field><field name="agreementItemTypeEnumId"><default-field title="Item Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="productId"><default-field title="Product"><display-entity entity-name="mantle.product.Product"/></default-field></field><field name="itemText"><default-field title="Line Description"><text-line size="30"/></default-field></field><field name="fromDate"><default-field><date-time type="date"/></default-field></field><field name="thruDate"><default-field><date-time type="date"/></default-field></field><field name="quantity"><conditional-field condition="1" title="Quantity"><text-line size="1"/></conditional-field><default-field title="Quantity"><display/></default-field></field><field name="unitListPrice" from="1" align="right"><default-field title="List Price"><display currency-unit-field="agreement.currencyUomId"/></default-field></field><field name="price"><default-field><display currency-unit-field="agreement.currencyUomId"/></default-field></field><field name="price"><conditional-field condition="1" title="Price"><text-line size="4" format="#,##0.00#"/></conditional-field><default-field title="Contracted Price"><display currency-unit-field="agreement.currencyUomId"/></default-field></field><field name="lineAmount" align="right"><default-field title="Line Amount"><display currency-unit-field="agreement.currencyUomId"/></default-field></field><field name="submitButton" align="right"><conditional-field condition="1"><submit text="Update"/><link url="deleteAgreementItem" text=" " btn-type="danger" icon="fa fa-trash" confirmation="Delete Item?"/></conditional-field><default-field title=""/></field></form-list></box-body></container-box></row-col></container-row></widgets></screen>
<!-- Screen Location component://Sales/screen/Sales/Agreement/FindAgreement.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="true" default-menu-title="Find Agreements"><transition name="viewAgreement"><default-response url="../ViewAgreement"/></transition><transition name="viewAccount"><default-response url="//Sales/Account/ViewAccount"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><widgets><form-list name="AgreementList" list="agreementList" skip-form="true" header-dialog="true" select-columns="true" saved-finds="true" show-csv-button="true" show-xlsx-button="true" show-all-button="true"><entity-find entity-name="mantle.party.agreement.Agreement" list="agreementList"/><field name="otherPartyId"><header-field title="Customer" show-order-by="true"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2" parameter-map="[roleTypeId:'Customer']"/></drop-down></header-field><default-field><link url="viewAccount" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" link-type="anchor" parameter-map="[partyId:otherPartyId]"/></default-field></field><field name="agreementId"><header-field title="Agreement" show-order-by="true"><text-find size="20" hide-options="true"/></header-field><default-field><link url="viewAgreement" link-type="anchor" text="${agreementId}"/></default-field></field><field name="description"><header-field title="Description"><text-find size="40"/></header-field><default-field><display/></default-field></field><field name="agreementDate"><header-field title="Agreement Date" show-order-by="true"><date-time type="date-time"/></header-field><default-field><display/></default-field></field><field name="fromDate"><header-field title="From Date" show-order-by="true"><date-time type="date"/></header-field><default-field><display format="yyyy-MM-dd"/></default-field></field><field name="thruDate"><header-field title="Thru Date" show-order-by="true"><date-time type="date"/></header-field><default-field><display format="yyyy-MM-dd"/></default-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field></field></form-list></widgets></screen>
<!-- Screen Location component://Sales/screen/Sales/Agreement.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Agreements" default-menu-index="40" menu-image="/ssstatic/images/Customer.png"><subscreens default-item="FindAgreement"/><widgets><subscreens-panel id="agreement-panel" type="popup"/></widgets></screen>
<!-- Screen Location component://Sales/screen/Sales/Order/FindOrder.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Find Order"><transition name="viewAccount"><default-response url="../../Account/ViewAccount"/></transition><transition name="viewOrder"><default-response url="../ViewOrder"/></transition><transition name="createOrder"><service-call name="mantle.order.OrderServices.create#Order" in-map="true" out-map="context" multi="parameter"/><default-response url="../ViewOrder"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><actions><set field="defaultProductStoreId" from="ec.user.getPreference('OrderSalesStoreDefault')"/><if condition="defaultProductStoreId"><entity-find-one entity-name="mantle.product.store.ProductStore" value-field="defaultProductStore"><field-map field-name="productStoreId" from="defaultProductStoreId"/></entity-find-one><if condition="defaultProductStore == null"><set field="defaultProductStoreId" from="null"/></if></if><set field="defaultFacilityId" from="ec.user.getPreference('FacilityGeneralDefault')"/><if condition="defaultFacilityId"><entity-find-one entity-name="mantle.facility.Facility" value-field="defaultFacility"><field-map field-name="facilityId" from="defaultFacilityId"/></entity-find-one><if condition="defaultFacility == null"><set field="defaultFacilityId" from="null"/></if></if></actions><widgets><container-dialog id="CreateSalesOrderDialog" button-text="Create Sales Order"><form-single name="CreateSalesOrder" transition="createOrder"><field name="productStoreId" from="productStoreId ?: defaultProductStoreId"><default-field title="Store"><drop-down allow-empty="true"><entity-options key="${productStoreId}" text="${productStoreId}: ${storeName}"><entity-find entity-name="mantle.product.store.ProductStore"><order-by field-name="storeName"/></entity-find></entity-options></drop-down></default-field></field><field name="customerPartyId"><default-field title="Customer"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2" parameter-map="[roleTypeId:'Customer']"/></drop-down></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="OrderList" list="orderList" skip-form="true" header-dialog="true" select-columns="true" saved-finds="true" show-csv-button="true" show-xlsx-button="true" show-all-button="true"><entity-find entity-name="mantle.order.OrderPartFindView" list="orderList"><search-form-inputs><default-parameters partStatusId="OrderOpen,OrderProposed,OrderRequested,OrderPlaced,OrderApproved,OrderHold" partStatusId_op="in"/></search-form-inputs><select-field field-name="orderPartSeqId"/></entity-find><field name="customerPartyId"><header-field title="Account" show-order-by="true"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2" parameter-map="[roleTypeId:'Customer']"/></drop-down></header-field><default-field><link url="viewAccount" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" link-type="anchor" parameter-map="[partyId:customerPartyId]"/><label text=" - ${custPcaaList*.description.join(', ')}" condition="custPcaaList"/></default-field></field><field name="orderId"><header-field title="Order" show-order-by="true"><text-find size="20" hide-options="true"/></header-field><default-field><link text="${orderId}:${orderPartSeqId}" url="viewOrder" link-type="anchor" condition="orderId"/></default-field></field><field name="orderName"><header-field title="Order Name"><text-find size="40"/></header-field><default-field><display/></default-field></field><field name="partStatusId"><header-field title="Status" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="OrderHeader"/><set field="allowMultiple" value="true"/></widget-template-include></header-field><default-field container-style="text-strong"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="partTotal" align="right" show-total="sum"><header-field show-order-by="true" title="Total"><range-find/></header-field><default-field><display currency-unit-field="currencyUomId"/></default-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Party/EditParty/UpdatePaymentMethodInfo.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="partyId" required="true"/><parameter name="paymentMethodId"/><parameter name="paymentMethodTypeEnumId"/><parameter name="orderId"/><transition name="storePaymentMethodInfo"><service-call name="mantle.account.PaymentMethodServices.store#PaymentMethodInfo" in-map="true" out-map="context" multi="parameter"/><default-response url=".."/></transition><transition-include name="getGeoCountryStates" location="component://SimpleScreens/template/party/PartyForms.xml"/><actions><service-call name="mantle.account.PaymentMethodServices.get#PartyPaymentMethodInfo" out-map="methodInfo" in-map="context"/><set field="methodInfoFlat" from="flattenNestedMap(methodInfo)"/><entity-find entity-name="mantle.party.contact.PartyContactMechPostalAddress" list="partyPostalAddressList"><date-filter/><econdition field-name="partyId"/></entity-find><entity-find entity-name="mantle.party.contact.PartyContactMechTelecomNumber" list="partyTelecomNumberList"><date-filter/><econdition field-name="partyId"/></entity-find><entity-find entity-name="mantle.account.method.PaymentGatewayConfig" list="paymentGatewayConfigList"><econdition field-name="paymentGatewayTypeEnumId" operator="not-equals" value="PgtTest"/><order-by field-name="description"/></entity-find></actions><widgets><form-single name="PaymentMethodInfoForm" transition="storePaymentMethodInfo" map="methodInfoFlat" extends="component://SimpleScreens/template/party/PartyForms.xml#PaymentMethodInfo"><field name="orderId"><default-field><hidden/></default-field></field></form-single></widgets></screen>
<!-- Screen Location component://Sales/screen/Sales/Order/ViewOrder/Item.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Items" default-menu-index="0"><parameter name="orderPartInfo" required="true"/><transition name="addProductItem"><service-call name="mantle.order.OrderServices.add#OrderProductQuantity" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateItem"><service-call name="mantle.order.OrderServices.update#OrderItem" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteItem"><service-call name="mantle.order.OrderServices.delete#OrderItem" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><widgets><container-box><box-header title="Order Items"/><box-toolbar><container-dialog id="AddProductItemContainer" button-text="Add Product"><form-single name="AddProductItemForm" transition="addProductItem" focus-field="productId"><field name="orderId"><default-field><hidden/></default-field></field><field name="orderPartSeqId" from="orderPartInfo.orderPart.orderPartSeqId"><default-field><hidden/></default-field></field><field name="updateExisting"><default-field><hidden default-value="false"/></default-field></field><field name="requireInventory"><default-field><hidden default-value="false"/></default-field></field><field name="assetClassEnumId"><default-field title="Asset Class"><drop-down allow-empty="true" no-current-selected-key="AsClsInventoryFin"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="parentEnumId" value="AsClsInventory"/><order-by field-name="sequenceNum,description"/></entity-find></entity-options></drop-down></default-field></field><field name="productId"><default-field title="Product"><drop-down><dynamic-options transition="getProductList" server-search="true" min-length="0" depends-optional="true"><depends-on field="assetClassEnumId"/></dynamic-options></drop-down></default-field></field><field name="quantity"><default-field><text-line size="8" default-value="1"/></default-field></field><field name="unitAmount"><default-field title="Price" tooltip="Leave empty to use Calc Price"><text-line size="10"/></default-field></field><field name="calcAmount"><default-field title="Calc Price"><display dynamic-transition="getProductPrice" parameter-map="[orderId:orderId, orderPartSeqId:orderPartInfo.orderPart.orderPartSeqId, priceFormat:'#,##0.00']"><depends-on field="productId"/><depends-on field="quantity"/></display></default-field></field><field name="standardCost"><conditional-field condition="orderPartInfo.isCustomerInternalOrg" tooltip="Cost for accounting if different from Price, used to set Asset Acquire Cost on receipt"><text-line size="10"/></conditional-field></field><field name="requiredByDate" from="orderPartInfo.orderPart.shipBeforeDate"><default-field><date-time format="yyyy-MM-dd HH:mm"/></default-field></field><field name="itemTypeEnumId" from="null"><conditional-field condition="orderPartInfo.isCustomerInternalOrg" title="Item Type"><drop-down no-current-selected-key="ItemInventory"><option key="ItemInventory" text="Inventory"/><option key="ItemAsset" text="Fixed Asset"/><option key="ItemExpSupplies" text="Supplies"/></drop-down></conditional-field><default-field title="Item Type"><drop-down no-current-selected-key="ItemProduct"><option key="ItemProduct" text="Product"/><option key="ItemAsset" text="Fixed Asset"/><option key="ItemRental" text="Rental Asset"/><option key="ItemReplacement" text="Replacement"/></drop-down></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="OrderItems" list="orderPartInfo.partOrderItemList" list-entry="orderItem" transition="updateItem"><field name="productId"><default-field title="Product"><display-entity entity-name="mantle.product.Product"/></default-field></field><field name="itemTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration" text="${description}${isPromo ? ' (Promotion)' : ''}"/></default-field></field><field name="itemDescription"><default-field title="Description"><display/></default-field></field><field name="unitListPrice" align="right"><default-field title="List Price"><display currency-unit-field="orderHeader.currencyUomId"/></default-field></field><field name="unitAmount"><conditional-field condition="orderPartInfo.partEditable && isPromo != 'Y'" title="Price"><text-line size="4" format="#,##0.00#"/></conditional-field><default-field title="Price"><display currency-unit-field="orderHeader.currencyUomId"/></default-field></field><field name="quantity"><conditional-field condition="orderPartInfo.partEditable && isPromo != 'Y'"><text-line size="1"/></conditional-field><default-field><display/></default-field></field><field name="submitButton" align="right"><conditional-field condition="orderPartInfo.partEditable && isPromo != 'Y'"><submit text="Update"/><link url="deleteItem" text="" btn-type="danger" icon="fa fa-trash" confirmation="Delete item ${orderItemSeqId}?"/></conditional-field><conditional-field condition="orderPartInfo.partEditable && isPromo == 'Y'"><link url="deleteItem" text="" btn-type="danger" icon="fa fa-trash" confirmation="Delete item ${orderItemSeqId}?"/></conditional-field><default-field title=""/></field></form-list></box-body></container-box></widgets></screen>
<!-- Screen Location component://Sales/screen/Sales/Order/ViewOrder.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="true" default-menu-title="View Order (alpha)" default-menu-include="false"><parameter name="orderId" required="true"/><transition name="getShippingOptions"><parameter name="orderId"/><parameter name="orderPartSeqId"/><actions><entity-find-one entity-name="mantle.order.OrderHeader" value-field="orderHeader"/><service-call name="mantle.product.StoreServices.get#StoreShippingOptions" out-map="shipOptsOut" in-map="[productStoreId:orderHeader.productStoreId, orderId:orderId, orderPartSeqId:orderPartSeqId,                             postalContactMechId:postalContactMechId, getRates:true]"/><script><![CDATA[outList = []
            for (sop in shipOptsOut.shippingOptions) outList.add([value:"${sop.carrierPartyId}:${sop.shipmentMethodEnumId}".toString(),
            label:"${sop.description ? sop.description : (sop.carrierPartyId != '_NA_' ? (sop.carrierName + ' - ') : '') + sop.shipmentMethodDescription}${sop.shippingTotal != null ? ' ' + ec.l10n.formatCurrency(sop.shippingTotal, orderHeader.currencyUomId) : ''}".toString()])
            ec.web.sendJsonResponse(outList)]]></script></actions><default-response type="none"/></transition><transition name="setOrderBillingShippingInfo"><service-call name="mantle.order.OrderServices.set#OrderBillingShippingInfo" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateShipToParty"><service-call name="sales.SalesOrderServices.update#ShipToParty" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateBillToParty"><service-call name="sales.SalesOrderServices.update#BillToParty" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="setBillToContactMech"><service-call name="sales.SalesOrderServices.update#BillToContactMech" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition name="updateOrderPart"><service-call name="mantle.order.OrderServices.update#OrderPart" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><subscreens default-item="Item"><subscreens-item name="UpdateContactInfo" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty/UpdateContactInfo.xml"/><subscreens-item name="UpdatePaymentMethodInfo" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty/UpdatePaymentMethodInfo.xml"/></subscreens><pre-actions><service-call name="mantle.order.OrderInfoServices.get#OrderDisplayInfo" in-map="[orderId:orderId, itemLimit:(itemLimit as Integer)]" out-map="context"/><set field="orderPartInfo" from="orderPartInfoList[0]"/><set field="orderPart" from="orderPartInfo.orderPart"/><set field="orderPartSeqId" from="orderPart.orderPartSeqId"/><set field="customerShipToDetail" from="orderPartInfo.customerShipToDetail?:orderPartInfo.customerDetail"/><set field="customerBillToDetail" from="orderPartInfo.customerBillToDetail?:orderPartInfo.customerDetail"/></pre-actions><widgets><container-row><row-col lg="6"><container-box><box-header title="Order #${orderId} - ${ec.resource.expand('PartyNameOnlyTemplate','',orderPartInfo.customerDetail)}"/><box-toolbar><link url="." text="Put order buttons here (change status, etc)"/></box-toolbar><box-body><form-single name="HeaderForm" map="orderHeader"><field name="statusId"><default-field title="Status"><display text="${statusItem.description}"/></default-field></field><field name="entryDate"><default-field title="Created"><display format="yyyy-MM-dd"/></default-field></field><field name="grandTotal"><default-field><display currency-unit-field="currencyUomId"/></default-field></field><field-layout><field-col-row><field-col><field-ref name="statusId"/></field-col><field-col><field-ref name="entryDate"/></field-col><field-col><field-ref name="grandTotal"/></field-col></field-col-row></field-layout></form-single><label text="Customer Email: ${orderPartInfo.customerEmail ?: 'No Order or Primary email found'}" type="div"/></box-body></container-box><container-box><box-header title="Ship To Customer: ${ec.resource.expand('PartyNameOnlyTemplate','',customerShipToDetail)}"/><box-toolbar><container-dialog id="ChangeShipToDialog" button-text="Change Ship To"><form-single name="ChangeShipToForm" transition="updateShipToParty" map="orderPart"><field name="orderId"><default-field><hidden/></default-field></field><field name="orderPartSeqId"><default-field><hidden/></default-field></field><field name="currentShipToPartyId"><default-field><hidden default-value="customerShipToDetail.partyId"/></default-field></field><field name="newShipToPartyId"><default-field title="Party"><drop-down><dynamic-options transition="searchPartyList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><section name="CurrentShippingAddress"><actions><service-call name="mantle.party.ContactServices.get#PartyContactInfo" out-map="curShipToInfo" in-map="[partyId:customerShipToDetail.partyId, postalContactMechId:orderPart.postalContactMechId]"/><set field="contactInfo" from="curShipToInfo"/><service-call name="mantle.party.ContactServices.get#PartyContactInfoList" out-map="customerShippingInfo" in-map="[partyId:customerShipToDetail.partyId, postalContactMechPurposeId:'PostalShippingDest']"/></actions><widgets><container-box><box-header title="Ship To Address"/><box-toolbar><container-dialog id="SelectShipToAddress" button-text="Select"><form-single name="SelectShipToForm" transition="setOrderBillingShippingInfo" map="orderPartInfo.orderPart"><field name="orderId"><default-field><hidden/></default-field></field><field name="orderPartSeqId"><default-field><hidden/></default-field></field><field name="paymentMethodId"><default-field><hidden/></default-field></field><field name="shippingPostalContactMechId" from="orderPart.postalContactMechId"><conditional-field title="Shipping Address" condition="orderPartInfo.partEditable"><drop-down><list-options list="customerShippingInfo.postalAddressList" key="${postalContactMechId}" text="PostalAddressInfoTemplate"/></drop-down></conditional-field><default-field><hidden/></default-field></field><field name="carrierAndShipmentMethod"><conditional-field title="Shipment Method" condition="orderPartInfo.partEditable"><drop-down no-current-selected-key="${orderPart.carrierPartyId ? orderPart.carrierPartyId + ':' + orderPart.shipmentMethodEnumId : ''}"><list-options list="shippingOptions" key="${carrierPartyId}:${shipmentMethodEnumId}" text="${description ? description : (carrierPartyId != '_NA_' ? (carrierName + ' - ') : '') + shipmentMethodDescription}${shippingTotal != null ? ' ' + ec.l10n.formatCurrency(shippingTotal, orderHeader.currencyUomId) : ''}"/><dynamic-options transition="getShippingOptions"/></drop-down></conditional-field><default-field title="Shipment Method"><display text="${orderPartInfo.shipmentMethodEnum?.description ?: ''}${orderPartInfo.carrierPartyDetail ? ' - ' + ec.resource.expand('PartyNameTemplate', null, orderPartInfo.carrierPartyDetail) : ''}"/></default-field></field><field name="submitButton"><conditional-field condition="orderPartInfo.partEditable" title="Save"><submit/></conditional-field><default-field><ignored/></default-field></field></form-single></container-dialog><dynamic-dialog id="UpdatePostalInfo" button-text="Edit" transition="UpdateContactInfo" width="800" condition="orderPartInfo.partEditable && contactInfo" parameter-map="[partyId:customerShipToDetail.partyId, postalContactMechId:contactInfo.postalContactMechId,                                                 postalContactMechPurposeId:contactInfo.postalContactMechPurposeId, orderId:orderId]"/><dynamic-dialog id="AddPostalInfo" button-text="Add" transition="UpdateContactInfo" width="800" condition="orderPartInfo.partEditable" parameter-map="[partyId:customerShipToDetail.partyId, postalContactMechPurposeId:'PostalShippingDest',                                                         telecomContactMechPurposeId:'PhoneShippingDest', emailContactMechPurposeId:'EmailShippingDest', orderId:orderId, postalContactMechId:null]"/></box-toolbar><box-body><label text="Please select an address from the list below and click the Set button.                                         If none are listed add a new address." condition="!contactInfo" type="i"/><text type="html,vuet,qvt" location="component://Sales/template/ContactInfo.html.gstring"/></box-body></container-box></widgets></section><section name="SetShippingMethod"><widgets><form-single name="SelectShipMethodForm" transition="setOrderBillingShippingInfo" map="orderPartInfo.orderPart"><field name="orderId"><default-field><hidden/></default-field></field><field name="orderPartSeqId"><default-field><hidden/></default-field></field><field name="carrierAndShipmentMethod"><conditional-field title="Shipment Method" condition="orderPartInfo.partEditable"><drop-down submit-on-select="true" no-current-selected-key="${orderPart.carrierPartyId ? orderPart.carrierPartyId + ':' + orderPart.shipmentMethodEnumId : ''}"><list-options list="shippingOptions" key="${carrierPartyId}:${shipmentMethodEnumId}" text="${description ? description : (carrierPartyId != '_NA_' ? (carrierName + ' - ') : '') + shipmentMethodDescription}${shippingTotal != null ? ' ' + ec.l10n.formatCurrency(shippingTotal, orderHeader.currencyUomId) : ''}"/><dynamic-options transition="getShippingOptions"/></drop-down></conditional-field><default-field title="Shipment Method"><display text="${orderPartInfo.shipmentMethodEnum?.description ?: ''}${orderPartInfo.carrierPartyDetail ? ' - ' + ec.resource.expand('PartyNameTemplate', null, orderPartInfo.carrierPartyDetail) : ''}"/></default-field></field></form-single></widgets></section></box-body></container-box></row-col><row-col lg="6"><container-box><box-header title="Bill To Customer: ${ec.resource.expand('PartyNameOnlyTemplate','',customerBillToDetail)}"/><box-toolbar><container-dialog id="ChangeBillToDialog" button-text="Change Bill To"><form-single name="ChangeBillToForm" transition="updateBillToParty" map="orderPart"><field name="orderId"><default-field><hidden/></default-field></field><field name="orderPartSeqId"><default-field><hidden/></default-field></field><field name="currentBillToPartyId"><default-field><hidden default-value="customerBillToDetail.partyId"/></default-field></field><field name="newBillToPartyId"><default-field title="Party"><drop-down><dynamic-options transition="searchPartyList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><section name="CurrentBillingAddress"><actions><entity-find-one entity-name="mantle.order.OrderPartContactMech" value-field="curBillToContactMech"><field-map field-name="orderId" from="orderPart.orderId"/><field-map field-name="orderPartSeqId" from="orderPart.orderPartSeqId"/><field-map field-name="contactMechPurposeId" value="PostalBilling"/></entity-find-one><if condition="curBillToContactMech != null"><service-call name="mantle.party.ContactServices.get#PartyContactInfo" out-map="curBillToInfo" in-map="[partyId:customerBillToDetail.partyId, postalContactMechId:curBillToContactMech.contactMechId]"/><set field="contactInfo" from="curBillToInfo"/></if><service-call name="mantle.party.ContactServices.get#PartyContactInfoList" out-map="customerBillingInfo" in-map="[partyId:customerBillToDetail.partyId, postalContactMechPurposeId:'PostalBilling']"/></actions><widgets><container-box><box-header title="Bill To Address"/><box-toolbar><container-dialog id="SelectBillToAddress" button-text="Select"><form-single name="SetBillingInfoForm" transition="setBillToContactMech" map="orderPartInfo.orderPart"><field name="orderId"><default-field><hidden/></default-field></field><field name="orderPartSeqId"><default-field><hidden/></default-field></field><field name="paymentMethodId"><default-field><hidden/></default-field></field><field name="billToPostalContactMechId" from="curBillToContactMech?.contactMechId"><conditional-field title="Billing Address" condition="orderPartInfo.partEditable"><drop-down><list-options list="customerBillingInfo.postalAddressList" key="${postalContactMechId}" text="PostalAddressInfoTemplate"/></drop-down></conditional-field><default-field><hidden/></default-field></field><field name="submitButton"><conditional-field condition="orderPartInfo.partEditable" title="Set Billing Address"><submit/></conditional-field><default-field><ignored/></default-field></field></form-single></container-dialog><dynamic-dialog id="UpdatePostalInfo" button-text="Edit" transition="UpdateContactInfo" width="800" condition="orderPartInfo.partEditable && contactInfo" parameter-map="[partyId:customerBillToDetail.partyId, postalContactMechId:contactInfo.postalContactMechId,                                                 postalContactMechPurposeId:contactInfo.postalContactMechPurposeId, orderId:orderId]"/><dynamic-dialog id="AddPostalInfo" button-text="Add" transition="UpdateContactInfo" width="800" condition="orderPartInfo.partEditable" parameter-map="[partyId:customerBillToDetail.partyId, postalContactMechPurposeId:'PostalBilling',                                     telecomContactMechPurposeId:'PhoneBilling', emailContactMechPurposeId:'EmailBilling', orderId:orderId, postalContactMechId:null]"/></box-toolbar><box-body><label text="Please select an address from the list below and click the Set button.                                         If none are listed add a new address." condition="!contactInfo" type="i"/><text type="html,vuet,qvt" location="component://Sales/template/ContactInfo.html.gstring"/></box-body></container-box></widgets></section><section name="SetBillingAddress"><actions/><widgets/></section></box-body></container-box><container-box><box-header title="Payment Information"/><box-toolbar><link url="." text="Put payment buttons here"/></box-toolbar><box-body><form-single name="EditPartForm" transition="updateOrderPart" map="orderPart"><field name="orderId"><default-field><hidden/></default-field></field><field name="orderPartSeqId"><default-field><hidden/></default-field></field><field name="settlementTermId"><default-field title="Payment Terms"><drop-down submit-on-select="true" allow-empty="true"><entity-options key="${settlementTermId}" text="${description}"><entity-find entity-name="mantle.account.invoice.SettlementTermAndEnumMember"><econdition field-name="enumGroupEnumId" value="EngPaymentTermType"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field></form-single></box-body></container-box></row-col></container-row><subscreens-panel id="BottomPanel" type="tab"/></widgets></screen>
<!-- Screen Location component://Sales/screen/Sales/Order.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Orders" default-menu-index="50" menu-image="/ssstatic/images/Customer.png" default-menu-include="true"><subscreens default-item="FindOrder"/><widgets><subscreens-panel id="order-panel" type="popup"/></widgets></screen>
<!-- Screen Location component://Sales/screen/Sales.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" menu-image="fa fa-flash" menu-image-type="icon"><subscreens default-item="Account"/><widgets><subscreens-panel id="SalesPanel" type="popup"/><render-mode><text type="html,vuet,qvt,qvue"><![CDATA[<script type=text/javascript src="${sri.buildUrl('Scripts/ckeditor.js').url}" /><script src="https://cdnjs.cloudflare.com/ajax/libs/showdown/2.1.0/showdown.min.js" integrity="sha512-LhccdVNGe2QMEfI3x4DVV3ckMRe36TfydKss6mJpdHjNFiV07dFpS2xzeZedptKZrwxfICJpez09iNioiSZ3hA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/turndown/7.1.1/turndown.min.js" integrity="sha512-7f2yNDjY95XObwgNriZ38R/29bcPSuGWkM3NotiI6JeKe/GdBXkjzuYAVnM+yQEtwLbvDYn20fZy8QJ79aSEew==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jsdiff/3.2.0/diff.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>]]></text></render-mode></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Party/FindParty.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="editParty"><default-response url="../EditParty"/></transition><transition name="findOrder"><default-response url="../../Order/FindOrder"/></transition><transition name="createPerson"><service-call name="mantle.party.PartyServices.create#Person" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditParty"/></transition><transition name="createPersonCustomer"><service-call name="mantle.party.PartyServices.create#PersonCustomer" in-map="context + [groupTypeEnumIdList:appUserGroupTypeEnumId]" out-map="context" multi="parameter"/><default-response url="../EditParty"/></transition><transition name="createPersonEmployee"><service-call name="mantle.party.PartyServices.create#PersonEmployee" in-map="context + [groupTypeEnumIdList:appUserGroupTypeEnumId]" out-map="context" multi="parameter"/><default-response url="../EditParty"/></transition><transition name="createOrganization"><service-call name="mantle.party.PartyServices.create#Organization" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditParty"/></transition><transition name="createAccount"><service-call name="mantle.sales.AccountServices.create#Account" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditParty"/></transition><transition name="createContact"><service-call name="mantle.sales.AccountServices.create#Contact" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditParty"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition-include name="getGeoCountryStates" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition-include name="getPartyClassificationList" location="component://SimpleScreens/template/party/PartyTransitions.xml"/><actions><service-call name="mantle.party.PartyServices.search#Party" in-map="context" out-map="context"/></actions><widgets><container-dialog id="CreatePersonDialog" button-text="New Person"><form-single name="CreatePersonForm" transition="createPerson"><field name="roleTypeId"><default-field><hidden/></default-field></field><field name="firstName"><default-field><text-line size="30"/></default-field></field><field name="lastName"><default-field><text-line size="30"/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><container-dialog id="CreatePersonCustDialog" button-text="New Person Customer"><form-single name="CreatePersonCustForm" transition="createPersonCustomer"><field name="roleTypeId"><default-field title="Role"><drop-down no-current-selected-key="Customer"><entity-options key="${roleTypeId}" text="${description}"><entity-find entity-name="mantle.party.RoleType"><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="partyClassificationId"><default-field title="Customer Class"><drop-down allow-empty="true" no-current-selected-key="CustConsumer"><entity-options key="${partyClassificationId}" text="${description}"><entity-find entity-name="mantle.party.PartyClassification"><econdition field-name="classificationTypeEnumId" value="PcltCustomer"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="accountPartyId"><default-field title="Sales Account"><drop-down allow-empty="true"><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="Account"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName,firstName,lastName"/></entity-find></entity-options></drop-down></default-field></field><field name="firstName"><default-field title="" tooltip="First Name"><text-line size="30"/></default-field></field><field name="lastName"><default-field title="" tooltip="Last Name"><text-line size="30"/></default-field></field><field name="emailAddress"><default-field title="Email"><text-line size="40"/></default-field></field><field name="countryCode"><default-field title="" tooltip="Country Code"><label text="+"/><text-line size="3" maxlength="3" default-value="${ec.user.getPreference('TelecomNumber.DefaultCountryCode') ?: '1'}"/></default-field></field><field name="areaCode"><default-field title="" tooltip="Area Code"><label text="-"/><text-line size="3" maxlength="3"/></default-field></field><field name="contactNumber"><default-field title="" tooltip="Phone Number"><label text="-"/><text-line size="8" maxlength="8"/></default-field></field><field name="address1"><default-field title="Address 1"><text-line size="30"/></default-field></field><field name="unitNumber"><default-field title="Unit"><text-line size="10"/></default-field></field><field name="address2"><default-field title="Address 2"><text-line size="30"/></default-field></field><field name="city"><default-field title="" tooltip="City"><text-line size="16"/></default-field></field><field name="countryGeoId"><default-field title=""><drop-down no-current-selected-key="USA"><entity-options key="${geoId}" text="${geoName}"><entity-find entity-name="moqui.basic.Geo" list="geoList"><econdition field-name="geoTypeEnumId" value="GEOT_COUNTRY"/><order-by field-name="geoName"/></entity-find></entity-options></drop-down></default-field></field><field name="stateProvinceGeoId"><default-field title=""><drop-down><dynamic-options transition="getGeoCountryStates" value-field="geoId"><depends-on field="countryGeoId"/></dynamic-options></drop-down></default-field></field><field name="postalCode"><default-field title="" tooltip="Zip/Postal Code"><text-line size="8"/></default-field></field><field name="postalCodeExt"><default-field title="" tooltip="Zip/Postal Code Extension"><text-line size="4"/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field><field-layout><field-ref name="roleTypeId"/><field-ref name="partyClassificationId"/><field-ref name="accountPartyId"/><field-row-big title="Name"><field-ref name="firstName"/><field-ref name="lastName"/></field-row-big><field-ref name="emailAddress"/><field-row-big title="Phone"><field-ref name="countryCode"/><field-ref name="areaCode"/><field-ref name="contactNumber"/></field-row-big><field-row><field-ref name="address1"/><field-ref name="unitNumber"/></field-row><field-ref name="address2"/><field-row-big title="City/Zip"><field-ref name="city"/><field-ref name="postalCode"/><field-ref name="postalCodeExt"/></field-row-big><field-row-big title="Country/State"><field-ref name="countryGeoId"/><field-ref name="stateProvinceGeoId"/></field-row-big><field-ref name="submitButton"/></field-layout></form-single></container-dialog><container-dialog id="CreateEmployeeDialog" button-text="New Employee"><form-single name="CreateEmployeeForm" transition="createPersonEmployee"><field name="pseudoId"><default-field title="ID"><text-line size="15"/></default-field></field><field name="firstName"><default-field><text-line size="20"/></default-field></field><field name="middleName"><default-field><text-line size="10"/></default-field></field><field name="lastName"><default-field><text-line size="20"/></default-field></field><field name="emailAddress"><default-field title="Email"><text-line size="40"/></default-field></field><field name="countryCode"><default-field title="" tooltip="Country Code"><label text="+"/><text-line size="3" maxlength="3" default-value="${ec.user.getPreference('TelecomNumber.DefaultCountryCode') ?: '1'}"/></default-field></field><field name="areaCode"><default-field title="" tooltip="Area Code"><label text="-"/><text-line size="3" maxlength="3"/></default-field></field><field name="contactNumber"><default-field title="" tooltip="Phone Number"><label text="-"/><text-line size="8" maxlength="8"/></default-field></field><field name="employerPartyId"><default-field title="Employer/Branch"><drop-down allow-empty="true"><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" operator="in" value="OrgInternal,OrgEmployer"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName,firstName,lastName"/></entity-find></entity-options></drop-down></default-field></field><field name="userGroupId"><default-field title="User Group"><drop-down allow-empty="true"><entity-options key="${userGroupId}" text="${description}"><entity-find entity-name="moqui.security.UserGroup"><econdition field-name="groupTypeEnumId" from="appUserGroupTypeEnumId"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Add Employee"><submit/></default-field></field><field-layout><field-ref name="pseudoId"/><field-row><field-ref name="firstName"/><field-ref name="middleName"/></field-row><field-ref name="lastName"/><field-ref name="emailAddress"/><field-row-big title="Phone"><field-ref name="countryCode"/><field-ref name="areaCode"/><field-ref name="contactNumber"/></field-row-big><field-ref name="employerPartyId"/><field-ref name="userGroupId"/><field-ref name="submitButton"/></field-layout></form-single></container-dialog><container-dialog id="CreateOrganizationDialog" button-text="New Organization"><form-single name="CreateOrganizationForm" transition="createOrganization"><field name="roleTypeId"><default-field><hidden/></default-field></field><field name="organizationName"><default-field><text-line size="60"/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><container-dialog id="CreateAccountDialog" button-text="New Sales Account (Organization Customer)"><form-single name="CreateAccountForm" transition="createAccount"><field name="organizationName"><default-field><text-line size="60"/></default-field></field><field name="parentAccountPartyId"><default-field title="Parent Sales Account"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2" parameter-map="[roleTypeId:'Account']"/></drop-down></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><container-dialog id="CreateContactDialog" button-text="New Sales Contact"><form-single name="CreateContactForm" transition="createContact"><field name="accountPartyId"><default-field title="Sales Account"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2" parameter-map="[roleTypeId:'Account']"/></drop-down></default-field></field><field name="firstName"><default-field><text-line size="30"/></default-field></field><field name="lastName"><default-field><text-line size="30"/></default-field></field><field name="fromRoleTypeId"><default-field title="Role"><drop-down allow-empty="true"><entity-options key="${roleTypeId}" text="${description}"><entity-find entity-name="mantle.party.RoleGroupMemberAndType" cache="true"><econdition field-name="roleGroupEnumId" value="RgpAccountContact"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><link url="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-query-string-query.html#query-string-syntax" url-type="plain" link-type="anchor" target-window="_blank" text="Search String Reference"/><form-single name="OuterSearchForm" transition="." focus-field="anyField"><field name="anyField"><default-field title="" tooltip="Matches whole words, use the asterisk (*) wildcard to match partial words; use field:term to search a specific field"><text-line size="100"/></default-field></field><field name="submitButton"><default-field title="Search"><submit/></default-field></field><field-layout><field-row-big><field-ref name="anyField"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single><form-list name="PartyListForm" list="documentList" skip-form="true" header-dialog="true" saved-finds="true" show-xlsx-button="true" show-csv-button="true" show-page-size="true"><field name="anyField"><header-field><text-line size="80"/></header-field></field><field name="pseudoId"><header-field title="ID" show-order-by="true"><text-line size="20"/></header-field><default-field><link url="editParty" text="${pseudoId}" link-type="anchor"/></default-field></field><field name="idValue"><header-field title="Other ID"><text-line size="20"/></header-field></field><field name="gatewayCimId"><header-field title="CIM ID"><text-line size="20"/></header-field></field><field name="organizationName"><header-field><text-line size="40"/></header-field></field><field name="firstName"><header-field><text-line size="40"/></header-field></field><field name="lastName"><header-field><text-line size="40"/></header-field></field><field name="combinedName"><header-field title="Name" show-order-by="true"><text-line size="40"/></header-field><default-field><link url="editParty" text="${combinedName}" link-type="anchor"/></default-field></field><field name="username"><header-field show-order-by="true"><text-line size="20"/></header-field><default-field><section-iterate name="UserAccountsSection" list="userAccounts" entry="userAccount"><widgets><container><label style="${userAccount.userDisabled == 'Y' || userAccount.userTerminateDate ? 'text-strong' : ''}" text="${userAccount.username} ${userAccount.userDisabled == 'Y' ? '(disabled)' : ''} ${userAccount.userTerminateDate ? '(terminated ' + ec.l10n.format(new Timestamp(userAccount.userTerminateDate), 'yyyy-MM-dd') + ')' : ''}"/></container></widgets></section-iterate></default-field></field><field name="roleTypeId"><header-field title="Role"><drop-down allow-empty="true"><entity-options key="${roleTypeId}" text="${description}"><entity-find entity-name="mantle.party.RoleType"><order-by field-name="description"/></entity-find></entity-options></drop-down></header-field><default-field><display text="${roles ? roles*.role.join(', ') : ''}"/></default-field></field><field name="classificationTypeEnumId"><header-field title="Class Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="PartyClassificationType"/><set field="allowEmpty" value="true"/></widget-template-include></header-field></field><field name="partyClassificationId"><header-field title="Class"><drop-down allow-empty="true"><dynamic-options transition="getPartyClassificationList" value-field="partyClassificationId" label-field="description"><depends-on field="classificationTypeEnumId"/></dynamic-options></drop-down></header-field><default-field><display text="${classifications ? classifications.findAll({(it.classFromDate == null || it.classFromDate < System.currentTimeMillis()) && (it.classThruDate == null || it.classThruDate > System.currentTimeMillis())})*.class.join(', ') : ''}"/></default-field></field><field name="disabled"><header-field title="Hidden"><drop-down allow-empty="true"><option key="Y"/><option key="N"/></drop-down></header-field><default-field><display/></default-field></field><field name="hasDuplicates"><header-field title="Dups"><drop-down allow-empty="true"><option key="Y"/><option key="N"/></drop-down></header-field><default-field><display/></default-field></field><field name="matches"><default-field><section-iterate name="MatchesSection" list="highlights" key="hlField" entry="hlList"><actions><script><![CDATA[hlFieldDisplay = hlField
                        if (hlFieldDisplay.contains('.')) hlFieldDisplay = hlFieldDisplay.substring(hlFieldDisplay.lastIndexOf('.') + 1)
                        hlFieldDisplay = org.moqui.util.StringUtilities.camelCaseToPretty(hlFieldDisplay)
                        hlListDisplay = hlList.collect({'"' + org.moqui.util.WebUtilities.encodeHtml(it.toString().replace('<em>', '__EMO_').replace('</em>', '__EMC_'))
                                .replace('__EMO_', '<strong>').replace('__EMC_', '</strong>') + '"'})]]></script></actions><widgets><label text="${hlFieldDisplay}: ${hlListDisplay.join(', ')}" type="div" encode="false"/></widgets></section-iterate></default-field></field><field name="infoString"><header-field title="Email"><text-line size="40"/></header-field></field><field name="areaCode"><header-field><text-line size="5"/></header-field></field><field name="contactNumber"><header-field><text-line size="10"/></header-field></field><field name="address1"><header-field><text-line size="40"/></header-field></field><field name="city"><header-field><text-line size="30"/></header-field></field><field name="stateProvinceGeoId"><header-field title="State"><drop-down allow-empty="true"><entity-options key="${toGeoId}" text="${geoName}"><entity-find entity-name="moqui.basic.GeoAssocAndToDetail"><econdition field-name="geoId" value="USA"/><econdition field-name="geoAssocTypeEnumId" value="GAT_REGIONS"/><order-by field-name="geoName"/></entity-find></entity-options></drop-down></header-field></field><field name="postalCode"><header-field><text-line size="10"/></header-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field><default-field><link url="findOrder" text="Sales Orders" parameter-map="[customerPartyId:partyId]" link-type="anchor"/><link url="findOrder" text="Purchase Orders" parameter-map="[vendorPartyId:partyId]" link-type="anchor"/></default-field></field></form-list><container-row><row-col md="2" style="text-right"><label text="Current Search String" type="strong"/></row-col><row-col><label text="${queryString?:'No Current Search'}"/></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Party/PaymentMethod/EditPaymentMethod.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Payment Method" default-menu-index="1"><parameter name="paymentMethodId" required="true"/><parameter name="partyId"/><transition name="editParty"><default-response url="../../EditParty"/></transition><transition name="findPayment"><default-response url="//${appRoot}/Accounting/Payment/FindPayment"/></transition><transition name="storePaymentMethodInfo"><service-call name="mantle.account.PaymentMethodServices.store#PaymentMethodInfo" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updatePaymentMethodMutable"><service-call name="mantle.account.PaymentMethodServices.update#PaymentMethodMutable" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateBankAccountMutable"><service-call name="mantle.account.PaymentMethodServices.update#BankAccountMutable" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="removePaymentMethod"><service-call name="mantle.account.PaymentMethodServices.delete#PaymentMethod" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getGlAccountListPaginated" location="component://SimpleScreens/template/account/AccountTransitions.xml"/><transition-include name="getGeoCountryStates" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition name="createContent"><service-call name="mantle.account.PaymentMethodServices.create#PaymentMethodContent" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateContent"><service-call name="mantle.account.PaymentMethodServices.update#PaymentMethodContent" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="downloadContent" read-only="true"><parameter name="paymentMethodContentId"/><actions><entity-find-one entity-name="mantle.account.method.PaymentMethodContent" value-field="paymentMethodContent"/><script><![CDATA[ec.web.sendResourceResponse(paymentMethodContent.contentLocation)]]></script></actions><default-response type="none"/></transition><pre-actions><if condition="!partyId && paymentMethodId"><entity-find-one entity-name="mantle.account.method.PaymentMethod" value-field="paymentMethod"/><set field="partyId" from="paymentMethod.ownerPartyId"/></if></pre-actions><actions><service-call name="mantle.account.PaymentMethodServices.get#PartyPaymentMethodInfo" in-map="context" out-map="methodInfo"/><set field="methodInfoFlat" from="flattenNestedMap(methodInfo)"/><entity-find entity-name="mantle.party.contact.PartyContactMechPostalAddress" list="partyPostalAddressList"><date-filter/><econdition field-name="partyId"/></entity-find><entity-find entity-name="mantle.party.contact.PartyContactMechTelecomNumber" list="partyTelecomNumberList"><date-filter/><econdition field-name="partyId"/></entity-find><entity-find entity-name="mantle.account.method.PaymentGatewayConfig" list="paymentGatewayConfigList"><econdition field-name="paymentGatewayTypeEnumId" operator="not-equals" value="PgtTest"/><order-by field-name="description"/></entity-find></actions><widgets><link url="editParty" text="Edit Party" parameter-map="[partyId:methodInfoFlat.ownerPartyId]"/><link url="findPayment" text="Payments From" parameter-map="[paymentMethodId:paymentMethodId]"/><link url="findPayment" text="Payments To" parameter-map="[toPaymentMethodId:paymentMethodId]"/><link url="removePaymentMethod" text="Delete (Expire)" confirmation="Delete this Payment Method?" btn-type="danger" parameter-map="[partyId:partyId, paymentMethodId:paymentMethodId]"/><form-single name="PaymentMethodInfoForm" transition="storePaymentMethodInfo" map="methodInfoFlat" extends="component://SimpleScreens/template/party/PartyForms.xml#PaymentMethodInfo"/><section name="ContentSection"><actions><entity-find entity-name="mantle.account.method.PaymentMethodContent" list="contentList"><econdition field-name="paymentMethodId"/><order-by field-name="-contentDate"/></entity-find></actions><widgets><container-box><box-header title="Content"/><box-toolbar><container-dialog id="NewContentDialog" button-text="Add Content"><form-single name="NewContentForm" transition="createContent"><field name="paymentMethodId"><default-field><hidden/></default-field></field><field name="contentTypeEnumId"><default-field title="Content Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="PaymentMethodContentType"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="contentFile"><default-field><file/></default-field></field><field name="description"><default-field><text-line size="60"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><section-iterate name="ContentIterateSection" list="contentList" entry="content"><actions><entity-find-one entity-name="mantle.party.PersonWithUserAccount" value-field="paua"><field-map field-name="userId" from="content.userId"/></entity-find-one><entity-find-one entity-name="moqui.basic.Enumeration" value-field="contentTypeEnum"><field-map field-name="enumId" from="content.contentTypeEnumId"/></entity-find-one></actions><widgets><container><container><label text="${contentTypeEnum?.description?:'No Type'}" type="strong"/></container><link url="downloadContent" condition="content.contentLocation" parameter-map="[paymentMethodContentId:content.paymentMethodContentId]" text="Download ${content.contentLocation.substring(content.contentLocation.lastIndexOf('/')+1)}"/><container-dialog id="UpdateContentContainer" button-text="Edit Content"><form-single name="UpdateContentForm" transition="updateContent" map="content"><field name="paymentMethodContentId"><default-field><hidden/></default-field></field><field name="paymentMethodId"><default-field><hidden/></default-field></field><field name="contentTypeEnumId"><default-field title="Content Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="PaymentMethodContentType"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="contentFile"><default-field><file/></default-field></field><field name="description"><default-field><text-line size="60"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></container-dialog><container><label text="By ${ec.resource.expand('UsernameTemplate','',paua+[userId:content.userId])} at ${ec.l10n.format(content.contentDate, 'yyyy-MM-dd HH:mm')}" condition="paua"/></container><label text="${content.description ?: 'No Description'}" type="p"/></container></widgets></section-iterate></box-body></container-box></widgets></section><section name="PaymentMethodDetailForms" condition="methodInfo.isBankAccount"><widgets><label text="Bank Account Details" type="h4"/><form-single name="UpdateBankAccountMutable" transition="updateBankAccountMutable" map="methodInfoFlat"><field name="paymentMethodId"><default-field><hidden/></default-field></field><field name="description"><default-field><text-line size="50"/></default-field></field><field name="lastCheckNumber"><default-field><text-line size="15" format="#"/></default-field></field><field name="glAccountId"><default-field title="GL Account"><drop-down allow-empty="true"><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0"/></drop-down></default-field></field><field name="purposeEnumId"><default-field title="Purpose"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="PaymentMethodPurpose"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="ledgerBalance"><default-field><text-line size="10"/></default-field></field><field name="availableBalance"><default-field><text-line size="10"/></default-field></field><field name="balanceDate"><default-field><date-time/></default-field></field><field name="posPayNote"><default-field title=""><label text="Pos. Pay fields for Positive Pay export"/></default-field></field><field name="posPayBankNumber"><default-field title="Pos. Pay Bank Number" tooltip="Required for some Positive Pay exports"><text-line size="10"/></default-field></field><field name="posPayFormatEnumId"><default-field title="Pos. Pay File Format"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="PaymentMethodFileType"/><set field="parentEnumId" value="PmftPositivePay"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="nachaNote"><default-field title=""><label text="NACHA fields for ACH (NACHA) export"/></default-field></field><field name="nachaImmedDest"><default-field title="*NACHA Immed. Destination ID" tooltip="Required for NACHA; 9 digits; usually routing/transit number"><text-line size="9" maxlength="10"/></default-field></field><field name="nachaImmedDestName"><default-field title="NACHA Immed. Dest. Name" tooltip="Defaults to Bank Name, max 23 characters"><text-line size="23" maxlength="23"/></default-field></field><field name="nachaImmedOrig"><default-field title="*NACHA Immed. Origin ID" tooltip="Required for NACHA; 9 digits; source/origin ID"><text-line size="9" maxlength="10"/></default-field></field><field name="nachaImmedOrigName"><default-field title="NACHA Immed. Origin Name" tooltip="Defaults to Company Name On Account, max 23 characters"><text-line size="23" maxlength="23"/></default-field></field><field name="nachaCompanyId"><default-field title="*NACHA Company ID" tooltip="Required for NACHA; max 10 digits; bank-assigned Company ID"><text-line size="10" maxlength="10"/></default-field></field><field name="nachaCompanyName"><default-field title="NACHA Company Name" tooltip="Defaults to Company Name On Account, max 16 characters"><text-line size="16" maxlength="16"/></default-field></field><field name="nachaOdfiId"><default-field title="NACHA Orig. DFI ID" tooltip="Defaults to first 8 digits of Immed. Destination ID"><text-line size="10" maxlength="10"/></default-field></field><field name="nachaDiscrData"><default-field title="NACHA Discr. Data" tooltip="Optional, max 20 characters"><text-line size="20" maxlength="20"/></default-field></field><field name="nachaEntryDescription"><default-field title="NACHA Entry Description" tooltip="Required for NACHA"><text-line size="10" maxlength="10"/></default-field></field><field name="fedNachaInfo"><default-field><label text="Sending direct to <strong>Federal Reserve</strong>? Set <strong>Add New Line</strong> to <em>No</em>, and <strong>Add Offset Record</strong> to <em>Yes</em>." encode="false"/></default-field></field><field name="nachaAddNewLine"><default-field tooltip="Add a new line (line feed) character after each 94 character record, use No for Federal Reserve direct submit"><radio no-current-selected-key="Y"><option key="N" text="No"/><option key="Y" text="Yes"/></radio></default-field></field><field name="nachaAddOffsetRecord"><default-field tooltip="Add offset record to create a balanced NACHA file, use Yes for Federal Reserve direct submit"><radio no-current-selected-key="N"><option key="N" text="No"/><option key="Y" text="Yes"/></radio></default-field></field><field name="gatewayCimId"><default-field title="Gateway CIM ID"><text-line size="20"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></widgets><fail-widgets><label text="Payment Method Details" type="h4"/><form-single name="UpdatePaymentMethodMutable" transition="updatePaymentMethodMutable" map="methodInfoFlat"><field name="paymentMethodId"><default-field><hidden/></default-field></field><field name="description"><default-field><text-line size="50"/></default-field></field><field name="gatewayCimId"><default-field title="Gateway CIM ID"><text-line size="20"/></default-field></field><field name="glAccountId"><default-field title="GL Account"><drop-down allow-empty="true"><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0"/></drop-down></default-field></field><field name="purposeEnumId"><default-field title="Purpose"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="PaymentMethodPurpose"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="ledgerBalance"><default-field><text-line size="10"/></default-field></field><field name="availableBalance"><default-field><text-line size="10"/></default-field></field><field name="balanceDate"><default-field><date-time/></default-field></field><field name="thruDateSetAuto"><default-field title="Auto Delete" tooltip="If Yes auto delete when there are no more active Payments"><radio no-current-selected-key="N"><option key="N" text="No"/><option key="Y" text="Yes"/></radio></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></fail-widgets></section></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Party/PaymentMethod/PaymentMethodTrans/CreatePayment.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="partyId" required="true"/><parameter name="paymentMethodId" required="true"/><parameter name="fitId" required="true"/><transition name="createPayment"><service-call name="mantle.account.ReconciliationServices.create#TransPayment" in-map="true" out-map="context" multi="parameter"/><default-response url=".."/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><actions><entity-find-one entity-name="mantle.account.method.PaymentMethod" value-field="paymentMethod"/><entity-find-one entity-name="mantle.account.method.PaymentMethodTrans" value-field="paymentMethodTrans"/><set field="instrumentByTransType" from="[PMTT_CHECK:'PiCompanyCheck', PMTT_PAYMENT:'PiAch', PMTT_OTHER:'PiOther']"/></actions><widgets><label text="Name: ${paymentMethodTrans.transName}" type="p" condition="paymentMethodTrans.transName"/><label text="Memo: ${paymentMethodTrans.transMemo}" type="p" condition="paymentMethodTrans.transMemo"/><label text="Ref: ${paymentMethodTrans.refNumber}" type="p" condition="paymentMethodTrans.refNumber"/><form-single name="CreatePaymentForm" transition="createPayment"><field name="partyId"><default-field><hidden/></default-field></field><field name="paymentMethodId"><default-field><hidden/></default-field></field><field name="fitId"><default-field><hidden/></default-field></field><field name="pageIndex"><default-field><hidden/></default-field></field><field name="fromPartyId" from="paymentMethodTrans.transAmount < 0.0 ? paymentMethod.ownerPartyId : null"><conditional-field title="From" condition="paymentMethodTrans.transAmount < 0.0"><drop-down><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="partyId" from="activeOrgId" ignore="!activeOrgId"/><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></conditional-field><default-field title="From"><drop-down><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="toPartyId" from="paymentMethodTrans.transAmount >= 0.0 ? paymentMethod.ownerPartyId : null"><conditional-field title="To" condition="paymentMethodTrans.transAmount >= 0.0"><drop-down><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="partyId" from="activeOrgId" ignore="!activeOrgId"/><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></conditional-field><default-field title="To"><drop-down><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="paymentInstrumentEnumId" from="instrumentByTransType.get(paymentMethodTrans.transType) ?: 'PiOther'"><default-field title="Instrument"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="PaymentInstrument"/></widget-template-include></default-field></field><field name="paymentTypeEnumId"><default-field title="Payment Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="PaymentType"/><set field="noCurrentSelectedKey" value="PtInvoicePayment"/></widget-template-include></default-field></field><field name="statusId"><default-field title="Status"><drop-down no-current-selected-key="PmntDelivered"><option key="PmntProposed" text="Proposed"/><option key="PmntPromised" text="Promised"/><option key="PmntAuthorized" text="Authorized"/><option key="PmntDelivered" text="Delivered"/></drop-down></default-field></field><field name="amount" from="paymentMethodTrans.transAmount?.abs()"><default-field><text-line size="12" format="#,##0.00"/></default-field></field><field name="amountUomId" from="paymentMethod.currencyUomId"><default-field title="Currency"><display-entity entity-name="moqui.basic.Uom"/></default-field></field><field name="effectiveDate" from="paymentMethodTrans.postedDate"><default-field><date-time/></default-field></field><field name="submitButton"><default-field title="Create Payment"><submit/></default-field></field></form-single></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Party/PaymentMethod/PaymentMethodTrans.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Transactions" default-menu-index="2"><parameter name="paymentMethodId" required="true"/><transition name="findPayment"><default-response url="//${appRoot}/Accounting/Payment/FindPayment"/></transition><transition name="editPayment"><default-response url="//${appRoot}/Accounting/Payment/EditPayment"/></transition><transition name="editTransaction"><default-response url="//${appRoot}/Accounting/Transaction/EditTransaction"/></transition><transition name="findTransactionEntry"><default-response url="//${appRoot}/Accounting/Transaction/FindTransactionEntry"/></transition><transition name="createPaymentMethodTrans"><service-call name="mantle.account.ReconciliationServices.create#PaymentMethodTrans" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updatePaymentMethodTrans"><service-call name="mantle.account.ReconciliationServices.update#PaymentMethodTrans" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="matchReconcile"><service-call name="mantle.account.ReconciliationServices.match#PaymentMethodTransUnmatched" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="reconcile"><service-call name="mantle.account.ReconciliationServices.reconcile#PaymentMethodTrans" in-map="true" out-map="context" multi="parameter"/><default-response url="." parameter-map="ec.web.requestParameters + [fitId:null, paymentId:null, acctgTransId:null, moquiFormName:null]"/></transition><transition name="unreconcile"><service-call name="mantle.account.ReconciliationServices.unreconcile#PaymentMethodTrans" in-map="true" out-map="context" multi="parameter"/><default-response url="." parameter-map="ec.web.requestParameters + [fitId:null, submitButton:null]"/></transition><transition name="noReconcile"><service-call name="mantle.account.ReconciliationServices.noReconcile#PaymentMethodTrans" in-map="true" out-map="context" multi="parameter"/><default-response url="." parameter-map="ec.web.requestParameters + [fitId:null, moquiFormName:null, submitButton:null]"/></transition><transition name="uploadOfxVersion1"><service-call name="mantle.account.OfxServices.upload#OfxVersion1" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="uploadBaiVersion2"><service-call name="mantle.account.BaiServices.upload#BaiVersion2" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><entity-find-one entity-name="mantle.party.PartyRole" value-field="ownerOrgRole"><field-map field-name="partyId" from="paymentMethod?.ownerPartyId"/><field-map field-name="roleTypeId" value="OrgInternal"/></entity-find-one><if condition="ownerOrgRole == null"><return error="true" message="Transactions only available for payment methods owned by an Internal Organization"/></if></actions><widgets><container-dialog id="AddTransDialog" button-text="Add Transaction"><form-single name="AddTransForm" transition="createPaymentMethodTrans"><field name="partyId"><default-field><hidden/></default-field></field><field name="paymentMethodId"><default-field><hidden/></default-field></field><field name="fitId"><default-field title="FIT ID"><text-line size="15"/></default-field></field><field name="transType"><default-field><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="PaymentMethodTransType"/><set field="noCurrentSelectedKey" value="PMTT_DEBIT"/></widget-template-include></default-field></field><field name="transName"><default-field><text-line size="40"/></default-field></field><field name="transMemo"><default-field><text-line size="40"/></default-field></field><field name="postedDate"><default-field><date-time/></default-field></field><field name="transAmount"><default-field><text-line size="12"/></default-field></field><field name="checkNumber"><default-field><text-line size="15"/></default-field></field><field name="refNumber"><default-field><text-line size="15"/></default-field></field><field name="paymentId"><default-field><text-line size="15"/></default-field></field><field name="acctgTransId"><default-field title="GL Trans ID"><text-line size="15"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog><container-dialog id="UploadOfxV1Dialog" button-text="Upload OFX V1 (or QFX)"><form-single name="UploadOfxV1Form" transition="uploadOfxVersion1"><field name="partyId"><default-field><hidden/></default-field></field><field name="paymentMethodId"><default-field><hidden/></default-field></field><field name="ofxFile"><default-field><file/></default-field></field><field name="submitButton"><default-field title="Upload"><submit/></default-field></field></form-single></container-dialog><container-dialog id="UploadBaiV2Dialog" button-text="Upload BAI V2"><form-single name="UploadBaiV2Form" transition="uploadBaiVersion2"><field name="partyId"><default-field><hidden/></default-field></field><field name="paymentMethodId"><default-field><hidden/></default-field></field><field name="baiFile"><default-field><file/></default-field></field><field name="submitButton"><default-field title="Upload"><submit/></default-field></field></form-single></container-dialog><container-dialog id="AutoMatchReconcileDialog" button-text="Auto Match and Reconcile"><form-single name="AutoMatchReconcileForm" transition="matchReconcile"><field name="partyId"><default-field><hidden/></default-field></field><field name="paymentMethodId"><default-field><hidden/></default-field></field><field name="lookBackDays"><default-field><text-line size="4" default-value="7"/></default-field></field><field name="submitButton"><default-field title="Match and Reconcile"><submit/></default-field></field><field-layout><field-row-big><field-ref name="lookBackDays"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single></container-dialog><link url="findPayment" text="Payments From" parameter-map="[paymentMethodId:paymentMethodId]"/><link url="findPayment" text="Payments To" parameter-map="[toPaymentMethodId:paymentMethodId]"/><link url="findPayment" text="Payments Not Rec" parameter-map="[eitherPaymentMethodId:paymentMethodId,                 onlyNotRec:'Y', statusId:'PmntDelivered,PmntConfirmed', statusId_op:'in']"/><link url="findTransactionEntry" text="GL Trans Not Rec" condition="paymentMethod?.glAccountId" parameter-map="[glAccountId:paymentMethod?.glAccountId, onlyNotRec:'Y']"/><form-list name="TransList" list="transList" transition="updatePaymentMethodTrans" skip-form="true" header-dialog="true" saved-finds="true" select-columns="true" show-csv-button="true" show-xlsx-button="true"><entity-find entity-name="mantle.account.method.PaymentMethodTrans" list="transList"><search-form-inputs default-order-by="-postedDate,-fitId"/><econdition field-name="paymentMethodId"/><econdition field-name="paymentId" operator="is-null" ignore="onlyNotRec != 'true'"/><econdition field-name="acctgTransId" operator="is-null" ignore="onlyNotRec != 'true'"/><econdition field-name="noReconcile" value="N" or-null="true" ignore="onlyNotRec != 'true'"/><select-field field-name="paymentMethodId,fitId,paymentId,acctgTransId,acctgTransEntrySeqId,noReconcile"/></entity-find><row-actions><entity-find-one entity-name="moqui.basic.Enumeration" value-field="transTypeEnum"><field-map field-name="enumId" from="transType"/></entity-find-one><if condition="paymentId"><entity-find-one entity-name="mantle.account.payment.Payment" value-field="payment"/><if condition="payment.fromPartyId != paymentMethod.ownerPartyId"><entity-find-one entity-name="mantle.party.PartyDetail" value-field="pmtFromParty"><field-map field-name="partyId" from="payment.fromPartyId"/></entity-find-one></if><if condition="payment.toPartyId != paymentMethod.ownerPartyId"><entity-find-one entity-name="mantle.party.PartyDetail" value-field="pmtToParty"><field-map field-name="partyId" from="payment.toPartyId"/></entity-find-one></if></if><if condition="acctgTransId"><entity-find-one entity-name="mantle.ledger.transaction.AcctgTrans" value-field="acctgTrans"/><entity-find-one entity-name="mantle.ledger.transaction.AcctgTransEntry" value-field="acctgTransEntry"/><if condition="acctgTrans.otherPartyId != paymentMethod.ownerPartyId"><entity-find-one entity-name="mantle.party.PartyDetail" value-field="atxOtherParty"><field-map field-name="partyId" from="acctgTrans.otherPartyId"/></entity-find-one></if></if></row-actions><hidden-parameters><parameter name="partyId"/><parameter name="paymentMethodId"/></hidden-parameters><field name="onlyNotRec"><header-field><radio no-current-selected-key="false"><option key="true" text="Y"/><option key="false" text="N"/></radio></header-field></field><field name="postedDate"><header-field show-order-by="true"><date-period/></header-field><default-field container-style="text-strong"><display format="yyyy-MM-dd"/></default-field></field><field name="paymentDate" from="payment?.effectiveDate"><default-field><display format="yyyy-MM-dd"/></default-field></field><field name="glTransDate" from="acctgTrans?.transactionDate"><default-field title="GL Trans Date"><display format="yyyy-MM-dd"/></default-field></field><field name="transAmount"><header-field><range-find/></header-field><default-field><display currency-unit-field="paymentMethod.currencyUomId" style="text-strong"/></default-field></field><field name="paymentAmount" from="payment?.amount"><default-field><display currency-unit-field="payment?.amountUomId" style="${payment?.amount == transAmount?.abs() ? 'text-success' : 'text-danger'}"/></default-field></field><field name="glTransAmount" from="acctgTransEntry?.amount"><default-field title="GL Trans Amount"><display currency-unit-field="acctgTrans?.amountUomId" style="${acctgTransEntry?.amount == transAmount?.abs() ? 'text-success' : 'text-danger'}"/></default-field></field><field name="fitId"><header-field title="FIT ID" show-order-by="true"><text-find size="10" hide-options="true"/></header-field><default-field><display/></default-field></field><field name="transType"><header-field show-order-by="true"><text-find size="8" hide-options="true"/></header-field><default-field><display text="${transTypeEnum?.description ?: transType}"/></default-field></field><field name="checkNumber"><header-field show-order-by="true"><text-find size="10" hide-options="true"/></header-field><default-field><display/></default-field></field><field name="refNumber"><header-field show-order-by="true"><text-find size="10" hide-options="true"/></header-field><default-field><display/></default-field></field><field name="paymentRefNum" from="payment?.paymentRefNum"><default-field><display style="${payment?.paymentRefNum == checkNumber || payment?.paymentRefNum == refNumber ? 'text-success' : 'text-error'}"/></default-field></field><field name="transName"><header-field show-order-by="true"><text-find size="20" hide-options="true"/></header-field><default-field><display/></default-field></field><field name="transMemo"><header-field show-order-by="true"><text-find size="20" hide-options="true"/></header-field><default-field><display/></default-field></field><field name="paymentInfo"><default-field><link url="editPayment" text="Payment ${paymentId} ${payment.status?.description}" link-type="anchor" condition="payment" style="${payment.statusId in ['PmntDelivered', 'PmntConfirmed'] ? '' : 'text-danger'}"/><label text="From ${ec.resource.expand('PartyNameTemplate', null, pmtFromParty)}" condition="pmtFromParty"/><label text="To ${ec.resource.expand('PartyNameTemplate', null, pmtToParty)}" condition="pmtToParty"/><label text="No Rec" condition="noReconcile == 'Y'"/></default-field></field><field name="acctgTransInfo"><default-field title="GL Trans Info"><link url="editTransaction" text="GL Trans ${acctgTransId}:${acctgTransEntrySeqId}" link-type="anchor" condition="acctgTransId"/><label text="PartyNameTemplate" text-map="atxOtherParty" condition="atxOtherParty"/></default-field></field><field name="transActions"><default-field title=""><dynamic-dialog id="CreatePmtDialog" button-text="New Payment" transition="CreatePayment" parameter-map="[paymentMethodId:paymentMethodId, fitId:fitId, pageIndex:pageIndex]" condition="!(paymentId || acctgTransId || noReconcile == 'Y')"/><container-dialog id="ManRecDialog" button-text="Manual Rec" title="Manual Reconcile" condition="(!paymentId || !acctgTransId) && noReconcile != 'Y'"><label text="Name: ${transName}" type="p" condition="transName"/><label text="Memo: ${transMemo}" type="p" condition="transMemo"/><label text="Ref: ${refNumber}" type="p" condition="refNumber"/><label text="If Payment and GL Trans are associated you can enter one or the other" type="p" style="text-info"/><form-single name="ManRecForm" transition="reconcile" pass-through-parameters="true"><field name="partyId"><default-field><hidden/></default-field></field><field name="paymentMethodId"><default-field><hidden/></default-field></field><field name="fitId"><default-field><hidden/></default-field></field><field name="pageIndex"><default-field><hidden/></default-field></field><field name="paymentId"><default-field><text-line size="20"/></default-field></field><field name="acctgTransId"><default-field title="GL Trans ID"><text-line size="20"/></default-field></field><field name="submitButton"><default-field title="Reconcile"><submit/></default-field></field></form-single></container-dialog><link url="noReconcile" text="No Rec" parameter-map="ec.web.requestParameters + [fitId:fitId, pageIndex:pageIndex]" condition="!(paymentId || acctgTransId || noReconcile == 'Y')"/><link url="unreconcile" text="Unrec" parameter-map="ec.web.requestParameters + [fitId:fitId, pageIndex:pageIndex]" condition="paymentId || acctgTransId || noReconcile == 'Y'"/></default-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field></field><form-list-column><field-ref name="postedDate"/><field-ref name="paymentDate"/><field-ref name="glTransDate"/></form-list-column><form-list-column><field-ref name="transAmount"/><field-ref name="paymentAmount"/><field-ref name="glTransAmount"/></form-list-column><form-list-column><field-ref name="fitId"/><field-ref name="transType"/></form-list-column><form-list-column><field-ref name="checkNumber"/><field-ref name="refNumber"/><field-ref name="paymentRefNum"/></form-list-column><form-list-column><field-ref name="transName"/><field-ref name="transMemo"/></form-list-column><form-list-column><field-ref name="paymentInfo"/><field-ref name="acctgTransInfo"/></form-list-column><form-list-column><field-ref name="transActions"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Party/PaymentMethod/PaymentMethodChecks.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Checks" default-menu-index="3"><parameter name="paymentMethodId" required="true"/><transition name="editPayment"><default-response url="//${appRoot}/Accounting/Payment/EditPayment"/></transition><actions><entity-find entity-name="mantle.account.method.BankAccountCheckAndPayment" list="checkList"><search-form-inputs/><econdition field-name="paymentMethodId"/></entity-find><entity-find-one entity-name="mantle.party.PartyRole" value-field="ownerOrgRole"><field-map field-name="partyId" from="paymentMethod?.ownerPartyId"/><field-map field-name="roleTypeId" value="OrgInternal"/></entity-find-one><if condition="ownerOrgRole == null"><return error="true" message="Checks only available for payment methods owned by an Internal Organization"/></if></actions><widgets><form-list name="CheckList" list="checkList" skip-form="true" header-dialog="true" saved-finds="true"><field name="checkNumber"><header-field show-order-by="true"><range-find size="10"/></header-field><default-field><display format="#"/></default-field></field><field name="paymentId"><header-field show-order-by="true"><text-find size="10" hide-options="true"/></header-field><default-field><link url="editPayment" text="${paymentId}" link-type="anchor"/></default-field></field><field name="paymentTypeEnumId"><header-field show-order-by="true" title="Payment Type"/><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="paymentRefNum"><header-field show-order-by="true"><text-find size="10" hide-options="true"/></header-field><default-field><display/></default-field></field><field name="toPartyId"><header-field title="To Party" show-order-by="true"/><default-field><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameTemplate"/></default-field></field><field name="effectiveDate"><header-field><date-period allow-empty="true"/></header-field><default-field><display/></default-field></field><field name="amount"><header-field><range-find size="10"/></header-field><default-field><display currency-unit-field="amountUomId"/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Party/PaymentMethod/PaymentMethodFiles.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Files" default-menu-index="4"><parameter name="paymentMethodId" required="true"/><parameter name="paymentMethodFileId"/><transition name="findPayment"><default-response url="//${appRoot}/Accounting/Payment/FindPayment"/></transition><transition name="generateNachaFile"><service-call name="mantle.account.NachaServices.generate#NachaFile" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="generatePosPayFile"><service-call name="mantle.account.PositivePayServices.generate#PositivePayFile" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="sendSystemMessage"><service-call name="mantle.account.PaymentMethodServices.produce#PaymentMethodFileSystemMessage" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="cancelFile"><service-call name="mantle.account.PaymentMethodServices.cancel#PaymentMethodFile" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="downloadFileText" read-only="true"><parameter name="paymentMethodFileId"/><actions><entity-find-one entity-name="mantle.account.method.PaymentMethodFile" value-field="paymentMethodFile"/><script><![CDATA[ec.web.sendTextResponse(paymentMethodFile.fileText, "text/plain", "PaymentFile${paymentMethodFileId}.txt")]]></script></actions><default-response type="none"/></transition><actions><entity-find-one entity-name="mantle.account.method.BankAccount" value-field="bankAccount"/><entity-find entity-name="mantle.account.method.PaymentMethodFileType" list="allMethodFileTypeList"><econdition field-name="paymentMethodId"/></entity-find><entity-find-one entity-name="mantle.party.PartyRole" value-field="ownerOrgRole"><field-map field-name="partyId" from="paymentMethod?.ownerPartyId"/><field-map field-name="roleTypeId" value="OrgInternal"/></entity-find-one><if condition="ownerOrgRole == null"><return error="true" message="Files only available for payment methods owned by an Internal Organization"/></if></actions><widgets><section name="GenerateNachaSection" condition="bankAccount?.nachaImmedDest"><widgets><container-dialog id="GenerateNachaFileDialog" button-text="Generate NACHA File"><form-single name="GenerateNachaFile" transition="generateNachaFile"><field name="paymentMethodId"><default-field><hidden/></default-field></field><field name="fromDate"><default-field><date-time/></default-field></field><field name="thruDate"><default-field><date-time/></default-field></field><field name="fileDate" from="ec.user.nowTimestamp"><default-field><date-time/></default-field></field><field name="effectiveEntryDate"><default-field tooltip="Transaction settle/post date. Defaults to next week day after File Date."><date-time type="date"/></default-field></field><field name="nachaEntryDescription" from="bankAccount.nachaEntryDescription"><default-field title="NACHA Entry Description"><text-line size="10" maxlength="10"/></default-field></field><field name="submitButton"><default-field title="Generate"><submit/></default-field></field></form-single></container-dialog></widgets></section><section name="GeneratePosPaySection" condition="bankAccount?.posPayFormatEnumId"><widgets><container-dialog id="GeneratePosPayFileDialog" button-text="Generate Pos. Pay File"><form-single name="GeneratePosPayFile" transition="generatePosPayFile"><field name="paymentMethodId"><default-field><hidden/></default-field></field><field name="fromDate"><default-field><date-time/></default-field></field><field name="thruDate"><default-field><date-time/></default-field></field><field name="fileDate" from="ec.user.nowTimestamp"><default-field><date-time/></default-field></field><field name="submitButton"><default-field title="Generate"><submit/></default-field></field></form-single></container-dialog></widgets></section><form-list name="FileList" list="fileList" skip-form="true" header-dialog="true" saved-finds="true"><entity-find entity-name="mantle.account.method.PaymentMethodFile" list="fileList"><search-form-inputs default-order-by="-fileDate"/><econdition field-name="paymentMethodId"/></entity-find><row-actions><set field="methodFileType" from="allMethodFileTypeList.find({ it.fileTypeEnumId == fileTypeEnumId })"/><set field="canSendSystemMessage" from="methodFileType?.systemMessageTypeId && methodFileType?.systemMessageRemoteId"/><if condition="canSendSystemMessage"><entity-find entity-name="moqui.service.message.SystemMessage" list="existingMessageList"><econdition field-name="paymentMethodFileId"/><econdition field-name="systemMessageTypeId" from="methodFileType.systemMessageTypeId"/><econdition field-name="systemMessageRemoteId" from="methodFileType.systemMessageRemoteId"/><select-field field-name="systemMessageId,statusId"/></entity-find><if condition="existingMessageList.size() > 0"><set field="canSendSystemMessage" from="false"/></if></if></row-actions><hidden-parameters><parameter name="paymentMethodId"/></hidden-parameters><field name="paymentMethodFileId"><header-field show-order-by="true" title="File ID"><text-find size="20" hide-options="true" default-operator="begins"/></header-field><default-field><display/></default-field></field><field name="fileTypeEnumId"><header-field show-order-by="true" title="File Type"/><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="fileDate"><header-field show-order-by="true"><date-period allow-empty="true"/></header-field><default-field><display/></default-field></field><field name="entryCount"><header-field show-order-by="true"/><default-field><display/></default-field></field><field name="debitAmountTotal"><header-field show-order-by="true"><range-find size="10"/></header-field><default-field><display format="#,##0.00"/></default-field></field><field name="creditAmountTotal"><header-field show-order-by="true"><range-find size="10"/></header-field><default-field><display format="#,##0.00"/></default-field></field><field name="paymentsButton"><default-field title=""><link url="findPayment" text="Payments" parameter-map="[paymentMethodFileId:paymentMethodFileId]"/></default-field></field><field name="isCancelled"><conditional-field condition="isCancelled != 'Y'"><link url="cancelFile" text="Cancel" parameter-map="[paymentMethodFileId:paymentMethodFileId, partyId:partyId]" confirmation="Remove all payments from this file and cancel?" btn-type="danger"/></conditional-field><default-field title=""><display text="Cancelled"/></default-field></field><field name="messages"><conditional-field condition="canSendSystemMessage && isCancelled != 'Y'"><link url="sendSystemMessage" text="Send to Bank" parameter-map="[paymentMethodFileId:paymentMethodFileId]"/></conditional-field><conditional-field condition="existingMessageList"><label text="${existingMessageList.collect({it.systemMessageId + ' ' + it.statusId?.substring(4)}).join(', ')}"/></conditional-field></field><field name="downloadButton"><header-field title="Find"><submit/></header-field><default-field title=""><link url="downloadFileText" text="Download File ${paymentMethodFileId}"/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Party/PaymentMethod/PaymentGatewayResponses.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Gateway Responses" default-menu-index="5"><parameter name="paymentMethodId" required="true"/><transition name="editPayment"><default-response url="//${appRoot}/Accounting/Payment/EditPayment"/></transition><actions><entity-find entity-name="mantle.account.method.PaymentGatewayResponse" list="gatewayResponseList"><search-form-inputs default-order-by="-transactionDate"/><econdition field-name="paymentMethodId"/></entity-find></actions><widgets><form-list name="GatewayResponseList" list="gatewayResponseList" skip-form="true" header-dialog="true" show-csv-button="true"><field name="paymentMethodId"><header-field><hidden/></header-field></field><field name="partyId"><header-field><hidden/></header-field></field><field name="paymentGatewayConfigId"><default-field title="Gateway Config"><display-entity entity-name="mantle.account.method.PaymentGatewayConfig" text="${description}"/></default-field></field><field name="paymentOperationEnumId"><header-field title="Operation"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="PaymentOperation"/><set field="allowEmpty" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="amount"><header-field show-order-by="true"/><default-field><display currency-unit-field="amountUomId"/></default-field></field><field name="transactionDate"><header-field title="TX Date" show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="referenceNum"><header-field title="Ref Num" show-order-by="true"><text-find size="20" hide-options="true"/></header-field><default-field><display/></default-field></field><field name="approvalCode"><header-field title="Approval Code" show-order-by="true"><text-find size="20" hide-options="true"/></header-field><default-field><display/></default-field></field><field name="responseCode"><header-field title="Response Code" show-order-by="true"><text-find size="10" hide-options="true"/></header-field><default-field><display/></default-field></field><field name="reasonCode"><header-field title="Reason Code" show-order-by="true"><text-find size="10" hide-options="true"/></header-field><default-field tooltip="${reasonMessage}"><display/></default-field></field><field name="reasonMessage"><default-field title="Message"><display/></default-field></field><field name="resultSuccess"><header-field title="Success"><drop-down allow-empty="true"><option key="Y"/><option key="N"/></drop-down></header-field><default-field><display/></default-field></field><field name="resultDeclined"><header-field title="Declined"><drop-down allow-empty="true"><option key="Y"/><option key="N"/></drop-down></header-field><default-field><display/></default-field></field><field name="resultError"><header-field title="Error"><drop-down allow-empty="true"><option key="Y"/><option key="N"/></drop-down></header-field><default-field><display/></default-field></field><field name="avsResult"><default-field title="AVS"><display/></default-field></field><field name="cvResult"><default-field title="CV"><display/></default-field></field><field name="resultNsf"><header-field title="NSF"><drop-down allow-empty="true"><option key="Y"/><option key="N"/></drop-down></header-field><default-field><display/></default-field></field><field name="resultBadExpire"><header-field title="Expired"><drop-down allow-empty="true"><option key="Y"/><option key="N"/></drop-down></header-field><default-field><display/></default-field></field><field name="resultBadCardNumber"><header-field title="Bad#"><drop-down allow-empty="true"><option key="Y"/><option key="N"/></drop-down></header-field><default-field><display/></default-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field></field><form-list-column><field-ref name="transactionDate"/><field-ref name="amount"/><field-ref name="referenceNum"/></form-list-column><form-list-column><field-ref name="paymentGatewayConfigId"/><field-ref name="paymentOperationEnumId"/></form-list-column><form-list-column><field-ref name="approvalCode"/><field-ref name="responseCode"/><field-ref name="reasonCode"/></form-list-column><form-list-column><field-ref name="reasonMessage"/></form-list-column><form-list-column><field-ref name="resultSuccess"/><field-ref name="resultDeclined"/><field-ref name="resultError"/></form-list-column><form-list-column><field-ref name="avsResult"/><field-ref name="cvResult"/></form-list-column><form-list-column><field-ref name="resultNsf"/><field-ref name="resultBadExpire"/><field-ref name="resultBadCardNumber"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Party/PaymentMethod.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><parameter name="paymentMethodId" required="true"/><parameter name="partyId"/><always-actions><entity-find-one entity-name="mantle.account.method.PaymentMethod" value-field="paymentMethod"/><set field="partyId" from="paymentMethod?.ownerPartyId"/></always-actions><subscreens default-item="EditPaymentMethod"/><widgets><subscreens-panel id="PaymentMethodPanel" type="tab"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Party/EditParty/ExpiredContactOther.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="partyId" required="true"/><transition name="unremoveContactInfo"><service-call name="mantle.party.ContactServices.undelete#PartyContactMech" in-map="true" out-map="context" multi="parameter"/><default-response url=".."/></transition><widgets><form-list name="PcmListForm" list="pcmList" skip-form="true"><entity-find entity-name="mantle.party.contact.PartyContactMechInfo" list="pcmList" limit="50"><econdition field-name="partyId"/><econdition field-name="contactMechTypeEnumId" operator="not-in" value="CmtPostalAddress,CmtTelecomNumber"/><econdition field-name="thruDate" operator="less" from="ec.user.nowTimestamp"/><select-field field-name="partyId,contactMechId,contactMechTypeEnumId,contactMechPurposeId,fromDate"/><order-by field-name="-thruDate"/></entity-find><field name="fromDate"><default-field><display/></default-field></field><field name="thruDate"><default-field container-style="text-danger"><display/></default-field></field><field name="contactMechTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="contactMechPurposeId"><default-field title="Purpose"><display-entity entity-name="mantle.party.contact.ContactMechPurpose"/></default-field></field><field name="infoString"><default-field title="Info"><display/></default-field></field><field name="unremoveLink"><default-field title=""><link url="unremoveContactInfo" text="Restore" confirmation="Restore address?" parameter-map="[partyId:partyId, contactMechId:contactMechId, contactMechPurposeId:contactMechPurposeId, fromDate:fromDate]"/></default-field></field><form-list-column><field-ref name="fromDate"/><field-ref name="thruDate"/></form-list-column><form-list-column><field-ref name="contactMechTypeEnumId"/><field-ref name="contactMechPurposeId"/></form-list-column><form-list-column><field-ref name="infoString"/></form-list-column><form-list-column><field-ref name="unremoveLink"/></form-list-column></form-list><form-list name="PcmTelecomListForm" list="pcmList" skip-form="true"><entity-find entity-name="mantle.party.contact.PartyContactMechTelecomNumber" list="pcmList" limit="50"><econdition field-name="partyId"/><econdition field-name="contactMechTypeEnumId" value="CmtTelecomNumber"/><econdition field-name="thruDate" operator="less" from="ec.user.nowTimestamp"/><select-field field-name="partyId,contactMechId,contactMechPurposeId,fromDate"/><order-by field-name="-thruDate"/></entity-find><field name="fromDate"><default-field><display/></default-field></field><field name="thruDate"><default-field container-style="text-danger"><display/></default-field></field><field name="contactMechPurposeId"><default-field title="Purpose"><display-entity entity-name="mantle.party.contact.ContactMechPurpose"/></default-field></field><field name="countryCode"><default-field title="Country"><display/></default-field></field><field name="areaCode"><default-field title="Area"><display/></default-field></field><field name="contactNumber"><default-field title="Number"><display/></default-field></field><field name="extension"><default-field title="Ext"><display/></default-field></field><field name="unremoveLink"><default-field title=""><link url="unremoveContactInfo" text="Restore" confirmation="Restore phone number?" parameter-map="[partyId:partyId, contactMechId:contactMechId, contactMechPurposeId:contactMechPurposeId, fromDate:fromDate]"/></default-field></field><form-list-column><field-ref name="fromDate"/><field-ref name="thruDate"/></form-list-column><form-list-column><field-ref name="contactMechPurposeId"/></form-list-column><form-list-column><field-ref name="countryCode"/></form-list-column><form-list-column><field-ref name="areaCode"/></form-list-column><form-list-column><field-ref name="contactNumber"/></form-list-column><form-list-column><field-ref name="extension"/></form-list-column><form-list-column><field-ref name="unremoveLink"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Party/EditParty/ExpiredPostal.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="partyId" required="true"/><transition name="unremoveContactInfo"><service-call name="mantle.party.ContactServices.undelete#PartyContactMech" in-map="true" out-map="context" multi="parameter"/><default-response url=".."/></transition><widgets><form-list name="PcmListForm" list="pcmList" skip-form="true"><entity-find entity-name="mantle.party.contact.PartyContactMechPostalAddress" list="pcmList" limit="50"><econdition field-name="partyId"/><econdition field-name="contactMechTypeEnumId" value="CmtPostalAddress"/><econdition field-name="thruDate" operator="less" from="ec.user.nowTimestamp"/><select-field field-name="partyId,contactMechId,contactMechPurposeId,fromDate,stateGeoName,stateGeoCodeAlpha2"/><order-by field-name="-thruDate"/></entity-find><field name="fromDate"><default-field><display/></default-field></field><field name="thruDate"><default-field container-style="text-danger"><display/></default-field></field><field name="contactMechPurposeId"><default-field title="Purpose"><display-entity entity-name="mantle.party.contact.ContactMechPurpose"/></default-field></field><field name="address1"><default-field title="Address 1"><display/></default-field></field><field name="unitNumber"><default-field title="Unit"><display/></default-field></field><field name="postalCode"><default-field title="Postal"><display/></default-field></field><field name="postalCodeExt"><default-field title="Ext"><display/></default-field></field><field name="stateProvinceGeoId"><default-field title="State"><display text="${stateGeoCodeAlpha2 ?: stateGeoName ?: stateProvinceGeoId}"/></default-field></field><field name="countryGeoId"><default-field title="Country"><display/></default-field></field><field name="unremoveLink"><default-field title=""><link url="unremoveContactInfo" text="Restore" confirmation="Restore address?" parameter-map="[partyId:partyId, contactMechId:contactMechId, contactMechPurposeId:contactMechPurposeId, fromDate:fromDate]"/></default-field></field><form-list-column><field-ref name="fromDate"/><field-ref name="thruDate"/></form-list-column><form-list-column><field-ref name="contactMechPurposeId"/></form-list-column><form-list-column><field-ref name="address1"/><field-ref name="unitNumber"/></form-list-column><form-list-column><field-ref name="postalCode"/><field-ref name="postalCodeExt"/></form-list-column><form-list-column><field-ref name="stateProvinceGeoId"/><field-ref name="countryGeoId"/></form-list-column><form-list-column><field-ref name="unremoveLink"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Party/EditParty/FindDuplicates.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="partyId" required="true"/><transition name="mergeParties"><service-call name="mantle.party.DuplicateServices.merge#Parties" in-map="true" out-map="context" multi="parameter"/><default-response url=".."/></transition><actions><set field="toPartyId" from="partyId"/><service-call name="mantle.party.DuplicateServices.find#PartyDuplicates" in-map="[partyId:partyId]" out-map="context"/><script><![CDATA[dupInfoList = []
            for (List matchList in matchingInfoByPartyId.values()) {
                for (matchInfo in matchList) {
                    if (matchInfo instanceof org.moqui.entity.EntityValue) { dupInfoList.add(matchInfo.getMap()) }
                    else { dupInfoList.add(matchInfo) }
                }
            }]]></script></actions><widgets><form-list name="DupPartyList" list="dupInfoList"><field name="partyId"><default-field title="Party"><link url=".." entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" link-type="anchor"/></default-field></field><field name="idValue"><default-field title="Alt ID"><display/></default-field></field><field name="infoString"><default-field title="Email"><display/></default-field></field><field name="birthDate"><default-field title="Birth"><display/></default-field></field><field name="areaCode"><default-field title="Area Code"><display/></default-field></field><field name="contactNumber"><default-field title="Number"><display/></default-field></field><field name="address1"><default-field title="Address 1"><display/></default-field></field><field name="unitNumber"><default-field title="Unit"><display/></default-field></field><field name="postalCode"><default-field title="Postal"><display/></default-field></field><field name="postalCodeExt"><default-field title="Ext"><display/></default-field></field><field name="countryGeoId"><default-field title="Country"><display/></default-field></field><field name="mergeLink"><default-field title=""><link url="mergeParties" text="Merge From ${partyId}" parameter-map="[partyId:toPartyId, toPartyId:toPartyId, fromPartyId:partyId]" confirmation="Really merge ${partyId} into this party?"/></default-field></field><form-list-column><field-ref name="partyId"/></form-list-column><form-list-column><field-ref name="idValue"/></form-list-column><form-list-column><field-ref name="infoString"/></form-list-column><form-list-column><field-ref name="birthDate"/></form-list-column><form-list-column><field-ref name="areaCode"/><field-ref name="contactNumber"/></form-list-column><form-list-column><field-ref name="address1"/><field-ref name="unitNumber"/></form-list-column><form-list-column><field-ref name="postalCode"/><field-ref name="postalCodeExt"/></form-list-column><form-list-column><field-ref name="countryGeoId"/></form-list-column><form-list-column><field-ref name="mergeLink"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Party/EditParty.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Party" default-menu-index="1"><parameter name="partyId" required="true"/><transition name="findOrder"><default-response url="//${appRoot}/Order/FindOrder"/></transition><transition name="findShipment"><default-response url="//${appRoot}/Shipment/FindShipment"/></transition><transition name="findInvoice"><default-response url="//${appRoot}/Accounting/Invoice/FindInvoice"/></transition><transition name="findPayment"><default-response url="//${appRoot}/Accounting/Payment/FindPayment"/></transition><transition name="findRequest"><default-response url="//${appRoot}/Request/FindRequest"/></transition><transition name="systemUserAccount"><default-response url="//system/Security/UserAccount/UserAccountDetail"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition name="updateParty"><service-call name="mantle.party.PartyServices.update#PartyDetail" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="convertPartyToOrganization"><service-call name="mantle.party.PartyServices.convert#PartyToOrganization" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="convertPartyToPerson"><service-call name="mantle.party.PartyServices.convert#PartyToPerson" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createPartyRole"><service-call name="create#mantle.party.PartyRole" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deletePartyRole"><service-call name="delete#mantle.party.PartyRole" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="setPartyClassification"><service-call name="mantle.party.PartyServices.set#PartyClassification" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="removePartyClassification"><service-call name="mantle.party.PartyServices.remove#PartyClassification" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getPartyClassificationList" location="component://SimpleScreens/template/party/PartyTransitions.xml"/><transition name="storePartySetting"><service-call name="mantle.party.PartyServices.store#PartySetting" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deletePartySetting"><service-call name="delete#mantle.party.PartySetting" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getPartySettingList" location="component://SimpleScreens/template/party/PartyTransitions.xml"/><transition name="createPartyIdentification"><service-call name="create#mantle.party.PartyIdentification" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updatePartyIdentification"><service-call name="update#mantle.party.PartyIdentification" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deletePartyIdentification"><parameter name="partyIdTypeEnumId"/><service-call name="delete#mantle.party.PartyIdentification" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createUserAccount"><service-call name="mantle.party.PartyServices.create#PartyUserAccount" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateUserAccount"><service-call name="mantle.party.PartyServices.update#PartyUserAccount" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="enableUserAccount"><service-call name="org.moqui.impl.UserServices.enable#UserAccount" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="disableUserAccount"><service-call name="org.moqui.impl.UserServices.disable#UserAccount" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="resetPassword"><service-call name="org.moqui.impl.UserServices.reset#Password" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createUserGroupMember"><service-call name="create#moqui.security.UserGroupMember" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateUserGroupMember"><service-call name="update#moqui.security.UserGroupMember" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createPartyRelationship"><service-call name="create#mantle.party.PartyRelationship" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updatePartyRelationship"><service-call name="update#mantle.party.PartyRelationship" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="addContact"><service-call name="mantle.sales.AccountServices.add#Contact" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createContact"><service-call name="mantle.sales.AccountServices.create#Contact" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="removeContact"><service-call name="mantle.sales.AccountServices.delete#Contact" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="removePaymentMethod"><service-call name="mantle.account.PaymentMethodServices.delete#PaymentMethod" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="editPaymentMethod"><default-response url="../PaymentMethod/EditPaymentMethod"/></transition><transition name="findFinancialAccount"><default-response url="//${appRoot}/Accounting/FinancialAccount/FindFinancialAccount"/></transition><transition name="editFinancialAccount"><default-response url="//${appRoot}/Accounting/FinancialAccount/EditFinancialAccount"/></transition><transition name="storePartyContactMech"><service-call name="mantle.party.ContactServices.store#PartyContactMech" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="removeContactInfo"><service-call name="mantle.party.ContactServices.delete#PartyContactMech" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateContactMechMutable"><service-call name="mantle.party.ContactServices.update#ContactMechMutable" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="validateAddress"><service-call name="mantle.shipment.CarrierServices.validate#PostalAddress" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createContactMechOther"><service-call name="mantle.party.ContactServices.create#ContactMechOther" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updatePartyContactOther"><service-call name="mantle.party.ContactServices.update#PartyContactOther" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getContactMechPurposesByType" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition name="createPartyNote"><service-call name="create#mantle.party.PartyNote" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updatePartyNote"><service-call name="update#mantle.party.PartyNote" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createContent"><service-call name="mantle.party.PartyServices.create#PartyContent" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateContent"><service-call name="mantle.party.PartyServices.update#PartyContent" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="downloadContent" read-only="true"><parameter name="partyContentId"/><actions><entity-find-one entity-name="mantle.party.PartyContent" value-field="partyContent"/><script><![CDATA[ec.web.sendResourceResponse(partyContent?.contentLocation)]]></script></actions><default-response type="none"/></transition><transition name="receivableStatement"><default-response url="${ec.web.getWebappRootUrl(false, null)}/fop/apps/${appRoot}/Accounting/Invoice/ReceivableStatement" url-type="plain"><parameter name="pageNoLimit" value="true"/><parameter name="toPartyId"/><parameter name="filename" value="Statement-${toPartyId}-${ec.l10n.format(ec.user.nowTimestamp, 'yyyy-MM-dd')}.pdf"/></default-response></transition><actions><entity-find-one entity-name="mantle.party.PartyDetail" value-field="party"/><if condition="party == null"><return error="true" message="Party not found with ID ${partyId}"/></if><entity-find entity-name="moqui.security.UserAccount" list="userAccountList"><econdition field-name="partyId"/><econdition field-name="disabled" operator="not-equals" value="Y" or-null="true"/><order-by field-name="userId"/></entity-find><if condition="!userAccountList"><entity-find entity-name="moqui.security.UserAccount" list="userAccountList"><econdition field-name="partyId"/><econdition field-name="disabled" value="Y"/><order-by field-name="userId"/></entity-find></if><set field="userAccount" from="userAccountList ? userAccountList[0] : null"/><entity-find-count entity-name="mantle.request.RequestAndParty" count-field="requestCount"><date-filter/><econdition field-name="partyId"/></entity-find-count><entity-find-count entity-name="mantle.order.OrderPart" count-field="customerOrderPartCount"><econdition field-name="customerPartyId" from="partyId"/></entity-find-count><entity-find-count entity-name="mantle.order.OrderPart" count-field="vendorOrderPartCount"><econdition field-name="vendorPartyId" from="partyId"/></entity-find-count><entity-find-count entity-name="mantle.shipment.Shipment" count-field="fromShipmentCount"><econdition field-name="fromPartyId" from="partyId"/></entity-find-count><entity-find-count entity-name="mantle.shipment.Shipment" count-field="toShipmentCount"><econdition field-name="toPartyId" from="partyId"/></entity-find-count><entity-find-count entity-name="mantle.account.invoice.Invoice" count-field="fromInvoiceCount"><econdition field-name="fromPartyId" from="partyId"/><econdition field-name="statusId" operator="not-equals" value="InvoiceCancelled"/></entity-find-count><entity-find-count entity-name="mantle.account.invoice.Invoice" count-field="toInvoiceCount"><econdition field-name="toPartyId" from="partyId"/><econdition field-name="statusId" operator="not-equals" value="InvoiceCancelled"/></entity-find-count><entity-find-count entity-name="mantle.account.payment.Payment" count-field="fromPaymentCount"><econdition field-name="fromPartyId" from="partyId"/><econdition field-name="statusId" operator="not-in" value="PmntCancelled,PmntVoid"/></entity-find-count><entity-find-count entity-name="mantle.account.payment.Payment" count-field="toPaymentCount"><econdition field-name="toPartyId" from="partyId"/><econdition field-name="statusId" operator="not-in" value="PmntCancelled,PmntVoid"/></entity-find-count><entity-find entity-name="mantle.party.PartyRole" list="partyRoleList"><econdition field-name="partyId"/></entity-find><set field="roleTypeIdList" from="partyRoleList*.roleTypeId"/></actions><widgets><container-row><row-col lg="6"><link url="findRequest" text="Requests" badge="${requestCount}" parameter-map="[partyId:partyId]" condition="requestCount"/><link url="findOrder" text="Sales Orders" badge="${customerOrderPartCount}" parameter-map="[customerPartyId:partyId]" condition="customerOrderPartCount"/><link url="findOrder" text="Purchase Orders" badge="${vendorOrderPartCount}" parameter-map="[vendorPartyId:partyId]" condition="vendorOrderPartCount"/><link url="findShipment" text="Shipments From" badge="${fromShipmentCount}" parameter-map="[fromPartyId:partyId]" condition="fromShipmentCount"/><link url="findShipment" text="Shipments To" badge="${toShipmentCount}" parameter-map="[toPartyId:partyId]" condition="toShipmentCount"/><link url="findInvoice" text="Invoices From" badge="${fromInvoiceCount}" condition="fromInvoiceCount" parameter-map="[fromPartyId:partyId, orderByField:'-invoiceDate', statusId:'InvoiceCancelled', statusId_not:'Y']"/><link url="findInvoice" text="Invoices To" badge="${toInvoiceCount}" condition="toInvoiceCount" parameter-map="[toPartyId:partyId, orderByField:'-invoiceDate', statusId:'InvoiceCancelled', statusId_not:'Y']"/><link url="findPayment" text="Payments From" badge="${fromPaymentCount}" condition="fromPaymentCount" parameter-map="[fromPartyId:partyId, orderByField:'-effectiveDate,-paymentId', statusId:'PmntCancelled,PmntVoid', statusId_not:'Y', statusId_op:'in']"/><link url="findPayment" text="Payments To" badge="${toPaymentCount}" condition="toPaymentCount" parameter-map="[toPartyId:partyId, orderByField:'-effectiveDate,-paymentId', statusId:'PmntCancelled,PmntVoid', statusId_not:'Y', statusId_op:'in']"/><link url="receivableStatement" text="Statement PDF" parameter-map="[toPartyId:partyId]" condition="toInvoiceCount || fromPaymentCount"/><section name="NonUserPerson" condition="!userAccount"><actions><entity-find entity-name="mantle.party.contact.PartyContactMechInfo" list="primaryEmailList"><date-filter/><econdition field-name="partyId"/><econdition field-name="contactMechPurposeId" value="EmailPrimary"/><order-by field-name="-fromDate"/></entity-find><set field="emailAddress" from="primaryEmailList?.first?.infoString"/></actions><widgets><container-dialog id="CreateUserAccountDialog" button-text="Create User" type="success"><label text="User must change password before first login, even if password is set here." type="p"/><form-single name="CreateUserAccount" transition="createUserAccount"><field name="partyId"><default-field><hidden/></default-field></field><field name="username"><default-field><text-line size="20"/></default-field></field><field name="emailAddress"><default-field title="System Email"><text-line size="60"/></default-field></field><field name="newPassword"><default-field title="Password"><password size="15"/></default-field></field><field name="newPasswordVerify"><default-field title="Password Verify"><password size="15"/></default-field></field><field name="requirePasswordChange"><default-field><hidden default-value="Y"/></default-field></field><field name="userGroupId"><default-field title="Group"><drop-down allow-empty="true"><entity-options key="${userGroupId}" text="${description}"><entity-find entity-name="moqui.security.UserGroup"><econdition field-name="groupTypeEnumId" from="appUserGroupTypeEnumId"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog></widgets></section><section name="ConvertPartySection" condition="party?.partyTypeEnumId == 'PtyOrganization'"><widgets><container-dialog id="ConvertToPersonSection" button-text="Convert To Person"><form-single name="ConvertToPersonForm" map="party" transition="convertPartyToPerson"><field name="partyId"><default-field><hidden/></default-field></field><field name="firstName" from="party.organizationName.contains(' ') ? party.organizationName.substring(0, party.organizationName.lastIndexOf(' ')) : party.organizationName"><default-field><text-line size="30"/></default-field></field><field name="middleName"><default-field><text-line size="20"/></default-field></field><field name="lastName" from="party.organizationName.contains(' ') ? party.organizationName.substring(party.organizationName.lastIndexOf(' ') + 1) : ''"><default-field><text-line size="30"/></default-field></field><field name="birthDate"><default-field><date-time type="date"/></default-field></field><field name="submitButton"><default-field title="Convert To Person"><submit confirmation="Are you sure?"/></default-field></field></form-single></container-dialog></widgets><fail-widgets><container-dialog id="ConvertToOrganizationSection" button-text="Convert To Organization"><form-single name="ConvertToOrganizationForm" map="party" transition="convertPartyToOrganization"><field name="partyId"><default-field><hidden/></default-field></field><field name="organizationName"><default-field><text-line size="60" default-value="${party.firstName?:''}${party.middleName ? ' ' + party.middleName : ''}${party.lastName ? ' ' + party.lastName : ''}"/></default-field></field><field name="submitButton"><default-field title="Convert To Organization"><submit confirmation="Are you sure?"/></default-field></field></form-single></container-dialog></fail-widgets></section><dynamic-dialog id="FindDuplicatesDialog" button-text="Find Duplicates" transition="FindDuplicates" width="960" type="warning"/><section name="HasDuplicatesSection"><actions><if condition="party.hasDuplicates != 'Y'"><service-call name="mantle.party.DuplicateServices.find#PartyHasDuplicates" in-map="[partyId:partyId]" out-map="context"/></if><entity-find entity-name="mantle.party.Party" list="mergedFromList"><econdition field-name="mergedToPartyId" from="partyId"/></entity-find></actions><widgets><label text="Duplicates found (by ${party.hasDuplicates == 'Y' ? 'address/name, phone/name, ' : ''}identification, email, or birth date and name)" type="div" style="text-danger" condition="party.hasDuplicates == 'Y' || hasDuplicates"/><container><link url="." text="This party was merged into ${party.mergedToPartyId}" link-type="anchor" parameter-map="[partyId:party.mergedToPartyId]" condition="party.mergedToPartyId"/></container><container><label text="This party has data merged from parties: " condition="mergedFromList"/><section-iterate name="MergedFromList" list="mergedFromList" entry="mergedFrom"><widgets><link url="." text="${mergedFrom.partyId} " link-type="anchor" parameter-map="[partyId:mergedFrom.partyId]"/></widgets></section-iterate></container></widgets></section><section name="EditPartySection" condition="party?.partyTypeEnumId == 'PtyOrganization'"><widgets><form-single name="EditOrganizationForm" map="party" transition="updateParty"><field name="partyId"><default-field><hidden/></default-field></field><field name="pseudoId"><default-field title="ID"><text-line size="15"/></default-field></field><field name="organizationName"><default-field><text-line size="60"/></default-field></field><field name="externalId"><default-field><text-line size="20"/></default-field></field><field name="disabled"><default-field title="Hidden"><drop-down><option key="N"/><option key="Y"/></drop-down></default-field></field><field name="gatewayCimId"><default-field title="CIM ID"><text-line size="20"/></default-field></field><field name="ownerPartyId"><default-field title="Owned By Org"><drop-down allow-empty="true"><option key="_NA_" text="N/A"/><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></default-field></field><field name="dataSourceId"><default-field title="Data Source"><drop-down allow-empty="true"><entity-options key="${dataSourceId}" text="${description}"><entity-find entity-name="moqui.basic.DataSource"><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="comments"><default-field title="Internal Comments"><text-area rows="3" cols="120"/></default-field></field><field name="shippingInstructions"><default-field><text-area rows="5" cols="120"/></default-field></field><field name="submitButton"><default-field title="Update Organization"><submit/></default-field></field></form-single></widgets><fail-widgets><form-single name="EditPersonForm" map="party" transition="updateParty"><field name="partyId"><default-field><hidden/></default-field></field><field name="pseudoId"><default-field title="ID"><text-line size="15"/></default-field></field><field name="firstName"><default-field><text-line size="30"/></default-field></field><field name="middleName"><default-field><text-line size="20"/></default-field></field><field name="lastName"><default-field><text-line size="30"/></default-field></field><field name="birthDate"><default-field><date-time type="date"/></default-field></field><field name="externalId"><default-field><text-line size="20"/></default-field></field><field name="disabled"><default-field title="Hidden"><drop-down><option key="N"/><option key="Y"/></drop-down></default-field></field><field name="gatewayCimId"><default-field title="CIM ID"><text-line size="20"/></default-field></field><field name="ownerPartyId"><default-field title="Owned By Org"><drop-down allow-empty="true"><option key="_NA_" text="N/A"/><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></default-field></field><field name="dataSourceId"><default-field title="Data Source"><drop-down allow-empty="true"><entity-options key="${dataSourceId}" text="${description}"><entity-find entity-name="moqui.basic.DataSource"><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="comments"><default-field title="Internal Comments"><text-area rows="3" cols="80"/></default-field></field><field name="shippingInstructions"><default-field><text-area rows="3" cols="80"/></default-field></field><field name="submitButton"><default-field title="Update Person"><submit/></default-field></field><field-layout><fields-not-referenced/><field-row><field-ref name="birthDate"/><field-ref name="externalId"/></field-row><field-row><field-ref name="disabled"/><field-ref name="gatewayCimId"/></field-row><field-row><field-ref name="ownerPartyId"/><field-ref name="dataSourceId"/></field-row><field-ref name="comments"/><field-ref name="shippingInstructions"/><field-ref name="submitButton"/></field-layout></form-single></fail-widgets></section><section name="RolesSection"><actions><entity-find entity-name="mantle.party.PartyRole" list="partyRoleList"><econdition field-name="partyId"/></entity-find></actions><widgets><container-box type="warning"><box-header title="Roles"/><box-toolbar><container-dialog id="AddDirectRoleDialog" button-text="Add Direct Role"><label text="Roles applied directly describe how the system should treat the Party, or what the Party is to users of the system." type="p"/><label text="These Roles enable system functionality when directly applied to a Party." type="p"/><form-single name="AddDirectRoleForm" transition="createPartyRole"><field name="partyId"><default-field><hidden/></default-field></field><field name="roleTypeId"><default-field title="Role"><drop-down><entity-options key="${roleTypeId}" text="${description}"><entity-find entity-name="mantle.party.RoleGroupMemberAndType" cache="true"><econdition field-name="roleGroupEnumId" value="RgpDirect"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog><container-dialog id="AddOtherRoleDialog" button-text="Add Other Role"><label text="Roles applied directly describe how the system should treat the Party, or what the Party is to users of the system." type="p"/><label text="Any Role may be added here to organize parties for searching, etc but many are used to describe a Party's relationship to, or involvement with, other things in the system and have no effect when applied directly." type="p"/><form-single name="AddOtherRoleForm" transition="createPartyRole"><field name="partyId"><default-field><hidden/></default-field></field><field name="roleTypeId"><default-field title="Role"><drop-down><entity-options key="${roleTypeId}" text="${description}"><entity-find entity-name="mantle.party.RoleType"><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body-nopad><form-list name="RolesForm" list="partyRoleList" transition="deletePartyRole" skip-header="true"><field name="partyId"><default-field><hidden/></default-field></field><field name="roleTypeId"><default-field title="Role"><display-entity entity-name="mantle.party.RoleType"/></default-field></field><field name="submitButton"><default-field title=""><submit icon="fa fa-trash" confirmation="Delete role?"/></default-field></field></form-list></box-body-nopad></container-box></widgets></section><section name="PartyClassificationSection"><actions><entity-find entity-name="mantle.party.PartyClassificationAndAppl" list="pcaaList"><date-filter/><econdition field-name="partyId"/></entity-find></actions><widgets><container-box type="warning"><box-header title="Classifications"/><box-toolbar><container-dialog id="SetClassificationDialog" button-text="Set Classification"><form-single name="SetClassificationForm" transition="setPartyClassification"><field name="partyId"><default-field><hidden/></default-field></field><field name="classificationTypeEnumId"><default-field title="Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="PartyClassificationType"/><set field="noCurrentSelectedKey" value="PcltCustomer"/></widget-template-include></default-field></field><field name="partyClassificationId"><default-field title="Class"><drop-down><dynamic-options transition="getPartyClassificationList" value-field="partyClassificationId" label-field="description"><depends-on field="classificationTypeEnumId"/></dynamic-options></drop-down></default-field></field><field name="submitButton"><default-field title="Set"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body-nopad><form-list name="ClassificationsForm" list="pcaaList" transition="removePartyClassification" skip-header="true"><field name="partyId"><default-field><hidden/></default-field></field><field name="partyClassificationId"><default-field><hidden/></default-field></field><field name="fromDate"><default-field><hidden/></default-field></field><field name="thruDate" from="ec.user.nowTimestamp"><default-field><hidden/></default-field></field><field name="classificationTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="description"><default-field title="Class"><display/></default-field></field><field name="submitButton"><default-field title=""><submit icon="fa fa-trash" confirmation="Delete classification?"/></default-field></field></form-list></box-body-nopad></container-box></widgets></section><section name="PartyIdentificationSection"><actions><entity-find entity-name="mantle.party.PartyIdentification" list="partyIdentificationList"><econdition field-name="partyId"/></entity-find><set field="partyIdTypeEnumIds" from="partyIdentificationList.partyIdTypeEnumId"/></actions><widgets><container-box><box-header title="Identification"/><box-toolbar><container-dialog id="AddIdentificationDialog" button-text="Add Identification"><form-single name="AddIdentificationForm" transition="createPartyIdentification"><field name="partyId"><default-field><hidden/></default-field></field><field name="partyIdTypeEnumId"><default-field title="ID Type"><drop-down><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="PartyIdType"/><econdition field-name="enumId" operator="not-in" from="partyIdTypeEnumIds" ignore-if-empty="true"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="idValue"><default-field><text-line size="20"/></default-field></field><field name="expireDate"><default-field><date-time type="date"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body-nopad><form-list name="IdentificationsForm" list="partyIdentificationList" transition="updatePartyIdentification"><field name="partyId"><default-field><hidden/></default-field></field><field name="partyIdTypeEnumId"><default-field title="ID Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="idValue"><default-field><text-line size="20"/></default-field></field><field name="expireDate"><default-field><date-time type="date"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field name="removeButton"><default-field title=""><link url="deletePartyIdentification" text=" " icon="fa fa-trash" confirmation="Delete this ID?"/></default-field></field></form-list></box-body-nopad></container-box></widgets></section><section name="PartySettingSection"><actions><entity-find entity-name="mantle.party.PartySetting" list="settingList"><econdition field-name="partyId"/><order-by field-name="partySettingTypeId"/></entity-find></actions><widgets><container-box><box-header title="Settings"/><box-toolbar><container-dialog id="AddSettingDialog" button-text="Select Setting"><form-single name="AddSettingForm" transition="storePartySetting"><field name="partyId"><default-field><hidden/></default-field></field><field name="partySettingTypeId"><default-field title="Type"><drop-down><entity-options key="${partySettingTypeId}" text="${description}"><entity-find entity-name="mantle.party.PartySettingTypeAndRole" cache="false"><econdition field-name="roleTypeId" operator="in" from="roleTypeIdList" or-null="true"/><econdition field-name="enumTypeId" operator="is-not-null"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="settingValue"><default-field title="Value"><drop-down><dynamic-options transition="getPartySettingList" value-field="enumId" label-field="description"><depends-on field="partySettingTypeId"/></dynamic-options></drop-down></default-field></field><field name="submitButton"><default-field title="Set"><submit/></default-field></field></form-single></container-dialog><container-dialog id="AddSettingTextDialog" button-text="Enter Setting"><form-single name="AddSettingTextForm" transition="storePartySetting"><field name="partyId"><default-field><hidden/></default-field></field><field name="partySettingTypeId"><default-field title="Type"><drop-down><entity-options key="${partySettingTypeId}" text="${description}"><entity-find entity-name="mantle.party.PartySettingTypeAndRole" cache="false"><econdition field-name="roleTypeId" operator="in" from="roleTypeIdList" or-null="true"/><econdition field-name="enumTypeId" operator="is-null"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="settingValue"><default-field title="Value"><text-line size="40"/></default-field></field><field name="submitButton"><default-field title="Set"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body-nopad><form-list name="SettingsForm" list="settingList" transition="deletePartySetting" skip-header="true"><row-actions><entity-find-one entity-name="moqui.basic.Enumeration" value-field="valueEnum"><field-map field-name="enumId" from="settingValue"/></entity-find-one></row-actions><field name="partyId"><default-field><hidden/></default-field></field><field name="partySettingTypeId"><default-field title="Type"><display-entity entity-name="mantle.party.PartySettingType"/></default-field></field><field name="settingValue"><default-field title="Value"><display text="${valueEnum ? valueEnum.description : settingValue}"/></default-field></field><field name="submitButton"><default-field title=""><submit icon="fa fa-trash" confirmation="Really delete setting?"/></default-field></field></form-list></box-body-nopad></container-box></widgets></section><section name="UserSecuritySection" condition="userAccount"><actions><set field="localeStringList" from="[]"/><iterate list="Locale.getAvailableLocales()" entry="lcl"><script><![CDATA[localeStringList.add([locale:lcl.toString(), name:lcl.getDisplayName(ec.user.locale)])]]></script></iterate><order-map-list list="localeStringList"><order-by field-name="name"/></order-map-list></actions><widgets><container-box><box-header title="User Account"/><box-toolbar><link url="systemUserAccount" text="Account Detail" parameter-map="[userId:userAccount.userId]"/><link url="enableUserAccount" text="Enable Account" parameter-map="[userId:userAccount.userId]" condition="userAccount.disabled == 'Y'"/><link url="disableUserAccount" text="Disable Account" parameter-map="[userId:userAccount.userId]" condition="userAccount.disabled != 'Y'"/><link url="resetPassword" text="Reset Password" parameter-map="[userId:userAccount.userId]" condition="userAccount.emailAddress" confirmation="Generate reset password and send by email to ${userAccount.emailAddress}?"/></box-toolbar><box-body><form-single name="UpdateUserAccount" map="userAccount" transition="updateUserAccount"><field name="partyId"><default-field><hidden/></default-field></field><field name="userId"><default-field><hidden/></default-field></field><field name="username"><default-field><text-line size="20"/></default-field></field><field name="emailAddress"><default-field title="System Email"><text-line size="60"/></default-field></field><field name="locale"><default-field><drop-down allow-empty="true"><list-options list="localeStringList" key="${locale}" text="${name}"/></drop-down></default-field></field><field name="timeZone"><default-field><drop-down allow-empty="true"><list-options list="new TreeSet(TimeZone.getAvailableIDs().collect())"/></drop-down></default-field></field><field name="requirePasswordChange"><default-field><drop-down no-current-selected-key="N"><option key="Y"/><option key="N"/></drop-down></default-field></field><field name="disabled"><default-field><display/></default-field></field><field name="disabledDateTime"><conditional-field condition="userAccount?.disabledDateTime"><display/></conditional-field><default-field><ignored/></default-field></field><field name="successiveFailedLogins"><conditional-field condition="userAccount?.successiveFailedLogins"><display/></conditional-field><default-field><ignored/></default-field></field><field name="terminateDate"><default-field tooltip="After this date user may not login and will not receive notifications" red-when="before-now"><date-time/></default-field></field><field name="submitButton"><default-field title="Update User"><submit/></default-field></field><field-layout><fields-not-referenced/><field-row><field-ref name="requirePasswordChange"/><field-ref name="disabled"/></field-row><field-row><field-ref name="successiveFailedLogins"/><field-ref name="disabledDateTime"/></field-row><field-ref name="submitButton"/></field-layout></form-single></box-body></container-box></widgets></section><section name="UserAuthzSection" condition="userAccount"><actions><entity-find entity-name="moqui.security.UserGroupMember" list="userGroupMemberList"><date-filter/><econdition field-name="userId" from="userAccount?.userId"/></entity-find><set field="userOrgRelationshipTypes" from="['PrtAgent', 'PrtEmployee', 'PrtMember', 'PrtTeamMember']"/><entity-find entity-name="mantle.party.PartyToAndRelationship" list="userOrgRelList"><date-filter/><econdition field-name="fromPartyId" from="partyId"/><econdition field-name="relationshipTypeEnumId" operator="in" from="userOrgRelationshipTypes"/><econdition field-name="toRoleTypeId" operator="in" value="OrgInternal,OrgEmployer"/><order-by field-name="pseudoId,organizationName"/></entity-find></actions><widgets><container-box><box-header title="Security Groups"/><box-toolbar><container-dialog id="AddGroupDialog" button-text="Add to Group"><form-single name="AddGroupForm" transition="createUserGroupMember"><field name="partyId"><default-field><hidden/></default-field></field><field name="userId" from="userAccount.userId"><default-field><hidden/></default-field></field><field name="fromDate" from="ec.user.nowTimestamp"><default-field><hidden/></default-field></field><field name="userGroupId"><default-field title="Group"><drop-down><entity-options key="${userGroupId}" text="${description}"><entity-find entity-name="moqui.security.UserGroup"><econdition field-name="groupTypeEnumId" from="appUserGroupTypeEnumId"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="GroupsForm" list="userGroupMemberList" transition="updateUserGroupMember" skip-header="true"><field name="partyId"><default-field><hidden/></default-field></field><field name="userId"><default-field><hidden/></default-field></field><field name="fromDate"><default-field><hidden/></default-field></field><field name="thruDate" from="ec.user.nowTimestamp"><default-field><hidden/></default-field></field><field name="userGroupId"><default-field title="Group"><display-entity entity-name="moqui.security.UserGroup"/></default-field></field><field name="submitButton" align="right"><default-field title=""><submit icon="fa fa-trash" confirmation="Remove from Group?"/></default-field></field></form-list></box-body></container-box><container-box><box-header title="Internal Organization Relationships"/><box-toolbar><container-dialog id="AddOrgDialog" button-text="Add to Organization"><form-single name="NewToRelForm" transition="createPartyRelationship"><field name="partyId"><default-field><hidden/></default-field></field><field name="fromPartyId" from="partyId"><default-field><hidden/></default-field></field><field name="fromDate" from="ec.user.nowTimestamp"><default-field><hidden/></default-field></field><field name="toRoleTypeId"><default-field><hidden default-value="OrgInternal"/></default-field></field><field name="relationshipTypeEnumId"><default-field title="Rel. Type"><drop-down><entity-options key="${enumId}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumId" operator="in" from="userOrgRelationshipTypes"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="toPartyId"><default-field title="Organization"><drop-down><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="UserOrgRelList" list="userOrgRelList" transition="updatePartyRelationship"><field name="partyRelationshipId"><default-field><hidden/></default-field></field><field name="partyId"><header-field><hidden/></header-field><default-field><hidden/></default-field></field><field name="relationshipTypeEnumId"><default-field title="Rel. Type"><display-entity entity-name="moqui.basic.Enumeration" text="${description}"/></default-field></field><field name="toPartyId"><default-field title="Organization"><link url="." text="PartyNameTemplate" entity-name="mantle.party.PartyDetail" parameter-map="[partyId:toPartyId]" link-type="anchor"/></default-field></field><field name="fromDate"><default-field><display/></default-field></field><field name="thruDate" from="ec.user.nowTimestamp"><default-field><hidden/></default-field></field><field name="submitButton" align="right"><default-field title=""><submit icon="fa fa-trash" confirmation="Remove from Organization?"/></default-field></field></form-list></box-body></container-box></widgets></section><section name="SalesAccountContactSection"><actions><entity-find entity-name="mantle.party.PartyToAndRelationship" list="accountRelList"><date-filter/><econdition field-name="fromPartyId" from="partyId"/><econdition field-name="relationshipTypeEnumId" value="PrtContact"/></entity-find><set field="isSalesContact" from="roleTypeIdList.contains('Contact') || accountRelList"/><set field="isSalesAccount" from="roleTypeIdList.contains('Account') || (roleTypeIdList.contains('Customer') && party.partyTypeEnumId == 'PtyOrganization')"/></actions><widgets><section name="AccountRelListSection" condition="isSalesContact"><widgets><container-box><box-header title="Contact of Sales Accounts"/><box-toolbar><container-dialog id="AddSalesAccountDialog" button-text="Add to Sales Account"><form-single name="AddSalesAccount" transition="addContact"><field name="partyId"><default-field><hidden/></default-field></field><field name="accountPartyId"><default-field title="Sales Account"><drop-down><dynamic-options transition="searchPartyList" server-search="true" min-length="2" parameter-map="[roleTypeId:'Account']"/></drop-down></default-field></field><field name="fromRoleTypeId"><default-field title="Role"><drop-down allow-empty="true"><entity-options key="${roleTypeId}" text="${description}"><entity-find entity-name="mantle.party.RoleGroupMemberAndType" cache="true"><econdition field-name="roleGroupEnumId" value="RgpAccountContact"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="AccountRelList" list="accountRelList" list-entry="accountRel" skip-header="true" skip-form="true"><field name="fromRoleTypeId" from="accountRel.fromRoleTypeId"><default-field title="Role"><display-entity entity-name="mantle.party.RoleType"/></default-field></field><field name="toPartyId"><default-field><link url="." text="PartyNameTemplate" text-map="accountRel" link-type="anchor" parameter-map="[partyId:accountRel.toPartyId]"/></default-field></field><field name="removeButton" align="right"><default-field title=""><link url="removeContact" icon="fa fa-trash" parameter-map="[partyRelationshipId:accountRel.partyRelationshipId]" confirmation="Are you sure you want to remove this contact from the account?"/></default-field></field></form-list></box-body></container-box></widgets></section><section name="ContactRelListSection" condition="isSalesAccount"><actions><entity-find entity-name="mantle.party.PartyFromAndRelationship" list="contactRelList"><date-filter/><econdition field-name="toPartyId" from="partyId"/><econdition field-name="relationshipTypeEnumId" value="PrtContact"/></entity-find></actions><widgets><container-box><box-header title="Sales Account Contacts"/><box-toolbar><container-dialog id="AddContactAssignDialog" button-text="Add Contact"><form-single name="AddContactAssignForm" transition="addContact"><field name="partyId" from="contactPartyId"><default-field title="Contact"><drop-down><dynamic-options transition="searchPartyList" server-search="true" min-length="2" parameter-map="[roleTypeId:null]"/></drop-down></default-field></field><field name="fromRoleTypeId"><default-field title="Role"><drop-down allow-empty="true"><entity-options key="${roleTypeId}" text="${description}"><entity-find entity-name="mantle.party.RoleGroupMemberAndType" cache="true"><econdition field-name="roleGroupEnumId" value="RgpAccountContact"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="accountPartyId" from="partyId"><default-field title="Sales Account"><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameTemplate"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog><container-dialog id="CreateContactDialog" button-text="New Contact"><form-single name="CreateContactForm" transition="createContact"><field name="firstName"><default-field><text-line size="30"/></default-field></field><field name="lastName"><default-field><text-line size="30"/></default-field></field><field name="fromRoleTypeId"><default-field title="Role"><drop-down allow-empty="true"><entity-options key="${roleTypeId}" text="${description}"><entity-find entity-name="mantle.party.RoleGroupMemberAndType" cache="true"><econdition field-name="roleGroupEnumId" value="RgpAccountContact"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="accountPartyId" from="partyId"><default-field title="Sales Account"><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameTemplate"/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="ContactRelList" list="contactRelList" list-entry="contactRel" skip-form="true" skip-header="true"><field name="fromPartyId"><default-field><link url="." text="PartyNameTemplate" text-map="contactRel" link-type="anchor" parameter-map="[partyId:contactRel.fromPartyId]"/></default-field></field><field name="fromRoleTypeId" from="contactRel.fromRoleTypeId"><default-field title="Role"><display-entity entity-name="mantle.party.RoleType"/></default-field></field><field name="removeButton" align="right"><default-field><link url="removeContact" icon="fa fa-trash" parameter-map="[partyRelationshipId:contactRel.partyRelationshipId]" confirmation="Are you sure you want to remove this contact?"/></default-field></field></form-list></box-body></container-box></widgets></section><section name="ParentAccountRelListSection" condition="isSalesAccount"><actions><entity-find entity-name="mantle.party.PartyToAndRelationship" list="parentAccountRelList"><date-filter/><econdition field-name="fromPartyId" from="partyId"/><econdition field-name="relationshipTypeEnumId" value="PrtOrgRollup"/></entity-find></actions><widgets><container-box><box-header title="Parent Sales Account"/><box-toolbar><container-dialog id="AddParentAccountDialog" button-text="Add Parent Account"><form-single name="AddParentAccount" transition="createPartyRelationship"><field name="partyId"><default-field><hidden/></default-field></field><field name="fromPartyId" from="partyId"><default-field><hidden/></default-field></field><field name="fromRoleTypeId" from="'Account'"><default-field><hidden/></default-field></field><field name="relationshipTypeEnumId" from="'PrtOrgRollup'"><default-field><hidden/></default-field></field><field name="toRoleTypeId" from="'Account'"><default-field><hidden/></default-field></field><field name="fromDate" from="ec.user.nowTimestamp"><default-field><hidden/></default-field></field><field name="toPartyId"><default-field title="Parent Account"><drop-down><dynamic-options transition="searchPartyList" server-search="true" min-length="2" parameter-map="[roleTypeId:'Account']"/></drop-down></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="ParentAccountRelList" list="parentAccountRelList" list-entry="accountRel" skip-form="true" skip-header="true"><field name="toPartyId"><default-field><link url="." text="PartyNameTemplate" text-map="accountRel" link-type="anchor" parameter-map="[partyId:accountRel.toPartyId]"/></default-field></field><field name="removeButton" align="right"><default-field title=""><link url="removeContact" icon="fa fa-trash" parameter-map="[partyRelationshipId:accountRel.partyRelationshipId]" confirmation="Are you sure you want to remove this account from the parent account?"/></default-field></field></form-list></box-body></container-box></widgets></section><section name="ChildAccountRelListSection" condition="isSalesAccount"><actions><entity-find entity-name="mantle.party.PartyFromAndRelationship" list="childAccountRelList"><date-filter/><econdition field-name="toPartyId" from="partyId"/><econdition field-name="relationshipTypeEnumId" value="PrtOrgRollup"/></entity-find></actions><widgets><container-box><box-header title="Child Sales Accounts"/><box-toolbar><container-dialog id="AddChildAccountDialog" button-text="Add Child Account"><form-single name="AddChildAccount" transition="createPartyRelationship"><field name="partyId"><default-field><hidden/></default-field></field><field name="toPartyId" from="partyId"><default-field><hidden/></default-field></field><field name="fromRoleTypeId" from="'Account'"><default-field><hidden/></default-field></field><field name="relationshipTypeEnumId" from="'PrtOrgRollup'"><default-field><hidden/></default-field></field><field name="toRoleTypeId" from="'Account'"><default-field><hidden/></default-field></field><field name="fromDate" from="ec.user.nowTimestamp"><default-field><hidden/></default-field></field><field name="fromPartyId"><default-field title="Child Account"><drop-down><dynamic-options transition="searchPartyList" server-search="true" min-length="2" parameter-map="[roleTypeId:'Account']"/></drop-down></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="ChildAccountRelList" list="childAccountRelList" list-entry="accountRel" skip-form="true" skip-header="true"><field name="fromPartyId"><default-field><link url="." text="PartyNameTemplate" text-map="accountRel" link-type="anchor" parameter-map="[partyId:accountRel.fromPartyId]"/></default-field></field><field name="removeButton" align="right"><default-field title=""><link url="removeContact" icon="fa fa-trash" parameter-map="[partyRelationshipId:accountRel.partyRelationshipId]" confirmation="Are you sure you want to remove this child account from the parent account?"/></default-field></field></form-list></box-body></container-box></widgets></section></widgets></section></row-col><row-col lg="6"><section name="NotesSection"><actions><entity-find entity-name="mantle.party.PartyNote" list="partyNoteList"><econdition field-name="partyId"/><order-by field-name="-noteDate"/></entity-find></actions><widgets><container-box><box-header title="Notes"/><box-toolbar><container-dialog id="NewNoteDialog" button-text="Add Note"><form-single name="NewNoteForm" transition="createPartyNote"><field name="partyId"><default-field><hidden/></default-field></field><field name="noteText"><default-field title="Note"><text-area cols="60" rows="6"/></default-field></field><field name="submitButton"><default-field title="Add Note"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><section-iterate name="NoteIterateSection" list="partyNoteList" entry="partyNote"><actions><entity-find-one entity-name="mantle.party.PersonWithUserAccount" value-field="paua"><field-map field-name="userId" from="partyNote.userId"/></entity-find-one></actions><widgets><label text="By ${paua?.firstName?:''} ${paua?.lastName?:''} (${paua?.username ?: partyNote.userId}) at ${ec.l10n.format(partyNote.noteDate, 'yyyy-MM-dd HH:mm')}" type="strong"/><section name="UpdateNoteSection" condition="partyNote.userId == ec.user.userId || ec.user.isInGroup('ADMIN')"><widgets><container-dialog id="UpdateNoteContainer" button-text="Edit Note"><form-single name="UpdateNoteForm" transition="updatePartyNote" map="partyNote"><field name="partyId"><default-field><hidden/></default-field></field><field name="noteDate"><default-field><hidden/></default-field></field><field name="noteText"><default-field title="Note"><text-area cols="60" rows="6"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></container-dialog></widgets></section><label text="${partyNote.noteText}" type="p"/></widgets></section-iterate></box-body></container-box></widgets></section><section name="ContactInfoSection"><actions><service-call name="mantle.party.ContactServices.get#PartyContactInfoList" out-map="contactOut" in-map="[partyId:partyId, getAll:true]"/><set field="handledContactMechTypes" from="['CmtPostalAddress', 'CmtTelecomNumber', 'CmtEmailAddress', 'CmtWebAddress']"/><entity-find entity-name="mantle.party.contact.PartyContactMechInfo" list="otherPcmiList" limit="50"><date-filter/><econdition field-name="partyId"/><econdition field-name="contactMechTypeEnumId" operator="not-in" from="handledContactMechTypes"/><order-by field-name="contactMechTypeEnumId,fromDate"/></entity-find></actions><widgets><container-box type="info"><box-header title="Phone, Email, and Other"/><box-toolbar><dynamic-dialog id="ExpiredOtherDialog" button-text="View Old" transition="ExpiredContactOther" parameter-map="[partyId:partyId]"/><button-menu text="Add New" icon="fa fa-plus"><dynamic-dialog id="AddPhoneInfo" button-text="Phone" transition="UpdateContactInfo" parameter-map="[partyId:partyId, createTelecom:'true']"/><dynamic-dialog id="AddEmailInfo" button-text="Email" transition="UpdateContactInfo" parameter-map="[partyId:partyId, createEmail:'true']"/><dynamic-dialog id="AddWebUrlInfo" button-text="URL" transition="UpdateContactInfo" parameter-map="[partyId:partyId, createWeb:'true']"/><container-dialog id="OtherCreateDialog" button-text="Other"><form-single name="OtherCreateForm" transition="createContactMechOther"><field name="partyId"><default-field><hidden/></default-field></field><field name="contactMechTypeEnumId"><default-field title="Type"><drop-down><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="ContactMechType"/><econdition field-name="enumId" operator="not-in" from="handledContactMechTypes"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="contactMechPurposeId"><default-field title="Purpose"><drop-down><dynamic-options transition="getContactMechPurposesByType"><depends-on field="contactMechTypeEnumId"/></dynamic-options></drop-down></default-field></field><field name="infoString"><default-field title="Value"><text-line size="60"/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog></button-menu></box-toolbar><box-body><section-iterate name="PhoneInfoSection" list="contactOut.telecomNumberList" entry="contactInfo"><widgets><container-row><row-col lg="6"><dynamic-dialog id="UpdatePhoneInfo" button-text="Update" transition="UpdateContactInfo" parameter-map="[partyId:partyId, telecomContactMechId:contactInfo.telecomContactMechId,                                         telecomContactMechPurposeId:contactInfo.telecomContactMechPurposeId]"/><container-dialog id="PhonePurposeDialog" button-text="Purpose"><form-single name="PhonePurposeForm" transition="storePartyContactMech"><field name="partyId"><default-field><hidden/></default-field></field><field name="contactMechId" from="contactInfo.telecomContactMechId"><default-field><hidden/></default-field></field><field name="oldContactMechPurposeId" from="contactInfo.telecomContactMechPurposeId"><default-field><hidden/></default-field></field><field name="contactMechPurposeId" from="contactInfo.telecomContactMechPurposeId"><default-field title="Purpose"><drop-down><entity-options key="${contactMechPurposeId}" text="${description}"><entity-find entity-name="mantle.party.contact.ContactMechPurpose"><econdition field-name="contactMechTypeEnumId" value="CmtTelecomNumber"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="extension" from="contactInfo.telecomPartyContactMech?.extension"><default-field><text-line size="6" maxlength="8"/></default-field></field><field name="updateButton"><default-field title="Update Purpose"><submit/></default-field></field><field name="addButton"><default-field title="Add Purpose"><submit/></default-field></field><field-layout><field-ref name="contactMechPurposeId"/><field-ref name="extension"/><field-row-big><field-ref name="updateButton"/><field-ref name="addButton"/></field-row-big></field-layout></form-single></container-dialog><link url="removeContactInfo" text=" " icon="fa fa-trash" confirmation="Remove phone number?" parameter-map="[partyId:partyId, contactMechId:contactInfo.telecomContactMechId,                                         contactMechPurposeId:contactInfo.telecomContactMechPurposeId]"/></row-col><row-col lg="6"><label text="${contactInfo.telecomContactMechPurpose.description}" type="strong"/><render-mode><text type="html,vuet,qvt" location="component://SimpleScreens/template/party/ContactInfo.html.gstring"/></render-mode></row-col></container-row></widgets></section-iterate><section-iterate name="EmailInfoSection" list="contactOut.emailAddressList" entry="contactInfo"><widgets><container-row><row-col lg="6"><dynamic-dialog id="UpdateEmailInfo" button-text="Update" transition="UpdateContactInfo" parameter-map="[partyId:partyId, emailContactMechId:contactInfo.emailContactMechId,                                         emailContactMechPurposeId:contactInfo.emailContactMechPurposeId]"/><container-dialog id="EmailPurposeDialog" button-text="Purpose"><form-single name="EmailPurposeForm" transition="storePartyContactMech"><field name="partyId"><default-field><hidden/></default-field></field><field name="contactMechId" from="contactInfo.emailContactMechId"><default-field><hidden/></default-field></field><field name="oldContactMechPurposeId" from="contactInfo.emailContactMechPurposeId"><default-field><hidden/></default-field></field><field name="contactMechPurposeId" from="contactInfo.emailContactMechPurposeId"><default-field title="Purpose"><drop-down><entity-options key="${contactMechPurposeId}" text="${description}"><entity-find entity-name="mantle.party.contact.ContactMechPurpose"><econdition field-name="contactMechTypeEnumId" value="CmtEmailAddress"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="updateButton"><default-field title="Update Purpose"><submit/></default-field></field><field name="addButton"><default-field title="Add Purpose"><submit/></default-field></field><field-layout><field-ref name="contactMechPurposeId"/><field-row-big><field-ref name="updateButton"/><field-ref name="addButton"/></field-row-big></field-layout></form-single></container-dialog><link url="removeContactInfo" text=" " icon="fa fa-trash" confirmation="Remove email address?" parameter-map="[partyId:partyId, contactMechId:contactInfo.emailContactMechId,                                         contactMechPurposeId:contactInfo.emailContactMechPurposeId]"/></row-col><row-col lg="6"><label text="${contactInfo.emailContactMechPurpose.description}" type="strong"/><render-mode><text type="html,vuet,qvt" location="component://SimpleScreens/template/party/ContactInfo.html.gstring"/></render-mode></row-col></container-row></widgets></section-iterate><section-iterate name="WebInfoSection" list="contactOut.webAddressList" entry="contactInfo"><widgets><container-row><row-col lg="6"><dynamic-dialog id="UpdateWebInfo" button-text="Update" transition="UpdateContactInfo" parameter-map="[partyId:partyId, webContactMechId:contactInfo.webContactMechId,                                         webContactMechPurposeId:contactInfo.webContactMechPurposeId]"/><container-dialog id="WebPurposeDialog" button-text="Purpose"><form-single name="WebPurposeForm" transition="storePartyContactMech"><field name="partyId"><default-field><hidden/></default-field></field><field name="contactMechId" from="contactInfo.webContactMechId"><default-field><hidden/></default-field></field><field name="oldContactMechPurposeId" from="contactInfo.webContactMechPurposeId"><default-field><hidden/></default-field></field><field name="contactMechPurposeId" from="contactInfo.webContactMechPurposeId"><default-field title="Purpose"><drop-down><entity-options key="${contactMechPurposeId}" text="${description}"><entity-find entity-name="mantle.party.contact.ContactMechPurpose"><econdition field-name="contactMechTypeEnumId" value="CmtWebAddress"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="updateButton"><default-field title="Update Purpose"><submit/></default-field></field><field name="addButton"><default-field title="Add Purpose"><submit/></default-field></field><field-layout><field-ref name="contactMechPurposeId"/><field-row-big><field-ref name="updateButton"/><field-ref name="addButton"/></field-row-big></field-layout></form-single></container-dialog><link url="removeContactInfo" text=" " icon="fa fa-trash" confirmation="Remove Web URL?" parameter-map="[partyId:partyId, contactMechId:contactInfo.webContactMechId,                                         contactMechPurposeId:contactInfo.webContactMechPurposeId]"/></row-col><row-col lg="6"><label text="${contactInfo.webContactMechPurpose.description}" type="strong"/><render-mode><text type="html,vuet,qvt" location="component://SimpleScreens/template/party/ContactInfo.html.gstring"/></render-mode></row-col></container-row></widgets></section-iterate><section-iterate name="OtherInfoSection" list="otherPcmiList" entry="otherPcmi"><actions><entity-find-one entity-name="moqui.basic.Enumeration" value-field="contactMechTypeEnum" cache="true"><field-map field-name="enumId" from="otherPcmi.contactMechTypeEnumId"/></entity-find-one><entity-find-one entity-name="mantle.party.contact.ContactMechPurpose" value-field="contactMechPurpose" cache="true"><field-map field-name="contactMechPurposeId" from="otherPcmi.contactMechPurposeId"/></entity-find-one></actions><widgets><container-row><row-col lg="6"><container-dialog id="OtherUpdateDialog" button-text="Update"><form-single name="OtherUpdateForm" transition="updatePartyContactOther"><field name="partyId"><default-field><hidden/></default-field></field><field name="contactMechId" from="otherPcmi.contactMechId"><default-field><hidden/></default-field></field><field name="contactMechPurposeId" from="otherPcmi.contactMechPurposeId"><default-field><hidden/></default-field></field><field name="infoString" from="otherPcmi.infoString"><default-field title="Value"><text-line size="60"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></container-dialog><container-dialog id="OtherPurposeDialog" button-text="Purpose"><form-single name="OtherPurposeForm" transition="storePartyContactMech"><field name="partyId"><default-field><hidden/></default-field></field><field name="contactMechId" from="otherPcmi.contactMechId"><default-field><hidden/></default-field></field><field name="oldContactMechPurposeId" from="otherPcmi.contactMechPurposeId"><default-field><hidden/></default-field></field><field name="contactMechPurposeId" from="otherPcmi.contactMechPurposeId"><default-field title="Purpose"><drop-down><entity-options key="${contactMechPurposeId}" text="${description}"><entity-find entity-name="mantle.party.contact.ContactMechPurpose"><econdition field-name="contactMechTypeEnumId" from="otherPcmi.contactMechTypeEnumId" or-null="true"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="updateButton"><default-field title="Update Purpose"><submit/></default-field></field><field name="addButton"><default-field title="Add Purpose"><submit/></default-field></field><field-layout><field-ref name="contactMechPurposeId"/><field-row-big><field-ref name="updateButton"/><field-ref name="addButton"/></field-row-big></field-layout></form-single></container-dialog><link url="removeContactInfo" text=" " icon="fa fa-trash" confirmation="Remove Contact Info?" parameter-map="[partyId:partyId, contactMechId:otherPcmi.contactMechId,                                         contactMechPurposeId:otherPcmi.contactMechPurposeId]"/></row-col><row-col lg="6"><label text="${contactMechTypeEnum.description} - ${contactMechPurpose.description}" type="strong"/><container><label text="${otherPcmi.infoString}" type="i"/></container></row-col></container-row></widgets></section-iterate></box-body></container-box><container-box type="info"><box-header title="Postal Addresses"/><box-toolbar><dynamic-dialog id="ExpiredPostalDialog" button-text="Old Addresses" transition="ExpiredPostal" width="840" parameter-map="[partyId:partyId]"/><dynamic-dialog id="AddAddressInfo" button-text="Add Address" transition="UpdateContactInfo" width="840" parameter-map="[partyId:partyId, createPostal:'true']"/></box-toolbar><box-body><section-iterate name="PostalInfoSection" list="contactOut.postalAddressList" entry="contactInfo"><widgets><container-row><row-col lg="6"><dynamic-dialog id="UpdatePostalInfo" button-text="Update" transition="UpdateContactInfo" width="840" parameter-map="[partyId:partyId, postalContactMechId:contactInfo.postalContactMechId,                                         postalContactMechPurposeId:contactInfo.postalContactMechPurposeId]"/><container-dialog id="PostalPurposeDialog" button-text="Purpose"><form-single name="PostalPurposeForm" transition="storePartyContactMech"><field name="partyId"><default-field><hidden/></default-field></field><field name="contactMechId" from="contactInfo.postalContactMechId"><default-field><hidden/></default-field></field><field name="oldContactMechPurposeId" from="contactInfo.postalContactMechPurposeId"><default-field><hidden/></default-field></field><field name="contactMechPurposeId" from="contactInfo.postalContactMechPurposeId"><default-field title="Purpose"><drop-down><entity-options key="${contactMechPurposeId}" text="${description}"><entity-find entity-name="mantle.party.contact.ContactMechPurpose"><econdition field-name="contactMechTypeEnumId" value="CmtPostalAddress"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="updateButton"><default-field title="Update Purpose"><submit/></default-field></field><field name="addButton"><default-field title="Add Purpose"><submit/></default-field></field><field-layout><field-ref name="contactMechPurposeId"/><field-row-big><field-ref name="updateButton"/><field-ref name="addButton"/></field-row-big></field-layout></form-single></container-dialog><link url="removeContactInfo" text=" " icon="fa fa-trash" confirmation="Remove Address?" parameter-map="[partyId:partyId, contactMechId:contactInfo.postalContactMechId,                                         contactMechPurposeId:contactInfo.postalContactMechPurposeId]"/><container><label text="Trust: ${contactInfo.postalTrustLevelEnum?.description ?: 'New'}" type="strong"/><link url="validateAddress" text="Validate" parameter-map="[partyId:partyId, contactMechId:contactInfo.postalContactMechId]" condition="!contactInfo.postalContactMech.trustLevelEnumId || contactInfo.postalContactMech.trustLevelEnumId == 'CmtlNew'"/><link url="updateContactMechMutable" text="Grey" parameter-map="[contactMechId:contactInfo.postalContactMechId, trustLevelEnumId:'CmtlGreylisted']" condition="!(contactInfo.postalContactMech.trustLevelEnumId in ['CmtlGreylisted', 'CmtlBlacklisted'])" confirmation="Really greylist this address?" btn-type="warning"/><link url="updateContactMechMutable" text="Black" parameter-map="[contactMechId:contactInfo.postalContactMechId, trustLevelEnumId:'CmtlBlacklisted']" condition="contactInfo.postalContactMech.trustLevelEnumId != 'CmtlBlacklisted'" confirmation="Really blacklist this address?" btn-type="danger"/><link url="updateContactMechMutable" text="Unlist" parameter-map="[contactMechId:contactInfo.postalContactMechId, trustLevelEnumId:'CmtlNew']" condition="contactInfo.postalContactMech.trustLevelEnumId in ['CmtlGreylisted', 'CmtlBlacklisted']" confirmation="Set trust level back to New?" btn-type="danger"/></container><label text="${contactInfo.postalContactMech.validateMessage?:''}" type="div"/></row-col><row-col lg="6"><label text="${contactInfo.postalContactMechPurpose.description}" type="strong"/><render-mode><text type="html,vuet,qvt" location="component://SimpleScreens/template/party/ContactInfo.html.gstring"/></render-mode></row-col></container-row></widgets></section-iterate></box-body></container-box></widgets></section><section name="PaymentMethodSection"><actions><service-call name="mantle.account.PaymentMethodServices.get#PartyPaymentMethodInfoList" in-map="[partyId:partyId]" out-map="ppmiOut"/></actions><widgets><container-box type="success"><box-header title="Payment Methods"/><box-toolbar><dynamic-dialog id="CreateCreditCardDialog" button-text="Create Credit Card" transition="UpdatePaymentMethodInfo" width="800" parameter-map="[partyId:partyId, paymentMethodTypeEnumId:'PmtCreditCard']"/><dynamic-dialog id="CreateBankAccountDialog" button-text="Create Bank Account" transition="UpdatePaymentMethodInfo" width="800" parameter-map="[partyId:partyId, paymentMethodTypeEnumId:'PmtBankAccount']"/></box-toolbar><box-body><container style="float-box" type="ul"><section-iterate name="BillingInfoSection" list="ppmiOut.methodInfoList" entry="methodInfo"><widgets><container type="li"><render-mode><text type="html,vuet,qvt" location="component://SimpleScreens/template/party/PaymentMethodInfo.html.gstring"/></render-mode><label text="CIM ID: ${methodInfo.paymentMethod.gatewayCimId}" type="div" condition="methodInfo.paymentMethod.gatewayCimId"/><label text="Gateway: ${methodInfo.paymentMethod.gatewayConfig?.description}" type="div" condition="methodInfo.paymentMethod?.paymentGatewayConfigId"/><dynamic-dialog id="UpdatePaymentMethodDialog" button-text="Update" transition="UpdatePaymentMethodInfo" width="800" parameter-map="[partyId:partyId, paymentMethodId:methodInfo.paymentMethodId]"/><link url="removePaymentMethod" text=" " icon="fa fa-trash" parameter-map="[paymentMethodId:methodInfo.paymentMethodId]" confirmation="Really delete Payment Method ${methodInfo.paymentMethodId}?"/><link url="editPaymentMethod" text="Detail" parameter-map="[partyId:partyId, paymentMethodId:methodInfo.paymentMethodId]"/></container></widgets></section-iterate></container></box-body></container-box></widgets></section><section name="FinancialAccountSection"><actions><entity-find entity-name="mantle.account.financial.FinancialAccount" list="financialAccountList"><econdition field-name="ownerPartyId" from="partyId"/></entity-find></actions><widgets><container-box type="success"><box-header title="Financial Accounts"/><box-toolbar><link url="findFinancialAccount" text="Find Accounts" parameter-map="[ownerPartyId:partyId]"/><link url="findFinancialAccount" text="Create Account" parameter-map="[ownerPartyId:partyId, _openDialog:'NewFinancialAccountDialog']"/></box-toolbar><box-body><form-list name="FinancialAccountList" list="financialAccountList" skip-form="true"><field name="finAccountName"><default-field title="Account"><link url="editFinancialAccount" text="FinancialAccountNameTemplate" link-type="anchor"/></default-field></field><field name="finAccountTypeId"><default-field title="Type"><display-entity entity-name="mantle.account.financial.FinancialAccountType"/></default-field></field><field name="organizationPartyId"><default-field title="Organization"><link url="." entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" link-type="anchor" parameter-map="[partyId:organizationPartyId]"/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem" also-hidden="false"/></default-field></field><field name="actualBalance" align="right"><default-field title="Balance"><display currency-unit-field="currencyUomId"/></default-field></field><field name="availableBalance" align="right"><default-field title="Available"><display currency-unit-field="currencyUomId"/></default-field></field></form-list></box-body></container-box></widgets></section><section name="ContentSection"><actions><entity-find entity-name="mantle.party.PartyContent" list="contentList"><econdition field-name="partyId"/><order-by field-name="-contentDate"/></entity-find></actions><widgets><container-box><box-header title="Content"/><box-toolbar><container-dialog id="NewContentDialog" button-text="Add Content"><form-single name="NewContentForm" transition="createContent"><field name="partyId"><default-field><hidden/></default-field></field><field name="partyContentTypeEnumId"><default-field title="Content Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="PartyContentType"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="contentFile"><default-field><file/></default-field></field><field name="description"><default-field tooltip="Put text content here or upload"><text-area cols="80"/></default-field></field><field name="submitButton"><default-field><submit text="Add"/></default-field></field></form-single></container-dialog></box-toolbar><box-body><section-iterate name="ContentIterateSection" list="contentList" entry="content"><actions><entity-find-one entity-name="mantle.party.PersonWithUserAccount" value-field="paua"><field-map field-name="userId" from="content.userId"/></entity-find-one><entity-find-one entity-name="moqui.basic.Enumeration" value-field="contentTypeEnum"><field-map field-name="enumId" from="content.partyContentTypeEnumId"/></entity-find-one></actions><widgets><container><container><label text="${contentTypeEnum?.description?:'No Type'}" type="strong"/></container><link url="downloadContent" condition="content.contentLocation" parameter-map="[partyContentId:content.partyContentId]" text="Download ${content.contentLocation.substring(content.contentLocation.lastIndexOf('/')+1)}"/><container-dialog id="UpdateContentContainer" button-text="Edit Content"><form-single name="UpdateContentForm" transition="updateContent" map="content"><field name="partyContentId"><default-field><hidden/></default-field></field><field name="partyId"><default-field><hidden/></default-field></field><field name="partyContentTypeEnumId"><default-field title="Content Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="PartyContentType"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="contentFile"><default-field><file/></default-field></field><field name="description"><default-field tooltip="Put text content here or upload"><text-area cols="80"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></container-dialog><container><label condition="paua" text="By ${ec.resource.expand('UsernameTemplate','',paua+[userId:content.userId])} at ${ec.l10n.format(content.contentDate, 'yyyy-MM-dd HH:mm')}"/></container><label text="${content.description ?: 'No Description'}" type="p"/></container></widgets></section-iterate></box-body></container-box></widgets></section></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Party/PartyCalendar.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Calendar" default-menu-index="2"><parameter name="partyId" required="true"/><transition name="eventDetail"><default-response url="."/></transition><transition name="taskDetail"><default-response url="."/></transition><transition name="getCalendarEvents"><service-call name="mantle.work.EventServices.get#FullCalendarData" web-send-json-response="eventList" in-map="context" out-map="context" multi="parameter"/><default-response type="none"/></transition><transition name="getCalendarTasks"><service-call name="mantle.work.TaskServices.get#FullCalendarData" web-send-json-response="eventList" in-map="context" out-map="context" multi="parameter"/><default-response type="none"/></transition><actions><entity-find-one entity-name="mantle.party.PartyDetail" value-field="party"/></actions><widgets><render-mode><text type="html,vuet,qvt"><![CDATA[<div id="calendar"></div><script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.1.0/fullcalendar.min.js" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.1.0/locale-all.js" type="text/javascript"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.1.0/fullcalendar.min.css" type="text/css"/><script>
    $('#calendar').fullCalendar({ timezone:false, defaultView:'agendaWeek', locale:'${ec.user.locale.toString()}',
        header: { left:'prev,next today', center:'title', right:'month,agendaWeek,agendaDay' },
        eventSources: [ { url:"${sri.buildUrl('getCalendarEvents').url}", type:'POST', data: { moquiSessionToken:'${ec.web.sessionToken}', partyId:'${partyId}' } },
            { url:"${sri.buildUrl('getCalendarTasks').url}", type:'POST', data:{ moquiSessionToken:'${ec.web.sessionToken}', partyId:'${partyId}' }, backgroundColor:'#5cb85c', borderColor:'#4cae4c' } ]
    });
            </script>]]></text></render-mode></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Party/PartyEmails.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Emails" default-menu-index="3"><parameter name="partyId" required="true"/><transition name="sendEmailMessage"><service-call name="org.moqui.impl.EmailServices.send#EmailMessage" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="EmailMessage" read-only="true"><parameter name="emailMessageId"/><actions><entity-find-one entity-name="moqui.basic.email.EmailMessage" value-field="emailMessage"/><script><![CDATA[ec.web.sendTextResponse(emailMessage?.body, "text/html", null)]]></script></actions><default-response type="none"/></transition><actions><entity-find entity-name="moqui.security.UserAccount" list="userAccountList"><econdition field-name="partyId"/></entity-find><set field="userIdList" from="userAccountList*.userId"/><entity-find entity-name="mantle.party.contact.PartyContactMechInfo" list="emailPcmList"><econdition field-name="partyId"/><econdition field-name="contactMechTypeEnumId" value="CmtEmailAddress"/><select-field field-name="infoString"/></entity-find><set field="emailAddressSet" from="new HashSet(emailPcmList*.infoString)"/></actions><widgets><section name="HasUserOrEmailAddress" condition="userIdList || emailAddressSet"><widgets><label text="User Accounts: ${userAccountList*.username.join(', ')}" condition="userAccountList"/><label text="Email Addresses: ${emailAddressSet.join(', ')}" condition="emailAddressSet"/><form-list name="EmailMessageList" list="emailMessageList" skip-form="true" header-dialog="true"><entity-find entity-name="moqui.basic.email.EmailMessage" list="emailMessageList"><search-form-inputs default-order-by="sentDate,emailMessageId"/><econditions combine="or"><econdition field-name="fromUserId" operator="in" from="userIdList" ignore-if-empty="true"/><econdition field-name="toUserId" operator="in" from="userIdList" ignore-if-empty="true"/><econdition field-name="toAddresses" operator="in" from="emailAddressSet" ignore-if-empty="true"/><econdition field-name="fromAddress" operator="in" from="emailAddressSet" ignore-if-empty="true"/></econditions></entity-find><hidden-parameters><parameter name="partyId"/></hidden-parameters><field name="emailMessageId"><default-field title="ID"><link url="EmailMessage" text="${emailMessageId}" link-type="anchor" target-window="_blank"/></default-field></field><field name="toAddresses"><default-field><display/></default-field></field><field name="statusId"><header-field title="Status" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="EmailMessage"/><set field="allowMultiple" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="sentDate"><header-field><date-period/></header-field><default-field><display/></default-field></field><field name="receivedDate"><header-field><date-period/></header-field><default-field><display/></default-field></field><field name="emailTypeEnumId"><header-field title="Email Type" show-order-by="true"><drop-down allow-multiple="true"><entity-options key="${enumId}" text="EnumerationNameTemplate"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="EmailType"/><order-by field-name="sequenceNum,description"/></entity-find></entity-options><entity-options key="${enumId}" text="EnumerationNameTemplate"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="ProductStoreEmailType"/><order-by field-name="sequenceNum,description"/></entity-find></entity-options></drop-down></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="viewLink"><default-field title=""><link url="EmailMessage" text="View Message" parameter-map="[emailMessageId:emailMessageId]" link-type="anchor-button" target-window="_blank"/></default-field></field><field name="sendLink"><default-field title=""><link url="sendEmailMessage" text="Send/Resend" parameter-map="[emailMessageId:emailMessageId]" condition="!(statusId in ['ES_DRAFT', 'ES_CANCELLED'])" confirmation="Send this email message? Note that this may not include attachments from original email."/></default-field></field><field name="findButton"><header-field title="Find"><submit/></header-field></field></form-list></widgets><fail-widgets><label text="Party has no user accounts and no email address, cannot search for email messages" type="h5"/></fail-widgets></section></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/MyAccount/User/Messages/FindMessage.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Message List" default-menu-include="false"><parameter name="partyId"/><transition name="editMessage"><default-response url="../EditMessage"/></transition><transition name="messageThread"><default-response url="../MessageThread"/></transition><transition name="createMessage"><service-call name="mantle.party.CommunicationServices.create#Message" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><actions><if condition="toCurrentUser == 'true'"><set field="toPartyId" from="ec.user.userAccount.partyId"/></if><entity-find entity-name="mantle.party.communication.CommunicationEventAndPurpose" list="commEventList"><search-form-inputs default-order-by="-entryDate"/><econditions combine="or"><econdition field-name="fromPartyId" from="partyId" ignore-if-empty="true"/><econdition field-name="toPartyId" from="partyId" ignore-if-empty="true"/></econditions><econdition field-name="communicationEventTypeId" operator="in" value="Email,Message,Comment"/><select-field field-name="communicationEventId"/><select-field field-name="entryDate"/><select-field field-name="statusId"/><select-field field-name="fromPartyId"/><select-field field-name="toPartyId"/><select-field field-name="subject"/><select-field field-name="communicationEventTypeId"/></entity-find><if condition="ec.user.userAccount.partyId != partyId"><set field="toPartyId" from="partyId"/></if></actions><widgets><container-dialog id="CreateMessageDialog" button-text="Send Message" width="800"><form-single name="CreateMessage" transition="createMessage"><field name="partyId"><default-field><hidden/></default-field></field><field name="fromPartyId" from="ec.user.userAccount.partyId"><default-field title="From"><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameTemplate"/></default-field></field><field name="toPartyId"><default-field title="To"><drop-down><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="purposeEnumId"><default-field title="Purpose"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="CommunicationPurpose"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="subject"><default-field><text-line size="60"/></default-field></field><field name="body"><default-field title="Message"><text-area cols="80" rows="20"/></default-field></field><field name="submitButton"><default-field title="Send"><submit/></default-field></field></form-single></container-dialog><form-list name="MessageList" list="commEventList" skip-form="true" header-dialog="true" saved-finds="true"><row-actions><entity-find entity-name="mantle.party.communication.CommunicationEventPurpose" list="cepList"><econdition field-name="communicationEventId"/><order-by field-name="purposeEnumId"/></entity-find></row-actions><hidden-parameters><parameter name="partyId"/></hidden-parameters><field name="entryDate"><header-field show-order-by="true"/><default-field title="Date"><display format="yyyy-MM-dd HH:mm"/></default-field></field><field name="statusId"><header-field show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="CommunicationEvent"/><set field="allowEmpty" value="true"/></widget-template-include></header-field><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem" also-hidden="false"/></default-field></field><field name="fromPartyId"><header-field title="From"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></header-field><default-field><display-entity entity-name="mantle.party.PartyDetail" also-hidden="false" key-field-name="partyId" text="PartyNameTemplate"/></default-field></field><field name="toPartyId"><header-field title="To"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></header-field><default-field><display-entity entity-name="mantle.party.PartyDetail" also-hidden="false" key-field-name="partyId" text="PartyNameTemplate"/></default-field></field><field name="subject"><header-field show-order-by="case-insensitive"/><default-field><link url="messageThread" text="${subject}" link-type="anchor"/></default-field></field><field name="communicationEventTypeId"><header-field title="Type"><drop-down allow-multiple="true"><entity-options text="${description}"><entity-find entity-name="mantle.party.communication.CommunicationEventType"><order-by field-name="description"/></entity-find></entity-options><option key="Comment"/><option key="Email"/><option key="Message"/></drop-down></header-field><default-field><display-entity entity-name="mantle.party.communication.CommunicationEventType"/></default-field></field><field name="purposeList"><header-field title="Purposes" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="CommunicationPurpose"/><set field="allowMultiple" value="true"/></widget-template-include></header-field><default-field><section-iterate name="PurposeListSection" list="cepList" entry="cep"><actions><entity-find-one entity-name="moqui.basic.Enumeration" value-field="purpEnum"><field-map field-name="enumId" from="cep.purposeEnumId"/></entity-find-one></actions><widgets><label text="${purpEnum.description}" type="p"/></widgets></section-iterate></default-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field><default-field><link url="editMessage" text="Edit"/><link url="messageThread" text="Thread"/></default-field></field><form-list-column><field-ref name="fromPartyId"/><field-ref name="toPartyId"/></form-list-column><form-list-column><field-ref name="subject"/></form-list-column><form-list-column><field-ref name="entryDate"/><field-ref name="statusId"/></form-list-column><form-list-column><field-ref name="communicationEventTypeId"/><field-ref name="purposeList"/></form-list-column><form-list-column><field-ref name="submitButton"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/MyAccount/User/Messages/EditMessage.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Message" default-menu-index="1"><parameter name="communicationEventId" required="true"/><parameter name="partyId"/><transition name="updateMessage"><service-call name="update#mantle.party.communication.CommunicationEvent" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateStatus"><service-call name="update#mantle.party.communication.CommunicationEvent" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createCommunicationEventPurpose"><service-call name="create#mantle.party.communication.CommunicationEventPurpose" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateCommunicationEventPurpose"><service-call name="update#mantle.party.communication.CommunicationEventPurpose" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteCommunicationEventPurpose"><service-call name="delete#mantle.party.communication.CommunicationEventPurpose" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="messageThread"><default-response url="../MessageThread"/></transition><transition name="replyMessage"><service-call name="mantle.party.CommunicationServices.reply#CommunicationEvent" in-map="true" out-map="context" multi="parameter"/><default-response url="../MessageThread"/></transition><actions><entity-find-one entity-name="mantle.party.communication.CommunicationEvent" value-field="commEvent"/><set field="statusId" from="commEvent.statusId"/><set field="changedEntityName" value="mantle.party.communication.CommunicationEvent"/><set field="pkPrimaryValue" from="commEvent.communicationEventId"/></actions><widgets><container style="row"><container style="col-lg-6"><label text="${commEvent.subject ?: 'Message'}" type="h3"/><link url="messageThread" text="Thread"/><container-dialog id="ReplyDialog" button-text="Reply"><form-single name="ReplyMessageForm" transition="replyMessage"><field name="communicationEventId"><default-field><hidden/></default-field></field><field name="partyId"><default-field><hidden/></default-field></field><field name="parentCommEventId" from="communicationEventId"><default-field><hidden/></default-field></field><field name="subject"><default-field><text-line default-value="Re: ${commEvent.subject}" size="60"/></default-field></field><field name="body"><default-field title=""><text-area rows="10" cols="80"/></default-field></field><field name="submitButton"><default-field title="Reply"><submit/></default-field></field><field-layout><field-ref name="subject"/><field-row-big><field-ref name="body"/></field-row-big><field-ref name="submitButton"/></field-layout></form-single></container-dialog><form-single name="MessageForm" map="commEvent" transition="updateMessage"><field name="communicationEventId"><default-field><hidden/></default-field></field><field name="partyId"><default-field><hidden/></default-field></field><field name="fromPartyId"><default-field title="From"><display-entity entity-name="mantle.party.PartyDetail" also-hidden="false" key-field-name="partyId" text="PartyNameTemplate"/></default-field></field><field name="toPartyId"><default-field title="To"><display-entity entity-name="mantle.party.PartyDetail" also-hidden="false" key-field-name="partyId" text="PartyNameTemplate"/></default-field></field><field name="communicationEventTypeId"><default-field title="Type"><display-entity entity-name="mantle.party.communication.CommunicationEventType"/></default-field></field><field name="body"><default-field title=""><text-area cols="110" rows="16"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></container><container style="col-lg-6"><section-include name="StatusChangeAndHistorySection" location="component://SimpleScreens/template/basic/StatusWidgets.xml"/><section name="CommunicationEventPurposeSection"><actions><entity-find entity-name="mantle.party.communication.CommunicationEventPurpose" list="purposeList"><econdition field-name="communicationEventId"/><order-by field-name="purposeEnumId"/></entity-find><set field="purposeEnumIds" from="purposeList*.purposeEnumId"/></actions><widgets><container-box><box-header title="Purposes"/><box-toolbar><container-dialog id="AddPurposeDialog" button-text="Add Purpose"><form-single name="AddPurposeForm" transition="createCommunicationEventPurpose"><field name="communicationEventId"><default-field><hidden/></default-field></field><field name="partyId"><default-field><hidden/></default-field></field><field name="purposeEnumId"><default-field title="Purpose"><drop-down><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="CommunicationPurpose"/><econdition field-name="enumId" operator="not-in" from="purposeEnumIds" ignore-if-empty="true"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="description"><default-field title="Note"><text-line size="20"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body-nopad><form-list name="PurposesForm" list="purposeList" transition="updateCommunicationEventPurpose"><field name="communicationEventId"><default-field><hidden/></default-field></field><field name="partyId"><default-field><hidden/></default-field></field><field name="purposeEnumId"><default-field title="Purpose"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="description"><default-field title="Note"><text-line size="20"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field name="removeButton"><default-field title=""><link url="deleteCommunicationEventPurpose" text=" " icon="fa fa-trash" confirmation="Delete this Purpose?"/></default-field></field></form-list></box-body-nopad></container-box></widgets></section></container></container></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/MyAccount/User/Messages/MessageThread/SingleMessage.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="communicationEventId" required="true"/><parameter name="partyId"/><transition name="editMessage"><default-response url="../../EditMessage"/></transition><transition name="messageThread"><default-response url=".."/></transition><transition name="updateStatus"><service-call name="update#mantle.party.communication.CommunicationEvent" in-map="true" out-map="context" multi="parameter"/><default-response url=".."/></transition><transition name="replyMessage"><service-call name="mantle.party.CommunicationServices.reply#CommunicationEvent" in-map="context" out-map="context" multi="parameter"/><default-response url=".."/></transition><actions><entity-find-one entity-name="mantle.party.communication.CommunicationEvent" value-field="commEvent"/><entity-find-one entity-name="mantle.party.PartyDetail" value-field="fromParty"><field-map field-name="partyId" from="commEvent?.fromPartyId"/></entity-find-one><entity-find-one entity-name="mantle.party.PartyDetail" value-field="toParty"><field-map field-name="partyId" from="commEvent?.toPartyId"/></entity-find-one><set field="statusId" from="commEvent.statusId"/></actions><widgets><container-box><box-header title="${commEvent.subject ?: 'Message'}"/><box-toolbar><link url="editMessage" text="Edit"/><container-dialog id="ReplyDialog" button-text="Reply"><form-single name="ReplyMessageForm" transition="replyMessage"><field name="communicationEventId"><default-field><hidden/></default-field></field><field name="partyId"><default-field><hidden/></default-field></field><field name="parentCommEventId" from="communicationEventId"><default-field><hidden/></default-field></field><field name="subject"><default-field><text-line default-value="Re: ${commEvent.subject}" size="60"/></default-field></field><field name="body"><default-field title=""><text-area rows="10" cols="80"/></default-field></field><field name="submitButton"><default-field title="Reply"><submit/></default-field></field><field-layout><field-ref name="subject"/><field-row-big><field-ref name="body"/></field-row-big><field-ref name="submitButton"/></field-layout></form-single></container-dialog></box-toolbar><box-body><container><label text="From ${ec.resource.expand('PartyNameTemplate','',fromParty)}," type="strong"/><label text="to ${ec.resource.expand('PartyNameTemplate','',toParty)}" type="strong"/><label text="at ${ec.l10n.format(commEvent?.entryDate, 'yyyy-MM-dd HH:mm')}" type="strong"/></container><section-include name="StatusChangeSection" location="component://SimpleScreens/template/basic/StatusWidgets.xml"/><label text="${commEvent.body}" type="pre"/></box-body></container-box></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/MyAccount/User/Messages/MessageThread.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Message" default-menu-index="1"><parameter name="communicationEventId" required="true"/><parameter name="partyId"/><transition name="singleMessage"><default-response url="SingleMessage"/></transition><transition name="messageThread"><default-response url="."/></transition><actions><entity-find-one entity-name="mantle.party.communication.CommunicationEvent" value-field="commEvent"/><set field="rootCommEventId" from="commEvent.rootCommEventId ?: commEvent.communicationEventId"/><entity-find-one entity-name="mantle.party.communication.CommunicationEvent" value-field="rootCommEvent"><field-map field-name="communicationEventId" from="rootCommEventId"/></entity-find-one><script><![CDATA[idPathSb = new StringBuilder(commEvent.communicationEventId)
            def curCe = commEvent
            while (curCe.parentCommEventId) {
                idPathSb.insert(0, "/").insert(0, curCe.parentCommEventId)
                curCe = ec.entity.find("mantle.party.communication.CommunicationEvent")
                        .condition("communicationEventId", curCe.parentCommEventId).one()
            }]]></script></actions><widgets><label text="${rootCommEvent?.subject ?: 'Thread'}" type="h3"/><container style="row"><container style="col-lg-4"><tree name="MessageTree" open-path="${idPathSb.toString()}"><parameter name="rootCommEventId"/><tree-node name="MessageNode"><actions><entity-find-one entity-name="mantle.party.PartyDetail" value-field="msgFrom"><field-map field-name="partyId" from="nodeList_entry?.fromPartyId"/></entity-find-one><entity-find-one entity-name="moqui.basic.StatusItem" value-field="statusItem"><field-map field-name="statusId" from="nodeList_entry?.statusId"/></entity-find-one></actions><link url="singleMessage" dynamic-load-id="SingleMessageContainer" text="${ec.resource.expand('PartyNameOnlyTemplate','',msgFrom)} at ${ec.l10n.format(nodeList_entry?.entryDate, 'yyyy-MM-dd HH:mm')} (${statusItem?.description})" id="${treeNodeId == '#' ? '' : treeNodeId + '/'}${nodeList_entry?.communicationEventId}"><parameter name="communicationEventId" from="nodeList_entry?.communicationEventId"/><parameter name="partyId"/></link><tree-sub-node node-name="MessageNode" list="childMessages"><actions><set field="messageId" from="treeNodeId.split('/').last()"/><entity-find entity-name="mantle.party.communication.CommunicationEvent" list="childMessages"><econdition field-name="parentCommEventId" from="messageId"/><order-by field-name="entryDate"/></entity-find></actions></tree-sub-node></tree-node><tree-sub-node node-name="MessageNode" list="topLevelMessages"><actions><entity-find-one entity-name="mantle.party.communication.CommunicationEvent" value-field="rootCommEvent"><field-map field-name="communicationEventId" from="rootCommEventId"/></entity-find-one><set field="topLevelMessages" from="[rootCommEvent]"/></actions></tree-sub-node></tree></container><container style="col-lg-8"><dynamic-container id="SingleMessageContainer" transition="singleMessage"/></container></container></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Party/PartyMessages.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Messages" default-menu-index="3"><parameter name="partyId" required="true"/><subscreens default-item="FindMessage"><subscreens-item name="FindMessage" menu-include="false" location="component://SimpleScreens/screen/MyAccount/User/Messages/FindMessage.xml"/><subscreens-item name="EditMessage" menu-title="Message" menu-index="1" location="component://SimpleScreens/screen/MyAccount/User/Messages/EditMessage.xml"/><subscreens-item name="MessageThread" menu-title="Thread" menu-index="2" location="component://SimpleScreens/screen/MyAccount/User/Messages/MessageThread.xml"/></subscreens><widgets><subscreens-active/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Party/PartyRelated.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Related" default-menu-index="4"><parameter name="partyId" required="true"/><transition name="editParty"><default-response url="../EditParty"/></transition><transition name="createPartyRelationship"><service-call name="create#mantle.party.PartyRelationship" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updatePartyRelationship"><service-call name="update#mantle.party.PartyRelationship" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><actions><entity-find-one entity-name="mantle.party.PartyDetail" value-field="partyDetail"/><entity-find entity-name="mantle.party.PartyToAndRelationship" list="toRelList"><search-form-inputs default-order-by="pseudoId,organizationName,firstName,lastName"/><date-filter/><econdition field-name="fromPartyId" from="partyId"/></entity-find><entity-find entity-name="mantle.party.PartyFromAndRelationship" list="fromRelList"><search-form-inputs default-order-by="pseudoId,organizationName,firstName,lastName"/><date-filter/><econdition field-name="toPartyId" from="partyId"/></entity-find><entity-find entity-name="mantle.party.RoleType" list="roleTypeList"><order-by field-name="description"/></entity-find></actions><widgets><container-dialog id="NewRelationshipDialog" button-text="New Relationship" width="800"><form-single name="NewToRelForm" transition="createPartyRelationship"><field name="partyId"><default-field><hidden/></default-field></field><field name="fromPartyId" from="partyId"><default-field title=""><display text="PartyNameTemplate" text-map="partyDetail"/></default-field></field><field name="fromRoleTypeId"><default-field title="in role"><drop-down allow-empty="true"><list-options list="roleTypeList" key="${roleTypeId}"/></drop-down></default-field></field><field name="relationshipTypeEnumId"><default-field title="is a"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="PartyRelationshipType"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="toPartyId"><default-field title="of"><drop-down><dynamic-options transition="searchPartyList" server-search="true" min-length="2" parameter-map="[roleTypeId:null]"/></drop-down></default-field></field><field name="toRoleTypeId"><default-field title="in role"><drop-down allow-empty="true"><list-options list="roleTypeList" key="${roleTypeId}"/></drop-down></default-field></field><field name="fromDate" from="ec.user.nowTimestamp"><default-field><hidden/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single><form-single name="NewFromRelForm" transition="createPartyRelationship"><field name="partyId"><default-field><hidden/></default-field></field><field name="fromPartyId"><default-field title=""><drop-down><dynamic-options transition="searchPartyList" server-search="true" min-length="2" parameter-map="[roleTypeId:null]"/></drop-down></default-field></field><field name="fromRoleTypeId"><default-field title="in role"><drop-down allow-empty="true"><list-options list="roleTypeList" key="${roleTypeId}"/></drop-down></default-field></field><field name="relationshipTypeEnumId"><default-field title="is a"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="PartyRelationshipType"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="toPartyId" from="partyId"><default-field title="of"><display text="PartyNameTemplate" text-map="partyDetail"/></default-field></field><field name="toRoleTypeId"><default-field title="in role"><drop-down allow-empty="true"><list-options list="roleTypeList" key="${roleTypeId}"/></drop-down></default-field></field><field name="fromDate" from="ec.user.nowTimestamp"><default-field><hidden/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="ToRelationshipForm" list="toRelList" transition="updatePartyRelationship" header-dialog="true" saved-finds="true"><field name="partyRelationshipId"><default-field><hidden/></default-field></field><field name="partyId"><header-field><hidden/></header-field><default-field><hidden/></default-field></field><field name="fromPartyId"><default-field title="From Party"><display text="PartyNameTemplate" text-map="partyDetail"/></default-field></field><field name="fromRoleTypeId"><default-field title="From Role"><display-entity entity-name="mantle.party.RoleType" text="in role ${description}"/></default-field></field><field name="relationshipTypeEnumId"><header-field show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="PartyRelationshipType"/><set field="allowEmpty" value="true"/><set field="style" value=" "/></widget-template-include></header-field><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration" text="is a ${description} of"/></default-field></field><field name="toPartyId"><header-field show-order-by="true"><drop-down><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></header-field><default-field title="To Party"><link url="editParty" text="PartyNameTemplate" entity-name="mantle.party.PartyDetail" parameter-map="[partyId:toPartyId]" link-type="anchor"/></default-field></field><field name="toRoleTypeId"><default-field title="To Role"><display-entity entity-name="mantle.party.RoleType" text="in role ${description}"/></default-field></field><field name="fromDate"><header-field show-order-by="true"/><default-field><display/></default-field></field><field name="thruDate" from="ec.user.nowTimestamp"><default-field><hidden/></default-field></field><field name="submitButton" align="right"><header-field title="Find"><submit/></header-field><default-field title=""><submit text="X"/></default-field></field></form-list><form-list name="FromRelationshipForm" list="fromRelList" transition="updatePartyRelationship" header-dialog="true" saved-finds="true"><field name="partyRelationshipId"><default-field><hidden/></default-field></field><field name="partyId"><header-field><hidden/></header-field><default-field><hidden/></default-field></field><field name="fromPartyId"><header-field show-order-by="true"><drop-down><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></header-field><default-field title="From Party"><link url="editParty" text="PartyNameTemplate" parameter-map="[partyId:fromPartyId]" link-type="anchor"/></default-field></field><field name="fromRoleTypeId"><default-field title="From Role"><display-entity entity-name="mantle.party.RoleType" text="in role ${description}"/></default-field></field><field name="relationshipTypeEnumId"><header-field show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="PartyRelationshipType"/><set field="allowEmpty" value="true"/><set field="style" value=" "/></widget-template-include></header-field><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration" text="is a ${description} of"/></default-field></field><field name="toPartyId"><default-field title="To Party"><display text="PartyNameTemplate" text-map="partyDetail"/></default-field></field><field name="toRoleTypeId"><default-field title="To Role"><display-entity entity-name="mantle.party.RoleType" text="in role ${description}"/></default-field></field><field name="fromDate"><header-field show-order-by="true"/><default-field><display/></default-field></field><field name="thruDate" from="ec.user.nowTimestamp"><default-field><hidden/></default-field></field><field name="submitButton" align="right"><header-field title="Find"><submit/></header-field><default-field title=""><submit text="X"/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Party/PartyTimeEntries/EditTimeEntry.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="timeEntryId"/><parameter name="partyId" from="partyId ?: ec.user.userAccount?.partyId"/><parameter name="clockInMode"/><transition name="recordTimeEntry"><service-call name="mantle.work.TimeServices.store#TimeEntry" in-map="context" out-map="context" multi="parameter"/><default-response url=".."/></transition><transition-include name="getFacilityList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><transition-include name="getTaskList" location="component://SimpleScreens/template/work/WorkTransitions.xml"/><actions><if condition="!partyId"><return error="true" message="No party specified"/></if><if condition="timeEntryId"><entity-find-one entity-name="mantle.work.time.TimeEntry" value-field="timeEntry"/><if condition="timeEntry != null && timeEntry.partyId != partyId"><return error="true" message="Time Entry ${timeEntryId} owned by different party"/></if></if><service-call name="mantle.humanres.PositionServices.get#PartyEmployersAndPositionClasses" in-map="[partyId:partyId]" out-map="context"/><set field="entryEditable" from="timeEntry?.invoiceId == null && timeEntry?.vendorInvoiceId == null"/><set field="hasRatePermission" from="clockInMode ? false : ec.user.hasPermission('TIME_ENTRY_RATE')"/></actions><widgets><form-single name="AddTimeForm" transition="recordTimeEntry" map="timeEntry"><field name="partyId"><default-field><hidden/></default-field></field><field name="timeEntryId"><default-field><hidden/></default-field></field><field name="clientPartyId"><conditional-field title="Employer" condition="entryEditable"><drop-down allow-empty="true"><list-options list="employerPartyList" key="${partyId}" text="PartyNameTemplate"/></drop-down></conditional-field><default-field title="Employer"><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameTemplate"/></default-field></field><field name="workEffortId"><conditional-field title="Task" condition="entryEditable"><drop-down allow-empty="true"><dynamic-options transition="getTaskList" min-length="0" server-search="true" parameter-map="[assignedPartyId:partyId]"/></drop-down></conditional-field><default-field title="Task"><display-entity entity-name="mantle.work.effort.WorkEffort" text="WorkEffortNameTemplate"/></default-field></field><field name="facilityId"><conditional-field title="Facility" condition="entryEditable"><drop-down allow-empty="true"><dynamic-options transition="getFacilityList" server-search="true" min-length="0"/></drop-down></conditional-field><default-field title="Facility"><display-entity text="FacilityNameTemplate" entity-name="mantle.facility.Facility"/></default-field></field><field name="workTypeEnumId"><conditional-field title="Work Type" condition="entryEditable"><drop-down><list-options list="workTypeEnumerationList" key="${enumId}" text="${description}"/></drop-down></conditional-field><default-field title="Work Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="emplPositionClassId"><conditional-field title="Position Class" condition="entryEditable"><drop-down allow-empty="true"><list-options list="emplPositionClassList" key="${emplPositionClassId}" text="${title}"/></drop-down></conditional-field><default-field title="Position Class"><display-entity entity-name="mantle.humanres.position.EmplPositionClass" text="${title}"/></default-field></field><field name="rateTypeEnumId"><conditional-field title="Rate Type" condition="entryEditable"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumGroupDropDown"><set field="enumGroupEnumId" value="EngRateCommonEntry"/></widget-template-include></conditional-field><default-field title="Rate Type"><display-entity entity-name="moqui.basic.Enumeration" key-field-name="enumId"/></default-field></field><field name="breakHours"><conditional-field condition="entryEditable && !clockInMode" tooltip="Unpaid break time"><text-line size="5" default-value="0"/></conditional-field><conditional-field condition="!clockInMode"><display/></conditional-field></field><field name="pieceCount"><conditional-field condition="entryEditable && !clockInMode"><text-line size="6"/></conditional-field><conditional-field condition="!clockInMode"><display/></conditional-field></field><field name="instructions1"><conditional-field title="" condition="timeEntry?.fromDate != null && timeEntry?.thruDate == null"><display text="To clock out now leave Hours and Thru empty; specify Hours or Thru if your clock out time is in the past"/></conditional-field><conditional-field title="" condition="!clockInMode"><display text="Enter values for 2 of the 3 below, or just Hours or From and Thru will be set to now"/></conditional-field></field><field name="fromDate"><conditional-field condition="entryEditable"><date-time minute-stepping="1"/></conditional-field><default-field title="From"><display/></default-field></field><field name="thruDate"><conditional-field title="Thru" condition="entryEditable && !clockInMode"><date-time minute-stepping="1"/></conditional-field><conditional-field title="Thru" condition="!clockInMode"><display/></conditional-field></field><field name="hours"><conditional-field condition="entryEditable && !clockInMode" tooltip="Work and paid break time"><text-line size="5"/></conditional-field><conditional-field condition="!clockInMode"><display/></conditional-field></field><field name="comments"><default-field><text-area cols="100" rows="3"/></default-field></field><field name="submitButton"><default-field title=""><submit text="${timeEntryId ? 'Update' : 'Add'} Time Entry"/></default-field></field><field name="hasModifiedRates"><conditional-field title="Rates Modified" condition="hasRatePermission"><display text="${hasModifiedRates ?: 'N'}"/></conditional-field></field><field name="clientHourRate"><conditional-field condition="entryEditable && hasRatePermission"><text-line size="8" format="0.00#"/></conditional-field><conditional-field condition="hasRatePermission"><display format="0.00#"/></conditional-field></field><field name="rateAmountId"><conditional-field title="Client Hour Calc" condition="hasRatePermission"><display-entity text="C: ${ec.l10n.format(rateAmount, '0.00')} (${rateAmountId})" entity-name="mantle.humanres.rate.RateAmount"/></conditional-field></field><field name="vendorHourRate"><conditional-field title="Worker Hour Rate" condition="entryEditable && hasRatePermission"><text-line size="8" format="0.00"/></conditional-field><conditional-field title="Worker Hour Rate" condition="hasRatePermission"><display format="0.00"/></conditional-field></field><field name="vendorRateAmountId"><conditional-field title="Worker Hour Calc" condition="hasRatePermission"><display-entity text="W: ${ec.l10n.format(rateAmount, '0.00')} (${rateAmountId})" entity-name="mantle.humanres.rate.RateAmount"/></conditional-field></field><field name="pieceRateTypeEnumId"><conditional-field title="Piece Rate Type" condition="hasRatePermission"><display-entity entity-name="moqui.basic.Enumeration" key-field-name="enumId"/></conditional-field></field><field name="clientPieceRate"><conditional-field condition="entryEditable && hasRatePermission"><text-line size="8" format="0.00#"/></conditional-field><conditional-field condition="hasRatePermission"><display format="0.00#"/></conditional-field></field><field name="pieceRateAmountId"><conditional-field title="Client Piece Calc" condition="hasRatePermission"><display-entity text="C: ${ec.l10n.format(rateAmount, '0.00')} (${rateAmountId})" entity-name="mantle.humanres.rate.RateAmount"/></conditional-field></field><field name="vendorPieceRate"><conditional-field title="Worker Piece Rate" condition="entryEditable && hasRatePermission"><text-line size="8" format="0.00#"/></conditional-field><conditional-field title="Worker Piece Rate" condition="hasRatePermission"><display format="0.00#"/></conditional-field></field><field name="vendorPieceRateAmountId"><conditional-field title="Worker Piece Calc" condition="hasRatePermission"><display-entity text="W: ${ec.l10n.format(rateAmount, '0.00')} (${rateAmountId})" entity-name="mantle.humanres.rate.RateAmount"/></conditional-field></field><field-layout><field-ref name="clientPartyId"/><field-ref name="workEffortId"/><field-ref name="facilityId"/><field-row><field-ref name="workTypeEnumId"/><field-ref name="emplPositionClassId"/></field-row><field-ref name="rateTypeEnumId"/><field-row><field-ref name="breakHours"/><field-ref name="pieceCount"/></field-row><field-ref name="instructions1"/><field-row><field-ref name="fromDate"/><field-ref name="thruDate"/></field-row><field-ref name="hours"/><field-ref name="comments"/><field-ref name="submitButton"/><field-accordion active="false"><field-group title="Rates"><field-ref name="hasModifiedRates"/><field-row><field-ref name="clientHourRate"/><field-ref name="rateAmountId"/></field-row><field-row><field-ref name="vendorHourRate"/><field-ref name="vendorRateAmountId"/></field-row><field-ref name="pieceRateTypeEnumId"/><field-row><field-ref name="clientPieceRate"/><field-ref name="pieceRateAmountId"/></field-row><field-row><field-ref name="vendorPieceRate"/><field-ref name="vendorPieceRateAmountId"/></field-row></field-group></field-accordion></field-layout></form-single></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Party/PartyTimeEntries.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Time" default-menu-index="5"><parameter name="partyId" required="true"/><transition name="editInvoice"><default-response url="//${appRoot}/Accounting/Invoice/EditInvoice"/></transition><transition name="recordTimeEntry"><service-call name="mantle.work.TimeServices.store#TimeEntry" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="clockInTimeEntry"><service-call name="mantle.work.TimeServices.create#TimeEntryClockIn" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="resetAndGetTimeEntryRates"><service-call name="mantle.work.TimeServices.resetAndGet#TimeEntryRates" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createWorkerInvoiceItems"><service-call name="mantle.account.InvoiceServices.create#WorkerInvoiceItems" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getFacilityList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><transition-include name="getTaskList" location="component://SimpleScreens/template/work/WorkTransitions.xml"/><transition-include name="getOpenVendorInvoicesByFromParty" location="component://SimpleScreens/template/work/WorkTransitions.xml"/><actions><entity-find entity-name="mantle.work.time.TimeEntry" list="timeEntryList"><search-form-inputs default-order-by="-fromDate"/><econdition field-name="partyId"/></entity-find><service-call name="mantle.humanres.PositionServices.get#PartyEmployersAndPositionClasses" in-map="[partyId:partyId]" out-map="context"/><set field="hasRatePermission" from="ec.user.hasPermission('TIME_ENTRY_RATE')"/></actions><widgets><section name="ClockInOutSection"><actions><if condition="openTimeEntry == null"><entity-find entity-name="mantle.work.time.TimeEntry" list="openTimeEntryList"><econdition field-name="partyId" from="partyId ?: ec.user.userAccount?.partyId"/><econdition field-name="thruDate" operator="is-null"/><order-by field-name="-fromDate"/></entity-find><set field="openTimeEntry" from="openTimeEntryList ? openTimeEntryList[0] : null"/></if></actions><widgets><section name="ClockInOutInnerSection" condition="openTimeEntry != null"><widgets><dynamic-dialog id="ClockOutDialogDyn" button-text="Clock Out" transition="EditTimeEntry" parameter-map="[partyId:partyId, timeEntryId:openTimeEntry.timeEntryId]" type="success"/></widgets><fail-widgets><container-dialog id="ClockInDialog" button-text="Clock In" type="success"><form-single name="ClockInForm" transition="clockInTimeEntry"><field name="partyId"><default-field><hidden/></default-field></field><field name="clientPartyId"><default-field title="Employer"><drop-down allow-empty="true"><list-options list="employerPartyList" key="${partyId}" text="PartyNameTemplate"/></drop-down></default-field></field><field name="workEffortId"><default-field title="Task"><drop-down allow-empty="true"><dynamic-options transition="getTaskList" min-length="0" server-search="true" parameter-map="[assignedPartyId:partyId]"/></drop-down></default-field></field><field name="facilityId"><default-field title="Facility"><drop-down allow-empty="true"><dynamic-options transition="getFacilityList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="workTypeEnumId"><default-field title="Work Type"><drop-down><list-options list="workTypeEnumerationList" key="${enumId}" text="${description}"/></drop-down></default-field></field><field name="emplPositionClassId"><default-field title="Position Class"><drop-down allow-empty="true"><list-options list="emplPositionClassList" key="${emplPositionClassId}" text="${title}"/></drop-down></default-field></field><field name="rateTypeEnumId"><default-field title="Rate Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumGroupDropDown"><set field="enumGroupEnumId" value="EngRateCommonEntry"/><set field="noCurrentSelectedKey" value="RatpStandard"/></widget-template-include></default-field></field><field name="comments"><default-field><text-area cols="100" rows="3"/></default-field></field><field name="fromDate"><default-field title="From"><date-time minute-stepping="1"/></default-field></field><field name="submitButton"><default-field title="Clock In"><submit/></default-field></field></form-single></container-dialog></fail-widgets></section></widgets></section><dynamic-dialog id="AddTimeDialogDyn" button-text="Record Time" transition="EditTimeEntry" parameter-map="[partyId:partyId, timeEntryId:'']"/><link url="resetAndGetTimeEntryRates" text="Auto Update Rates" parameter-map="[partyId:partyId]"/><container-dialog id="WorkerInvoiceDialog" button-text="Worker Invoice" width="700"><form-single name="WorkerInvoice" transition="createWorkerInvoiceItems"><field name="partyId"><default-field><hidden/></default-field></field><field name="workerPartyId" from="partyId"><default-field><hidden/></default-field></field><field name="ratePurposeEnumId"><default-field><hidden default-value="RaprVendor"/></default-field></field><field name="vendorPartyId"><default-field title="Employer"><drop-down><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="partyId" from="activeOrgId" ignore="!activeOrgId"/><econdition field-name="roleTypeId" operator="in" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></default-field></field><field name="thruDate"><default-field><date-time type="date-time"/></default-field></field><field name="invoiceId"><default-field title="Existing Invoice"><drop-down><dynamic-options transition="getOpenVendorInvoicesByFromParty" value-field="invoiceId" label-field="label" server-search="true" min-length="0"><depends-on field="workerPartyId"/></dynamic-options></drop-down></default-field></field><field name="submitButton"><default-field title="Invoice Time"><submit/></default-field></field></form-single></container-dialog><form-list name="TimeEntryList" list="timeEntryList" transition="recordTimeEntry" header-dialog="true" saved-finds="true" select-columns="true"><row-actions><set field="entryEditable" from="!invoiceId && !vendorInvoiceId"/></row-actions><field name="partyId"><header-field><hidden/></header-field><default-field><hidden/></default-field></field><field name="timeEntryId"><default-field><hidden/></default-field></field><field name="fromDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="thruDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="hours" align="center"><header-field show-order-by="true"/><default-field><display/></default-field></field><field name="breakHours" align="center"><header-field title="Break" show-order-by="true"/><default-field><display/></default-field></field><field name="pieceCount" align="center"><header-field show-order-by="true"/><default-field><display/></default-field></field><field name="clientPartyId"><header-field title="Employer"><drop-down allow-empty="true"><list-options list="employerPartyList" key="${partyId}" text="PartyNameTemplate"/></drop-down></header-field><default-field><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameTemplate"/></default-field></field><field name="workEffortId"><header-field title="Task" show-order-by="true"><drop-down allow-empty="true"><dynamic-options transition="getTaskList" min-length="0" server-search="true" parameter-map="[assignedPartyId:partyId]"/></drop-down></header-field><default-field><display-entity entity-name="mantle.work.effort.WorkEffort" text="WorkEffortNameTemplate"/></default-field></field><field name="facilityId"><header-field title="Facility" show-order-by="true"><drop-down allow-empty="true"><dynamic-options transition="getFacilityList" server-search="true" min-length="0"/></drop-down></header-field><default-field><link url="editFacility" text="FacilityNameTemplate" entity-name="mantle.facility.Facility" link-type="anchor"/></default-field></field><field name="workTypeEnumId"><header-field title="Work Type" show-order-by="true"><drop-down allow-empty="true"><list-options list="workTypeEnumerationList" key="${enumId}" text="${description}"/></drop-down></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="emplPositionClassId"><header-field title="Position Class" show-order-by="true"><drop-down allow-empty="true"><list-options list="emplPositionClassList" key="${emplPositionClassId}" text="${title}"/></drop-down></header-field><default-field><display-entity entity-name="mantle.humanres.position.EmplPositionClass" text="${title}"/></default-field></field><field name="rateTypeEnumId"><header-field title="Rate Type" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumGroupDropDown"><set field="enumGroupEnumId" value="EngRateCommonEntry"/><set field="allowEmpty" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration" key-field-name="enumId"/></default-field></field><field name="clientHourRate"><default-field title="Client Hour Rate"><display format="0.00#"/></default-field></field><field name="rateAmountId"><default-field title="Client Hour Calc"><display-entity text="C: ${ec.l10n.format(rateAmount, '0.00')} (${rateAmountId})" entity-name="mantle.humanres.rate.RateAmount"/></default-field></field><field name="vendorHourRate"><default-field title="Worker Hour Rate"><display format="0.00"/></default-field></field><field name="vendorRateAmountId"><default-field title="Worker Hour Calc"><display-entity text="W: ${ec.l10n.format(rateAmount, '0.00')} (${rateAmountId})" entity-name="mantle.humanres.rate.RateAmount"/></default-field></field><field name="pieceRateTypeEnumId"><default-field title="Piece Rate Type"><display-entity entity-name="moqui.basic.Enumeration" key-field-name="enumId"/></default-field></field><field name="clientPieceRate"><default-field title="Client Piece Rate"><display format="0.00#"/></default-field></field><field name="pieceRateAmountId"><default-field title="Client Piece Calc"><display-entity text="C: ${ec.l10n.format(rateAmount, '0.00')} (${rateAmountId})" entity-name="mantle.humanres.rate.RateAmount"/></default-field></field><field name="vendorPieceRate"><default-field title="Worker Piece Rate"><display format="0.00#"/></default-field></field><field name="vendorPieceRateAmountId"><default-field title="Worker Piece Calc"><display-entity text="W: ${ec.l10n.format(rateAmount, '0.00')} (${rateAmountId})" entity-name="mantle.humanres.rate.RateAmount"/></default-field></field><field name="hasModifiedRates"><header-field title="Mod" show-order-by="true"><drop-down allow-empty="true"><option key="Y"/><option key="N"/></drop-down></header-field><default-field><display/></default-field></field><field name="comments"><header-field show-order-by="true"/><default-field><display/></default-field></field><field name="invoiceId"><header-field show-order-by="true"/><default-field title="Client Invoice"><link url="editInvoice" text="C: ${invoiceId}" link-type="anchor" condition="invoiceId" parameter-map="[invoiceId:invoiceId]"/></default-field></field><field name="vendorInvoiceId"><header-field show-order-by="true"/><default-field title="Worker Invoice"><link url="editInvoice" text="W: ${vendorInvoiceId}" link-type="anchor" condition="vendorInvoiceId" parameter-map="[invoiceId:vendorInvoiceId]"/></default-field></field><field name="findButton" align="right"><header-field title="Find"><submit/></header-field><default-field><dynamic-dialog id="EditTimeEntryDialog" button-text="Edit" icon="fa fa-pencil" transition="EditTimeEntry" parameter-map="[partyId:partyId, timeEntryId:timeEntryId]"/></default-field></field><form-list-column><field-ref name="fromDate"/><field-ref name="thruDate"/></form-list-column><form-list-column><field-ref name="hours"/><field-ref name="breakHours"/><field-ref name="pieceCount"/></form-list-column><form-list-column><field-ref name="clientPartyId"/><field-ref name="workEffortId"/><field-ref name="facilityId"/></form-list-column><form-list-column><field-ref name="workTypeEnumId"/><field-ref name="emplPositionClassId"/></form-list-column><form-list-column><field-ref name="comments"/></form-list-column><form-list-column><field-ref name="invoiceId"/><field-ref name="vendorInvoiceId"/></form-list-column><form-list-column><field-ref name="findButton"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Party/PartyAgreements/EditAgreement.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><parameter name="partyId"/><parameter name="agreementId" required="true"/><always-actions><entity-find-one entity-name="mantle.party.agreement.Agreement" value-field="agreement"/><set field="partyId" from="agreement?.otherPartyId"/></always-actions><transition name="updateAgreement"><service-call name="update#mantle.party.agreement.Agreement" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createTerm"><service-call name="create#mantle.party.agreement.AgreementTerm" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteTerm"><service-call name="delete#mantle.party.agreement.AgreementTerm" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createAgreementItem"><service-call name="create#mantle.party.agreement.AgreementItem" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteAgreementItem"><service-call name="delete#mantle.party.agreement.AgreementItem" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition name="createContent"><service-call name="mantle.party.AgreementServices.create#AgreementContent" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateContent"><service-call name="mantle.party.AgreementServices.update#AgreementContent" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="downloadContent" read-only="true"><parameter name="agreementContentId"/><actions><entity-find-one entity-name="mantle.party.agreement.AgreementContent" value-field="agreementContent"/><script><![CDATA[ec.web.sendResourceResponse(agreementContent?.contentLocation)]]></script></actions><default-response type="none"/></transition><widgets><container-row><row-col lg="5"><form-single name="EditAgreement" map="agreement" transition="updateAgreement"><field name="partyId"><default-field><hidden/></default-field></field><field name="agreementId"><default-field><display/></default-field></field><field name="agreementTypeEnumId"><default-field title="Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="AgreementType"/><set field="noCurrentSelectedKey" value="AgrOther"/></widget-template-include></default-field></field><field name="description"><default-field><text-line size="80"/></default-field></field><field name="otherPartyId" from="partyId"><default-field title="Party"><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameTemplate"/></default-field></field><field name="otherRoleTypeId"><default-field title="Role"><drop-down><entity-options key="${roleTypeId}" text="${description}"><entity-find entity-name="mantle.party.RoleGroupMemberAndType" cache="true"><econdition field-name="roleGroupEnumId" value="RgpAgreement"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="organizationPartyId"><default-field title="Organization"><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameTemplate"/></default-field></field><field name="agreementDate"><default-field><date-time/></default-field></field><field name="fromDate"><default-field><date-time/></default-field></field><field name="thruDate"><default-field><date-time/></default-field></field><field name="textData"><default-field title="Agreement Text"><text-area rows="15" cols="100"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></row-col><row-col lg="7"><container-box><box-header title="Terms"/><box-toolbar><container-dialog id="AddSettlementTermDialog" button-text="Add Settlement Term"><form-single name="AddSettlementTerm" transition="createTerm"><field name="partyId"><default-field><hidden/></default-field></field><field name="agreementId"><default-field><hidden/></default-field></field><field name="settlementTermId"><default-field title="Term"><drop-down><entity-options key="${settlementTermId}" text="${description}"><entity-find entity-name="mantle.account.invoice.SettlementTerm"><order-by field-name="termTypeEnumId,description"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog><container-dialog id="AddOtherTermDialog" button-text="Add Other Term"><form-single name="AddOtherTerm" transition="createTerm"><field name="partyId"><default-field><hidden/></default-field></field><field name="agreementId"><default-field><hidden/></default-field></field><field name="termTypeEnumId"><default-field title="Term Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="TermType"/></widget-template-include></default-field></field><field name="termNumber"><default-field><text-line size="10"/></default-field></field><field name="termText"><default-field><text-area rows="5"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body-nopad><form-list name="AgreementTermList" list="agreementTermList" skip-form="true"><entity-find entity-name="mantle.party.agreement.AgreementTerm" list="agreementTermList"><econdition field-name="agreementId"/><order-by field-name="termTypeEnumId,settlementTermId"/></entity-find><field name="partyId"><default-field><hidden/></default-field></field><field name="agreementId"><default-field><hidden/></default-field></field><field name="agreementTermId"><default-field><hidden/></default-field></field><field name="settlementTermId"><default-field title="Settlement Term"><display-entity entity-name="mantle.account.invoice.SettlementTerm"/></default-field></field><field name="termTypeEnumId"><default-field title="Term Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="termNumber"><default-field><display/></default-field></field><field name="termText"><default-field><display/></default-field></field><field name="deleteButton" align="right"><default-field title=""><link url="deleteTerm" icon="fa fa-trash" parameter-map="[agreementTermId:agreementTermId]"/></default-field></field><form-list-column><field-ref name="settlementTermId"/><field-ref name="termTypeEnumId"/></form-list-column><form-list-column><field-ref name="termNumber"/><field-ref name="termText"/></form-list-column><form-list-column><field-ref name="deleteButton"/></form-list-column></form-list></box-body-nopad></container-box><container-box><box-header title="Items"/><box-toolbar><container-dialog id="AddAgreementItemDialog" button-text="Add Agreement Item"><form-single name="AddAgreementItem" transition="createAgreementItem"><field name="agreementId"><default-field><hidden/></default-field></field><field name="agreementItemTypeEnumId"><default-field title="Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="AgreementItemType"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="productId"><default-field title="Product"><drop-down><dynamic-options transition="getProductList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="quantity"><default-field><text-line/></default-field></field><field name="fromDate"><default-field><date-time/></default-field></field><field name="thruDate"><default-field><date-time/></default-field></field><field name="itemText"><default-field><text-area/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body-nopad><form-list name="AgreementItemList" list="agreementItemList" skip-form="true"><entity-find entity-name="mantle.party.agreement.AgreementItem" list="agreementItemList"><econdition field-name="agreementId"/></entity-find><field name="agreementId"><default-field><hidden/></default-field></field><field name="agreementItemSeqId"><default-field title="Item"><hidden/></default-field></field><field name="productId"><default-field title="Product"><display-entity entity-name="mantle.product.Product" text="ProductNameTemplate"/></default-field></field><field name="quantity"><default-field><display/></default-field></field><field name="itemText"><default-field><display/></default-field></field><field name="agreementItemTypeEnumId"><default-field title="Item Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="fromDate"><default-field><display/></default-field></field><field name="thruDate"><default-field><display/></default-field></field><field name="deleteButton" align="right"><default-field title=""><link url="deleteAgreementItem" icon="fa fa-trash" parameter-map="[agreementId:agreementId,agreementItemId:agreementItemId]"/></default-field></field><form-list-column><field-ref name="agreementItemSeqId"/></form-list-column><form-list-column><field-ref name="productId"/><field-ref name="quantity"/></form-list-column><form-list-column><field-ref name="fromDate"/><field-ref name="thruDate"/></form-list-column><form-list-column><field-ref name="agreementItemTypeEnumId"/><field-ref name="itemText"/></form-list-column><form-list-column><field-ref name="deleteButton"/></form-list-column></form-list></box-body-nopad></container-box><section name="ContentSection"><actions><entity-find entity-name="mantle.party.agreement.AgreementContent" list="contentList"><econdition field-name="agreementId"/><order-by field-name="-contentDate"/></entity-find></actions><widgets><container-box><box-header title="Content"/><box-toolbar><container-dialog id="NewContentDialog" button-text="Add Content"><form-single name="NewContentForm" transition="createContent"><field name="agreementId"><default-field><hidden/></default-field></field><field name="contentTypeEnumId"><default-field title="Content Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="AgreementContentType"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="contentFile"><default-field><file/></default-field></field><field name="description"><default-field><text-line size="60"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><section-iterate name="ContentIterateSection" list="contentList" entry="content"><actions><entity-find-one entity-name="mantle.party.PersonWithUserAccount" value-field="paua"><field-map field-name="userId" from="content.userId"/></entity-find-one><entity-find-one entity-name="moqui.basic.Enumeration" value-field="contentTypeEnum"><field-map field-name="enumId" from="content.contentTypeEnumId"/></entity-find-one></actions><widgets><container><container><label text="${contentTypeEnum?.description?:'No Type'}" type="strong"/></container><link url="downloadContent" condition="content.contentLocation" parameter-map="[agreementContentId:content.agreementContentId]" text="Download ${content.contentLocation.substring(content.contentLocation.lastIndexOf('/')+1)}"/><container-dialog id="UpdateContentContainer" button-text="Edit Content"><form-single name="UpdateContentForm" transition="updateContent" map="content"><field name="agreementContentId"><default-field><hidden/></default-field></field><field name="agreementId"><default-field><hidden/></default-field></field><field name="contentTypeEnumId"><default-field title="Content Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="AgreementContentType"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="contentFile"><default-field><file/></default-field></field><field name="description"><default-field><text-line size="60"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></container-dialog><container><label condition="paua" text="By ${ec.resource.expand('UsernameTemplate','',paua+[userId:content.userId])} at ${ec.l10n.format(content.contentDate, 'yyyy-MM-dd HH:mm')}"/></container><label text="${content.description ?: 'No Description'}" type="p"/></container></widgets></section-iterate></box-body></container-box></widgets></section></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Party/PartyAgreements/FindAgreement.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><parameter name="partyId" required="true"/><transition name="editParty"><default-response url="../../EditParty"/></transition><transition name="editAgreement"><default-response url="../EditAgreement"/></transition><transition name="createAgreement"><service-call name="create#mantle.party.agreement.Agreement" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditAgreement"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><widgets><container-dialog id="NewAgreementDialog" button-text="New Agreement"><form-single name="NewAgreement" transition="createAgreement"><field name="partyId"><default-field><hidden/></default-field></field><field name="agreementTypeEnumId"><default-field title="Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="AgreementType"/><set field="noCurrentSelectedKey" value="AgrOther"/></widget-template-include></default-field></field><field name="description"><default-field><text-line size="80"/></default-field></field><field name="otherPartyId" from="partyId"><default-field title="Party"><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameTemplate"/></default-field></field><field name="otherRoleTypeId"><default-field title="Role"><drop-down><entity-options key="${roleTypeId}" text="${description}"><entity-find entity-name="mantle.party.RoleGroupMemberAndType" cache="true"><econdition field-name="roleGroupEnumId" value="RgpAgreement"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="organizationPartyId"><default-field title="Organization"><drop-down><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="partyId" from="activeOrgId" ignore="!activeOrgId"/><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></default-field></field><field name="agreementDate"><default-field><date-time/></default-field></field><field name="fromDate"><default-field title="Valid From"><date-time/></default-field></field><field name="thruDate"><default-field title="Valid Thru"><date-time/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="AgreementList" list="agreementList" skip-form="true"><entity-find entity-name="mantle.party.agreement.Agreement" list="agreementList"><search-form-inputs default-order-by="-fromDate"/><econdition field-name="otherPartyId" from="partyId"/></entity-find><field name="agreementId"><default-field><link url="editAgreement" text="${agreementId}" link-type="anchor"/></default-field></field><field name="description"><default-field><link url="editAgreement" text="${description}" link-type="anchor"/></default-field></field><field name="agreementTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="otherRoleTypeId"><default-field title="Role"><display-entity entity-name="mantle.party.RoleType"/></default-field></field><field name="organizationPartyId"><default-field title="Organization"><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameTemplate"/></default-field></field><field name="fromDate"><default-field title="Valid From"><display/></default-field></field><field name="thruDate"><default-field title="Valid Thru"><display/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Party/PartyAgreements.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Agreements" default-menu-index="6"><parameter name="partyId" required="true"/><subscreens default-item="FindAgreement"/><widgets><subscreens-active/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Party/PartyProjects.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Projects" default-menu-index="12"><parameter name="partyId" required="true"/><transition name="addUserAssign"><service-call name="create#WorkEffortParty" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateUserAssign"><service-call name="update#WorkEffortParty" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="editProject"><default-response url="../../Project/EditProject"/></transition><actions><entity-find entity-name="WorkEffortAndParty" list="weapList"><econdition field-name="partyId"/><econdition field-name="workEffortTypeEnumId" value="WetProject"/></entity-find></actions><widgets><container-dialog id="AddUserAssignDialog" button-text="Add Project Assignment"><form-single name="AddUserAssignForm" transition="addUserAssign"><field name="partyId"><default-field><hidden/></default-field></field><field name="workEffortId"><default-field title="Project"><drop-down><entity-options key="${workEffortId}" text="${workEffortId} - ${workEffortName}"><entity-find entity-name="WorkEffort"><econdition field-name="workEffortTypeEnumId" value="WetProject"/></entity-find></entity-options></drop-down></default-field></field><field name="roleTypeId"><default-field title="Role"><drop-down><entity-options key="${roleTypeId}" text="${description}"><entity-find entity-name="mantle.party.RoleGroupMemberAndType" cache="true"><econdition field-name="roleGroupEnumId" value="RgpProject"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="fromDate" from="ec.user.nowTimestamp"><header-field show-order-by="true"/><default-field><date-time/></default-field></field><field name="thruDate"><header-field show-order-by="true"/><default-field><date-time/></default-field></field><field name="expectationEnumId"><default-field title="Expectation"><drop-down allow-empty="true"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="Enumeration"><econdition field-name="enumTypeId" value="WorkEffortPartyExpectation"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="emplPositionClassId"><default-field title="Position Class"><drop-down allow-empty="true"><entity-options key="${emplPositionClassId}" text="${title}"><entity-find entity-name="EmplPositionClass"/></entity-options></drop-down></default-field></field><field name="statusId"><default-field title="Status"><drop-down><entity-options key="${statusId}" text="${description}"><entity-find entity-name="StatusItem"><econdition field-name="statusTypeId" value="WorkEffortParty"/><order-by field-name="sequenceNum"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Add Assignment"><submit/></default-field></field></form-single></container-dialog><form-list name="UpdateUserAssignForm" list="weapList" transition="updateUserAssign"><row-actions><entity-find-one entity-name="moqui.basic.StatusItem" value-field="currentStatus"><field-map field-name="statusId" from="partyStatusId"/></entity-find-one></row-actions><field name="partyId"><default-field><hidden/></default-field></field><field name="workEffortId"><default-field><hidden/></default-field></field><field name="project"><default-field title="Project"><link text="${workEffortId} - ${workEffortName}" url="editProject" link-type="anchor"/></default-field></field><field name="roleTypeId"><header-field title="Role" show-order-by="true"/><default-field><display-entity entity-name="RoleType" text="${description}"/></default-field></field><field name="fromDate"><header-field show-order-by="true"/><default-field><display/></default-field></field><field name="thruDate"><header-field show-order-by="true"/><default-field><date-time/></default-field></field><field name="expectationEnumId"><header-field title="Expectation" show-order-by="true"/><default-field><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="WorkEffortPartyExpectation"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="emplPositionClassId"><header-field title="Position Class" show-order-by="true"/><default-field><drop-down allow-empty="true"><entity-options key="${emplPositionClassId}" text="${title}"><entity-find entity-name="EmplPositionClass"/></entity-options></drop-down></default-field></field><field name="statusId" from="partyStatusId"><header-field title="Status" show-order-by="true"/><default-field><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusTransitionDropDown"><set field="currentDescription" from="currentStatus?.description"/><set field="statusId" from="partyStatusId"/></widget-template-include></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><form-list-column><field-ref name="project"/><field-ref name="roleTypeId"/></form-list-column><form-list-column><field-ref name="fromDate"/><field-ref name="thruDate"/></form-list-column><form-list-column><field-ref name="expectationEnumId"/><field-ref name="emplPositionClassId"/></form-list-column><form-list-column><field-ref name="statusId"/><field-ref name="submitButton"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Party/PartyTasks.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Tasks" default-menu-index="13"><parameter name="partyId" required="true"/><transition name="addUserAssign"><service-call name="create#WorkEffortParty" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateUserAssign"><service-call name="update#WorkEffortParty" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="editTask"><default-response url="//${appRoot}/Task/TaskSummary"/></transition><transition name="getProjectTasks"><actions><service-call name="mantle.work.ProjectServices.get#ProjectTasks" in-map="context" out-map="context"/><script><![CDATA[ec.web.sendJsonResponse(resultList)]]></script></actions><default-response type="none"/></transition><actions><entity-find entity-name="mantle.work.effort.WorkEffortAndParty" list="weapList"><econdition field-name="partyId"/><econdition field-name="workEffortTypeEnumId" value="WetTask"/></entity-find><entity-find entity-name="mantle.work.effort.WorkEffortAndParty" list="myProjectList"><date-filter/><econdition field-name="partyId"/><econdition field-name="workEffortTypeEnumId" value="WetProject"/></entity-find></actions><widgets><container-dialog id="AddUserAssignDialog" button-text="Add Task Assignment"><form-single name="AddUserAssignForm" transition="addUserAssign"><field name="partyId"><default-field><hidden/></default-field></field><field name="rootWorkEffortId"><default-field title="Project"><drop-down><list-options list="myProjectList" key="${workEffortId}" text="${workEffortId}: ${workEffortName}"/></drop-down></default-field></field><field name="workEffortId"><default-field title="Task"><drop-down combo-box="true"><dynamic-options transition="getProjectTasks" value-field="workEffortId" label-field="taskLabel"><depends-on field="rootWorkEffortId"/></dynamic-options></drop-down></default-field></field><field name="roleTypeId"><default-field title="Role"><drop-down><entity-options key="${roleTypeId}" text="${description}"><entity-find entity-name="mantle.party.RoleGroupMemberAndType" cache="true"><econdition field-name="roleGroupEnumId" value="RgpTask"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="fromDate" from="ec.user.nowTimestamp"><header-field show-order-by="true"/><default-field><date-time/></default-field></field><field name="thruDate"><header-field show-order-by="true"/><default-field><date-time/></default-field></field><field name="expectationEnumId"><default-field title="Expectation"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="WorkEffortPartyExpectation"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="emplPositionClassId"><default-field title="Position Class"><drop-down allow-empty="true"><entity-options key="${emplPositionClassId}" text="${title}"><entity-find entity-name="EmplPositionClass"/></entity-options></drop-down></default-field></field><field name="statusId"><default-field title="Status"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="WorkEffortParty"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="receiveNotifications"><default-field><drop-down no-current-selected-key="N"><option key="Y"/><option key="N"/></drop-down></default-field></field><field name="submitButton"><default-field title="Add Assignment"><submit/></default-field></field></form-single></container-dialog><form-list name="UpdateUserAssignForm" list="weapList" transition="updateUserAssign"><row-actions><entity-find-one entity-name="moqui.basic.StatusItem" value-field="currentStatus"><field-map field-name="statusId" from="partyStatusId"/></entity-find-one></row-actions><field name="partyId"><default-field><hidden/></default-field></field><field name="workEffortId"><default-field title="Task"><display text=" "/><link text="${workEffortId} - ${workEffortName}" url="editTask" link-type="anchor"/></default-field></field><field name="roleTypeId"><header-field title="Role" show-order-by="true"/><default-field><display-entity entity-name="RoleType" text="${description}"/></default-field></field><field name="fromDate"><header-field show-order-by="true"/><default-field><display/></default-field></field><field name="thruDate"><header-field show-order-by="true"/><default-field><date-time/></default-field></field><field name="expectationEnumId"><header-field title="Expectation" show-order-by="true"/><default-field><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="WorkEffortPartyExpectation"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="emplPositionClassId"><header-field title="Position Class" show-order-by="true"/><default-field><drop-down allow-empty="true"><entity-options key="${emplPositionClassId}" text="${title}"><entity-find entity-name="EmplPositionClass"/></entity-options></drop-down></default-field></field><field name="statusId" from="partyStatusId"><header-field title="Status" show-order-by="true"/><default-field><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusTransitionDropDown"><set field="currentDescription" from="currentStatus?.description"/><set field="statusId" from="partyStatusId"/></widget-template-include></default-field></field><field name="receiveNotifications"><default-field title="Notifs?"><drop-down no-current-selected-key="N"><option key="Y"/><option key="N"/></drop-down></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><form-list-column><field-ref name="workEffortId"/><field-ref name="roleTypeId"/></form-list-column><form-list-column><field-ref name="fromDate"/><field-ref name="thruDate"/></form-list-column><form-list-column><field-ref name="expectationEnumId"/><field-ref name="emplPositionClassId"/></form-list-column><form-list-column><field-ref name="statusId"/><field-ref name="receiveNotifications"/></form-list-column><form-list-column><field-ref name="submitButton"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Party/PartyRequests.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Requests" default-menu-index="14"><parameter name="partyId" required="true"/><transition name="addUser"><service-call name="create#mantle.request.RequestParty" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateUser"><service-call name="update#mantle.request.RequestParty" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="editRequest"><default-response url="//${appRoot}/Request/EditRequest"/></transition><actions><entity-find entity-name="mantle.request.RequestAndParty" list="rapList"><econdition field-name="partyId"/></entity-find></actions><widgets><container-dialog id="AddUserDialog" button-text="Add to Request"><form-single name="AddUserForm" transition="addUser"><field name="partyId"><default-field><hidden/></default-field></field><field name="requestId"><default-field title="Request"><drop-down combo-box="true"><entity-options key="${requestId}" text="${requestId} - ${requestName}"><entity-find entity-name="Request"><econdition field-name="statusId" operator="not-in" value="REQUEST_COMPLETED,REQUEST_REJECTED,REQUEST_CANCELLED"/></entity-find></entity-options></drop-down></default-field></field><field name="roleTypeId"><default-field title="Role"><drop-down><entity-options key="${roleTypeId}" text="${description}"><entity-find entity-name="mantle.party.RoleGroupMemberAndType" cache="true"><econdition field-name="roleGroupEnumId" value="RgpRequest"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="fromDate" from="ec.user.nowTimestamp"><header-field show-order-by="true"/><default-field><date-time/></default-field></field><field name="thruDate"><header-field show-order-by="true"/><default-field><date-time/></default-field></field><field name="receiveNotifications"><default-field><drop-down no-current-selected-key="N"><option key="Y"/><option key="N"/></drop-down></default-field></field><field name="submitButton"><default-field title="Add Request"><submit/></default-field></field></form-single></container-dialog><form-list name="UpdateUserForm" list="rapList" transition="updateUser"><field name="partyId"><default-field><hidden/></default-field></field><field name="requestId"><default-field title="ID"><link text="${requestId}" url="editRequest" link-type="anchor"/></default-field></field><field name="requestName"><default-field title="Name"><display/></default-field></field><field name="roleTypeId"><header-field title="Role" show-order-by="true"/><default-field><display-entity entity-name="RoleType" text="${description}"/></default-field></field><field name="fromDate"><header-field show-order-by="true"/><default-field><display/></default-field></field><field name="thruDate"><header-field show-order-by="true"/><default-field><date-time/></default-field></field><field name="receiveNotifications"><default-field title="Notifs?"><drop-down no-current-selected-key="N"><option key="Y"/><option key="N"/></drop-down></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Party/FinancialInfo.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Financial Info" default-menu-index="21"><parameter name="partyId" required="true"/><transition name="findOrder"><default-response url="//${appRoot}/Order/FindOrder"/></transition><transition name="findShipment"><default-response url="//${appRoot}/Shipment/FindShipment"/></transition><transition name="findInvoice"><default-response url="//${appRoot}/Accounting/Invoice/FindInvoice"/></transition><transition name="findPayment"><default-response url="//${appRoot}/Accounting/Payment/FindPayment"/></transition><transition name="findRequest"><default-response url="//${appRoot}/Request/FindRequest"/></transition><transition name="orderDetail"><default-response url="//${appRoot}/Order/OrderDetail"/></transition><transition name="editInvoice"><default-response url="//${appRoot}/Accounting/Invoice/EditInvoice"/></transition><transition name="editPayment"><default-response url="//${appRoot}/Accounting/Payment/EditPayment"/></transition><transition name="receivableStatement"><default-response url="${ec.web.getWebappRootUrl(false, null)}/fop/apps/${appRoot}/Accounting/Invoice/ReceivableStatement" url-type="plain"><parameter name="pageNoLimit" value="true"/><parameter name="toPartyId"/><parameter name="filename" value="Statement-${toPartyId}-${ec.l10n.format(ec.user.nowTimestamp, 'yyyy-MM-dd')}.pdf"/></default-response></transition><actions><entity-find-one entity-name="mantle.party.PartyDetail" value-field="partyDetail"/><entity-find-one entity-name="mantle.party.PartyRole" value-field="internalRole"><field-map field-name="partyId"/><field-map field-name="roleTypeId" value="OrgInternal"/></entity-find-one><if condition="internalRole != null"><return error="true" message="${ec.resource.expand('PartyNameTemplate', null, partyDetail)} is an Internal Organization, see Accounting screens and reports for financial information"/></if><entity-find-count entity-name="mantle.request.RequestAndParty" count-field="requestCount"><date-filter/><econdition field-name="partyId"/></entity-find-count><entity-find-count entity-name="mantle.order.OrderPart" count-field="customerOrderPartCount"><econdition field-name="customerPartyId" from="partyId"/></entity-find-count><entity-find-count entity-name="mantle.order.OrderPart" count-field="vendorOrderPartCount"><econdition field-name="vendorPartyId" from="partyId"/></entity-find-count><entity-find-count entity-name="mantle.shipment.Shipment" count-field="fromShipmentCount"><econdition field-name="fromPartyId" from="partyId"/></entity-find-count><entity-find-count entity-name="mantle.shipment.Shipment" count-field="toShipmentCount"><econdition field-name="toPartyId" from="partyId"/></entity-find-count><entity-find-count entity-name="mantle.account.invoice.Invoice" count-field="fromInvoiceCount"><econdition field-name="fromPartyId" from="partyId"/></entity-find-count><entity-find-count entity-name="mantle.account.invoice.Invoice" count-field="toInvoiceCount"><econdition field-name="toPartyId" from="partyId"/></entity-find-count><entity-find-count entity-name="mantle.account.payment.Payment" count-field="fromPaymentCount"><econdition field-name="fromPartyId" from="partyId"/></entity-find-count><entity-find-count entity-name="mantle.account.payment.Payment" count-field="toPaymentCount"><econdition field-name="toPartyId" from="partyId"/></entity-find-count><entity-find entity-name="mantle.order.OrderHeaderAndPartSummary" list="ordersTotalList"><econdition field-name="customerPartyId" from="partyId"/><econdition field-name="partStatusId" operator="in" value="OrderPlaced,OrderProcessing,OrderApproved,OrderSent,OrderCompleted"/><select-field field-name="currencyUomId,orderCount,partTotal"/></entity-find><entity-find entity-name="mantle.account.invoice.InvoiceSummary" list="invoicesTotalList"><econdition field-name="toPartyId" from="partyId"/><econdition field-name="statusId" operator="in" value="InvoiceInProcess,InvoiceFinalized,InvoiceSent,InvoiceAcked,InvoicePmtRecvd"/><select-field field-name="currencyUomId,invoiceCount,grandTotal,unpaidTotal"/></entity-find><entity-find entity-name="mantle.account.payment.PaymentSummary" list="paymentsTotalList"><econdition field-name="fromPartyId" from="partyId"/><econdition field-name="statusId" operator="in" value="PmntProposed,PmntPromised,PmntAuthorized,PmntDelivered,PmntConfirmed"/><select-field field-name="amountUomId,paymentCount,amountTotal,unappliedTotal"/></entity-find><entity-find entity-name="mantle.order.OrderHeaderAndPartSummary" list="ordersCompletedList"><econdition field-name="customerPartyId" from="partyId"/><econdition field-name="partStatusId" value="OrderCompleted"/><select-field field-name="currencyUomId,orderCount,partTotal"/></entity-find><entity-find entity-name="mantle.account.invoice.InvoiceSummary" list="invoicesBookedList"><econdition field-name="toPartyId" from="partyId"/><econdition field-name="statusId" operator="in" value="InvoiceFinalized,InvoiceSent,InvoiceAcked,InvoicePmtRecvd"/><select-field field-name="currencyUomId,invoiceCount,grandTotal,unpaidTotal"/></entity-find><entity-find entity-name="mantle.account.payment.PaymentSummary" list="paymentsPaidList"><econdition field-name="fromPartyId" from="partyId"/><econdition field-name="statusId" operator="in" value="PmntDelivered,PmntConfirmed"/><select-field field-name="amountUomId,paymentCount,amountTotal,unappliedTotal"/></entity-find><entity-find entity-name="mantle.order.OrderHeaderAndPartSummary" list="supOrdersTotalList"><econdition field-name="vendorPartyId" from="partyId"/><econdition field-name="partStatusId" operator="in" value="OrderPlaced,OrderProcessing,OrderApproved,OrderSent,OrderCompleted"/><select-field field-name="currencyUomId,orderCount,partTotal"/></entity-find><entity-find entity-name="mantle.account.invoice.InvoiceSummary" list="supInvoicesTotalList"><econdition field-name="fromPartyId" from="partyId"/><econdition field-name="statusId" operator="in" value="InvoiceIncoming,InvoiceReceived,InvoiceApproved,InvoicePmtSent"/><select-field field-name="currencyUomId,invoiceCount,grandTotal,unpaidTotal"/></entity-find><entity-find entity-name="mantle.account.payment.PaymentSummary" list="supPaymentsTotalList"><econdition field-name="toPartyId" from="partyId"/><econdition field-name="statusId" operator="in" value="PmntProposed,PmntPromised,PmntAuthorized,PmntDelivered,PmntConfirmed"/><select-field field-name="amountUomId,paymentCount,amountTotal,unappliedTotal"/></entity-find><entity-find entity-name="mantle.order.OrderHeaderAndPartSummary" list="supOrdersCompletedList"><econdition field-name="vendorPartyId" from="partyId"/><econdition field-name="partStatusId" value="OrderCompleted"/><select-field field-name="currencyUomId,orderCount,partTotal"/></entity-find><entity-find entity-name="mantle.account.invoice.InvoiceSummary" list="supInvoicesBookedList"><econdition field-name="fromPartyId" from="partyId"/><econdition field-name="statusId" operator="in" value="InvoiceApproved,InvoicePmtSent"/><select-field field-name="currencyUomId,invoiceCount,grandTotal,unpaidTotal"/></entity-find><entity-find entity-name="mantle.account.payment.PaymentSummary" list="supPaymentsPaidList"><econdition field-name="toPartyId" from="partyId"/><econdition field-name="statusId" operator="in" value="PmntDelivered,PmntConfirmed"/><select-field field-name="amountUomId,paymentCount,amountTotal,unappliedTotal"/></entity-find></actions><widgets><link url="findRequest" text="Requests (${requestCount})" parameter-map="[partyId:partyId]" condition="requestCount"/><link url="findOrder" text="Sales Orders (${customerOrderPartCount})" parameter-map="[customerPartyId:partyId]" condition="customerOrderPartCount"/><link url="findShipment" text="Shipments To (${toShipmentCount})" parameter-map="[toPartyId:partyId]" condition="toShipmentCount"/><link url="findInvoice" text="Invoices To (${toInvoiceCount})" parameter-map="[toPartyId:partyId]" condition="toInvoiceCount"/><link url="findPayment" text="Payments From (${fromPaymentCount})" parameter-map="[fromPartyId:partyId]" condition="fromPaymentCount"/><link url="findOrder" text="Purchase Orders (${vendorOrderPartCount})" parameter-map="[vendorPartyId:partyId]" condition="vendorOrderPartCount"/><link url="findShipment" text="Shipments From (${fromShipmentCount})" parameter-map="[fromPartyId:partyId]" condition="fromShipmentCount"/><link url="findInvoice" text="Invoices From (${fromInvoiceCount})" parameter-map="[fromPartyId:partyId]" condition="fromInvoiceCount"/><link url="findPayment" text="Payments To (${toPaymentCount})" parameter-map="[toPartyId:partyId]" condition="toPaymentCount"/><link url="receivableStatement" text="Customer Statement PDF" parameter-map="[toPartyId:partyId]" condition="toInvoiceCount || fromPaymentCount"/><link url="${sri.getScreenUrlInstance().getScreenOnlyPath()}" url-type="plain" text="XLS Export" parameter-map="ec.web.requestParameters + [saveFilename:('FinancialInfo_' + partyId + '.xlsx'),                     renderMode:'xlsx', pageNoLimit:'true', lastStandalone:'true']"/><container-box><box-header title="Financial Summary for ${ec.resource.expand('PartyNameTemplate', null, partyDetail)}"/><box-body><container-row><row-col sm="4"><label text="Completed Sales Orders" type="strong"/></row-col><row-col sm="4"><label text="Booked Receivable Invoices" type="strong"/></row-col><row-col sm="4"><label text="Received Incoming Payments" type="strong"/></row-col></container-row><container-row><row-col sm="4"><section-iterate name="OrdersCompletedListSection" list="ordersCompletedList" entry="ordersTotal"><widgets><label text="${ec.l10n.format(ordersTotal.orderCount, '#,##0')} orders ${ec.l10n.formatCurrency(ordersTotal.partTotal, ordersTotal.currencyUomId)}" type="div"/></widgets></section-iterate></row-col><row-col sm="4"><section-iterate name="InvoicesBookedListSection" list="invoicesBookedList" entry="invoicesTotal"><widgets><label text="${ec.l10n.format(invoicesTotal.invoiceCount, '#,##0')} invoices ${ec.l10n.formatCurrency(invoicesTotal.grandTotal, invoicesTotal.currencyUomId)} (unpaid ${ec.l10n.formatCurrency(invoicesTotal.unpaidTotal, invoicesTotal.currencyUomId)})" type="div"/></widgets></section-iterate></row-col><row-col sm="4"><section-iterate name="PaymentsPaidListSection" list="paymentsPaidList" entry="paymentsTotal"><widgets><label text="${ec.l10n.format(paymentsTotal.paymentCount, '#,##0')} payments ${ec.l10n.formatCurrency(paymentsTotal.amountTotal, paymentsTotal.amountUomId)} (unapplied ${ec.l10n.formatCurrency(paymentsTotal.unappliedTotal, paymentsTotal.amountUomId)})" type="div"/></widgets></section-iterate></row-col></container-row><container-row><row-col sm="4"><label text="All Sales Orders" type="strong"/></row-col><row-col sm="4"><label text="All Receivable Invoices" type="strong"/></row-col><row-col sm="4"><label text="All Incoming Payments" type="strong"/></row-col></container-row><container-row><row-col sm="4"><section-iterate name="OrdersTotalListSection" list="ordersTotalList" entry="ordersTotal"><widgets><label text="${ec.l10n.format(ordersTotal.orderCount, '#,##0')} orders ${ec.l10n.formatCurrency(ordersTotal.partTotal, ordersTotal.currencyUomId)}" type="div"/></widgets></section-iterate></row-col><row-col sm="4"><section-iterate name="InvoicesTotalListSection" list="invoicesTotalList" entry="invoicesTotal"><widgets><label text="${ec.l10n.format(invoicesTotal.invoiceCount, '#,##0')} invoices ${ec.l10n.formatCurrency(invoicesTotal.grandTotal, invoicesTotal.currencyUomId)} (unpaid ${ec.l10n.formatCurrency(invoicesTotal.unpaidTotal, invoicesTotal.currencyUomId)})" type="div"/></widgets></section-iterate></row-col><row-col sm="4"><section-iterate name="PaymentsTotalListSection" list="paymentsTotalList" entry="paymentsTotal"><widgets><label text="${ec.l10n.format(paymentsTotal.paymentCount, '#,##0')} payments ${ec.l10n.formatCurrency(paymentsTotal.amountTotal, paymentsTotal.amountUomId)} (unapplied ${ec.l10n.formatCurrency(paymentsTotal.unappliedTotal, paymentsTotal.amountUomId)})" type="div"/></widgets></section-iterate></row-col></container-row><container-row><row-col sm="4"><label text="Completed Purchase Orders" type="strong"/></row-col><row-col sm="4"><label text="Booked Payable Invoices" type="strong"/></row-col><row-col sm="4"><label text="Received Outgoing Payments" type="strong"/></row-col></container-row><container-row><row-col sm="4"><section-iterate name="SupOrdersCompletedListSection" list="supOrdersCompletedList" entry="ordersTotal"><widgets><label text="${ec.l10n.format(ordersTotal.orderCount, '#,##0')} orders ${ec.l10n.formatCurrency(ordersTotal.partTotal, ordersTotal.currencyUomId)}" type="div"/></widgets></section-iterate></row-col><row-col sm="4"><section-iterate name="SupInvoicesBookedListSection" list="supInvoicesBookedList" entry="invoicesTotal"><widgets><label text="${ec.l10n.format(invoicesTotal.invoiceCount, '#,##0')} invoices ${ec.l10n.formatCurrency(invoicesTotal.grandTotal, invoicesTotal.currencyUomId)} (unpaid ${ec.l10n.formatCurrency(invoicesTotal.unpaidTotal, invoicesTotal.currencyUomId)})" type="div"/></widgets></section-iterate></row-col><row-col sm="4"><section-iterate name="SupPaymentsPaidListSection" list="supPaymentsPaidList" entry="paymentsTotal"><widgets><label text="${ec.l10n.format(paymentsTotal.paymentCount, '#,##0')} payments ${ec.l10n.formatCurrency(paymentsTotal.amountTotal, paymentsTotal.amountUomId)} (unapplied ${ec.l10n.formatCurrency(paymentsTotal.unappliedTotal, paymentsTotal.amountUomId)})" type="div"/></widgets></section-iterate></row-col></container-row><container-row><row-col sm="4"><label text="All Purchase Orders" type="strong"/></row-col><row-col sm="4"><label text="All Payable Invoices" type="strong"/></row-col><row-col sm="4"><label text="All Outgoing Payments" type="strong"/></row-col></container-row><container-row><row-col sm="4"><section-iterate name="SupOrdersTotalListSection" list="supOrdersTotalList" entry="ordersTotal"><widgets><label text="${ec.l10n.format(ordersTotal.orderCount, '#,##0')} orders ${ec.l10n.formatCurrency(ordersTotal.partTotal, ordersTotal.currencyUomId)}" type="div"/></widgets></section-iterate></row-col><row-col sm="4"><section-iterate name="SupInvoicesTotalListSection" list="supInvoicesTotalList" entry="invoicesTotal"><widgets><label text="${ec.l10n.format(invoicesTotal.invoiceCount, '#,##0')} invoices ${ec.l10n.formatCurrency(invoicesTotal.grandTotal, invoicesTotal.currencyUomId)} (unpaid ${ec.l10n.formatCurrency(invoicesTotal.unpaidTotal, invoicesTotal.currencyUomId)})" type="div"/></widgets></section-iterate></row-col><row-col sm="4"><section-iterate name="SupPaymentsTotalListSection" list="supPaymentsTotalList" entry="paymentsTotal"><widgets><label text="${ec.l10n.format(paymentsTotal.paymentCount, '#,##0')} payments ${ec.l10n.formatCurrency(paymentsTotal.amountTotal, paymentsTotal.amountUomId)} (unapplied ${ec.l10n.formatCurrency(paymentsTotal.unappliedTotal, paymentsTotal.amountUomId)})" type="div"/></widgets></section-iterate></row-col></container-row></box-body></container-box><container-box type="success"><box-header title="Unpaid Receivables"/><box-body-nopad><form-list name="UnpaidInvoiceList" list="invoiceList" skip-form="true" show-csv-button="true"><entity-find entity-name="mantle.account.invoice.Invoice" list="invoiceList"><econdition field-name="toPartyId" from="partyId"/><econdition field-name="statusId" operator="in" value="InvoiceInProcess,InvoiceFinalized,InvoiceSent,InvoiceAcked,InvoicePmtRecvd"/><econdition field-name="unpaidTotal" operator="not-equals" from="0.0"/><order-by field-name="invoiceDate,invoiceId"/></entity-find><field name="invoiceId"><default-field title="Invoice"><link url="editInvoice" text="${invoiceId}" link-type="anchor"/></default-field></field><field name="referenceNumber"><default-field title="Their Invoice"><display/></default-field></field><field name="otherPartyOrderId"><default-field title="Their Order"><display/></default-field></field><field name="invoiceDate"><default-field><display format="yyyy-MM-dd"/></default-field></field><field name="dueDate"><default-field><display format="yyyy-MM-dd"/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="fromPartyId"><default-field title="Organization"><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameTemplate"/></default-field></field><field name="invoiceTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="invoiceTotal" align="right" show-total="true"><default-field title="Total"><display currency-unit-field="currencyUomId"/></default-field></field><field name="unpaidTotal" align="right" show-total="true"><default-field title="Unpaid"><display currency-unit-field="currencyUomId"/></default-field></field></form-list></box-body-nopad></container-box><container-box type="success"><box-header title="Unapplied Incoming Payments"/><box-body-nopad><form-list name="PaymentList" list="paymentList" skip-form="true"><entity-find entity-name="mantle.account.payment.Payment" list="paymentList"><econdition field-name="fromPartyId" from="partyId"/><econdition field-name="statusId" operator="in" value="PmntProposed,PmntPromised,PmntAuthorized,PmntDelivered,PmntConfirmed"/><econdition field-name="unappliedTotal" operator="not-equals" from="0.0"/><order-by field-name="effectiveDate"/></entity-find><field name="paymentId"><default-field title="Payment"><link url="editPayment" text="${paymentId}" link-type="anchor"/></default-field></field><field name="paymentRefNum"><default-field title="Ref Num"><display/></default-field></field><field name="effectiveDate"><default-field><display format="yyyy-MM-dd"/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="toPartyId"><default-field title="Organization"><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameTemplate"/></default-field></field><field name="paymentTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="paymentInstrumentEnumId"><default-field title="Instrument"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="amount" align="right" show-total="sum"><default-field title="Amount"><display currency-unit-field="amountUomId"/></default-field></field><field name="unappliedTotal" align="right" show-total="sum"><default-field title="Unapplied"><display currency-unit-field="amountUomId"/></default-field></field></form-list></box-body-nopad></container-box><container-box type="success"><box-header title="Current Sales Orders"/><box-body-nopad><form-list name="OrderList" list="orderList" skip-form="true"><entity-find entity-name="mantle.order.OrderHeaderAndPart" list="orderList"><econdition field-name="customerPartyId" from="partyId"/><econdition field-name="statusId" operator="in" value="OrderPlaced,OrderProcessing,OrderApproved,OrderSent"/><select-field field-name="orderPartSeqId"/><order-by field-name="placedDate"/></entity-find><field name="orderId"><default-field title="Order"><link text="${orderId}:${orderPartSeqId}" url="orderDetail" link-type="anchor" condition="orderId"/></default-field></field><field name="otherPartyOrderId"><default-field title="PO #"><display/></default-field></field><field name="placedDate"><default-field><display format="yyyy-MM-dd"/></default-field></field><field name="shipBeforeDate"><default-field title="Ship Before"><display format="yyyy-MM-dd"/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="facilityId"><default-field title="Facility"><display-entity entity-name="mantle.facility.Facility" text="FacilityNameTemplate"/></default-field></field><field name="productStoreId"><default-field title="Store"><display-entity entity-name="mantle.product.store.ProductStore" text="${productStoreId}: ${storeName}"/></default-field></field><field name="vendorPartyId"><default-field title="Vendor"><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameTemplate"/></default-field></field><field name="partTotal" align="right" show-total="sum"><default-field title="Total"><display currency-unit-field="currencyUomId"/></default-field></field></form-list></box-body-nopad></container-box><container-box type="info"><box-header title="Unpaid Payables"/><box-body-nopad><form-list name="UnpaidPayablesList" list="invoiceList" skip-form="true" show-csv-button="true"><entity-find entity-name="mantle.account.invoice.Invoice" list="invoiceList"><econdition field-name="fromPartyId" from="partyId"/><econdition field-name="statusId" operator="in" value="InvoiceIncoming,InvoiceReceived,InvoiceApproved,InvoicePmtSent"/><econdition field-name="unpaidTotal" operator="not-equals" from="0.0"/><order-by field-name="invoiceDate,invoiceId"/></entity-find><field name="invoiceId"><default-field title="Invoice"><link url="editInvoice" text="${invoiceId}" link-type="anchor"/></default-field></field><field name="referenceNumber"><default-field title="Their Invoice"><display/></default-field></field><field name="otherPartyOrderId"><default-field title="Their Order"><display/></default-field></field><field name="invoiceDate"><default-field><display format="yyyy-MM-dd"/></default-field></field><field name="dueDate"><default-field><display format="yyyy-MM-dd"/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="toPartyId"><default-field title="Organization"><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameTemplate"/></default-field></field><field name="invoiceTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="invoiceTotal" align="right" show-total="true"><default-field title="Total"><display currency-unit-field="currencyUomId"/></default-field></field><field name="unpaidTotal" align="right" show-total="true"><default-field title="Unpaid"><display currency-unit-field="currencyUomId"/></default-field></field></form-list></box-body-nopad></container-box><container-box type="info"><box-header title="Unapplied Outgoing Payments"/><box-body-nopad><form-list name="OutgoingPaymentList" list="paymentList" skip-form="true"><entity-find entity-name="mantle.account.payment.Payment" list="paymentList"><econdition field-name="toPartyId" from="partyId"/><econdition field-name="statusId" operator="in" value="PmntProposed,PmntPromised,PmntAuthorized,PmntDelivered,PmntConfirmed"/><econdition field-name="unappliedTotal" operator="not-equals" from="0.0"/><order-by field-name="effectiveDate"/></entity-find><field name="paymentId"><default-field title="Payment"><link url="editPayment" text="${paymentId}" link-type="anchor"/></default-field></field><field name="paymentRefNum"><default-field title="Ref Num"><display/></default-field></field><field name="effectiveDate"><default-field><display format="yyyy-MM-dd"/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="fromPartyId"><default-field title="Organization"><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameTemplate"/></default-field></field><field name="paymentTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="paymentInstrumentEnumId"><default-field title="Instrument"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="amount" align="right" show-total="sum"><default-field title="Amount"><display currency-unit-field="amountUomId"/></default-field></field><field name="unappliedTotal" align="right" show-total="sum"><default-field title="Unapplied"><display currency-unit-field="amountUomId"/></default-field></field></form-list></box-body-nopad></container-box><container-box type="info"><box-header title="Current Purchase Orders"/><box-body-nopad><form-list name="PurchaseOrderList" list="orderList" skip-form="true"><entity-find entity-name="mantle.order.OrderHeaderAndPart" list="orderList"><econdition field-name="vendorPartyId" from="partyId"/><econdition field-name="statusId" operator="in" value="OrderPlaced,OrderProcessing,OrderApproved,OrderSent"/><select-field field-name="orderPartSeqId"/><order-by field-name="placedDate"/></entity-find><field name="orderId"><default-field title="Order"><link text="${orderId}:${orderPartSeqId}" url="orderDetail" link-type="anchor" condition="orderId"/></default-field></field><field name="otherPartyOrderId"><default-field title="SO #"><display/></default-field></field><field name="placedDate"><default-field><display format="yyyy-MM-dd"/></default-field></field><field name="shipBeforeDate"><default-field title="Ship Before"><display format="yyyy-MM-dd"/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="facilityId"><default-field title="Facility"><display-entity entity-name="mantle.facility.Facility" text="FacilityNameTemplate"/></default-field></field><field name="productStoreId"><default-field title="Store"><display-entity entity-name="mantle.product.store.ProductStore" text="${productStoreId}: ${storeName}"/></default-field></field><field name="customerPartyId"><default-field title="Customer"><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameTemplate"/></default-field></field><field name="partTotal" align="right" show-total="sum"><default-field title="Total"><display currency-unit-field="currencyUomId"/></default-field></field></form-list></box-body-nopad></container-box><container-box type="success"><box-header title="Recent Paid Receivables"/><box-body-nopad><form-list name="PaidInvoiceList" list="invoiceList" skip-form="true"><entity-find entity-name="mantle.account.invoice.Invoice" list="invoiceList" limit="20"><econdition field-name="toPartyId" from="partyId"/><econdition field-name="statusId" operator="in" value="InvoiceInProcess,InvoiceFinalized,InvoiceSent,InvoiceAcked,InvoicePmtRecvd"/><econdition field-name="unpaidTotal" from="0.0"/><order-by field-name="-invoiceDate,invoiceId"/></entity-find><field name="invoiceId"><default-field title="Invoice"><link url="editInvoice" text="${invoiceId}" link-type="anchor"/></default-field></field><field name="referenceNumber"><default-field title="Their Invoice"><display/></default-field></field><field name="otherPartyOrderId"><default-field title="Their Order"><display/></default-field></field><field name="invoiceDate"><default-field><display format="yyyy-MM-dd"/></default-field></field><field name="dueDate"><default-field><display format="yyyy-MM-dd"/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="fromPartyId"><default-field title="Organization"><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameTemplate"/></default-field></field><field name="invoiceTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="invoiceTotal" align="right" show-total="true"><default-field title="Total"><display currency-unit-field="currencyUomId"/></default-field></field><field name="unpaidTotal" align="right" show-total="true"><default-field title="Unpaid"><display currency-unit-field="currencyUomId"/></default-field></field></form-list></box-body-nopad></container-box><container-box type="info"><box-header title="Recent Paid Payables"/><box-body-nopad><form-list name="PaidPayablesList" list="invoiceList" skip-form="true"><entity-find entity-name="mantle.account.invoice.Invoice" list="invoiceList" limit="20"><econdition field-name="fromPartyId" from="partyId"/><econdition field-name="statusId" operator="in" value="InvoiceIncoming,InvoiceReceived,InvoiceApproved,InvoicePmtSent"/><econdition field-name="unpaidTotal" from="0.0"/><order-by field-name="-invoiceDate,invoiceId"/></entity-find><field name="invoiceId"><default-field title="Invoice"><link url="editInvoice" text="${invoiceId}" link-type="anchor"/></default-field></field><field name="referenceNumber"><default-field title="Their Invoice"><display/></default-field></field><field name="otherPartyOrderId"><default-field title="Their Order"><display/></default-field></field><field name="invoiceDate"><default-field><display format="yyyy-MM-dd"/></default-field></field><field name="dueDate"><default-field><display format="yyyy-MM-dd"/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="toPartyId"><default-field title="Organization"><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameTemplate"/></default-field></field><field name="invoiceTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="invoiceTotal" align="right" show-total="true"><default-field title="Total"><display currency-unit-field="currencyUomId"/></default-field></field><field name="unpaidTotal" align="right" show-total="true"><default-field title="Unpaid"><display currency-unit-field="currencyUomId"/></default-field></field></form-list></box-body-nopad></container-box></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Party.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Parties" default-menu-index="24" menu-image="/ssstatic/images/Parties.png"><subscreens default-item="FindParty"/><actions><entity-find-one entity-name="mantle.party.PartyDetail" value-field="partyDetail"/></actions><widgets><label text="PartyNameTemplate" text-map="partyDetail" type="strong" condition="partyDetail"/><subscreens-panel id="PartyPanel" type="tab"/></widgets></screen>
<!-- Screen Location component://Sales/screen/SalesAdmin.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" menu-image="fa fa-flash" menu-image-type="icon"><subscreens default-item="Party"><subscreens-item name="Party" menu-title="Manage Parties" location="component://SimpleScreens/screen/SimpleScreens/Party.xml" menu-index="99"/></subscreens><widgets><subscreens-panel id="SalesAdminPanel" type="popup"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Gateway/Payment/FindPaymentGateway.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Payment Gateways" default-menu-include="false"><transition name="editPaymentGateway"><default-response url="../EditPaymentGateway"/></transition><transition name="createPaymentGateway"><service-call name="create#mantle.account.method.PaymentGatewayConfig" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditPaymentGateway"/></transition><actions><set field="knownServiceNames" from="ec.service.knownServiceNames"/></actions><widgets><container-dialog id="NewPaymentGatewayDialog" button-text="New Payment Gateway"><form-single name="NewPaymentGatewayForm" transition="createPaymentGateway"><field name="paymentGatewayConfigId"><default-field title="ID"><text-line size="30"/></default-field></field><field name="paymentGatewayTypeEnumId"><default-field title="Gateway Type"><drop-down><entity-options key="${enumId}" text="EnumerationNameTemplate"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="PaymentGatewayType"/><order-by field-name="enumId"/></entity-find></entity-options></drop-down></default-field></field><field name="description"><default-field title="Description"><text-line size="30"/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="PaymentGatewaysForm" list="paymentGatewayList" skip-form="true" header-dialog="true"><entity-find entity-name="mantle.account.method.PaymentGatewayConfig" list="paymentGatewayList"><search-form-inputs default-order-by="description"/></entity-find><field name="description"><header-field title="Description" show-order-by="case-insensitive"><text-find size="25" hide-options="true"/></header-field><default-field><link url="editPaymentGateway" text="${description}" link-type="anchor"/></default-field></field><field name="paymentGatewayConfigId"><header-field title="ID" show-order-by="case-insensitive"><text-find size="10" hide-options="true"/></header-field><default-field><link url="editPaymentGateway" text="${paymentGatewayConfigId}" link-type="anchor"/></default-field></field><field name="paymentGatewayTypeEnumId"><header-field title="Gateway Type" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="PaymentGatewayType"/><set field="allowEmpty" value="true"/><set field="style" value=" "/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field><default-field><display text=" "/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Gateway/Payment/EditPaymentGateway.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Payment Gateway" default-menu-index="1"><parameter name="paymentGatewayConfigId" required="true"/><transition name="updatePaymentGatewayConfig"><service-call name="update#mantle.account.method.PaymentGatewayConfig" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><entity-find-one entity-name="mantle.account.method.PaymentGatewayConfig" value-field="paymentGatewayConfig"><field-map field-name="paymentGatewayConfigId" from="paymentGatewayConfigId"/></entity-find-one></actions><widgets><container-row><row-col lg="7"><form-single name="EditPaymentGatewayForm" map="paymentGatewayConfig" transition="updatePaymentGatewayConfig"><field name="paymentGatewayConfigId"><default-field title="ID"><display text="${paymentGatewayConfigId}"/></default-field></field><field name="paymentGatewayTypeEnumId"><default-field title="Gateway Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="PaymentGatewayType"/></widget-template-include></default-field></field><field name="description"><default-field title="Description"><text-line size="30"/></default-field></field><field name="authorizeServiceName"><default-field title="Authorize Service"><text-line size="100"/></default-field></field><field name="captureServiceName"><default-field title="Capture Service"><text-line size="100"/></default-field></field><field name="releaseServiceName"><default-field title="Release Service"><text-line size="100"/></default-field></field><field name="refundServiceName"><default-field title="Refund Service"><text-line size="100"/></default-field></field><field name="detailsServiceName"><default-field title="TX Details Service"><text-line size="100"/></default-field></field><field name="submitButton"><default-field title="Update"><submit confirmation="WARNING: changing to incorrect or invalid services will break payment processing. Do you want to update?"/></default-field></field></form-single></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Gateway/Payment.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-index="1"><subscreens default-item="FindPaymentGateway"/><widgets><subscreens-panel id="PaymentGatewayPanel" type="tab"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Gateway/Shipping/FindShippingGateway.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Shipping Gateways" default-menu-include="false"><transition name="editShippingGateway"><default-response url="../EditShippingGateway"/></transition><transition name="createShippingGateway"><service-call name="create#mantle.shipment.carrier.ShippingGatewayConfig" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditShippingGateway"/></transition><actions><set field="knownServiceNames" from="ec.service.knownServiceNames"/></actions><widgets><container-dialog id="NewShippingGatewayDialog" button-text="New Shipping Gateway"><form-single name="NewShippingGatewayForm" transition="createShippingGateway"><field name="shippingGatewayConfigId"><default-field title="ID"><text-line size="30"/></default-field></field><field name="shippingGatewayTypeEnumId"><default-field title="Gateway Type"><drop-down allow-empty="true"><entity-options key="${enumId}" text="EnumerationNameTemplate"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="ShippingGatewayType"/><order-by field-name="enumId"/></entity-find></entity-options></drop-down></default-field></field><field name="description"><default-field title="Description"><text-line size="30"/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="ShippingGatewaysForm" list="shippingGatewayList" skip-form="true" header-dialog="true"><entity-find entity-name="mantle.shipment.carrier.ShippingGatewayConfig" list="shippingGatewayList"><search-form-inputs default-order-by="description"/></entity-find><field name="description"><header-field title="Description" show-order-by="case-insensitive"><text-find size="25" hide-options="true"/></header-field><default-field><link url="editShippingGateway" text="${description}" link-type="anchor"/></default-field></field><field name="shippingGatewayConfigId"><header-field title="ID" show-order-by="case-insensitive"><text-find size="10" hide-options="true"/></header-field><default-field><link url="editShippingGateway" text="${shippingGatewayConfigId}" link-type="anchor"/></default-field></field><field name="shippingGatewayTypeEnumId"><header-field title="Gateway Type" show-order-by="true"/><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field><default-field><display text=" "/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Gateway/Shipping/EditShippingGateway.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Shipping Gateway" default-menu-index="1"><parameter name="shippingGatewayConfigId" required="true"/><transition name="updateShippingGatewayConfig"><service-call name="update#mantle.shipment.carrier.ShippingGatewayConfig" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><entity-find-one entity-name="mantle.shipment.carrier.ShippingGatewayConfig" value-field="shippingGatewayConfig"><field-map field-name="shippingGatewayConfigId" from="shippingGatewayConfigId"/></entity-find-one></actions><widgets><container-row><row-col lg="7"><form-single name="EditShippingGatewayForm" map="shippingGatewayConfig" transition="updateShippingGatewayConfig"><field name="shippingGatewayConfigId"><default-field title="ID"><display text="${shippingGatewayConfigId}"/></default-field></field><field name="shippingGatewayTypeEnumId"><default-field title="Gateway Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ShippingGatewayType"/></widget-template-include></default-field></field><field name="description"><default-field title="Description"><text-line size="30"/></default-field></field><field name="getOrderRateServiceName"><default-field title="Order Rate Service"><text-line size="100"/></default-field></field><field name="getShippingRatesBulkName"><default-field title="Bulk Shipping Rates Service"><text-line size="100"/></default-field></field><field name="getAutoPackageInfoName"><default-field title="Auto Package Info Service"><text-line size="100"/></default-field></field><field name="getRateServiceName"><default-field title="Rate Service Name"><text-line size="100"/></default-field></field><field name="requestLabelsServiceName"><default-field title="Request Labels Service Name"><text-line size="100"/></default-field></field><field name="refundLabelsServiceName"><default-field title="Refund Labels Service Name"><text-line size="100"/></default-field></field><field name="trackLabelsServiceName"><default-field title="Track Labels Service Name"><text-line size="100"/></default-field></field><field name="validateAddressServiceName"><default-field title="Address Validation Service"><text-line size="100"/></default-field></field><field name="submitButton"><default-field title="Update"><submit confirmation="WARNING: changing to incorrect or invalid services will break shipping label processing. Do you want to update?"/></default-field></field></form-single></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Gateway/Shipping.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-index="2"><subscreens default-item="FindShippingGateway"/><widgets><subscreens-panel id="ShippingGatewayPanel" type="tab"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Gateway.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Gateways" default-menu-index="10" menu-image="/ssstatic/images/PaymentGateway.png"><subscreens default-item="Payment"/><widgets><subscreens-panel id="GatewayPanel" type="popup"/></widgets></screen>
<!-- Screen Location component://MarbleERP/screen/marble/dashboard.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Dashboard" default-menu-index="1" menu-image="fa fa-dashboard" menu-image-type="icon"><widgets><container-row><row-col md="6" style="text-center"><form-single name="SearchOptions" transition="../QuickSearch" extends="component://SimpleScreens/screen/SimpleScreens/Search.xml#SearchOptions"><field name="queryString"><default-field tooltip=""><text-line size="25"/></default-field></field><field-layout><field-row-big justify="center"><field-ref name="documentType"/><field-ref name="queryString"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single></row-col><row-col md="6" style="text-center"><section name="QuickInfoSection"><actions><entity-find entity-name="mantle.party.PartyRole" list="orgPartyRoles"><econdition field-name="roleTypeId" value="OrgInternal"/></entity-find><set field="orgIntPartyIds" from="orgPartyRoles*.partyId"/><entity-find-count entity-name="mantle.order.OrderPart" count-field="orderPlacedCount"><econdition field-name="statusId" operator="in" from="['OrderPlaced', 'OrderProcessing']"/><econdition field-name="vendorPartyId" operator="in" from="orgIntPartyIds"/></entity-find-count><entity-find-count entity-name="mantle.order.OrderPart" count-field="orderApprovedCount"><econdition field-name="statusId" operator="in" from="['OrderApproved', 'OrderSent']"/><econdition field-name="vendorPartyId" operator="in" from="orgIntPartyIds"/></entity-find-count><entity-find-count entity-name="mantle.order.OrderPart" count-field="orderHeldCount"><econdition field-name="statusId" value="OrderHold"/><econdition field-name="vendorPartyId" operator="in" from="orgIntPartyIds"/></entity-find-count><entity-find-count entity-name="mantle.request.RequestAndParty" count-field="requestSubmittedCount"><econdition field-name="statusId" value="ReqSubmitted"/><econdition field-name="roleTypeId" value="Customer"/></entity-find-count><entity-find-count entity-name="mantle.request.RequestAndParty" count-field="requestInProgressCount"><econdition field-name="statusId" operator="in" from="['ReqReviewed', 'ReqInProgress']"/><econdition field-name="roleTypeId" value="Customer"/></entity-find-count></actions><widgets><container style="big-row text-center q-my-md"><container style="big-row no-wrap" type="span"><container style="big-row-item q-my-auto q-ml-md q-mr-sm"><label text="Sales" type="h4"/></container><container style="big-row-item q-my-auto"><link url="../Order/FindOrder" parameter-map="[orderType:'Sales', statusId:'OrderPlaced,OrderProcessing', statusId_op:'in']" text="Placed" badge="${orderPlacedCount}" btn-type="default"/></container><container style="big-row-item q-my-auto"><link url="../Order/FindOrder" parameter-map="[orderType:'Sales', statusId:'OrderApproved,OrderSent', statusId_op:'in']" text="Approved" badge="${orderApprovedCount}" btn-type="default"/></container><container style="big-row-item q-my-auto"><link url="../Order/FindOrder" parameter-map="[orderType:'Sales', statusId:'OrderHold']" text="Held" badge="${orderHeldCount}" btn-type="default"/></container></container><container style="big-row no-wrap" type="span"><container style="big-row-item q-my-auto q-ml-md q-mr-sm"><label text="Requests" type="h4"/></container><container style="big-row-item q-my-auto"><link url="../Request" parameter-map="[statusId:'ReqSubmitted', roleTypeId:'Customer']" text="Submitted" badge="${requestSubmittedCount}" btn-type="default"/></container><container style="big-row-item q-my-auto"><link url="../Request" parameter-map="[statusId:'ReqReviewed,ReqInProgress', statusId_op:'in', roleTypeId:'Customer']" text="In Progress" badge="${requestInProgressCount}" btn-type="default"/></container></container></container></widgets></section></row-col></container-row><label text="&nbsp;" type="p" encode="false"/><container-row style="diagram-sequence"><row-col sm="4"><container style="diagram-sequence-actor"><link text="Customers" url="../Customer" link-type="anchor"/></container><container style="diagram-sequence-item"><container><link text="Marketing" url="../Marketing" link-type="anchor"/></container><container style="fa left" type="i"/></container><label text="&nbsp;" encode="false" type="div"/><container style="diagram-sequence-item"><link text="Customer <strong>Requests</strong>" encode="false" url="../Request" link-type="anchor"/><container style="fa right" type="i"/></container><label text="&nbsp;" encode="false" type="div"/><container style="diagram-sequence-item"><link text="Sales <strong>Orders</strong> &amp; Quotes" encode="false" url="../Order/FindOrder" link-type="anchor" parameter-map="[orderType:'Sales']"/><container style="fa right" type="i"/></container><label text="&nbsp;" encode="false" type="div"/><container style="diagram-sequence-item"><container><link text="Sales <strong>Shipments</strong>" encode="false" url="../Shipment/FindShipment" link-type="anchor" parameter-map="[parentShipmentType:'ShpTpOutgoing']"/></container><container><link text="Shipping - Pick & Pack" url="../Shipping" link-type="anchor"/></container><container style="fa left" type="i"/></container><label text="&nbsp;" encode="false" type="div"/><container style="diagram-sequence-item"><link text="Receivable <strong>Invoices</strong>" encode="false" url="../Accounting/Invoice/FindInvoice" link-type="anchor" parameter-map="[invoiceType:'Receivable']"/><container style="fa left" type="i"/></container><container style="diagram-sequence-item"><link text="Customer Credit Memos" url="../Accounting/Invoice/FindInvoice" link-type="anchor" parameter-map="[invoiceType:'Payable',invoiceTypeEnumId:'InvoiceCreditMemo']"/><container style="fa right" type="i"/></container><container style="diagram-sequence-item"><link text="Customer <strong>Payments</strong>" encode="false" url="../Accounting/Payment/FindPayment" link-type="anchor" parameter-map="[paymentType:'Incoming',paymentTypeEnumId:'PtInvoicePayment']"/><container style="fa right" type="i"/></container><label text="&nbsp;" encode="false" type="div"/><container style="diagram-sequence-item smaller"><container><link text="Sales Returns & RMA" url="../Return" link-type="anchor" parameter-map="[returnType:'Customer']" style="text-normal"/></container><container style="fa right" type="i"/></container><container style="diagram-sequence-item smaller"><container><link text="Customer Return Shipments" url="../Shipment/FindShipment" link-type="anchor" parameter-map="[shipmentTypeEnumId:'ShpTpSalesReturn']"/></container><container style="fa right" type="i"/></container><container style="diagram-sequence-item smaller"><link text="Payable Return Invoices" url="../Accounting/Invoice/FindInvoice" link-type="anchor" parameter-map="[invoiceType:'Payable',invoiceTypeEnumId:'InvoiceReturn']"/><container style="fa right" type="i"/></container><container style="diagram-sequence-item smaller"><link text="Outgoing Refund Payments" url="../Accounting/Payment/FindPayment" link-type="anchor" parameter-map="[paymentType:'Outgoing',paymentTypeEnumId:'PtRefund']"/><container style="fa left" type="i"/></container></row-col><row-col sm="4"><label text="&nbsp;" encode="false" type="p" style="lt-sm visible-xs-block"/><container style="diagram-sequence-actor"><link text="Internal" url="../Party/FindParty" link-type="anchor" parameter-map="[roleTypeId:'OrgInternal']"/></container><container style="diagram-sequence-item"><container><link text="HR" url="../HumanRes" link-type="anchor"/><label text=" - "/><link text="Employees" url="../Party/FindParty" link-type="anchor" parameter-map="[roleTypeId:'Employee']"/></container></container><label text="&nbsp;" encode="false" type="div"/><container style="diagram-sequence-item"><link text="Requests" url="../Request" link-type="anchor" style="text-strong"/></container><label text="&nbsp;" encode="false" type="div"/><container style="diagram-sequence-item"><link text="Products" url="../Catalog/Product" link-type="anchor" style="text-strong"/><label text=" - "/><link text="Catalog" url="../Catalog" link-type="anchor"/></container><label text="&nbsp;" encode="false" type="div"/><container style="diagram-sequence-item"><container><link text="Assets" url="../Asset" link-type="anchor" style="text-strong"/><label text=" - "/><link text="Inventory" url="../Asset/Asset/FindSummary" link-type="anchor" parameter-map="[assetTypeEnumId:'AstTpInventory']"/></container><container><link text="Manufacturing" url="../Manufacturing" link-type="anchor"/></container></container><label text="&nbsp;" encode="false" type="div"/><container style="diagram-sequence-item"><container><link text="Projects" url="../Project" link-type="anchor" style="text-strong"/></container><container><link text="Tasks" url="../Task" link-type="anchor"/></container></container><label text="&nbsp;" encode="false" type="div"/><container style="diagram-sequence-item"><link text="All Parties" url="../Party" link-type="anchor"/></container><container style="diagram-sequence-item"><container><link text="Facilities" url="../Facility" link-type="anchor"/></container><container><link text="Stores" url="../ProductStore" link-type="anchor"/></container></container><container style="diagram-sequence-item"><container><label text="Content: "/><link text="Wiki" url="../Wiki/WikiSpaces" link-type="anchor"/><label text=" - "/><link text="Blogs" url="../Wiki/WikiBlogs" link-type="anchor"/></container><link text="Surveys" url="../Survey" link-type="anchor"/></container><label text="&nbsp;" encode="false" type="div"/><container style="diagram-sequence-item"><link text="Accounting" url="../Accounting" link-type="anchor" style="text-strong"/><label text=" - "/><link text="Reports" url="../Accounting/Reports" link-type="anchor"/></container><container style="text-center"><link url="../QuickViewReport" text="Custom Reports" link-type="anchor"/><label text=" - "/><link url="../SimpleReport" text="Report Builder" link-type="anchor"/></container></row-col><row-col sm="4"><label text="&nbsp;" encode="false" type="p" style="lt-sm visible-xs-block"/><container style="diagram-sequence-actor"><link text="Suppliers" url="../Supplier" link-type="anchor"/></container><label text="&nbsp;" encode="false" type="p" style="gt-xs hidden-xs"/><label text="&nbsp;" encode="false" type="div" style="gt-xs hidden-xs"/><container style="diagram-sequence-item"><link text="Purchase <strong>Requests</strong>" encode="false" url="../Request" link-type="anchor"/><container style="fa right" type="i"/></container><label text="&nbsp;" encode="false" type="div"/><container style="diagram-sequence-item"><container><link text="Purchase <strong>Orders</strong> &amp; Quotes" encode="false" url="../Order/FindOrder" link-type="anchor" parameter-map="[orderType:'Purchase']"/></container><container style="fa right" type="i"/></container><label text="&nbsp;" encode="false" type="div"/><label text="&nbsp;" encode="false" type="div"/><container style="diagram-sequence-item"><link text="Purchase <strong>Shipments</strong>" encode="false" url="../Shipment/FindShipment" link-type="anchor" parameter-map="[parentShipmentType:'ShpTpIncoming']"/><container style="fa left" type="i"/></container><label text="&nbsp;" encode="false" type="div"/><container style="diagram-sequence-item"><link text="Payable <strong>Invoices</strong>" encode="false" url="../Accounting/Invoice/FindInvoice" link-type="anchor" parameter-map="[invoiceType:'Payable']"/><container style="fa left" type="i"/></container><container style="diagram-sequence-item"><link text="Supplier Credit Memos" url="../Accounting/Invoice/FindInvoice" link-type="anchor" parameter-map="[invoiceType:'Receivable',invoiceTypeEnumId:'InvoiceCreditMemo']"/><container style="fa right" type="i"/></container><container style="diagram-sequence-item"><link text="Supplier <strong>Payments</strong>" encode="false" url="../Accounting/Payment/FindPayment" link-type="anchor" parameter-map="[paymentType:'Outgoing',paymentTypeEnumId:'PtInvoicePayment']"/><container style="fa right" type="i"/></container><label text="&nbsp;" encode="false" type="div"/><container style="diagram-sequence-item smaller"><container><link text="Purchase Returns" url="../Return" link-type="anchor" parameter-map="[returnType:'Supplier']"/></container><container style="fa right" type="i"/></container><container style="diagram-sequence-item smaller"><container><link text="Supplier Return Shipments" url="../Shipment/FindShipment" link-type="anchor" parameter-map="[shipmentTypeEnumId:'ShpTpPurchaseReturn']"/></container><container style="fa right" type="i"/></container><container style="diagram-sequence-item smaller"><link text="Receivable Return Invoices" url="../Accounting/Invoice/FindInvoice" link-type="anchor" parameter-map="[invoiceType:'Receivable',invoiceTypeEnumId:'InvoiceReturn']"/><container style="fa right" type="i"/></container><container style="diagram-sequence-item smaller"><link text="Incoming Refund Payments" url="../Accounting/Payment/FindPayment" link-type="anchor" parameter-map="[paymentType:'Incoming',paymentTypeEnumId:'PtRefund']"/><container style="fa left" type="i"/></container></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/QuickSearch.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Quick Search" default-menu-index="2" menu-image="fa fa-search" menu-image-type="icon"><transition name="assetDetail"><default-response url="//apps/${appRoot}/Asset/AssetDetail"/></transition><transition name="editFacility"><default-response url="//apps/${appRoot}/Facility/EditFacility"/></transition><transition name="orderDetail"><default-response url="//apps/${appRoot}/Order/OrderDetail"/></transition><transition name="editReturn"><default-response url="//apps/${appRoot}/Return/EditReturn"/></transition><transition name="shipmentDetail"><default-response url="//apps/${appRoot}/Shipment/ShipmentDetail"/></transition><transition name="picklistDetail"><default-response url="//apps/${appRoot}/Shipping/Picklist/PicklistDetail"/></transition><transition name="editRun"><default-response url="//apps/${appRoot}/Manufacturing/Run/EditRun"/></transition><transition name="projectSummary"><default-response url="//apps/${appRoot}/Project/ProjectSummary"/></transition><transition name="taskSummary"><default-response url="//apps/${appRoot}/Task/TaskSummary"/></transition><transition name="editParty"><default-response url="//apps/${appRoot}/Party/EditParty"/></transition><transition name="editSupplier"><default-response url="//apps/${appRoot}/Supplier/EditSupplier"/></transition><transition name="editCustomer"><default-response url="//apps/${appRoot}/Customer/EditCustomer"/></transition><transition name="editProduct"><default-response url="//apps/${appRoot}/Catalog/Product/EditProduct"/></transition><transition name="editPayment"><default-response url="//apps/${appRoot}/Accounting/Payment/EditPayment"/></transition><transition name="editInvoice"><default-response url="//apps/${appRoot}/Accounting/Invoice/EditInvoice"/></transition><transition name="editTransaction"><default-response url="//apps/${appRoot}/Accounting/Transaction/EditTransaction"/></transition><actions><set field="indexName" from="searchIndexName"/><set field="originalQueryString" from="queryString"/><if condition="queryString"><set field="lookupFuture" from="ec.service.async().name('mantle.GeneralServices.lookup#ById').parameter('lookupId', originalQueryString).callFuture()"/><service-call name="mantle.GeneralServices.search#MantleFiltered" in-map="context" out-map="context"/><set field="lookupResults" from="lookupFuture.get(10, java.util.concurrent.TimeUnit.SECONDS)"/><script><![CDATA[if (lookupResults) context.putAll(lookupResults)]]></script></if></actions><widgets><container><label text="Search + Lookup by ID" type="strong"/><label text=" for Asset, Facility, Invoice, Order, Return, Party, Badge, Payment, Product, Shipment, Work Effort (Project, Task, Picklist, Production Run), GL Transaction"/></container><form-single name="SearchOptions" transition="." extends="component://SimpleScreens/screen/SimpleScreens/Search.xml#SearchOptions"/><section-include name="AssetSection" location="component://SimpleScreens/screen/SimpleScreens/QuickLookup.xml"/><section-include name="FacilitySection" location="component://SimpleScreens/screen/SimpleScreens/QuickLookup.xml"/><section-include name="InvoiceSection" location="component://SimpleScreens/screen/SimpleScreens/QuickLookup.xml"/><section-include name="OrderSection" location="component://SimpleScreens/screen/SimpleScreens/QuickLookup.xml"/><section-include name="ReturnSection" location="component://SimpleScreens/screen/SimpleScreens/QuickLookup.xml"/><section-include name="PartySection" location="component://SimpleScreens/screen/SimpleScreens/QuickLookup.xml"/><section-include name="PaymentSection" location="component://SimpleScreens/screen/SimpleScreens/QuickLookup.xml"/><section-include name="ProductSection" location="component://SimpleScreens/screen/SimpleScreens/QuickLookup.xml"/><section-include name="ShipmentSection" location="component://SimpleScreens/screen/SimpleScreens/QuickLookup.xml"/><section-include name="WorkEffortSection" location="component://SimpleScreens/screen/SimpleScreens/QuickLookup.xml"/><section-include name="AcctgTransSection" location="component://SimpleScreens/screen/SimpleScreens/QuickLookup.xml"/><section-iterate name="messageInfos" list="ec.message.messageInfos" entry="messageInfo"><widgets><container><label text="${messageInfo.message}" type="strong" style="text-${messageInfo.typeString}"/></container></widgets></section-iterate><container-box><box-header title="Search Results"/><box-body-nopad><form-list name="SearchResults" list="documentList" extends="component://SimpleScreens/screen/SimpleScreens/Search.xml#SearchResults"/><label text="Full search string: ${queryString?:''}" type="p"/><link url="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-query-string-query.html#query-string-syntax" url-type="plain" link-type="anchor" target-window="_blank" text="Search String Reference"/></box-body-nopad></container-box></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/OrgSettings/AcctgPreference.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Accounting Preferences" default-menu-index="1"><parameter name="partyId" required="true"/><transition name="editAcctgPreferences"><default-response url="."/></transition><transition name="updatePartyAcctgPreference"><service-call name="update#mantle.ledger.config.PartyAcctgPreference" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="initPartyAccountingConfiguration"><service-call name="mantle.ledger.LedgerServices.init#PartyAccountingConfiguration" in-map="context + [organizationPartyId:partyId]" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><entity-find-one entity-name="mantle.party.PartyDetail" value-field="partyDetail"/><set field="organizationPartyId" from="partyId"/><entity-find-one entity-name="mantle.ledger.config.PartyAcctgPreference" value-field="partyAcctgPreference"/><if condition="!partyAcctgPreference"><service-call name="mantle.ledger.LedgerServices.find#PartyAcctgPreference" in-map="context" out-map="findPapOut"/></if></actions><widgets><label text="Accounting Preferences for ${partyDetail.organizationName} [${partyDetail.pseudoId}]" type="h3"/><section name="HasPapSection" condition="partyAcctgPreference"><widgets><form-single name="EditPapForm" transition="updatePartyAcctgPreference" map="partyAcctgPreference"><field name="partyId"><default-field><hidden/></default-field></field><field name="organizationPartyId"><default-field><hidden/></default-field></field><field name="baseCurrencyUomId"><default-field title="Base Currency"><display-entity entity-name="moqui.basic.Uom" text="${uomId} - ${description}"/></default-field></field><field name="localCurrencyUomId"><default-field title="Local Currency"><display-entity entity-name="moqui.basic.Uom" text="${uomId} - ${description} - Local Currency Amounts are calculated for each GL Transaction IF a current exchange rate is set in a UomConversion record between Base Currency and Local Currency"/></default-field></field><field name="cogsMethodEnumId"><default-field title="COGS Method"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="settlementTermId"><default-field title="Default Receivables Term" tooltip="Settlement Term can be set on each invoice, a per-customer term may be set in an Agreement"><drop-down allow-empty="true"><entity-options key="${settlementTermId}" text="${description}"><entity-find entity-name="mantle.account.invoice.SettlementTerm"><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="hourlyTimePeriodTypeId"><default-field title="Pay Period - Hourly"><drop-down><entity-options key="${timePeriodTypeId}" text="${description}"><entity-find entity-name="mantle.party.time.TimePeriodType"><econdition field-name="periodPurposeEnumId" value="Payroll"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="salaryTimePeriodTypeId"><default-field title="Pay Period - Salary"><drop-down><entity-options key="${timePeriodTypeId}" text="${description}"><entity-find entity-name="mantle.party.time.TimePeriodType"><econdition field-name="periodPurposeEnumId" value="Payroll"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="errorGlJournalId"><default-field title="Error Journal"><drop-down><entity-options key="${glJournalId}" text="${glJournalName}"><entity-find entity-name="mantle.ledger.transaction.GlJournal"><econdition field-name="organizationPartyId"/><order-by field-name="glJournalName"/></entity-find></entity-options></drop-down></default-field></field><field name="realTimeGlSummary"><default-field title="Per-Transaction GL Summary" tooltip="Defaults to N. If set to Y then Organization and Org/TimePeriod summaries are updated with each AcctgTrans post instead of with a timed job."><radio no-current-selected-key="N"><option key="Y"/><option key="N"/></radio></default-field></field><field name="taxClassificationEnumId"><default-field title="Tax Classification"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="TaxClassification"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="taxFormEnumId"><default-field title="Tax Form"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="TaxForm"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="employerClassEnumId"><default-field title="Employer Classification"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="EmployerClassification"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="payrollTaxFormEnumId"><default-field title="Payroll Tax Form"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="PayrollTaxForm"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></widgets><fail-widgets><label text="${partyDetail.organizationName} [${partyDetail.pseudoId}] has no accounting preferences." type="p" style="text-strong"/><section name="ParentPap" condition="findPapOut.partyAcctgPreference"><actions><entity-find-one entity-name="mantle.party.PartyDetail" value-field="existingPapParty"><field-map field-name="partyId" from="findPapOut.partyAcctgPreference.organizationPartyId"/></entity-find-one></actions><widgets><label text="Parent organization ${existingPapParty.organizationName} [${existingPapParty.pseudoId}] has accounting settings."/><link url="editAcctgPreferences" text="Edit ${existingPapParty.organizationName} [${existingPapParty.pseudoId}] Accounting Settings" parameter-map="[partyId:existingPapParty.partyId]" link-type="anchor"/></widgets></section><section name="CloneAcctgSettingsSection"><actions><entity-find entity-name="mantle.ledger.config.PartyAcctgPreference" list="allPapList"/><set field="papPartyList" from="[]"/><iterate list="allPapList" entry="allPap"><entity-find-one entity-name="mantle.party.PartyDetail" value-field="allPapParty"><field-map field-name="partyId" from="allPap.organizationPartyId"/></entity-find-one><script><![CDATA[papPartyList.add(allPapParty)]]></script></iterate></actions><widgets><form-single name="CloneAcctgSettingsForm" transition="initPartyAccountingConfiguration"><field name="partyId"><default-field><hidden/></default-field></field><field name="baseCurrencyUomId"><default-field title="Base Currency"><drop-down no-current-selected-key="USD"><entity-options key="${uomId}" text="${uomId} - ${description}"><entity-find entity-name="moqui.basic.Uom"><econdition field-name="uomTypeEnumId" value="UT_CURRENCY_MEASURE"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="localCurrencyUomId"><default-field title="Local Currency" tooltip="Local currency for financial reporting, only needed IF DIFFERENT from Base Currency; if used separate local currency amounts are calculated for each GL transaction"><drop-down allow-empty="true"><entity-options key="${uomId}" text="${uomId} - ${description}"><entity-find entity-name="moqui.basic.Uom"><econdition field-name="uomTypeEnumId" value="UT_CURRENCY_MEASURE"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="cogsMethodEnumId"><default-field><hidden default-value="CogsActualCost"/></default-field></field><field name="sourcePartyId"><default-field title="Source Party"><drop-down><list-options list="papPartyList" key="${partyId}" text="${organizationName} [${pseudoId}]"/></drop-down></default-field></field><field name="submitButton"><default-field title="Clone Accounting Settings"><submit confirmation="Are you sure? This will enable GL posting for this organization."/></default-field></field></form-single></widgets></section></fail-widgets></section></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/OrgSettings/GlAccounts.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="GL Accounts" default-menu-index="2"><parameter name="partyId" required="true"/><transition name="editGlAccount"><default-response url="../../../Accounting/GlAccount/EditGlAccount"/></transition><transition name="createGlAccountOrganization"><service-call name="create#mantle.ledger.account.GlAccountOrganization" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteGlAccountOrganization"><service-call name="delete#mantle.ledger.account.GlAccountOrganization" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getGlAccountListPaginated" location="component://SimpleScreens/template/account/AccountTransitions.xml"/><actions><set field="organizationPartyId" from="partyId"/><entity-find-one entity-name="mantle.party.Organization" value-field="organization"/><entity-find entity-name="mantle.ledger.account.GlAccountAndOrganization" list="glaoList"><search-form-inputs default-order-by="accountCode"/><econdition field-name="partyId"/></entity-find><service-call name="mantle.ledger.LedgerServices.find#PartyAcctgPreference" in-map="context" out-map="context"/><set field="glAccountCodeMask" from="partyAcctgPreference?.glAccountCodeMask ?: ec.user.getPreference('GlAccountCodeMask')"/><set field="accountCodeFormatter" from="masker(glAccountCodeMask, '0')"/></actions><widgets><label text="GL Accounts for ${organization.organizationName}" type="h3"/><container-dialog id="NewGlAccountOrgDialog" button-text="Add GL Account"><form-single name="NewGlAccountOrgForm" transition="createGlAccountOrganization"><field name="partyId"><default-field><hidden/></default-field></field><field name="organizationPartyId"><default-field><hidden/></default-field></field><field name="glAccountId"><default-field title="GL Account"><drop-down allow-empty="true"><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0" parameter-map="[organizationPartyId:null]"/></drop-down></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog><form-list name="GlAccountOrgList" list="glaoList" skip-form="true"><field name="partyId"><header-field><hidden/></header-field></field><field name="accountCode"><header-field show-order-by="case-insensitive"><text-find size="10" hide-options="true"/></header-field><default-field><link url="editGlAccount" text="${accountCodeFormatter != null ? accountCodeFormatter.valueToString(accountCode) : accountCode}" link-type="anchor"/></default-field></field><field name="accountName"><header-field show-order-by="case-insensitive"><text-find size="20" hide-options="true"/></header-field><default-field><display/></default-field></field><field name="parentGlAccountId"><default-field title="Parent Account"><link url="editGlAccount" entity-name="mantle.ledger.account.GlAccount" link-type="anchor" condition="parentGlAccountId" parameter-map="[glAccountId:parentGlAccountId]" text="${accountCodeFormatter != null ? accountCodeFormatter.valueToString(accountCode) : accountCode}: ${accountName}"/></default-field></field><field name="glAccountTypeEnumId"><header-field title="Account Type" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="GlAccountType"/><set field="allowEmpty" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="glAccountClassEnumId"><header-field title="Account Class" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="GlAccountClass"/><set field="allowEmpty" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="postedBalance"><default-field><display currency-unit-field="partyAcctgPreference?.baseCurrencyUomId"/></default-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field><default-field><link url="deleteGlAccountOrganization" text=" " icon="fa fa-trash" confirmation="Delete? Will be automatically added if any transactions are posted to it." parameter-map="[partyId:partyId, organizationPartyId:organizationPartyId, glAccountId:glAccountId]"/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/OrgSettings/TypeDefaults.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Account Types" default-menu-index="3"><parameter name="partyId" required="true"/><transition name="editGlAccount"><default-response url="../../../Accounting/GlAccount/EditGlAccount"/></transition><transition name="storeConfig"><service-call name="store#mantle.ledger.config.GlAccountTypeDefault" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getGlAccountListPaginated" location="component://SimpleScreens/template/account/AccountTransitions.xml"/><actions><set field="organizationPartyId" from="partyId"/><entity-find-one entity-name="mantle.party.Organization" value-field="organization"/><entity-find entity-name="mantle.ledger.config.GlAccountAndTypeDefault" list="allConfigList"><econdition field-name="organizationPartyId"/></entity-find><entity-find entity-name="moqui.basic.Enumeration" list="typeEnumList"><econdition field-name="enumTypeId" value="GlAccountType"/><order-by field-name="description"/></entity-find></actions><widgets><form-list name="AllEnumList" list="typeEnumList" list-entry="typeEnum" transition="storeConfig"><row-actions><filter-map-list list="allConfigList" to-list="configList"><field-map field-name="glAccountTypeEnumId" from="typeEnum.enumId"/></filter-map-list><set field="configItem" from="configList?.getAt(0)"/><script><![CDATA[if (configItem) context.putAll(configItem)]]></script></row-actions><field name="partyId"><default-field><hidden/></default-field></field><field name="glAccountTypeEnumId" from="typeEnum.enumId"><default-field><hidden/></default-field></field><field name="organizationPartyId"><default-field><hidden/></default-field></field><field name="accountType"><default-field><display text="${typeEnum.description}"/></default-field></field><field name="glAccountId"><default-field title="GL Account"><drop-down allow-empty="true"><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0"/></drop-down></default-field></field><field name="accountCode"><conditional-field condition="!configItem"><display text=" "/></conditional-field><default-field><link url="editGlAccount" text="${accountCode}" link-type="anchor"/></default-field></field><field name="accountName"><default-field><display/></default-field></field><field name="accountGlAccountTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="glAccountClassEnumId"><default-field title="Class"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="submitButton"><conditional-field condition="configItem" title="Update"><submit/></conditional-field><default-field title="Add"><submit/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/OrgSettings/InvoiceTypes.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Invoice Types" default-menu-index="4"><parameter name="partyId" required="true"/><transition name="editGlAccount"><default-response url="../../../Accounting/GlAccount/EditGlAccount"/></transition><transition name="storeConfig"><service-call name="store#mantle.ledger.config.InvoiceTypeTransType" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateConfig"><service-call name="update#mantle.ledger.config.InvoiceTypeTransType" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getGlAccountListPaginated" location="component://SimpleScreens/template/account/AccountTransitions.xml"/><actions><set field="organizationPartyId" from="partyId"/><entity-find-one entity-name="mantle.party.Organization" value-field="organization"/><entity-find entity-name="mantle.ledger.config.InvoiceTypeTransTypeDetail" list="allConfigList"><econdition field-name="organizationPartyId"/><order-by field-name="invoiceTypeDescription,isPayable"/></entity-find><entity-find entity-name="moqui.basic.Enumeration" list="typeEnumList"><econdition field-name="enumTypeId" value="InvoiceType"/><order-by field-name="description"/></entity-find><set field="allItemTypeEnumIds" from="typeEnumList.enumId"/><set field="configTypeEnumIds" from="allConfigList.invoiceTypeEnumId"/><set field="noConfigTypeEnumIds" from="allItemTypeEnumIds - configTypeEnumIds"/></actions><widgets><container-dialog id="AddConfigDialog" button-text="Add Invoice Type Mapping"><form-single name="AddConfigForm" transition="storeConfig"><field name="partyId"><default-field><hidden/></default-field></field><field name="organizationPartyId"><default-field><hidden/></default-field></field><field name="invoiceTypeEnumId"><default-field title="Invoice Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="InvoiceType"/></widget-template-include></default-field></field><field name="isPayable"><default-field><drop-down><option key="Y" text="Y (Payable)"/><option key="N" text="N (Receivable)"/></drop-down></default-field></field><field name="acctgTransTypeEnumId"><default-field title="Transaction Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="AcctgTransType"/></widget-template-include></default-field></field><field name="glAccountId"><default-field title="GL Account"><drop-down allow-empty="true"><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0"/></drop-down></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog><container-dialog id="MissingConfigDialog" button-text="Add From Missing Invoice Types" width="800"><form-list name="MissingConfigForm" list="noConfigTypeEnumIds" list-entry="invoiceTypeEnumId" transition="storeConfig"><field name="partyId"><default-field><hidden/></default-field></field><field name="organizationPartyId"><default-field><hidden/></default-field></field><field name="invoiceTypeEnumId"><default-field title="Invoice Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="isPayable"><default-field><drop-down><option key="Y" text="Y (Payable)"/><option key="N" text="N (Receivable)"/></drop-down></default-field></field><field name="acctgTransTypeEnumId"><default-field title="Transaction Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="AcctgTransType"/></widget-template-include></default-field></field><field name="glAccountId"><default-field title="GL Account"><drop-down allow-empty="true"><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0"/></drop-down></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-list></container-dialog><form-list name="AllConfigList" list="allConfigList" transition="updateConfig"><field name="partyId"><default-field><hidden/></default-field></field><field name="organizationPartyId"><default-field><hidden/></default-field></field><field name="invoiceTypeEnumId"><default-field><hidden/></default-field></field><field name="invoiceTypeDescription"><default-field title="Invoice Type"><display/></default-field></field><field name="isPayable"><default-field><display/></default-field></field><field name="acctgTransTypeEnumId"><default-field title="Transaction Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="AcctgTransType"/></widget-template-include></default-field></field><field name="glAccountId"><default-field title="GL Account"><drop-down allow-empty="true"><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0"/></drop-down></default-field></field><field name="accountCode"><default-field><link url="editGlAccount" text="${accountCode}" link-type="anchor" condition="accountCode"/></default-field></field><field name="accountName"><default-field><display/></default-field></field><field name="glAccountTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="glAccountClassEnumId"><default-field title="Class"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/OrgSettings/ItemTypes.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Item Types" default-menu-index="4"><parameter name="partyId" required="true"/><transition name="editGlAccount"><default-response url="../../../Accounting/GlAccount/EditGlAccount"/></transition><transition name="storeConfig"><service-call name="store#mantle.ledger.config.ItemTypeGlAccount" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateConfig"><service-call name="update#mantle.ledger.config.ItemTypeGlAccount" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getGlAccountListPaginated" location="component://SimpleScreens/template/account/AccountTransitions.xml"/><actions><set field="organizationPartyId" from="partyId"/><entity-find-one entity-name="mantle.party.Organization" value-field="organization"/><entity-find entity-name="mantle.ledger.config.ItemTypeAndGlAccount" list="allConfigList"><econdition field-name="organizationPartyId"/><order-by field-name="itemTypeDescription"/></entity-find><entity-find entity-name="moqui.basic.Enumeration" list="typeEnumList"><econdition field-name="enumTypeId" value="ItemType"/><order-by field-name="description"/></entity-find><set field="allItemTypeEnumIds" from="typeEnumList.enumId"/><set field="configTypeEnumIds" from="allConfigList.itemTypeEnumId"/><set field="noConfigTypeEnumIds" from="allItemTypeEnumIds - configTypeEnumIds"/></actions><widgets><container-dialog id="AddConfigDialog" button-text="Add Item Type Account"><form-single name="AddConfigForm" transition="storeConfig"><field name="partyId"><default-field><hidden/></default-field></field><field name="organizationPartyId"><default-field><hidden/></default-field></field><field name="itemTypeEnumId"><default-field><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ItemType"/></widget-template-include></default-field></field><field name="direction"><default-field><drop-down><option key="E" text="Either"/><option key="I" text="Incoming (Purchase)"/><option key="O" text="Outgoing (Sales)"/></drop-down></default-field></field><field name="glAccountId"><default-field title="GL Account"><drop-down allow-empty="true"><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0"/></drop-down></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog><container-dialog id="MissingConfigDialog" button-text="Add From Missing Item Types" width="900"><form-list name="MissingConfigForm" list="noConfigTypeEnumIds" list-entry="itemTypeEnumId" transition="storeConfig"><field name="partyId"><default-field><hidden/></default-field></field><field name="organizationPartyId"><default-field><hidden/></default-field></field><field name="itemTypeEnumId"><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="direction"><default-field><drop-down><option key="E" text="Either"/><option key="I" text="Incoming (Purchase)"/><option key="O" text="Outgoing (Sales)"/></drop-down></default-field></field><field name="glAccountId"><default-field title="GL Account"><drop-down allow-empty="true"><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0"/></drop-down></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-list></container-dialog><form-list name="AllConfigList" list="allConfigList" transition="updateConfig"><field name="partyId"><default-field><hidden/></default-field></field><field name="organizationPartyId"><default-field><hidden/></default-field></field><field name="itemTypeEnumId"><default-field><hidden/></default-field></field><field name="itemType"><default-field><display text="${itemTypeDescription}"/></default-field></field><field name="direction"><default-field><display/></default-field></field><field name="glAccountId"><default-field title="GL Account"><drop-down allow-empty="true"><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0"/></drop-down></default-field></field><field name="accountCode"><default-field><link url="editGlAccount" text="${accountCode}" link-type="anchor"/></default-field></field><field name="accountName"><default-field><display/></default-field></field><field name="glAccountTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="glAccountClassEnumId"><default-field title="Class"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/OrgSettings/PaymentTypes.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Payment Types" default-menu-index="5"><parameter name="partyId" required="true"/><transition name="editGlAccount"><default-response url="../../../Accounting/GlAccount/EditGlAccount"/></transition><transition name="storeConfig"><service-call name="store#mantle.ledger.config.PaymentTypeGlAccount" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateConfig"><service-call name="update#mantle.ledger.config.PaymentTypeGlAccount" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getGlAccountListPaginated" location="component://SimpleScreens/template/account/AccountTransitions.xml"/><actions><set field="organizationPartyId" from="partyId"/><entity-find-one entity-name="mantle.party.Organization" value-field="organization"/><entity-find entity-name="mantle.ledger.config.PaymentTypeAndGlAccount" list="allConfigList"><econdition field-name="organizationPartyId"/><order-by field-name="typeDescription"/></entity-find><entity-find entity-name="moqui.basic.Enumeration" list="typeEnumList"><econdition field-name="enumTypeId" value="PaymentType"/><order-by field-name="description"/></entity-find><set field="allPaymentTypeEnumIds" from="typeEnumList.enumId"/><set field="configTypeEnumIds" from="allConfigList.paymentTypeEnumId"/><set field="noConfigTypeEnumIds" from="allPaymentTypeEnumIds - configTypeEnumIds"/></actions><widgets><container-dialog id="AddConfigDialog" button-text="Add Payment Type Account"><form-single name="AddConfigForm" transition="storeConfig"><field name="partyId"><default-field><hidden/></default-field></field><field name="organizationPartyId"><default-field><hidden/></default-field></field><field name="paymentTypeEnumId"><default-field><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="PaymentType"/></widget-template-include></default-field></field><field name="isApplied"><default-field><drop-down><option key="Y" text="Y (Applied when posted)"/><option key="N" text="N (Not applied when posted)"/></drop-down></default-field></field><field name="isPayable"><default-field><drop-down><option key="Y" text="Y (Payable/Outgoing)"/><option key="N" text="N (Receivable/Incoming)"/></drop-down></default-field></field><field name="glAccountId"><default-field title="GL Account"><drop-down allow-empty="true"><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0"/></drop-down></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog><container-dialog id="MissingConfigDialog" button-text="Add From Missing Payment Types" width="900"><form-list name="MissingConfigForm" list="noConfigTypeEnumIds" list-entry="paymentTypeEnumId" transition="storeConfig"><field name="partyId"><default-field><hidden/></default-field></field><field name="organizationPartyId"><default-field><hidden/></default-field></field><field name="paymentTypeEnumId"><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="isApplied"><default-field><drop-down><option key="Y" text="Y (Applied when posted)"/><option key="N" text="N (Not applied when posted)"/></drop-down></default-field></field><field name="isPayable"><default-field><drop-down><option key="Y" text="Y (Payable/Outgoing)"/><option key="N" text="N (Receivable/Incoming)"/></drop-down></default-field></field><field name="glAccountId"><default-field title="GL Account"><drop-down allow-empty="true"><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0"/></drop-down></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-list></container-dialog><form-list name="AllConfigList" list="allConfigList" transition="updateConfig"><field name="partyId"><default-field><hidden/></default-field></field><field name="organizationPartyId"><default-field><hidden/></default-field></field><field name="paymentTypeEnumId"><default-field><hidden/></default-field></field><field name="paymentType"><default-field><display text="${typeDescription}"/></default-field></field><field name="isApplied"><default-field><display/></default-field></field><field name="isPayable"><default-field><display/></default-field></field><field name="glAccountId"><default-field title="GL Account"><drop-down allow-empty="true"><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0"/></drop-down></default-field></field><field name="accountCode"><default-field><link url="editGlAccount" text="${accountCode}" link-type="anchor"/></default-field></field><field name="accountName"><default-field><display/></default-field></field><field name="glAccountTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="glAccountClassEnumId"><default-field title="Class"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/OrgSettings/PaymentInstruments.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Payment Instruments" default-menu-index="6"><parameter name="partyId" required="true"/><transition name="editGlAccount"><default-response url="../../../Accounting/GlAccount/EditGlAccount"/></transition><transition name="storeConfig"><service-call name="store#mantle.ledger.config.PaymentInstrumentGlAccount" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getGlAccountListPaginated" location="component://SimpleScreens/template/account/AccountTransitions.xml"/><actions><set field="organizationPartyId" from="partyId"/><entity-find-one entity-name="mantle.party.Organization" value-field="organization"/><entity-find entity-name="mantle.ledger.config.PaymentInstrumentAndGlAccount" list="allConfigList"><econdition field-name="organizationPartyId"/></entity-find><entity-find entity-name="moqui.basic.Enumeration" list="typeEnumList"><econdition field-name="enumTypeId" value="PaymentInstrument"/><order-by field-name="description"/></entity-find></actions><widgets><form-list name="AllEnumList" list="typeEnumList" list-entry="typeEnum" transition="storeConfig"><row-actions><filter-map-list list="allConfigList" to-list="configList"><field-map field-name="paymentInstrumentEnumId" from="typeEnum.enumId"/></filter-map-list><set field="configItem" from="configList?.getAt(0)"/><script><![CDATA[if (configItem) context.putAll(configItem)]]></script></row-actions><field name="partyId"><default-field><hidden/></default-field></field><field name="isPayable"><default-field><hidden default-value="E"/></default-field></field><field name="paymentInstrumentEnumId" from="typeEnum.enumId"><default-field><hidden/></default-field></field><field name="organizationPartyId"><default-field><hidden/></default-field></field><field name="accountType"><default-field><display text="${typeEnum.description}"/></default-field></field><field name="glAccountId"><default-field title="GL Account"><drop-down allow-empty="true"><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0"/></drop-down></default-field></field><field name="accountCode"><conditional-field condition="!configItem"><display text=" "/></conditional-field><default-field><link url="editGlAccount" text="${accountCode}" link-type="anchor"/></default-field></field><field name="accountName"><default-field><display/></default-field></field><field name="glAccountTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="glAccountClassEnumId"><default-field title="Class"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="submitButton"><conditional-field condition="configItem" title="Update"><submit/></conditional-field><default-field title="Add"><submit/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/OrgSettings/FinAcctReasons.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Financial Acct Reasons" default-menu-index="7"><parameter name="partyId" required="true"/><transition name="editGlAccount"><default-response url="../../../Accounting/GlAccount/EditGlAccount"/></transition><transition name="storeConfig"><service-call name="store#mantle.ledger.config.FinancialAccountReasonGlAccount" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getGlAccountListPaginated" location="component://SimpleScreens/template/account/AccountTransitions.xml"/><actions><set field="organizationPartyId" from="partyId"/><entity-find-one entity-name="mantle.party.Organization" value-field="organization"/><entity-find entity-name="mantle.ledger.config.FinancialAccountReasonAndGlAccount" list="allConfigList"><econdition field-name="organizationPartyId"/></entity-find><entity-find entity-name="moqui.basic.Enumeration" list="finAcctReasonList"><econdition field-name="enumTypeId" value="FinancialAccountTransReason"/><order-by field-name="description"/></entity-find></actions><widgets><form-list name="AllTypesList" list="finAcctReasonList" list-entry="finAcctReason" transition="storeConfig"><row-actions><filter-map-list list="allConfigList" to-list="configList"><field-map field-name="reasonEnumId" from="finAcctReason.enumId"/></filter-map-list><set field="configItem" from="configList?.getAt(0)"/><script><![CDATA[if (configItem) context.putAll(configItem)]]></script></row-actions><field name="partyId"><default-field><hidden/></default-field></field><field name="reasonEnumId" from="finAcctReason.enumId"><default-field><hidden/></default-field></field><field name="organizationPartyId"><default-field><hidden/></default-field></field><field name="reason"><default-field title="TX Reason"><display text="${finAcctReason.description}"/></default-field></field><field name="glAccountId"><default-field title="GL Account"><drop-down allow-empty="true"><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0"/></drop-down></default-field></field><field name="accountCode"><conditional-field condition="!configItem"><display text=" "/></conditional-field><default-field><link url="editGlAccount" text="${accountCode}" link-type="anchor"/></default-field></field><field name="accountName"><default-field><display/></default-field></field><field name="glAccountTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="glAccountClassEnumId"><default-field title="Class"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="submitButton"><conditional-field condition="configItem" title="Update"><submit/></conditional-field><default-field title="Add"><submit/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/OrgSettings/FinAcctTypes.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Financial Acct Types" default-menu-index="7"><parameter name="partyId" required="true"/><transition name="editGlAccount"><default-response url="../../../Accounting/GlAccount/EditGlAccount"/></transition><transition name="storeConfig"><service-call name="store#mantle.ledger.config.FinancialAccountTypeGlAccount" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getGlAccountListPaginated" location="component://SimpleScreens/template/account/AccountTransitions.xml"/><actions><set field="organizationPartyId" from="partyId"/><entity-find-one entity-name="mantle.party.Organization" value-field="organization"/><entity-find entity-name="mantle.ledger.config.FinancialAccountTypeAndGlAccount" list="allConfigList"><econdition field-name="organizationPartyId"/></entity-find><entity-find entity-name="mantle.account.financial.FinancialAccountType" list="finAcctTypeList"><order-by field-name="description"/></entity-find></actions><widgets><form-list name="AllTypesList" list="finAcctTypeList" list-entry="finAcctType" transition="storeConfig"><row-actions><filter-map-list list="allConfigList" to-list="configList"><field-map field-name="finAccountTypeId" from="finAcctType.finAccountTypeId"/></filter-map-list><set field="configItem" from="configList?.getAt(0)"/><script><![CDATA[if (configItem) context.putAll(configItem)]]></script></row-actions><field name="partyId"><default-field><hidden/></default-field></field><field name="finAccountTypeId" from="finAcctType.finAccountTypeId"><default-field><hidden/></default-field></field><field name="organizationPartyId"><default-field><hidden/></default-field></field><field name="accountType"><default-field><display text="${finAcctType.description}"/></default-field></field><field name="glAccountId"><default-field title="GL Account"><drop-down allow-empty="true"><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0"/></drop-down></default-field></field><field name="accountCode"><conditional-field condition="!configItem"><display text=" "/></conditional-field><default-field><link url="editGlAccount" text="${accountCode}" link-type="anchor"/></default-field></field><field name="accountName"><default-field><display/></default-field></field><field name="glAccountTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="glAccountClassEnumId"><default-field title="Class"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="submitButton"><conditional-field condition="configItem" title="Update"><submit/></conditional-field><default-field title="Add"><submit/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/OrgSettings/AssetTypes.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Asset Types" default-menu-index="8"><parameter name="partyId" required="true"/><transition name="editGlAccount"><default-response url="../../GlAccount/EditGlAccount"/></transition><transition name="storeConfig"><service-call name="store#mantle.ledger.config.AssetTypeGlAccount" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateConfig"><service-call name="update#mantle.ledger.config.AssetTypeGlAccount" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getGlAccountListPaginated" location="component://SimpleScreens/template/account/AccountTransitions.xml"/><actions><set field="organizationPartyId" from="partyId"/><entity-find-one entity-name="mantle.party.Organization" value-field="organization"/><entity-find entity-name="mantle.ledger.config.AssetTypeGlAccountDetail" list="allConfigList"><econdition field-name="organizationPartyId"/><order-by field-name="assetTypeDescription,assetClassDescription"/></entity-find></actions><widgets><container-dialog id="AddConfigDialog" button-text="Add Asset Type Mapping"><form-single name="AddConfigForm" transition="storeConfig"><field name="partyId"><default-field><hidden/></default-field></field><field name="organizationPartyId"><default-field><hidden/></default-field></field><field name="assetTypeEnumId"><default-field title="Asset Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="AssetType"/></widget-template-include></default-field></field><field name="classEnumId"><default-field title="Asset Class"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="AssetClass"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="assetGlAccountId"><default-field title="Asset Account"><drop-down allow-empty="true"><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0"/></drop-down></default-field></field><field name="receiptGlAccountId"><default-field title="Receipt Account"><drop-down allow-empty="true"><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0"/></drop-down></default-field></field><field name="issuanceGlAccountId"><default-field title="Issuance Account"><drop-down allow-empty="true"><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0"/></drop-down></default-field></field><field name="receiptTransTypeEnumId"><default-field title="Receipt TX Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="AcctgTransType"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="issuanceTransTypeEnumId"><default-field title="Issuance TX Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="AcctgTransType"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="transferGlAccountId"><default-field title="Transfer Account"><drop-down allow-empty="true"><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0"/></drop-down></default-field></field><field name="accDepreciationGlAccountId"><default-field title="Accumulated Depr Account"><drop-down allow-empty="true"><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0"/></drop-down></default-field></field><field name="depreciationGlAccountId"><default-field title="Depreciation Account"><drop-down allow-empty="true"><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0"/></drop-down></default-field></field><field name="profitGlAccountId"><default-field title="Profit Account"><drop-down allow-empty="true"><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0"/></drop-down></default-field></field><field name="lossGlAccountId"><default-field title="Loss Account"><drop-down allow-empty="true"><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0"/></drop-down></default-field></field><field name="foundGlAccountId"><default-field title="Found Account"><drop-down allow-empty="true"><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0"/></drop-down></default-field></field><field name="shrinkageGlAccountId"><default-field title="Shrinkage Account"><drop-down allow-empty="true"><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0"/></drop-down></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog><form-list name="AllConfigList" list="allConfigList" transition="updateConfig" extends="AddConfigForm"><field name="assetTypeGlAccountId"><default-field><hidden/></default-field></field><field name="assetTypeEnumId"><default-field><ignored/></default-field></field><field name="classEnumId"><default-field><ignored/></default-field></field><field name="assetTypeDescription"><default-field title="Asset Type"><display/></default-field></field><field name="assetClassDescription"><default-field title="Asset Class"><display/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><form-list-column><field-ref name="assetTypeDescription"/><field-ref name="assetClassDescription"/></form-list-column><form-list-column><field-ref name="assetGlAccountId"/><field-ref name="receiptGlAccountId"/><field-ref name="issuanceGlAccountId"/><field-ref name="transferGlAccountId"/></form-list-column><form-list-column><field-ref name="receiptTransTypeEnumId"/><field-ref name="issuanceTransTypeEnumId"/></form-list-column><form-list-column><field-ref name="accDepreciationGlAccountId"/><field-ref name="depreciationGlAccountId"/></form-list-column><form-list-column><field-ref name="profitGlAccountId"/><field-ref name="lossGlAccountId"/></form-list-column><form-list-column><field-ref name="foundGlAccountId"/><field-ref name="shrinkageGlAccountId"/></form-list-column><form-list-column><field-ref name="submitButton"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/OrgSettings.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Org Settings" default-menu-include="false"><parameter name="partyId" required="true"/><subscreens default-item="AcctgPreference"/><actions><entity-find-one entity-name="mantle.party.PartyRole" value-field="partyRole"><field-map field-name="partyId"/><field-map field-name="roleTypeId" value="OrgInternal"/></entity-find-one></actions><widgets><section name="IsOrgInternalSection" condition="partyRole != null"><widgets><subscreens-panel id="accounting-panel" type="tab"/></widgets><fail-widgets><label text="Must be an Internal Organization for Accounting Settings"/></fail-widgets></section></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/dashboard/OrgInternalSummary.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" standalone="true"><transition name="findInvoice"><default-response url="../../Invoice/FindInvoice"/></transition><transition name="orgSettings"><default-response url="../../OrgSettings"/></transition><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition name="editPaymentMethod"><default-response url="//${appRoot}/Party/PaymentMethod/EditPaymentMethod"/></transition><transition name="paymentMethodTrans"><default-response url="//${appRoot}/Party/PaymentMethod/PaymentMethodTrans"/></transition><actions><entity-find entity-name="mantle.party.PartyDetailAndRole" list="orgInternalList"><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName,firstName,lastName"/></entity-find><set field="orgInternalIds" from="orgInternalList*.partyId"/><entity-find entity-name="mantle.account.invoice.InvoiceSummary" list="allRecInvList" use-clone="true"><econdition field-name="fromPartyId" operator="in" from="orgInternalIds"/><econdition field-name="statusId" operator="in" value="InvoiceFinalized,InvoiceSent,InvoiceAcked"/><select-field field-name="fromPartyId,invoiceCount,unpaidTotal,currencyUomId"/></entity-find><entity-find entity-name="mantle.account.invoice.InvoiceSummary" list="allPblInvList" use-clone="true"><econdition field-name="toPartyId" operator="in" from="orgInternalIds"/><econdition field-name="statusId" operator="in" value="InvoiceReceived,InvoiceApproved"/><select-field field-name="toPartyId,invoiceCount,unpaidTotal,currencyUomId"/></entity-find></actions><widgets><form-list name="OrgInternalForm" list="orgInternalList" skip-form="true"><row-actions><filter-map-list list="allRecInvList" to-list="recInvList"><field-map field-name="fromPartyId" from="partyId"/></filter-map-list><set field="recDesc" value=""/><iterate list="recInvList" entry="recInv"><if condition="recDesc"><set field="recDesc" from="recDesc + ', '"/></if><set field="recDesc" from="recDesc + recInv.invoiceCount + ' Invoice' + (recInv.invoiceCount ? 's ' : ' ') + ec.l10n.formatCurrency(recInv.unpaidTotal, recInv.currencyUomId)"/></iterate><filter-map-list list="allPblInvList" to-list="pblInvList"><field-map field-name="toPartyId" from="partyId"/></filter-map-list><set field="pblDesc" value=""/><iterate list="pblInvList" entry="pblInv"><if condition="pblDesc"><set field="pblDesc" from="pblDesc + ', '"/></if><set field="pblDesc" from="pblDesc + pblInv.invoiceCount + ' Invoice' + (pblInv.invoiceCount ? 's ' : ' ') + ec.l10n.formatCurrency(pblInv.unpaidTotal, pblInv.currencyUomId)"/></iterate><entity-find entity-name="mantle.account.method.PaymentMethod" list="paymentMethodList"><date-filter/><econdition field-name="ownerPartyId" from="partyId"/><econdition field-name="paymentMethodTypeEnumId" value="PmtBankAccount"/></entity-find></row-actions><field name="name"><default-field title="Internal Organization"><link url="editParty" text="${organizationName?:''}${firstName?:''} ${lastName?:''}" link-type="anchor"/></default-field></field><field name="recSummary"><default-field title="Receivable"><link url="findInvoice" text="${recDesc?:'None'}" link-type="anchor" parameter-map="[fromPartyId:partyId, statusId:'InvoiceFinalized,InvoiceSent,InvoiceAcked', statusId_op:'in']"/></default-field></field><field name="pblSummary"><default-field title="Payable"><link url="findInvoice" text="${pblDesc?:'None'}" link-type="anchor" parameter-map="[toPartyId:partyId, statusId:'InvoiceReceived,InvoiceApproved', statusId_op:'in']"/></default-field></field><field name="paymentMethods"><default-field title="Bank Accounts"><section-iterate name="PaymentMethodList" list="paymentMethodList" entry="paymentMethod"><widgets><container><link url="paymentMethodTrans" text="${paymentMethod.description ?: paymentMethod.paymentMethodId}${paymentMethod.ledgerBalance ? ' ' + ec.l10n.format(paymentMethod.ledgerBalance, '#,##0.00') : ''}${paymentMethod.balanceDate ? ' (' + ec.l10n.format(paymentMethod.balanceDate, 'yyyy-MM-dd') + ')' : ''}" link-type="anchor" parameter-map="[paymentMethodId:paymentMethod.paymentMethodId]"/></container></widgets></section-iterate></default-field></field><field name="settings"><default-field title=""><link url="orgSettings" text="Settings" link-type="anchor"/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/dashboard.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Dashboard" default-menu-index="1"><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition name="findInvoice"><default-response url="../Invoice/FindInvoice"/></transition><transition name="editPaymentMethod"><default-response url="//${appRoot}/Party/PaymentMethod/EditPaymentMethod"/></transition><transition name="paymentMethodTrans"><default-response url="//${appRoot}/Party/PaymentMethod/PaymentMethodTrans"/></transition><widgets><container-row><row-col md="6"><container-box><box-header title="Invoices and Payments"/><box-body><link url="../Invoice/FindInvoice" text="Invoices"/><link url="../Invoice/Aging" text="Aging##Invoice"/><link url="../Payment/FindPayment" text="Payments"/><link url="../Payment/BulkPaymentCheck" text="Bulk Checks"/><link url="../FinancialAccount/FindFinancialAccount" text="Financial Accounts"/></box-body></container-box></row-col><row-col md="6"><container-box><box-header title="General Ledger"/><box-toolbar><link url="../Reports" text="Reports"/></box-toolbar><box-body><link url="../Transaction" text="Transactions"/><link url="../Transaction/FindTransactionEntry" text="Transaction Entries"/><link url="../GlAccount" text="GL Accounts"/><link url="../FindJournal" text="GL Journals"/><link url="../TimePeriod" text="Time Periods"/><link url="../Budget" text="Budgets"/></box-body></container-box></row-col></container-row><dynamic-container id="OrgInternalSummary" transition="OrgInternalSummary"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Invoice/Aging.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" default-menu-title="Aging"><transition name="findInvoice"><default-response url="../FindInvoice"/></transition><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><actions><set field="invoiceType" from="invoiceType ?: 'Receivable'"/><if condition="'payable'.equalsIgnoreCase(invoiceType)"><then><set field="toRoleTypeId" value="OrgInternal"/></then><else-if condition="'receivable'.equalsIgnoreCase(invoiceType)"><set field="fromRoleTypeId" value="OrgInternal"/></else-if></if><set field="periodDays" from="(periodDays ?: '30') as int"/><set field="statusId" from="statusId ?: (invoiceType == 'Payable' ? 'InvoiceReceived,InvoiceApproved' : 'InvoiceFinalized,InvoiceSent,InvoiceAcked')"/><set field="statusId_op" value="in"/><set field="dbConfName" from="ec.entity.getDatabaseConfName('mantle.account.invoice.Invoice')"/></actions><widgets><form-single name="ReportOptions" transition="."><field name="invoiceType"><default-field title="AR/AP"><radio><option key="Receivable"/><option key="Payable"/></radio></default-field></field><field name="periodDays"><default-field><text-line size="2"/></default-field></field><field name="dateField"><default-field title="Age By##Invoice"><drop-down><option key="DUE_DATE" text="Due Date"/><option key="INVOICE_DATE" text="Invoice Date"/></drop-down></default-field></field><field name="submitButton"><default-field><submit text="Run Report"/></default-field></field><field-layout><field-row-big><field-ref name="invoiceType"/><field-ref name="periodDays"/><field-ref name="dateField"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single><label text="NOTE: For invoices with no Due Date specified try running the report by Invoice Date."/><form-list name="InvoiceAgingList" list="invoiceAgingList" skip-form="true" header-dialog="true" saved-finds="true" show-all-button="true" show-csv-button="true" show-xlsx-button="true"><entity-find entity-name="mantle.account.invoice.InvoiceAgingSummary" list="invoiceAgingList"><search-form-inputs default-order-by="-totalDue" skip-fields="fromRoleTypeId,toRoleTypeId"/><econdition field-name="fromRoleTypeId" ignore-if-empty="true"/><econdition field-name="toRoleTypeId" ignore-if-empty="true"/></entity-find><field name="invoiceType"><header-field><radio><option key="Receivable"/><option key="Payable"/></radio></header-field></field><field name="periodDays"><header-field><text-line size="6"/></header-field></field><field name="dateField"><header-field title="Find By"><drop-down><option key="DUE_DATE" text="Due Date"/><option key="INVOICE_DATE" text="Invoice Date"/></drop-down></header-field></field><field name="referenceNumber"><header-field title="Their Invoice"><text-find/></header-field></field><field name="otherPartyOrderId"><header-field title="Their Order"><text-find/></header-field></field><field name="invoiceCount"><header-field title="Invoices" show-order-by="true"><range-find size="4"/></header-field><default-field><link url="findInvoice" text="${invoiceCount ? (invoiceCount + ' invoice' + (invoiceCount > 1 ? 's' : '')) : ''}" link-type="anchor" parameter-map="[fromPartyId:fromPartyId, toPartyId:toPartyId, statusId:statusId]"/></default-field></field><field name="fromPartyId"><header-field title="From"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></header-field><default-field><link url="editParty" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" link-type="anchor" parameter-map="[partyId:fromPartyId]"/></default-field></field><field name="toPartyId"><header-field title="To"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></header-field><default-field><link url="editParty" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" link-type="anchor" parameter-map="[partyId:toPartyId]"/></default-field></field><field name="statusId"><header-field title="Status" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="Invoice"/><set field="allowMultiple" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="currentDue" align="right" show-total="true"><header-field title="Current" show-order-by="true"/><default-field><display currency-unit-field="currencyUomId"/></default-field></field><field name="period1" align="right" show-total="true"><header-field title="0 - ${periodDays} days" show-order-by="true"/><default-field><display currency-unit-field="currencyUomId"/></default-field></field><field name="period2" align="right" show-total="true"><header-field title="${periodDays+1} - ${periodDays*2} days" show-order-by="true"/><default-field><display currency-unit-field="currencyUomId"/></default-field></field><field name="period3" align="right" show-total="true"><header-field title="${periodDays*2+1} - ${periodDays*3} days" show-order-by="true"/><default-field><display currency-unit-field="currencyUomId"/></default-field></field><field name="period4" align="right" show-total="true"><header-field title="${periodDays*3+1} - ${periodDays*4} days" show-order-by="true"/><default-field><display currency-unit-field="currencyUomId"/></default-field></field><field name="periodRemaining" align="right" show-total="true"><header-field title="> ${periodDays*4} days" show-order-by="true"/><default-field><display currency-unit-field="currencyUomId"/></default-field></field><field name="totalDue" align="right" show-total="true"><header-field title="Total" show-order-by="true"/><default-field><display currency-unit-field="currencyUomId"/></default-field></field><field name="findButton"><header-field title="Find"><submit/></header-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Invoice/FindInvoice.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="editInvoice"><default-response url="../EditInvoice"/></transition><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition name="createInvoice"><service-call name="mantle.account.InvoiceServices.create#Invoice" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditInvoice"/></transition><transition name="createProjectInvoiceItems"><service-call name="mantle.account.InvoiceServices.create#ProjectInvoiceItems" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createWorkerInvoiceItems"><service-call name="mantle.account.InvoiceServices.create#WorkerInvoiceItems" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getProjectList" location="component://SimpleScreens/template/work/WorkTransitions.xml"/><transition-include name="getOpenClientInvoicesByProject" location="component://SimpleScreens/template/work/WorkTransitions.xml"/><transition-include name="getOpenVendorInvoicesByFromParty" location="component://SimpleScreens/template/work/WorkTransitions.xml"/><transition-include name="getProjectParties" location="component://SimpleScreens/template/work/WorkTransitions.xml"/><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition name="receivableStatement"><default-response url="${ec.web.getWebappRootUrl(false, null)}/fop/apps/${appRoot}/Accounting/Invoice/ReceivableStatement" url-type="plain"><parameter name="renderMode" value="xsl-fo"/><parameter name="pageNoLimit" value="true"/><parameter name="toPartyId"/><parameter name="fromPartyId"/><parameter name="periodDays"/><parameter name="asOfDate"/><parameter name="filename" value="Statement-${toPartyId}-${asOfDate ?: ec.l10n.format(ec.user.nowTimestamp, 'yyyy-MM-dd')}.pdf"/></default-response></transition><actions><if condition="!invoiceType"><set field="invoiceType" value="Any"/></if><if condition="'payable'.equalsIgnoreCase(invoiceType)"><then><set field="toRoleTypeId" value="OrgInternal"/></then><else-if condition="'receivable'.equalsIgnoreCase(invoiceType)"><set field="fromRoleTypeId" value="OrgInternal"/></else-if></if><set field="periodDays" from="periodDays ? periodDays as Integer : 30"/><set field="periodDaysBd" from="new BigDecimal(periodDays)"/><set field="nowTimestamp" from="ec.user.nowTimestamp"/><set field="hasReceivableAging" from="new java.util.concurrent.atomic.AtomicBoolean(false)"/><set field="hasPayableAging" from="new java.util.concurrent.atomic.AtomicBoolean(false)"/><set field="receivableAgingList" from="new ArrayList([0.0, 0.0, 0.0, 0.0, 0.0])"/><set field="receivableDueAgingList" from="new ArrayList([0.0, 0.0, 0.0, 0.0, 0.0, 0.0])"/><set field="payableAgingList" from="new ArrayList([0.0, 0.0, 0.0, 0.0, 0.0])"/><set field="payableDueAgingList" from="new ArrayList([0.0, 0.0, 0.0, 0.0, 0.0, 0.0])"/></actions><widgets><container-dialog id="NewPayableDialog" button-text="New Payable"><form-single name="NewPayableForm" transition="createInvoice"><field name="fromPartyId"><default-field title="From Supplier"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="toPartyId"><default-field title="To Organization"><drop-down><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="partyId" from="activeOrgId" ignore="!activeOrgId"/><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></default-field></field><field name="invoiceTypeEnumId"><default-field title="Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="InvoiceType"/><set field="noCurrentSelectedKey" value="InvoiceSales"/></widget-template-include></default-field></field><field name="referenceNumber"><default-field tooltip="Other party invoice reference number"><text-line size="20"/></default-field></field><field name="invoiceDate" from="ec.user.nowTimestamp"><default-field><date-time/></default-field></field><field name="submitButton"><default-field title="Create Invoice"><submit/></default-field></field></form-single></container-dialog><container-dialog id="NewReceivableDialog" button-text="New Receivable"><form-single name="NewReceivableForm" transition="createInvoice" extends="NewPayableForm"><field name="fromPartyId"><default-field title="From Organization"><drop-down><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="partyId" from="activeOrgId" ignore="!activeOrgId"/><econdition field-name="roleTypeId" operator="in" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></default-field></field><field name="toPartyId"><default-field title="To Customer"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></default-field></field></form-single></container-dialog><container-dialog id="NewCustCreditDialog" button-text="Customer Credit Memo"><label text="A Customer Credit Memo is a Payable Invoice that may be applied to one or more Receivable Invoices" type="p"/><form-single name="NewCustCreditForm" transition="createInvoice" extends="NewPayableForm"><field name="fromPartyId"><default-field title="From Customer"/></field><field name="invoiceTypeEnumId" from="'InvoiceCreditMemo'"><default-field><hidden/></default-field></field></form-single></container-dialog><container-dialog id="NewSupCreditDialog" button-text="Supplier Credit Memo"><label text="A Supplier Credit Memo is a Receivable Invoice that may be applied to one or more Payable Invoices" type="p"/><form-single name="NewSupCreditForm" transition="createInvoice" extends="NewReceivableForm"><field name="toPartyId"><default-field title="To Supplier"/></field><field name="invoiceTypeEnumId" from="'InvoiceCreditMemo'"><default-field><hidden/></default-field></field></form-single></container-dialog><section name="ProjectInvoiceSection"><widgets><container-dialog id="ProjectInvoiceDialog" button-text="Project Client Invoice" width="700"><form-single name="ProjectInvoice" transition="createProjectInvoiceItems"><field name="workEffortId"><default-field title="Project"><drop-down><dynamic-options transition="getProjectList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="thruDate"><default-field><date-time type="date-time"/></default-field></field><field name="invoiceId"><default-field title="Existing Invoice" tooltip="If no existing invoice selected a new one will be created for Project Vendor and Customer parties"><drop-down allow-empty="true"><dynamic-options transition="getOpenClientInvoicesByProject" value-field="invoiceId" label-field="label" server-search="true" min-length="0"><depends-on field="workEffortId"/></dynamic-options></drop-down></default-field></field><field name="entryGrouping"><default-field title="Grouping"><drop-down no-current-selected-key="worker"><option key="entry" text="Item Per Time Entry"/><option key="worker" text="Item Per Worker"/><option key="all" text="Single Invoice Item"/></drop-down></default-field></field><field name="submitButton"><default-field title="Invoice Time and Expenses"><submit/></default-field></field></form-single></container-dialog><container-dialog id="ProjectWorkerInvoiceDialog" button-text="Project Worker Invoice" width="700"><form-single name="ProjectWorkerInvoice" transition="createProjectInvoiceItems"><field name="ratePurposeEnumId"><default-field><hidden default-value="RaprVendor"/></default-field></field><field name="workEffortId"><default-field title="Project"><drop-down><dynamic-options transition="getProjectList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="workerPartyId"><default-field title="Worker" tooltip=""><drop-down allow-empty="true"><dynamic-options transition="getProjectParties" value-field="partyId" label-field="name" server-search="true" min-length="0"><depends-on field="workEffortId"/></dynamic-options></drop-down></default-field></field><field name="thruDate"><default-field><date-time type="date-time"/></default-field></field><field name="invoiceId"><default-field title="Existing Invoice" tooltip="If no existing invoice selected a new one will be created for Project Vendor and Worker parties"><drop-down allow-empty="true"><dynamic-options transition="getOpenVendorInvoicesByFromParty" value-field="invoiceId" label-field="label" server-search="true" min-length="0"><depends-on field="workerPartyId"/></dynamic-options></drop-down></default-field></field><field name="submitButton"><default-field title="Invoice Time"><submit/></default-field></field></form-single></container-dialog></widgets></section><container-dialog id="WorkerInvoiceDialog" button-text="Worker Invoice" width="700"><form-single name="WorkerInvoice" transition="createWorkerInvoiceItems"><field name="ratePurposeEnumId"><default-field><hidden default-value="RaprVendor"/></default-field></field><field name="vendorPartyId"><default-field title="Employer"><drop-down><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="partyId" from="activeOrgId" ignore="!activeOrgId"/><econdition field-name="roleTypeId" operator="in" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></default-field></field><field name="workerPartyId"><default-field title="Worker"><drop-down><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="thruDate"><default-field><date-time type="date-time"/></default-field></field><field name="invoiceId"><default-field title="Existing Invoice"><drop-down allow-empty="true"><dynamic-options transition="getOpenVendorInvoicesByFromParty" value-field="invoiceId" label-field="label" server-search="true" min-length="0"><depends-on field="workerPartyId"/></dynamic-options></drop-down></default-field></field><field name="submitButton"><default-field title="Invoice Time"><submit/></default-field></field></form-single></container-dialog><container-dialog id="CustomerStatementDialog" button-text="Customer Statement PDF"><form-single name="CustomerStatementForm" transition="receivableStatement"><field name="fromPartyId"><default-field title="Organization"><drop-down allow-empty="true"><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="partyId" from="activeOrgId" ignore="!activeOrgId"/><econdition field-name="roleTypeId" operator="in" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></default-field></field><field name="toPartyId"><default-field title="Customer"><drop-down><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="asOfDate" from="ec.user.nowTimestamp"><default-field><date-time type="date"/></default-field></field><field name="submitButton"><default-field title="Download PDF"><submit/></default-field></field></form-single></container-dialog><form-list name="InvoiceList" list="invoiceList" skip-form="true" header-dialog="true" select-columns="true" saved-finds="true" show-csv-button="true" show-xlsx-button="true" show-all-button="true"><entity-find entity-name="mantle.account.invoice.InvoiceFindView" list="invoiceList" use-clone="true"><search-form-inputs default-order-by="invoiceDate,invoiceId" skip-fields="fromRoleTypeId,toRoleTypeId"><default-parameters statusId="InvoiceInProcess,InvoiceFinalized,InvoiceSent,InvoiceAcked,InvoiceIncoming,InvoiceReceived,InvoiceApproved" statusId_op="in" invoiceDate_poffset="-3" invoiceDate_period="30d"/></search-form-inputs><econdition field-name="fromRoleTypeId" ignore-if-empty="true"/><econdition field-name="toRoleTypeId" ignore-if-empty="true"/><select-field field-name="currencyUomId"/></entity-find><row-actions><script><![CDATA[if (unpaidTotal) {
                    Integer invoiceDateDays = invoiceDate != null ? nowTimestamp - invoiceDate : null
                    Integer invoiceDateIdx = invoiceDateDays != null ? ((invoiceDateDays as BigDecimal) / periodDaysBd).setScale(0, BigDecimal.ROUND_DOWN).intValue() : null
                    if (invoiceDateIdx != null && invoiceDateIdx > 4) invoiceDateIdx = 4
                    Integer dueDateDays = dueDate != null ? nowTimestamp - dueDate : null
                    Integer dueDateIdx = dueDateDays != null ? (dueDateDays < 0 ? 0 :
                            ((dueDateDays as BigDecimal) / periodDaysBd).setScale(0, BigDecimal.ROUND_DOWN).intValue() + 1) : null
                    if (dueDateIdx != null && dueDateIdx > 5) dueDateIdx = 5

                    if (statusId in ['InvoiceInProcess','InvoiceFinalized','InvoiceSent','InvoiceAcked']) {
                        if (invoiceDateIdx != null) receivableAgingList[invoiceDateIdx] = receivableAgingList[invoiceDateIdx] + unpaidTotal
                        if (dueDateIdx != null) receivableDueAgingList[dueDateIdx] = receivableDueAgingList[dueDateIdx] + unpaidTotal
                        hasReceivableAging.set(true)
                    } else if (statusId in ['InvoiceIncoming','InvoiceReceived','InvoiceApproved']) {
                        if (invoiceDateIdx != null) payableAgingList[invoiceDateIdx] = payableAgingList[invoiceDateIdx] + unpaidTotal
                        if (dueDateIdx != null) payableDueAgingList[dueDateIdx] = payableDueAgingList[dueDateIdx] + unpaidTotal
                        hasPayableAging.set(true)
                    }
                }]]></script></row-actions><field name="invoiceType"><header-field><radio no-current-selected-key="Any"><option key="Any"/><option key="Receivable"/><option key="Payable"/></radio></header-field></field><field name="invoiceId"><header-field show-order-by="true" title="Invoice"><text-find hide-options="ignore-case" default-operator="begins"/></header-field><default-field><link url="editInvoice" text="${invoiceId}" link-type="anchor"/></default-field></field><field name="invoiceTypeEnumId"><header-field title="Type" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="InvoiceType"/><set field="allowEmpty" value="true"/><set field="allowMultiple" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="referenceNumber"><header-field title="Their Invoice"><text-find size="20" default-operator="begins"/></header-field><default-field><display/></default-field></field><field name="otherPartyOrderId"><header-field title="Their Order"><text-find size="20" default-operator="begins"/></header-field><default-field><display/></default-field></field><field name="invoiceDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display format="yyyy-MM-dd"/></default-field></field><field name="dueDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display format="yyyy-MM-dd"/></default-field></field><field name="receivableStatuses"><header-field title="Receivable"><display text="In-Process, Finalized, Sent, Acknowledged, Payment Received"/></header-field></field><field name="payableStatuses"><header-field title="Payable"><display text="Incoming, Received, Approved, Payment Sent"/></header-field></field><field name="statusId"><header-field title="Status" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="Invoice"/><set field="allowMultiple" value="true"/><set field="showNot" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="fromPartyId"><header-field title="From"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></header-field><default-field><link url="editParty" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" link-type="anchor" parameter-map="[partyId:fromPartyId]"/></default-field></field><field name="productStoreId"><header-field title="Store"><drop-down allow-empty="true"><entity-options key="${productStoreId}" text="${productStoreId}: ${storeName}"><entity-find entity-name="mantle.product.store.ProductStore"><order-by field-name="storeName"/></entity-find></entity-options></drop-down></header-field><default-field><display-entity entity-name="mantle.product.store.ProductStore" text="${productStoreId}: ${storeName}"/></default-field></field><field name="toPartyId"><header-field title="To"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></header-field><default-field><link url="editParty" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" link-type="anchor" parameter-map="[partyId:toPartyId]"/></default-field></field><field name="invoiceTotal" align="right" show-total="true"><header-field title="Total" show-order-by="true"><range-find/></header-field><default-field><display currency-unit-field="currencyUomId"/></default-field></field><field name="unpaidTotal" align="right" show-total="true"><header-field title="Unpaid" show-order-by="true"><range-find/></header-field><default-field><display currency-unit-field="currencyUomId"/></default-field></field><field name="findButton"><header-field title="Find"><submit/></header-field></field><form-list-column><field-ref name="invoiceId"/><field-ref name="invoiceTypeEnumId"/></form-list-column><form-list-column><field-ref name="invoiceDate"/><field-ref name="dueDate"/></form-list-column><form-list-column><field-ref name="referenceNumber"/><field-ref name="otherPartyOrderId"/></form-list-column><form-list-column><field-ref name="statusId"/></form-list-column><form-list-column><field-ref name="fromPartyId"/><field-ref name="productStoreId"/></form-list-column><form-list-column><field-ref name="toPartyId"/></form-list-column><form-list-column><field-ref name="invoiceTotal"/></form-list-column><form-list-column><field-ref name="unpaidTotal"/></form-list-column></form-list><section name="AgingSummarySection" condition="hasReceivableAging.get() || hasPayableAging.get()"><actions><script><![CDATA[agingSummaryList = []
                if (hasReceivableAging.get()) {
                    agingSummaryList.add([description:'Receivable by Invoice Date', period0:receivableAgingList[0], period1:receivableAgingList[1],
                            period2:receivableAgingList[2], period3:receivableAgingList[3], periodRemaining:receivableAgingList[4], total:receivableAgingList.sum()])
                    agingSummaryList.add([description:'Receivable by Due Date', current:receivableDueAgingList[0], period0:receivableDueAgingList[1],
                            period1:receivableDueAgingList[2], period2:receivableDueAgingList[3], period3:receivableDueAgingList[4],
                            periodRemaining:receivableDueAgingList[5], total:receivableDueAgingList.sum()])
                }
                if (hasPayableAging.get()) {
                    agingSummaryList.add([description:'Payable by Invoice Date', period0:payableAgingList[0], period1:payableAgingList[1],
                            period2:payableAgingList[2], period3:payableAgingList[3], periodRemaining:payableAgingList[4], total:payableAgingList.sum()])
                    agingSummaryList.add([description:'Payable by Due Date', current:payableDueAgingList[0], period0:payableDueAgingList[1],
                            period1:payableDueAgingList[2], period2:payableDueAgingList[3], period3:payableDueAgingList[4],
                            periodRemaining:payableDueAgingList[5], total:payableDueAgingList.sum()])
                }]]></script></actions><widgets><form-list name="AgingSummaryList" list="agingSummaryList" skip-form="true"><field name="description"><default-field title="Aging Summary (displayed records only)"><display text="${ec.l10n.localize(description)}"/></default-field></field><field name="current" align="right"><default-field><display currency-unit-field="currencyUomId"/></default-field></field><field name="period0" align="right"><header-field title="0 - ${periodDays} days"/><default-field><display currency-unit-field="currencyUomId"/></default-field></field><field name="period1" align="right"><header-field title="${periodDays+1} - ${periodDays*2} days"/><default-field><display currency-unit-field="currencyUomId"/></default-field></field><field name="period2" align="right"><header-field title="${periodDays*2+1} - ${periodDays*3} days"/><default-field><display currency-unit-field="currencyUomId"/></default-field></field><field name="period3" align="right"><header-field title="${periodDays*3+1} - ${periodDays*4} days"/><default-field><display currency-unit-field="currencyUomId"/></default-field></field><field name="periodRemaining" align="right"><header-field title="> ${periodDays*4} days"/><default-field><display currency-unit-field="currencyUomId"/></default-field></field><field name="total" align="right"><default-field><display currency-unit-field="currencyUomId"/></default-field></field></form-list></widgets></section></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Invoice/PrintInvoice.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="invoiceId" required="true"/><actions><service-call name="mantle.account.InvoiceServices.get#InvoicePrintInfo" in-map="[invoiceId:invoiceId]" out-map="context"/><if condition="!templateLocation"><set field="templateLocation" value="component://SimpleScreens/template/account/Invoice.xsl-fo.ftl"/></if></actions><widgets><render-mode><text type="xsl-fo" location="${templateLocation}" template="true" encode="false" no-boundary-comment="true"/></render-mode></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Invoice/ReceivableStatement.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="toPartyId" required="true"/><parameter name="fromPartyId"/><parameter name="periodDays"/><parameter name="asOfDate"/><actions><service-call name="mantle.account.InvoiceServices.get#ReceivableStatementInfo" in-map="context" out-map="context"/></actions><widgets><render-mode><text type="xsl-fo" location="component://SimpleScreens/template/account/ReceivableStatement.xsl-fo.ftl" template="true" encode="false" no-boundary-comment="true"/></render-mode></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Invoice/EditInvoice.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Invoice" default-menu-index="1"><parameter name="invoiceId" required="true"/><transition name="editPayment"><default-response url="../../Payment/EditPayment"/></transition><transition name="editTransaction"><default-response url="../../Transaction/EditTransaction"/></transition><transition name="editTimePeriod"><default-response url="../../TimePeriod/EditTimePeriod"/></transition><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition name="orderDetail"><default-response url="//${appRoot}/Order/OrderDetail"/></transition><transition name="shipmentDetail"><default-response url="//${appRoot}/Shipment/ShipmentDetail"/></transition><transition name="editReturn"><default-response url="//${appRoot}/Return/EditReturn"/></transition><transition name="updateInvoice"><service-call name="mantle.account.InvoiceServices.update#Invoice" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateInvoiceClosed"><service-call name="mantle.account.InvoiceServices.update#InvoiceClosed" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateStatus"><service-call name="update#mantle.account.invoice.Invoice" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="reverseInvoice"><service-call name="mantle.account.InvoiceServices.reverse#Invoice" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="cancelInvoiceAndPayments"><service-call name="mantle.account.InvoiceServices.cancel#InvoiceAndPayments" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="adjustInvoice"><service-call name="mantle.account.InvoiceServices.adjust#Invoice" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="postInvoice"><service-call name="mantle.ledger.InvoiceAutoPostServices.post#Invoice" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="repostInvoice"><service-call name="mantle.ledger.InvoiceAutoPostServices.repost#Invoice" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getGlAccountListPaginated" location="component://SimpleScreens/template/account/AccountTransitions.xml"/><transition-include name="getItemTypeGlAccount" location="component://SimpleScreens/template/account/AccountTransitions.xml"/><transition name="createCreditMemo"><service-call name="mantle.account.InvoiceServices.create#InvoiceCreditMemo" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="recordPayment"><service-call name="mantle.account.PaymentServices.create#InvoicePayment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="sendPromisedPayment"><service-call name="mantle.account.PaymentServices.send#PromisedPayment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="applyInvoicePayment"><service-call name="mantle.account.PaymentServices.apply#InvoicePayment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="applyInvoiceToInvoice"><service-call name="mantle.account.PaymentServices.apply#InvoiceToInvoice" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="unapplyPaymentApplication"><service-call name="mantle.account.PaymentServices.unapply#PaymentApplication" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="sendInvoiceStoreEmail"><service-call name="mantle.account.InvoiceServices.send#InvoiceStoreEmail" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="sendCustomerPastDueEmail"><service-call name="mantle.account.InvoiceServices.send#CustomerPastDueEmail" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="sendEmailMessage"><service-call name="org.moqui.impl.EmailServices.send#EmailMessage" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createContent"><service-call name="mantle.account.InvoiceServices.create#InvoiceContent" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateContent"><service-call name="mantle.account.InvoiceServices.update#InvoiceContent" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="downloadContent" read-only="true"><parameter name="invoiceContentId"/><actions><entity-find-one entity-name="mantle.account.invoice.InvoiceContent" value-field="invoiceContent"/><script><![CDATA[ec.web.sendResourceResponse(invoiceContent.contentLocation)]]></script></actions><default-response type="none"/></transition><transition name="EmailMessage" read-only="true"><parameter name="emailMessageId"/><actions><entity-find-one entity-name="moqui.basic.email.EmailMessage" value-field="emailMessage"/><script><![CDATA[ec.web.sendTextResponse(emailMessage?.body, "text/html", null)]]></script></actions><default-response type="none"/></transition><transition name="Invoice.pdf"><default-response url="${ec.web.getWebappRootUrl(false, null)}/fop/apps/${appRoot}/Accounting/Invoice/PrintInvoice" url-type="plain"><parameter name="invoiceId"/><parameter name="original"/><parameter name="filename" value="Invoice${original == 'true' ? 'Original' : 'Current'}-${invoiceId}.pdf"/></default-response></transition><actions><service-call name="mantle.account.InvoiceServices.get#InvoiceDisplayInfo" in-map="[invoiceId:invoiceId]" out-map="context"/><if condition="invoice == null"><return error="true" message="Invoice ${invoiceId} not found"/></if><set field="statusId" from="invoice?.statusId"/><entity-find-one entity-name="mantle.party.PartyDetail" value-field="organizationParty"><field-map field-name="partyId" from="organizationPartyId"/></entity-find-one><entity-find entity-name="moqui.service.message.SystemMessage" list="outSystemMessageList"><econdition field-name="invoiceId"/><econdition field-name="isOutgoing" value="Y"/><econdition field-name="statusId" operator="not-equals" value="SmsgCancelled"/></entity-find></actions><widgets><container-row><row-col lg="6"><container><section name="AdjustSection" condition="statusId in ['InvoiceFinalized', 'InvoiceSent', 'InvoiceAcked', 'InvoiceApproved']"><widgets><container-dialog id="AdjustDialog" button-text="Adjust Invoice"><form-single name="AdjustInvoice" transition="adjustInvoice"><field name="invoiceId"><default-field><hidden/></default-field></field><field name="itemTypeEnumId"><default-field title="Item Type"><drop-down><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.EnumAndGroup"><econdition field-name="enumGroupEnumId" value="EngItemsAdjust"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="itemDate" from="invoice.invoiceDate"><default-field title="Adjustment Item Date"><date-time/></default-field></field><field name="description"><default-field><text-line size="40"/></default-field></field><field name="amount"><default-field tooltip="May be positive or negative to add to or subtract from invoice total"><text-line size="10"/></default-field></field><field name="parentInvoiceItemSeqId"><default-field title="Adjust Item"><drop-down allow-empty="true"><entity-options key="${invoiceItemSeqId}" text="${invoiceItemSeqId} ${itemTypeDescription?:''} ${description?:''}"><entity-find entity-name="mantle.account.invoice.InvoiceItemAndType"><econdition field-name="invoiceId"/></entity-find></entity-options></drop-down></default-field></field><field name="productId"><default-field title="Product"><drop-down allow-empty="true"><dynamic-options transition="getProductList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="typeGlAccount"><default-field title="Default GL Account"><display dynamic-transition="getItemTypeGlAccount" also-hidden="false" depends-optional="true" parameter-map="[organizationPartyId:organizationPartyId, direction:(isPayableInvoice ? 'I' : 'O')]"><depends-on field="itemTypeEnumId"/><depends-on field="productId"/></display></default-field></field><field name="overrideGlAccountId"><default-field title="Override GL Account"><drop-down allow-empty="true"><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0"/></drop-down></default-field></field><field name="submitButton"><default-field title="Add Adjustment Item"><submit/></default-field></field></form-single></container-dialog></widgets></section><link url="Invoice.pdf" text="Current PDF" link-type="anchor-button"><parameter name="invoiceId"/></link><link url="Invoice.pdf" text="Original PDF" link-type="anchor-button"><parameter name="invoiceId"/><parameter name="original" value="true"/></link><section-iterate name="OrderLinks" list="orderIdSet" entry="orderId"><widgets><link url="orderDetail" text="Order ${orderId}" link-type="anchor-button"/></widgets></section-iterate><section-iterate name="ShipmentLinks" list="shipmentIdSet" entry="shipmentId"><widgets><link url="shipmentDetail" text="Shipment ${shipmentId}" link-type="anchor-button"/></widgets></section-iterate><section-iterate name="ReturnLinks" list="returnIdSet" entry="returnId"><widgets><link url="editReturn" text="Return ${returnId}" link-type="anchor-button"/></widgets></section-iterate><link url="updateStatus" text="Uncancel" parameter-map="[invoiceId:invoiceId, statusId:'InvoiceInProcess']" condition="statusId == 'InvoiceCancelled' && !isPayableInvoice" confirmation="Go back to In Process status?"/><link url="updateStatus" text="Uncancel" parameter-map="[invoiceId:invoiceId, statusId:'InvoiceReceived']" condition="statusId == 'InvoiceCancelled' && isPayableInvoice" confirmation="Go back to Received status?"/><link url="cancelInvoiceAndPayments" text="Cancel Invoice and Payments" btn-type="warning" confirmation="Cancel this invoice and all payments applied to it?" condition="statusId != 'InvoiceCancelled'"/><link url="reverseInvoice" text="Reverse Invoice" btn-type="warning" condition="invoice.invoiceTotal < 0.0"/><section name="OutMessageSection" condition="outSystemMessageList"><widgets><container-dialog id="OutMessageDialog" button-text="Invoice Message History" width="800"><form-list name="OutSystemMessageList" list="outSystemMessageList" skip-form="true"><field name="systemMessageId"><default-field title="Message ID"><display/></default-field></field><field name="systemMessageTypeId"><default-field title="Type"><display-entity entity-name="moqui.service.message.SystemMessageType"/></default-field></field><field name="systemMessageRemoteId"><default-field title="Remote"><display-entity entity-name="moqui.service.message.SystemMessageRemote"/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="initDate"><default-field><display/></default-field></field><field name="docType"><default-field><display/></default-field></field><field name="docSubType"><default-field><display/></default-field></field><field name="ackMessageId"><default-field><display/></default-field></field></form-list></container-dialog></widgets></section><container-dialog id="AuditLogDialog" button-text="Audit Log" width="960"><form-list name="AuditLogList" list="auditLogList" skip-form="true"><entity-find entity-name="moqui.entity.EntityAuditLog" list="auditLogList"><econdition field-name="changedEntityName" operator="in" from="['mantle.account.invoice.Invoice', 'mantle.account.invoice.InvoiceItem']"/><econdition field-name="changedFieldName" operator="not-equals" value="statusId"/><econdition field-name="pkPrimaryValue" from="invoiceId"/><select-field field-name="changedEntityName"/><order-by field-name="-changedDate,pkSecondaryValue"/></entity-find><field name="changedDate"><default-field title="Date"><display/></default-field></field><field name="changedByUserId"><default-field title="User"><display-entity text="UsernameTemplate" entity-name="mantle.party.PersonWithUserAccount" key-field-name="userId"/></default-field></field><field name="pkSecondaryValue"><default-field title="Item"><display/></default-field></field><field name="changedFieldName"><default-field title="Field"><display text="${org.moqui.util.StringUtilities.camelCaseToPretty(changedFieldName)}"/></default-field></field><field name="oldValueText"><default-field title="From"><display text="${ec.entity.formatFieldString(changedEntityName, changedFieldName, oldValueText)}"/></default-field></field><field name="newValueText"><default-field title="To"><display text="${ec.entity.formatFieldString(changedEntityName, changedFieldName, newValueText)}"/></default-field></field></form-list></container-dialog></container><form-single name="EditInvoice" transition="${invoiceEditable ? 'updateInvoice' : 'updateInvoiceClosed'}" map="invoice"><field name="invoiceId"><default-field><display/></default-field></field><field name="fromPartyId"><default-field title="From"><link url="editParty" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" link-type="anchor" parameter-map="[partyId:fromPartyId]"/></default-field></field><field name="toPartyId"><default-field title="To"><link url="editParty" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" link-type="anchor" parameter-map="[partyId:toPartyId]"/></default-field></field><field name="invoiceTypeEnumId"><conditional-field title="Type" condition="invoiceEditable"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="InvoiceType"/></widget-template-include></conditional-field><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="productStoreId"><conditional-field title="Store" condition="invoiceEditable"><drop-down allow-empty="true"><entity-options key="${productStoreId}" text="${productStoreId}: ${storeName}"><entity-find entity-name="mantle.product.store.ProductStore"><order-by field-name="storeName"/></entity-find></entity-options></drop-down></conditional-field><conditional-field title="Store" condition="invoice.productStoreId"><display-entity entity-name="mantle.product.store.ProductStore" text="${productStoreId}: ${storeName}"/></conditional-field><default-field><ignored/></default-field></field><field name="timePeriodId"><conditional-field condition="invoice.timePeriodId" title="Time Period"><link url="editTimePeriod" text="TimePeriodNameTemplate" link-type="anchor" entity-name="mantle.party.time.TimePeriod" parameter-map="[timePeriodId:invoice.timePeriodId]"/></conditional-field><default-field><ignored/></default-field></field><field name="referenceNumber"><default-field title="Their Invoice" tooltip="Other party invoice or other reference number"><text-line size="40"/></default-field></field><field name="otherPartyOrderId"><default-field title="Their Order" tooltip="Other party purchase or sales order ID"><text-line size="40"/></default-field></field><field name="dupWarning"><conditional-field title="" condition="dupInvoiceList"><label text="Found invoice(s) with same Reference Number: ${dupInvoiceList.invoiceId}" style="text-danger"/></conditional-field><default-field><ignored/></default-field></field><field name="invoiceDate"><conditional-field condition="invoiceEditable"><date-time/></conditional-field><default-field title="Date"><display also-hidden="false"/></default-field></field><field name="invoiceTotal"><default-field title="Total"><display currency-unit-field="invoice.currencyUomId"/></default-field></field><field name="dueDate"><default-field><date-time type="date"/></default-field></field><field name="settlementTermId"><default-field title="Settlement Term"><drop-down allow-empty="true"><entity-options key="${settlementTermId}" text="${description}"><entity-find entity-name="mantle.account.invoice.SettlementTerm"><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="description"><default-field><text-line size="60"/></default-field></field><field name="invoiceMessage"><default-field><text-area cols="60" rows="3"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field-layout><field-row><field-ref name="invoiceId"/><field-ref name="invoiceTypeEnumId"/></field-row><field-row><field-ref name="invoiceDate"/><field-ref name="invoiceTotal"/></field-row><fields-not-referenced/></field-layout></form-single><section name="ContentSection"><actions><entity-find entity-name="mantle.account.invoice.InvoiceContent" list="contentList"><econdition field-name="invoiceId"/><order-by field-name="-contentDate"/></entity-find></actions><widgets><container-box><box-header title="Content"/><box-toolbar><container-dialog id="NewContentDialog" button-text="Add Content"><form-single name="NewContentForm" transition="createContent"><field name="invoiceId"><default-field><hidden/></default-field></field><field name="contentTypeEnumId"><default-field title="Content Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="InvoiceContentType"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="contentFile"><default-field><file/></default-field></field><field name="description"><default-field><text-line size="60"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><section-iterate name="ContentIterateSection" list="contentList" entry="content"><actions><entity-find-one entity-name="mantle.party.PersonWithUserAccount" value-field="paua"><field-map field-name="userId" from="content.userId"/></entity-find-one><entity-find-one entity-name="moqui.basic.Enumeration" value-field="contentTypeEnum"><field-map field-name="enumId" from="content.contentTypeEnumId"/></entity-find-one></actions><widgets><container><container><label text="${contentTypeEnum?.description?:'No Type'}" type="strong"/></container><link url="downloadContent" condition="content.contentLocation" parameter-map="[invoiceContentId:content.invoiceContentId]" text="Download ${content.contentLocation.substring(content.contentLocation.lastIndexOf('/')+1)}"/><container-dialog id="UpdateContentContainer" button-text="Edit Content"><form-single name="UpdateContentForm" transition="updateContent" map="content"><field name="invoiceContentId"><default-field><hidden/></default-field></field><field name="invoiceId"><default-field><hidden/></default-field></field><field name="contentTypeEnumId"><default-field title="Content Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="InvoiceContentType"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="contentFile"><default-field><file/></default-field></field><field name="description"><default-field><text-line size="60"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></container-dialog><container><label text="By ${ec.resource.expand('UsernameTemplate','',paua+[userId:content.userId])} at ${ec.l10n.format(content.contentDate, 'yyyy-MM-dd HH:mm')}" condition="paua"/></container><label text="${content.description ?: 'No Description'}" type="p"/></container></widgets></section-iterate></box-body></container-box></widgets></section><section name="EmailMessageSection"><widgets><container-box><box-header title="Email Messages"/><box-toolbar><section name="SendFinalizedEmailSection" condition="!isPayableInvoice && invoice.statusId in ['InvoiceFinalized', 'InvoiceSent', 'InvoiceAcked', 'InvoicePmtRecvd']"><actions><if condition="invoice.toPartyId"><service-call name="mantle.party.ContactServices.get#PartyContactInfoList" out-map="emailInfo" in-map="[partyId:invoice.toPartyId, emailContactMechPurposeId:'EmailBilling', alsoIncludePrimaryPurpose:true]"/><set field="emailAddressList" from="emailInfo.emailAddressList ?: []"/><entity-find entity-name="mantle.party.PartyRelationship" list="contactRelList"><date-filter/><econdition field-name="toPartyId" from="invoice.toPartyId"/><econdition field-name="relationshipTypeEnumId" value="PrtContact"/></entity-find><iterate list="contactRelList" entry="contactRel"><service-call name="mantle.party.ContactServices.get#PartyContactInfoList" out-map="contactEmailInfo" out-map-add-to-existing="false" in-map="[partyId:contactRel.fromPartyId, emailContactMechPurposeId:'EmailBilling', alsoIncludePrimaryPurpose:true]"/><if condition="contactEmailInfo.emailAddressList"><script><![CDATA[emailAddressList.addAll(contactEmailInfo.emailAddressList)]]></script></if></iterate></if></actions><widgets><container-dialog id="SendPastDueEmailDialog" button-text="Send Past Due Email"><form-single name="SendPastDueEmailForm" transition="sendCustomerPastDueEmail"><field name="invoiceId"><default-field><hidden/></default-field></field><field name="fromPartyId" from="invoice.fromPartyId"><default-field><hidden/></default-field></field><field name="toPartyId" from="invoice.toPartyId"><default-field><hidden/></default-field></field><field name="toAddresses"><default-field title="To Address"><text-line size="40"/></default-field></field><field name="toAddressList"><default-field title="To Address"><drop-down allow-multiple="true"><list-options list="emailAddressList" key="${emailAddress}" text="${emailAddress} (${emailContactMechPurpose.description})"/></drop-down></default-field></field><field name="daysPastDue"><default-field title="Days Past Due"><text-line size="4" default-value="7"/></default-field></field><field name="daysPastInvoice"><default-field title="Days Past Invoice"><text-line size="4" default-value="40"/></default-field></field><field name="daysLastEmail"><default-field title="Days Singe Last Past Due Email"><text-line size="4" default-value="2"/></default-field></field><field name="submitButton"><default-field title="Send Email"><submit/></default-field></field></form-single></container-dialog><container-dialog id="SendFinalizedEmailDialog" button-text="Send Invoice Email"><form-single name="SendFinalizedEmailForm" transition="sendInvoiceStoreEmail"><field name="invoiceId"><default-field><hidden/></default-field></field><field name="emailTypeEnumId" from="'PsetInvoiceFinalized'"><default-field><hidden/></default-field></field><field name="toAddresses"><default-field title="To Address"><text-line size="40"/></default-field></field><field name="toAddressList"><default-field title="To Address"><drop-down allow-multiple="true"><list-options list="emailAddressList" key="${emailAddress}" text="${emailAddress} (${emailContactMechPurpose.description})"/></drop-down></default-field></field><field name="submitButton"><default-field title="Send Email"><submit/></default-field></field></form-single></container-dialog></widgets></section></box-toolbar><box-body><form-list name="EmailMessageList" list="emailMessageList" skip-form="true"><entity-find entity-name="mantle.account.invoice.InvoiceEmailMessageDetail" list="emailMessageList"><econdition field-name="invoiceId"/><order-by field-name="sentDate,emailMessageId"/></entity-find><field name="emailMessageId"><default-field title="ID"><link url="EmailMessage" text="${emailMessageId}" link-type="anchor" target-window="_blank"/></default-field></field><field name="sentDate"><default-field><display/></default-field></field><field name="toAddresses"><default-field><display/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="receivedDate"><default-field><display/></default-field></field><field name="emailTypeEnumId"><default-field title="Email Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field></form-list></box-body></container-box></widgets></section></row-col><row-col lg="6"><label text="Payable Invoice ${invoiceId} for ${ec.resource.expand('PartyNameTemplate', null, organizationParty)}" condition="isPayableInvoice"/><label text="Receivable Invoice ${invoiceId} for ${ec.resource.expand('PartyNameTemplate', null, organizationParty)}" condition="!isPayableInvoice"/><section-include name="StatusChangeSection" location="component://SimpleScreens/template/basic/StatusWidgets.xml"/><section-include name="StatusHistorySection" location="component://SimpleScreens/template/basic/StatusWidgets.xml"/><container-box><box-header title="Payment Applications"/><box-toolbar><container-dialog id="NewCreditMemoDialog" button-text="New Credit Memo" condition="unpaidTotal"><form-single name="NewCreditMemoForm" transition="createCreditMemo"><field name="originalInvoiceId" from="invoiceId"><default-field><display/></default-field></field><field name="invoiceDate" from="ec.user.nowTimestamp"><default-field><date-time/></default-field></field><field name="description"><default-field><text-line size="50"/></default-field></field><field name="amount" from="unpaidTotal"><default-field><text-line size="8" format="#,##0.00"/></default-field></field><field name="itemTypeEnumId"><default-field title="Item Type"><drop-down><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.EnumAndGroup"><econdition field-name="enumGroupEnumId" value="EngItemsAdjust"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="typeGlAccount"><default-field title="Default GL Account"><display dynamic-transition="getItemTypeGlAccount" also-hidden="false" depends-optional="true" parameter-map="[organizationPartyId:organizationPartyId, direction:(isPayableInvoice ? 'I' : 'O')]"><depends-on field="itemTypeEnumId"/><depends-on field="productId"/></display></default-field></field><field name="overrideGlAccountId"><default-field title="Override GL Account"><drop-down allow-empty="true"><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0"/></drop-down></default-field></field><field name="submitButton"><default-field title="Record Credit Memo"><submit/></default-field></field></form-single></container-dialog><container-dialog id="RecordPaymentContainer" button-text="New Payment for Invoice" condition="unpaidTotal"><form-single name="RecordPaymentForm" transition="recordPayment"><field name="invoiceId"><default-field><display/></default-field></field><field name="statusId" from="paymentStatusId"><default-field title="Payment Status"><drop-down no-current-selected-key="PmntPromised"><option key="PmntProposed" text="Proposed"/><option key="PmntPromised" text="Promised"/><option key="PmntAuthorized" text="Authorized"/><option key="PmntDelivered" text="Delivered"/></drop-down></default-field></field><field name="amountUomId" from="invoice.currencyUomId"><default-field title="Currency"><display-entity entity-name="moqui.basic.Uom"/></default-field></field><field name="amount"><default-field><text-line size="10" default-value="${ec.l10n.format(unpaidTotal, '#,##0.00')}"/></default-field></field><field name="paymentInstrumentEnumId"><default-field title="Payment Instrument"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="PaymentInstrument"/><set field="noCurrentSelectedKey" value="PiCompanyCheck"/></widget-template-include></default-field></field><field name="paymentMethodId"><default-field title="From Payment Method"><drop-down allow-empty="true"><entity-options key="${paymentMethodId}" text="PaymentMethodAndTypeTemplate"><entity-find entity-name="mantle.account.method.PaymentMethodAndType"><econdition field-name="ownerPartyId" from="invoice.toPartyId"/><order-by field-name="typeDescription,description"/></entity-find></entity-options></drop-down></default-field></field><field name="effectiveDate"><default-field><date-time/></default-field></field><field name="dueDate"><default-field><date-time/></default-field></field><field name="paymentRefNum"><default-field title="Ref/Check Number"><text-line size="10"/></default-field></field><field name="memo"><default-field><text-line size="30"/></default-field></field><field name="comments"><default-field><text-area cols="60" rows="4"/></default-field></field><field name="submitButton"><default-field title="Create Payment"><submit/></default-field></field><field-layout><field-row><field-ref name="statusId"/><field-ref name="invoiceId"/></field-row><field-row><field-ref name="amount"/><field-ref name="amountUomId"/></field-row><field-row><field-ref name="effectiveDate"/><field-ref name="dueDate"/></field-row><fields-not-referenced/></field-layout></form-single></container-dialog></box-toolbar><box-body><label text="Applied Payments ${ec.l10n.formatCurrency(appliedPaymentsTotal, invoice.currencyUomId)}, Unpaid ${ec.l10n.formatCurrency(unpaidTotal, invoice.currencyUomId)}" type="strong"/></box-body><box-body-nopad><form-list name="PaymentApplicationList" list="paymentApplicationList" skip-form="true"><row-actions><set field="otherInvoiceId" from="toInvoiceId ? (toInvoiceId == invoice.invoiceId ? invoiceId : toInvoiceId) : null"/><if condition="otherInvoiceId"><then><entity-find-one entity-name="mantle.account.invoice.Invoice" value-field="otherInvoice"><field-map field-name="invoiceId" from="otherInvoiceId"/><select-field field-name="statusId,referenceNumber"/></entity-find-one></then><else><entity-find-one entity-name="mantle.account.payment.Payment" value-field="payment"><field-map field-name="paymentId"/><select-field field-name="statusId,paymentRefNum"/></entity-find-one></else></if></row-actions><field name="paymentApplicationId"><default-field title="Appl"><display/></default-field></field><field name="paymentId"><default-field title="Payment"><link url="editPayment" text="${paymentId}" link-type="anchor" condition="paymentId"/></default-field></field><field name="otherInvoiceId"><default-field title="Other Invc"><link url="." text="${otherInvoiceId}" link-type="anchor" condition="otherInvoiceId" parameter-map="[invoiceId:otherInvoiceId]"/></default-field></field><field name="amountApplied" align="right"><default-field title="Amount"><display currency-unit-field="invoice.currencyUomId"/></default-field></field><field name="appliedDate"><default-field title="Applied"><display/></default-field></field><field name="statusId" from="payment?.statusId ?: otherInvoice?.statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="refNum" from="payment?.paymentRefNum ?: otherInvoice?.referenceNumber"><default-field title="Ref/Check"><display/></default-field></field><field name="unapply"><default-field title=""><link url="unapplyPaymentApplication" text="Un-apply" condition="amountApplied" confirmation="This will reduce the amount paid (applied) on this invoice possibly changing it back to an un-paid status, reverse the payment application GL transaction, and free up the payment to be applied to another invoice. Un-apply payment?"/></default-field></field></form-list></box-body-nopad></container-box><section name="RecordPaymentSection" condition="canRecordPayments"><widgets><container-box><box-header title="Promised Order Payments"/><box-body-nopad><form-list name="OrderPromisedPaymentList" list="orderPromisedPaymentList" transition="sendPromisedPayment"><field name="invoiceId"><default-field><hidden/></default-field></field><field name="orderId"><default-field title="Order"><link url="orderDetail" text="${orderId?:''}" link-type="anchor"/></default-field></field><field name="paymentId"><default-field title="Payment"><display text=""/><link url="editPayment" text="${paymentId?:''}" link-type="anchor"/></default-field></field><field name="amount" align="right"><default-field title="Amount"><text-line size="8" format="#,##0.00"/></default-field></field><field name="paymentRefNum"><default-field title="Ref Num"><text-line size="8"/></default-field></field><field name="submitButton"><default-field title="Send & Apply"><submit/></default-field></field></form-list></box-body-nopad></container-box></widgets></section><section name="ApplyPaymentSection" condition="canRecordPayments"><widgets><container-box><box-header title="Applicable Payments"/><box-body-nopad><form-list name="UnappliedPaymentList" list="unappliedPaymentInfoList" transition="applyInvoicePayment"><field name="invoiceId"><default-field><hidden/></default-field></field><field name="paymentId" from="payment.paymentId"><default-field title="Payment"><display text=""/><link url="editPayment" text="${payment.paymentId?:''}" link-type="anchor" parameter-map="[paymentId:payment.paymentId]"/></default-field></field><field name="effectiveDate" from="payment.effectiveDate"><default-field title="Date"><display format="yyyy-MM-dd"/></default-field></field><field name="statusId" from="payment.statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem" also-hidden="false"/></default-field></field><field name="forThis"><default-field title="For This"><display text="${payment.forInvoiceId == invoiceId ? 'Y' : 'N'}"/></default-field></field><field name="paymentTotal" align="right"><default-field title="Amount"><display currency-unit-field="payment.amountUomId"/></default-field></field><field name="unappliedTotal" align="right"><default-field title="Unapplied"><display currency-unit-field="payment.amountUomId"/></default-field></field><field name="amount" from="maxApplicableAmount" align="right"><conditional-field condition="allowApply"><text-line size="8" format="0.00"/></conditional-field><default-field title="Apply"><display currency-unit-field="invoice.currencyUomId"/></default-field></field><field name="submitButton"><conditional-field condition="allowApply" title="Apply"><submit/></conditional-field><default-field title=""><display text=""/></default-field></field></form-list></box-body-nopad></container-box></widgets></section><section name="ApplyToInvoiceSection" condition="canRecordPayments"><widgets><container-box><box-header title="Applicable Unpaid Invoices"/><box-body-nopad><form-list name="UnpaidInvoiceList" list="unpaidInvoiceInfoList" transition="applyInvoiceToInvoice"><field name="invoiceId"><default-field><hidden/></default-field></field><field name="toInvoiceId" from="invoice.invoiceId"><default-field title="Invoice"><display text=""/><link url="." text="${invoice.invoiceId?:''}" link-type="anchor" parameter-map="[invoiceId:invoice.invoiceId]"/></default-field></field><field name="invoiceDate" from="invoice.invoiceDate"><default-field title="Date"><display format="yyyy-MM-dd"/></default-field></field><field name="statusId" from="invoice.statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem" also-hidden="false"/></default-field></field><field name="invoiceTotal" align="right"><default-field title="Total"><display currency-unit-field="invoice.currencyUomId"/></default-field></field><field name="unpaidTotal" align="right"><default-field title="Unpaid"><display currency-unit-field="invoice.currencyUomId"/></default-field></field><field name="amount" from="maxApplicableAmount" align="right"><conditional-field condition="allowApply"><text-line size="8" format="0.00"/></conditional-field><default-field title="Amount"><display currency-unit-field="invoice.currencyUomId"/></default-field></field><field name="submitButton"><conditional-field title="Apply" condition="allowApply"><submit/></conditional-field><default-field title=""><display text=""/></default-field></field></form-list></box-body-nopad></container-box></widgets></section><section name="GlTransactionsSection"><actions><entity-find entity-name="mantle.ledger.transaction.AcctgTrans" list="acctgTransList"><econditions combine="or"><econdition field-name="invoiceId"/><econdition field-name="toInvoiceId" from="invoiceId"/></econditions><order-by field-name="acctgTransId"/></entity-find><set field="unpostableStatus" from="invoice.statusId in ['InvoiceInProcess', 'InvoiceIncoming', 'InvoiceReceived', 'InvoiceCancelled']"/><entity-find entity-name="mantle.ledger.transaction.AcctgTransAndEntryGlaSummary" list="entrySummaryList"><econditions combine="or"><econdition field-name="invoiceId"/><econdition field-name="toInvoiceId" from="invoiceId"/></econditions><select-field field-name="glAccountId,accountCode,accountName,isDebit,glAccountClassEnumId,debitCreditFlag,amount"/></entity-find><set field="glaSummaryMap" from="[:]"/><iterate list="entrySummaryList" entry="entrySummary"><set field="curEntry" from="glaSummaryMap.get(entrySummary.glAccountId)"/><if condition="curEntry == null"><set field="curEntry" from="entrySummary.getMap()"/><script><![CDATA[glaSummaryMap.put(entrySummary.glAccountId, curEntry)]]></script></if><if condition="entrySummary.debitCreditFlag == 'D'"><then><set field="curEntry.debits" from="entrySummary.amount"/></then><else><set field="curEntry.credits" from="entrySummary.amount"/></else></if><set field="curEntry.cdDiff" from="entrySummary.isDebit == 'Y' ? (curEntry.debits?:0.0) - (curEntry.credits?:0.0) : (curEntry.credits?:0.0) - (curEntry.debits?:0.0)"/></iterate><set field="glaSummaryList" from="new ArrayList(glaSummaryMap.values())"/><order-map-list list="glaSummaryList"><order-by field-name="accountCode"/></order-map-list><set field="glAccountCodeMask" from="ec.user.getPreference('GlAccountCodeMask')"/><set field="accountCodeFormatter" from="masker(glAccountCodeMask, '0')"/></actions><widgets><container-box><box-header title="GL Transactions"/><box-toolbar><link url="postInvoice" text="Post Invoice" condition="!acctgTransList && !unpostableStatus" confirmation="This will attempt to create and post a GL transaction for this invoice, and one for each invoice adjustment item if there are any. Post now?"/><link url="repostInvoice" text="Re-post Invoice" condition="acctgTransList && !unpostableStatus" confirmation="This will delete the current invoice and invoice adjustment transactions and post new ones based on the current state of the invoice. Re-post this invoice?"/></box-toolbar><box-body-nopad><form-list name="InvoiceTxList" list="acctgTransList" skip-form="true"><row-actions><service-call name="mantle.ledger.LedgerServices.calculate#AcctgTransTrialBalance" in-map="[acctgTransId:acctgTransId]" out-map="context"/></row-actions><field name="acctgTransId"><default-field title="TX ID"><link url="editTransaction" text="${acctgTransId}" link-type="anchor"/></default-field></field><field name="acctgTransTypeEnumId"><default-field title="TX Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="paymentId"><default-field title="Payment"><link url="editPayment" text="${paymentId}" link-type="anchor" condition="paymentId"/></default-field></field><field name="reversedByAcctgTransId"><default-field title="Rev By"><link url="editTransaction" text="${reversedByAcctgTransId}" link-type="anchor" condition="reversedByAcctgTransId" parameter-map="[acctgTransId:reversedByAcctgTransId]"/></default-field></field><field name="reverseOfAcctgTransId"><default-field title="Rev Of"><link url="editTransaction" text="${reverseOfAcctgTransId}" link-type="anchor" condition="reverseOfAcctgTransId" parameter-map="[acctgTransId:reverseOfAcctgTransId]"/></default-field></field><field name="transactionDate"><default-field title="TX Date"><display format="yyyy-MM-dd"/></default-field></field><field name="isPosted"><default-field title="Posted" container-style="${isPosted == 'Y' ? 'text-success' : 'text-danger'}"><display/></default-field></field><field name="postedDate"><default-field><display format="yyyy-MM-dd"/></default-field></field><field name="debitTotal" align="right"><default-field title="Total"><display currency-unit-field="amountUomId"/></default-field></field></form-list><form-list name="InvoiceGlaList" list="glaSummaryList" skip-form="true"><field name="glAccountId"><conditional-field condition="glAccountId"><display text="GlAccountNameTemplate"/></conditional-field><default-field title="GL Account"><display text=" "/></default-field></field><field name="debits" align="right" show-total="true"><default-field container-style="${(!glAccountId && credits != debits) ? 'text-danger' : ''}"><display format="#,##0.00"/></default-field></field><field name="credits" align="right" show-total="true"><default-field container-style="${(!glAccountId && credits != debits) ? 'text-danger' : ''}"><display format="#,##0.00"/></default-field></field><field name="cdDiff" align="right"><default-field title="Total" container-style="${(unpaidTotal != cdDiff && glAccountClassEnumId in ['ACCOUNTS_RECEIVABLE', 'ACCOUNTS_PAYABLE']) ? 'text-danger' : ''}"><display format="#,##0.00"/></default-field></field></form-list></box-body-nopad></container-box></widgets></section></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Invoice/EditInvoiceItems.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Items" default-menu-index="2"><parameter name="invoiceId" required="true"/><transition name="assetDetail"><default-response url="//${appRoot}/Asset/AssetDetail"/></transition><transition name="editProduct"><default-response url="//${appRoot}/Catalog/Product/EditProduct"/></transition><transition name="createInvoiceItem"><service-call name="mantle.account.InvoiceServices.create#InvoiceItem" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateInvoiceItem"><service-call name="mantle.account.InvoiceServices.update#InvoiceItem" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateInvoiceItemClosed"><service-call name="mantle.account.InvoiceServices.update#InvoiceItemClosed" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteInvoiceItem"><service-call name="mantle.account.InvoiceServices.delete#InvoiceItem" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getAssetList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getGlAccountListPaginated" location="component://SimpleScreens/template/account/AccountTransitions.xml"/><transition-include name="getItemTypeGlAccount" location="component://SimpleScreens/template/account/AccountTransitions.xml"/><actions><service-call name="mantle.account.InvoiceServices.get#InvoiceBasicInfo" out-map="context" in-map="[invoiceId:invoiceId, activeOrgId:activeOrgId]"/><entity-find entity-name="mantle.account.invoice.InvoiceItem" list="invoiceItemList"><search-form-inputs/><econdition field-name="invoiceId"/><order-by field-name="invoiceItemSeqId"/></entity-find><set field="topItemList" from="invoiceItemList.findAll({ it.parentItemSeqId == null })"/><script><![CDATA[itemWithChildrenSet = new HashSet()
            List reverseList = invoiceItemList.cloneList().orderByFields(["-invoiceItemSeqId"])
            for (invoiceItem in reverseList) {
                if (invoiceItem.parentItemSeqId) {
                    itemWithChildrenSet.add(invoiceItem.parentItemSeqId)
                    invoiceItemList.move(invoiceItemList.indexMatching([invoiceItemSeqId:invoiceItem.invoiceItemSeqId]),
                            invoiceItemList.indexMatching([invoiceItemSeqId:invoiceItem.parentItemSeqId])+1)
                }
            }]]></script><if condition="invoice.invoiceTypeEnumId == 'InvoiceSales' || invoice.invoiceTypeEnumId == 'InvoiceReturn'"><then><entity-find entity-name="moqui.basic.EnumAndGroup" list="itemTypeEnumList"><econdition field-name="enumGroupEnumId" from="isPayableInvoice ? 'EngItemsPurchase' : 'EngItemsSales'"/><order-by field-name="description"/></entity-find></then><else-if condition="invoice.invoiceTypeEnumId == 'InvoicePayroll'"><entity-find entity-name="moqui.basic.EnumAndParent" list="itemTypeEnumList"><econdition field-name="parentEnumId" operator="in" value="ItemPayrollIncome,ItemPayrollDeduct,ItemPayrollTaxes,ItemPayrollExpense"/><order-by field-name="description"/></entity-find></else-if><else><entity-find entity-name="moqui.basic.Enumeration" list="itemTypeEnumList"><econdition field-name="enumTypeId" value="ItemType"/><order-by field-name="description"/></entity-find></else></if><set field="glAccountCodeMask" from="ec.user.getPreference('GlAccountCodeMask')"/><set field="accountCodeFormatter" from="masker(glAccountCodeMask, '0')"/></actions><widgets><section name="AddInvoiceItemSection" condition="invoiceEditable"><widgets><container><container-dialog id="AddInvoiceItemDialog" button-text="Add Invoice Item" width="700"><form-single name="CreateInvoiceItem" transition="createInvoiceItem"><field name="invoiceId"><default-field><hidden/></default-field></field><field name="itemTypeEnumId"><default-field title="Type"><drop-down><list-options list="itemTypeEnumList" key="${enumId}" text="${description}"/></drop-down></default-field></field><field name="description"><default-field><text-line size="50"/></default-field></field><field name="quantity"><default-field><text-line size="4" default-value="1"/></default-field></field><field name="amount"><default-field><text-line size="8"/></default-field></field><field name="itemDate"><default-field><date-time/></default-field></field><field name="productId"><default-field title="Product"><drop-down allow-empty="true"><dynamic-options transition="getProductList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="otherPartyProductId"><default-field><text-line size="25"/></default-field></field><field name="typeGlAccount"><default-field title="Default GL Account"><display dynamic-transition="getItemTypeGlAccount" also-hidden="false" depends-optional="true" parameter-map="[organizationPartyId:organizationPartyId, direction:(isFromPartyOrgInternal ? 'O' : 'I')]"><depends-on field="itemTypeEnumId"/><depends-on field="productId"/></display></default-field></field><field name="overrideGlAccountId"><default-field title="Override GL Account"><drop-down allow-empty="true"><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0"/></drop-down></default-field></field><field name="submitButton"><default-field title="Create Invoice Item"><submit/></default-field></field></form-single></container-dialog></container></widgets></section><label text="Invoice Total: ${ec.l10n.formatCurrency(invoice.invoiceTotal, invoice.currencyUomId)}, Unpaid: ${ec.l10n.formatCurrency(invoice.unpaidTotal, invoice.currencyUomId)}"/><form-list name="EditInvoiceItems" list="invoiceItemList" transition="updateInvoiceItem" multi="true" header-dialog="true"><hidden-parameters><parameter name="invoiceId"/></hidden-parameters><field name="invoiceItemSeqId"><default-field title="Item"><display style="${parentItemSeqId ? 'text-info' : 'text-strong'}"/></default-field></field><field name="parentItemSeqId" align="center"><conditional-field condition="itemWithChildrenSet.contains(invoiceItemSeqId)"><display text=" "/></conditional-field><conditional-field condition="invoiceEditable"><drop-down allow-empty="true"><list-options list="topItemList" key="${invoiceItemSeqId}" text="${invoiceItemSeqId}"/></drop-down></conditional-field><default-field title="Parent"><display/></default-field></field><field name="description"><header-field><text-find/></header-field><default-field><text-line size="60"/></default-field></field><field name="productId"><header-field><drop-down allow-empty="true"><dynamic-options transition="getProductList" server-search="true" min-length="0"/></drop-down></header-field><conditional-field condition="invoiceEditable"><drop-down allow-empty="true"><dynamic-options transition="getProductList" server-search="true" min-length="0"/></drop-down></conditional-field><default-field title="Product"><display text=" "/><link url="editProduct" text="ProductNameTemplate" entity-name="mantle.product.Product" link-type="anchor" condition="productId"/></default-field></field><field name="otherPartyProductId"><header-field><text-find/></header-field><default-field><text-line size="25"/></default-field></field><field name="assetId"><conditional-field condition="invoiceEditable"><drop-down allow-empty="true"><dynamic-options transition="getAssetList" server-search="true" min-length="0"><depends-on field="productId"/></dynamic-options></drop-down></conditional-field><default-field title="Asset"><link url="assetDetail" text="AssetNameTemplate" entity-name="mantle.product.asset.Asset" link-type="anchor" condition="assetId"/></default-field></field><field name="itemTypeEnumId"><header-field><drop-down allow-empty="true"><list-options list="itemTypeEnumList" key="${enumId}" text="${description}"/></drop-down></header-field><conditional-field condition="invoiceEditable || isAdjustment == 'Y'"><drop-down><list-options list="itemTypeEnumList" key="${enumId}" text="${description}"/></drop-down></conditional-field><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="typeGlAccount"><default-field title="Default GL Account"><display dynamic-transition="getItemTypeGlAccount" also-hidden="false" depends-optional="true" parameter-map="[organizationPartyId:organizationPartyId, direction:(isFromPartyOrgInternal ? 'O' : 'I')]"><depends-on field="itemTypeEnumId"/><depends-on field="productId"/></display></default-field></field><field name="overrideGlAccountId"><conditional-field condition="invoiceEditable || isAdjustment == 'Y'" tooltip="Use % (percent) as a wildcard"><drop-down allow-empty="true"><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0"/></drop-down></conditional-field><default-field title="Override GL Account"><display-entity entity-name="mantle.ledger.account.GlAccount" text="GlAccountNameTemplate"/></default-field></field><field name="quantity"><conditional-field condition="invoiceEditable || isAdjustment == 'Y'"><text-line size="4"/></conditional-field><default-field><display/></default-field></field><field name="amount"><conditional-field condition="invoiceEditable || isAdjustment == 'Y'"><text-line size="8"/></conditional-field><default-field><display format="#,##0.00##"/></default-field></field><field name="itemDate"><default-field><date-time/></default-field></field><field name="total" from="(((quantity != null ? quantity : 1.0) * (amount ?: 0.0)) as BigDecimal).setScale(2, BigDecimal.ROUND_HALF_UP)" align="right"><default-field><display format="#,##0.00##" style="${parentItemSeqId ? 'text-info' : 'text-strong'}"/></default-field></field><field name="isAdjustment"><default-field title="Is Adjust"><display/></default-field></field><field name="deleteButton"><default-field title=""><link url="deleteInvoiceItem" text="Delete" condition="invoiceEditable" confirmation="Delete this item?" parameter-map="[invoiceId:invoiceId, invoiceItemSeqId:invoiceItemSeqId]"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field name="findButton"><header-field title="Find"><submit/></header-field></field><form-list-column><field-ref name="invoiceItemSeqId"/><field-ref name="parentItemSeqId"/></form-list-column><form-list-column><field-ref name="description"/><field-ref name="productId"/><field-ref name="otherPartyProductId"/><field-ref name="assetId"/></form-list-column><form-list-column><field-ref name="itemTypeEnumId"/><field-ref name="typeGlAccount"/><field-ref name="overrideGlAccountId"/></form-list-column><form-list-column><field-ref name="quantity"/><field-ref name="amount"/><field-ref name="itemDate"/></form-list-column><form-list-column><field-ref name="total"/><field-ref name="isAdjustment"/></form-list-column><form-list-column><field-ref name="deleteButton"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Invoice/EditInvoiceItemOrders.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Orders" default-menu-index="5"><parameter name="invoiceId" required="true"/><transition name="orderDetail"><default-response url="//${appRoot}/Order/OrderDetail"/></transition><transition name="shipmentDetail"><default-response url="//${appRoot}/Shipment/ShipmentDetail"/></transition><transition name="assetDetail"><default-response url="//${appRoot}/Asset/Asset/AssetDetail"/></transition><transition name="applyInvoiceToOrder"><service-call name="mantle.account.InvoiceServices.apply#InvoiceToOrder" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="applyInvoiceItemToOrder"><service-call name="mantle.account.InvoiceServices.apply#InvoiceItemToOrder" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="unapplyInvoiceItemFromOrder"><service-call name="mantle.account.InvoiceServices.unapply#InvoiceItemFromOrder" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><entity-find-one entity-name="mantle.account.invoice.Invoice" value-field="invoice"/><entity-find entity-name="mantle.account.invoice.InvoiceItem" list="invoiceItemList"><econdition field-name="invoiceId"/></entity-find><entity-find entity-name="mantle.order.OrderItemBillingDetail" list="allBillingList"><econdition field-name="invoiceId"/></entity-find></actions><widgets><container-dialog id="ApplyToOrderDialog" button-text="Apply Invoice to Order"><form-single name="ApplyToOrder" transition="applyInvoiceToOrder"><field name="invoiceId"><default-field><hidden/></default-field></field><field name="orderId"><default-field><text-line size="20"/></default-field></field><field name="submitButton"><default-field title="Apply Invoice"><submit/></default-field></field></form-single></container-dialog><section-iterate name="ItemListSection" list="invoiceItemList" entry="invoiceItem"><actions><filter-map-list list="allBillingList" to-list="itemBillingList"><field-map field-name="invoiceItemSeqId" from="invoiceItem.invoiceItemSeqId"/></filter-map-list><set field="billingQuantity" from="0"/><iterate list="itemBillingList" entry="itemBilling"><set field="billingQuantity" from="billingQuantity + (itemBilling.quantity ?: 0)"/></iterate></actions><widgets><container-box><box-header title="Item ${invoiceItem.invoiceItemSeqId}: ${invoiceItem.description}"/><box-toolbar><container-dialog id="ApplyItemToOrderDialog" button-text="Apply Item to Order"><form-single name="ApplyItemToOrder" transition="applyInvoiceItemToOrder"><field name="invoiceId"><default-field><hidden/></default-field></field><field name="invoiceItemSeqId" from="invoiceItem.invoiceItemSeqId"><default-field><hidden/></default-field></field><field name="orderId"><default-field><text-line size="20"/></default-field></field><field name="submitButton"><default-field title="Apply Item"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><container-row><row-col sm="1" style="text-right"><label text="Item Type" type="strong"/></row-col><row-col sm="3"><label text="${invoiceItem.type?.description ?: ''}"/></row-col><row-col sm="1" style="text-right"><label text="Quantity" type="strong"/></row-col><row-col sm="1"><label text="${ec.l10n.format(invoiceItem.quantity, '')}"/></row-col><row-col sm="1" style="text-right"><label text="Orders" type="strong"/></row-col><row-col sm="1"><label text="${ec.l10n.format(billingQuantity, '')} (${ec.l10n.format((billingQuantity / (invoiceItem.quantity ?: 1)) * 100, '0.0')}%)" style="${billingQuantity < (invoiceItem.quantity ?: 1) ? 'text-warning' : (billingQuantity > (invoiceItem.quantity ?: 1) ? 'text-danger' : 'text-success')}"/></row-col><row-col sm="1" style="text-right"><label text="Amount" type="strong"/></row-col><row-col sm="1"><label text="${ec.l10n.formatCurrency(invoiceItem.amount, invoice.currencyUomId)}"/></row-col><row-col sm="1" style="text-right"><label text="Total" type="strong"/></row-col><row-col sm="1"><label text="${ec.l10n.formatCurrency((invoiceItem.quantity ?: 1) * (invoiceItem.amount ?: 0), invoice.currencyUomId)}"/></row-col></container-row></box-body><box-body-nopad><form-list name="ItemBillingList" list="itemBillingList" skip-form="true" multi="true"><hidden-parameters><parameter name="invoiceId"/></hidden-parameters><field name="orderItemBillingId"><default-field><hidden/></default-field></field><field name="orderId"><default-field title="Order Item"><link url="orderDetail" link-type="anchor" text="${orderId}:${orderItemSeqId}"/></default-field></field><field name="shipmentId"><default-field title="Shipment"><link url="shipmentDetail" link-type="anchor" text="${shipmentId}"/></default-field></field><field name="assetId" from="receiptAssetId ?: issuanceAssetId"><default-field title="Asset"><link url="assetDetail" link-type="anchor" condition="assetId" text="${assetId} (${assetReceiptId ? 'Receipt ' + assetReceiptId : 'Issuance ' + assetIssuanceId})"/></default-field></field><field name="quantity" align="right"><default-field title="Applied Qty"><display/></default-field></field><field name="amountApplied" from="(quantity ?: 0) * (invoiceItem.amount ?: 0)" align="right"><default-field title="Applied Total"><display currency-unit-field="invoice.currencyUomId"/></default-field></field><field name="itemQuantity" align="right"><default-field title="Order Qty"><display/></default-field></field><field name="unitAmount" align="right"><default-field title="Order Amt" container-style="${unitAmount == invoiceItem.amount ? 'text-success' : 'text-danger'}"><display currency-unit-field="invoice.currencyUomId"/></default-field></field><field name="deleteButton" align="right"><default-field title=""><link url="unapplyInvoiceItemFromOrder" text="" icon="fa fa-trash" confirmation="Unapply item from Order?" parameter-map="[invoiceId:invoiceId, orderItemBillingId:orderItemBillingId]"/></default-field></field></form-list></box-body-nopad></container-box></widgets></section-iterate></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Invoice/EditInvoiceItemShipments.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Shipments" default-menu-index="6"><parameter name="invoiceId" required="true"/><transition name="shipmentDetail"><default-response url="//${appRoot}/Shipment/ShipmentDetail"/></transition><transition name="orderDetail"><default-response url="//${appRoot}/Order/OrderDetail"/></transition><transition name="editReturn"><default-response url="//${appRoot}/Return/EditReturn"/></transition><transition name="applyInvoiceToShipment"><service-call name="mantle.account.InvoiceServices.apply#InvoiceToShipment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="applyInvoiceItemToShipment"><service-call name="mantle.account.InvoiceServices.apply#InvoiceItemToShipment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="unapplyInvoiceItemFromShipment"><service-call name="mantle.account.InvoiceServices.unapply#InvoiceItemFromShipment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><entity-find-one entity-name="mantle.account.invoice.Invoice" value-field="invoice"/><entity-find entity-name="mantle.account.invoice.InvoiceItem" list="invoiceItemList"><econdition field-name="invoiceId"/></entity-find><entity-find entity-name="moqui.basic.EnumGroupMember" list="productItemTypeEgms" cache="true"><econdition field-name="enumGroupEnumId" value="EngItemsProduct"/></entity-find><set field="productItemTypes" from="productItemTypeEgms*.enumId"/></actions><widgets><container-dialog id="ApplyToShipmentDialog" button-text="Apply Invoice to Shipment"><form-single name="ApplyToShipment" transition="applyInvoiceToShipment"><field name="invoiceId"><default-field><hidden/></default-field></field><field name="shipmentId"><default-field><text-line size="20"/></default-field></field><field name="submitButton"><default-field title="Apply Invoice"><submit/></default-field></field></form-single></container-dialog><section-iterate name="ItemListSection" list="invoiceItemList" entry="invoiceItem"><actions><entity-find entity-name="mantle.shipment.ShipmentItemSource" list="itemSourceList"><econdition field-name="invoiceId"/><econdition field-name="invoiceItemSeqId" from="invoiceItem.invoiceItemSeqId"/></entity-find><set field="sourceQuantity" from="0"/><iterate list="itemSourceList" entry="itemSource"><set field="sourceQuantity" from="sourceQuantity + (itemSource.quantity ?: 0)"/></iterate></actions><widgets><section name="ItemListInner" condition="invoiceItem.itemTypeEnumId in productItemTypes"><widgets><container-box><box-header title="Item ${invoiceItem.invoiceItemSeqId}: ${invoiceItem.description}"/><box-toolbar><container-dialog id="ApplyItemToShipmentDialog" button-text="Apply Item to Shipment"><form-single name="ApplyItemToShipment" transition="applyInvoiceItemToShipment"><field name="invoiceId"><default-field><hidden/></default-field></field><field name="invoiceItemSeqId" from="invoiceItem.invoiceItemSeqId"><default-field><hidden/></default-field></field><field name="shipmentId"><default-field><text-line size="20"/></default-field></field><field name="submitButton"><default-field title="Apply Item"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><container-row><row-col sm="1" style="text-right"><label text="Item Type" type="strong"/></row-col><row-col sm="3"><label text="${invoiceItem.type?.description ?: ''}"/></row-col><row-col sm="1" style="text-right"><label text="Quantity" type="strong"/></row-col><row-col sm="1"><label text="${ec.l10n.format(invoiceItem.quantity, '')}"/></row-col><row-col sm="1" style="text-right"><label text="Shipments" type="strong"/></row-col><row-col sm="1"><label text="${ec.l10n.format(sourceQuantity, '')} (${ec.l10n.format((sourceQuantity / (invoiceItem.quantity ?: 1)) * 100, '0.0')}%)" style="${sourceQuantity < (invoiceItem.quantity ?: 1) ? 'text-warning' : (sourceQuantity > (invoiceItem.quantity ?: 1) ? 'text-danger' : 'text-success')}"/></row-col><row-col sm="1" style="text-right"><label text="Amount" type="strong"/></row-col><row-col sm="1"><label text="${ec.l10n.formatCurrency(invoiceItem.amount, invoice.currencyUomId)}"/></row-col><row-col sm="1" style="text-right"><label text="Total" type="strong"/></row-col><row-col sm="1"><label text="${ec.l10n.formatCurrency((invoiceItem.quantity ?: 1) * (invoiceItem.amount ?: 0), invoice.currencyUomId)}"/></row-col></container-row></box-body><box-body-nopad><form-list name="ItemSourceList" list="itemSourceList" skip-form="true" multi="true"><hidden-parameters><parameter name="invoiceId"/></hidden-parameters><field name="shipmentItemSourceId"><default-field><hidden/></default-field></field><field name="shipmentId"><default-field title="Shipment"><link url="shipmentDetail" link-type="anchor" text="${shipmentId}"/></default-field></field><field name="orderId"><default-field title="Order Item"><link url="orderDetail" link-type="anchor" text="${orderId}:${orderItemSeqId}" condition="orderId"/></default-field></field><field name="returnId"><default-field title="Return Item"><link url="editReturn" link-type="anchor" text="${returnId}:${returnItemSeqId}" condition="returnId"/></default-field></field><field name="quantity" align="right"><default-field title="Applied Qty"><display/></default-field></field><field name="amountApplied" from="(quantity ?: 0) * (invoiceItem.amount ?: 0)" align="right"><default-field title="Applied Total"><display currency-unit-field="invoice.currencyUomId"/></default-field></field><field name="deleteButton" align="right"><default-field title=""><link url="unapplyInvoiceItemFromShipment" text="" icon="fa fa-trash" confirmation="Unapply item from Shipment?" parameter-map="[invoiceId:invoiceId, shipmentItemSourceId:shipmentItemSourceId]"/></default-field></field></form-list></box-body-nopad></container-box></widgets></section></widgets></section-iterate></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Invoice/EditInvoiceItemDetails.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Budget Details" default-menu-index="9"><parameter name="invoiceId" required="true"/><transition name="editFacility"><default-response url="//${appRoot}/Facility/EditFacility"/></transition><transition name="assetDetail"><default-response url="//${appRoot}/Asset/Asset/AssetDetail"/></transition><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition name="createInvoiceItemDetail"><service-call name="mantle.account.InvoiceServices.create#InvoiceItemDetail" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateInvoiceItemDetail"><service-call name="update#mantle.account.invoice.InvoiceItemDetail" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteInvoiceItemDetail"><service-call name="delete#mantle.account.invoice.InvoiceItemDetail" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getAssetList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getFacilityList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><actions><entity-find-one entity-name="mantle.account.invoice.Invoice" value-field="invoice"/><entity-find entity-name="mantle.account.invoice.InvoiceItem" list="invoiceItemList"><econdition field-name="invoiceId"/></entity-find><entity-find-one entity-name="mantle.party.PartyRole" value-field="toPartyRole"><field-map field-name="partyId" from="invoice.overrideOrgPartyId ?: invoice.toPartyId"/><field-map field-name="roleTypeId" value="OrgInternal"/></entity-find-one><if condition="toPartyRole != null"><then><set field="organizationPartyId" from="toPartyRole.partyId"/></then><else><set field="organizationPartyId" from="invoice.fromPartyId"/></else></if><set field="glAccountCodeMask" from="ec.user.getPreference('GlAccountCodeMask')"/><set field="accountCodeFormatter" from="masker(glAccountCodeMask, '0')"/></actions><widgets><section-iterate name="ItemListSection" list="invoiceItemList" entry="invoiceItem"><actions><entity-find entity-name="mantle.account.invoice.InvoiceItemDetail" list="itemDetailList"><econdition field-name="invoiceId"/><econdition field-name="invoiceItemSeqId" from="invoiceItem.invoiceItemSeqId"/></entity-find><set field="detailQuantity" from="0"/><iterate list="itemDetailList" entry="itemDetail"><set field="detailQuantity" from="detailQuantity + (itemDetail.quantity ?: 0)"/></iterate><set field="glAccountId" from="invoiceItem.overrideGlAccountId"/><if condition="!glAccountId"><service-call name="mantle.ledger.InvoiceAutoPostServices.get#InvoiceItemGlAccount" in-map="[organizationPartyId:organizationPartyId, itemTypeEnumId:invoiceItem.itemTypeEnumId,                             productId:invoiceItem.productId, assetId:invoiceItem.assetId, direction:'I']" out-map="invoiceItemGlAccountOut" out-map-add-to-existing="false"/><set field="glAccountId" from="invoiceItemGlAccountOut.glAccountId"/></if><if condition="glAccountId"><service-call name="mantle.other.BudgetServices.get#GlAccountAppls" out-map="context" in-map="[glAccountId:glAccountId, ownerPartyIds:new HashSet([organizationPartyId])]"/><script><![CDATA[assetIdSet.removeAll(itemDetailList*.assetId); facilityIdSet.removeAll(itemDetailList*.facilityId)]]></script></if><entity-find-one entity-name="mantle.ledger.account.GlAccount" value-field="glAccount"><field-map field-name="glAccountId"/></entity-find-one></actions><widgets><container-box><box-header title="Item ${invoiceItem.invoiceItemSeqId}: ${invoiceItem.description}"/><box-toolbar><container-dialog id="AddDetailDialog" button-text="Add Detail"><form-single name="AddDetailForm" transition="createInvoiceItemDetail"><field name="invoiceId"><default-field><hidden/></default-field></field><field name="invoiceItemSeqId" from="invoiceItem.invoiceItemSeqId"><default-field><hidden/></default-field></field><field name="facilityTypeEnumId"><default-field title="Facility Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="FacilityType"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="facilityId"><default-field title="Facility"><drop-down allow-empty="true"><dynamic-options transition="getFacilityList" server-search="true" min-length="0"><depends-on field="facilityTypeEnumId"/></dynamic-options></drop-down></default-field></field><field name="assetId"><default-field title="OR Asset"><drop-down allow-empty="true"><dynamic-options transition="getAssetList" server-search="true" min-length="0" parameter-map="[assetTypeEnumId:'AstTpEquipment']"/></drop-down></default-field></field><field name="partyId"><default-field title="OR Party"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="quantity"><default-field><text-line size="10"/></default-field></field><field name="submitButton"><default-field title="Add Detail"><submit/></default-field></field></form-single></container-dialog><container-dialog id="AssetDetailDialog" button-text="Add Asset Details" condition="assetIdSet"><form-list name="AssetItemDetailList" list="assetList" transition="createInvoiceItemDetail" multi="true"><entity-find entity-name="mantle.product.asset.AssetSummaryView"><econdition field-name="assetId" operator="in" from="assetIdSet"/><select-field field-name="assetId,assetName,assetTypeEnumId,classEnumId,ownerPartyId,pseudoId,productName"/><order-by field-name="assetName,productName"/></entity-find><hidden-parameters><parameter name="invoiceId"/></hidden-parameters><field name="invoiceItemSeqId" from="invoiceItem.invoiceItemSeqId"><default-field><hidden/></default-field></field><field name="createNoQuantity" from="'false'"><default-field><hidden/></default-field></field><field name="assetId"><default-field title="Asset"><display text="AssetNameTemplate"/></default-field></field><field name="classEnumId"><default-field title="Class"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="productName"><default-field title="Product"><display text="ProductNameTemplate"/></default-field></field><field name="ownerPartyId"><default-field title="Owner"><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameTemplate"/></default-field></field><field name="quantity" align="right"><default-field><text-line size="8"/></default-field></field><field name="submitButton"><default-field title="Add Asset Details"><submit/></default-field></field></form-list></container-dialog><container-dialog id="FacilityDetailDialog" button-text="Add Facility Details" condition="facilityIdSet"><form-list name="FacilityItemDetailList" list="facilityList" transition="createInvoiceItemDetail" multi="true"><entity-find entity-name="mantle.facility.Facility"><econdition field-name="facilityId" operator="in" from="facilityIdSet"/><select-field field-name="facilityId,pseudoId,facilityName,ownerPartyId,facilitySize,facilitySizeUomId"/><order-by field-name="facilityName"/></entity-find><row-actions><entity-find-one entity-name="moqui.basic.Uom" value-field="sizeUom"><field-map field-name="uomId" from="facilitySizeUomId"/></entity-find-one></row-actions><hidden-parameters><parameter name="invoiceId"/></hidden-parameters><field name="invoiceItemSeqId" from="invoiceItem.invoiceItemSeqId"><default-field><hidden/></default-field></field><field name="createNoQuantity" from="'false'"><default-field><hidden/></default-field></field><field name="facilityId"><default-field title="Facility"><link url="editFacility" link-type="anchor" entity-name="mantle.facility.Facility" text="FacilityNameTemplate" condition="facilityId"/></default-field></field><field name="ownerPartyId"><default-field title="Owner"><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameTemplate"/></default-field></field><field name="quantity" align="right"><default-field><text-line size="8"/></default-field></field><field name="submitButton"><default-field title="Add Facility Details"><submit/></default-field></field></form-list></container-dialog></box-toolbar><box-body><container-row><row-col sm="1" style="text-right"><label text="Item Type" type="strong"/></row-col><row-col sm="3"><label text="${invoiceItem.type?.description ?: ''}"/></row-col><row-col sm="1" style="text-right"><label text="Quantity" type="strong"/></row-col><row-col sm="1"><label text="${ec.l10n.format(invoiceItem.quantity, '')}"/></row-col><row-col sm="1" style="text-right"><label text="Detail" type="strong"/></row-col><row-col sm="1"><label text="${ec.l10n.format(detailQuantity, '')} (${ec.l10n.format((detailQuantity / (invoiceItem.quantity ?: 1)) * 100, '0.0')}%)" style="${detailQuantity < (invoiceItem.quantity ?: 1) ? 'text-warning' : (detailQuantity > (invoiceItem.quantity ?: 1) ? 'text-danger' : 'text-success')}"/></row-col><row-col sm="1" style="text-right"><label text="Amount" type="strong"/></row-col><row-col sm="1"><label text="${ec.l10n.formatCurrency(invoiceItem.amount, invoice.currencyUomId)}"/></row-col><row-col sm="1" style="text-right"><label text="Total" type="strong"/></row-col><row-col sm="1"><label text="${ec.l10n.formatCurrency((invoiceItem.quantity ?: 1) * (invoiceItem.amount ?: 0), invoice.currencyUomId)}"/></row-col></container-row><container-row><row-col sm="1" style="text-right"><label text="GL Account" type="strong"/></row-col><row-col sm="5"><label text="GlAccountNameTemplate" text-map="glAccount"/></row-col></container-row></box-body><box-body-nopad><form-list name="ItemDetailList" list="itemDetailList" transition="updateInvoiceItemDetail" multi="true"><hidden-parameters><parameter name="invoiceId"/></hidden-parameters><field name="invoiceItemDetailId"><default-field><hidden/></default-field></field><field name="facilityId"><default-field title="Facility"><link url="editFacility" link-type="anchor" entity-name="mantle.facility.Facility" text="FacilityNameTemplate" condition="facilityId"/></default-field></field><field name="assetId"><default-field title="Asset"><link url="assetDetail" link-type="anchor" entity-name="mantle.product.asset.Asset" text="AssetNameTemplate" condition="assetId"/></default-field></field><field name="partyId"><default-field title="Party"><link url="editParty" link-type="anchor" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" condition="partyId"/></default-field></field><field name="quantity" align="right"><default-field><text-line size="10"/></default-field></field><field name="amount" from="(quantity ?: 0) * (invoiceItem.amount ?: 0)" align="right"><default-field><display currency-unit-field="invoice.currencyUomId"/></default-field></field><field name="deleteButton" align="right"><default-field title=""><link url="deleteInvoiceItemDetail" text="" icon="fa fa-trash" confirmation="Remove budget detail?" parameter-map="[invoiceId:invoiceId, invoiceItemDetailId:invoiceItemDetailId]"/></default-field></field><field name="submitButton"><default-field title="Update Details"><submit/></default-field></field></form-list></box-body-nopad></container-box></widgets></section-iterate></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Invoice.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Invoices" default-menu-index="1"><subscreens default-item="FindInvoice"/><widgets><subscreens-panel id="invoice-panel" type="tab"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Payment/BulkPaymentCheck.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Bulk Checks" default-menu-include="false"><parameter name="paymentMethodId" from="paymentMethodId ?: paymentMethodIdSave_0"/><transition name="editPayment"><default-response url="../EditPayment"/></transition><transition name="editPaymentMethod"><default-response url="//apps/${appRoot}/Party/PaymentMethod/EditPaymentMethod"/></transition><transition name="editParty"><default-response url="//apps/${appRoot}/Party/EditParty"/></transition><transition name="createPayment"><service-call name="mantle.account.PaymentServices.create#Payment" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditPayment"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition name="handleSubmit"><actions><if condition="setDelivered"><then><service-call name="update#mantle.account.payment.Payment" in-map="context + [statusId:'PmntDelivered']" multi="true"/></then><else-if condition="setAuthorized"><service-call name="update#mantle.account.payment.Payment" in-map="context + [statusId:'PmntAuthorized']" multi="true"/></else-if><else-if condition="setRefNums"><service-call name="mantle.account.PaymentServices.assign#BankAccountCheckNumber" in-map="context" multi="true"/></else-if><else><script><![CDATA[paymentIds = new StringBuilder()
                    for (int i = 0; ; i++) {
                        String curKey = "paymentId_" + i
                        if (context.containsKey(curKey)) {
                            if ((context.get("_useRowSubmit") == "true" || context.get("_useRowSubmit_" + i) == "true")
                                    && context.get("_rowSubmit_" + i) != "true") continue
                            if (paymentIds.length() > 0) paymentIds.append(",")
                            paymentIds.append(context.get(curKey))
                        } else {
                            break
                        }
                    }]]></script></else></if></actions><conditional-response url="${ec.web.getWebappRootUrl(false, null)}/fop/apps/${appRoot}/Accounting/Payment/PaymentCheck" url-type="plain"><condition><expression><![CDATA[checksPdf]]></expression></condition><parameter name="paymentIds" from="paymentIds"/><parameter name="filename" value="PaymentChecks.pdf"/></conditional-response><conditional-response url="${ec.web.getWebappRootUrl(false, null)}/fop/apps/${appRoot}/Accounting/Payment/PaymentDetail" url-type="plain"><condition><expression><![CDATA[detailsPdf]]></expression></condition><parameter name="paymentIds" from="paymentIds"/><parameter name="filename" value="PaymentDetails.pdf"/></conditional-response><default-response url="."/></transition><actions><set field="paymentInstrumentEnumId" from="paymentInstrumentEnumId ?: 'PiCompanyCheck'"/><entity-find entity-name="mantle.party.PartyRole" list="orgPrList"><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="partyId" from="activeOrgId" ignore="!activeOrgId"/></entity-find><set field="orgPartyIdList" from="orgPrList.partyId"/><entity-find entity-name="mantle.account.payment.Payment" list="paymentList" use-clone="true"><search-form-inputs default-order-by="paymentRefNum,effectiveDate" paginate="false"/><econdition field-name="fromPartyId" ignore-if-empty="true"/><econdition field-name="fromPartyId" operator="in" from="orgPartyIdList" ignore="fromPartyId"/><econdition field-name="statusId" operator="in" value="PmntPromised,PmntAuthorized"/></entity-find><if condition="paymentMethodId"><entity-find-one entity-name="mantle.account.method.PaymentMethodAndType" value-field="paymentMethod"/><entity-find-one entity-name="mantle.account.method.BankAccount" value-field="bankAccount"/><set field="lastCheckNumber" from="bankAccount?.lastCheckNumber"/><set field="phMap" from="[lastCheckNumber:lastCheckNumber]"/></if></actions><widgets><section name="PaymentMethodInfoSection" condition="bankAccount != null"><widgets><container-row><row-col md="2"><label text="Selected Method" type="strong"/></row-col><row-col md="10"><link url="editPaymentMethod" link-type="anchor" text="PaymentMethodAndTypeTemplate" text-map="paymentMethod"/></row-col></container-row><container-row><row-col md="2"><label text="Last Check Number" type="strong"/></row-col><row-col md="10"><label text="${lastCheckNumber} (update with link above)"/></row-col></container-row></widgets><fail-widgets><label text="To assign check numbers select a bank account in From Payment Method (in Find Options)."/></fail-widgets></section><form-list name="PaymentList" list="paymentList" multi="true" transition="handleSubmit" header-dialog="true" saved-finds="true" select-columns="true" show-csv-button="true" show-xlsx-button="true" show-page-size="true"><row-actions><if condition="lastCheckNumber"><set field="phMap.lastCheckNumber" from="phMap.lastCheckNumber + 1"/><set field="setRefNum" from="phMap.lastCheckNumber as String"/></if></row-actions><row-selection id-field="paymentId"><action><form-single name="PaymentListAssignRef" transition="handleSubmit" pass-through-parameters="true"><field name="paymentMethodId"><default-field><hidden/></default-field></field><field name="setRefNums"><conditional-field condition="bankAccount == null"><link url="invalid" text="Assign Check Numbers" link-type="anchor-button" tooltip="Select a From Payment Method to assign check numbers"/></conditional-field><default-field><submit text="Assign Check Numbers" type="success"/></default-field></field></form-single></action><action><form-single name="PaymentListActions" transition="handleSubmit" pass-through-parameters="true"><field name="checksPdf"><default-field><submit text="Checks PDF" type="info"/></default-field></field><field name="detailsPdf"><default-field><submit text="Details PDF" type="info"/></default-field></field><field name="setAuthorized"><default-field title="Set Authorized"><submit/></default-field></field><field name="setDelivered"><default-field title="Set Delivered"><submit/></default-field></field><field-layout><field-row-big><field-ref name="checksPdf"/><field-ref name="detailsPdf"/><field-ref name="setAuthorized"/><field-ref name="setDelivered"/></field-row-big></field-layout></form-single></action></row-selection><hidden-parameters><parameter name="_useRowSubmit" value="true"/></hidden-parameters><field name="paymentId"><default-field><hidden/></default-field></field><field name="paymentMethodIdSave" from="paymentMethodId"><default-field><hidden/></default-field></field><field name="_rowSubmit"><default-field title="Select"><check no-current-selected-key="true"><option key="true" text=" "/></check></default-field></field><field name="paymentLink"><default-field title="Payment"><link url="editPayment" text="${paymentId}" link-type="anchor"/></default-field></field><field name="paymentRefNum" from="paymentRefNum"><header-field title="Check Num" show-order-by="true"><text-line size="8"/></header-field><default-field><display/></default-field></field><field name="effectiveDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display also-hidden="false"/></default-field></field><field name="status" from="statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem" key-field-name="statusId" also-hidden="false"/></default-field></field><field name="fromPartyId"><header-field title="From"><drop-down allow-empty="true"><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="partyId" from="activeOrgId" ignore="!activeOrgId"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName,firstName,lastName"/></entity-find></entity-options></drop-down></header-field><default-field><link url="editParty" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" link-type="anchor" parameter-map="[partyId:fromPartyId]"/></default-field></field><field name="toPartyId"><header-field title="To"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></header-field><default-field><link url="editParty" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" link-type="anchor" parameter-map="[partyId:toPartyId]"/></default-field></field><field name="paymentTypeEnumId"><header-field title="Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="PaymentType"/><set field="allowEmpty" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration" also-hidden="false"/></default-field></field><field name="paymentInstrumentEnumId"><header-field title="Instrument"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="PaymentInstrument"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration" also-hidden="false"/></default-field></field><field name="paymentMethodId"><header-field title="From Payment Method"><drop-down allow-empty="true"><entity-options key="${paymentMethodId}" text="PaymentMethodAndTypeTemplate"><entity-find entity-name="mantle.account.method.PaymentMethodAndType"><econdition field-name="ownerPartyId" from="fromPartyId" ignore="!fromPartyId"/><econdition field-name="ownerPartyId" operator="in" from="orgPartyIdList" ignore="fromPartyId"/><order-by field-name="typeDescription,description"/></entity-find></entity-options></drop-down></header-field><default-field><display-entity entity-name="mantle.account.method.PaymentMethodAndType" text="PaymentMethodAndTypeTemplate" also-hidden="false"/></default-field></field><field name="amount" align="right"><header-field show-order-by="true"/><default-field title="Amount"><display currency-unit-field="amountUomId" also-hidden="false"/></default-field></field><field name="setRefNums"><conditional-field condition="bankAccount != null" title=""><submit text="Assign Check Numbers" type="success"/></conditional-field><default-field title=""><ignored/></default-field></field><field name="checksPdf"><default-field title=""><submit text="Checks PDF" type="info"/></default-field></field><field name="detailsPdf"><default-field title=""><submit text="Details PDF" type="info"/></default-field></field><field name="setAuthorized"><default-field title="Set Authorized"><submit/></default-field></field><field name="setDelivered"><default-field title="Set Delivered"><submit/></default-field></field><field name="findButton"><header-field title="Find"><submit/></header-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Payment/FindPayment.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="editPayment"><default-response url="../EditPayment"/></transition><transition name="createPayment"><service-call name="mantle.account.PaymentServices.create#Payment" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditPayment"/></transition><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><actions><if condition="'incoming'.equalsIgnoreCase(paymentType)"><then><set field="toRoleTypeId" value="OrgInternal"/></then><else-if condition="'outgoing'.equalsIgnoreCase(paymentType)"><set field="fromRoleTypeId" value="OrgInternal"/></else-if></if></actions><widgets><container-dialog id="NewInPaymentDialog" button-text="New Incoming Payment"><form-single name="NewInPaymentForm" transition="createPayment"><field name="fromPartyId"><default-field title="From"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="toPartyId"><default-field title="To"><drop-down><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="partyId" from="activeOrgId" ignore="!activeOrgId"/><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></default-field></field><field name="paymentInstrumentEnumId"><default-field title="Instrument"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="PaymentInstrument"/><set field="noCurrentSelectedKey" value="PiCompanyCheck"/></widget-template-include></default-field></field><field name="paymentTypeEnumId"><default-field title="Payment Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="PaymentType"/><set field="noCurrentSelectedKey" value="PtInvoicePayment"/></widget-template-include></default-field></field><field name="amount"><default-field><text-line size="12" format="#.00"/></default-field></field><field name="effectiveDate" from="ec.user.nowTimestamp"><default-field><date-time/></default-field></field><field name="submitButton"><default-field title="Create Payment"><submit/></default-field></field></form-single></container-dialog><container-dialog id="NewOutPaymentDialog" button-text="New Outgoing Payment"><form-single name="NewOutPaymentForm" transition="createPayment" extends="NewInPaymentForm"><field name="fromPartyId"><default-field title="From"><drop-down><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="partyId" from="activeOrgId" ignore="!activeOrgId"/><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></default-field></field><field name="toPartyId"><default-field title="To"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></default-field></field></form-single></container-dialog><link url="../BulkPaymentCheck" text="Bulk Checks"/><form-list name="PaymentList" list="paymentList" skip-form="true" header-dialog="true" select-columns="true" saved-finds="true" show-csv-button="true" show-xlsx-button="true" show-all-button="true"><entity-find entity-name="mantle.account.payment.PaymentFindView" list="paymentList" use-clone="true"><search-form-inputs default-order-by="-effectiveDate" skip-fields="fromRoleTypeId,toRoleTypeId"><default-parameters statusId="PmntProposed,PmntPromised,PmntAuthorized" statusId_op="in" effectiveDate_poffset="-1" effectiveDate_period="30d" paymentType="Any"/></search-form-inputs><econdition field-name="fromRoleTypeId" ignore-if-empty="true"/><econdition field-name="toRoleTypeId" ignore-if-empty="true"/><econditions combine="or"><econdition field-name="paymentMethodId" from="eitherPaymentMethodId" ignore-if-empty="true"/><econdition field-name="toPaymentMethodId" from="eitherPaymentMethodId" ignore-if-empty="true"/></econditions><econdition field-name="reconcileStatusId" value="PmtrNot" or-null="true" ignore="onlyNotRec != 'Y'"/><select-field field-name="amountUomId"/></entity-find><field name="paymentType"><header-field><radio no-current-selected-key="Any"><option key="Any"/><option key="Incoming"/><option key="Outgoing"/></radio></header-field></field><field name="onlyNotRec"><header-field><radio no-current-selected-key="N"><option key="Y"/><option key="N"/></radio></header-field></field><field name="paymentId"><header-field show-order-by="true" title="Payment"><text-find default-operator="begins"/></header-field><default-field><link url="editPayment" text="${paymentId}" link-type="anchor"/></default-field></field><field name="paymentRefNum"><header-field title="Ref Num" show-order-by="true"><text-find default-operator="begins"/></header-field><default-field><display/></default-field></field><field name="effectiveDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display also-hidden="false"/></default-field></field><field name="statusId"><header-field title="Status" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="Payment"/><set field="allowMultiple" value="true"/><set field="showNot" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="fromPartyId"><header-field title="From"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></header-field><default-field><link url="editParty" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" link-type="anchor" parameter-map="[partyId:fromPartyId]"/></default-field></field><field name="toPartyId"><header-field title="To"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></header-field><default-field><link url="editParty" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" link-type="anchor" parameter-map="[partyId:toPartyId]"/></default-field></field><field name="paymentTypeEnumId"><header-field title="Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="PaymentType"/><set field="allowEmpty" value="true"/><set field="style" value=" "/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="paymentInstrumentEnumId"><header-field title="Instrument"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="PaymentInstrument"/><set field="allowEmpty" value="true"/><set field="style" value=" "/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="paymentMethodId"><default-field title="From Payment Method"><display-entity entity-name="mantle.account.method.PaymentMethodAndType" text="PaymentMethodAndTypeTemplate"/></default-field></field><field name="toPaymentMethodId"><default-field title="To Payment Method"><display-entity entity-name="mantle.account.method.PaymentMethodAndType" text="PaymentMethodAndTypeTemplate"/></default-field></field><field name="eitherPaymentMethodId"><header-field title="Either PM"><display-entity entity-name="mantle.account.method.PaymentMethodAndType" text="PaymentMethodAndTypeTemplate"/></header-field></field><field name="amount" align="right" show-total="sum"><header-field title="Amount" show-order-by="true"><range-find/></header-field><default-field><display currency-unit-field="amountUomId"/></default-field></field><field name="unappliedTotal" align="right" show-total="sum"><header-field title="Unapplied" show-order-by="true"><range-find/></header-field><default-field><display currency-unit-field="amountUomId"/></default-field></field><field name="findButton"><header-field title="Find"><submit/></header-field></field><form-list-column><field-ref name="paymentId"/><field-ref name="paymentRefNum"/></form-list-column><form-list-column><field-ref name="effectiveDate"/><field-ref name="statusId"/></form-list-column><form-list-column><field-ref name="fromPartyId"/><field-ref name="toPartyId"/></form-list-column><form-list-column><field-ref name="paymentTypeEnumId"/><field-ref name="paymentInstrumentEnumId"/></form-list-column><form-list-column><field-ref name="paymentMethodId"/><field-ref name="toPaymentMethodId"/></form-list-column><form-list-column><field-ref name="amount"/></form-list-column><form-list-column><field-ref name="unappliedTotal"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Payment/PaymentCheck.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="paymentIds" required="true"/><actions><set field="paymentIdList" from="paymentIds instanceof List ? paymentIds : paymentIds.split(',') as List"/><service-call name="mantle.account.PaymentServices.get#PaymentCheckInfo" out-map="context" in-map="[paymentIdList:paymentIdList, templateSettingSuffix:'TemplatePaymentCheck']"/><if condition="!templateLocation"><set field="templateLocation" value="component://SimpleScreens/template/account/PaymentCheck.xsl-fo.ftl"/></if></actions><widgets><render-mode><text type="xsl-fo" location="${templateLocation}" template="true" encode="false" no-boundary-comment="true"/></render-mode></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Payment/PaymentDetail.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="paymentIds" required="true"/><actions><set field="paymentIdList" from="paymentIds instanceof List ? paymentIds : paymentIds.split(',') as List"/><service-call name="mantle.account.PaymentServices.get#PaymentCheckInfo" out-map="context" in-map="[paymentIdList:paymentIdList, templateSettingSuffix:'TemplatePaymentDetail']"/><if condition="!templateLocation"><set field="templateLocation" value="component://SimpleScreens/template/account/PaymentDetail.xsl-fo.ftl"/></if></actions><widgets><render-mode><text type="xsl-fo" location="${templateLocation}" template="true" encode="false" no-boundary-comment="true"/></render-mode></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Payment/EditPayment.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Payment" default-menu-index="1" default-menu-include="false"><parameter name="paymentId" required="true"/><transition name="editPayment"><default-response url="."/></transition><transition name="editPaymentMethod"><default-response url="//${appRoot}/Party/PaymentMethod/EditPaymentMethod"/></transition><transition name="paymentMethodFiles"><default-response url="//${appRoot}/Party/PaymentMethod/PaymentMethodFiles"/></transition><transition name="editInvoice"><default-response url="../../Invoice/EditInvoice"/></transition><transition name="editTransaction"><default-response url="../../Transaction/EditTransaction"/></transition><transition name="editFinancialAccount"><default-response url="../../FinancialAccount/EditFinancialAccount"/></transition><transition name="financialAccountTrans"><default-response url="../../FinancialAccount/FinancialAccountTrans"/></transition><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition name="orderDetail"><default-response url="//${appRoot}/Order/OrderDetail"/></transition><transition name="editReturn"><default-response url="//${appRoot}/Return/EditReturn"/></transition><transition name="updatePayment"><service-call name="mantle.account.PaymentServices.update#Payment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateStatus"><service-call name="update#mantle.account.payment.Payment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="cancelPaymentAndInvoices"><service-call name="mantle.account.PaymentServices.cancel#PaymentAndInvoices" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="postPayment"><service-call name="mantle.ledger.PaymentAutoPostServices.post#Payment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="repostPaymentAndApplications"><service-call name="mantle.ledger.PaymentAutoPostServices.repost#PaymentAndApplications" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createRefundPayment"><service-call name="mantle.account.PaymentServices.create#RefundPayment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="gatewayAuthorize"><service-call name="mantle.account.PaymentServices.authorize#SinglePayment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="gatewayCapture"><service-call name="mantle.account.PaymentServices.capture#SinglePayment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="gatewayRelease"><service-call name="mantle.account.PaymentServices.release#SinglePayment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="gatewayRefund"><service-call name="mantle.account.PaymentServices.refund#SinglePayment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="gatewayDetails"><service-call name="mantle.account.PaymentServices.get#SinglePaymentGatewayDetails" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="setPaymentRefundFor"><service-call name="mantle.account.PaymentServices.set#PaymentRefundFor" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="applyInvoicePayment"><service-call name="mantle.account.PaymentServices.apply#InvoicePayment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="applyPaymentToPayment"><service-call name="mantle.account.PaymentServices.apply#PaymentToPayment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="unapplyPaymentApplication"><service-call name="mantle.account.PaymentServices.unapply#PaymentApplication" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getGlAccountListPaginated" location="component://SimpleScreens/template/account/AccountTransitions.xml"/><transition name="createContent"><service-call name="mantle.account.PaymentServices.create#PaymentContent" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateContent"><service-call name="mantle.account.PaymentServices.update#PaymentContent" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="downloadContent" read-only="true"><parameter name="paymentContentId"/><actions><entity-find-one entity-name="mantle.account.payment.PaymentContent" value-field="paymentContent"/><script><![CDATA[ec.web.sendResourceResponse(paymentContent.contentLocation)]]></script></actions><default-response type="none"/></transition><transition name="PaymentCheck.pdf"><default-response url="${ec.web.getWebappRootUrl(false, null)}/fop/apps/${appRoot}/Accounting/Payment/PaymentCheck" url-type="plain"><parameter name="renderMode" value="xsl-fo"/><parameter name="pageNoLimit" value="true"/><parameter name="paymentIds" from="paymentId"/><parameter name="filename" value="PaymentCheck-${paymentId}.pdf"/></default-response></transition><transition name="PaymentDetail.pdf"><default-response url="${ec.web.getWebappRootUrl(false, null)}/fop/apps/${appRoot}/Accounting/Payment/PaymentDetail" url-type="plain"><parameter name="renderMode" value="xsl-fo"/><parameter name="pageNoLimit" value="true"/><parameter name="paymentIds" from="paymentId"/><parameter name="filename" value="PaymentDetail-${paymentId}.pdf"/></default-response></transition><actions><set field="thisPaymentId" from="paymentId"/><service-call name="mantle.account.PaymentServices.get#PaymentDisplayInfo" in-map="[paymentId:paymentId]" out-map="context"/><if condition="payment == null"><return error="true" message="Payment ${paymentId} not found"/></if><set field="statusId" from="payment?.statusId"/><set field="paymentEditable" from="statusId in ['PmntProposed', 'PmntPromised', 'PmntAuthorized']"/><set field="paymentDelivered" from="statusId in ['PmntDelivered', 'PmntConfirmed']"/><set field="isInvoicePayment" from="payment?.paymentTypeEnumId == 'PtInvoicePayment' || payment?.type?.parentEnumId == 'PtInvoicePayment'"/><set field="isCheck" from="payment.paymentInstrumentEnumId in ['PiPersonalCheck', 'PiCompanyCheck']"/><entity-find-one entity-name="mantle.account.method.PaymentMethodFile" value-field="paymentMethodFile"><field-map field-name="paymentMethodFileId" from="payment.paymentMethodFileId"/></entity-find-one></actions><widgets><container-row><row-col lg="6"><container><section-iterate name="InvoiceLinks" list="invoiceIdSet" entry="invoiceId"><widgets><link url="editInvoice" text="Invoice ${invoiceId}"/></widgets></section-iterate><section-iterate name="ReturnLinks" list="returnIdSet" entry="returnId"><widgets><link url="editReturn" text="Return ${returnId}" link-type="anchor-button"/></widgets></section-iterate><link url="PaymentCheck.pdf" text="Check PDF" condition="isCheck && isFromPartyOrgInternal"/><link url="PaymentDetail.pdf" text="Detail PDF" condition="isCheck && isFromPartyOrgInternal"/><container-dialog id="RefundDialog" button-text="Create Refund" condition="paymentDelivered"><form-single name="RefundPaymentForm" transition="createRefundPayment"><field name="paymentId"><default-field title="Original Payment"><display/></default-field></field><field name="statusId" from="paymentStatusId"><default-field title="Status"><drop-down no-current-selected-key="PmntPromised"><option key="PmntProposed" text="Proposed"/><option key="PmntPromised" text="Promised"/><option key="PmntAuthorized" text="Authorized"/><option key="PmntDelivered" text="Delivered"/></drop-down></default-field></field><field name="amountUomId" from="payment.amountUomId"><default-field title="Currency"><display-entity entity-name="moqui.basic.Uom"/></default-field></field><field name="amount"><default-field><text-line size="10" default-value="${ec.l10n.format(unappliedTotal, '#,##0.00')}"/></default-field></field><field name="paymentInstrumentEnumId"><default-field title="Payment Instrument"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="PaymentInstrument"/><set field="noCurrentSelectedKey" value="PiCompanyCheck"/></widget-template-include></default-field></field><field name="paymentMethodId"><default-field title="From Payment Method"><drop-down allow-empty="true"><entity-options key="${paymentMethodId}" text="PaymentMethodAndTypeTemplate"><entity-find entity-name="mantle.account.method.PaymentMethodAndType"><econdition field-name="ownerPartyId" from="payment.toPartyId"/><order-by field-name="typeDescription,description"/></entity-find></entity-options></drop-down></default-field></field><field name="effectiveDate" from="ec.user.nowTimestamp"><default-field><date-time/></default-field></field><field name="paymentRefNum"><default-field title="Ref/Check Number"><text-line size="10"/></default-field></field><field name="memo"><default-field><text-line size="30"/></default-field></field><field name="comments"><default-field><text-area cols="60" rows="4"/></default-field></field><field name="submitButton"><default-field title="Create Refund Payment"><submit/></default-field></field></form-single></container-dialog><container-dialog id="AuditLogDialog" button-text="Audit Log" width="960"><form-list name="AuditLogList" list="auditLogList" skip-form="true"><entity-find entity-name="moqui.entity.EntityAuditLog" list="auditLogList"><econdition field-name="changedEntityName" value="mantle.account.payment.Payment"/><econdition field-name="changedFieldName" operator="not-equals" value="statusId"/><econdition field-name="pkPrimaryValue" from="paymentId"/><select-field field-name="changedEntityName"/><order-by field-name="-changedDate"/></entity-find><field name="changedDate"><default-field title="Date"><display/></default-field></field><field name="changedByUserId"><default-field title="User"><display-entity text="UsernameTemplate" entity-name="mantle.party.PersonWithUserAccount" key-field-name="userId"/></default-field></field><field name="changedFieldName"><default-field title="Field"><display text="${org.moqui.util.StringUtilities.camelCaseToPretty(changedFieldName)}"/></default-field></field><field name="oldValueText"><default-field title="From"><display text="${ec.entity.formatFieldString(changedEntityName, changedFieldName, oldValueText)}"/></default-field></field><field name="newValueText"><default-field title="To"><display text="${ec.entity.formatFieldString(changedEntityName, changedFieldName, newValueText)}"/></default-field></field></form-list></container-dialog></container><form-single name="EditPayment" transition="updatePayment" map="payment"><field name="paymentId"><default-field><display/></default-field></field><field name="effectiveDate"><conditional-field condition="paymentEditable"><date-time/></conditional-field><default-field><display also-hidden="false"/></default-field></field><field name="fromPartyId"><default-field title="From"><link url="editParty" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" link-type="anchor" parameter-map="[partyId:fromPartyId]"/><display text=""/></default-field></field><field name="toPartyId"><default-field title="To"><link url="editParty" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" link-type="anchor" parameter-map="[partyId:toPartyId]"/><display text=""/></default-field></field><field name="orderId"><conditional-field condition="orderId" title="Order"><link url="orderDetail" text="OrderPartNameTemplate" text-map="payment" link-type="anchor" parameter-map="[orderId:orderId]"/></conditional-field><default-field><ignored/></default-field></field><field name="forInvoiceId"><conditional-field condition="forInvoiceId" title="For Invoice"><link url="editInvoice" text="${forInvoiceId}" link-type="anchor" parameter-map="[invoiceId:forInvoiceId]"/></conditional-field><default-field><ignored/></default-field></field><field name="amount"><conditional-field condition="paymentEditable"><text-line size="12" format="#,##0.00"/></conditional-field><default-field><display format="#,##0.00"/></default-field></field><field name="amountUomId"><default-field title="Currency"><display-entity entity-name="moqui.basic.Uom" text="${uomId}: ${description}"/></default-field></field><field name="paymentAuthCode"><default-field title="Auth Code"><text-line size="15"/></default-field></field><field name="paymentRefNum"><default-field title="Ref/Check Number"><text-line size="15"/></default-field></field><field name="dupWarning"><conditional-field title="" condition="dupPaymentList"><label text="Found payment(s) with same Ref Number: ${dupPaymentList.paymentId}" style="text-danger"/></conditional-field><default-field><ignored/></default-field></field><field name="dueDate"><default-field><date-time/></default-field></field><field name="settlementDate"><default-field><date-time/></default-field></field><field name="memo"><default-field><text-line size="30"/></default-field></field><field name="comments"><default-field><text-area cols="60" rows="4"/></default-field></field><field name="paymentTypeEnumId"><conditional-field title="Type" condition="paymentEditable"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="PaymentType"/></widget-template-include></conditional-field><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="paymentMethodFileId"><conditional-field condition="paymentMethodFile" title="In File"><link url="paymentMethodFiles" text="#${paymentMethodFile.paymentMethodFileId}" link-type="anchor" parameter-map="[paymentMethodId:paymentMethodFile.paymentMethodId,                                         paymentMethodFileId:paymentMethodFile.paymentMethodFileId]"/></conditional-field><default-field><ignored/></default-field></field><field name="overrideGlAccountId"><conditional-field title="Override (Cash) GL Account" condition="paymentEditable"><drop-down allow-empty="true"><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0"/></drop-down></conditional-field><default-field title="Override (Cash) GL Account"><display-entity entity-name="mantle.ledger.account.GlAccount" text="GlAccountNameTemplate"/></default-field></field><field name="paymentInstrumentEnumId"><conditional-field title="Instrument" condition="paymentEditable"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="PaymentInstrument"/><set field="allowEmpty" value="true"/></widget-template-include></conditional-field><default-field title="Instrument"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="paymentMethodId"><conditional-field title="From Payment Method" condition="paymentEditable"><drop-down allow-empty="true"><entity-options key="${paymentMethodId}" text="PaymentMethodDetailTemplate"><entity-find entity-name="mantle.account.method.PaymentMethodDetail"><econdition field-name="paymentMethodId"/></entity-find></entity-options><entity-options key="${paymentMethodId}" text="PaymentMethodDetailTemplate"><entity-find entity-name="mantle.account.method.PaymentMethodDetail"><date-filter/><econdition field-name="ownerPartyId" from="fromPartyId"/><econdition field-name="paymentMethodId" operator="not-equals"/><order-by field-name="typeDescription,description"/></entity-find></entity-options></drop-down><link url="editPaymentMethod" text="PaymentMethodAndTypeTemplate" link-type="anchor" entity-name="mantle.account.method.PaymentMethodAndType" parameter-map="[paymentMethodId:paymentMethodId]" condition="paymentMethodId"/></conditional-field><default-field title="From Payment Method"><link url="editPaymentMethod" text="PaymentMethodAndTypeTemplate" link-type="anchor" entity-name="mantle.account.method.PaymentMethodAndType" parameter-map="[paymentMethodId:paymentMethodId]" condition="paymentMethodId"/></default-field></field><field name="toPaymentMethodId"><conditional-field title="To Payment Method" condition="paymentEditable"><drop-down allow-empty="true"><entity-options key="${paymentMethodId}" text="PaymentMethodDetailTemplate"><entity-find entity-name="mantle.account.method.PaymentMethodDetail"><econdition field-name="paymentMethodId" from="toPaymentMethodId"/></entity-find></entity-options><entity-options key="${paymentMethodId}" text="PaymentMethodDetailTemplate"><entity-find entity-name="mantle.account.method.PaymentMethodDetail"><date-filter/><econdition field-name="ownerPartyId" from="toPartyId"/><econdition field-name="paymentMethodId" operator="not-equals" from="toPaymentMethodId"/><order-by field-name="typeDescription,description"/></entity-find></entity-options></drop-down><link url="editPaymentMethod" text="PaymentMethodAndTypeTemplate" link-type="anchor" entity-name="mantle.account.method.PaymentMethodAndType" parameter-map="[paymentMethodId:toPaymentMethodId]" condition="toPaymentMethodId"/></conditional-field><default-field title="To Payment Method"><link url="editPaymentMethod" text="PaymentMethodAndTypeTemplate" link-type="anchor" entity-name="mantle.account.method.PaymentMethodAndType" parameter-map="[paymentMethodId:toPaymentMethodId]" condition="toPaymentMethodId"/></default-field></field><field name="finAccountId"><conditional-field condition="paymentEditable" title="Financial Account"><drop-down allow-empty="true"><entity-options key="${finAccountId}" text="FinancialAccountNameTemplate"><entity-find entity-name="mantle.account.financial.FinancialAccount"><econdition field-name="ownerPartyId" operator="in" from="[fromPartyId, toPartyId]"/></entity-find></entity-options></drop-down><link url="editFinancialAccount" text="FinancialAccountNameTemplate" link-type="anchor" condition="finAccountId" entity-name="mantle.account.financial.FinancialAccount" parameter-map="[finAccountId:finAccountId]"/></conditional-field><conditional-field condition="finAccountId" title="Financial Account"><link url="editFinancialAccount" text="FinancialAccountNameTemplate" link-type="anchor" condition="finAccountId" entity-name="mantle.account.financial.FinancialAccount" parameter-map="[finAccountId:finAccountId]"/></conditional-field><default-field><ignored/></default-field></field><field name="finAccountTransId"><conditional-field condition="finAccountTransId" title="Financial Account TX"><link url="financialAccountTrans" text="${finAccountTransId}" link-type="anchor" parameter-map="[finAccountId:finAccountId, finAccountTransId:finAccountTransId]"/></conditional-field><default-field><ignored/></default-field></field><field name="paymentGatewayConfigId"><default-field title="Payment Gateway"><drop-down allow-empty="true"><entity-options key="${paymentGatewayConfigId}" text="${description}"><entity-find entity-name="mantle.account.method.PaymentGatewayConfig"><econdition field-name="paymentGatewayTypeEnumId" operator="not-equals" value="PgtTest"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="originalCurrencyAmount"><default-field><text-line size="12" format="0.00"/></default-field></field><field name="originalCurrencyUomId"><default-field title="Original Currency"><drop-down allow-empty="true"><entity-options key="${uomId}" text="${description} [${uomId}]"><entity-find entity-name="moqui.basic.Uom"><econdition field-name="uomTypeEnumId" value="UT_CURRENCY_MEASURE"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field-layout><field-row><field-ref name="paymentId"/><field-ref name="effectiveDate"/></field-row><field-row><field-ref name="fromPartyId"/><field-ref name="toPartyId"/></field-row><field-row><field-ref name="orderId"/><field-ref name="forInvoiceId"/></field-row><field-row><field-ref name="amount"/><field-ref name="amountUomId"/></field-row><field-row><field-ref name="paymentAuthCode"/><field-ref name="paymentRefNum"/></field-row><field-ref name="dupWarning"/><field-row><field-ref name="settlementDate"/><field-ref name="dueDate"/></field-row><fields-not-referenced/></field-layout></form-single></row-col><row-col lg="6"><section name="PaymentGatewayActionsSection" condition="payment.paymentMethodId && (payment.paymentGatewayConfigId || payment.paymentInstrumentEnumId == 'PiFinancialAccount')"><widgets><container-dialog id="GatewayAuthorizeDialog" button-text="Gateway Authorize" condition="payment.statusId in ['PmntPromised', 'PmntProposed', 'PmntDeclined']"><form-single name="GatewayAuthorizeForm" map="payment" transition="gatewayAuthorize"><field name="paymentId"><default-field><hidden/></default-field></field><field name="cardSecurityCode"><default-field><text-line size="4"/></default-field></field><field name="submitButton"><default-field title="Authorize"><submit/></default-field></field></form-single></container-dialog><container-dialog id="GatewayCaptureDialog" button-text="Gateway Capture" condition="payment.statusId == 'PmntAuthorized'"><form-single name="GatewayCaptureForm" map="payment" transition="gatewayCapture"><field name="paymentId"><default-field><hidden/></default-field></field><field name="amount"><default-field><text-line size="10"/></default-field></field><field name="submitButton"><default-field title="Capture"><submit/></default-field></field></form-single></container-dialog><link url="gatewayRelease" text="Gateway Release Auth" condition="payment.statusId == 'PmntAuthorized'" parameter-map="[payment:null]"/><container-dialog id="GatewayRefundDialog" button-text="Gateway Refund" condition="paymentDelivered"><form-single name="GatewayRefundForm" map="payment" transition="gatewayRefund"><field name="paymentId"><default-field><hidden/></default-field></field><field name="amount" from="unappliedTotal"><default-field><text-line size="10"/></default-field></field><field name="submitButton"><default-field title="Refund"><submit/></default-field></field></form-single></container-dialog><link url="gatewayDetails" text="Get Gateway Status" parameter-map="[payment:null]" condition="payment.paymentRefNum"/></widgets></section><section name="SetRefundForSection" condition="isFromPartyOrgInternal && !payment.refundForPaymentId && payment.statusId in ['PmntPromised', 'PmntAuthorized']"><actions><entity-find entity-name="mantle.account.payment.Payment" list="originalPaymentList"><econdition field-name="fromPartyId" from="payment.toPartyId"/><econdition field-name="toPartyId" from="payment.fromPartyId"/><econdition field-name="paymentInstrumentEnumId" value="PiCreditCard"/><econdition field-name="statusId" operator="in" value="PmntDelivered,PmntConfirmed"/><econdition field-name="paymentGatewayConfigId" operator="is-not-null"/><econdition field-name="paymentRefNum" operator="is-not-null"/><econdition field-name="amount" operator="greater-equals" from="payment.amount"/></entity-find></actions><widgets><container-dialog id="SetRefundForDialog" button-text="Set Refund For Payment" condition="originalPaymentList"><form-list name="SetRefundForForm" list="originalPaymentList" transition="setPaymentRefundFor"><row-actions><entity-find entity-name="mantle.account.payment.Payment" list="otherRefundPaymentList"><econdition field-name="refundForPaymentId" from="paymentId"/><econdition field-name="statusId" operator="not-in" value="PmntCancelled,PmntVoid,PmntDeclined"/><select-field field-name="paymentId,amount"/></entity-find><set field="otherRefundTotal" from="otherRefundPaymentList ? otherRefundPaymentList*.amount.sum() : 0.0"/><set field="refundRemaining" from="amount - otherRefundTotal"/></row-actions><field name="paymentId" from="thisPaymentId"><default-field><hidden/></default-field></field><field name="refundForPaymentId" from="paymentId"><default-field><hidden/></default-field></field><field name="payment"><default-field><link url="editPayment" text="${paymentId}"/></default-field></field><field name="effectiveDate"><default-field><display format="yyyy-MM-dd"/></default-field></field><field name="amount"><default-field><display currency-unit-field="amountUomId"/></default-field></field><field name="refundRemaining"><default-field><display currency-unit-field="amountUomId" style="${refundRemaining < payment.amount ? 'text-danger' : ''}"/></default-field></field><field name="submitButton"><default-field title="Set Refund For"><submit/></default-field></field></form-list></container-dialog></widgets></section><link text="Refund For Payment ${payment.refundForPaymentId}" url="editPayment" condition="payment.refundForPaymentId" parameter-map="[paymentId:payment.refundForPaymentId]"/><container-dialog id="GatewayRefundForDialog" button-text="Process Gateway Refund" condition="payment.refundForPaymentId && payment.statusId in ['PmntPromised', 'PmntAuthorized']"><form-single name="GatewayRefundForForm" transition="gatewayRefund"><field name="refundPaymentId" from="thisPaymentId"><default-field><hidden/></default-field></field><field name="paymentId" from="payment.refundForPaymentId"><default-field title="Original Payment"><display/></default-field></field><field name="amount" from="payment.amount"><default-field><display currency-unit-field="payment.amountUomId"/></default-field></field><field name="submitButton"><default-field title="Refund"><submit/></default-field></field></form-single></container-dialog><section-include name="StatusChangeSection" location="component://SimpleScreens/template/basic/StatusWidgets.xml"/><section-include name="StatusHistorySection" location="component://SimpleScreens/template/basic/StatusWidgets.xml"/><section name="RefundPaymentSection" condition="refundPaymentList"><widgets><container-box><box-header title="Refund Payments"/><box-body-nopad><form-list name="RefundPaymentList" list="refundPaymentList" skip-form="true"><field name="paymentId"><default-field title="Payment"><link url="editPayment" text="${paymentId}" link-type="anchor"/></default-field></field><field name="effectiveDate"><default-field title="Date"><display format="yyyy-MM-dd"/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem" also-hidden="false"/></default-field></field><field name="amount" align="right"><default-field title="Amount"><display currency-unit-field="amountUomId"/></default-field></field><field name="unappliedTotal" align="right"><default-field title="Unapplied"><display currency-unit-field="amountUomId"/></default-field></field></form-list></box-body-nopad></container-box></widgets></section><container-box><box-header title="Payment Applications"/><box-toolbar><link url="cancelPaymentAndInvoices" text="Cancel Payment and Invoices" confirmation="Cancel this payment and cancel all invoices it is applied to?" condition="statusId in ['PmntProposed', 'PmntPromised']"/><link url="cancelPaymentAndInvoices" text="Void Payment and Invoices" confirmation="Void this payment and cancel all invoices it is applied to?" condition="statusId in ['PmntAuthorized', 'PmntDelivered']"/></box-toolbar><box-body><label text="Applied ${ec.l10n.formatCurrency(appliedTotal, payment.amountUomId)}, Unapplied ${ec.l10n.formatCurrency(unappliedTotal, payment.amountUomId)}" type="strong"/></box-body><box-body-nopad><form-list name="PaymentApplicationList" list="paymentApplicationList"><row-actions><set field="otherPaymentId" from="toPaymentId ? (toPaymentId == payment.paymentId ? paymentId : toPaymentId) : null"/></row-actions><field name="paymentApplicationId"><default-field title="Appl"><display/></default-field></field><field name="invoiceId"><default-field title="Invoice"><link url="editInvoice" text="${invoiceId?:''}${invoiceItemSeqId ? (':' + invoiceItemSeqId) : ''}" link-type="anchor" condition="invoiceId"/></default-field></field><field name="otherPaymentId"><default-field title="Other Pmnt"><link url="editPayment" text="${otherPaymentId}" link-type="anchor" condition="otherPaymentId" parameter-map="[paymentId:otherPaymentId]"/></default-field></field><field name="amountApplied" align="right"><default-field title="Amount"><display currency-unit-field="payment.amountUomId"/></default-field></field><field name="appliedDate"><default-field title="Date"><display/></default-field></field><field name="unapply"><default-field title=""><link url="unapplyPaymentApplication" text="Un-apply" condition="amountApplied" confirmation="This will reduce the amount paid (applied) on the invoice possibly changing it back to an un-paid status, reverse the payment application GL transaction, and free up this payment to be applied to another invoice. Un-apply payment?"/></default-field></field></form-list></box-body-nopad></container-box><section name="ApplyToInvoiceSection" condition="(isInvoicePayment || payment?.paymentTypeEnumId == 'PtRefund') && unappliedTotal > 0"><widgets><container-box><box-header title="Applicable Unpaid Invoices"/><box-body-nopad><form-list name="UnpaidInvoiceList" list="unpaidInvoiceInfoList" transition="applyInvoicePayment"><field name="paymentId"><default-field><hidden/></default-field></field><field name="invoiceId" from="invoice.invoiceId"><default-field title="Invoice"><display text=""/><link url="editInvoice" text="${invoice.invoiceId?:''}" link-type="anchor" parameter-map="[invoiceId:invoice.invoiceId]"/></default-field></field><field name="invoiceDate" from="invoice.invoiceDate"><default-field title="Date"><display format="yyyy-MM-dd"/></default-field></field><field name="statusId" from="invoice.statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem" also-hidden="false"/></default-field></field><field name="forThis"><default-field title="For"><display text="${payment.forInvoiceId == invoice.invoiceId ? 'Y' : 'N'}"/></default-field></field><field name="invoiceTotal" align="right"><default-field title="Total"><display currency-unit-field="invoice.currencyUomId"/></default-field></field><field name="unpaidTotal" align="right"><default-field title="Unpaid"><display currency-unit-field="invoice.currencyUomId"/></default-field></field><field name="amount" from="maxApplicableAmount" align="right"><conditional-field condition="paymentDelivered && allowApply"><text-line size="8" format="0.00"/></conditional-field><default-field title="Amount"><display currency-unit-field="payment.amountUomId"/></default-field></field><field name="submitButton"><conditional-field title="Apply" condition="paymentDelivered && allowApply"><submit/></conditional-field><default-field title=""><display text=""/></default-field></field></form-list></box-body-nopad></container-box></widgets></section><section name="ApplyPaymentSection" condition="(isInvoicePayment || payment?.paymentTypeEnumId == 'PtRefund') && unappliedTotal > 0"><widgets><container-box><box-header title="Applicable Payments"/><box-body-nopad><form-list name="UnappliedPaymentList" list="unappliedPaymentInfoList" transition="applyPaymentToPayment"><field name="paymentId" from="thisPaymentId"><default-field><hidden/></default-field></field><field name="toPaymentId" from="payment.paymentId"><default-field title="Payment"><display text=""/><link url="editPayment" text="${payment.paymentId?:''}" link-type="anchor" parameter-map="[paymentId:payment.paymentId]"/></default-field></field><field name="effectiveDate" from="payment.effectiveDate"><default-field title="Date"><display format="yyyy-MM-dd"/></default-field></field><field name="statusId" from="payment.statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem" also-hidden="false"/></default-field></field><field name="paymentTotal" align="right"><default-field title="Amount"><display currency-unit-field="payment.amountUomId"/></default-field></field><field name="unappliedTotal" align="right"><default-field title="Unapplied"><display currency-unit-field="payment.amountUomId"/></default-field></field><field name="amount" from="maxApplicableAmount" align="right"><conditional-field condition="paymentDelivered && allowApply"><text-line size="8" format="0.00"/></conditional-field><default-field title="Apply"><display currency-unit-field="payment.amountUomId"/></default-field></field><field name="submitButton"><conditional-field condition="allowApply" title="Apply"><submit/></conditional-field><default-field title=""><display text=""/></default-field></field></form-list></box-body-nopad></container-box></widgets></section><section name="GlTransactionsSection"><actions><entity-find entity-name="mantle.ledger.transaction.AcctgTrans" list="acctgTransList"><econditions combine="or"><econdition field-name="paymentId"/><econdition field-name="toPaymentId" from="paymentId"/></econditions><order-by field-name="acctgTransId"/></entity-find><set field="unpostableStatus" from="!(payment.statusId in ['PmntDelivered', 'PmntConfirmed'])"/><entity-find entity-name="mantle.ledger.transaction.AcctgTransAndEntryGlaSummary" list="entrySummaryList"><econditions combine="or"><econdition field-name="paymentId"/><econdition field-name="toPaymentId" from="paymentId"/></econditions><select-field field-name="glAccountId,accountCode,accountName,isDebit,glAccountClassEnumId,debitCreditFlag,amount"/></entity-find><set field="glaSummaryMap" from="[:]"/><iterate list="entrySummaryList" entry="entrySummary"><set field="curEntry" from="glaSummaryMap.get(entrySummary.glAccountId)"/><if condition="curEntry == null"><set field="curEntry" from="entrySummary.getMap()"/><script><![CDATA[glaSummaryMap.put(entrySummary.glAccountId, curEntry)]]></script></if><if condition="entrySummary.debitCreditFlag == 'D'"><then><set field="curEntry.debits" from="entrySummary.amount"/></then><else><set field="curEntry.credits" from="entrySummary.amount"/></else></if><set field="curEntry.cdDiff" from="entrySummary.isDebit == 'Y' ? (curEntry.debits?:0.0) - (curEntry.credits?:0.0) : (curEntry.credits?:0.0) - (curEntry.debits?:0.0)"/></iterate><set field="glaSummaryList" from="new ArrayList(glaSummaryMap.values())"/><order-map-list list="glaSummaryList"><order-by field-name="accountCode"/></order-map-list><set field="glAccountCodeMask" from="ec.user.getPreference('GlAccountCodeMask')"/><set field="accountCodeFormatter" from="masker(glAccountCodeMask, '0')"/></actions><widgets><container-box><box-header title="GL Transactions"/><box-toolbar><link url="postPayment" text="Post Payment" condition="!acctgTransList && !unpostableStatus" confirmation="This will attempt to create and post a GL transaction for this payment. Post now?"/><link url="repostPaymentAndApplications" text="Re-post Payment and Applications" condition="acctgTransList && !unpostableStatus" confirmation="This will delete the current payment and payment application transactions and post new ones based on the current state of the payment. Re-post this payment?"/></box-toolbar><box-body-nopad><form-list name="PaymentTxList" list="acctgTransList" skip-form="true"><row-actions><service-call name="mantle.ledger.LedgerServices.calculate#AcctgTransTrialBalance" in-map="[acctgTransId:acctgTransId]" out-map="context"/></row-actions><field name="acctgTransId"><default-field title="TX ID"><link url="editTransaction" text="${acctgTransId}" link-type="anchor"/></default-field></field><field name="acctgTransTypeEnumId"><default-field title="TX Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="invoiceId"><default-field title="Invoice"><link url="editInvoice" text="${invoiceId}" link-type="anchor" condition="invoiceId"/></default-field></field><field name="reversedByAcctgTransId"><default-field title="Rev By"><link url="editTransaction" text="${reversedByAcctgTransId}" link-type="anchor" condition="reversedByAcctgTransId" parameter-map="[acctgTransId:reversedByAcctgTransId]"/></default-field></field><field name="reverseOfAcctgTransId"><default-field title="Rev Of"><link url="editTransaction" text="${reverseOfAcctgTransId}" link-type="anchor" condition="reverseOfAcctgTransId" parameter-map="[acctgTransId:reverseOfAcctgTransId]"/></default-field></field><field name="transactionDate"><default-field title="TX Date"><display format="yyyy-MM-dd"/></default-field></field><field name="isPosted"><default-field title="Posted"><display/></default-field></field><field name="postedDate"><default-field><display format="yyyy-MM-dd"/></default-field></field><field name="debitTotal" align="right"><default-field title="Total"><display currency-unit-field="amountUomId"/></default-field></field></form-list><form-list name="InvoiceGlaList" list="glaSummaryList" skip-form="true"><field name="glAccountId"><conditional-field condition="glAccountId"><display text="GlAccountNameTemplate"/></conditional-field><default-field title="GL Account"><display text=" "/></default-field></field><field name="debits" align="right" show-total="true"><default-field container-style="${(!glAccountId && credits != debits) ? 'text-danger' : ''}"><display format="#,##0.00"/></default-field></field><field name="credits" align="right" show-total="true"><default-field container-style="${(!glAccountId && credits != debits) ? 'text-danger' : ''}"><display format="#,##0.00"/></default-field></field><field name="cdDiff" align="right"><default-field title="Total" container-style="${(unappliedTotal != cdDiff && glAccountClassEnumId in ['UNEARNED_REVENUE', 'PREPAID_EXPENSE']) ? 'text-danger' : ''}"><display format="#,##0.00"/></default-field></field></form-list></box-body-nopad></container-box></widgets></section><section name="ContentSection"><actions><entity-find entity-name="mantle.account.payment.PaymentContent" list="contentList"><econdition field-name="paymentId"/><order-by field-name="-contentDate"/></entity-find></actions><widgets><container-box><box-header title="Content"/><box-toolbar><container-dialog id="NewContentDialog" button-text="Add Content"><form-single name="NewContentForm" transition="createContent"><field name="paymentId"><default-field><hidden/></default-field></field><field name="contentTypeEnumId"><default-field title="Content Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="PaymentContentType"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="contentFile"><default-field><file/></default-field></field><field name="description"><default-field><text-line size="60"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><section-iterate name="ContentIterateSection" list="contentList" entry="content"><actions><entity-find-one entity-name="mantle.party.PersonWithUserAccount" value-field="paua"><field-map field-name="userId" from="content.userId"/></entity-find-one><entity-find-one entity-name="moqui.basic.Enumeration" value-field="contentTypeEnum"><field-map field-name="enumId" from="content.contentTypeEnumId"/></entity-find-one></actions><widgets><container><container><label text="${contentTypeEnum?.description?:'No Type'}" type="strong"/></container><link url="downloadContent" condition="content.contentLocation" parameter-map="[paymentContentId:content.paymentContentId]" text="Download ${content.contentLocation.substring(content.contentLocation.lastIndexOf('/')+1)}"/><container-dialog id="UpdateContentContainer" button-text="Edit Content"><form-single name="UpdateContentForm" transition="updateContent" map="content"><field name="paymentContentId"><default-field><hidden/></default-field></field><field name="paymentId"><default-field><hidden/></default-field></field><field name="contentTypeEnumId"><default-field title="Content Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="PaymentContentType"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="contentFile"><default-field><file/></default-field></field><field name="description"><default-field><text-line size="60"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></container-dialog><container><label text="By ${ec.resource.expand('UsernameTemplate','',paua+[userId:content.userId])} at ${ec.l10n.format(content.contentDate, 'yyyy-MM-dd HH:mm')}" condition="paua"/></container><label text="${content.description ?: 'No Description'}" type="p"/></container></widgets></section-iterate></box-body></container-box></widgets></section><section name="GatewayResponseSection"><actions><entity-find entity-name="mantle.account.method.PaymentGatewayResponse" list="gatewayResponseList"><econdition field-name="paymentId"/><order-by field-name="-transactionDate"/></entity-find></actions><widgets><container-box><box-header title="Gateway Responses"/><box-body-nopad><form-list name="GatewayResponseList" list="gatewayResponseList" skip-form="true"><field name="paymentGatewayConfigId"><default-field title="Gateway Config"><display-entity entity-name="mantle.account.method.PaymentGatewayConfig" text="${description}"/></default-field></field><field name="paymentOperationEnumId"><default-field title="Operation"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="amount"><default-field><display currency-unit-field="amountUomId"/></default-field></field><field name="transactionDate"><default-field title="TX Date"><display/></default-field></field><field name="referenceNum"><default-field title="Ref Num"><display/></default-field></field><field name="approvalCode"><default-field title="Approval"><display/></default-field></field><field name="responseCode"><default-field title="Resp Code"><display/></default-field></field><field name="reasonCode"><default-field title="Reason" tooltip="${reasonMessage}"><display/></default-field></field><field name="reasonMessage"><default-field title="Message"><display/></default-field></field><field name="transactionStatus"><default-field title="Status"><display/></default-field></field><field name="resultSuccess"><default-field title="Success"><display/></default-field></field><field name="resultDeclined"><default-field title="Decline"><display/></default-field></field><field name="resultError"><default-field title="Error"><display/></default-field></field><field name="avsResult"><default-field title="AVS"><display text="${avsResult?:'N/A'}"/></default-field></field><field name="cvResult"><default-field title="CdV"><display text="${cvResult?:'N/A'}"/></default-field></field><field name="resultNsf"><default-field title="NSF"><display/></default-field></field><field name="resultBadExpire"><default-field title="Exp"><display/></default-field></field><field name="resultBadCardNumber"><default-field title="Bad#"><display/></default-field></field><form-list-column><field-ref name="paymentGatewayConfigId"/><field-ref name="paymentOperationEnumId"/><field-ref name="amount"/><field-ref name="transactionDate"/><field-ref name="reasonMessage"/></form-list-column><form-list-column><field-ref name="referenceNum"/><field-ref name="approvalCode"/><field-ref name="responseCode"/><field-ref name="reasonCode"/><field-ref name="transactionStatus"/></form-list-column><form-list-column><field-ref name="resultSuccess"/><field-ref name="resultDeclined"/><field-ref name="resultError"/></form-list-column><form-list-column><field-ref name="avsResult"/><field-ref name="cvResult"/></form-list-column><form-list-column><field-ref name="resultNsf"/><field-ref name="resultBadExpire"/><field-ref name="resultBadCardNumber"/></form-list-column></form-list></box-body-nopad></container-box></widgets></section></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Payment.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Payments" default-menu-index="2"><subscreens default-item="FindPayment"/><widgets><subscreens-active/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/FinancialAccount/FinancialAccountStatement.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="finAccountId" required="true"/><parameter name="year"/><parameter name="month"/><actions><service-call name="mantle.account.FinancialAccountServices.get#StatementPrintInfo" in-map="context" out-map="context"/></actions><widgets><render-mode><text type="xsl-fo" location="component://SimpleScreens/template/account/FinancialAccountStatement.xsl-fo.ftl" template="true" encode="false" no-boundary-comment="true"/></render-mode></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/FinancialAccount/FindFinancialAccount.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="editFinancialAccount"><default-response url="../EditFinancialAccount"/></transition><transition name="createFinancialAccount"><service-call name="mantle.account.FinancialAccountServices.create#FinancialAccount" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditFinancialAccount"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><actions><entity-find entity-name="mantle.account.financial.FinancialAccount" list="financialAccountList"><search-form-inputs default-order-by="-finAccountName"/></entity-find></actions><widgets><container-dialog id="NewFinancialAccountDialog" button-text="New Financial Account"><form-single name="NewFinancialAccountForm" transition="createFinancialAccount"><field name="finAccountTypeId"><default-field title="Type"><drop-down><entity-options key="${finAccountTypeId}" text="${description}"><entity-find entity-name="mantle.account.financial.FinancialAccountType"><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="organizationPartyId"><default-field title="Organization"><drop-down><entity-options key="${partyId}" text="${organizationName?:''} ${firstName?:''} ${lastName?:''} [${pseudoId}]"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" operator="in" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName,firstName,lastName"/></entity-find></entity-options></drop-down></default-field></field><field name="ownerPartyId"><default-field title="Account Owner"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="finAccountName"><default-field title="Account Name"><text-line size="50"/></default-field></field><field name="finAccountCode"><default-field title="Account #"><text-line size="20"/></default-field></field><field name="finAccountPin"><default-field title="PIN"><text-line size="8"/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="FinancialAccountList" list="financialAccountList" skip-form="true" header-dialog="true" select-columns="true" saved-finds="true" show-csv-button="true"><field name="finAccountTypeId"><header-field title="Type" show-order-by="true"><drop-down allow-empty="true"><entity-options key="${finAccountTypeId}" text="${description}"><entity-find entity-name="mantle.account.financial.FinancialAccountType"><order-by field-name="description"/></entity-find></entity-options></drop-down></header-field><default-field><display-entity entity-name="mantle.account.financial.FinancialAccountType"/></default-field></field><field name="organizationPartyId"><header-field title="Organization"><drop-down allow-empty="true"><entity-options key="${partyId}" text="${organizationName?:''} ${firstName?:''} ${lastName?:''} [${pseudoId}]"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName,firstName,lastName"/></entity-find></entity-options></drop-down></header-field><default-field><display-entity entity-name="mantle.party.PartyDetail" text="${organizationName?:''}${firstName?:''} ${lastName?:''} [${pseudoId}]"/></default-field></field><field name="ownerPartyId"><header-field title="Account Owner"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></header-field><default-field><display-entity entity-name="mantle.party.PartyDetail" also-hidden="false" key-field-name="partyId" text="${organizationName?:''}${firstName?:''} ${lastName?:''} [${pseudoId}]"/></default-field></field><field name="statusId"><header-field title="Status" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="FinancialAccount"/><set field="allowEmpty" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.StatusItem" also-hidden="false"/></default-field></field><field name="finAccountName"><header-field title="Account Name" show-order-by="case-insensitive"><text-find size="20" hide-options="true"/></header-field><default-field><display/></default-field></field><field name="actualBalance"><header-field title="Balance" show-order-by="true"/><default-field><display currency-unit-field="currencyUomId"/></default-field></field><field name="availableBalance"><header-field title="Available" show-order-by="true"/><default-field><display currency-unit-field="currencyUomId"/></default-field></field><field name="editFinancialAccountLink"><header-field title="Find"><submit/></header-field><default-field><link url="editFinancialAccount" text="Edit ${finAccountId}"/></default-field></field><form-list-column><field-ref name="finAccountTypeId"/><field-ref name="statusId"/></form-list-column><form-list-column><field-ref name="organizationPartyId"/><field-ref name="ownerPartyId"/></form-list-column><form-list-column><field-ref name="finAccountName"/></form-list-column><form-list-column><field-ref name="actualBalance"/></form-list-column><form-list-column><field-ref name="availableBalance"/></form-list-column><form-list-column><field-ref name="editFinancialAccountLink"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/FinancialAccount/EditFinancialAccount.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Financial Account" default-menu-index="1"><parameter name="finAccountId" required="true"/><transition name="updateFinancialAccount"><service-call name="mantle.account.FinancialAccountServices.update#FinancialAccount" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateStatus"><service-call name="mantle.account.FinancialAccountServices.update#FinancialAccount" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition name="FinancialAccountStatement.pdf"><default-response url="${ec.web.getWebappRootUrl(false, null)}/fop/apps/${appRoot}/Accounting/FinancialAccount/FinancialAccountStatement" url-type="plain"><parameter name="renderMode" value="xsl-fo"/><parameter name="pageNoLimit" value="true"/><parameter name="finAccountId"/><parameter name="year"/><parameter name="month"/><parameter name="filename" value="AccountStatement-${finAccountId}-${year ?: 'ALL-' + ec.l10n.format(ec.user.nowTimestamp, 'yyyy-MM-dd')}${month ? '-' + month : ''}.pdf"/></default-response></transition><actions><entity-find-one entity-name="mantle.account.financial.FinancialAccount" value-field="financialAccount"/><set field="statusId" from="financialAccount?.statusId"/><set field="changedEntityName" value="mantle.account.financial.FinancialAccount"/><set field="pkPrimaryValue" from="finAccountId"/><script><![CDATA[yearList = []
            int curYear = ec.user.getNowCalendar().get(Calendar.YEAR)
            for (int i = 0; i < 10; i++) yearList.add((curYear - i) as String)]]></script></actions><widgets><container-dialog id="StatementDialog" button-text="Statement PDF"><form-single name="StatementForm" transition="FinancialAccountStatement.pdf"><field name="finAccountId"><default-field><hidden/></default-field></field><field name="year"><default-field><drop-down><list-options list="yearList"/></drop-down></default-field></field><field name="month"><default-field><drop-down><option key="01" text="January"/><option key="02" text="February"/><option key="03" text="March"/><option key="04" text="April"/><option key="05" text="May"/><option key="06" text="June"/><option key="07" text="July"/><option key="08" text="August"/><option key="09" text="September"/><option key="10" text="October"/><option key="11" text="November"/><option key="12" text="December"/></drop-down></default-field></field><field name="submitButton"><default-field title="Get Statement"><submit/></default-field></field></form-single></container-dialog><link url="FinancialAccountStatement.pdf" text="Full History PDF"/><container-row><row-col lg="6"><form-single name="UpdateFinancialAccountForm" transition="updateFinancialAccount" map="financialAccount"><field name="finAccountId"><default-field><hidden/></default-field></field><field name="finAccountTypeId"><default-field title="Type"><drop-down><entity-options key="${finAccountTypeId}" text="${description}"><entity-find entity-name="mantle.account.financial.FinancialAccountType"><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="organizationPartyId"><default-field title="Organization"><display-entity entity-name="mantle.party.PartyDetail" also-hidden="false" text="PartyNameTemplate"/></default-field></field><field name="ownerPartyId"><default-field title="Account Owner"><drop-down><dynamic-options transition="searchPartyList" server-search="true"/></drop-down></default-field></field><field name="finAccountName"><default-field title="Account Name"><text-line size="50"/></default-field></field><field name="finAccountCode"><default-field title="Account #"><display/></default-field></field><field name="negativeBalanceLimit"><default-field title="Credit Limit"><text-line size="12"/></default-field></field><field name="actualBalance"><default-field title="Balance"><display currency-unit-field="currencyUomId"/></default-field></field><field name="availableBalance"><default-field title="Available"><display currency-unit-field="currencyUomId"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></row-col><row-col lg="6"><section-include name="StatusChangeSection" location="component://SimpleScreens/template/basic/StatusWidgets.xml"/><section-include name="StatusHistorySection" location="component://SimpleScreens/template/basic/StatusWidgets.xml"/></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/FinancialAccount/FinancialAccountTrans.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Transactions" default-menu-index="2"><parameter name="finAccountId" required="true"/><transition name="adjustFinancialAccount"><service-call name="mantle.account.FinancialAccountServices.adjust#FinancialAccount" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><pre-actions><if condition="!finAccountId && finAccountTransId"><entity-find-one entity-name="mantle.account.financial.FinancialAccountTrans" value-field="financialAccountTrans"/><set field="finAccountId" from="financialAccountTrans.finAccountId"/></if></pre-actions><actions><entity-find-one entity-name="mantle.account.financial.FinancialAccount" value-field="financialAccount"/><entity-find entity-name="mantle.account.financial.FinancialAccountTrans" list="financialAccountTransList"><search-form-inputs default-order-by="-transactionDate"/><econdition field-name="finAccountId"/></entity-find></actions><widgets><section name="AdjustSection" condition="financialAccount.statusId in ['FaNegPendRepl', 'FaActive']"><widgets><container-dialog id="AdjustDialog" button-text="Add Adjustment" width="700"><form-single name="AdjustFinancialAccount" transition="adjustFinancialAccount"><field name="finAccountId"><default-field><hidden/></default-field></field><field name="amount"><default-field><text-line size="8"/></default-field></field><field name="reasonEnumId"><default-field title="Reason"><drop-down allow-empty="true"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="FinancialAccountTransReason"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="comments"><default-field><text-area cols="60" rows="4"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></widgets></section><label text="Balance: ${ec.l10n.formatCurrency(financialAccount.actualBalance, financialAccount.currencyUomId)}, Available: ${ec.l10n.formatCurrency(financialAccount.availableBalance, financialAccount.currencyUomId)}" type="strong"/><form-list name="TransactionList" list="financialAccountTransList" skip-form="true" show-csv-button="true" show-xlsx-button="true"><field name="finAccountId"><header-field><hidden/></header-field></field><field name="finAccountTransId"><default-field title="ID"><display/></default-field></field><field name="transactionDate"><header-field title="Date" show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="reasonEnumId"><default-field title="Reason"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="comments"><header-field><text-find hide-options="true" size="20"/></header-field><default-field><display/></default-field></field><field name="fromPartyId"><header-field title="From"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></header-field><default-field><display-entity entity-name="mantle.party.PartyDetail" text="${organizationName?:''}${firstName?:''} ${lastName?:''} [${pseudoId}]"/></default-field></field><field name="toPartyId"><header-field title="To"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></header-field><default-field><display-entity entity-name="mantle.party.PartyDetail" text="${organizationName?:''}${firstName?:''} ${lastName?:''} [${pseudoId}]"/></default-field></field><field name="performedByUserId"><header-field title="Performed By"/><default-field><display-entity entity-name="mantle.party.PersonAndUserAccount" text="${username} - ${firstName?:''} ${lastName?:''}"/></default-field></field><field name="amount"><default-field><display currency-unit-field="financialAccount.currencyUomId"/></default-field></field><field name="findButton"><header-field title="Find"><submit/></header-field><default-field><display text=" "/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/FinancialAccount.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Financial Accounts" default-menu-index="3"><subscreens default-item="FindFinancialAccount"/><widgets><subscreens-panel id="FinancialAccountPanel" type="tab"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Transaction/FindTransaction.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="editTransaction"><default-response url="../EditTransaction"/></transition><transition name="findTransactionEntry"><default-response url="../FindTransactionEntry"/></transition><transition name="createAcctgTrans"><service-call name="mantle.ledger.LedgerServices.create#AcctgTrans" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditTransaction"/></transition><transition name="editInvoice"><default-response url="../../Invoice/EditInvoice"/></transition><transition name="editPayment"><default-response url="../../Payment/EditPayment"/></transition><transition name="assetDetail"><default-response url="//${appRoot}/Asset/AssetDetail"/></transition><transition name="shipmentDetail"><default-response url="//${appRoot}/Shipment/ShipmentDetail"/></transition><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><widgets><link url="findTransactionEntry" text="Find Entries"/><container-dialog id="CreateTxDialog" button-text="New Transaction"><form-single name="CreateAcctgTrans" transition="createAcctgTrans"><field name="acctgTransTypeEnumId"><default-field title="TX Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="AcctgTransType"/></widget-template-include></default-field></field><field name="organizationPartyId"><default-field title="Organization"><drop-down><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></default-field></field><field name="transactionDate" from="ec.user.nowTimestamp"><default-field><date-time/></default-field></field><field name="amountUomId"><default-field title="Currency"><drop-down no-current-selected-key="USD"><entity-options key="${uomId}" text="UomNameTemplate"><entity-find entity-name="moqui.basic.Uom"><econdition field-name="uomTypeEnumId" value="UT_CURRENCY_MEASURE"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="glJournalId"><default-field title="Journal"><drop-down allow-empty="true"><entity-options key="${glJournalId}" text="${glJournalName}"><entity-find entity-name="mantle.ledger.transaction.GlJournal"><econdition field-name="isPosted" operator="not-equals" value="Y" or-null="true"/><order-by field-name="glJournalName"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="TransactionList" list="acctgTransList" skip-form="true" header-dialog="true" select-columns="true" saved-finds="true" show-csv-button="true" show-xlsx-button="true"><entity-find entity-name="mantle.ledger.transaction.AcctgTrans" list="acctgTransList"><search-form-inputs default-order-by="-transactionDate"><default-parameters transactionDate_poffset="-1" transactionDate_period="30d"/></search-form-inputs></entity-find><row-actions><service-call name="mantle.ledger.LedgerServices.calculate#AcctgTransTrialBalance" in-map="[acctgTransId:acctgTransId]" out-map="context"/></row-actions><field name="transactionDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="acctgTransId"><header-field show-order-by="true" title="TX ID"><text-find hide-options="true" default-operator="begins"/></header-field><default-field><link url="editTransaction" text="${acctgTransId}" link-type="anchor"/></default-field></field><field name="acctgTransTypeEnumId"><header-field title="TX Type" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="AcctgTransType"/><set field="allowEmpty" value="true"/><set field="style" value=" "/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="glJournalId"><header-field title="Journal"><drop-down allow-empty="true"><entity-options key="${glJournalId}" text="${glJournalName}"><entity-find entity-name="mantle.ledger.transaction.GlJournal"><econdition field-name="isPosted" operator="not-equals" value="Y" or-null="true"/><order-by field-name="glJournalName"/></entity-find></entity-options></drop-down></header-field><default-field><display-entity entity-name="mantle.ledger.transaction.GlJournal" text="${glJournalId}: ${glJournalName}"/></default-field></field><field name="organizationPartyId"><header-field title="Organization"><drop-down allow-empty="true"><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></header-field><default-field><link url="editParty" link-type="anchor" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate"/></default-field></field><field name="otherPartyId"><header-field title="Other Party"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></header-field><default-field><link url="editParty" link-type="anchor" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" condition="otherPartyId"/></default-field></field><field name="description"><header-field show-order-by="true"><text-find/></header-field><default-field><display/></default-field></field><field name="invoiceId"><header-field title="Invoice" show-order-by="true"><text-line size="20"/></header-field><default-field><link url="editInvoice" text="${invoiceId}" link-type="anchor" condition="invoiceId"/></default-field></field><field name="paymentId"><header-field title="Payment" show-order-by="true"><text-line size="20"/></header-field><default-field><link url="editPayment" text="${paymentId}" link-type="anchor" condition="paymentId"/></default-field></field><field name="assetId"><header-field title="Asset" show-order-by="true"><text-line size="20"/></header-field><default-field><link url="assetDetail" text="${assetId}" link-type="anchor" condition="assetId"/></default-field></field><field name="shipmentId"><header-field title="Shipment" show-order-by="true"><text-line size="20"/></header-field><default-field><link url="shipmentDetail" text="${shipmentId}" link-type="anchor" condition="shipmentId"/></default-field></field><field name="reversedByAcctgTransId"><header-field title="Rev By" show-order-by="true"><text-line size="20"/></header-field><default-field><link url="editTransaction" text="${reversedByAcctgTransId}" link-type="anchor" condition="reversedByAcctgTransId" parameter-map="[acctgTransId:reversedByAcctgTransId]"/></default-field></field><field name="reverseOfAcctgTransId"><header-field title="Rev Of" show-order-by="true"><text-line size="20"/></header-field><default-field><link url="editTransaction" text="${reverseOfAcctgTransId}" link-type="anchor" condition="reverseOfAcctgTransId" parameter-map="[acctgTransId:reverseOfAcctgTransId]"/></default-field></field><field name="isPosted"><header-field title="Posted" show-order-by="true"><drop-down allow-empty="true"><option key="Y"/><option key="N"/></drop-down></header-field><default-field><display/></default-field></field><field name="postedDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="debitTotal" align="right"><default-field title="Total"><display currency-unit-field="amountUomId"/></default-field></field><field name="find"><header-field title="Find"><submit/></header-field></field><form-list-column><field-ref name="transactionDate"/><field-ref name="acctgTransId"/></form-list-column><form-list-column><field-ref name="acctgTransTypeEnumId"/><field-ref name="glJournalId"/></form-list-column><form-list-column><field-ref name="organizationPartyId"/><field-ref name="otherPartyId"/></form-list-column><form-list-column><field-ref name="description"/></form-list-column><form-list-column><field-ref name="invoiceId"/><field-ref name="paymentId"/></form-list-column><form-list-column><field-ref name="assetId"/><field-ref name="shipmentId"/></form-list-column><form-list-column><field-ref name="reversedByAcctgTransId"/><field-ref name="reverseOfAcctgTransId"/></form-list-column><form-list-column><field-ref name="isPosted"/><field-ref name="postedDate"/></form-list-column><form-list-column><field-ref name="debitTotal"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Transaction/FindTransactionEntry.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="editTransaction"><default-response url="../EditTransaction"/></transition><transition name="editInvoice"><default-response url="../../Invoice/EditInvoice"/></transition><transition name="editPayment"><default-response url="../../Payment/EditPayment"/></transition><transition name="editGlAccount"><default-response url="../../GlAccount/EditGlAccount"/></transition><transition name="assetDetail"><default-response url="//${appRoot}/Asset/AssetDetail"/></transition><transition name="shipmentDetail"><default-response url="//${appRoot}/Shipment/ShipmentDetail"/></transition><transition name="editProduct"><default-response url="//${appRoot}/Catalog/Product/EditProduct"/></transition><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition-include name="getGlAccountListPaginated" location="component://SimpleScreens/template/account/AccountTransitions.xml"/><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="emailScreenAsync" location="component://webroot/template/screen/BasicTransitions.xml"/><actions><set field="glAccountCodeMask" from="ec.user.getPreference('GlAccountCodeMask')"/><set field="accountCodeFormatter" from="masker(glAccountCodeMask, '0')"/></actions><widgets><section-include name="EmailScreenSection" location="component://webroot/template/screen/BasicTransitions.xml"/><form-list name="TransactionEntryList" list="acctgTransEntryList" skip-form="true" header-dialog="true" select-columns="true" saved-finds="true" show-csv-button="true" show-xlsx-button="true" show-all-button="true"><entity-find entity-name="mantle.ledger.transaction.AcctgTransAndEntrySummary" list="acctgTransEntryList"><search-form-inputs default-order-by="-transactionDate,-acctgTransId,acctgTransEntrySeqId"><default-parameters transactionDate_poffset="-1" transactionDate_period="30d"/></search-form-inputs><econdition field-name="reconcileStatusId" value="AterNot" or-null="true" ignore="onlyNotRec != 'Y'"/><select-field field-name="amount,debitCreditFlag"/></entity-find><field name="onlyNotRec"><header-field><radio no-current-selected-key="N"><option key="Y"/><option key="N"/></radio></header-field></field><field name="acctgTransId"><header-field show-order-by="true" title="TX ID"/><default-field><link url="editTransaction" text="${acctgTransId}" link-type="anchor"/></default-field></field><field name="glJournalId"><header-field title="Journal"><text-find size="10" hide-options="true"/></header-field><default-field><display/></default-field></field><field name="transactionDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="isPosted"><header-field title="Posted" show-order-by="true"><drop-down allow-empty="true"><option key="Y"/><option key="N"/></drop-down></header-field><default-field><display/></default-field></field><field name="acctgTransTypeEnumId"><header-field title="TX Type" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="AcctgTransType"/><set field="allowEmpty" value="true"/><set field="allowMultiple" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="description"><header-field show-order-by="true"><text-find size="40"/></header-field><default-field><display/></default-field></field><field name="organizationPartyId"><header-field title="Organization"><drop-down allow-empty="true"><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></header-field><default-field><link url="editParty" link-type="anchor" parameter-map="[partyId:organizationPartyId]" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate"/></default-field></field><field name="otherPartyId"><header-field title="Other Party"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></header-field><default-field><link url="editParty" link-type="anchor" parameter-map="[partyId:otherPartyId]" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" condition="otherPartyId"/></default-field></field><field name="invoiceId"><header-field title="Invoice" show-order-by="true"><text-find size="20" hide-options="ignore-case" default-operator="equals"/></header-field><default-field><link url="editInvoice" text="${invoiceId}" link-type="anchor" condition="invoiceId"/></default-field></field><field name="paymentId"><header-field title="Payment" show-order-by="true"><text-find size="20" hide-options="ignore-case" default-operator="equals"/></header-field><default-field><link url="editPayment" text="${paymentId}" link-type="anchor" condition="paymentId"/></default-field></field><field name="shipmentId"><header-field title="Shipment" show-order-by="true"><text-find size="20" hide-options="ignore-case" default-operator="equals"/></header-field><default-field><link url="shipmentDetail" text="${shipmentId}" link-type="anchor" condition="shipmentId"/></default-field></field><field name="assetId"><header-field title="Asset" show-order-by="true"><text-find size="10" hide-options="ignore-case" default-operator="equals"/></header-field><default-field><link url="assetDetail" text="${assetId}" link-type="anchor" condition="assetId"/></default-field></field><field name="productId"><header-field title="Product" show-order-by="true"><drop-down allow-empty="true"><dynamic-options transition="getProductList" server-search="true" min-length="0"/></drop-down></header-field><default-field><link url="editProduct" text="${productId}" link-type="anchor" condition="productId"/></default-field></field><field name="acctgTransEntrySeqId"><default-field title="Entry"><display/></default-field></field><field name="glAccountId"><header-field title="GL Account" show-order-by="true"><drop-down allow-empty="true"><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0"/></drop-down></header-field><default-field><link url="editGlAccount" link-type="anchor" entity-name="mantle.ledger.account.GlAccount" text="GlAccountNameTemplate"/></default-field></field><field name="debitCreditFlag"><default-field title="C/D"><display/></default-field></field><field name="amount" align="right"><header-field><range-find size="15"/></header-field><default-field><display format="#,##0.00"/></default-field></field><field name="debit" from="debitCreditFlag == 'D' ? amount : 0.0" align="right" show-total="sum"><default-field><display format="#,##0.00"/></default-field></field><field name="credit" from="debitCreditFlag == 'C' ? amount : 0.0" align="right" show-total="sum"><default-field><display format="#,##0.00"/></default-field></field><field name="find"><header-field title="Find"><submit/></header-field></field><form-list-column><field-ref name="acctgTransId"/><field-ref name="glJournalId"/></form-list-column><form-list-column><field-ref name="transactionDate"/><field-ref name="isPosted"/></form-list-column><form-list-column><field-ref name="acctgTransTypeEnumId"/><field-ref name="description"/></form-list-column><form-list-column><field-ref name="organizationPartyId"/><field-ref name="otherPartyId"/></form-list-column><form-list-column><field-ref name="invoiceId"/></form-list-column><form-list-column><field-ref name="paymentId"/></form-list-column><form-list-column><field-ref name="assetId"/></form-list-column><form-list-column><field-ref name="productId"/></form-list-column><form-list-column><field-ref name="acctgTransEntrySeqId"/></form-list-column><form-list-column><field-ref name="glAccountId"/></form-list-column><form-list-column><field-ref name="debit"/></form-list-column><form-list-column><field-ref name="credit"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Transaction/EditTransaction/MoveEntry.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="acctgTransId" required="true"/><parameter name="acctgTransEntrySeqId" required="true"/><transition name="moveTransEntry"><service-call name="mantle.ledger.LedgerServices.move#AcctgTransEntry" in-map="true" out-map="context" multi="parameter"/><default-response url=".."/></transition><transition-include name="getGlAccountListPaginated" location="component://SimpleScreens/template/account/AccountTransitions.xml"/><actions><entity-find-one entity-name="mantle.ledger.transaction.AcctgTrans" value-field="acctgTrans"/><entity-find-one entity-name="mantle.ledger.transaction.AcctgTransEntry" value-field="acctgTransEntry"/></actions><widgets><form-single name="ReceiveForm" transition="moveTransEntry"><field name="acctgTransId"><default-field><hidden/></default-field></field><field name="acctgTransEntrySeqId"><default-field title="Entry"><display/></default-field></field><field name="amount" from="acctgTransEntry.amount"><default-field><display currency-unit-field="acctgTrans.amountUomId"/></default-field></field><field name="fromGlAccountId" from="acctgTransEntry.glAccountId"><default-field title="From Account"><display-entity entity-name="mantle.ledger.account.GlAccount" text="GlAccountNameTemplate"/></default-field></field><field name="glAccountId"><default-field title="To Account"><drop-down><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0" parameter-map="[onlyPostingAllowed:'true', organizationPartyId:acctgTrans.organizationPartyId]"/></drop-down></default-field></field><field name="submitButton"><default-field title="Move"><submit/></default-field></field></form-single></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Transaction/EditTransaction.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Transaction" default-menu-index="1" default-menu-include="false"><parameter name="acctgTransId" required="true"/><transition name="editTransaction"><default-response url="."/></transition><transition name="updateAcctgTrans"><service-call name="mantle.ledger.LedgerServices.update#AcctgTrans" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateAcctgTransPosted"><service-call name="mantle.ledger.LedgerServices.update#AcctgTransPosted" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteAcctgTrans"><service-call name="mantle.ledger.LedgerServices.delete#AcctgTrans" in-map="true" out-map="context" multi="parameter"/><default-response url=".."/></transition><transition name="postAcctgTrans"><service-call name="mantle.ledger.LedgerServices.post#AcctgTrans" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="unpostAcctgTrans"><service-call name="mantle.ledger.LedgerServices.unpost#AcctgTrans" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="postReverseAcctgTrans"><service-call name="mantle.ledger.LedgerServices.post#ReverseAcctgTrans" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createAcctgTransEntry"><service-call name="mantle.ledger.LedgerServices.create#AcctgTransEntry" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateAcctgTransEntry"><service-call name="mantle.ledger.LedgerServices.update#AcctgTransEntry" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteAcctgTransEntry"><service-call name="mantle.ledger.LedgerServices.delete#AcctgTransEntry" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="editInvoice"><default-response url="../../Invoice/EditInvoice"/></transition><transition name="editPayment"><default-response url="../../Payment/EditPayment"/></transition><transition name="editProduct"><default-response url="//${appRoot}/Catalog/Product/EditProduct"/></transition><transition name="assetDetail"><default-response url="//${appRoot}/Asset/AssetDetail"/></transition><transition name="shipmentDetail"><default-response url="//${appRoot}/Shipment/ShipmentDetail"/></transition><transition-include name="getGlAccountListPaginated" location="component://SimpleScreens/template/account/AccountTransitions.xml"/><actions><entity-find-one entity-name="mantle.ledger.transaction.AcctgTrans" value-field="acctgTrans"/><if condition="acctgTrans == null"><return error="true" message="Transaction not found with ID ${acctgTransId}"/></if><set field="organizationPartyId" from="acctgTrans.organizationPartyId"/><service-call name="mantle.ledger.LedgerServices.calculate#AcctgTransTrialBalance" in-map="[acctgTransId:acctgTransId]" out-map="context"/><entity-find-one entity-name="mantle.party.PartyDetail" value-field="orgDetail"><field-map field-name="partyId" from="acctgTrans.organizationPartyId"/></entity-find-one><entity-find-one entity-name="mantle.party.PartyDetail" value-field="otherDetail"><field-map field-name="partyId" from="acctgTrans.otherPartyId"/></entity-find-one><entity-find-one entity-name="moqui.basic.Enumeration" value-field="typeEnum"><field-map field-name="enumId" from="acctgTrans.acctgTransTypeEnumId"/></entity-find-one><entity-find-one entity-name="moqui.basic.Uom" value-field="amountUom"><field-map field-name="uomId" from="acctgTrans.amountUomId"/></entity-find-one><entity-find-one entity-name="moqui.basic.Uom" value-field="origCurrencyAmountUom"><field-map field-name="uomId" from="acctgTrans.originalCurrencyUomId"/></entity-find-one><set field="glJournal" from="acctgTrans.'mantle.ledger.transaction.GlJournal'"/><entity-find entity-name="mantle.ledger.transaction.AcctgTransEntry" list="entryList"><econdition field-name="acctgTransId"/><order-by field-name="acctgTransEntrySeqId"/></entity-find><set field="glAccountCodeMask" from="ec.user.getPreference('GlAccountCodeMask')"/><set field="accountCodeFormatter" from="masker(glAccountCodeMask, '0')"/></actions><widgets><section name="NotPostedSection"><condition><expression><![CDATA[acctgTrans.isPosted != "Y"]]></expression></condition><widgets><link url="postAcctgTrans" text="Post Transaction" confirmation="Post transaction?"/><link url="postAcctgTrans" text="Force Post" confirmation="Force post transaction, ignoring closed periods?" btn-type="danger" condition="ec.user.hasPermission('GL_POST_CLOSED')" parameter-map="[forcePost:'true']"/><link url="deleteAcctgTrans" text="Delete Transaction" confirmation="Really delete this transaction?"/><container-dialog id="UpdateTxDialog" button-text="Update Transaction" width="900"><form-single name="UpdateAcctgTrans" map="acctgTrans" transition="updateAcctgTrans"><field name="acctgTransId"><default-field><hidden/></default-field></field><field name="acctgTransTypeEnumId"><default-field title="TX Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="AcctgTransType"/></widget-template-include></default-field></field><field name="organizationPartyId"><default-field title="Organization"><display text="${orgDetail.organizationName?:''} [${orgDetail.pseudoId}]"/></default-field></field><field name="transactionDate"><default-field><date-time/></default-field></field><field name="amountUomId"><default-field title="Currency"><drop-down><entity-options key="${uomId}" text="${description} [${uomId}]"><entity-find entity-name="moqui.basic.Uom"><econdition field-name="uomTypeEnumId" value="UT_CURRENCY_MEASURE"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="originalCurrencyUomId"><default-field title="Orig. Currency"><drop-down allow-empty="true"><entity-options key="${uomId}" text="${description} [${uomId}]"><entity-find entity-name="moqui.basic.Uom"><econdition field-name="uomTypeEnumId" value="UT_CURRENCY_MEASURE"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="glJournalId"><default-field title="Journal"><drop-down allow-empty="true"><entity-options key="${glJournalId}" text="${glJournalName}"><entity-find entity-name="mantle.ledger.transaction.GlJournal"><econdition field-name="isPosted" operator="not-equals" value="Y" or-null="true"/><order-by field-name="glJournalName"/></entity-find></entity-options></drop-down></default-field></field><field name="description"><default-field><text-area cols="80" rows="2"/></default-field></field><field name="invoiceId"><default-field title="Invoice ID"><text-line size="20"/><link url="editInvoice" text="${invoiceId?:''}" link-type="anchor"/></default-field></field><field name="paymentId"><default-field title="Payment ID"><text-line size="20"/><link url="editPayment" text="${paymentId?:''}" link-type="anchor"/></default-field></field><field name="paymentApplicationId"><default-field><text-line size="20"/></default-field></field><field name="finAccountTransId"><default-field><text-line size="20"/></default-field></field><field name="otherPartyId"><default-field title="Other Party ID"><text-line/></default-field></field><field name="voucherRef"><default-field><text-line size="20"/></default-field></field><field name="voucherDate"><default-field><date-time/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field-layout><fields-not-referenced/><field-row><field-ref name="invoiceId"/><field-ref name="paymentApplicationId"/></field-row><field-row><field-ref name="paymentId"/><field-ref name="finAccountTransId"/></field-row><field-row><field-ref name="otherPartyId"/></field-row><field-row><field-ref name="voucherRef"/><field-ref name="voucherDate"/></field-row><field-row><field-ref name="submitButton"/></field-row></field-layout></form-single></container-dialog><label text="WARNING: This GL Transaction is based on Asset Issuance ${acctgTrans.assetIssuanceId}, manual changes to Transaction Date, Amounts, etc may cause reconciliation exceptions or audit flags." type="p" style="text-danger" condition="acctgTrans.assetIssuanceId"/><label text="WARNING: This GL Transaction is based on Asset Receipt ${acctgTrans.assetReceiptId}, manual changes to Transaction Date, Amounts, etc may cause reconciliation exceptions or audit flags." type="p" style="text-danger" condition="acctgTrans.assetReceiptId"/><label text="WARNING: This GL Transaction is based on Physical Inventory ${acctgTrans.physicalInventoryId}, manual changes to Transaction Date, Amounts, etc may cause reconciliation exceptions or audit flags." type="p" style="text-danger" condition="acctgTrans.physicalInventoryId"/><label text="WARNING: This GL Transaction is based on Invoice ${acctgTrans.invoiceId}, manual changes to Transaction Date, Amounts, etc may cause reconciliation exceptions or audit flags." type="p" style="text-danger" condition="acctgTrans.invoiceId"/><label text="WARNING: This GL Transaction is based on Payment ${acctgTrans.paymentId}, manual changes to Transaction Date, Amounts, etc may cause reconciliation exceptions or audit flags." type="p" style="text-danger" condition="acctgTrans.paymentId"/><label text="WARNING: This GL Transaction is based on Payment Application ${acctgTrans.paymentApplicationId}, manual changes to Transaction Date, Amounts, etc may cause reconciliation exceptions or audit flags." type="p" style="text-danger" condition="acctgTrans.paymentApplicationId"/><label text="WARNING: This GL Transaction is based on Financial Account Transaction ${acctgTrans.finAccountTransId}, manual changes to Transaction Date, Amounts, etc may cause reconciliation exceptions or audit flags." type="p" style="text-danger" condition="acctgTrans.finAccountTransId"/></widgets><fail-widgets><link url="unpostAcctgTrans" text="Un-post Transaction" confirmation="Un-post transaction?"/><link url="postReverseAcctgTrans" text="Create Reverse Transaction (don't post)" parameter-map="[createOnly:'true']" condition="!acctgTrans.reversedByAcctgTransId"/><link url="postReverseAcctgTrans" text="Create and Post Reverse Transaction" condition="!acctgTrans.reverseOfAcctgTransId && !acctgTrans.reversedByAcctgTransId" confirmation="Create and post a new transaction that reverses this?"/><container-dialog id="UpdatePostedDialog" button-text="Update Transaction" width="900"><form-single name="UpdateAcctgTransPosted" map="acctgTrans" transition="updateAcctgTransPosted" extends="UpdateAcctgTrans"><field name="organizationPartyId"><default-field><ignored/></default-field></field><field name="transactionDate"><default-field><ignored/></default-field></field><field name="amountUomId"><default-field><ignored/></default-field></field><field name="originalCurrencyUomId"><default-field><ignored/></default-field></field><field name="invoiceId"><default-field title="Invoice ID"><text-line size="20"/><link url="editInvoice" text="${invoiceId?:''}" link-type="anchor"/></default-field></field><field name="paymentId"><default-field title="Payment ID"><text-line size="20"/><link url="editPayment" text="${paymentId?:''}" link-type="anchor"/></default-field></field><field name="paymentApplicationId"><default-field><text-line size="20"/></default-field></field><field name="finAccountTransId"><default-field><text-line size="20"/></default-field></field><field name="otherPartyId"><default-field title="Other Party ID"><text-line/></default-field></field><field name="voucherRef"><default-field><text-line size="20"/></default-field></field><field name="voucherDate"><default-field><date-time/></default-field></field></form-single></container-dialog></fail-widgets></section><container-row><row-col lg="1"><label text="ID" type="strong"/></row-col><row-col lg="3"><label text="${acctgTransId}" type="strong" style="${acctgTrans.reversedByAcctgTransId || acctgTrans.reverseOfAcctgTransId ? 'text-warning' : 'text-info'}"/></row-col><row-col lg="1"><label text="Organization" type="strong"/></row-col><row-col lg="3"><label text="${orgDetail.organizationName?:''} [${orgDetail.pseudoId}]" type="p"/></row-col><row-col lg="1"><label text="TX Type" type="strong"/></row-col><row-col lg="3"><label text="${typeEnum?.description?:''}"/></row-col></container-row><container-row><row-col lg="1"><label text="Journal" type="strong"/></row-col><row-col lg="3"><label text="${glJournal?.glJournalName?:''} [${acctgTrans.glJournalId?:''}]" type="p"/></row-col><row-col lg="1"><label text="Currency" type="strong"/></row-col><row-col lg="3"><label text="${amountUom?.description} [${amountUom?.uomId}]" type="p"/></row-col><row-col lg="1"><label text="Orig. Currency" type="strong"/></row-col><row-col lg="3"><label text="${origCurrencyAmountUom?.description?:''} [${origCurrencyAmountUom?.uomId?:''}]"/></row-col></container-row><container-row><row-col lg="1"><label text="TX Date" type="strong"/></row-col><row-col lg="3"><label text="${ec.l10n.format(acctgTrans.transactionDate, null)}"/></row-col><row-col lg="1"><label text="Is Posted" type="strong"/></row-col><row-col lg="3"><label text="${acctgTrans.isPosted}"/></row-col><row-col lg="1"><label text="Posted Date" type="strong"/></row-col><row-col lg="3"><label text="${ec.l10n.format(acctgTrans.postedDate, null)}"/></row-col></container-row><container-row><row-col lg="1"><label text="Invoice" type="strong"/></row-col><row-col lg="3"><link url="editInvoice" text="${acctgTrans.invoiceId?:''}" link-type="anchor" parameter-map="[invoiceId:acctgTrans.invoiceId]"/></row-col><row-col lg="1"><label text="Payment" type="strong"/></row-col><row-col lg="3"><link url="editPayment" text="${acctgTrans.paymentId?:''}" link-type="anchor" parameter-map="[paymentId:acctgTrans.paymentId]"/></row-col><row-col lg="1"><label text="Pmnt Appl" type="strong"/></row-col><row-col lg="3"><label text="${acctgTrans.paymentApplicationId?:''}"/></row-col></container-row><container-row><row-col lg="1"><label text="Shipment" type="strong"/></row-col><row-col lg="3"><link url="shipmentDetail" text="${acctgTrans.shipmentId?:''}" link-type="anchor" parameter-map="[shipmentId:acctgTrans.shipmentId]"/></row-col><row-col lg="1"><label text="Asset" type="strong"/></row-col><row-col lg="3"><link url="assetDetail" text="${acctgTrans.assetId?:''}" link-type="anchor" parameter-map="[assetId:acctgTrans.assetId]"/></row-col><row-col lg="1"><label text="Voucher Ref" type="strong"/></row-col><row-col lg="3"><label text="${acctgTrans.voucherRef?:''}"/></row-col></container-row><container-row><row-col lg="1"><label text="Fin Acct TX" type="strong"/></row-col><row-col lg="3"><label text="${acctgTrans.finAccountTransId?:''}"/></row-col><row-col lg="1"><label text="Other Party" type="strong"/></row-col><row-col lg="3"><label text="${otherDetail?.organizationName?:''}${otherDetail?.firstName?:''} ${otherDetail?.lastName?:''} [${otherDetail?.pseudoId?:''}]"/></row-col><row-col lg="1"><label text="Voucher Date" type="strong"/></row-col><row-col lg="3"><label text="${ec.l10n.format(acctgTrans.voucherDate, null)}"/></row-col></container-row><container-row><row-col lg="1"><label text="Description" type="strong"/></row-col><row-col lg="11"><label text="${acctgTrans.description?:''}" type="p"/></row-col></container-row><container-row><row-col lg="1"><label text="Reverse Of" type="strong"/></row-col><row-col lg="3"><link url="editTransaction" text="${acctgTrans.reverseOfAcctgTransId}" link-type="anchor-button" parameter-map="[acctgTransId:acctgTrans.reverseOfAcctgTransId]" condition="acctgTrans.reverseOfAcctgTransId"/></row-col><row-col lg="1"><label text="Reversed By" type="strong"/></row-col><row-col lg="3"><link url="editTransaction" text="${acctgTrans.reversedByAcctgTransId}" link-type="anchor-button" parameter-map="[acctgTransId:acctgTrans.reversedByAcctgTransId]" condition="acctgTrans.reversedByAcctgTransId"/></row-col></container-row><container-row><row-col lg="1"><label text="Debit" type="strong"/></row-col><row-col lg="3"><label text="${ec.l10n.formatCurrency(debitTotal, acctgTrans.amountUomId)}"/></row-col><row-col lg="1"><label text="Credit" type="strong"/></row-col><row-col lg="3"><label text="${ec.l10n.formatCurrency(creditTotal, acctgTrans.amountUomId)}"/></row-col></container-row><label text="&nbsp;" type="p" encode="false"/><container-box><box-header title="Transaction Entries"/><box-toolbar><container-dialog id="AddEntryDialog" button-text="Add Entry" condition="acctgTrans.isPosted != 'Y'"><form-single name="AddEntryForm" transition="createAcctgTransEntry"><field name="acctgTransId"><default-field><hidden/></default-field></field><field name="acctgTransEntrySeqId"><default-field><hidden/></default-field></field><field name="amount"><default-field><text-line size="8"/></default-field></field><field name="originalCurrencyAmount"><default-field title="Orig Currency Amt"><text-line size="8"/></default-field></field><field name="debitCreditFlag"><default-field title="Debit Credit"><drop-down><option key="D"/><option key="C"/></drop-down></default-field></field><field name="glAccountTypeEnumId"><default-field title="Entry Acct Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="GlAccountType"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="glAccountId"><default-field title="GL Account"><drop-down allow-empty="true"><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0" parameter-map="[onlyPostingAllowed:'true', organizationPartyId:organizationPartyId]"/></drop-down></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body-nopad><form-list name="EntryListForm" list="entryList" transition="updateAcctgTransEntry"><field name="acctgTransId"><default-field><hidden/></default-field></field><field name="acctgTransEntrySeqId"><default-field><hidden/></default-field></field><field name="amount" align="right"><conditional-field condition="acctgTrans.isPosted != 'Y'"><text-line size="12" format="#,##0.00##"/></conditional-field><default-field container-style="${debitCreditFlag == 'C' ? 'text-success' : 'text-info'}"><display currency-unit-field="acctgTrans.amountUomId"/></default-field></field><field name="originalCurrencyAmount" align="right"><conditional-field condition="acctgTrans.isPosted != 'Y'"><text-line size="10"/></conditional-field><default-field title="Orig Currency Amt"><display currency-unit-field="acctgTrans.originalCurrencyUomId"/></default-field></field><field name="debitCreditFlag"><conditional-field condition="acctgTrans.isPosted != 'Y'"><drop-down><option key="D"/><option key="C"/></drop-down></conditional-field><default-field title="Dbt Cdt" container-style="text-strong ${debitCreditFlag == 'C' ? 'text-success' : 'text-info'}"><display/></default-field></field><field name="glAccountTypeEnumId"><conditional-field condition="acctgTrans.isPosted != 'Y'"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="GlAccountType"/><set field="allowEmpty" value="true"/></widget-template-include></conditional-field><default-field title="Entry Acct Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="glAccountId"><conditional-field condition="acctgTrans.isPosted != 'Y'"><drop-down allow-empty="true"><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0" parameter-map="[onlyPostingAllowed:'true', organizationPartyId:organizationPartyId]"/></drop-down></conditional-field><default-field title="GL Account"><display-entity entity-name="mantle.ledger.account.GlAccount" text="GlAccountNameTemplate"/></default-field></field><field name="reconcileStatusId"><default-field title="Reconciled"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="invoiceItemSeqId"><default-field title="Invc Itm"><display/></default-field></field><field name="productId"><default-field title="Product"><link url="editProduct" entity-name="mantle.product.Product" text="ProductNameTemplate" link-type="anchor"/></default-field></field><field name="assetId"><default-field title="Asset"><link url="assetDetail" text="${assetId?:''}" link-type="anchor"/></default-field></field><field name="submitButton"><conditional-field condition="acctgTrans.isPosted != 'Y'" title="Update"><submit/></conditional-field><default-field title=""><dynamic-dialog id="MoveEntryDialog" button-text="Move" transition="MoveEntry"><parameter name="acctgTransId"/><parameter name="acctgTransEntrySeqId"/></dynamic-dialog></default-field></field><field name="removeLink"><conditional-field condition="acctgTrans.isPosted != 'Y'" title="Update"><link url="deleteAcctgTransEntry" text="Remove" confirmation="Really remove entry?"/></conditional-field><default-field title=""><display/></default-field></field><form-list-column><field-ref name="amount"/><field-ref name="originalCurrencyAmount"/></form-list-column><form-list-column><field-ref name="debitCreditFlag"/></form-list-column><form-list-column><field-ref name="glAccountId"/><field-ref name="glAccountTypeEnumId"/></form-list-column><form-list-column><field-ref name="reconcileStatusId"/></form-list-column><form-list-column><field-ref name="invoiceItemSeqId"/></form-list-column><form-list-column><field-ref name="productId"/></form-list-column><form-list-column><field-ref name="assetId"/></form-list-column><form-list-column><field-ref name="submitButton"/></form-list-column><form-list-column><field-ref name="removeLink"/></form-list-column></form-list></box-body-nopad></container-box><container-box><box-header title="Audit Log"/><box-body><form-list name="AuditLogList" list="auditLogList" skip-form="true"><entity-find entity-name="moqui.entity.EntityAuditLog" list="auditLogList"><econdition field-name="changedEntityName" operator="in" from="['mantle.ledger.transaction.AcctgTrans', 'mantle.ledger.transaction.AcctgTransEntry']"/><econdition field-name="pkPrimaryValue" from="acctgTransId"/><select-field field-name="changedEntityName"/><order-by field-name="-changedDate,pkSecondaryValue"/></entity-find><field name="changedDate"><default-field title="Date"><display/></default-field></field><field name="changedByUserId"><default-field title="User"><display-entity text="UsernameTemplate" entity-name="mantle.party.PersonWithUserAccount" key-field-name="userId"/></default-field></field><field name="pkSecondaryValue"><default-field title="Entry"><display/></default-field></field><field name="changedFieldName"><default-field title="Field"><display text="${org.moqui.util.StringUtilities.camelCaseToPretty(changedFieldName)}"/></default-field></field><field name="oldValueText"><default-field title="From"><display text="${ec.entity.formatFieldString(changedEntityName, changedFieldName, oldValueText)}"/></default-field></field><field name="newValueText"><default-field title="To"><display text="${ec.entity.formatFieldString(changedEntityName, changedFieldName, newValueText)}"/></default-field></field></form-list></box-body></container-box></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Transaction.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Transactions" default-menu-index="4"><subscreens default-item="FindTransaction"/><widgets><subscreens-active/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/FindJournal.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="GL Journals" default-menu-index="5"><transition name="createGlJournal"><service-call name="mantle.ledger.LedgerServices.create#GlJournal" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateGlJournal"><service-call name="mantle.ledger.LedgerServices.update#GlJournal" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="postGlJournal"><parameter name="glJournalId"/><service-call name="mantle.ledger.LedgerServices.post#GlJournal" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="findTransaction"><parameter name="glJournalId"/><default-response url="../Transaction/FindTransaction"/></transition><actions><entity-find entity-name="mantle.ledger.transaction.GlJournal" list="glJournalList"><search-form-inputs default-order-by="-glJournalId"/></entity-find></actions><widgets><container-dialog id="CreateTxDialog" button-text="New Journal"><form-single name="CreateGlJournal" transition="createGlJournal"><field name="glJournalName"><default-field title="Journal Name"><text-line size="40"/></default-field></field><field name="glJournalTypeEnumId"><default-field title="Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="GlJournalType"/></widget-template-include></default-field></field><field name="organizationPartyId"><default-field title="Organization"><drop-down><entity-options key="${partyId}" text="${organizationName?:''}${firstName?:''} ${lastName?:''} [${pseudoId}]"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="TransactionList" list="glJournalList" transition="updateGlJournal" header-dialog="true" select-columns="true" saved-finds="true" show-csv-button="true"><field name="glJournalId"><header-field title="ID" show-order-by="true"><text-find size="10" hide-options="true"/></header-field><default-field><display/></default-field></field><field name="glJournalName"><header-field title="Journal Name" show-order-by="true"><text-find size="20" hide-options="true"/></header-field><default-field><text-line size="30"/></default-field></field><field name="organizationPartyId"><header-field title="Organization"><drop-down allow-empty="true"><entity-options key="${partyId}" text="${organizationName?:''} ${firstName?:''} ${lastName?:''} [${pseudoId}]"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></header-field><default-field><display-entity entity-name="mantle.party.PartyDetail" also-hidden="false" key-field-name="partyId" text="${organizationName?:''}${firstName?:''} ${lastName?:''} [${pseudoId}]"/></default-field></field><field name="glJournalTypeEnumId"><header-field title="Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="GlJournalType"/><set field="allowEmpty" value="true"/></widget-template-include></header-field><default-field><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="GlJournalType"/></widget-template-include></default-field></field><field name="isPosted"><header-field title="Posted" show-order-by="true"><drop-down allow-empty="true"><option key="Y"/><option key="N"/></drop-down></header-field><default-field><display also-hidden="false"/></default-field></field><field name="postedDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display also-hidden="false"/></default-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field><default-field title="Update"><submit/></default-field></field><field name="postButton"><conditional-field condition="isPosted != 'Y' && glJournalTypeEnumId != 'GLJRNL_ERROR'"><link url="postGlJournal" text="Post##Accounting"/></conditional-field><default-field title=""><display text=" "/></default-field></field><field name="findTransactionLink"><header-field title=""/><default-field><link url="findTransaction" text="Transactions" link-type="anchor-button" parameter-map="[glJournalId:glJournalId]"/></default-field></field><form-list-column><field-ref name="glJournalId"/><field-ref name="glJournalName"/></form-list-column><form-list-column><field-ref name="organizationPartyId"/><field-ref name="glJournalTypeEnumId"/></form-list-column><form-list-column><field-ref name="isPosted"/><field-ref name="postedDate"/></form-list-column><form-list-column><field-ref name="submitButton"/></form-list-column><form-list-column><field-ref name="postButton"/><field-ref name="findTransactionLink"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/TimePeriod/FindTimePeriod.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><parameter name="partyId"/><parameter name="timePeriodTypeId"/><transition name="editTimePeriod"><default-response url="../EditTimePeriod"/></transition><transition name="viewPeriodGlAccounts"><default-response url="../ViewPeriodGlAccounts"/></transition><transition name="createTimePeriod"><service-call name="mantle.party.TimeServices.create#TimePeriod" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditTimePeriod"/></transition><transition name="createNextTimePeriod"><service-call name="mantle.party.TimeServices.create#TimePeriod" in-map="[previousPeriodId:previousPeriodId]" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createPreviousTimePeriod"><service-call name="mantle.party.TimeServices.create#TimePeriod" in-map="[nextPeriodId:nextPeriodId]" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getTimePeriodList" location="component://SimpleScreens/template/party/PartyTransitions.xml"/><widgets><container-dialog id="CreatePeriodDialog" button-text="Create First Period"><label text="Only create the first period in a series using this form. Use the Create Next Period buttons to create subsequent periods." type="p"/><label text="Create parent periods (years, quarters, etc) then create child periods from parent period screen. " type="p"/><form-single name="CreatePeriod" transition="createTimePeriod"><field name="partyId"><default-field title="Organization"><drop-down><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></default-field></field><field name="timePeriodTypeId"><default-field title="Type"><drop-down><entity-options key="${timePeriodTypeId}" text="${description}"><entity-find entity-name="mantle.party.time.TimePeriodType"><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="fromDate"><default-field><date-time type="date"/></default-field></field><field name="thruDate"><default-field tooltip="Optional, leave empty to calculate with from date and period type"><date-time type="date"/></default-field></field><field name="createBtn"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="TimePeriodList" list="timePeriodList" skip-form="true" header-dialog="true" select-columns="true" saved-finds="true" show-csv-button="true"><entity-find entity-name="mantle.party.time.TimePeriod" list="timePeriodList"><search-form-inputs default-order-by="-fromDate"/><select-field field-name="timePeriodId,timePeriodTypeId"/></entity-find><row-actions><entity-find entity-name="mantle.party.time.TimePeriod" list="nextTimePeriodList"><econdition field-name="previousPeriodId" from="timePeriodId"/></entity-find><set field="nextTimePeriod" from="nextTimePeriodList ? nextTimePeriodList[0] : null"/></row-actions><field name="partyId"><header-field title="Organization"><drop-down allow-empty="true"><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></header-field><default-field><display-entity entity-name="mantle.party.PartyDetail" also-hidden="false" key-field-name="partyId" text="PartyNameTemplate"/></default-field></field><field name="periodName"><header-field show-order-by="true"/><default-field><link url="editTimePeriod" text="${periodName}" link-type="anchor"/></default-field></field><field name="timePeriodTypeId"><header-field title="Type" show-order-by="true"><drop-down allow-multiple="true"><entity-options key="${timePeriodTypeId}" text="${description}"><entity-find entity-name="mantle.party.time.TimePeriodType"><order-by field-name="description"/></entity-find></entity-options></drop-down></header-field><default-field><display-entity entity-name="mantle.party.time.TimePeriodType"/></default-field></field><field name="periodNum"><header-field show-order-by="true"/><default-field><display format="####"/></default-field></field><field name="fromDate"><header-field show-order-by="true"/><default-field><display/></default-field></field><field name="thruDate"><header-field show-order-by="true"><date-find type="date"/></header-field><default-field><display/></default-field></field><field name="isClosed"><header-field title="Closed"><drop-down allow-empty="true"><option key="Y"/><option key="N"/></drop-down></header-field><default-field><display/></default-field></field><field name="parentPeriodId"><header-field title="Parent"><drop-down allow-empty="true"><dynamic-options transition="getTimePeriodList" server-search="true" min-length="0" depends-optional="true"><depends-on field="partyId"/></dynamic-options></drop-down></header-field><default-field><link url="editTimePeriod" text="${periodName} (${ec.l10n.localize('Closed##TimePeriod')}: ${isClosed})" entity-name="mantle.party.time.TimePeriod" parameter-map="[timePeriodId:parentPeriodId]" condition="parentPeriodId" link-type="anchor"/></default-field></field><field name="previousPeriodId"><header-field title="Previous"><drop-down allow-empty="true"><dynamic-options transition="getTimePeriodList" server-search="true" min-length="0" depends-optional="true"><depends-on field="partyId"/></dynamic-options></drop-down></header-field><default-field><link url="editTimePeriod" text="${periodName} (${ec.l10n.localize('Closed##TimePeriod')}: ${isClosed})" entity-name="mantle.party.time.TimePeriod" parameter-map="[timePeriodId:previousPeriodId]" condition="previousPeriodId" link-type="anchor"/><link url="createPreviousTimePeriod" text="Create Previous" condition="!previousPeriodId" parameter-map="[nextPeriodId:timePeriodId]" pass-through-parameters="true" confirmation="Really create previous period?"/></default-field></field><field name="nextPeriod"><default-field title="Next"><link url="editTimePeriod" text="${nextTimePeriod.periodName}" text-map="nextTimePeriod" parameter-map="[timePeriodId:nextTimePeriod.timePeriodId]" condition="nextTimePeriod != null" link-type="anchor"/><link url="createNextTimePeriod" text="Create Next" condition="nextTimePeriod == null" parameter-map="[previousPeriodId:timePeriodId]" pass-through-parameters="true" confirmation="Really create next period?"/></default-field></field><field name="accounts"><default-field><link url="viewPeriodGlAccounts" text="Accounts" condition="timePeriodTypeId?.startsWith('Fiscal')"/></default-field></field><field name="searchButton"><header-field title="Find"><submit/></header-field></field><form-list-column><field-ref name="partyId"/><field-ref name="periodName"/></form-list-column><form-list-column><field-ref name="timePeriodTypeId"/><field-ref name="periodNum"/></form-list-column><form-list-column><field-ref name="fromDate"/><field-ref name="thruDate"/></form-list-column><form-list-column><field-ref name="isClosed"/></form-list-column><form-list-column><field-ref name="parentPeriodId"/></form-list-column><form-list-column><field-ref name="previousPeriodId"/></form-list-column><form-list-column><field-ref name="nextPeriod"/></form-list-column><form-list-column><field-ref name="accounts"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/TimePeriod/EditTimePeriod.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Time Period" default-menu-index="1"><parameter name="timePeriodId" required="true"/><transition name="editTimePeriod"><default-response url="."/></transition><transition name="createTimePeriod"><service-call name="mantle.party.TimeServices.create#TimePeriod" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteTimePeriod"><service-call name="mantle.party.TimeServices.delete#TimePeriod" in-map="true" out-map="context" multi="parameter"/><actions><set field="timePeriodId" from="parentPeriodId ?: previousPeriodId"/></actions><conditional-response url="."><condition><expression><![CDATA[timePeriodId]]></expression></condition></conditional-response><default-response url="../FindTimePeriod"/></transition><transition name="createNextTimePeriod"><service-call name="mantle.party.TimeServices.create#TimePeriod" in-map="[previousPeriodId:previousPeriodId, thruDate:thruDate]" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createPreviousTimePeriod"><service-call name="mantle.party.TimeServices.create#TimePeriod" in-map="[nextPeriodId:nextPeriodId, fromDate:fromDate]" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><entity-find-one entity-name="mantle.party.time.TimePeriod" value-field="timePeriod"/><if condition="timePeriod == null"><return error="true" message="Could not find Period with ID ${timePeriodId}"/></if><set field="timePeriodType" from="timePeriod.type"/><entity-find-one entity-name="mantle.party.time.TimePeriod" value-field="parentPeriod"><field-map field-name="timePeriodId" from="timePeriod.parentPeriodId"/></entity-find-one><entity-find-one entity-name="mantle.party.time.TimePeriod" value-field="previousPeriod"><field-map field-name="timePeriodId" from="timePeriod.previousPeriodId"/></entity-find-one><entity-find entity-name="mantle.party.time.TimePeriod" list="nextTimePeriodList"><econdition field-name="previousPeriodId" from="timePeriodId"/></entity-find><set field="nextPeriod" from="nextTimePeriodList ? nextTimePeriodList[0] : null"/><entity-find entity-name="mantle.party.time.TimePeriod" list="childTimePeriodList"><econdition field-name="parentPeriodId" from="timePeriodId"/><order-by field-name="periodNum"/></entity-find><entity-find entity-name="mantle.party.time.TimePeriodType" list="childTypeFindList"><econdition field-name="parentPeriodTypeId" from="timePeriod.timePeriodTypeId"/><order-by field-name="description"/></entity-find><entity-find entity-name="mantle.party.time.TimePeriodType" list="grandchildTypeFindList"><econdition field-name="parentPeriodTypeId" operator="in" from="childTypeFindList*.timePeriodTypeId"/><order-by field-name="description"/></entity-find><set field="childPeriodTypeList" from="new ArrayList(childTypeFindList)"/><script><![CDATA[childPeriodTypeList.addAll(grandchildTypeFindList)]]></script></actions><widgets><link url="editTimePeriod" text="Parent: ${parentPeriod.periodName}" parameter-map="[timePeriodId:parentPeriod.timePeriodId]" condition="parentPeriod != null"/><link url="editTimePeriod" text="Previous: ${previousPeriod.periodName}" parameter-map="[timePeriodId:previousPeriod.timePeriodId]" condition="previousPeriod != null"/><link url="editTimePeriod" text="Next: ${nextPeriod.periodName}" parameter-map="[timePeriodId:nextPeriod.timePeriodId]" condition="nextPeriod != null"/><container-dialog id="CreateNextDialog" button-text="Create Next Period" condition="nextPeriod == null"><form-single name="CreateNextPeriod" transition="createNextTimePeriod"><field name="previousPeriodId" from="timePeriodId"><default-field><hidden/></default-field></field><field name="timePeriodTypeId"><default-field title="Type"><display text="${description}" text-map="timePeriodType"/></default-field></field><field name="fromDate" from="timePeriod.thruDate + 1"><default-field><display/></default-field></field><field name="thruDate"><default-field tooltip="Optional, leave empty to calculate with from date and period type"><date-time type="date"/></default-field></field><field name="createBtn"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><link url="editTimePeriod" text="Previous: ${previousPeriod.periodName}" parameter-map="[timePeriodId:previousPeriod.timePeriodId]" condition="previousPeriod != null"/><container-dialog id="CreatePreviousDialog" button-text="Create Previous Period" condition="previousPeriod == null"><form-single name="CreatePreviousPeriod" transition="createPreviousTimePeriod"><field name="nextPeriodId" from="timePeriodId"><default-field><hidden/></default-field></field><field name="timePeriodTypeId"><default-field title="Type"><display text="${description}" text-map="timePeriodType"/></default-field></field><field name="fromDate"><default-field tooltip="Optional, leave empty to calculate with thru date and period type"><date-time type="date"/></default-field></field><field name="thruDate" from="timePeriod.fromDate - 1"><default-field><display/></default-field></field><field name="createBtn"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><link url="deleteTimePeriod" text="Delete Period" btn-type="danger" confirmation="Delete period ${timePeriod.periodName}?" parameter-map="[timePeriodId:timePeriodId, parentPeriodId:timePeriod.parentPeriodId, previousPeriodId:timePeriod.previousPeriodId]" condition="nextPeriod == null && !childTimePeriodList && timePeriod.isClosed != 'Y'"/><container-row><row-col md="5"><form-single name="ViewTimePeriod" map="timePeriod"><field name="partyId"><default-field><display-entity entity-name="mantle.party.PartyDetail" also-hidden="false" key-field-name="partyId" text="${organizationName?:''} ${firstName?:''} ${lastName?:''} [${pseudoId}]"/></default-field></field><field name="periodName"><default-field><display/></default-field></field><field name="timePeriodTypeId"><default-field title="Type"><display-entity entity-name="mantle.party.time.TimePeriodType"/></default-field></field><field name="periodNum"><default-field><display format="####"/></default-field></field><field name="fromDate"><default-field><display/></default-field></field><field name="thruDate"><default-field><display/></default-field></field><field name="isClosed"><default-field title="Closed"><display/></default-field></field></form-single></row-col><row-col md="7"><container-box><box-header title="Child Periods"/><box-toolbar><container-dialog id="CreateChildDialog" button-text="Create First Child" condition="!childTimePeriodList && childPeriodTypeList"><form-single name="CreateChild" transition="createTimePeriod"><field name="parentPeriodId" from="timePeriodId"><default-field><hidden/></default-field></field><field name="partyId" from="timePeriod.partyId"><default-field><hidden/></default-field></field><field name="fromDate" from="timePeriod.fromDate"><default-field><display/></default-field></field><field name="periodNum" from="1"><default-field><display/></default-field></field><field name="timePeriodTypeId"><default-field title="Type"><drop-down><list-options list="childPeriodTypeList" key="${timePeriodTypeId}" text="${description}"/></drop-down></default-field></field><field name="thruDate"><default-field tooltip="Optional, leave empty to calculate with from date and period type"><date-time type="date"/></default-field></field><field name="createBtn"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body-nopad><form-list name="TimePeriodList" list="childTimePeriodList" skip-form="true"><field name="periodNum"><default-field><display format="####"/></default-field></field><field name="periodName"><default-field><link url="editTimePeriod" text="${periodName}" link-type="anchor"/></default-field></field><field name="fromDate"><default-field><display/></default-field></field><field name="thruDate"><default-field><display/></default-field></field><field name="isClosed"><default-field title="Closed"><display/></default-field></field></form-list></box-body-nopad></container-box></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/TimePeriod/ViewPeriodGlAccounts.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Accounts" default-menu-index="2"><parameter name="timePeriodId" required="true"/><transition name="postFaDepreciations"><service-call name="mantle.ledger.AssetAutoPostServices.calculateAndPost#AllFixedAssetDepreciations" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="recalculateAllAmounts"><service-call name="mantle.ledger.LedgerServices.recalculate#GlAccountOrgSummaries" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="recalculateAmounts"><service-call name="mantle.ledger.LedgerServices.recalculate#GlAccountOrgTimePeriodAmounts" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="closePeriod" begin-transaction="false"><service-call name="mantle.ledger.LedgerServices.close#FinancialTimePeriod" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="reopenPeriod"><service-call name="mantle.ledger.LedgerServices.reopen#FinancialTimePeriod" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createPeriodCloseAcctgTrans"><service-call name="mantle.ledger.LedgerServices.create#PeriodCloseAcctgTrans" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><entity-find-one entity-name="mantle.party.time.TimePeriod" value-field="timePeriod"/><set field="timePeriodType" from="timePeriod.type"/><if condition="timePeriodType?.periodPurposeEnumId != 'Fiscal'"><return error="true" message="This screen is for Fiscal periods only"/></if><set field="organizationPartyId" from="timePeriod.partyId"/><service-call name="mantle.ledger.LedgerServices.find#PartyAcctgPreference" in-map="[organizationPartyId:timePeriod.partyId]" out-map="context"/><set field="glAccountCodeMask" from="partyAcctgPreference?.glAccountCodeMask ?: ec.user.getPreference('GlAccountCodeMask')"/><set field="accountCodeFormatter" from="masker(glAccountCodeMask, '0')"/><set field="incomeStmtTopIds" from="['REVENUE', 'COST_OF_SALES', 'INCOME', 'EXPENSE', 'NON_OP_EXPENSE']"/><set field="incomeStmtClassIds" from="new HashSet()"/><iterate list="incomeStmtTopIds" entry="incomeStmtTopId"><service-call name="org.moqui.impl.BasicServices.find#EnumerationByParent" out-map="incStmtClassOut" out-map-add-to-existing="false" in-map="[parentEnumId:incomeStmtTopId, includeParent:true, includeNested:true]"/><script><![CDATA[if (incStmtClassOut.enumIdSet) incomeStmtClassIds.addAll(incStmtClassOut.enumIdSet)]]></script></iterate></actions><widgets><label text="Accounts for ${timePeriod.periodName} [${timePeriod.timePeriodId}]" type="h3"/><link url="recalculateAllAmounts" text="Recalc All" parameter-map="[organizationPartyId:timePeriod.partyId]"/><section name="PeriodCloseSection" condition="timePeriod.isClosed == 'Y'"><widgets><label text="Period Closed" type="h4"/><link url="reopenPeriod" text="Reopen Period" confirmation="Reopen period ${ec.resource.expand('TimePeriodNameTemplate','',timePeriod)}?" condition="ec.user.hasPermission('FISCAL_REOPEN')"/></widgets><fail-widgets><link url="recalculateAmounts" text="Recalc Period" parameter-map="[timePeriodId:timePeriodId]"/><link url="postFaDepreciations" text="Post Depreciation"/><link url="closePeriod" text="Close Period" confirmation="Close period ${ec.resource.expand('TimePeriodNameTemplate','',timePeriod)}?"/><link url="closePeriod" text="Close Period + Depends" parameter-map="[closePrevious:'true', closeChildren:'true']" confirmation="Close period ${ec.resource.expand('TimePeriodNameTemplate','',timePeriod)} plus any previous or child periods that are not closed?"/></fail-widgets></section><container-dialog id="ClosingTransDialog" button-text="Net Income Closing Transactions"><label text="Creates a transaction for each income statement account class (Revenue, Cost of Sales, Expense, Non-Operating Income, Non-Operating Expense)" type="p"/><label text="This can be run at any time, but best after a period is closed (Period Close type transactions may be posted after a period is closed)" type="p"/><form-single name="ClosingTransForm" transition="createPeriodCloseAcctgTrans"><field name="timePeriodId"><default-field><hidden/></default-field></field><field name="postTransactions"><default-field><drop-down><option key="true" text="Yes"/><option key="false" text="No"/></drop-down></default-field></field><field name="glJournalId"><default-field title="Journal"><drop-down allow-empty="true"><entity-options key="${glJournalId}" text="${glJournalName} [${glJournalId}]"><entity-find entity-name="mantle.ledger.transaction.GlJournal"><econdition field-name="organizationPartyId" or-null="true"/><econdition field-name="isPosted" value="N" or-null="true"/><econdition field-name="glJournalTypeEnumId" operator="not-equals" value="GLJRNL_ERROR"/><order-by field-name="glJournalName"/></entity-find></entity-options></drop-down></default-field></field><field name="netIncomeGlAccountId"><default-field title="Net Income Account"><drop-down><entity-options key="${glAccountId}" text="GlAccountNameTemplate"><entity-find entity-name="mantle.ledger.account.GlAccount"><econdition field-name="glAccountClassEnumId" operator="in" value="NET_INCOME,RETAINED_EARNINGS"/><order-by field-name="glAccountClassEnumId,accountCode"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="PeriodGlAccountList" list="gaotpList" skip-form="true" show-csv-button="true" show-xlsx-button="true"><entity-find entity-name="mantle.ledger.account.GlAccountOrgTimePeriod" list="gaotpList"><econdition field-name="timePeriodId"/><order-by field-name="glAccountId"/></entity-find><row-actions><entity-find-one entity-name="mantle.ledger.account.GlAccount" value-field="glAccount"/><set field="rowStyle" from="incomeStmtClassIds.contains(glAccount?.glAccountClassEnumId) ? 'text-success' : ''"/></row-actions><field name="glAccountId"><default-field title="GL Account"><display text="GlAccountNameTemplate" text-map="glAccount" style="${rowStyle}"/></default-field></field><field name="postedDebits" align="right"><default-field title="Debits"><display format="#,##0.00"/></default-field></field><field name="postedCredits" align="right"><default-field title="Credits"><display format="#,##0.00"/></default-field></field><field name="postedDebitsNoClosing" align="right"><default-field title="Deb - Close"><display format="#,##0.00"/></default-field></field><field name="postedCreditsNoClosing" align="right"><default-field title="Cred - Close"><display format="#,##0.00"/></default-field></field><field name="beginningBalance" align="right"><default-field title="Beginning"><display format="#,##0.00" style="${rowStyle}"/></default-field></field><field name="endingBalance" align="right"><default-field title="Ending"><display format="#,##0.00" style="${rowStyle}"/></default-field></field><field name="balanceLastUpdated" align="right"><default-field title="Amounts Updated"><display/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/TimePeriod.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-index="6"><subscreens default-item="FindTimePeriod"/><widgets><subscreens-panel id="TimePeriodPanel" type="tab"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/GlAccount/FindGlAccount.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="editGlAccount"><default-response url="../EditGlAccount"/></transition><transition name="glAccountTree"><default-response url="../GlAccountTree"/></transition><transition name="createGlAccount"><service-call name="mantle.ledger.LedgerServices.create#GlAccount" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditGlAccount"/></transition><transition-include name="getGlAccountListPaginated" location="component://SimpleScreens/template/account/AccountTransitions.xml"/><actions><entity-find entity-name="mantle.ledger.account.GlAccount" list="glAccountList"><search-form-inputs default-order-by="accountCode"/></entity-find><set field="glAccountCodeMask" from="ec.user.getPreference('GlAccountCodeMask')"/><set field="accountCodeFormatter" from="masker(glAccountCodeMask, '0')"/></actions><widgets><link url="glAccountTree" text="Account Tree"/><container-dialog id="NewGlAccountDialog" button-text="New GL Account"><form-single name="NewGlAccountForm" transition="createGlAccount"><field name="parentGlAccountId"><default-field title="Parent Account"><drop-down allow-empty="true"><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0"/></drop-down></default-field></field><field name="accountCode"><default-field tooltip="Enter digits only, masking is added on display"><text-line size="20"/></default-field></field><field name="accountName"><default-field><text-line size="40"/></default-field></field><field name="glAccountClassEnumId"><default-field title="Account Class"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="GlAccountClass"/></widget-template-include></default-field></field><field name="glAccountTypeEnumId"><default-field title="Account Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="GlAccountType"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="GlAccountListForm" list="glAccountList" skip-form="true" header-dialog="true" show-csv-button="true"><field name="accountCode"><header-field show-order-by="case-insensitive"><text-find size="10" hide-options="true"/></header-field><default-field><link url="editGlAccount" text="${accountCodeFormatter != null ? accountCodeFormatter.valueToString(accountCode) : accountCode}" link-type="anchor"/></default-field></field><field name="accountName"><header-field title="Name" show-order-by="case-insensitive"><text-find size="15" hide-options="true"/></header-field><default-field><link url="editGlAccount" text="${accountName}" link-type="anchor"/></default-field></field><field name="parentGlAccountId"><default-field title="Parent Account"><link url="editGlAccount" entity-name="mantle.ledger.account.GlAccount" link-type="anchor" condition="parentGlAccountId" parameter-map="[glAccountId:parentGlAccountId]" text="GlAccountNameTemplate"/></default-field></field><field name="glAccountTypeEnumId"><header-field title="Account Type" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="GlAccountType"/><set field="allowEmpty" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="glAccountClassEnumId"><header-field title="Account Class" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="GlAccountClass"/><set field="allowEmpty" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/GlAccount/GlAccountTree.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="editGlAccount"><default-response url="../EditGlAccount"/></transition><widgets><tree name="AccountTree"><tree-node name="AccountNode"><link url="editGlAccount" text="${accountCodeFormatter != null ? accountCodeFormatter.valueToString(nodeList_entry.accountCode) : nodeList_entry.accountCode}: ${nodeList_entry.accountName} (${nodeList_entry.classEnum?.description ?: 'No Class'})${nodeList_entry.disallowPosting ? (' ' + ec.l10n.localize('Non-Posting')) : ''}" id="${treeNodeId == '#' ? '' : treeNodeId + '/'}${nodeList_entry.glAccountId}"><parameter name="glAccountId" from="nodeList_entry.glAccountId"/></link><tree-sub-node node-name="AccountNode" list="childAccounts"><actions><set field="parentGlAccountId" from="treeNodeId.split('/').last()"/><entity-find entity-name="mantle.ledger.account.GlAccount" list="childAccounts"><econdition field-name="parentGlAccountId"/><order-by field-name="accountCode"/></entity-find><set field="glAccountCodeMask" from="ec.user.getPreference('GlAccountCodeMask')"/><set field="accountCodeFormatter" from="masker(glAccountCodeMask, '0')"/></actions></tree-sub-node></tree-node><tree-sub-node node-name="AccountNode" list="topLevelAccounts"><actions><entity-find entity-name="mantle.ledger.account.GlAccount" list="topLevelAccounts"><econdition field-name="parentGlAccountId" from="null"/><order-by field-name="accountCode"/></entity-find><set field="glAccountCodeMask" from="ec.user.getPreference('GlAccountCodeMask')"/><set field="accountCodeFormatter" from="masker(glAccountCodeMask, '0')"/></actions></tree-sub-node></tree></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/GlAccount/EditGlAccount.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="GL Account" default-menu-index="1"><parameter name="glAccountId" required="true"/><transition name="editGlAccount"><default-response url="."/></transition><transition name="updateGlAccount"><service-call name="update#mantle.ledger.account.GlAccount" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createGlAccountOrganization"><service-call name="create#mantle.ledger.account.GlAccountOrganization" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getGlAccountListPaginated" location="component://SimpleScreens/template/account/AccountTransitions.xml"/><actions><entity-find-one entity-name="mantle.ledger.account.GlAccount" value-field="glAccount"/><entity-find entity-name="mantle.ledger.account.GlAccountAndOrganization" list="glaoList"><econdition field-name="glAccountId"/><order-by field-name="organizationName"/></entity-find></actions><widgets><container-row><row-col md="6"><form-single name="EditGlAccountForm" transition="updateGlAccount" map="glAccount"><field name="glAccountId"><default-field><hidden/></default-field></field><field name="parentGlAccountId"><default-field title="Parent Account"/></field><field name="parentGlAccountId"><default-field title="Parent Account"><drop-down allow-empty="true"><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0"/></drop-down><link url="editGlAccount" text="Edit Parent Account" parameter-map="[glAccountId:glAccount.parentGlAccountId]" link-type="anchor" condition="glAccount.parentGlAccountId"/></default-field></field><field name="accountCode"><default-field><text-line size="20"/></default-field></field><field name="accountName"><default-field><text-line size="40"/></default-field></field><field name="glAccountTypeEnumId"><default-field title="Account Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="GlAccountType"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="glAccountClassEnumId"><default-field title="Account Class"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="GlAccountClass"/></widget-template-include></default-field></field><field name="disallowPosting"><default-field><drop-down allow-empty="true"><option key="Y"/><option key="N"/></drop-down></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></row-col><row-col md="6"><container-box><box-header title="Organizations with Account ${glAccount.accountCode}"/><box-toolbar><container-dialog id="NewGlAccountOrgDialog" button-text="Add Organization"><form-single name="NewGlAccountOrgForm" transition="createGlAccountOrganization"><field name="glAccountId"><default-field><hidden/></default-field></field><field name="organizationPartyId"><default-field><drop-down><entity-options key="${partyId}" text="${organizationName?:''} ${firstName?:''} ${lastName?:''} [${pseudoId}]"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body-nopad><form-list name="GlAccountOrgList" list="glaoList" skip-form="true"><row-actions><service-call name="mantle.ledger.LedgerServices.find#PartyAcctgPreference" in-map="context" out-map="context"/></row-actions><field name="organizationPartyId"><default-field title="Organization"><display text="${organizationName?:''}"/></default-field></field><field name="postedBalance"><default-field><display currency-unit-field="partyAcctgPreference?.baseCurrencyUomId"/></default-field></field></form-list></box-body-nopad></container-box></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/GlAccount.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="GL Accounts" default-menu-index="10"><subscreens default-item="FindGlAccount"/><widgets><subscreens-active/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Budget/FindBudget.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" default-menu-title="Budgets"><transition name="editBudget"><default-response url="../EditBudget"/></transition><transition name="createBudget"><service-call name="mantle.other.BudgetServices.create#Budget" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditBudget"/><error-response url="."/></transition><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition-include name="getOrgFiscalPeriods" location="component://SimpleScreens/template/party/PartyTransitions.xml"/><widgets><container-box><box-header title="Budgets"/><box-toolbar><container-dialog id="NewBudgetDialog" button-text="New Budget"><form-single name="NewBudgetForm" transition="createBudget"><field name="budgetTypeEnumId"><default-field title="Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="BudgetType"/><set field="noCurrentSelectedKey" value="BudgetOperating"/></widget-template-include></default-field></field><field name="organizationPartyId"><default-field title="Organization"><drop-down><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="partyId" from="activeOrgId" ignore="!activeOrgId"/><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName,firstName,lastName"/></entity-find></entity-options></drop-down></default-field></field><field name="timePeriodId"><default-field title="Time Period"><drop-down><dynamic-options transition="getOrgFiscalPeriods" value-field="timePeriodId" label-field="periodName" parameter-map="[timePeriodTypeId:'FiscalYear']"><depends-on field="organizationPartyId"/></dynamic-options></drop-down></default-field></field><field name="subTimePeriodTypeId"><default-field title="Sub Period Type"><drop-down allow-empty="true" no-current-selected-key="FiscalMonth"><option key="FiscalMonth" text="Month"/><option key="FiscalQuarter" text="Quarter"/></drop-down></default-field></field><field name="description"><default-field><text-line size="50"/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body-nopad><form-list name="BudgetList" list="budgetList" skip-form="true" header-dialog="true"><entity-find entity-name="mantle.other.budget.BudgetAndTimePeriod" list="budgetList"><search-form-inputs default-order-by="-thruDate"/></entity-find><field name="budgetId"><header-field title="Budget" show-order-by="true"><text-line size="6"/></header-field><default-field><link url="editBudget" text="${budgetId}" link-type="anchor"/></default-field></field><field name="description"><header-field show-order-by="true"><text-find/></header-field><default-field><link url="editBudget" text="${description}" link-type="anchor"/></default-field></field><field name="budgetTypeEnumId"><header-field title="Type" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="BudgetType"/><set field="allowEmpty" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="partyId"><header-field title="Organization"><drop-down allow-empty="true"><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="partyId" from="activeOrgId" ignore="!activeOrgId"/><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName,firstName,lastName"/></entity-find></entity-options></drop-down></header-field><default-field><link url="editParty" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" link-type="anchor"/></default-field></field><field name="periodName"><default-field><display/></default-field></field><field name="fromDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="thruDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="findButton"><header-field title="Find"><submit/></header-field></field></form-list></box-body-nopad></container-box></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Budget/EditBudget.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-index="1" default-menu-title="Budget"><parameter name="budgetId" required="true"/><transition name="updateBudget"><service-call name="update#mantle.other.budget.Budget" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition-include name="getOrgFiscalPeriods" location="component://SimpleScreens/template/party/PartyTransitions.xml"/><actions><entity-find-one entity-name="mantle.other.budget.BudgetAndTimePeriod" value-field="budget"/></actions><widgets><container-box><box-header title="Budget #${budgetId}"/><box-toolbar/><box-body><form-single name="UpdateBudgetForm" transition="updateBudget" map="budget"><field name="budgetTypeEnumId"><default-field title="Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="BudgetType"/><set field="noCurrentSelectedKey" value="BudgetOperating"/></widget-template-include></default-field></field><field name="partyId"><default-field title="Organization"><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameTemplate"/></default-field></field><field name="timePeriodId"><default-field title="Time Period"><drop-down><dynamic-options transition="getOrgFiscalPeriods" value-field="timePeriodId" label-field="periodName" parameter-map="[organizationPartyId:partyId, timePeriodTypeId:'FiscalYear']"/></drop-down></default-field></field><field name="subTimePeriodTypeId"><default-field title="Sub Period Type"><display-entity entity-name="mantle.party.time.TimePeriodType"/></default-field></field><field name="description"><default-field><text-line size="60"/></default-field></field><field name="comments"><default-field><text-area cols="100" rows="6"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></box-body></container-box></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Budget/BudgetAccountsEntry.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-index="2" default-menu-title="Accounts Entry"><parameter name="budgetId" from="budgetId ?: budgetId_0" required="true"/><transition name="storeBudgetItem"><service-call name="mantle.other.BudgetServices.store#BudgetItemsSubPeriods" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="budgetAccountDetail"><default-response url="../BudgetAccountDetail"/></transition><transition-include name="getGlAccountList" location="component://SimpleScreens/template/account/AccountTransitions.xml"/><actions><set field="pageSize" from="pageSize ?: '30'"/><service-call name="mantle.other.BudgetServices.get#BudgetItemsAccountsSubPeriods" in-map="context" out-map="context"/></actions><widgets><form-list name="GlAccountBudgetList" list="glAccountList" transition="storeBudgetItem" multi="true" header-dialog="true"><entity-find entity-name="mantle.ledger.account.GlAccountAndOrganization" list="glAccountList"><search-form-inputs default-order-by="accountCode"/><econdition field-name="organizationPartyId" from="timePeriod?.partyId" ignore-if-empty="true"/><econdition field-name="glAccountClassEnumId" operator="in" from="expenseClassEnumIds"/><select-field field-name="glAccountId,accountCode,accountName"/></entity-find><row-actions><set field="curBiList" from="budgetItemsByGlId.get(glAccountId)"/><set field="amountMain" from="curBiList?.get(0)?.amount"/><set field="subPerTotal" from="0.0"/><script><![CDATA[if (curBiList) for (int i = 1; i < 13; i++) subPerTotal += (curBiList.get(i)?.amount ?: BigDecimal.ZERO)]]></script></row-actions><hidden-parameters><parameter name="budgetId"/></hidden-parameters><field name="glAccountId"><default-field><hidden/></default-field></field><field name="accountCode"><header-field title="GL Code" show-order-by="true"><text-find size="12" hide-options="true"/></header-field><default-field><display text="${accountCodeFormatter != null ? accountCodeFormatter.valueToString(accountCode) : accountCode}"/></default-field></field><field name="accountName"><header-field title="Account Name" show-order-by="true"><text-find hide-options="true"/></header-field><default-field><display/></default-field></field><field name="amountMain" align="right"><default-field title="Main"><text-line size="9"/><label text="Periods: ${ec.l10n.format(subPerTotal, '')}" condition="amountMain && subPerTotal && amountMain != subPerTotal" style="text-warning"/></default-field></field><field name="amountPer1" from="curBiList?.get(1)?.amount" align="right"><default-field title="Per 1"><text-line size="6"/></default-field></field><field name="amountPer2" from="curBiList?.get(2)?.amount" align="right" hide="subTimePeriodSize < 2"><default-field title="Per 2"><text-line size="6"/></default-field></field><field name="amountPer3" from="curBiList?.get(3)?.amount" align="right" hide="subTimePeriodSize < 3"><default-field title="Per 3"><text-line size="6"/></default-field></field><field name="amountPer4" from="curBiList?.get(4)?.amount" align="right" hide="subTimePeriodSize < 4"><default-field title="Per 4"><text-line size="6"/></default-field></field><field name="amountPer5" from="curBiList?.get(5)?.amount" align="right" hide="subTimePeriodSize < 5"><default-field title="Per 5"><text-line size="6"/></default-field></field><field name="amountPer6" from="curBiList?.get(6)?.amount" align="right" hide="subTimePeriodSize < 6"><default-field title="Per 6"><text-line size="6"/></default-field></field><field name="amountPer7" from="curBiList?.get(7)?.amount" align="right" hide="subTimePeriodSize < 7"><default-field title="Per 7"><text-line size="6"/></default-field></field><field name="amountPer8" from="curBiList?.get(8)?.amount" align="right" hide="subTimePeriodSize < 8"><default-field title="Per 8"><text-line size="6"/></default-field></field><field name="amountPer9" from="curBiList?.get(9)?.amount" align="right" hide="subTimePeriodSize < 9"><default-field title="Per 9"><text-line size="6"/></default-field></field><field name="amountPer10" from="curBiList?.get(10)?.amount" align="right" hide="subTimePeriodSize < 10"><default-field title="Per 10"><text-line size="6"/></default-field></field><field name="amountPer11" from="curBiList?.get(11)?.amount" align="right" hide="subTimePeriodSize < 11"><default-field title="Per 11"><text-line size="6"/></default-field></field><field name="amountPer12" from="curBiList?.get(12)?.amount" align="right" hide="subTimePeriodSize < 12"><default-field title="Per 12"><text-line size="6"/></default-field></field><field name="findButton"><header-field title="Find"><submit/></header-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Budget/EditBudgetItems.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-index="3" default-menu-title="Items List"><parameter name="budgetId" from="budgetId ?: budgetId_0" required="true"/><transition name="createBudgetItem"><service-call name="create#mantle.other.budget.BudgetItem" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateBudgetItem"><service-call name="update#mantle.other.budget.BudgetItem" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteBudgetItem"><service-call name="delete#mantle.other.budget.BudgetItem" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getGlAccountListPaginated" location="component://SimpleScreens/template/account/AccountTransitions.xml"/><actions><entity-find-one entity-name="mantle.other.budget.Budget" value-field="budget"/><set field="timePeriod" from="budget.timePeriod"/><if condition="budget.timePeriodId && budget.subTimePeriodTypeId"><service-call name="mantle.party.TimeServices.get#DescendantPeriods" out-map="subPeriodOut" in-map="[parentPeriodId:budget.timePeriodId, timePeriodTypeId:budget.subTimePeriodTypeId, createMissing:true]"/><set field="subTimePeriodList" from="subPeriodOut.timePeriodList"/></if></actions><widgets><container-box><box-header title="Items for Budget #${budgetId}"/><box-toolbar><container-dialog id="AddItemDialog" button-text="Add Item"><form-single name="AddItemForm" transition="createBudgetItem"><field name="budgetId"><default-field><hidden/></default-field></field><field name="glAccountId"><default-field title="GL Account"><drop-down allow-empty="true"><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0" parameter-map="[organizationPartyId:timePeriod?.partyId]"/></drop-down></default-field></field><field name="amount"><default-field><text-line size="12"/></default-field></field><field name="subTimePeriodId"><conditional-field condition="subTimePeriodList" title="Sub-Period"><drop-down allow-empty="true"><list-options list="subTimePeriodList" key="${timePeriodId}" text="${periodNum} - ${periodName}"/></drop-down></conditional-field><default-field><ignored/></default-field></field><field name="purpose"><default-field><text-line size="50"/></default-field></field><field name="submitButton"><default-field title="Add Item"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="BudgetItemList" list="budgetItemList" transition="updateBudgetItem" header-dialog="true" saved-finds="true" show-csv-button="true"><entity-find entity-name="mantle.other.budget.BudgetItem" list="budgetItemList"><search-form-inputs default-order-by="budgetItemSeqId"/><econdition field-name="budgetId"/></entity-find><field name="budgetId"><header-field><hidden/></header-field><default-field><hidden/></default-field></field><field name="budgetItemSeqId"><header-field title="Item" show-order-by="true"/><default-field><link url="../BudgetItemDetail" text="${budgetItemSeqId}" link-type="anchor"/></default-field></field><field name="glAccountId"><header-field title="GL Account"><drop-down allow-empty="true"><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0" parameter-map="[organizationPartyId:timePeriod?.partyId]"/></drop-down></header-field><default-field><display-entity entity-name="mantle.ledger.account.GlAccount" text="GlAccountNameTemplate"/></default-field></field><field name="amount" align="right"><header-field show-order-by="true"><range-find size="12"/></header-field><default-field><display currency-unit-field="budget.currencyUomId"/></default-field></field><field name="subTimePeriodId"><header-field title="Sub-Period"><drop-down allow-empty="true" allow-multiple="true"><list-options list="subTimePeriodList" key="${timePeriodId}" text="${periodNum} - ${periodName}"/></drop-down></header-field><default-field><display-entity entity-name="mantle.party.time.TimePeriod" text="${periodNum} - ${periodName}"/></default-field></field><field name="purpose"><header-field show-order-by="true"><text-find size="20" hide-options="true"/></header-field><default-field><display/></default-field></field><field name="deleteButton"><default-field title=""><link url="deleteBudgetItem" text="X" confirmation="Really delete?" parameter-map="[budgetId:budgetId, budgetItemSeqId:budgetItemSeqId]"/></default-field></field></form-list></box-body></container-box></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Budget/BudgetReport.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-index="15" default-menu-title="Expense Report"><parameter name="budgetId" required="true"/><actions><service-call name="mantle.other.BudgetReportServices.run#BudgetExpenseReport" in-map="context" out-map="context"/></actions><widgets><form-list name="GlAccountBudgetList" list="glAccountInfoList" header-dialog="true" skip-form="true" show-csv-button="true" show-xlsx-button="true"><field name="budgetId"><header-field><hidden/></header-field><default-field><hidden/></default-field></field><field name="glAccountId"><default-field><hidden/></default-field></field><field name="accountCode"><header-field title="GL Code" show-order-by="true"><text-find size="7" hide-options="true"/></header-field><default-field><display text="${accountCodeFormatter != null ? accountCodeFormatter.valueToString(accountCode) : accountCode}"/></default-field></field><field name="accountName"><header-field title="Account Name" show-order-by="true"><text-find size="30" hide-options="true"/></header-field><default-field><display/></default-field></field><field name="actualMain" align="right"><default-field title="Actual Year"><display format="#,##0.00" text-format="0.00"/></default-field></field><field name="amountMain" align="right"><default-field title="Budget Year" container-style="${actualMain > amountMain ? 'text-danger' : 'text-success'}"><display format="#,##0.00" text-format="0.00"/></default-field></field><field name="actualPer1" align="right"><default-field title="Act P1"><display format="#,##0.00" text-format="0.00"/></default-field></field><field name="amountPer1" align="right"><default-field title="Bgt P1" container-style="${actualPer1 > amountPer1 ? 'text-danger' : 'text-success'}"><display format="#,##0.00" text-format="0.00"/></default-field></field><field name="actualPer2" align="right" hide="subTimePeriodSize < 2"><default-field title="Act P2"><display format="#,##0.00" text-format="0.00"/></default-field></field><field name="amountPer2" align="right" hide="subTimePeriodSize < 2"><default-field title="Bgt P2" container-style="${actualPer2 > amountPer2 ? 'text-danger' : 'text-success'}"><display format="#,##0.00" text-format="0.00"/></default-field></field><field name="actualPer3" align="right" hide="subTimePeriodSize < 3"><default-field title="Act P3"><display format="#,##0.00" text-format="0.00"/></default-field></field><field name="amountPer3" align="right" hide="subTimePeriodSize < 3"><default-field title="Bgt P3" container-style="${actualPer3 > amountPer3 ? 'text-danger' : 'text-success'}"><display format="#,##0.00" text-format="0.00"/></default-field></field><field name="actualPer4" align="right" hide="subTimePeriodSize < 4"><default-field title="Act P4"><display format="#,##0.00" text-format="0.00"/></default-field></field><field name="amountPer4" align="right" hide="subTimePeriodSize < 4"><default-field title="Bgt P4" container-style="${actualPer4 > amountPer4 ? 'text-danger' : 'text-success'}"><display format="#,##0.00" text-format="0.00"/></default-field></field><field name="actualPer5" align="right" hide="subTimePeriodSize < 5"><default-field title="Act P5"><display format="#,##0.00" text-format="0.00"/></default-field></field><field name="amountPer5" align="right" hide="subTimePeriodSize < 5"><default-field title="Bgt P5" container-style="${actualPer5 > amountPer5 ? 'text-danger' : 'text-success'}"><display format="#,##0.00" text-format="0.00"/></default-field></field><field name="actualPer6" align="right" hide="subTimePeriodSize < 6"><default-field title="Act P6"><display format="#,##0.00" text-format="0.00"/></default-field></field><field name="amountPer6" align="right" hide="subTimePeriodSize < 6"><default-field title="Bgt P6" container-style="${actualPer6 > amountPer6 ? 'text-danger' : 'text-success'}"><display format="#,##0.00" text-format="0.00"/></default-field></field><field name="actualPer7" align="right" hide="subTimePeriodSize < 7"><default-field title="Act P7"><display format="#,##0.00" text-format="0.00"/></default-field></field><field name="amountPer7" align="right" hide="subTimePeriodSize < 7"><default-field title="Bgt P7" container-style="${actualPer7 > amountPer7 ? 'text-danger' : 'text-success'}"><display format="#,##0.00" text-format="0.00"/></default-field></field><field name="actualPer8" align="right" hide="subTimePeriodSize < 8"><default-field title="Act P8"><display format="#,##0.00" text-format="0.00"/></default-field></field><field name="amountPer8" align="right" hide="subTimePeriodSize < 8"><default-field title="Bgt P8" container-style="${actualPer8 > amountPer8 ? 'text-danger' : 'text-success'}"><display format="#,##0.00" text-format="0.00"/></default-field></field><field name="actualPer9" align="right" hide="subTimePeriodSize < 9"><default-field title="Act P9"><display format="#,##0.00" text-format="0.00"/></default-field></field><field name="amountPer9" align="right" hide="subTimePeriodSize < 9"><default-field title="Bgt P9" container-style="${actualPer9 > amountPer9 ? 'text-danger' : 'text-success'}"><display format="#,##0.00" text-format="0.00"/></default-field></field><field name="actualPer10" align="right" hide="subTimePeriodSize < 10"><default-field title="Act P10"><display format="#,##0.00" text-format="0.00"/></default-field></field><field name="amountPer10" align="right" hide="subTimePeriodSize < 10"><default-field title="Bgt P10" container-style="${actualPer10 > amountPer10 ? 'text-danger' : 'text-success'}"><display format="#,##0.00" text-format="0.00"/></default-field></field><field name="actualPer11" align="right" hide="subTimePeriodSize < 11"><default-field title="Act P11"><display format="#,##0.00" text-format="0.00"/></default-field></field><field name="amountPer11" align="right" hide="subTimePeriodSize < 11"><default-field title="Bgt P11" container-style="${actualPer11 > amountPer11 ? 'text-danger' : 'text-success'}"><display format="#,##0.00" text-format="0.00"/></default-field></field><field name="actualPer12" align="right" hide="subTimePeriodSize < 12"><default-field title="Act P12"><display format="#,##0.00" text-format="0.00"/></default-field></field><field name="amountPer12" align="right" hide="subTimePeriodSize < 12"><default-field title="Bgt P12" container-style="${actualPer12 > amountPer12 ? 'text-danger' : 'text-success'}"><display format="#,##0.00" text-format="0.00"/></default-field></field><field name="findButton"><header-field title=""><submit text="Find"/></header-field><default-field><display text=""/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Budget.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Budgets" default-menu-index="18"><subscreens default-item="FindBudget"/><widgets><subscreens-panel id="BudgetPanel" type="tab"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Reports/AccountBalance.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition-include name="getTimePeriodList" location="component://SimpleScreens/template/party/PartyTransitions.xml"/><transition-include name="getGlAccountListPaginated" location="component://SimpleScreens/template/account/AccountTransitions.xml"/><actions><if condition="classAndDescendants"><service-call name="org.moqui.impl.BasicServices.find#EnumerationByParent" out-map="descOut" in-map="[parentEnumId:classAndDescendants, includeNested:true]"/><set field="glAccountClassEnumId" from="descOut.enumIdSet"/><set field="glAccountClassEnumId_op" value="in"/></if><if condition="organizationPartyId"><service-call name="mantle.ledger.LedgerServices.find#PartyAcctgPreference" out-map="context" in-map="[organizationPartyId:organizationPartyId]"/></if><set field="glAccountCodeMask" from="partyAcctgPreference?.glAccountCodeMask ?: ec.user.getPreference('GlAccountCodeMask')"/><set field="accountCodeFormatter" from="masker(glAccountCodeMask, '0')"/></actions><widgets><form-list name="AccountBalanceHistory" list="resultList" skip-form="true" header-dialog="true" select-columns="true" saved-finds="true" show-csv-button="true" show-xlsx-button="true" show-all-button="true"><entity-find entity-name="mantle.ledger.report.GlAccountOrgTimePeriodSummary" list="resultList"><search-form-inputs default-order-by="glAccountId,fromDate"><default-parameters timePeriodTypeId="FiscalYear"/></search-form-inputs></entity-find><field name="organizationPartyId"><header-field title="Organization"><drop-down allow-empty="true"><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName,firstName,lastName"/></entity-find></entity-options></drop-down></header-field></field><field name="timePeriodTypeId"><header-field title="Period Type"><drop-down><option key="FiscalYear" text="Year"/><option key="FiscalQuarter" text="Quarter"/><option key="FiscalMonth" text="Month"/></drop-down></header-field></field><field name="classAndDescendants"><header-field title="Class + Subs" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="GlAccountClass"/><set field="allowEmpty" value="true"/></widget-template-include></header-field></field><field name="glAccountId"><header-field title="GL Account" show-order-by="true"><drop-down allow-empty="true"><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0"/></drop-down></header-field><default-field><display-entity entity-name="mantle.ledger.account.GlAccount" text="GlAccountNameTemplate"/></default-field></field><field name="glAccountClassEnumId"><header-field title="Class" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="GlAccountClass"/><set field="allowMultiple" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="timePeriodId"><header-field title="Period"><drop-down allow-empty="true"><dynamic-options transition="getTimePeriodList" server-search="true" min-length="0" parameter-map="[timePeriodTypeId:'FiscalYear,FiscalQuarter,FiscalMonth']"><depends-on field="organizationPartyId" parameter="partyId"/></dynamic-options></drop-down></header-field><default-field><display-entity entity-name="mantle.party.time.TimePeriod" text="${periodName}"/></default-field></field><field name="fromDate"><header-field show-order-by="true"/><default-field><display/></default-field></field><field name="thruDate"><header-field show-order-by="true"/><default-field><display/></default-field></field><field name="isClosed"><default-field title="Closed"><display/></default-field></field><field name="postedDebits" align="right" show-total="sum"><default-field><display format="#,##0.00"/></default-field></field><field name="postedCredits" align="right" show-total="sum"><default-field><display format="#,##0.00"/></default-field></field><field name="beginningBalance" align="right" show-total="first"><default-field><display format="#,##0.00"/></default-field></field><field name="postedAmount" align="right" from="endingBalance - beginningBalance" show-total="sum"><default-field><display format="#,##0.00"/></default-field></field><field name="endingBalance" align="right" show-total="last"><default-field><display format="#,##0.00"/></default-field></field><field name="ledgerLink"><default-field title="Ledger"><link url="../AccountLedger" text="Ledger" link-type="anchor" condition="glAccountId && timePeriodId" parameter-map="[glAccountIdList:glAccountId, timePeriodId:timePeriodId]"/></default-field></field><field name="find"><header-field title="Find"><submit/></header-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Reports/AccountLedger.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><parameter name="glAccountId"/><parameter name="glAccountIdList"/><parameter name="timePeriodId"/><transition name="editTransaction"><default-response url="../../Transaction/EditTransaction"/></transition><transition name="editInvoice"><default-response url="../../Invoice/EditInvoice"/></transition><transition name="editPayment"><default-response url="../../Payment/EditPayment"/></transition><transition name="editGlAccount"><default-response url="../../GlAccount/EditGlAccount"/></transition><transition name="assetDetail"><default-response url="//${appRoot}/Asset/AssetDetail"/></transition><transition name="editProduct"><default-response url="//${appRoot}/Catalog/Product/EditProduct"/></transition><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition-include name="getGlAccountListPaginated" location="component://SimpleScreens/template/account/AccountTransitions.xml"/><transition-include name="getTimePeriodList" location="component://SimpleScreens/template/party/PartyTransitions.xml"/><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><actions><if condition="glAccountId && !glAccountIdList"><set field="glAccountIdList" from="[glAccountId]"/></if><if condition="glAccountIdList instanceof String"><then><set field="glAccountIdList" from="glAccountIdList.contains(',') ? (glAccountIdList.split(',') as List) : [glAccountIdList]"/></then><else><set field="glAccountIdList" from="glAccountIdList as List"/></else></if><if condition="timePeriodId && glAccountIdList"><service-call name="mantle.ledger.LedgerReportServices.get#AccountLedgerInfo" out-map="context" in-map="[timePeriodId:timePeriodId, glAccountIdList:glAccountIdList, showReverses:showReverses]"/></if></actions><widgets><container-box><box-header title="${timePeriod?.periodName ?: 'No Period Selected'} ${timePeriod?.fromDate ? '(from ' + timePeriod.fromDate : ''}${timePeriod?.thruDate ? ' thru ' + timePeriod.thruDate + ')': ''}"/><box-body-nopad><form-list name="AccountLedger" list="entryInfoList" skip-form="true" header-dialog="true" select-columns="true" saved-finds="true" show-csv-button="true" show-xlsx-button="true"><field name="glAccountIdList"><header-field title="GL Account"><drop-down allow-multiple="true"><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0" parameter-map="[glAccountId:null, organizationPartyId:null]"/></drop-down></header-field></field><field name="organizationPartyId"><header-field title="Organization"><drop-down><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></header-field></field><field name="timePeriodId"><header-field title="Time Period"><drop-down><dynamic-options transition="getTimePeriodList" server-search="true" min-length="0" parameter-map="[timePeriodTypeId:'FiscalYear,FiscalQuarter,FiscalMonth', timePeriodId:null]"><depends-on field="organizationPartyId" parameter="partyId"/></dynamic-options></drop-down></header-field></field><field name="acctgTransId"><default-field title="TX ID"><link url="editTransaction" text="${acctgTransId}" link-type="anchor" condition="acctgTransId"/><label text="${accountCode?:''}" style="text-strong" condition="!acctgTransId"/></default-field></field><field name="glJournalId"><default-field title="Jrnl"><display-entity entity-name="mantle.ledger.transaction.GlJournal" text="${glJournalName?.take(3)}"/></default-field></field><field name="transactionDate"><default-field title="Trans Date" container-style="${acctgTransId ? '' : 'text-strong'}"><display format="yyyy-MM-dd"/></default-field></field><field name="acctgTransTypeEnumId"><default-field title="TX Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="description"><default-field container-style="${acctgTransId ? '' : 'text-strong'}"><display text="${description ?: txDescription ?: ec.entity.find('moqui.basic.Enumeration').condition('enumId', acctgTransTypeEnumId).one()?.description ?: ''}"/></default-field></field><field name="otherPartyId"><default-field title="Other Party"><link url="editParty" link-type="anchor" parameter-map="[partyId:otherPartyId]" text="PartyNameTemplate" condition="otherPartyId"/></default-field></field><field name="invoiceId"><default-field title="Invoice"><link url="editInvoice" text="${invoiceId}" link-type="anchor" condition="invoiceId"/></default-field></field><field name="referenceNumber"><default-field title="Inv Ref"><display/></default-field></field><field name="invoiceByRef"><default-field title="Invoice/Ref"><link text="${acctgTransTypeEnumId == 'AttPurchaseInvoice' ? (referenceNumber ?: otherPartyOrderId ?: invoiceId) : invoiceId}" url="editInvoice" link-type="anchor" condition="invoiceId"/><label text="${txVoucherRef}" condition="txVoucherRef"/></default-field></field><field name="paymentId"><default-field title="Payment"><link url="editPayment" text="${paymentId}" link-type="anchor" condition="paymentId"/></default-field></field><field name="paymentRefNum"><default-field title="Pmt Ref"><display/></default-field></field><field name="assetId"><default-field title="Asset"><link url="assetDetail" text="${assetId}" link-type="anchor" condition="assetId"/></default-field></field><field name="productId"><default-field title="Product"><link url="editProduct" text="${productId}" link-type="anchor" condition="productId"/></default-field></field><field name="acctgTransEntrySeqId"><default-field title="Entry"><display/></default-field></field><field name="debit" align="right"><default-field container-style="${acctgTransId ? '' : 'text-strong'}"><display format="#,##0.00"/></default-field></field><field name="credit" align="right"><default-field container-style="${acctgTransId ? '' : 'text-strong'}"><display format="#,##0.00"/></default-field></field><field name="balance" align="right"><default-field container-style="${acctgTransId ? '' : 'text-strong'}"><display format="#,##0.00"/></default-field></field><field name="showReverses"><header-field><check><option key="true" text=" "/></check></header-field></field><field name="find"><header-field title="Find"><submit/></header-field></field><form-list-column><field-ref name="acctgTransId"/></form-list-column><form-list-column><field-ref name="transactionDate"/></form-list-column><form-list-column><field-ref name="glJournalId"/></form-list-column><form-list-column><field-ref name="description"/></form-list-column><form-list-column><field-ref name="otherPartyId"/></form-list-column><form-list-column><field-ref name="invoiceByRef"/></form-list-column><form-list-column><field-ref name="paymentId"/></form-list-column><form-list-column><field-ref name="paymentRefNum"/></form-list-column><form-list-column><field-ref name="debit"/></form-list-column><form-list-column><field-ref name="credit"/></form-list-column><form-list-column><field-ref name="balance"/></form-list-column></form-list></box-body-nopad></container-box></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Reports/InvoiceAgingDetail.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" default-menu-title="Aging Detail"><transition name="editInvoice"><default-response url="../../Invoice/EditInvoice"/></transition><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><actions><set field="invoiceType" from="invoiceType ?: 'Receivable'"/><if condition="'payable'.equalsIgnoreCase(invoiceType)"><then><set field="toRoleTypeId" value="OrgInternal"/></then><else-if condition="'receivable'.equalsIgnoreCase(invoiceType)"><set field="fromRoleTypeId" value="OrgInternal"/></else-if></if><set field="periodDays" from="(periodDays ?: '30') as int"/><set field="periodDaysBd" from="new BigDecimal(periodDays)"/><set field="dateField" from="dateField ?: 'invoiceDate'"/><set field="statusId" from="statusId ?: (invoiceType == 'Payable' ? 'InvoiceApproved,InvoicePmtSent,InvoiceBilledThrough' : 'InvoiceFinalized,InvoiceSent,InvoiceAcked,InvoicePmtRecvd,InvoiceWriteOff')"/><set field="statusId_op" value="in"/><set field="referenceNumber" from="refNum"/><set field="asOfDate" from="asOfDate ? ec.l10n.parseTimestamp(asOfDate + ' 23:59:59.999', 'yyyy-MM-dd HH:mm:ss.SSS', null, TimeZone.getDefault()) : ec.user.nowTimestamp"/></actions><widgets><form-single name="ReportOptions" transition="."><field name="formListFindId"><default-field><hidden/></default-field></field><field name="pageNoLimit"><default-field><hidden/></default-field></field><field name="orderByField"><default-field><hidden/></default-field></field><field name="invoiceType"><default-field title="AR/AP"><radio><option key="Receivable"/><option key="Payable"/></radio></default-field></field><field name="periodDays"><default-field><text-line size="2"/></default-field></field><field name="dateField"><default-field title="Age By"><drop-down><option key="invoiceDate" text="Invoice Date"/><option key="dueDate" text="Due Date"/></drop-down></default-field></field><field name="asOfDate"><default-field><date-time type="date"/></default-field></field><field name="submitButton"><default-field><submit text="Run Report"/></default-field></field><field-layout><field-row-big><field-ref name="invoiceType"/><field-ref name="periodDays"/><field-ref name="dateField"/><field-ref name="asOfDate"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single><form-list name="InvoiceAgingList" list="invoiceAgingList" skip-form="true" header-dialog="true" saved-finds="true" select-columns="true" show-all-button="true" show-csv-button="true" show-xlsx-button="true"><entity-find entity-name="mantle.account.invoice.InvoicePaymentApplicationSummary" list="invoiceAgingList" use-clone="true"><search-form-inputs default-order-by="fromPseudoId,toPseudoId,invoiceId" skip-fields="fromRoleTypeId,toRoleTypeId"/><econditions combine="or"><econditions><econdition field-name="isAdjustment" operator="not-equals" value="Y" or-null="true"/><econdition field-name="itemInvoiceDate" operator="less-equals" from="asOfDate"/></econditions><econditions><econdition field-name="isAdjustment" value="Y"/><econdition field-name="itemDate" operator="less-equals" from="asOfDate"/></econditions></econditions><econdition field-name="appliedDate" operator="less-equals" from="asOfDate"/><econdition field-name="toAppliedDate" operator="less-equals" from="asOfDate"/><econdition field-name="fromRoleTypeId" ignore-if-empty="true"/><econdition field-name="toRoleTypeId" ignore-if-empty="true"/><econditions combine="or"><econdition field-name="itemsTotal" operator="not-equals" to-field-name="totalAmountApplied"/><econditions><econdition field-name="itemsTotal" operator="not-equals" from="0.0"/><econdition field-name="amountApplied" operator="is-null"/><econdition field-name="toAmountApplied" operator="is-null"/></econditions></econditions><select-field field-name="fromPartyId,toPartyId,invoiceId,invoiceDate,dueDate,itemsTotal,amountApplied,toAmountApplied,totalAmountApplied"/></entity-find><row-actions><script><![CDATA[unpaidAmount = itemsTotal - (amountApplied ?: 0.0) - (toAmountApplied ?: 0.0)
                    agingList = new ArrayList([null, null, null, null, null, null])
                    Timestamp dateTs = context.get(dateField)
                    Integer dateDays = dateTs != null ? asOfDate - dateTs : null
                    Integer dateIdx = dateDays != null ? (dateDays < 0 ? 0 :
                            ((dateDays as BigDecimal) / periodDaysBd).setScale(0, BigDecimal.ROUND_DOWN).intValue() + 1) : null
                    if (dateIdx != null && dateIdx > 5) dateIdx = 5
                    if (dateIdx != null) agingList[dateIdx] = unpaidAmount]]></script></row-actions><field name="invoiceType"><header-field><radio><option key="Receivable"/><option key="Payable"/></radio></header-field></field><field name="periodDays"><header-field><text-line size="6"/></header-field></field><field name="dateField"><header-field title="Age By"><drop-down><option key="dueDate" text="Due Date"/><option key="invoiceDate" text="Invoice Date"/></drop-down></header-field></field><field name="asOfDate"><header-field><date-time type="date"/></header-field></field><field name="fromPartyId"><header-field title="From"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></header-field></field><field name="toPartyId"><header-field title="To"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></header-field></field><field name="fromPseudoId" aggregate="group-by"><header-field title="From ID" show-order-by="true"/><default-field><link url="editParty" text="${fromPseudoId}" link-type="anchor" parameter-map="[partyId:fromPartyId]"/></default-field></field><field name="toPseudoId" aggregate="group-by"><header-field title="To ID" show-order-by="true"/><default-field><link url="editParty" text="${toPseudoId}" link-type="anchor" parameter-map="[partyId:toPartyId]"/></default-field></field><field name="fromName"><header-field title="From Name" show-order-by="true"/><default-field><link url="editParty" text="${fromName}" link-type="anchor" parameter-map="[partyId:fromPartyId]"/></default-field></field><field name="toName"><header-field title="To Name" show-order-by="true"/><default-field><link url="editParty" text="${toName}" link-type="anchor" parameter-map="[partyId:toPartyId]"/></default-field></field><field name="invoiceId" aggregate="group-by"><header-field show-order-by="true" title="Invoice"/><default-field><link url="editInvoice" text="${invoiceId}" link-type="anchor"/></default-field></field><field name="referenceNumber"><header-field title="Their Invoice"><text-find/></header-field><default-field><display/></default-field></field><field name="otherPartyOrderId"><header-field title="Their Order"><text-find/></header-field><default-field><display/></default-field></field><field name="invoiceDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display format="yyyy-MM-dd"/></default-field></field><field name="dueDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display format="yyyy-MM-dd"/></default-field></field><field name="invoiceTypeEnumId" aggregate="group-by"><header-field title="Type" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="InvoiceType"/><set field="allowEmpty" value="true"/><set field="allowMultiple" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="statusId" aggregate="group-by"><header-field title="Status" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="Invoice"/><set field="allowMultiple" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="count" from="invoiceId" aggregate="count"><default-field><display/></default-field></field><field name="currentDue" from="agingList[0]" align="right" show-total="true" aggregate="sum"><header-field title="Current"/><default-field><display currency-unit-field="currencyUomId"/></default-field></field><field name="period1" from="agingList[1]" align="right" show-total="true" aggregate="sum"><header-field title="0 - ${periodDays} days"/><default-field><display currency-unit-field="currencyUomId"/></default-field></field><field name="period2" from="agingList[2]" align="right" show-total="true" aggregate="sum"><header-field title="${periodDays+1} - ${periodDays*2} days"/><default-field><display currency-unit-field="currencyUomId"/></default-field></field><field name="period3" from="agingList[3]" align="right" show-total="true" aggregate="sum"><header-field title="${periodDays*2+1} - ${periodDays*3} days"/><default-field><display currency-unit-field="currencyUomId"/></default-field></field><field name="period4" from="agingList[4]" align="right" show-total="true" aggregate="sum"><header-field title="${periodDays*3+1} - ${periodDays*4} days"/><default-field><display currency-unit-field="currencyUomId"/></default-field></field><field name="periodRemaining" from="agingList[5]" align="right" show-total="true" aggregate="sum"><header-field title="> ${periodDays*4} days"/><default-field><display currency-unit-field="currencyUomId"/></default-field></field><field name="unpaidAmount" align="right" show-total="true" aggregate="sum"><default-field title="Unpaid"><display currency-unit-field="currencyUomId"/></default-field></field><field name="itemsTotal" align="right" show-total="true" aggregate="sum"><default-field><display currency-unit-field="currencyUomId"/></default-field></field><field name="totalAmountApplied" align="right" show-total="true" aggregate="sum"><default-field title="Applied"><display currency-unit-field="currencyUomId"/></default-field></field><field name="findButton"><header-field title="Find"><submit/></header-field></field><form-list-column><field-ref name="fromPseudoId"/><field-ref name="toPseudoId"/></form-list-column><form-list-column><field-ref name="fromName"/><field-ref name="toName"/></form-list-column><form-list-column><field-ref name="invoiceId"/><field-ref name="referenceNumber"/><field-ref name="otherPartyOrderId"/></form-list-column><form-list-column><field-ref name="invoiceDate"/><field-ref name="dueDate"/></form-list-column><form-list-column><field-ref name="statusId"/></form-list-column><form-list-column><field-ref name="currentDue"/></form-list-column><form-list-column><field-ref name="period1"/></form-list-column><form-list-column><field-ref name="period2"/></form-list-column><form-list-column><field-ref name="period3"/></form-list-column><form-list-column><field-ref name="period4"/></form-list-column><form-list-column><field-ref name="periodRemaining"/></form-list-column><form-list-column><field-ref name="unpaidAmount"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Reports/ArAgingSummary.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" default-menu-title="AR Aging Summary"><transition name="findInvoice"><default-response url="../../Invoice/FindInvoice"/></transition><transition name="findPayment"><default-response url="../../Payment/FindPayment"/></transition><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><actions><set field="pageNoLimit" value="true"/><set field="periodDays" from="(periodDays ?: '30') as int"/><set field="periodDaysBd" from="new BigDecimal(periodDays)"/><set field="dateField" from="dateField ?: 'invoiceDate'"/><set field="asOfDate" from="asOfDate ? ec.l10n.parseTimestamp(asOfDate + ' 23:59:59.999', 'yyyy-MM-dd HH:mm:ss.SSS', null, TimeZone.getDefault()) : ec.user.nowTimestamp"/><set field="orderBySave" from="orderByField ?: 'toName'"/><set field="orderByField" from="null"/><entity-find entity-name="mantle.account.invoice.InvoicePaymentApplicationSummary" list="invoiceAgingList" use-clone="true"><search-form-inputs/><econditions combine="or"><econditions><econdition field-name="isAdjustment" operator="not-equals" value="Y" or-null="true"/><econdition field-name="itemInvoiceDate" operator="less-equals" from="asOfDate"/></econditions><econditions><econdition field-name="isAdjustment" value="Y"/><econdition field-name="itemDate" operator="less-equals" from="asOfDate"/></econditions></econditions><econdition field-name="appliedDate" operator="less-equals" from="asOfDate"/><econdition field-name="toAppliedDate" operator="less-equals" from="asOfDate"/><econdition field-name="fromRoleTypeId" ignore-if-empty="true"/><econdition field-name="toRoleTypeId" ignore-if-empty="true"/><econditions combine="or"><econdition field-name="itemsTotal" operator="not-equals" to-field-name="totalAmountApplied"/><econditions><econdition field-name="itemsTotal" operator="not-equals" from="0.0"/><econdition field-name="amountApplied" operator="is-null"/><econdition field-name="toAmountApplied" operator="is-null"/></econditions></econditions><econdition field-name="statusId" operator="in" value="InvoiceFinalized,InvoiceSent,InvoiceAcked,InvoicePmtRecvd,InvoiceWriteOff"/><select-field field-name="fromPartyId,toPartyId,toPseudoId,toName,invoiceId,invoiceDate,dueDate"/><select-field field-name="itemsTotal,amountApplied,toAmountApplied"/></entity-find><entity-find entity-name="mantle.account.payment.PaymentAndApplicationSummary" list="paymentAndAppList" use-clone="true"><econdition field-name="fromPartyId" from="toPartyId" ignore-if-empty="true"/><econdition field-name="toPartyId" from="fromPartyId" ignore-if-empty="true"/><econdition field-name="paymentTypeEnumId" operator="in" value="PtInvoicePayment,PtPrePayment,PtPrePaymentInventory"/><econdition field-name="statusId" operator="in" value="PmntDelivered,PmntConfirmed"/><econdition field-name="amount" operator="greater" from="0.0"/><econdition field-name="effectiveDate" operator="less-equals" from="asOfDate"/><econdition field-name="appliedDate" operator="less-equals" from="asOfDate"/><econdition field-name="toAppliedDate" operator="less-equals" from="asOfDate"/><econditions combine="or"><econdition field-name="amount" operator="not-equals" to-field-name="amountApplied"/><econditions combine="and"><econdition field-name="amountApplied" operator="is-null"/><econdition field-name="toAmountApplied" operator="is-null"/></econditions></econditions><select-field field-name="fromPartyId,toPartyId,paymentId,amount,amountApplied,toAmountApplied"/></entity-find><set field="orderByField" from="orderBySave"/><set field="agingInfoByToPartyId" from="[:]"/><set field="totalsRow" from="[toName:'Totals']"/><script><![CDATA[for (invoice in invoiceAgingList) {
                BigDecimal unpaidAmount = invoice.itemsTotal - (invoice.amountApplied ?: 0.0) - (invoice.toAmountApplied ?: 0.0)
                if (unpaidAmount == 0.0) continue

                String toPartyId = invoice.toPartyId
                Map toPartyInfo = agingInfoByToPartyId.get(toPartyId)
                if (toPartyInfo == null) {
                    toPartyInfo = invoice.getMap()
                    agingInfoByToPartyId.put(toPartyId, toPartyInfo)
                    toPartyInfo.count = 1
                } else {
                    toPartyInfo.count++
                }

                Timestamp dateTs = invoice.get(dateField)
                Integer dateDays = dateTs != null ? asOfDate - dateTs : null
                Integer dateIdx = dateDays != null ? (dateDays < 0 ? 0 :
                        ((dateDays as BigDecimal) / periodDaysBd).setScale(0, BigDecimal.ROUND_DOWN).intValue() + 1) : null
                if (dateIdx != null && dateIdx > 4) dateIdx = 4
                if (dateIdx != null) {
                    addToBigDecimalInMap("period" + dateIdx, unpaidAmount, toPartyInfo)
                    addToBigDecimalInMap("period" + dateIdx, unpaidAmount, totalsRow)
                }
                addToBigDecimalInMap("unpaidAmount", unpaidAmount, toPartyInfo)
                addToBigDecimalInMap("unpaidAmount", unpaidAmount, totalsRow)
                addToBigDecimalInMap("balanceDue", unpaidAmount, toPartyInfo)
                addToBigDecimalInMap("balanceDue", unpaidAmount, totalsRow)
                addToListInMap("invoiceIds", invoice.invoiceId, toPartyInfo)
            }]]></script><script><![CDATA[for (payment in paymentAndAppList) {
                BigDecimal unappliedAmount = payment.amount - (payment.amountApplied ?: 0.0) - (payment.toAmountApplied ?: 0.0)
                if (unappliedAmount == 0.0) continue

                String toPartyId = payment.fromPartyId // yes, fromPartyId; invoice.toPartyId = payment.fromPartyId
                Map toPartyInfo = agingInfoByToPartyId.get(toPartyId)
                if (toPartyInfo == null) {
                    Map party = ec.entity.find("mantle.party.PartyDetail").condition("partyId", toPartyId).one()
                    toPartyInfo = [toPartyId:toPartyId, toPseudoId:party.pseudoId,
                            toName:"${party.firstName ? party.firstName + ' ' : ''}${party.lastName?:''}${party.organizationName?:''}".toString()]
                    agingInfoByToPartyId.put(toPartyId, toPartyInfo)
                }

                addToBigDecimalInMap("unappliedTotal", unappliedAmount, toPartyInfo)
                addToBigDecimalInMap("unappliedTotal", unappliedAmount, totalsRow)
                addToBigDecimalInMap("balanceDue", -unappliedAmount, toPartyInfo)
                addToBigDecimalInMap("balanceDue", -unappliedAmount, totalsRow)
                addToListInMap("paymentIds", payment.paymentId, toPartyInfo)
            }]]></script><set field="agingInfoList" from="new ArrayList(agingInfoByToPartyId.values())"/><script><![CDATA[orderMapList(agingInfoList, orderByField.split(',') as List)]]></script><script><![CDATA[agingInfoList.add(totalsRow)
            BigDecimal unpaidAmount = totalsRow.unpaidAmount
            if (unpaidAmount) agingInfoList.add([toName:'Percent', period0:((totalsRow.period0 ?: 0.0)/unpaidAmount)*100.0,
                    period1:((totalsRow.period1 ?: 0.0)/unpaidAmount)*100.0, period2:((totalsRow.period2 ?: 0.0)/unpaidAmount)*100.0,
                    period3:((totalsRow.period3 ?: 0.0)/unpaidAmount)*100.0, period4:((totalsRow.period4 ?: 0.0)/unpaidAmount)*100.0])]]></script></actions><widgets><form-single name="ReportOptions" transition="."><field name="formListFindId"><default-field><hidden/></default-field></field><field name="orderByField"><default-field><hidden/></default-field></field><field name="periodDays"><default-field><text-line size="2"/></default-field></field><field name="dateField"><default-field title="Age By"><drop-down><option key="invoiceDate" text="Invoice Date"/><option key="dueDate" text="Due Date"/></drop-down></default-field></field><field name="asOfDate"><default-field><date-time type="date"/></default-field></field><field name="submitButton"><default-field><submit text="Run Report"/></default-field></field><field-layout><field-row-big><field-ref name="periodDays"/><field-ref name="dateField"/><field-ref name="asOfDate"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single><form-list name="InvoiceAgingList" list="agingInfoList" skip-form="true" header-dialog="true" show-csv-button="true" show-xlsx-button="true"><field name="periodDays"><header-field><text-line size="6"/></header-field></field><field name="dateField"><header-field title="Age By"><drop-down><option key="dueDate" text="Due Date"/><option key="invoiceDate" text="Invoice Date"/></drop-down></header-field></field><field name="asOfDate"><header-field><date-time type="date"/></header-field></field><field name="toPartyId"><header-field title="To"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></header-field></field><field name="toPseudoId"><header-field title="To ID" show-order-by="true"/><default-field><link url="editParty" text="${toPseudoId}" link-type="anchor" parameter-map="[partyId:toPartyId]"/></default-field></field><field name="toName"><header-field title="To Name" show-order-by="true"/><default-field><link url="editParty" text="${toName}" link-type="anchor" parameter-map="[partyId:toPartyId]"/></default-field></field><field name="count"><header-field show-order-by="true"/><default-field><display/></default-field></field><field name="period0" align="right"><header-field title="Current" show-order-by="true"/><default-field><display format="#,##0.00"/></default-field></field><field name="period1" align="right"><header-field title="0 - ${periodDays} days" show-order-by="true"/><default-field><display format="#,##0.00"/></default-field></field><field name="period2" align="right"><header-field title="${periodDays+1} - ${periodDays*2} days" show-order-by="true"/><default-field><display format="#,##0.00"/></default-field></field><field name="period3" align="right"><header-field title="${periodDays*2+1} - ${periodDays*3} days" show-order-by="true"/><default-field><display format="#,##0.00"/></default-field></field><field name="period4" align="right"><header-field title="> ${periodDays*3} days" show-order-by="true"/><default-field><display format="#,##0.00"/></default-field></field><field name="unpaidAmount" align="right"><header-field title="Unpaid" show-order-by="true"/><default-field><link url="findInvoice" text="${ec.l10n.format(unpaidAmount, '#,##0.00')}" link-type="anchor" parameter-map="[invoiceId:(invoiceIds.join(',')), invoiceId_op:'in']" condition="unpaidAmount && invoiceIds"/><label text="${ec.l10n.format(unpaidAmount, '#,##0.00')}" condition="unpaidAmount && !invoiceIds"/></default-field></field><field name="unappliedTotal" align="right"><header-field title="Overpaid" show-order-by="true"/><default-field><link url="findPayment" text="${ec.l10n.format(unappliedTotal, '#,##0.00')}" link-type="anchor" parameter-map="[paymentId:(paymentIds.join(',')), paymentId_op:'in']" condition="unappliedTotal && paymentIds"/><label text="${ec.l10n.format(unappliedTotal, '#,##0.00')}" condition="unappliedTotal && !paymentIds"/></default-field></field><field name="balanceDue" align="right"><header-field show-order-by="true"/><default-field><display format="#,##0.00"/></default-field></field><field name="findButton"><header-field title="Find"><submit/></header-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Reports/AssetOnHand.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Asset On Hand" default-menu-include="false"><transition name="editProduct"><default-response url="//${appRoot}/Catalog/Product/EditProduct"/></transition><transition name="editFacility"><default-response url="//${appRoot}/Facility/EditFacility"/></transition><transition name="assetDetail"><default-response url="//${appRoot}/Asset/AssetDetail"/></transition><transition name="orderDetail"><default-response url="//${appRoot}/Order/OrderDetail"/></transition><transition name="shipmentDetail"><default-response url="//${appRoot}/Shipment/ShipmentDetail"/></transition><transition name="editInvoice"><default-response url="//${appRoot}/Accounting/Invoice/EditInvoice"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getLocationList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><transition-include name="emailScreenAsync" location="component://webroot/template/screen/BasicTransitions.xml"/><actions><set field="hasDetails" from="showDetails == 'true'"/><if condition="facilityId && (dateRange_period || dateRange_from)"><then><set field="rangeList" from="ec.user.getPeriodRange('dateRange', context)"/><set field="fromDate" from="rangeList[0]"/><set field="thruDate" from="rangeList[1]"/><entity-find entity-name="mantle.product.asset.AssetOnHandSummary" list="summaryList" use-clone="true"><search-form-inputs default-order-by="pseudoId" paginate="false"/><econdition field-name="effectiveDate" operator="less-equals" from="thruDate"/><econdition field-name="quantityOnHandDiff" operator="not-equals" from="0.0"/><having-econditions><econditions combine="or"><econdition field-name="startingOnHand" operator="not-equals" from="0.0"/><econdition field-name="onHandChange" operator="not-equals" from="0.0"/></econditions></having-econditions><select-field field-name="productId,pseudoId,productName,facilityId,startingOnHand,onHandChange"/></entity-find><if condition="hasDetails"><set field="origList" from="summaryList"/><set field="summaryList" from="[]"/><iterate list="origList" entry="orig"><entity-find entity-name="mantle.product.asset.AssetOnHandDetail" list="detailList" use-clone="true"><econdition field-name="productId" from="orig.productId"/><econdition field-name="facilityId" from="orig.facilityId"/><econdition field-name="effectiveDate" operator="greater-equals" from="fromDate"/><econdition field-name="effectiveDate" operator="less-equals" from="thruDate"/><econdition field-name="quantityOnHandDiff" operator="not-equals" from="0.0"/><select-field field-name="assetId,effectiveDate,shipmentId,issOrderId,issInvoiceId,recOrderId,recInvoiceId,quantityOnHandDiff"/><order-by field-name="effectiveDate"/></entity-find><script><![CDATA[summaryList.add(orig.getMap())
                        for (det in detailList) summaryList.add([assetId:det.assetId, effectiveDate:det.effectiveDate,
                                orderId:(det.issOrderId ?: det.recOrderId), invoiceId:(det.issInvoiceId ?: det.recInvoiceId),
                                shipmentId:det.shipmentId, onHandChange:det.quantityOnHandDiff])]]></script></iterate></if></then><else><set field="dateRange_period" from="dateRange_period ?: 'week'"/><set field="dateRange_poffset" from="dateRange_poffset ?: '-1'"/></else></if><set field="sharedMap" from="[startingOnHand:null, prevStarting:null]"/></actions><widgets><label text="Please select a Facility" condition="!facilityId" type="p"/><label text="Please select a Date Range" condition="!dateRange_period || !dateRange_poffset" type="p"/><section-include name="EmailScreenSection" location="component://webroot/template/screen/BasicTransitions.xml"/><form-list name="AssetOnHandSummary" list="summaryList" skip-form="true" header-dialog="true" saved-finds="true" show-csv-button="true" show-xlsx-button="true"><row-actions><if condition="locationSeqId"><entity-find-one entity-name="mantle.facility.FacilityLocation" value-field="facLoc" cache="true"><field-map field-name="facilityId"/><field-map field-name="locationSeqId"/></entity-find-one></if><if condition="startingOnHand != null"><then><set field="sharedMap.startingOnHand" from="startingOnHand"/><set field="sharedMap.prevStarting" from="startingOnHand"/><set field="isSummaryRow" from="hasDetails"/></then><else><set field="sharedMap.startingOnHand" from="sharedMap.prevStarting"/><set field="sharedMap.prevStarting" from="sharedMap.prevStarting + onHandChange"/></else></if></row-actions><field name="dateRange"><header-field><date-period/></header-field></field><field name="productId"><header-field title="Product" show-order-by="true"><drop-down allow-empty="true"><dynamic-options transition="getProductList" server-search="true" min-length="0"/></drop-down></header-field></field><field name="ownerPartyId"><header-field title="Owner Party"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></header-field></field><field name="facilityId"><header-field title="Facility"><drop-down allow-empty="true"><entity-options text="FacilityNameTemplate"><entity-find entity-name="mantle.facility.Facility"><econdition field-name="facilityTypeEnumId" value="FcTpWarehouse"/><order-by field-name="facilityName"/></entity-find></entity-options></drop-down></header-field></field><field name="pseudoId"><header-field title="Product ID" show-order-by="true"/><default-field><link url="editProduct" text="${pseudoId}" link-type="anchor"/></default-field></field><field name="productName"><header-field title="Product Name" show-order-by="true"/><default-field><link url="editProduct" text="${productName}" link-type="anchor"/></default-field></field><field name="assetId"><header-field title="Asset"/><default-field><link url="assetDetail" text="${assetId}" link-type="anchor"/></default-field></field><field name="effectiveDate"><default-field title="Date"><display/></default-field></field><field name="orderId"><header-field title="Order"/><default-field><link url="orderDetail" text="${orderId}" link-type="anchor" condition="orderId"/></default-field></field><field name="shipmentId"><header-field title="Shipment"/><default-field><link url="shipmentDetail" text="${shipmentId}" link-type="anchor" condition="shipmentId"/></default-field></field><field name="invoiceId"><header-field title="Invoice"/><default-field><link url="editInvoice" text="${invoiceId}" link-type="anchor" condition="invoiceId"/></default-field></field><field name="startingOnHand" from="sharedMap.startingOnHand" align="right"><default-field title="Starting" container-style="${isSummaryRow ? 'text-strong text-success' : ''}"><display/></default-field></field><field name="onHandChange" align="right"><default-field title="Change" container-style="${isSummaryRow ? 'text-strong text-success' : ''}"><display/></default-field></field><field name="endingOnHand" from="(sharedMap.startingOnHand ?: 0.0) + (onHandChange ?: 0.0)" align="right"><default-field title="Ending" container-style="${isSummaryRow ? 'text-strong text-success' : ''}"><display/></default-field></field><field name="showDetails"><header-field><check><option key="true" text=" "/></check></header-field></field><field name="find"><header-field title="Find"><submit/></header-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Reports/AssetOnHandSummary.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Asset On Hand Summary" default-menu-include="false"><transition name="editProduct"><default-response url="//${appRoot}/Catalog/Product/EditProduct"/></transition><transition name="editFacility"><default-response url="//${appRoot}/Facility/EditFacility"/></transition><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition name="assetDetail"><default-response url="//${appRoot}/Asset/AssetDetail"/></transition><transition name="shipmentDetail"><default-response url="//${appRoot}/Shipment/ShipmentDetail"/></transition><transition name="editReturn"><default-response url="//${appRoot}/Return/EditReturn"/></transition><transition name="orderDetail"><default-response url="//${appRoot}/Order/OrderDetail"/></transition><transition name="editInvoice"><default-response url="//${appRoot}/Accounting/Invoice/EditInvoice"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getLocationList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><transition-include name="emailScreenAsync" location="component://webroot/template/screen/BasicTransitions.xml"/><actions><if condition="!dateRange_period && !dateRange_from"><set field="dateRange_period" from="dateRange_period ?: 'week'"/><set field="dateRange_poffset" from="dateRange_poffset ?: '-1'"/></if><set field="rangeList" from="ec.user.getPeriodRange('dateRange', context)"/><set field="fromDate" from="rangeList[0]"/><set field="thruDate" from="rangeList[1] ?: ec.user.nowTimestamp"/><set field="fieldDescriptions" from="[             [fieldName:'Shipments In', description:'All Incoming Shipments except Return Shipments'],             [fieldName:'Returns', description:'Return Shipments'],             [fieldName:'Produced', description:'Produced by Production Run'],             [fieldName:'Other Receipts', description:'All Receipts except Incoming Shipments and Production Runs'],             [fieldName:'All Receipts', description:'All Asset Receipts'],             [fieldName:'Shipments Out', description:'All Outgoing Shipments'],             [fieldName:'Consumed', description:'Consumed by Production Run'],             [fieldName:'Other Issuances', description:'All Issuances except Outgoing Shipments and Production Runs'],             [fieldName:'All Issuances', description:'All Asset Issuances'],             [fieldName:'Adjustments', description:'Physical Inventory Adjustments'],         ]"/></actions><widgets><section-include name="EmailScreenSection" location="component://webroot/template/screen/BasicTransitions.xml"/><container-dialog id="FieldDescDialog" button-text="Field Descriptions"><form-list name="FieldDescriptions" list="fieldDescriptions" skip-form="true" paginate="false"><field name="fieldName"><default-field><display style="text-strong"/></default-field></field><field name="description"><default-field><display/></default-field></field></form-list></container-dialog><form-list name="AssetOnHandSummary" list="summaryList" skip-form="true" header-dialog="true" saved-finds="true" select-columns="true" show-all-button="true" show-csv-button="true" show-xlsx-button="true"><entity-find entity-name="mantle.product.asset.AssetOnHandSummary" list="summaryList" use-clone="true"><search-form-inputs default-order-by="pseudoId" require-parameters="true"/><econdition field-name="effectiveDate" operator="less-equals" from="thruDate"/><econdition field-name="quantityOnHandDiff" operator="not-equals" from="0.0"/><select-field field-name="productId,pseudoId,productName,startingOnHand,onHandChange"/></entity-find><row-actions><if condition="locationSeqId"><entity-find-one entity-name="mantle.facility.FacilityLocation" value-field="facLoc" cache="true"><field-map field-name="facilityId"/><field-map field-name="locationSeqId"/></entity-find-one></if></row-actions><field name="dateRange"><header-field><date-period/></header-field></field><field name="ownerPartyId"><header-field title="Owner Party"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="0" parameter-map="[roleTypeId:'OrgInternal']"/></drop-down></header-field><default-field><link url="editParty" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" link-type="anchor"/></default-field></field><field name="facilityId"><header-field title="Facility"><drop-down allow-empty="true"><entity-options text="FacilityNameTemplate"><entity-find entity-name="mantle.facility.Facility"><econdition field-name="facilityTypeEnumId" value="FcTpWarehouse"/><order-by field-name="facilityName"/></entity-find></entity-options></drop-down></header-field><default-field><link url="editFacility" entity-name="mantle.facility.Facility" text="FacilityNameTemplate" link-type="anchor"/></default-field></field><field name="locationSeqId"><header-field title="Location"><drop-down allow-empty="true"><dynamic-options transition="getLocationList" server-search="true" min-length="0"><depends-on field="facilityId"/></dynamic-options></drop-down></header-field><default-field><label text="FacilityLocationNameTemplate" text-map="facLoc" condition="facLoc != null"/></default-field></field><field name="productId"><header-field title="Product" show-order-by="true"><drop-down allow-empty="true"><dynamic-options transition="getProductList" server-search="true" min-length="0"/></drop-down></header-field><default-field><display/></default-field></field><field name="pseudoId"><header-field title="Product ID" show-order-by="true"/><default-field><link url="editProduct" text="${pseudoId}" link-type="anchor"/></default-field></field><field name="productName"><header-field title="Product Name" show-order-by="true"/><default-field><link url="editProduct" text="${productName}" link-type="anchor"/></default-field></field><field name="effectiveDate"><default-field title="Effective Date"><display/></default-field></field><field name="shipmentId"><header-field title="Shipment" show-order-by="true"/><default-field><link url="shipmentDetail" text="${shipmentId}" link-type="anchor" condition="shipmentId"/></default-field></field><field name="returnId"><header-field title="Return" show-order-by="true"/><default-field><link url="editReturn" text="${returnId}" link-type="anchor" condition="returnId"/></default-field></field><field name="assetId"><header-field title="Asset" show-order-by="true"/><default-field><link url="assetDetail" text="${assetId}" link-type="anchor"/></default-field></field><field name="receivedDate"><header-field title="Received Date" show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="assetIssuanceId"><header-field title="Issuance" show-order-by="true"/><default-field><display/></default-field></field><field name="assetReceiptId"><header-field title="Receipt" show-order-by="true"/><default-field><display/></default-field></field><field name="physicalInventoryId"><header-field title="Physical Inv" show-order-by="true"/><default-field><display/></default-field></field><field name="startingOnHand" align="right"><default-field title="Starting"><display/></default-field></field><field name="receiptsShipmentNotReturn" align="right"><default-field title="Shipments In"><display/></default-field></field><field name="receiptsReturns" align="right"><default-field title="Returns"><display/></default-field></field><field name="receiptsWorkEffort" align="right"><default-field title="Produced"><display/></default-field></field><field name="receiptsOther" align="right"><default-field title="Other Receipts"><display/></default-field></field><field name="receiptsAll" align="right"><default-field title="All Receipts"><display/></default-field></field><field name="issuancesShipments" align="right"><default-field title="Shipments Out"><display/></default-field></field><field name="issuancesWorkEffort" align="right"><default-field title="Consumed"><display/></default-field></field><field name="issuancesOther" align="right"><default-field title="Other Issuances"><display/></default-field></field><field name="issuancesAll" align="right"><default-field title="All Issuances"><display/></default-field></field><field name="physicalAdjustments" align="right"><default-field title="Adjustments"><display/></default-field></field><field name="onHandChange" align="right"><default-field title="Change"><display/></default-field></field><field name="endingOnHand" from="(startingOnHand ?: 0.0) + (onHandChange ?: 0.0)" align="right"><default-field title="Ending"><display/></default-field></field><field name="find"><header-field title="Find"><submit/></header-field></field><form-list-column><field-ref name="pseudoId"/></form-list-column><form-list-column><field-ref name="productName"/></form-list-column><form-list-column><field-ref name="startingOnHand"/></form-list-column><form-list-column><field-ref name="receiptsShipmentNotReturn"/></form-list-column><form-list-column><field-ref name="receiptsOther"/></form-list-column><form-list-column><field-ref name="receiptsReturns"/></form-list-column><form-list-column><field-ref name="issuancesShipments"/></form-list-column><form-list-column><field-ref name="physicalAdjustments"/></form-list-column><form-list-column><field-ref name="onHandChange"/></form-list-column><form-list-column><field-ref name="endingOnHand"/></form-list-column></form-list><section name="ShowSql" condition="summaryList_xafind?.getQueryTextList()"><widgets><container-dialog id="ShowSqlDialog" button-text="Show SQL" type="info"><section-iterate name="ShowSqlIter" list="summaryList_xafind?.getQueryTextList()" entry="queryText"><widgets><label text="${queryText}" type="p"/><label text="${summaryList_xafind}" type="p"/></widgets></section-iterate></container-dialog></widgets></section></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Reports/AssetReceiptTransaction.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="editTransaction"><default-response url="../../Transaction/EditTransaction"/></transition><transition name="editInvoice"><default-response url="../../Invoice/EditInvoice"/></transition><transition name="editPayment"><default-response url="../../Payment/EditPayment"/></transition><transition name="editGlAccount"><default-response url="../../GlAccount/EditGlAccount"/></transition><transition name="editFacility"><default-response url="//${appRoot}/Facility/EditFacility"/></transition><transition name="shipmentDetail"><default-response url="//${appRoot}/Shipment/ShipmentDetail"/></transition><transition name="orderDetail"><default-response url="//${appRoot}/Order/OrderDetail"/></transition><transition name="assetDetail"><default-response url="//${appRoot}/Asset/AssetDetail"/></transition><transition name="editProduct"><default-response url="//${appRoot}/Catalog/Product/EditProduct"/></transition><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition-include name="getGlAccountListPaginated" location="component://SimpleScreens/template/account/AccountTransitions.xml"/><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><actions><set field="glAccountCodeMask" from="ec.user.getPreference('GlAccountCodeMask')"/><set field="accountCodeFormatter" from="masker(glAccountCodeMask, '0')"/></actions><widgets><form-list name="AssetReceiptTxList" list="acctgTransEntryList" skip-form="true" header-dialog="true" select-columns="true" saved-finds="true" show-csv-button="true" show-xlsx-button="true" show-all-button="true"><entity-find entity-name="mantle.ledger.transaction.AcctgTransEntryReceiptSummary" list="acctgTransEntryList" use-clone="true"><search-form-inputs default-order-by="receivedDate,acctgTransId"><default-parameters transactionDate_poffset="0" transactionDate_period="month" debitCreditFlag="D"/></search-form-inputs><select-field field-name="amount,debitCreditFlag"/></entity-find><field name="facilityId"><header-field title="Warehouse"><drop-down allow-empty="true"><entity-options text="FacilityNameTemplate"><entity-find entity-name="mantle.facility.Facility"><econdition field-name="facilityTypeEnumId" value="FcTpWarehouse"/><order-by field-name="facilityName"/></entity-find></entity-options></drop-down></header-field><default-field><link url="editFacility" entity-name="mantle.facility.Facility" text="FacilityNameTemplate" link-type="anchor"/></default-field></field><field name="acctgTransId"><header-field show-order-by="true" title="TX ID"/><default-field><link url="editTransaction" text="${acctgTransId}" link-type="anchor"/></default-field></field><field name="transactionDate"><header-field title="TX Date" show-order-by="true"><date-period/></header-field><default-field><display format="yyyy-MM-dd"/></default-field></field><field name="isPosted"><header-field title="Posted" show-order-by="true"><drop-down allow-empty="true"><option key="Y"/><option key="N"/></drop-down></header-field><default-field><display/></default-field></field><field name="acctgTransTypeEnumId"><header-field title="TX Type" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="AcctgTransType"/><set field="allowEmpty" value="true"/><set field="allowMultiple" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="organizationPartyId"><header-field title="Organization"><drop-down allow-empty="true"><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></header-field><default-field><link url="editParty" link-type="anchor" parameter-map="[partyId:organizationPartyId]" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate"/></default-field></field><field name="otherPartyId"><header-field title="Other Party"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></header-field><default-field><link url="editParty" link-type="anchor" parameter-map="[partyId:otherPartyId]" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" condition="otherPartyId"/></default-field></field><field name="shipmentId"><header-field title="Shipment" show-order-by="true"><text-find size="20" hide-options="ignore-case"/></header-field><default-field><link url="shipmentDetail" text="${shipmentId}" link-type="anchor" condition="shipmentId"/></default-field></field><field name="orderId"><header-field title="Order" show-order-by="true"><text-find size="20" hide-options="ignore-case"/></header-field><default-field><link url="orderDetail" text="${orderId}" link-type="anchor" condition="orderId"/></default-field></field><field name="invoiceId"><header-field title="Invoice" show-order-by="true"><text-find size="20" hide-options="ignore-case"/></header-field><default-field><link url="editInvoice" text="${invoiceId}" link-type="anchor" condition="invoiceId"/></default-field></field><field name="assetId"><header-field title="Asset" show-order-by="true"><text-find size="10" hide-options="ignore-case"/></header-field><default-field><link url="assetDetail" text="${assetId}" link-type="anchor" condition="assetId"/></default-field></field><field name="productId"><header-field title="Prod ID" show-order-by="true"><drop-down allow-empty="true"><dynamic-options transition="getProductList" server-search="true" min-length="0"/></drop-down></header-field><default-field><link url="editProduct" text="${pseudoId}" entity-name="mantle.product.Product" link-type="anchor" condition="productId"/></default-field></field><field name="productName" from="productId"><default-field title="Product Name"><link url="editProduct" text="${productName}" entity-name="mantle.product.Product" link-type="anchor" condition="productId"/></default-field></field><field name="mfgPartyId"><header-field title="Mfg ID"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></header-field><default-field><link url="editParty" link-type="anchor" parameter-map="[partyId:mfgPartyId]" entity-name="mantle.party.PartyDetail" text="${pseudoId}" condition="mfgPartyId"/></default-field></field><field name="mfgName" from="mfgPartyId"><default-field title="Manufacturer Name"><link url="editParty" link-type="anchor" parameter-map="[partyId:mfgPartyId]" entity-name="mantle.party.PartyDetail" text="PartyNameOnlyTemplate" condition="mfgPartyId"/></default-field></field><field name="lotNumber"><header-field title="Lot #"><text-find size="15" hide-options="ignore-case"/></header-field><default-field><display/></default-field></field><field name="acctgTransEntrySeqId"><default-field title="Entry"><display/></default-field></field><field name="glAccountId"><header-field title="GL Account" show-order-by="true"><drop-down allow-empty="true"><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0"/></drop-down></header-field><default-field><link url="editGlAccount" link-type="anchor" entity-name="mantle.ledger.account.GlAccount" text="GlAccountNameTemplate"/></default-field></field><field name="debitCreditFlag"><header-field title="Credit/Debit"><drop-down><option key="D"/><option key="C"/></drop-down></header-field><default-field><display/></default-field></field><field name="amount" align="right" show-total="true"><header-field><range-find size="15"/></header-field><default-field><display format="#,##0.00"/></default-field></field><field name="debit" align="right"><default-field><display text="${debitCreditFlag == 'D' ? ec.l10n.format(amount, '#,##0.00') : ''}"/></default-field></field><field name="credit" align="right"><default-field><display text="${debitCreditFlag == 'C' ? ec.l10n.format(amount, '#,##0.00') : ''}"/></default-field></field><field name="receivedDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display format="yyyy-MM-dd"/></default-field></field><field name="quantityAccepted" align="right" show-total="true"><header-field title="Qty Received" show-order-by="true"><range-find/></header-field><default-field><display/></default-field></field><field name="acquireCost" align="right"><header-field title="Unit Cost" show-order-by="true"><range-find size="15"/></header-field><default-field><display format="#,##0.00"/></default-field></field><field name="find"><header-field title="Find"><submit/></header-field></field><form-list-column><field-ref name="acctgTransId"/></form-list-column><form-list-column><field-ref name="transactionDate"/></form-list-column><form-list-column><field-ref name="acctgTransTypeEnumId"/></form-list-column><form-list-column><field-ref name="shipmentId"/></form-list-column><form-list-column><field-ref name="mfgPartyId"/><field-ref name="mfgName"/></form-list-column><form-list-column><field-ref name="productId"/><field-ref name="productName"/></form-list-column><form-list-column><field-ref name="amount"/></form-list-column><form-list-column><field-ref name="receivedDate"/></form-list-column><form-list-column><field-ref name="quantityAccepted"/></form-list-column><form-list-column><field-ref name="lotNumber"/></form-list-column><form-list-column><field-ref name="orderId"/></form-list-column><form-list-column><field-ref name="invoiceId"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Reports/AssetStatusByReceipt.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Asset Status by Receipt" default-menu-include="false"><transition name="editProduct"><default-response url="//${appRoot}/Catalog/Product/EditProduct"/></transition><transition name="editFacility"><default-response url="//${appRoot}/Facility/EditFacility"/></transition><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition name="assetDetail"><default-response url="//${appRoot}/Asset/AssetDetail"/></transition><transition name="shipmentDetail"><default-response url="//${appRoot}/Shipment/ShipmentDetail"/></transition><transition name="editReturn"><default-response url="//${appRoot}/Return/EditReturn"/></transition><transition name="orderDetail"><default-response url="//${appRoot}/Order/OrderDetail"/></transition><transition name="editInvoice"><default-response url="//${appRoot}/Accounting/Invoice/EditInvoice"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getLocationList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><transition-include name="emailScreenAsync" location="component://webroot/template/screen/BasicTransitions.xml"/><actions><if condition="!asOfDate"><set field="asOfDate" from="ec.l10n.format(ec.user.nowTimestamp, 'yyyy-MM-dd')"/></if><set field="thruTimestamp" from="asOfDate ? ec.l10n.parseTimestamp(asOfDate + ' 23:59:59.999', 'yyyy-MM-dd HH:mm:ss.SSS', null, TimeZone.getDefault()) : ec.user.nowTimestamp"/></actions><widgets><section-include name="EmailScreenSection" location="component://webroot/template/screen/BasicTransitions.xml"/><container-dialog id="FieldDescDialog" button-text="Field Descriptions"><form-list name="FieldDescriptions" list="fieldDescriptions" skip-form="true" paginate="false"><field name="fieldName"><default-field><display style="text-strong"/></default-field></field><field name="description"><default-field><display/></default-field></field></form-list></container-dialog><form-list name="AssetOnHandSummary" list="summaryList" skip-form="true" header-dialog="true" saved-finds="true" select-columns="true" show-all-button="true" show-csv-button="true" show-xlsx-button="true"><entity-find entity-name="mantle.product.asset.AssetAndDetailSummary" list="summaryList"><search-form-inputs default-order-by="pseudoId,receivedDate" require-parameters="true"/><econdition field-name="effectiveDate" operator="less-equals" from="thruTimestamp"/><econdition field-name="quantityOnHandDiff" operator="not-equals" from="0.0"/><having-econditions><econditions combine="or"><econdition field-name="quantityOnHandTotal" operator="not-equals" from="0.0"/></econditions></having-econditions><select-field field-name="productId,receivedDate"/></entity-find><row-actions><if condition="facilityId && locationSeqId"><entity-find-one entity-name="mantle.facility.FacilityLocation" value-field="facLoc" cache="true"><field-map field-name="facilityId"/><field-map field-name="locationSeqId"/></entity-find-one></if></row-actions><field name="asOfDate"><header-field><date-time type="date"/></header-field></field><field name="assetId"><header-field title="Asset" show-order-by="true"/><default-field><link url="assetDetail" text="${assetId}" link-type="anchor"/></default-field></field><field name="receivedDate"><header-field title="Received Date" show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="daysReceived" from="ec.user.nowTimestamp - receivedDate"><default-field title="Days Since Receipt"><display/></default-field></field><field name="ownerPartyId"><header-field title="Owner Party"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="0" parameter-map="[roleTypeId:'OrgInternal']"/></drop-down></header-field><default-field><link url="editParty" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" link-type="anchor"/></default-field></field><field name="facilityId"><header-field title="Facility"><drop-down allow-empty="true"><entity-options text="FacilityNameTemplate"><entity-find entity-name="mantle.facility.Facility"><econdition field-name="facilityTypeEnumId" value="FcTpWarehouse"/><order-by field-name="facilityName"/></entity-find></entity-options></drop-down></header-field><default-field><link url="editFacility" entity-name="mantle.facility.Facility" text="FacilityNameTemplate" link-type="anchor"/></default-field></field><field name="locationSeqId"><header-field title="Location"><drop-down allow-empty="true"><dynamic-options transition="getLocationList" server-search="true" min-length="0"><depends-on field="facilityId"/></dynamic-options></drop-down></header-field><default-field><label text="FacilityLocationNameTemplate" text-map="facLoc" condition="facLoc != null"/></default-field></field><field name="productId"><header-field title="Product" show-order-by="true"><drop-down allow-multiple="true"><dynamic-options transition="getProductList" server-search="true" min-length="0"/></drop-down></header-field><default-field><link url="editProduct" entity-name="mantle.product.Product" text="ProductNameTemplate" link-type="anchor"/></default-field></field><field name="pseudoId"><header-field title="Product ID" show-order-by="true"/><default-field><link url="editProduct" text="${pseudoId}" link-type="anchor"/></default-field></field><field name="productName"><header-field title="Product Name" show-order-by="true"/><default-field><link url="editProduct" text="${productName}" link-type="anchor"/></default-field></field><field name="quantityOnHandTotal" align="right"><default-field title="On Hand"><display/></default-field></field><field name="find"><header-field title="Find"><submit/></header-field></field><form-list-column><field-ref name="pseudoId"/></form-list-column><form-list-column><field-ref name="productName"/></form-list-column><form-list-column><field-ref name="receivedDate"/></form-list-column><form-list-column><field-ref name="daysReceived"/></form-list-column><form-list-column><field-ref name="quantityOnHandTotal"/></form-list-column></form-list><section name="ShowSql" condition="summaryList_xafind?.getQueryTextList()"><widgets><container-dialog id="ShowSqlDialog" button-text="Show SQL" type="info"><section-iterate name="ShowSqlIter" list="summaryList_xafind?.getQueryTextList()" entry="queryText"><widgets><label text="${queryText}" type="p"/><label text="${summaryList_xafind}" type="p"/></widgets></section-iterate></container-dialog></widgets></section></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Reports/BalanceSheet.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><parameter name="organizationPartyId" required="true"/><parameter name="timePeriodIdList" required="true"/><transition name="accountLedger"><default-response url="../AccountLedger"/></transition><actions><service-call name="mantle.ledger.LedgerReportServices.run#BalanceSheet" out-map="context" in-map="context"/><set field="findEntryUrl" from="sri.buildUrlInfo('accountLedger')"/><set field="csvUrl" from="sri.getScreenUrlInstance().cloneUrlInstance().addParameter('renderMode', 'csv').addParameter('saveFilename', 'BalanceSheet.csv')"/></actions><widgets><link url="${csvUrl.pathWithParams}" url-type="plain" text="Get CSV"/><render-mode><text type="html,vuet,qvt" location="component://SimpleScreens/template/ledger/BalanceSheet.html.ftl" template="true" encode="false" no-boundary-comment="true"/><text type="csv" location="component://SimpleScreens/template/ledger/BalanceSheet.csv.ftl" template="true"/></render-mode></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Reports/CashFlowStatement.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><parameter name="organizationPartyId" required="true"/><parameter name="timePeriodIdList" required="true"/><transition name="accountLedger"><default-response url="../AccountLedger"/></transition><actions><service-call name="mantle.ledger.LedgerReportServices.run#CashFlowStatement" out-map="context" in-map="context"/><set field="findEntryUrl" from="sri.buildUrlInfo('accountLedger')"/></actions><widgets><render-mode><text type="html,vuet,qvt" location="component://SimpleScreens/template/ledger/CashFlowStatement.html.ftl" template="true" encode="false" no-boundary-comment="true"/></render-mode></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Reports/FinancialRatios.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><parameter name="organizationPartyId" required="true"/><parameter name="timePeriodIdList" required="true"/><actions><service-call name="mantle.ledger.LedgerReportServices.run#FinancialRatios" out-map="context" in-map="context"/></actions><widgets><render-mode><text type="html,vuet,qvt" location="component://SimpleScreens/template/ledger/FinancialRatios.html.ftl" template="true" encode="false" no-boundary-comment="true"/></render-mode></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Reports/IncomeStatement.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><parameter name="organizationPartyId" required="true"/><parameter name="timePeriodIdList" required="true"/><transition name="accountLedger"><default-response url="../AccountLedger"/></transition><actions><service-call name="mantle.ledger.LedgerReportServices.run#IncomeStatement" out-map="context" in-map="context"/><set field="findEntryUrl" from="sri.buildUrlInfo('accountLedger')"/><set field="csvUrl" from="sri.getScreenUrlInstance().cloneUrlInstance().addParameter('renderMode', 'csv').addParameter('saveFilename', 'IncomeStatement.csv')"/></actions><widgets><link url="${csvUrl.pathWithParams}" url-type="plain" text="Get CSV"/><render-mode><text type="html,vuet,qvt" location="component://SimpleScreens/template/ledger/IncomeStatement.html.ftl" template="true" encode="false" no-boundary-comment="true"/><text type="csv" location="component://SimpleScreens/template/ledger/IncomeStatement.csv.ftl" template="true"/></render-mode></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Reports/AssetValuation.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Inventory Valuation" default-menu-include="false"><transition name="editProduct"><default-response url="//${appRoot}/Catalog/Product/EditProduct"/></transition><transition name="assetDetail"><default-response url="//${appRoot}/Asset/AssetDetail"/></transition><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><actions><set field="thruTimestamp" from="asOfDate ? ec.l10n.parseTimestamp(asOfDate + ' 23:59:59.999', 'yyyy-MM-dd HH:mm:ss.SSS', null, TimeZone.getDefault()) : ec.user.nowTimestamp"/></actions><widgets><form-list name="AssetValuationSummary" list="summaryList" skip-form="true" header-dialog="true" select-columns="true" saved-finds="true" show-csv-button="true" show-xlsx-button="true" show-all-button="true"><entity-find entity-name="mantle.product.asset.AssetValuationSummary" list="summaryList" use-clone="true"><search-form-inputs default-order-by="pseudoId" require-parameters="true"/><econdition field-name="effectiveDate" operator="less-equals" from="thruTimestamp"/><having-econditions><econdition field-name="quantityOnHandDiff" operator="not-equals" from="0.0"/></having-econditions><select-field field-name="productId,totalCost"/></entity-find><field name="asOfDate"><header-field><date-time type="date"/></header-field></field><field name="productId"><header-field title="Product" show-order-by="true"><drop-down allow-empty="true"><dynamic-options transition="getProductList" server-search="true" min-length="0"/></drop-down></header-field></field><field name="pseudoId"><header-field title="Product ID" show-order-by="true"/><default-field><link url="editProduct" text="${pseudoId}" link-type="anchor" condition="productId"/></default-field></field><field name="productName"><header-field title="Product Name" show-order-by="true"/><default-field><link url="editProduct" text="${productName}" link-type="anchor"/></default-field></field><field name="assetId"><header-field title="Asset ID" show-order-by="true"><text-find size="15" hide-options="ignore-case"/></header-field><default-field><link url="assetDetail" text="${assetId}" link-type="anchor"/></default-field></field><field name="facilityId"><header-field title="Facility" show-order-by="true"><drop-down allow-empty="true"><entity-options key="${facilityId}" text="FacilityNameTemplate"><entity-find entity-name="mantle.facility.Facility"><econdition field-name="facilityTypeEnumId" value="FcTpWarehouse"/><order-by field-name="facilityName"/></entity-find></entity-options></drop-down></header-field><default-field><display-entity entity-name="mantle.facility.Facility" text="FacilityNameTemplate"/></default-field></field><field name="mfgPartyId"><header-field title="Manufacturer"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></header-field><default-field><link url="editParty" link-type="anchor" parameter-map="[partyId:mfgPartyId]" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" condition="mfgPartyId"/></default-field></field><field name="lotNumber"><header-field><text-find size="15" hide-options="ignore-case"/></header-field><default-field><display/></default-field></field><field name="minAcquireCost" align="right"><default-field title="Min"><display format="#,##0.00"/></default-field></field><field name="maxAcquireCost" align="right"><default-field title="Max"><display format="#,##0.00"/></default-field></field><field name="averageCost" from="quantityOnHandDiff && totalCost ? totalCost/quantityOnHandDiff : 0.0" align="right"><default-field title="Avg"><display format="#,##0.00"/></default-field></field><field name="quantityOnHandDiff" align="right" show-total="true"><header-field title="Quantity"/><default-field><display format="#,##0"/></default-field></field><field name="totalCost" align="right" show-total="true"><default-field><display format="#,##0.00"/></default-field></field><field name="find"><header-field title="Find"><submit/></header-field></field><form-list-column><field-ref name="pseudoId"/></form-list-column><form-list-column><field-ref name="productName"/></form-list-column><form-list-column><field-ref name="facilityId"/></form-list-column><form-list-column><field-ref name="mfgPartyId"/></form-list-column><form-list-column><field-ref name="lotNumber"/></form-list-column><form-list-column><field-ref name="minAcquireCost"/></form-list-column><form-list-column><field-ref name="maxAcquireCost"/></form-list-column><form-list-column><field-ref name="averageCost"/></form-list-column><form-list-column><field-ref name="quantityOnHandDiff"/></form-list-column><form-list-column><field-ref name="totalCost"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Reports/InvoiceItemSummary.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Invoice Item Summary" default-menu-include="false"><transition name="editProduct"><default-response url="//${appRoot}/Catalog/Product/EditProduct"/></transition><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><actions><set field="invoiceType" from="invoiceType ?: 'Receivable'"/><if condition="'payable'.equalsIgnoreCase(invoiceType)"><then><set field="toRoleTypeId" value="OrgInternal"/></then><else-if condition="'receivable'.equalsIgnoreCase(invoiceType)"><set field="fromRoleTypeId" value="OrgInternal"/></else-if></if></actions><widgets><form-list name="InvoiceItemSummary" list="summaryList" skip-form="true" header-dialog="true" saved-finds="true" select-columns="true" show-csv-button="true" show-xlsx-button="true" show-all-button="true"><entity-find entity-name="mantle.account.invoice.InvoiceItemSummary" list="summaryList" use-clone="true"><search-form-inputs default-order-by="itemTypeEnumId,productId" skip-fields="fromRoleTypeId,toRoleTypeId"><default-parameters statusId="InvoiceApproved,InvoicePmtSent,InvoiceFinalized,InvoiceSent,InvoiceAcked,InvoicePmtRecvd" statusId_op="in" invoiceDate_poffset="-1" invoiceDate_period="month"/></search-form-inputs><econdition field-name="fromRoleTypeId" ignore-if-empty="true"/><econdition field-name="toRoleTypeId" ignore-if-empty="true"/></entity-find><field name="invoiceType"><header-field title="AR/AP"><radio><option key="Receivable"/><option key="Payable"/></radio></header-field></field><field name="invoiceId"><header-field show-order-by="true"/><default-field><display/></default-field></field><field name="invoiceDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="fromPartyId"><header-field title="From"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></header-field><default-field><link url="editParty" text="PartyNameTemplate" entity-name="mantle.party.PartyDetail" link-type="anchor" parameter-map="[partyId:fromPartyId]"/></default-field></field><field name="toPartyId"><header-field title="To"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></header-field><default-field><link url="editParty" text="PartyNameTemplate" entity-name="mantle.party.PartyDetail" link-type="anchor" parameter-map="[partyId:toPartyId]"/></default-field></field><field name="receivableStatuses"><header-field title="Receivable"><display text="In-Process, Finalized, Sent, Acknowledged, Payment Received"/></header-field></field><field name="payableStatuses"><header-field title="Payable"><display text="Incoming, Received, Approved, Payment Sent"/></header-field></field><field name="statusId"><header-field title="Status" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="Invoice"/><set field="allowMultiple" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="invoiceTypeEnumId"><header-field title="Invoice Type" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="InvoiceType"/><set field="allowMultiple" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="itemTypeEnumId"><header-field title="Item Type" show-order-by="true"><drop-down allow-empty="true" allow-multiple="true" show-not="true"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.EnumAndGroup"><econdition field-name="enumGroupEnumId" operator="in" from="['EngItemsSales', 'EngItemsPurchase']"/><order-by field-name="description"/></entity-find></entity-options></drop-down></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="productId"><header-field title="Product" show-order-by="true"><drop-down allow-empty="true" allow-multiple="true"><dynamic-options transition="getProductList" server-search="true" min-length="0"/></drop-down></header-field><default-field><link url="editProduct" text="ProductNameTemplate" entity-name="mantle.product.Product" link-type="anchor" condition="productId"/></default-field></field><field name="minAmount" align="right" show-total="min"><default-field title="Min"><display format="#,##0.00"/></default-field></field><field name="maxAmount" align="right" show-total="max"><default-field title="Max"><display format="#,##0.00"/></default-field></field><field name="avgAmount" align="right" show-total="avg"><default-field title="Avg"><display format="#,##0.00"/></default-field></field><field name="quantityTotal" align="right" show-total="sum"><header-field title="Qty" show-order-by="true"/><default-field><display format="#,##0"/></default-field></field><field name="itemsTotal" align="right" show-total="sum"><header-field title="Total" show-order-by="true"/><default-field><display format="#,##0.00"/></default-field></field><field name="find"><header-field title="Find"><submit/></header-field></field><form-list-column><field-ref name="itemTypeEnumId"/></form-list-column><form-list-column><field-ref name="productId"/></form-list-column><form-list-column><field-ref name="minAmount"/></form-list-column><form-list-column><field-ref name="maxAmount"/></form-list-column><form-list-column><field-ref name="avgAmount"/></form-list-column><form-list-column><field-ref name="quantityTotal"/></form-list-column><form-list-column><field-ref name="itemsTotal"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Reports/InvoiceReconciliation.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="editInvoice"><default-response url="../../Invoice/EditInvoice"/></transition><transition name="editPayment"><default-response url="../../Payment/EditPayment"/></transition><transition name="editTransaction"><default-response url="../../Transaction/EditTransaction"/></transition><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition-include name="getTimePeriodList" location="component://SimpleScreens/template/party/PartyTransitions.xml"/><actions><set field="invoiceType" from="invoiceType ?: 'Receivable'"/><set field="statusIdList" from="invoiceType == 'Payable' ? ['InvoiceApproved','InvoicePmtSent','InvoiceBilledThrough'] : ['InvoiceFinalized','InvoiceSent','InvoiceAcked','InvoicePmtRecvd','InvoiceWriteOff']"/><if condition="'payable'.equalsIgnoreCase(invoiceType)"><then><set field="toRoleTypeId" value="OrgInternal"/></then><else><set field="fromRoleTypeId" value="OrgInternal"/></else></if><set field="glAccountClassEnumId" from="invoiceType == 'Payable' ? 'ACCOUNTS_PAYABLE' : 'ACCOUNTS_RECEIVABLE'"/><if condition="timePeriodId"><then><service-call name="mantle.party.TimeServices.get#TimePeriodInfo" in-map="[timePeriodId:timePeriodId]" out-map="periodInfo"/><set field="asOfDate" from="periodInfo.thruTimestamp"/><set field="organizationPartyId" from="organizationPartyId ?: periodInfo.timePeriod.partyId"/></then><else><set field="asOfDate" from="ec.user.nowTimestamp"/></else></if><script><![CDATA[// look back 12 months
            Calendar asOfCal = ec.user.getNowCalendar()
            asOfCal.setTimeInMillis(asOfDate.time)
            Calendar lookBackCal = (Calendar) asOfCal.clone()
            lookBackCal.add(Calendar.MONTH, -12)
            lookBackDate = new Timestamp(lookBackCal.getTimeInMillis())
            Calendar shortLookBackCal = (Calendar) asOfCal.clone()
            shortLookBackCal.add(Calendar.MONTH, -1)
            shortLookBackDate = new Timestamp(shortLookBackCal.getTimeInMillis())]]></script><set field="glAccountCodeMask" from="ec.user.getPreference('GlAccountCodeMask')"/><set field="accountCodeFormatter" from="masker(glAccountCodeMask, '0')"/></actions><widgets><form-single name="ReportOptions" transition="."><field name="formListFindId"><default-field><hidden/></default-field></field><field name="pageNoLimit"><default-field><hidden/></default-field></field><field name="orderByField"><default-field><hidden/></default-field></field><field name="invoiceType"><default-field title="AR/AP"><radio><option key="Receivable"/><option key="Payable"/></radio></default-field></field><field name="organizationPartyId"><default-field title="Organization"><drop-down><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="partyId" from="activeOrgId" ignore="!activeOrgId"/><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName,firstName,lastName"/></entity-find></entity-options></drop-down></default-field></field><field name="timePeriodId"><default-field title="Time Period"><drop-down><dynamic-options transition="getTimePeriodList" server-search="true" min-length="0" parameter-map="[timePeriodTypeId:'FiscalMonth', pastOnly:'true']"><depends-on field="organizationPartyId" parameter="partyId"/></dynamic-options></drop-down></default-field></field><field name="submitButton"><default-field><submit text="Run Report"/></default-field></field><field-layout><field-row-big><field-ref name="invoiceType"/><field-ref name="organizationPartyId"/><field-ref name="timePeriodId"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single><container><link url="${sri.getScreenUrlInstance().getScreenOnlyPath()}" url-type="plain" text="XLS Export" condition="organizationPartyId" parameter-map="ec.web.requestParameters + [saveFilename:('InvoiceReconciliation_' + organizationPartyId + '.xlsx'),                     renderMode:'xlsx', pageNoLimit:'true', lastStandalone:'true']"/><label text="As of Date ${ec.l10n.format(asOfDate, '')} Look Back Date ${ec.l10n.format(lookBackDate, '')}" type="span"/></container><section name="AgingGlSummarySection" condition="timePeriodId"><actions><entity-find entity-name="mantle.account.invoice.InvoicePaymentApplicationSummary" list="invoiceAgingList" use-clone="true"><econdition field-name="statusId" operator="in" from="statusIdList"/><econdition field-name="fromPartyId" from="organizationPartyId" ignore="invoiceType != 'Receivable'"/><econdition field-name="toPartyId" from="organizationPartyId" ignore="invoiceType != 'Payable'"/><econditions combine="or"><econditions><econdition field-name="isAdjustment" operator="not-equals" value="Y" or-null="true"/><econdition field-name="itemInvoiceDate" operator="less-equals" from="asOfDate"/></econditions><econditions><econdition field-name="isAdjustment" value="Y"/><econdition field-name="itemDate" operator="less-equals" from="asOfDate"/></econditions></econditions><econdition field-name="appliedDate" operator="less-equals" from="asOfDate"/><econdition field-name="toAppliedDate" operator="less-equals" from="asOfDate"/><econdition field-name="fromRoleTypeId" ignore-if-empty="true"/><econdition field-name="toRoleTypeId" ignore-if-empty="true"/><econditions combine="or"><econdition field-name="itemsTotal" operator="not-equals" to-field-name="totalAmountApplied"/><econditions><econdition field-name="itemsTotal" operator="not-equals" from="0.0"/><econdition field-name="amountApplied" operator="is-null"/><econdition field-name="toAmountApplied" operator="is-null"/></econditions></econditions><select-field field-name="invoiceId,itemsTotal,amountApplied,toAmountApplied,totalAmountApplied"/></entity-find><set field="itemsTotalSum" from="invoiceAgingList.sum({ it.itemsTotal ?: 0.0 }) ?: 0.0"/><set field="amountAppliedSum" from="(invoiceAgingList.sum({ it.amountApplied ?: 0.0 }) ?: 0.0) + (invoiceAgingList.sum({ it.toAmountApplied ?: 0.0 }) ?: 0.0)"/><set field="invoiceUnpaid" from="itemsTotalSum - amountAppliedSum"/><entity-find entity-name="mantle.ledger.report.GlAccountOrgTimePeriodDetail" list="glSummaryList" use-clone="true"><econdition field-name="organizationPartyId"/><econdition field-name="timePeriodId"/><econdition field-name="glAccountClassEnumId"/><econdition field-name="endingBalance" operator="not-equals" from="0.0"/><select-field field-name="accountCode,accountName,endingBalance"/></entity-find><set field="glEndingTotal" from="glSummaryList*.endingBalance.sum() ?: 0.0"/></actions><widgets><container-row><row-col sm="6"><container-row><row-col sm="4" style="text-right"><label text="${ec.l10n.format(invoiceUnpaid - glEndingTotal, '#,##0.00')}" type="h4"/></row-col><row-col sm="8"><label text="Aging - GL Difference" type="h4"/></row-col><row-col sm="4" style="text-right"><label text="${ec.l10n.format(invoiceUnpaid, '#,##0.00')}" type="h4"/></row-col><row-col sm="8"><label text="${invoiceType} Aging Unpaid" type="h4"/></row-col></container-row></row-col><row-col sm="6"><container style="row"><section-iterate name="GlSummarySection" list="glSummaryList" entry="glSummary"><widgets><container style="col-sm-4 text-right"><label text="${ec.l10n.format(glSummary.endingBalance, '#,##0.00')}" type="h4"/></container><container style="col-sm-8"><label text="GlAccountNameTemplate" text-map="glSummary" type="h4"/></container></widgets></section-iterate></container></row-col></container-row></widgets></section><container-box><box-header title="Invoices where Unpaid different from GL Amount"/><box-body-nopad><form-list name="InvoiceVsGlList" list="invoiceGlList" skip-form="true"><entity-find entity-name="mantle.account.invoice.InvoiceGlImpactSummary" list="invoiceGlList" use-clone="true"><econditions combine="or"><econditions><econdition field-name="isAdjustment" operator="not-equals" value="Y" or-null="true"/><econdition field-name="itemInvoiceDate" operator="less-equals" from="asOfDate"/></econditions><econditions><econdition field-name="isAdjustment" value="Y"/><econdition field-name="itemDate" operator="less-equals" from="asOfDate"/></econditions></econditions><econdition field-name="appliedDate" operator="less-equals" from="asOfDate"/><econdition field-name="toAppliedDate" operator="less-equals" from="asOfDate"/><econdition field-name="invoiceDate" operator="greater-equals" from="lookBackDate"/><econdition field-name="statusId" operator="in" from="statusIdList"/><econdition field-name="fromPartyId" from="organizationPartyId" ignore="invoiceType != 'Receivable'"/><econdition field-name="toPartyId" from="organizationPartyId" ignore="invoiceType != 'Payable'"/><econdition field-name="debitGlAccountClassEnumId" from="glAccountClassEnumId"/><econdition field-name="debitTransactionDate" operator="less-equals" from="asOfDate"/><econdition field-name="creditGlAccountClassEnumId" from="glAccountClassEnumId"/><econdition field-name="creditTransactionDate" operator="less-equals" from="asOfDate"/><econdition field-name="unpaidAmount" operator="not-equals" to-field-name="debitMinusCredit" ignore="invoiceType != 'Receivable'"/><econdition field-name="unpaidAmount" operator="not-equals" to-field-name="creditMinusDebit" ignore="invoiceType != 'Payable'"/><select-field field-name="itemsTotal,amountApplied,debitTotal,creditTotal,debitMinusCredit,creditMinusDebit"/><order-by field-name="invoiceDate"/></entity-find><field name="invoiceId"><default-field title="Invoice"><link url="editInvoice" text="${invoiceId}" link-type="anchor"/></default-field></field><field name="referenceNumber"><default-field title="Their Invoice"><display/></default-field></field><field name="invoiceDate"><default-field><display format="yyyy-MM-dd"/></default-field></field><field name="invoiceTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="itemsTotal" align="right" show-total="sum"><default-field title="Invoice"><display format="#,##0.00"/></default-field></field><field name="amountApplied" align="right" show-total="sum"><default-field title="Pmt Applied"><display format="#,##0.00"/></default-field></field><field name="unpaidAmount" align="right" show-total="sum"><default-field title="Unpaid"><display format="#,##0.00"/></default-field></field><field name="glNetAmount" align="right" show-total="sum" from="invoiceType == 'Payable' ? creditMinusDebit : debitMinusCredit"><default-field title="GL Net"><display format="#,##0.00"/></default-field></field><field name="difference" align="right" show-total="sum" from="unpaidAmount - (invoiceType == 'Payable' ? creditMinusDebit : debitMinusCredit)"><default-field title="Diff"><display format="#,##0.00"/></default-field></field></form-list><section name="ShowSqlInvoice" condition="invoiceGlList_xafind?.getQueryTextList()"><widgets><container-dialog id="ShowSqlInvoiceDialog" button-text="Show SQL"><section-iterate name="ShowSqlInvoiceIter" list="invoiceGlList_xafind?.getQueryTextList()" entry="queryText"><widgets><label text="${queryText}" type="p"/><label text="${invoiceGlList_xafind}" type="p"/></widgets></section-iterate></container-dialog></widgets></section></box-body-nopad></container-box><container-box><box-header title="Payments where Applied different from GL Amount"/><box-body-nopad><form-list name="PaymentVsGlList" list="paymentGlList" skip-form="true"><entity-find entity-name="mantle.account.payment.PaymentGlImpactSummary" list="paymentGlList" use-clone="true"><econdition field-name="toPartyId" from="organizationPartyId" ignore="invoiceType != 'Receivable'"/><econdition field-name="fromPartyId" from="organizationPartyId" ignore="invoiceType != 'Payable'"/><econdition field-name="effectiveDate" operator="greater-equals" from="shortLookBackDate"/><econdition field-name="effectiveDate" operator="less-equals" from="asOfDate"/><econdition field-name="appliedDate" operator="less-equals" from="asOfDate"/><econdition field-name="debitGlAccountClassEnumId" from="glAccountClassEnumId"/><econdition field-name="debitTransactionDate" operator="less-equals" from="asOfDate"/><econdition field-name="creditGlAccountClassEnumId" from="glAccountClassEnumId"/><econdition field-name="creditTransactionDate" operator="less-equals" from="asOfDate"/><econdition field-name="amountApplied" operator="not-equals" to-field-name="creditMinusDebit" ignore="invoiceType != 'Receivable'"/><econdition field-name="amountApplied" operator="not-equals" to-field-name="debitMinusCredit" ignore="invoiceType != 'Payable'"/><select-field field-name="amountApplied,debitTotal,creditTotal,debitMinusCredit,creditMinusDebit"/><order-by field-name="effectiveDate"/></entity-find><field name="paymentId"><default-field title="Payment"><link url="editPayment" text="${paymentId}" link-type="anchor"/></default-field></field><field name="paymentRefNum"><default-field title="Ref Num"><display/></default-field></field><field name="effectiveDate"><default-field><display format="yyyy-MM-dd"/></default-field></field><field name="paymentTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="amountApplied" align="right" show-total="sum"><default-field title="Pmt Applied"><display format="#,##0.00"/></default-field></field><field name="glNetAmount" align="right" show-total="sum" from="invoiceType == 'Payable' ? debitMinusCredit : creditMinusDebit"><default-field title="GL Net"><display format="#,##0.00"/></default-field></field><field name="difference" align="right" show-total="sum" from="amountApplied - (invoiceType == 'Payable' ? debitMinusCredit : creditMinusDebit)"><default-field title="Diff"><display format="#,##0.00"/></default-field></field></form-list><section name="ShowSqlPayment" condition="paymentGlList_xafind?.getQueryTextList()"><widgets><container-dialog id="ShowSqlPaymentDialog" button-text="Show SQL"><section-iterate name="ShowSqlPaymentIter" list="paymentGlList_xafind?.getQueryTextList()" entry="queryText"><widgets><label text="${queryText}" type="p"/><label text="${paymentGlList_xafind}" type="p"/></widgets></section-iterate></container-dialog></widgets></section></box-body-nopad></container-box><container-box><box-header title="GL Transactions not Posted"/><box-body-nopad><form-list name="NotPostedTxList" list="notPostedTxList" skip-form="true"><entity-find entity-name="mantle.ledger.transaction.AcctgTrans" list="notPostedTxList" use-clone="true"><econdition field-name="transactionDate" operator="greater-equals" from="lookBackDate"/><econdition field-name="transactionDate" operator="less-equals" from="asOfDate"/><econdition field-name="isPosted" operator="not-equals" value="Y" or-null="true"/><order-by field-name="transactionDate"/></entity-find><row-actions><service-call name="mantle.ledger.LedgerServices.calculate#AcctgTransTrialBalance" in-map="[acctgTransId:acctgTransId]" out-map="context"/></row-actions><field name="acctgTransId"><default-field title="Transaction"><link url="editTransaction" text="${acctgTransId}" link-type="anchor"/></default-field></field><field name="acctgTransTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="transactionDate"><default-field title="Date"><display/></default-field></field><field name="otherPartyId"><default-field><link url="editParty" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" link-type="anchor" parameter-map="[partyId:otherPartyId]"/></default-field></field><field name="invoiceId"><default-field title="Invoice"><link url="editInvoice" text="${invoiceId}" link-type="anchor"/></default-field></field><field name="paymentId"><default-field title="Payment"><link url="editPayment" text="${paymentId}" link-type="anchor"/></default-field></field><field name="shipmentId"><default-field title="Shipment"><link url="editShipment" text="${shipmentId}" link-type="anchor"/></default-field></field><field name="assetId"><default-field title="Asset"><link url="assetDetail" text="${assetId}" link-type="anchor"/></default-field></field><field name="debitTotal" align="right"><default-field title="Total"><display currency-unit-field="amountUomId"/></default-field></field></form-list></box-body-nopad></container-box><container-box><box-header title="GL Transactions where Debits do not equal Credits"/><box-body-nopad><form-list name="CreditNeqDebitTxList" list="neqTxList" skip-form="true"><entity-find entity-name="mantle.ledger.transaction.AcctgTransDebitCreditSummary" list="neqTxList" use-clone="true"><econdition field-name="transactionDate" operator="greater-equals" from="lookBackDate"/><econdition field-name="transactionDate" operator="less-equals" from="asOfDate"/><econdition field-name="debitTotal" operator="not-equals" to-field-name="creditTotal"/><order-by field-name="transactionDate"/></entity-find><row-actions><service-call name="mantle.ledger.LedgerServices.calculate#AcctgTransTrialBalance" in-map="[acctgTransId:acctgTransId]" out-map="context"/></row-actions><field name="acctgTransId"><default-field title="Transaction"><link url="editTransaction" text="${acctgTransId}" link-type="anchor"/></default-field></field><field name="acctgTransTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="transactionDate"><default-field title="Date"><display/></default-field></field><field name="otherPartyId"><default-field><link url="editParty" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" link-type="anchor" parameter-map="[partyId:otherPartyId]"/></default-field></field><field name="invoiceId"><default-field title="Invoice"><link url="editInvoice" text="${invoiceId}" link-type="anchor"/></default-field></field><field name="paymentId"><default-field title="Payment"><link url="editPayment" text="${paymentId}" link-type="anchor"/></default-field></field><field name="shipmentId"><default-field title="Shipment"><link url="editShipment" text="${shipmentId}" link-type="anchor"/></default-field></field><field name="assetId"><default-field title="Asset"><link url="assetDetail" text="${assetId}" link-type="anchor"/></default-field></field><field name="debitTotal" align="right"><default-field title="Debits"><display currency-unit-field="amountUomId"/></default-field></field><field name="creditTotal" align="right"><default-field title="Credits"><display currency-unit-field="amountUomId"/></default-field></field></form-list></box-body-nopad></container-box><container-box><box-header title="AR/AP Transactions with no Invoice"/><box-body-nopad><form-list name="NoInvoiceTxList" list="noInvoiceTxList" skip-form="true"><entity-find entity-name="mantle.ledger.transaction.AcctgTransAndEntryGlaSummary" list="noInvoiceTxList" use-clone="true"><econdition field-name="glAccountClassEnumId"/><econdition field-name="transactionDate" operator="greater-equals" from="lookBackDate"/><econdition field-name="transactionDate" operator="less-equals" from="asOfDate"/><econdition field-name="reversedByAcctgTransId" operator="is-null"/><econdition field-name="reverseOfAcctgTransId" operator="is-null"/><econdition field-name="invoiceId" operator="is-null"/><order-by field-name="transactionDate"/></entity-find><row-actions><service-call name="mantle.ledger.LedgerServices.calculate#AcctgTransTrialBalance" in-map="[acctgTransId:acctgTransId]" out-map="context"/></row-actions><field name="acctgTransId"><default-field title="Transaction"><link url="editTransaction" text="${acctgTransId}" link-type="anchor"/></default-field></field><field name="acctgTransTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="transactionDate"><default-field title="Date"><display/></default-field></field><field name="otherPartyId"><default-field><link url="editParty" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" link-type="anchor" parameter-map="[partyId:otherPartyId]"/></default-field></field><field name="debitTotal" align="right"><default-field title="Total"><display currency-unit-field="amountUomId"/></default-field></field></form-list></box-body-nopad></container-box><container-box><box-header title="Payment Applications with Invoice after Period"/><box-body-nopad><form-list name="ApplicationFutureInvoiceList" list="applicationFutureInvoiceList" skip-form="true"><entity-find entity-name="mantle.account.payment.PaymentApplicationAndInvoice" list="applicationFutureInvoiceList" use-clone="true"><econdition field-name="appliedDate" operator="greater-equals" from="fromDate"/><econdition field-name="appliedDate" operator="less-equals" from="thruDate"/><econdition field-name="invoiceDate" operator="greater" from="thruDate"/></entity-find><field name="paymentApplicationId"><default-field title="Application ID"><display/></default-field></field><field name="paymentId"><default-field title="Payment"><link url="editPayment" text="${paymentId}" link-type="anchor"/></default-field></field><field name="appliedDate"><default-field><display/></default-field></field><field name="invoiceId"><default-field title="Invoice"><link url="editInvoice" text="${invoiceId}" link-type="anchor"/></default-field></field><field name="invoiceDate"><default-field><display/></default-field></field></form-list></box-body-nopad></container-box></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Reports/OrderIssuedInvoiced.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Order Issued and Invoiced" default-menu-include="false"><transition name="editProduct"><default-response url="//${appRoot}/Catalog/Product/EditProduct"/></transition><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition name="orderDetail"><default-response url="//${appRoot}/Order/OrderDetail"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><actions><entity-find entity-name="moqui.basic.EnumGroupMember" list="productItemTypeEgms" cache="true"><econdition field-name="enumGroupEnumId" value="EngItemsProduct"/></entity-find><set field="productItemTypes" from="productItemTypeEgms*.enumId"/></actions><widgets><form-list name="OrderIssuedInvoiced" list="oisbsList" skip-form="true" header-dialog="true" select-columns="true" saved-finds="true" show-csv-button="true" show-xlsx-button="true" show-all-button="true"><entity-find entity-name="mantle.order.OrderItemShipBillSummary" list="oisbsList" use-clone="true"><search-form-inputs default-order-by="placedDate"><default-parameters statusId_op="in" statusId="OrderApproved,OrderCompleted,OrderHold" placedDate_poffset="-3" placedDate_period="30d"/></search-form-inputs><econdition field-name="vendorRoleTypeId" value="OrgInternal"/><econdition field-name="itemTypeEnumId" operator="in" from="productItemTypes"/><econditions combine="or"><econdition field-name="issuedQuantity" operator="is-null" ignore="filterBy == 'billed'"/><econdition field-name="quantity" operator="not-equals" to-field-name="issuedQuantity" ignore="filterBy == 'billed'"/><econdition field-name="billedQuantity" operator="is-null" ignore="filterBy == 'issued'"/><econdition field-name="quantity" operator="not-equals" to-field-name="billedQuantity" ignore="filterBy == 'issued'"/></econditions><select-field field-name="productId,unitAmount"/></entity-find><field name="filterBy"><header-field><radio no-current-selected-key="both"><option key="both" text="Both"/><option key="issued" text="Not Issued"/><option key="billed" text="Not Invoiced"/></radio></header-field></field><field name="placedDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display format="yyyy-MM-dd"/></default-field></field><field name="orderId"><header-field show-order-by="true"><text-find size="15" hide-options="ignore-case"/></header-field><default-field><link url="orderDetail" text="${orderId}" link-type="anchor"/></default-field></field><field name="orderItemSeqId"><header-field title="Item" show-order-by="true"/><default-field><display/></default-field></field><field name="statusId"><header-field title="Status" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="OrderHeader"/><set field="allowMultiple" value="true"/><set field="allowEmpty" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="customerPartyId"><header-field title="Customer" show-order-by="true"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2" parameter-map="[roleTypeId:'Customer,OrgInternal']"/></drop-down></header-field><default-field><link url="editParty" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" link-type="anchor" parameter-map="[partyId:customerPartyId]"/></default-field></field><field name="productId"><header-field title="Product" show-order-by="true"><drop-down allow-empty="true" allow-multiple="true"><dynamic-options transition="getProductList" server-search="true" min-length="0"/></drop-down></header-field></field><field name="pseudoId" show-total="count"><header-field title="Product" show-order-by="true"/><default-field><link url="editProduct" text="${pseudoId}" link-type="anchor" condition="productId"/></default-field></field><field name="productName"><header-field title="Name" show-order-by="true"/><default-field><link url="editProduct" text="${productName}" link-type="anchor"/></default-field></field><field name="quantity" align="right" show-total="sum"><header-field show-order-by="true"><range-find size="15"/></header-field><default-field><display format="#,##0"/></default-field></field><field name="itemTotal" from="quantity * unitAmount" align="right" show-total="sum"><default-field><display format="#,##0.00"/></default-field></field><field name="issuedQuantity" align="right" show-total="sum"><header-field title="Issued" show-order-by="true"><range-find size="15"/></header-field><default-field><display format="#,##0"/></default-field></field><field name="issuedTotal" from="(issuedQuantity?:0.0) * unitAmount" align="right" show-total="sum"><default-field><display format="#,##0.00"/></default-field></field><field name="billedQuantity" align="right" show-total="sum"><header-field title="Billed" show-order-by="true"><range-find size="15"/></header-field><default-field><display format="#,##0"/></default-field></field><field name="billedTotal" from="(billedQuantity?:0.0) * unitAmount" align="right" show-total="sum"><default-field><display format="#,##0.00"/></default-field></field><field name="find"><header-field title="Find"><submit/></header-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Reports/OrderItemSummary.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Order Item Summary" default-menu-include="false"><transition name="editProduct"><default-response url="//${appRoot}/Catalog/Product/EditProduct"/></transition><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><actions><set field="orderType" from="orderType ?: 'Sales'"/><if condition="'sales'.equalsIgnoreCase(orderType)"><then><set field="vendorRoleTypeId" value="OrgInternal"/></then><else-if condition="'purchase'.equalsIgnoreCase(orderType)"><set field="customerRoleTypeId" value="OrgInternal"/></else-if></if></actions><widgets><form-list name="OrderItemSummary" list="summaryList" skip-form="true" header-dialog="true" saved-finds="true" select-columns="true" show-csv-button="true" show-xlsx-button="true" show-all-button="true"><entity-find entity-name="mantle.order.OrderItemAndPartSummary" list="summaryList" use-clone="true"><search-form-inputs default-order-by="itemTypeEnumId,productId" skip-fields="customerRoleTypeId,vendorRoleTypeId"><default-parameters statusId="OrderApproved,OrderSent,OrderCompleted" statusId_op="in" placedDate_poffset="-1" placedDate_period="month"/></search-form-inputs><econdition field-name="customerRoleTypeId" ignore-if-empty="true"/><econdition field-name="vendorRoleTypeId" ignore-if-empty="true"/></entity-find><field name="orderType"><header-field><radio no-current-selected-key="Any"><option key="Any"/><option key="Sales"/><option key="Purchase"/></radio></header-field></field><field name="placedDate"><header-field><date-period/></header-field></field><field name="vendorPartyId"><header-field title="Vendor"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="0" parameter-map="[roleTypeId:'Supplier,Vendor,OrgInternal']"/></drop-down></header-field><default-field><link url="editParty" text="PartyNameTemplate" entity-name="mantle.party.PartyDetail" link-type="anchor" parameter-map="[partyId:vendorPartyId]"/></default-field></field><field name="customerPartyId"><header-field title="Customer"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2" parameter-map="[roleTypeId:'Customer,OrgInternal']"/></drop-down></header-field><default-field><link url="editParty" text="PartyNameTemplate" entity-name="mantle.party.PartyDetail" link-type="anchor" parameter-map="[partyId:customerPartyId]"/></default-field></field><field name="statusId"><header-field title="Status" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="OrderHeader"/><set field="allowMultiple" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="itemTypeEnumId"><header-field title="Item Type" show-order-by="true"><drop-down allow-empty="true" allow-multiple="true"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.EnumAndGroup"><econdition field-name="enumGroupEnumId" operator="in" from="['EngItemsSales', 'EngItemsPurchase']"/><order-by field-name="description"/></entity-find></entity-options></drop-down></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="productId"><header-field title="Product" show-order-by="true"><drop-down allow-empty="true" allow-multiple="true"><dynamic-options transition="getProductList" server-search="true" min-length="0"/></drop-down></header-field><default-field><link url="editProduct" text="ProductNameTemplate" entity-name="mantle.product.Product" link-type="anchor" condition="productId"/></default-field></field><field name="minAmount" align="right" show-total="min"><default-field title="Min"><display format="#,##0.00"/></default-field></field><field name="maxAmount" align="right" show-total="max"><default-field title="Max"><display format="#,##0.00"/></default-field></field><field name="avgAmount" align="right" show-total="avg"><default-field title="Avg"><display format="#,##0.00"/></default-field></field><field name="quantity" align="right" show-total="sum"><header-field title="Qty" show-order-by="true"/><default-field><display format="#,##0"/></default-field></field><field name="itemTotal" align="right" show-total="sum"><header-field title="Total" show-order-by="true"/><default-field><display format="#,##0.00"/></default-field></field><field name="find"><header-field title="Find"><submit/></header-field></field><form-list-column><field-ref name="itemTypeEnumId"/></form-list-column><form-list-column><field-ref name="productId"/></form-list-column><form-list-column><field-ref name="minAmount"/></form-list-column><form-list-column><field-ref name="maxAmount"/></form-list-column><form-list-column><field-ref name="avgAmount"/></form-list-column><form-list-column><field-ref name="quantity"/></form-list-column><form-list-column><field-ref name="itemTotal"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Reports/PostedAmountSummary.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><parameter name="organizationPartyId" required="true"/><parameter name="fromDate"/><parameter name="thruDate"/><parameter name="dateRange_period"/><parameter name="dateRange_poffset"/><transition name="PostedAmountSummaryExport.csv"><default-response url="."><parameter name="renderMode" value="csv"/><parameter name="pageNoLimit" value="true"/><parameter name="lastStandalone" value="true"/><parameter name="saveFilename" value="PostedAmountSummaryExport-${organizationPartyId}.csv"/></default-response></transition><transition name="PostedAmountSummaryExport.xml"><default-response url="."><parameter name="renderMode" value="xml"/><parameter name="pageNoLimit" value="true"/><parameter name="lastStandalone" value="true"/><parameter name="saveFilename" value="PostedAmountSummaryExport-${organizationPartyId}.xml"/></default-response></transition><actions><service-call name="mantle.ledger.LedgerServices.find#PartyAcctgPreference" out-map="context" in-map="[organizationPartyId:organizationPartyId]"/><if condition="dateRange_period"><set field="rangeList" from="ec.user.getPeriodRange(dateRange_period, dateRange_poffset, dateRange_pdate)"/><set field="fromDate" from="rangeList[0]"/><set field="thruDate" from="rangeList[1]"/></if><service-call name="mantle.ledger.LedgerReportServices.run#PostedAmountSummary" out-map="context" in-map="context"/><set field="glAccountCodeMask" from="partyAcctgPreference?.glAccountCodeMask ?: ec.user.getPreference('GlAccountCodeMask')"/><set field="accountCodeFormatter" from="masker(glAccountCodeMask, '0')"/></actions><widgets><container><link url="PostedAmountSummaryExport.csv" text="Get as CSV" expand-transition-url="false"/><link url="PostedAmountSummaryExport.xml" text="Get as XML" expand-transition-url="false"/></container><form-list name="ResultListForm" skip-form="true" list="resultList"><field name="accountCode"><default-field title="Acct Code"><display text="${accountCodeFormatter != null ? accountCodeFormatter.valueToString(accountCode) : accountCode}"/></default-field></field><field name="accountName"><default-field><display/></default-field></field><field name="glAccountClassEnumId"><default-field title="Account Class"><display-entity entity-name="moqui.basic.Enumeration" key-field-name="enumId" text="${description}"/></default-field></field><field name="debitAmount"><default-field><display currency-unit-field="currencyUomId"/></default-field></field><field name="creditAmount"><default-field><display currency-unit-field="currencyUomId"/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Reports/PostedBalanceSummary.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><parameter name="organizationPartyId" required="true"/><parameter name="fromDate"/><parameter name="thruDate"/><parameter name="timePeriodId"/><transition name="PostedBalanceSummaryExport.csv"><default-response url="."><parameter name="renderMode" value="csv"/><parameter name="pageNoLimit" value="true"/><parameter name="lastStandalone" value="true"/><parameter name="saveFilename" value="PostedBalanceSummaryExport-${organizationPartyId}-${timePeriodId}.csv"/></default-response></transition><transition name="PostedBalanceSummaryExport.xml"><default-response url="."><parameter name="renderMode" value="xml"/><parameter name="pageNoLimit" value="true"/><parameter name="lastStandalone" value="true"/><parameter name="saveFilename" value="PostedBalanceSummaryExport-${organizationPartyId}-${timePeriodId}.xml"/></default-response></transition><actions><service-call name="mantle.ledger.LedgerServices.find#PartyAcctgPreference" out-map="context" in-map="[organizationPartyId:organizationPartyId]"/><entity-find entity-name="mantle.ledger.report.GlAccountOrgTimePeriodDetail" list="resultList"><econdition field-name="organizationPartyId"/><econdition field-name="fromDate" operator="greater-equals" from="fromDate" ignore-if-empty="true"/><econdition field-name="thruDate" operator="less-equals" from="thruDate" ignore-if-empty="true"/><econdition field-name="timePeriodId" ignore-if-empty="true"/><order-by field-name="accountCode"/></entity-find><set field="glAccountCodeMask" from="partyAcctgPreference?.glAccountCodeMask ?: ec.user.getPreference('GlAccountCodeMask')"/><set field="accountCodeFormatter" from="masker(glAccountCodeMask, '0')"/></actions><widgets><container><link url="PostedBalanceSummaryExport.csv" text="Get as CSV" expand-transition-url="false"/><link url="PostedBalanceSummaryExport.xml" text="Get as XML" expand-transition-url="false"/></container><form-list name="ResultList" skip-form="true" list="resultList" show-csv-button="true" show-xlsx-button="true"><row-actions><entity-find-one entity-name="moqui.basic.Enumeration" value-field="classEnum"><field-map field-name="enumId" from="glAccountClassEnumId"/></entity-find-one></row-actions><field name="periodName"><default-field><display/></default-field></field><field name="fromDate"><default-field><display/></default-field></field><field name="thruDate"><default-field><display/></default-field></field><field name="accountCode"><default-field title="Acct Code"><display text="${accountCodeFormatter != null ? accountCodeFormatter.valueToString(accountCode) : accountCode}"/></default-field></field><field name="accountName"><default-field><display text="${accountName} (${classEnum.description})"/></default-field></field><field name="beginningBalance"><default-field><display currency-unit-field="partyAcctgPreference?.baseCurrencyUomId"/></default-field></field><field name="postedDebits"><default-field><display currency-unit-field="partyAcctgPreference?.baseCurrencyUomId"/></default-field></field><field name="postedCredits"><default-field><display currency-unit-field="partyAcctgPreference?.baseCurrencyUomId"/></default-field></field><field name="endingBalance"><default-field><display currency-unit-field="partyAcctgPreference?.baseCurrencyUomId"/></default-field></field><field name="isClosed"><default-field><display/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Reports/RetainedEarningsStatement.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><parameter name="organizationPartyId" required="true"/><parameter name="timePeriodIdList" required="true"/><actions><service-call name="mantle.ledger.LedgerReportServices.run#RetainedEarningsStatement" out-map="context" in-map="context"/></actions><widgets><render-mode><text type="html,vuet,qvt" location="component://SimpleScreens/template/ledger/RetainedEarningsStatement.html.ftl" template="true" encode="false" no-boundary-comment="true"/></render-mode></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Reports/SalesInvoiceAnalysis.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Sales Invoice Analysis" default-menu-include="false"><transition name="editProduct"><default-response url="//${appRoot}/Catalog/Product/EditProduct"/></transition><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition name="editInvoice"><default-response url="//${appRoot}/Accounting/Invoice/EditInvoice"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><actions><set field="invoiceDate_poffset" from="invoiceDate_poffset ?: '-1'"/><set field="invoiceDate_period" from="invoiceDate_period ?: 'month'"/><entity-find entity-name="moqui.basic.EnumGroupMember" list="productItemTypeEgms" cache="true"><econdition field-name="enumGroupEnumId" value="EngItemsProduct"/></entity-find><set field="productItemTypes" from="productItemTypeEgms*.enumId"/><if condition="!assetClassEnumId"><set field="assetClassEnumId" value="AsClsInventoryFin"/></if></actions><widgets><form-list name="SalesInvoiceAnalysis" list="summaryList" skip-form="true" header-dialog="true" saved-finds="true" show-csv-button="true" show-xlsx-button="true" show-all-button="true"><entity-find entity-name="mantle.account.invoice.InvoiceItemSalesSummary" list="summaryList" use-clone="true"><search-form-inputs default-order-by="pseudoId" paginate="false" skip-fields="assetClassEnumId"/><econdition field-name="invoiceStatusId" operator="in" from="['InvoiceFinalized', 'InvoiceSent', 'InvoiceAcked', 'InvoicePmtRecvd']"/><econdition field-name="itemTypeEnumId" operator="in" from="productItemTypes"/><select-field field-name="productId"/></entity-find><field name="invoiceDate"><header-field title="Period"><date-period/></header-field></field><field name="productId"><header-field title="Product" show-order-by="true"><drop-down allow-empty="true" allow-multiple="true"><dynamic-options transition="getProductList" server-search="true" min-length="0"/></drop-down></header-field></field><field name="pseudoId" show-total="count"><header-field title="Product" show-order-by="true"/><default-field><link url="editProduct" text="${pseudoId}" link-type="anchor" condition="productId"/></default-field></field><field name="productName"><header-field title="Name" show-order-by="true"/><default-field><link url="editProduct" text="${productName}" link-type="anchor"/><label text="${pseudoId} Products" condition="!productId"/></default-field></field><field name="productStoreId"><header-field title="Store" show-order-by="true"><drop-down allow-empty="true" allow-multiple="true"><entity-options key="${productStoreId}" text="${productStoreId}: ${storeName}"><entity-find entity-name="mantle.product.store.ProductStore"><order-by field-name="storeName"/></entity-find></entity-options></drop-down></header-field></field><field name="minAmount" align="right" show-total="min"><default-field title="Min"><display format="#,##0.00"/></default-field></field><field name="maxAmount" align="right" show-total="max"><default-field title="Max"><display format="#,##0.00"/></default-field></field><field name="avgAmount" align="right" show-total="avg"><default-field title="Avg"><display format="#,##0.00"/></default-field></field><field name="quantity" align="right" show-total="sum"><header-field title="Invoice Qty" show-order-by="true"><range-find size="15"/></header-field><default-field><display format="#,##0"/></default-field></field><field name="totalSales" align="right" show-total="sum"><header-field show-order-by="true"><range-find size="15"/></header-field><default-field><display format="#,##0.00"/></default-field></field><field name="averageCost" align="right" show-total="avg"><default-field title="Avg Cost"><display format="#,##0.00"/></default-field></field><field name="issuedQuantity" align="right" show-total="sum"><header-field title="Issued Qty" show-order-by="true"/><default-field><display format="#,##0"/></default-field></field><field name="totalCost" align="right" show-total="sum"><header-field show-order-by="true"><range-find size="15"/></header-field><default-field><display format="#,##0.00"/></default-field></field><field name="marginAmount" from="(totalSales ?: 0.0) - (totalCost ?: 0.0)" align="right" show-total="true"><default-field title="Margin"><display format="#,##0.00"/></default-field></field><field name="marginPercent" align="right"><default-field title="Margin %"><display text="${ec.l10n.format(totalSales ? ((((totalSales ?: 0.0) - (totalCost ?: 0.0)).divide(totalSales, 10, BigDecimal.ROUND_HALF_EVEN))*100.0) : 0.0, '0.00')}"/></default-field></field><field name="costPercent" align="right"><default-field title="Cost %"><display text="${ec.l10n.format(totalSales ? (((totalCost ?: 0.0).divide(totalSales, 10, BigDecimal.ROUND_HALF_EVEN))*100.0) : 0.0, '0.00')}"/></default-field></field><field name="find"><header-field title="Find"><submit/></header-field></field></form-list><section name="ShowSql" condition="summaryList_xafind?.getQueryTextList()"><widgets><container-dialog id="ShowSqlDialog" button-text="Show SQL"><section-iterate name="ShowSqlIter" list="summaryList_xafind?.getQueryTextList()" entry="queryText"><widgets><label text="${queryText}" type="p"/><label text="${summaryList_xafind}" type="p"/></widgets></section-iterate></container-dialog></widgets></section></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Reports/SalesAnalysis.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Sales Order Analysis" default-menu-include="false"><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition name="editProductStore"><default-response url="//${appRoot}/ProductStore/EditProductStore"/></transition><transition name="editProduct"><default-response url="//${appRoot}/Catalog/Product/EditProduct"/></transition><transition name="orderDetail"><default-response url="//${appRoot}/Order/OrderDetail"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><actions><set field="pageSize" from="pageSize ?: '100'"/><set field="orderStatusList" from="['OrderPlaced', 'OrderProcessing', 'OrderApproved', 'OrderSent', 'OrderCompleted', 'OrderHold']"/><entity-find entity-name="moqui.basic.EnumGroupMember" list="productItemTypeEgms" cache="true"><econdition field-name="enumGroupEnumId" value="EngItemsProduct"/></entity-find><set field="productItemTypes" from="productItemTypeEgms*.enumId"/></actions><widgets><form-list name="SalesAnalysis" list="summaryList" skip-form="true" header-dialog="true" select-columns="true" saved-finds="true" show-csv-button="true" show-xlsx-button="true" show-all-button="true"><entity-find entity-name="mantle.order.OrderItemSalesSummary" list="summaryList" use-clone="true"><search-form-inputs default-order-by="vendorPartyId,pseudoId"><default-parameters placedDate_poffset="0" placedDate_period="month"/></search-form-inputs><econdition field-name="vendorRoleTypeId" value="OrgInternal"/><econdition field-name="orderStatusId" operator="in" from="orderStatusList"/><econdition field-name="partStatusId" operator="in" from="orderStatusList" or-null="true"/><econdition field-name="itemTypeEnumId" operator="in" from="productItemTypes"/><select-field field-name="totalSales,totalCost"/></entity-find><field name="placedDate"><header-field title="Placed Date"><date-period/></header-field></field><field name="vendorPartyId"><header-field title="Vendor" show-order-by="true"><drop-down allow-empty="true" allow-multiple="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="0" parameter-map="[roleTypeId:'OrgInternal']"/></drop-down></header-field><default-field><link url="editParty" text="PartyNameTemplate" link-type="anchor" condition="vendorPartyId" entity-name="mantle.party.PartyDetail" parameter-map="[partyId:vendorPartyId]"/></default-field></field><field name="customerPartyId"><header-field title="Customer" show-order-by="true"><drop-down allow-empty="true" allow-multiple="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="0" parameter-map="[roleTypeId:'Customer']"/></drop-down></header-field><default-field><link url="editParty" text="PartyNameTemplate" link-type="anchor" condition="vendorPartyId" entity-name="mantle.party.PartyDetail" parameter-map="[partyId:customerPartyId]"/></default-field></field><field name="productStoreId"><header-field title="Store" show-order-by="true"><drop-down allow-empty="true" allow-multiple="true"><entity-options key="${productStoreId}" text="${productStoreId}: ${storeName}"><entity-find entity-name="mantle.product.store.ProductStore"><order-by field-name="storeName"/></entity-find></entity-options></drop-down></header-field><default-field><link url="editProductStore" text="${productStoreId}: ${storeName}" link-type="anchor" condition="productStoreId" entity-name="mantle.product.store.ProductStore"/></default-field></field><field name="productId"><header-field title="Product" show-order-by="true"><drop-down allow-empty="true" allow-multiple="true"><dynamic-options transition="getProductList" server-search="true" min-length="0"/></drop-down></header-field></field><field name="pseudoId"><header-field title="Prod ID" show-order-by="true"/><default-field><display/></default-field></field><field name="productName"><header-field title="Product Name" show-order-by="true"/><default-field><display/></default-field></field><field name="orderId"><header-field show-order-by="true"><text-find size="15" hide-options="ignore-case"/></header-field><default-field><link url="orderDetail" text="${orderId}" link-type="anchor"/></default-field></field><field name="minUnitAmount" align="right" show-total="min"><default-field title="Min"><display format="#,##0.00"/></default-field></field><field name="maxUnitAmount" align="right" show-total="max"><default-field title="Max"><display format="#,##0.00"/></default-field></field><field name="averageAmount" from="totalSales && quantity ? totalSales/quantity : 0.0" align="right" show-total="avg"><default-field title="Avg"><display format="#,##0.00"/></default-field></field><field name="quantity" align="right" show-total="sum"><header-field show-order-by="true"/><default-field><display format="#,##0"/></default-field></field><field name="totalSales" align="right" show-total="sum"><header-field show-order-by="true"/><default-field><display format="#,##0.00"/></default-field></field><field name="issuedQuantity" align="right" show-total="sum"><header-field show-order-by="true"/><default-field><display format="#,##0"/></default-field></field><field name="totalIssued" align="right" show-total="sum"><header-field show-order-by="true"/><default-field><display format="#,##0.00"/></default-field></field><field name="totalCost" align="right" show-total="sum"><header-field show-order-by="true"/><default-field><display format="#,##0.00"/></default-field></field><field name="marginAmount" from="(totalIssued ?: 0.0) - (totalCost ?: 0.0)" align="right" show-total="true"><default-field title="Margin Amount"><display format="#,##0.00"/></default-field></field><field name="marginPercent" align="right"><default-field title="Margin Percent"><display text="${ec.l10n.format(totalIssued ? ((((totalIssued ?: 0.0) - (totalCost ?: 0.0)).divide(totalIssued, 10, BigDecimal.ROUND_HALF_EVEN))*100.0) : 0.0, '0.00')}"/></default-field></field><field name="find"><header-field title="Find"><submit/></header-field></field><form-list-column><field-ref name="vendorPartyId"/><field-ref name="productStoreId"/></form-list-column><form-list-column><field-ref name="pseudoId"/><field-ref name="productName"/></form-list-column><form-list-column><field-ref name="minUnitAmount"/></form-list-column><form-list-column><field-ref name="maxUnitAmount"/></form-list-column><form-list-column><field-ref name="averageAmount"/></form-list-column><form-list-column><field-ref name="quantity"/></form-list-column><form-list-column><field-ref name="totalSales"/></form-list-column><form-list-column><field-ref name="issuedQuantity"/></form-list-column><form-list-column><field-ref name="totalIssued"/></form-list-column><form-list-column><field-ref name="totalCost"/></form-list-column><form-list-column><field-ref name="marginAmount"/></form-list-column><form-list-column><field-ref name="marginPercent"/></form-list-column></form-list><section name="ShowSql" condition="summaryList_xafind?.getQueryTextList()"><widgets><container-dialog id="ShowSqlDialog" button-text="Show SQL" type="info"><section-iterate name="ShowSqlIter" list="summaryList_xafind?.getQueryTextList()" entry="queryText"><widgets><label text="${queryText}" type="p"/><label text="${summaryList_xafind}" type="p"/></widgets></section-iterate></container-dialog></widgets></section></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Reports/SalesSummary.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Sales Summary" default-menu-include="false"><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><actions><set field="interval" from="interval ?: 'w'"/><set field="maPeriods" from="(maPeriods ?: '0') as Integer"/><service-call name="mantle.sales.SalesReportServices.get#SalesOrderSummary" out-map="context" in-map="[interval:(interval?:'w'), intervalCount:intervalCount, thruDate:thruDate, maPeriods:maPeriods,                     vendorPartyIds:vendorPartyIds, customerPartyIds:customerPartyIds, productStoreIds:productStoreIds,                     customerClassificationIds:customerClassificationIds, productIds:productIds]"/><if condition="salesOrderSummaryList == null"><return error="true" message="ElasticSearch not available"/></if><service-call name="mantle.sales.SalesReportServices.get#SalesInvoiceSummary" out-map="context" in-map="[interval:(interval?:'w'), intervalCount:intervalCount, thruDate:thruDate, maPeriods:maPeriods,                     fromPartyIds:vendorPartyIds, toPartyIds:customerPartyIds, productStoreIds:productStoreIds,                     customerClassificationIds:customerClassificationIds, productIds:productIds]"/><service-call name="mantle.sales.SalesReportServices.get#SalesTopProduct" out-map="context" transaction="force-new" ignore-error="true" in-map="[interval:(interval?:'w'), intervalCount:intervalCount, thruDate:thruDate, topLimit:(topLimit?:15)]"/><service-call name="mantle.sales.SalesReportServices.get#InvoicesByCustomerClass" out-map="context" transaction="force-new" ignore-error="true" in-map="[interval:(interval?:'w'), intervalCount:intervalCount, thruDate:thruDate]"/><script><![CDATA[import java.math.RoundingMode

            defaultColors = ['rgba(92, 184, 92, 1.0)', 'rgba(91, 192, 222, 1.0)', 'rgba(240, 173, 78, 1.0)', 'rgba(217, 83, 79, 1.0)',
                    'rgba(60, 118, 61, 1.0)', 'rgba(49, 112, 143, 1.0)', 'rgba(138, 109, 59, 1.0)', 'rgba(169, 68, 66, 1.0)',
                    'rgba(223, 240, 216, 1.0)', 'rgba(217, 237, 247, 1.0)', 'rgba(252, 248, 227, 1.0)', 'rgba(242, 222, 222, 1.0)']

            orderSummaryNoTotals = salesOrderSummaryList.subList(0, salesOrderSummaryList.size() - 2)
            invoiceSummaryNoTotals = salesInvoiceSummaryList.subList(0, salesInvoiceSummaryList.size() - 2)
            orderLabelList = orderSummaryNoTotals*.dateKey
            invoiceLabelList = invoiceSummaryNoTotals*.dateKey

            newCustomerPercentList = orderSummaryNoTotals*.newCustomerPercent.collect({ (it * 100.0).setScale(1, RoundingMode.HALF_UP) })
            newCustomerPercentMaList = orderSummaryNoTotals*.newCustomerPercentMa.collect({ (it * 100.0).setScale(1, RoundingMode.HALF_UP) })
            orderProductSaleTotalList = orderSummaryNoTotals*.productSaleTotal.collect({ it.setScale(2, RoundingMode.HALF_UP) })
            orderNetSalesList = orderSummaryNoTotals*.netSales.collect({ it.setScale(2, RoundingMode.HALF_UP) })
            orderDiscountPercentList = orderSummaryNoTotals*.discountPercent.collect({ (it * 100.0).setScale(1, RoundingMode.HALF_UP) })
            orderDiscountPercentMaList = orderSummaryNoTotals*.discountPercentMa.collect({ (it * 100.0).setScale(1, RoundingMode.HALF_UP) })

            invoiceTotalList = invoiceSummaryNoTotals*.invoiceTotal.collect({ it.setScale(2, RoundingMode.HALF_UP) })
            invoiceTotalMaList = invoiceSummaryNoTotals*.invoiceTotalMa.collect({ it.setScale(2, RoundingMode.HALF_UP) })
            invoicePaidPercentList = invoiceSummaryNoTotals*.paidPercent.collect({ (it * 100.0).setScale(1, RoundingMode.HALF_UP) })
            invoicePaidPercentMaList = invoiceSummaryNoTotals*.paidPercentMa.collect({ (it * 100.0).setScale(1, RoundingMode.HALF_UP) })
            invoicePrePaidPercentList = invoiceSummaryNoTotals*.prePaidPercent.collect({ (it * 100.0).setScale(1, RoundingMode.HALF_UP) })
            invoicePrePaidPercentMaList = invoiceSummaryNoTotals*.prePaidPercentMa.collect({ (it * 100.0).setScale(1, RoundingMode.HALF_UP) })
            invoiceCostPercentList = invoiceSummaryNoTotals*.costPercent.collect({ (it * 100.0).setScale(1, RoundingMode.HALF_UP) })
            invoiceCostPercentMaList = invoiceSummaryNoTotals*.costPercentMa.collect({ (it * 100.0).setScale(1, RoundingMode.HALF_UP) })
            invoiceDiscountPercentList = invoiceSummaryNoTotals*.discountPercent.collect({ (it * 100.0).setScale(1, RoundingMode.HALF_UP) })
            invoiceDiscountPercentMaList = invoiceSummaryNoTotals*.discountPercentMa.collect({ (it * 100.0).setScale(1, RoundingMode.HALF_UP) })

            countSummaryDatasets = [
                    [label: 'Orders', backgroundColor: defaultColors[0], borderColor: defaultColors[0], fill: false,
                            data: orderSummaryNoTotals*.orderCount],
                    [label: 'New Customers', backgroundColor: defaultColors[1], borderColor: defaultColors[1], fill: false,
                            data: orderSummaryNoTotals*.newCustomerOrderCount],
                    [label: 'New Customer %', backgroundColor: defaultColors[3].replace('1.0', '0.5'), borderColor: defaultColors[3].replace('1.0', '0.5'), fill: false,
                            yAxisID:'rightSide', data:newCustomerPercentList],
                    [label: 'Invoices', backgroundColor: defaultColors[2], borderColor: defaultColors[2], fill: false,
                            data: invoiceSummaryNoTotals*.invoiceCount],
            ]
            orderAmountsDatasets = [
                    [label: 'Product Ordered', backgroundColor: defaultColors[0], borderColor: defaultColors[0], fill: false,
                            data: orderProductSaleTotalList],
                    [label: 'Order Discounts', backgroundColor: defaultColors[1], borderColor: defaultColors[1], fill: false,
                            data: orderSummaryNoTotals*.discountTotal.collect({ -it.setScale(2, RoundingMode.HALF_UP) })],
                    [label: 'Discount %', backgroundColor: defaultColors[3].replace('1.0', '0.5'), borderColor: defaultColors[3].replace('1.0', '0.5'), fill: false,
                            yAxisID: 'rightSide', data: orderDiscountPercentList ],
            ]
            invoiceMarginDatasets = [
                    [label: 'Product Invoiced', backgroundColor: defaultColors[0], borderColor: defaultColors[0], fill: false, type:'line',
                            data: invoiceSummaryNoTotals*.productSaleTotal.collect({ it.setScale(2, RoundingMode.HALF_UP) })],
                    [label: 'Invoice Discounts', backgroundColor: defaultColors[1].replace('1.0', '0.4'), borderColor: defaultColors[1], stack:'DiscCost',
                            data: invoiceSummaryNoTotals*.discountTotal.collect({ -it.setScale(2, RoundingMode.HALF_UP) })],
                    [label: 'Product Cost', backgroundColor: defaultColors[4].replace('1.0', '0.4'), borderColor: defaultColors[4], stack:'DiscCost',
                            data: invoiceSummaryNoTotals*.productCostTotal.collect({ it.setScale(2, RoundingMode.HALF_UP) })],
            ]
            discountCostDatasets = [
                    [label: 'Order Discount %', backgroundColor: defaultColors[0], borderColor: defaultColors[0], fill: false,
                            data: orderDiscountPercentList],
                    [label: 'Invoice Discount %', backgroundColor: defaultColors[1], borderColor: defaultColors[1], fill: false,
                            data: invoiceDiscountPercentList],
                    [label: 'Invoice Cost %', backgroundColor: defaultColors[2], borderColor: defaultColors[2], fill: false,
                            data: invoiceCostPercentList],
            ]]]></script><set field="statsPanelColStyle" value="col-lg-3 col-md-4 col-sm-4 col-xs-6"/><set field="statsChartColStyle" value="col-md-6 col-sm-6"/><if condition="vendorPartyIds"><set field="vendorPartyIdList" from="vendorPartyIds instanceof List ? vendorPartyIds : (vendorPartyIds.split(',') as List)"/><entity-find entity-name="mantle.party.PartyDetail" list="selectedVendorPartyList"><econdition field-name="partyId" operator="in" from="vendorPartyIdList"/><order-by field-name="pseudoId"/></entity-find></if><if condition="productStoreIds"><set field="productStoreIdList" from="productStoreIds instanceof List ? productStoreIds : (productStoreIds.split(',') as List)"/><entity-find entity-name="mantle.product.store.ProductStore" list="selectedProductStoreList"><econdition field-name="productStoreId" operator="in" from="productStoreIdList"/><order-by field-name="storeName"/></entity-find></if><if condition="customerClassificationIds"><set field="customerClassificationIdList" from="customerClassificationIds instanceof List ? customerClassificationIds : (customerClassificationIds.split(',') as List)"/><entity-find entity-name="mantle.party.PartyClassification" list="selectedClassificationList"><econdition field-name="partyClassificationId" operator="in" from="customerClassificationIdList"/><order-by field-name="description"/></entity-find></if><if condition="customerPartyIds"><set field="customerPartyIdList" from="customerPartyIds instanceof List ? customerPartyIds : (customerPartyIds.split(',') as List)"/><entity-find entity-name="mantle.party.PartyDetail" list="selectedCustomerPartyList"><econdition field-name="partyId" operator="in" from="customerPartyIdList"/><order-by field-name="pseudoId"/></entity-find></if><if condition="productIds"><set field="productIdList" from="productIds instanceof List ? productIds : (productIds.split(',') as List)"/><entity-find entity-name="mantle.product.Product" list="selectedProductList"><econdition field-name="productId" operator="in" from="productIdList"/><order-by field-name="pseudoId"/></entity-find></if></actions><widgets><container-dialog id="SummaryOptionsDialog" button-text="Summary Options"><form-single name="SummaryOptions"><field name="interval"><default-field><drop-down><option key="d" text="Day"/><option key="w" text="Week"/><option key="M" text="Month"/><option key="q" text="Quarter"/><option key="y" text="Year"/></drop-down></default-field></field><field name="intervalCount"><default-field title="Periods"><text-line size="2" default-value="13"/></default-field></field><field name="thruDate"><default-field><date-time type="date"/></default-field></field><field name="maPeriods"><default-field title="MA Periods" tooltip="Moving Average look back periods, set to 0 to disable"><text-line size="2" default-value="0"/></default-field></field><field name="vendorPartyIds"><default-field title="Vendors"><drop-down allow-empty="true" allow-multiple="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="0" parameter-map="[roleTypeId:'OrgInternal']"/></drop-down></default-field></field><field name="productStoreIds"><default-field title="Stores"><drop-down allow-empty="true" allow-multiple="true"><entity-options key="${productStoreId}" text="${productStoreId}: ${storeName}"><entity-find entity-name="mantle.product.store.ProductStore"><order-by field-name="storeName"/></entity-find></entity-options></drop-down></default-field></field><field name="customerClassificationIds"><default-field title="Customer Classes"><drop-down allow-multiple="true"><entity-options key="${partyClassificationId}" text="${description}"><entity-find entity-name="mantle.party.PartyClassification"><econdition field-name="classificationTypeEnumId" value="PcltCustomer"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="customerPartyIds"><default-field title="Customers"><drop-down allow-empty="true" allow-multiple="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="0" parameter-map="[roleTypeId:'Customer']"/></drop-down></default-field></field><field name="productIds"><default-field title="Products"><drop-down allow-multiple="true"><dynamic-options transition="getProductList" server-search="true" min-length="0" parameter-map="[assetClassEnumId:'AsClsInventoryFin']"/></drop-down></default-field></field><field name="productNote"><default-field title=""><label text="NOTE: Invoice level stats (total, pre-paid, paid, etc) are not available by Product and will show as having no data"/></default-field></field><field name="submitButton"><default-field title="Submit"><submit/></default-field></field></form-single></container-dialog><container><label text="Sales Summary for ${intervalCount?:13} ${[d:'Days', w:'Weeks', M:'Months', q:'Quarters', y:'Years'].get(interval?:'w')}${thruDate ? ' thru ' + ec.l10n.format(thruDate, 'dd MMM yyyy') : ''}${maPeriods ? ' with ' + maPeriods + ' Period MA' : ''}" type="h3"/><label text="Vendors: ${selectedVendorPartyList.collect({ ec.resource.expand('PartyNameTemplate', '', it) }).join(', ')}" condition="selectedVendorPartyList" type="h5"/><label text="Stores: ${selectedProductStoreList.collect({ it.productStoreId + ': ' + it.storeName }).join(', ')}" condition="selectedProductStoreList" type="h5"/><label text="Customer Classes: ${selectedClassificationList*.description.join(', ')}" condition="selectedClassificationList" type="h5"/><label text="Customers: ${selectedCustomerPartyList.collect({ ec.resource.expand('PartyNameTemplate', '', it) }).join(', ')}" condition="selectedCustomerPartyList" type="h5"/><label text="Products: ${selectedProductList.collect({ ec.resource.expand('ProductNameTemplate', '', it) }).join(', ')}" condition="selectedProductList" type="h5"/></container><render-mode><text type="html,vuet,qvt" location="component://SimpleScreens/screen/SimpleScreens/Accounting/Reports/SalesSummaryStats.html.ftl"/></render-mode><render-mode><text type="html,vuet,qvt" location="component://SimpleScreens/screen/SimpleScreens/Accounting/Reports/SalesSummaryCharts.html.ftl"/></render-mode><container-box><box-header title="Top Products Ordered (${[d:'Day', w:'Week', M:'Month', q:'Quarter', y:'Year'].get(interval?:'w')} from ${ec.l10n.format(topProductStart, 'dd MMM yyyy')} to ${ec.l10n.format((topProductEnd ? topProductEnd - 1 : null), 'dd MMM yyyy')})"/><box-body-nopad><form-list name="TopProductList" list="topProductList" skip-form="true"><field name="productId"><default-field title="Product"><display-entity entity-name="mantle.product.Product" text="ProductNameTemplate"/></default-field></field><field name="totalSales" align="right"><default-field title="Sales"><display format="#,##0.00"/></default-field></field><field name="totalQuantity" align="right"><default-field title="Quantity"><display/></default-field></field><field name="productIssuedTotal" align="right"><default-field title="Total Issued"><display format="#,##0.00"/></default-field></field><field name="productCostTotal" align="right"><default-field title="Total Cost"><display format="#,##0.00"/></default-field></field><field name="costPercent" align="right"><default-field title="Cost %"><display format="0.0%"/></default-field></field><field name="marginPercent" from="1 - (costPercent ?: 0.0)" align="right"><default-field title="Margin %"><display format="0.0%"/></default-field></field><field name="percentOfTotal" from="ordersLast?.totalSales ? (totalSales / ordersLast.totalSales) : 0.0" align="right"><default-field title="% of Sales"><display format="0.0%"/></default-field></field></form-list></box-body-nopad></container-box><container-box><box-header title="Sales Orders by Placed Date"/><box-body-nopad><form-list name="SalesOrderSummaryList" list="salesOrderSummaryList" skip-form="true"><row-actions><set field="rowStyle" from="dateKey?.charAt(0)?.letter ? 'text-strong' : ''"/></row-actions><field name="dateKey"><default-field title="Period" container-style="${rowStyle}"><display/></default-field></field><field name="orderCount" align="right"><default-field title="Orders" container-style="${rowStyle}"><display/></default-field></field><field name="newCustomerOrderCount" align="right"><default-field title="New Cust" container-style="${rowStyle}"><display/></default-field></field><field name="newCustomerPercent" align="right"><default-field title="New %" container-style="${rowStyle}"><display format="0.0%"/></default-field></field><field name="orderCount" align="right"><default-field title="Orders" container-style="${rowStyle}"><display/></default-field></field><field name="productQuantityTotal" align="right"><default-field title="Product Quantity" container-style="${rowStyle}"><display/></default-field></field><field name="totalSales" align="right"><default-field title="Total Sales" container-style="${rowStyle}"><display format="#,##0.00"/></default-field></field><field name="productSaleTotal" align="right"><default-field title="Product Sold" container-style="${rowStyle}"><display format="#,##0.00"/></default-field></field><field name="discountTotal" align="right"><default-field title="Discounts" container-style="${rowStyle}"><display format="#,##0.00"/></default-field></field><field name="netSales" align="right"><default-field title="Net Product" container-style="${rowStyle}"><display format="#,##0.00"/></default-field></field><field name="discountPercent" align="right"><default-field title="Disc %" container-style="${rowStyle}"><display format="0.0%"/></default-field></field><field name="productIssuedTotal" align="right"><default-field title="Product Issued" container-style="${rowStyle}"><display format="#,##0.00"/></default-field></field><field name="productCostTotal" align="right"><default-field title="Cost" container-style="${rowStyle}"><display format="#,##0.00"/></default-field></field><field name="costPercent" align="right"><default-field title="Cost %" container-style="${rowStyle}"><display format="0.0%"/></default-field></field></form-list></box-body-nopad></container-box><container-box><box-header title="Invoices by Customer Classification (${[d:'Day', w:'Week', M:'Month', q:'Quarter', y:'Year'].get(interval?:'w')} from ${ec.l10n.format(topCustomerClassStart, 'dd MMM yyyy')} to ${ec.l10n.format((topCustomerClassEnd ? topCustomerClassEnd - 1 : null), 'dd MMM yyyy')})"/><box-body-nopad><form-list name="TopCustomerClassList" list="topCustomerClassList" skip-form="true"><row-actions><set field="rowStyle" from="customerClassId ? '' : 'text-strong'"/></row-actions><field name="classDescription"><default-field title="Classification"><display/></default-field></field><field name="invoiceCount" align="right"><default-field title="Invoices" container-style="${rowStyle}"><display/></default-field></field><field name="productQuantityTotal" align="right"><default-field title="Product Quantity" container-style="${rowStyle}"><display/></default-field></field><field name="invoiceTotal" align="right"><default-field title="Invoices Total" container-style="${rowStyle}"><display format="#,##0.00"/></default-field></field><field name="invoicePaymentsApplied" align="right"><default-field title="Paid Amount" container-style="${rowStyle}"><display format="#,##0.00"/></default-field></field><field name="paidPercent" align="right"><default-field title="Paid %" container-style="${rowStyle}"><display format="0.0%"/></default-field></field><field name="productSaleTotal" align="right"><default-field title="Product Sold" container-style="${rowStyle}"><display format="#,##0.00"/></default-field></field><field name="discountTotal" align="right"><default-field title="Discounts" container-style="${rowStyle}"><display format="#,##0.00"/></default-field></field><field name="netSales" align="right"><default-field title="Net Product" container-style="${rowStyle}"><display format="#,##0.00"/></default-field></field><field name="discountPercent" align="right"><default-field title="Disc %" container-style="${rowStyle}"><display format="0.0%"/></default-field></field><field name="productIssuedTotal" align="right"><default-field title="Product Issued" container-style="${rowStyle}"><display format="#,##0.00"/></default-field></field><field name="productCostTotal" align="right"><default-field title="Cost" container-style="${rowStyle}"><display format="#,##0.00"/></default-field></field><field name="costPercent" align="right"><default-field title="Cost %" container-style="${rowStyle}"><display format="0.0%"/></default-field></field></form-list></box-body-nopad></container-box><container-box><box-header title="Sales Invoices by Invoice Date"/><box-body-nopad><form-list name="SalesInvoiceSummaryList" list="salesInvoiceSummaryList" skip-form="true"><row-actions><set field="rowStyle" from="dateKey?.charAt(0)?.letter ? 'text-strong' : ''"/></row-actions><field name="dateKey"><default-field title="Period" container-style="${rowStyle}"><display/></default-field></field><field name="invoiceCount" align="right"><default-field title="Invoices" container-style="${rowStyle}"><display/></default-field></field><field name="productQuantityTotal" align="right"><default-field title="Product Quantity" container-style="${rowStyle}"><display/></default-field></field><field name="invoiceTotal" align="right"><default-field title="Invoices Total" container-style="${rowStyle}"><display format="#,##0.00"/></default-field></field><field name="invoicePaymentsApplied" align="right"><default-field title="Paid Amount" container-style="${rowStyle}"><display format="#,##0.00"/></default-field></field><field name="paidPercent" align="right"><default-field title="Paid %" container-style="${rowStyle}"><display format="0.0%"/></default-field></field><field name="productSaleTotal" align="right"><default-field title="Product Sold" container-style="${rowStyle}"><display format="#,##0.00"/></default-field></field><field name="discountTotal" align="right"><default-field title="Discounts" container-style="${rowStyle}"><display format="#,##0.00"/></default-field></field><field name="netSales" align="right"><default-field title="Net Product" container-style="${rowStyle}"><display format="#,##0.00"/></default-field></field><field name="discountPercent" align="right"><default-field title="Disc %" container-style="${rowStyle}"><display format="0.0%"/></default-field></field><field name="productIssuedTotal" align="right"><default-field title="Product Issued" container-style="${rowStyle}"><display format="#,##0.00"/></default-field></field><field name="productCostTotal" align="right"><default-field title="Cost" container-style="${rowStyle}"><display format="#,##0.00"/></default-field></field><field name="costPercent" align="right"><default-field title="Cost %" container-style="${rowStyle}"><display format="0.0%"/></default-field></field></form-list></box-body-nopad></container-box></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Reports/ShipmentPackageSummary.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Shipment Package Summary" default-menu-include="false"><transition name="editProduct"><default-response url="//${appRoot}/Catalog/Product/EditProduct"/></transition><transition name="editFacility"><default-response url="//${appRoot}/Facility/EditFacility"/></transition><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition name="assetDetail"><default-response url="//${appRoot}/Asset/AssetDetail"/></transition><transition name="shipmentDetail"><default-response url="//${appRoot}/Shipment/ShipmentDetail"/></transition><transition name="editReturn"><default-response url="//${appRoot}/Return/EditReturn"/></transition><transition name="orderDetail"><default-response url="//${appRoot}/Order/OrderDetail"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getLocationList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><transition-include name="emailScreenAsync" location="component://webroot/template/screen/BasicTransitions.xml"/><actions><if condition="!dateRange_period && !dateRange_from"><set field="dateRange_period" from="dateRange_period ?: 'week'"/><set field="dateRange_poffset" from="dateRange_poffset ?: '-1'"/></if><set field="rangeList" from="ec.user.getPeriodRange('dateRange', context)"/><set field="dateRangeFrom" from="rangeList[0]"/><set field="dateRangeThru" from="rangeList[1] ?: ec.user.nowTimestamp"/><service-call name="org.moqui.impl.BasicServices.find#EnumerationByParent" out-map="outgoingTypeOut" in-map="[parentEnumId:'ShpTpOutgoing']"/><set field="outShipmentTypeSet" from="outgoingTypeOut.enumIdSet"/><service-call name="org.moqui.impl.BasicServices.find#EnumerationByParent" out-map="incomingTypeOut" in-map="[parentEnumId:'ShpTpIncoming']"/><set field="inShipmentTypeSet" from="incomingTypeOut.enumIdSet"/><if condition="!statusId"><set field="statusId" value="ShipPacked,ShipShipped,ShipDelivered"/></if><set field="requireParameters" from="fromOrToPartyId || originOrDestFacilityId ? 'false' : 'true'"/></actions><widgets><section-include name="EmailScreenSection" location="component://webroot/template/screen/BasicTransitions.xml"/><form-list name="ShipmentPackageSummary" list="summaryList" skip-form="true" header-dialog="true" saved-finds="true" select-columns="true" show-all-button="true" show-csv-button="true" show-xlsx-button="true"><entity-find entity-name="mantle.shipment.ShipmentPackageSummary" list="summaryList" use-clone="true"><search-form-inputs default-order-by="actualStartDate,actualArrivalDate" require-parameters="${requireParameters}" skip-fields="statusId"/><econdition field-name="statusId" operator="in" ignore-if-empty="true"/><econditions combine="or"><econditions><econdition field-name="actualStartDate" operator="greater-equals" from="dateRangeFrom"/><econdition field-name="actualStartDate" operator="less" from="dateRangeThru"/><econdition field-name="shipmentTypeEnumId" operator="in" from="outShipmentTypeSet"/></econditions><econditions><econdition field-name="actualArrivalDate" operator="greater-equals" from="dateRangeFrom"/><econdition field-name="actualArrivalDate" operator="less" from="dateRangeThru"/><econdition field-name="shipmentTypeEnumId" operator="in" from="inShipmentTypeSet"/></econditions></econditions><econditions combine="or"><econdition field-name="fromPartyId" from="fromOrToPartyId" ignore-if-empty="true"/><econdition field-name="toPartyId" from="fromOrToPartyId" ignore-if-empty="true"/></econditions><econditions combine="or"><econdition field-name="originFacilityId" from="originOrDestFacilityId" ignore-if-empty="true"/><econdition field-name="destinationFacilityId" from="originOrDestFacilityId" ignore-if-empty="true"/></econditions></entity-find><field name="requiredFields"><header-field title=""><label text="To get results an option other than Actual Date and Status is required"/></header-field></field><field name="dateRange"><header-field title="Actual Date"><date-period/></header-field></field><field name="fromOrToPartyId"><header-field title="From or To Party"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="0" parameter-map="[roleTypeId:'OrgInternal']"/></drop-down></header-field></field><field name="fromPartyId"><header-field title="From Party"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></header-field><default-field><link url="editParty" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" link-type="anchor" parameter-map="[partyId:fromPartyId]" condition="fromPartyId"/></default-field></field><field name="toPartyId"><header-field title="To Party"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></header-field><default-field><link url="editParty" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" link-type="anchor" parameter-map="[partyId:toPartyId]" condition="toPartyId"/></default-field></field><field name="originOrDestFacilityId"><header-field title="Origin or Dest Facility"><drop-down allow-empty="true"><entity-options text="FacilityNameTemplate"><entity-find entity-name="mantle.facility.Facility"><econdition field-name="facilityTypeEnumId" value="FcTpWarehouse"/><order-by field-name="facilityName"/></entity-find></entity-options></drop-down></header-field></field><field name="originFacilityId"><header-field title="Origin Facility"><drop-down allow-empty="true"><entity-options text="FacilityNameTemplate"><entity-find entity-name="mantle.facility.Facility"><econdition field-name="facilityTypeEnumId" value="FcTpWarehouse"/><order-by field-name="facilityName"/></entity-find></entity-options></drop-down></header-field><default-field><link url="editFacility" entity-name="mantle.facility.Facility" text="FacilityNameTemplate" link-type="anchor"/></default-field></field><field name="destinationFacilityId"><header-field title="Dest Facility"><drop-down allow-empty="true"><entity-options text="FacilityNameTemplate"><entity-find entity-name="mantle.facility.Facility"><econdition field-name="facilityTypeEnumId" value="FcTpWarehouse"/><order-by field-name="facilityName"/></entity-find></entity-options></drop-down></header-field><default-field><link url="editFacility" entity-name="mantle.facility.Facility" text="FacilityNameTemplate" link-type="anchor"/></default-field></field><field name="productId"><header-field title="Product" show-order-by="true"><drop-down allow-empty="true"><dynamic-options transition="getProductList" server-search="true" min-length="0"/></drop-down></header-field></field><field name="shipmentId"><header-field title="Shipment" show-order-by="true"/><default-field><link url="shipmentDetail" text="${shipmentId}" link-type="anchor" condition="shipmentId"/></default-field></field><field name="statusId"><header-field title="Status" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="Shipment"/><set field="allowMultiple" value="true"/><set field="showNot" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="shipmentTypeEnumId"><header-field title="Type" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ShipmentType"/><set field="allowEmpty" value="true"/><set field="showNot" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="entryDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="packedDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="actualStartDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="actualArrivalDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="orderId"><header-field title="Order ID"/><default-field><link url="orderDetail" text="${orderId}" link-type="anchor" condition="orderId"/></default-field></field><field name="orderDisplayId"><default-field title="Order Display ID"><link url="orderDetail" text="${orderDisplayId}" link-type="anchor" condition="orderId"/><label text="${orderDisplayId?:''}" condition="!orderId"/></default-field></field><field name="orderPlacedDate"><default-field title="Order Placed"><display/></default-field></field><field name="orderPartSeqId"><header-field title="Order Part"/><default-field><display/></default-field></field><field name="returnId"><header-field title="Return"/><default-field><link url="editReturn" text="${returnId}" link-type="anchor" condition="returnId"/></default-field></field><field name="returnDisplayId"><header-field title="Return Display"/><default-field><link url="editReturn" text="${returnDisplayId}" link-type="anchor" condition="returnId"/></default-field></field><field name="returnEntryDate"><default-field title="Return Entry"><display/></default-field></field><field name="shipmentPackageSeqId"><default-field title="Shipment Package #"><display/></default-field></field><field name="trackingCode"><default-field><display/></default-field></field><field name="trackingStatusEnumId"><header-field title="Tracking Status"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ShipmentTrackingStatus"/><set field="allowMultiple" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="returnTrackingCode"><default-field><display/></default-field></field><field name="returnTrackingStatusEnumId"><header-field title="Return Tracking Status"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ShipmentTrackingStatus"/><set field="allowMultiple" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="shipmentBoxTypeId"><header-field title="Box Type"><drop-down allow-empty="true"><entity-options text="${pseudoId}: ${description}"><entity-find entity-name="mantle.shipment.ShipmentBoxType"><order-by field-name="description"/></entity-find></entity-options></drop-down></header-field><default-field><display-entity entity-name="mantle.shipment.ShipmentBoxTypeDetail" text="${pseudoId}: ${description} (${ec.l10n.format(boxLength,'')}x${ec.l10n.format(boxWidth,'')}x${ec.l10n.format(boxHeight,'')}${dimensionAbbreviation})"/></default-field></field><field name="boxPseudoId"><default-field title="Box ID"><display/></default-field></field><field name="boxDescription"><default-field><display/></default-field></field><field name="boxLength"><default-field><display/></default-field></field><field name="boxWidth"><default-field><display/></default-field></field><field name="boxHeight"><default-field><display/></default-field></field><field name="dimensionUomId"><default-field title="Box Dim. UOM"><display-entity entity-name="moqui.basic.Uom"/></default-field></field><field name="boxWeight"><default-field><display/></default-field></field><field name="boxWeightUomId"><default-field title="Box Weight UOM"><display-entity entity-name="moqui.basic.Uom"/></default-field></field><field name="packageCount" align="right" show-total="sum"><default-field><display/></default-field></field><field name="quantityTotal" align="right" show-total="sum"><default-field title="Pkg Quantity"><display/></default-field></field><field name="estimatedAmountTotal" align="right" show-total="sum"><default-field title="Ship Cost"><display format="#,##0.00"/></default-field></field><field name="baseAmountTotal" align="right" show-total="sum"><default-field title="Ship Cost (base)"><display format="#,##0.00"/></default-field></field><field name="weightTotal" align="right" show-total="sum"><default-field title="Pkg Weight"><display/></default-field></field><field name="weightUomId"><default-field title="Package Weight UOM"><display-entity entity-name="moqui.basic.Uom"/></default-field></field><field name="orderProductQuantity" align="right"><default-field title="Order All Product Quantity"><display/></default-field></field><field name="shippingChargeTotal" align="right"><default-field title="Order Shipping Charge Total"><display format="#,##0.00"/></default-field></field><field name="shippingDiscountTotal" align="right"><default-field title="Order Shipping Discount Total"><display format="#,##0.00"/></default-field></field><field name="shippingCharge" align="right" show-total="sum" from="orderProductQuantity ? (shippingChargeTotal?:0.0) * ((quantityTotal?:0.0) / orderProductQuantity) : 0.0"><default-field title="Shipping Charge Prorated"><display format="#,##0.00"/></default-field></field><field name="shippingDiscount" align="right" show-total="sum" from="orderProductQuantity ? (shippingDiscountTotal?:0.0) * ((quantityTotal?:0.0) / orderProductQuantity): 0.0"><default-field title="Shipping Discount Prorated"><display format="#,##0.00"/></default-field></field><field name="find"><header-field title="Find"><submit/></header-field></field><form-list-column><field-ref name="shipmentId"/><field-ref name="shipmentTypeEnumId"/></form-list-column><form-list-column><field-ref name="actualStartDate"/><field-ref name="actualArrivalDate"/></form-list-column><form-list-column><field-ref name="orderId"/><field-ref name="orderDisplayId"/></form-list-column><form-list-column><field-ref name="orderPlacedDate"/><field-ref name="packedDate"/></form-list-column><form-list-column><field-ref name="returnId"/><field-ref name="returnDisplayId"/></form-list-column><form-list-column><field-ref name="fromPartyId"/><field-ref name="toPartyId"/></form-list-column><form-list-column><field-ref name="trackingCode"/><field-ref name="shipmentBoxTypeId"/></form-list-column><form-list-column><field-ref name="quantityTotal"/></form-list-column><form-list-column><field-ref name="estimatedAmountTotal"/></form-list-column><form-list-column><field-ref name="weightTotal"/></form-list-column></form-list><section name="ShowSql" condition="summaryList_xafind?.getQueryTextList()"><widgets><container-dialog id="ShowSqlDialog" button-text="Show SQL" type="info"><section-iterate name="ShowSqlIter" list="summaryList_xafind?.getQueryTextList()" entry="queryText"><widgets><label text="${queryText}" type="p"/><label text="${summaryList_xafind}" type="p"/></widgets></section-iterate></container-dialog></widgets></section></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Reports/ReportList.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Report List" default-menu-index="1"><transition name="viewBalanceSheet"><default-response url="../BalanceSheet"/></transition><transition name="viewIncomeStatement"><default-response url="../IncomeStatement"/></transition><transition name="viewCashFlowStatement"><default-response url="../CashFlowStatement"/></transition><transition name="viewRetainedEarningsStatement"><default-response url="../RetainedEarningsStatement"/></transition><transition name="viewFinancialRatios"><default-response url="../FinancialRatios"/></transition><transition name="viewPostedAmountSummary"><default-response url="../PostedAmountSummary"/></transition><transition name="viewPostedBalanceSummary"><default-response url="../PostedBalanceSummary"/></transition><transition-include name="getTimePeriodList" location="component://SimpleScreens/template/party/PartyTransitions.xml"/><transition-include name="getGlAccountListPaginated" location="component://SimpleScreens/template/account/AccountTransitions.xml"/><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition name="receivableStatement"><default-response url="${ec.web.getWebappRootUrl(false, null)}/fop/apps/${appRoot}/Accounting/Invoice/ReceivableStatement" url-type="plain"><parameter name="renderMode" value="xsl-fo"/><parameter name="pageNoLimit" value="true"/><parameter name="toPartyId"/><parameter name="fromPartyId"/><parameter name="periodDays"/><parameter name="asOfDate"/><parameter name="filename" value="Statement-${toPartyId}-${asOfDate ?: ec.l10n.format(ec.user.nowTimestamp, 'yyyy-MM-dd')}.pdf"/></default-response></transition><widgets><container-row><row-col md="6"><container-box><box-header title="Financial Reports"/><box-body><container-dialog id="BalanceSheetDialog" button-text="Balance Sheet"><form-single name="BalanceSheetForm" transition="viewBalanceSheet"><field name="organizationPartyId"><default-field title="Organization"><drop-down><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="partyId" from="activeOrgId" ignore="!activeOrgId"/><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName,firstName,lastName"/></entity-find></entity-options></drop-down></default-field></field><field name="timePeriodIdList"><default-field title="Time Periods"><drop-down allow-multiple="true"><dynamic-options transition="getTimePeriodList" server-search="true" min-length="0" parameter-map="[timePeriodTypeId:'FiscalYear,FiscalQuarter,FiscalMonth', pastOnly:'true']"><depends-on field="organizationPartyId" parameter="partyId"/></dynamic-options></drop-down></default-field></field><field name="detail"><default-field><check><option key="true" text=" "/></check></default-field></field><field name="beginningAndPosted"><default-field><check><option key="true" text=" "/></check></default-field></field><field name="percents"><default-field title="Percent of Assets"><check><option key="true" text=" "/></check></default-field></field><field name="charts"><default-field><ignored/></default-field></field><field name="childOrgPeriods"><default-field><check><option key="true" text=" "/></check></default-field></field><field name="submitButton"><default-field title="Run"><submit/></default-field></field></form-single></container-dialog><container-dialog id="IncomeStatementDialog" button-text="Income Statement"><form-single name="IncomeStatementForm" transition="viewIncomeStatement" extends="BalanceSheetForm"><field name="beginningAndPosted"><default-field><ignored/></default-field></field><field name="percents"><default-field title="Percent of Revenue"><check><option key="true" text=" "/></check></default-field></field><field name="charts"><default-field><check><option key="true" text=" "/></check></default-field></field></form-single></container-dialog><container-dialog id="CashFlowStatementDialog" button-text="Cash Flow"><form-single name="CashFlowStatementForm" transition="viewCashFlowStatement" extends="BalanceSheetForm"><field name="beginningAndPosted"><default-field><ignored/></default-field></field><field name="percents"><default-field><ignored/></default-field></field></form-single></container-dialog><container-dialog id="RetainedEarningsStatementDialog" button-text="Retained Earnings"><form-single name="RetainedEarningsStatementForm" transition="viewRetainedEarningsStatement" extends="BalanceSheetForm"><field name="detail"><default-field><ignored/></default-field></field><field name="beginningAndPosted"><default-field><ignored/></default-field></field><field name="percents"><default-field><ignored/></default-field></field></form-single></container-dialog><container-dialog id="FinancialRatiosDialog" button-text="Financial Ratios"><form-single name="FinancialRatiosForm" transition="viewFinancialRatios" extends="BalanceSheetForm"><field name="detail"><default-field><ignored/></default-field></field><field name="beginningAndPosted"><default-field><ignored/></default-field></field><field name="percents"><default-field><ignored/></default-field></field></form-single></container-dialog></box-body></container-box><container-box><box-header title="Sales and Invoice Reports"/><box-body><container><link url="../SalesSummary" text="Sales Summary"/><link url="../SalesAnalysis" text="Sales Order Analysis"/><link url="../SalesInvoiceAnalysis" text="Sales Invoice Analysis"/><container-dialog id="CustomerStatementDialog" button-text="Customer Statement PDF"><form-single name="CustomerStatementForm" transition="receivableStatement"><field name="fromPartyId"><default-field title="Organization"><drop-down allow-empty="true"><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="partyId" from="activeOrgId" ignore="!activeOrgId"/><econdition field-name="roleTypeId" operator="in" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName,firstName,lastName"/></entity-find></entity-options></drop-down></default-field></field><field name="toPartyId"><default-field title="Customer"><drop-down><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="asOfDate" from="ec.user.nowTimestamp"><default-field><date-time type="date"/></default-field></field><field name="submitButton"><default-field title="Download PDF"><submit/></default-field></field></form-single></container-dialog></container><container><link url="../OrderItemSummary" text="Order Item Summary"/><link url="../OrderIssuedInvoiced" text="Order Issued and Invoiced"/><link url="../InvoiceItemSummary" text="Invoice Item Summary"/></container><container><link url="../../Invoice/Aging" text="Quick Aging"/><link url="../InvoiceAgingDetail" text="Invoice Aging Detail"/><link url="../ArAgingSummary" text="AR Aging Summary"/><link url="../InvoiceReconciliation" text="Invoice Reconciliation"/></container></box-body></container-box></row-col><row-col md="6"><container-box><box-header title="Transaction Reports"/><box-body><container-dialog id="AccountLedgerDialog" button-text="Account Ledger"><form-single name="AccountLedgerForm" transition="../AccountLedger"><field name="organizationPartyId"><default-field title="Organization"><drop-down><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="partyId" from="activeOrgId" ignore="!activeOrgId"/><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName,firstName,lastName"/></entity-find></entity-options></drop-down></default-field></field><field name="timePeriodId"><default-field title="Time Period"><drop-down><dynamic-options transition="getTimePeriodList" server-search="true" min-length="0" parameter-map="[timePeriodTypeId:'FiscalYear,FiscalQuarter,FiscalMonth', pastOnly:'true']"><depends-on field="organizationPartyId" parameter="partyId"/></dynamic-options></drop-down></default-field></field><field name="glAccountIdList"><default-field title="GL Accounts"><drop-down allow-multiple="true"><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0"/></drop-down></default-field></field><field name="submitButton"><default-field title="Run"><submit/></default-field></field></form-single></container-dialog><container-dialog id="AccountBalanceDialog" button-text="Account Balance History"><form-single name="AccountBalanceForm" transition="../AccountBalance"><field name="organizationPartyId"><default-field title="Organization"><drop-down><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="partyId" from="activeOrgId" ignore="!activeOrgId"/><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName,firstName,lastName"/></entity-find></entity-options></drop-down></default-field></field><field name="timePeriodTypeId"><default-field title="Type"><drop-down><option key="FiscalYear" text="Year"/><option key="FiscalQuarter" text="Quarter"/><option key="FiscalMonth" text="Month"/></drop-down></default-field></field><field name="glAccountId"><default-field title="GL Account"><drop-down allow-empty="true"><dynamic-options transition="getGlAccountListPaginated" server-search="true" min-length="0"/></drop-down></default-field></field><field name="submitButton"><default-field title="Run"><submit/></default-field></field></form-single></container-dialog><link url="../../Transaction" text="Transactions"/><link url="../../Transaction/FindTransactionEntry" text="Transaction Entries"/><container><container-dialog id="PostedAmountSummaryDialog" button-text="Posted Amount Summary"><form-single name="PostedAmountSummaryForm" transition="viewPostedAmountSummary"><field name="organizationPartyId"><default-field title="Organization"><widget-template-include location="component://SimpleScreens/template/party/PartyWidgetTemplates.xml#partyDropDownByRole"><set field="roleTypeId" value="OrgInternal"/></widget-template-include></default-field></field><field name="dateRange"><default-field><date-period allow-empty="false"/></default-field></field><field name="submitButton"><default-field title="Run"><submit/></default-field></field></form-single></container-dialog><container-dialog id="PostedBalanceSummaryDialog" button-text="Posted Balance Summary"><form-single name="PostedBalanceSummaryForm" transition="viewPostedBalanceSummary"><field name="organizationPartyId"><default-field title="Organization"><drop-down><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="partyId" from="activeOrgId" ignore="!activeOrgId"/><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName,firstName,lastName"/></entity-find></entity-options></drop-down></default-field></field><field name="timePeriodId"><default-field title="Time Period"><drop-down><dynamic-options transition="getTimePeriodList" server-search="true" min-length="0" parameter-map="[timePeriodTypeId:'FiscalYear,FiscalQuarter,FiscalMonth', pastOnly:'true']"><depends-on field="organizationPartyId" parameter="partyId"/></dynamic-options></drop-down></default-field></field><field name="submitButton"><default-field title="Run"><submit/></default-field></field></form-single></container-dialog></container></box-body></container-box><container-box><box-header title="Asset and Inventory Reports"/><box-body><container><link url="../AssetValuation" text="Inventory Valuation"/><link url="../AssetReceiptTransaction" text="Receipt Transactions"/><link url="../AssetStatusByReceipt" text="Status by Receipt"/></container><container><link url="../AssetOnHand" text="On Hand"/><link url="../AssetOnHandSummary" text="On Hand Summary"/><link url="../ShipmentPackageSummary" text="Shipment Package Summary"/></container></box-body></container-box></row-col></container-row><section-include name="SelectOrganization" location="component://SimpleScreens/template/account/LedgerCharts.xml"/><container-row><row-col md="6"><section-include name="OperatingRevenueExpenseChart" location="component://SimpleScreens/template/account/LedgerCharts.xml"/></row-col><row-col md="6"><section-include name="CurrentAssetLiabilityChart" location="component://SimpleScreens/template/account/LedgerCharts.xml"/></row-col></container-row><container-row><row-col md="6"><section-include name="NetIncomeChart" location="component://SimpleScreens/template/account/LedgerCharts.xml"/></row-col><row-col md="6"><section-include name="BalanceSheetChart" location="component://SimpleScreens/template/account/LedgerCharts.xml"/></row-col></container-row><container-row><row-col md="6"><section-include name="NetIncomeYoyChart" location="component://SimpleScreens/template/account/LedgerCharts.xml"/></row-col><row-col md="6"/></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Reports.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Reports" default-menu-index="20"><subscreens default-item="ReportList"/><widgets><subscreens-panel id="reports-panel" type="popup"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Accounting" default-menu-index="13" menu-image="/ssstatic/images/Accounting.png"><subscreens default-item="dashboard"/><widgets><subscreens-panel id="accounting-panel" type="popup"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Asset/EditLots.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="createLot"><service-call name="create#mantle.product.asset.Lot" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateLot"><service-call name="update#mantle.product.asset.Lot" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><widgets><container-dialog id="CreateLotDialog" button-text="Create Lot"><form-single name="CreateLot" transition="createLot"><field name="mfgPartyId"><default-field title="Manufacturer"><drop-down><dynamic-options transition="searchPartyList" server-search="true" min-length="0" parameter-map="[roleTypeId:'Supplier,Manufacturer']"/></drop-down></default-field></field><field name="lotNumber"><default-field><text-line size="20"/></default-field></field><field name="manufacturedDate"><default-field><date-time/></default-field></field><field name="expirationDate"><default-field><date-time type="date"/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="LotList" list="lotList" transition="updateLot" header-dialog="true" show-csv-button="true"><entity-find entity-name="mantle.product.asset.Lot" list="lotList"><search-form-inputs default-order-by="lotNumber"/></entity-find><field name="lotId"><header-field title="Lot ID" show-order-by="true"><text-find size="15" hide-options="true"/></header-field><default-field><display/></default-field></field><field name="mfgPartyId"><header-field title="Manufacturer"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="0" parameter-map="[roleTypeId:'Supplier,Manufacturer']"/></drop-down></header-field><default-field><drop-down><dynamic-options transition="searchPartyList" server-search="true" min-length="0" parameter-map="[roleTypeId:'Supplier,Manufacturer']"/></drop-down></default-field></field><field name="lotNumber"><header-field show-order-by="case-insensitive"><text-find size="20"/></header-field><default-field><text-line size="15"/></default-field></field><field name="manufacturedDate"><header-field show-order-by="true"><date-period/></header-field><default-field><date-time/></default-field></field><field name="expirationDate"><header-field show-order-by="true"><date-period/></header-field><default-field><date-time type="date"/></default-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field><default-field title="Update"><submit/></default-field></field><field name="assetsLink"><default-field title=""><link url="../Asset/FindAsset" text="Assets" parameter-map="[lotId:lotId]"/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Asset/dashboard.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Dashboard" default-menu-index="1"><transition name="assetOnHand"><default-response url="//${appRoot}/Accounting/Reports/AssetOnHand"/></transition><widgets><container><link url="../Asset/FindSummary" text="Asset Summary"/><link url="../Asset/FindAsset" text="Assets"/><link url="../Asset/SelectAsset" text="Move Asset"/><link url="../PhysicalInventory" text="Physical Inventory"/></container><container><link url="../Container" text="Containers"/><link url="../EditLots" text="Lots"/><link url="../AssetPool" text="Pools"/><link url="assetOnHand" text="On Hand Report"/></container></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Asset/PhysicalInventory/EditPhysicalInventory.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" default-menu-title="Edit Physical Inventory"><parameter name="physicalInventoryId" required="true"/><transition name="editAsset"><default-response url="../../Asset/AssetDetail"/></transition><transition name="editProduct"><default-response url="//${appRoot}/Catalog/Product/EditProduct"/></transition><transition name="editFacility"><default-response url="//${appRoot}/Facility/EditFacility"/></transition><transition name="updatePhysicalInventoryDate"><service-call name="mantle.product.AssetServices.update#PhysicalInventoryDate" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><entity-find-one entity-name="mantle.product.asset.PhysicalInventory" value-field="physicalInventory"/></actions><widgets><container-row><row-col md="6"><form-single name="UpdateMasterEntityValue" transition="updatePhysicalInventoryDate" map="physicalInventory"><field name="physicalInventoryId"><default-field><display/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="facilityId"><default-field title="Facility"><link url="editFacility" entity-name="mantle.facility.Facility" text="FacilityNameTemplate" link-type="anchor"/></default-field></field><field name="physicalInventoryDate"><default-field title="Date"><date-time type="date-time"/></default-field></field><field name="comments"><default-field><text-area cols="100" rows="4"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></row-col><row-col md="6"><container-box><box-header title="Asset Adjustments"/><box-body-nopad><form-list name="AssetDetailList" list="assetList" skip-form="true"><entity-find entity-name="mantle.product.asset.AssetAndDetailSummary" list="assetList"><econdition field-name="physicalInventoryId"/><select-field field-name="productId,pseudoId,productName"/><order-by field-name="pseudoId"/></entity-find><field name="assetId"><default-field title="Asset"><link url="editAsset" text="${assetId}" link-type="anchor"/></default-field></field><field name="productId"><default-field title="Product"><link url="editProduct" text="ProductNameTemplate" link-type="anchor"/></default-field></field><field name="effectiveDate"><default-field><display/></default-field></field><field name="availableToPromiseDiff"><default-field title="ATP Diff"><display/></default-field></field><field name="quantityOnHandDiff"><default-field title="QOH Diff"><display/></default-field></field></form-list></box-body-nopad></container-box></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Asset/PhysicalInventory/FindPhysicalInventory.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" default-menu-title="Find Physical Inventory"><transition name="editPhysicalInventory"><default-response url="../EditPhysicalInventory"/></transition><transition name="editAsset"><default-response url="../../Asset/AssetDetail"/></transition><transition name="editProduct"><default-response url="//${appRoot}/Catalog/Product/EditProduct"/></transition><transition name="editFacility"><default-response url="//${appRoot}/Facility/EditFacility"/></transition><transition-include name="getAssetList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getFacilityList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><transition-include name="getLocationList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><transition name="createPhysicalInventory"><service-call name="create#mantle.product.asset.PhysicalInventory" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditPhysicalInventory"/></transition><transition name="updatePhysicalInventoryDate"><service-call name="mantle.product.AssetServices.update#PhysicalInventoryDate" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><widgets><form-list name="PhysicalInventoryList" list="physicalInventoryList" skip-form="true" header-dialog="true"><entity-find entity-name="mantle.product.asset.PhysicalInventory" list="physicalInventoryList"><search-form-inputs default-order-by="-physicalInventoryDate"><default-parameters physicalInventoryDate_poffset="-3" physicalInventoryDate_period="30d"/></search-form-inputs><select-field field-name="physicalInventoryId"/></entity-find><row-actions><entity-find entity-name="mantle.product.asset.AssetAndDetailSummary" list="assetList" limit="11"><econdition field-name="physicalInventoryId"/><select-field field-name="assetId,productId,pseudoId,productName,availableToPromiseDiff,quantityOnHandDiff,effectiveDate"/><order-by field-name="pseudoId"/></entity-find></row-actions><field name="physicalInventoryId"><header-field title="Phys. Inv. ID" show-order-by="true"><text-find default-operator="begins"/></header-field><default-field><link url="editPhysicalInventory" text="${physicalInventoryId}" link-type="anchor"/></default-field></field><field name="physicalInventoryDate"><header-field title="Date" show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="statusId"><header-field title="Status" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="PhysicalInventory"/><set field="allowMultiple" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="facilityId"><header-field title="Facility" show-order-by="true"><drop-down allow-empty="true"><dynamic-options transition="getFacilityList" server-search="true" min-length="0"/></drop-down></header-field><default-field><link url="editFacility" entity-name="mantle.facility.Facility" text="FacilityNameTemplate" link-type="anchor"/></default-field></field><field name="assetList"><default-field title="Assets"><section-iterate name="AssetListSection" list="assetList" entry="assetProduct"><widgets><container><link url="editAsset" text="${assetProduct.assetId}" link-type="anchor" parameter-map="[assetId:assetProduct.assetId]"/><label text=" - "/><link url="editProduct" text="ProductNameTemplate" text-map="assetProduct" link-type="anchor" parameter-map="[productId:assetProduct.productId]"/><label text="ATP ${ec.l10n.format(assetProduct.availableToPromiseDiff, null)} QOH ${ec.l10n.format(assetProduct.quantityOnHandDiff, null)} at ${ec.l10n.format(assetProduct.effectiveDate, null)}"/></container></widgets></section-iterate></default-field></field><field name="comments"><header-field show-order-by="case-insensitive"><text-find/></header-field><default-field><display/></default-field></field><field name="findButton"><header-field title="Find"><submit/></header-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Asset/PhysicalInventory.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Physical Inventory" default-menu-index="3"><subscreens default-item="FindPhysicalInventory"/><widgets><subscreens-panel id="PhysicalInventoryPanel" type="tab"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Asset/Container/EditContainer.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Container"><parameter name="containerId" required="true" from="containerId ?: toContainerId"/><parameter name="toContainerId"/><transition name="updateContainer"><service-call name="update#mantle.product.asset.Container" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="addAssetToContainer"><service-call name="update#mantle.product.asset.Asset" in-map="[assetId:assetId, containerId:containerId]" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="removeAssetFromContainer"><service-call name="update#mantle.product.asset.Asset" in-map="[assetId:assetId, containerId:null]" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="pickMoveProductToContainer"><service-call name="mantle.shipment.ShipmentServices.pickMove#ProductToContainer" in-map="context + [containerId:null]" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="assetDetail"><default-response url="../../Asset/AssetDetail"/></transition><transition name="editProduct"><default-response url="//${appRoot}/Catalog/Product/EditProduct"/></transition><transition-include name="getAssetList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getFacilityList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><transition-include name="getLocationList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><actions><entity-find-one entity-name="mantle.product.asset.Container" value-field="container"/><entity-find-one entity-name="mantle.facility.FacilityLocation" value-field="facLoc" cache="true"/></actions><widgets><container-row><row-col lg="5"><section name="PickScanSection"><actions><entity-find entity-name="mantle.shipment.Shipment" list="shipmentList"><econdition field-name="pickContainerId" from="containerId"/><econdition field-name="statusId" operator="in" value="ShipInput,ShipScheduled"/><order-by field-name="shipmentId"/></entity-find></actions><widgets><container-dialog id="PickScanDialog" button-text="Pick & Move to Container" condition="shipmentList"><form-single name="PickScanForm" transition="pickMoveProductToContainer"><field name="toContainerId" from="containerId"><default-field><hidden/></default-field></field><field name="quantity" from="1"><default-field><text-line size="4"/></default-field></field><field name="scanProduct"><default-field title=" Scan Product"><text-line size="40"/></default-field></field><field name="scanLocation"><default-field title="Scan From Location"><text-line size="40"/></default-field></field><field name="shipmentId"><default-field title="Shipment"><drop-down allow-empty="true"><list-options list="shipmentList" key="${shipmentId}" text="${shipmentId}"/></drop-down></default-field></field><field name="pickButton"><default-field title=""><submit text="Pick${pickContainer ? ' and Move to Container ' + (pickContainer.serialNumber ?: pickContainer.containerId) : ''}"/></default-field></field></form-single></container-dialog></widgets></section><form-single name="UpdateContainerForm" transition="updateContainer" map="container"><field name="containerId"><default-field><display/></default-field></field><field name="createdDate"><default-field><display/></default-field></field><field name="containerTypeEnumId"><default-field title="Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ContainerType"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="serialNumber"><default-field><text-line size="40"/></default-field></field><field name="description"><default-field><text-line size="40"/></default-field></field><field name="externalId"><default-field><text-line size="20"/></default-field></field><field name="facilityId"><default-field title="Facility"><drop-down allow-empty="true"><dynamic-options transition="getFacilityList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="locationSeqId"><default-field title="Location"><drop-down allow-empty="true"><dynamic-options transition="getLocationList" server-search="true" min-length="0" depends-optional="true"><depends-on field="facilityId"/></dynamic-options></drop-down></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></row-col><row-col lg="7"><container-box><box-header title="Assets"/><box-toolbar><container-dialog id="AddAssetDialog" button-text="Add Asset"><form-single name="AddAssetForm" transition="addAssetToContainer"><field name="containerId"><default-field><hidden/></default-field></field><field name="assetId"><default-field title="Asset"><drop-down allow-empty="true"><dynamic-options transition="getAssetList" server-search="true" min-length="0" parameter-map="[excludeZeroQoh:'true']"/></drop-down></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="AssetListForm" list="assetList" skip-form="true"><entity-find entity-name="mantle.product.asset.AssetAndProduct" list="assetList"><econdition field-name="containerId"/><select-field field-name="assetId,productId,pseudoId,productName"/><order-by field-name="assetId"/></entity-find><field name="asset"><default-field><link url="assetDetail" text="${assetId}" link-type="anchor"/></default-field></field><field name="availableToPromiseTotal"><default-field title="ATP"><display/></default-field></field><field name="quantityOnHandTotal"><default-field title="QOH"><display/></default-field></field><field name="product"><default-field><link url="editProduct" text="ProductNameTemplate" link-type="anchor"/></default-field></field><field name="removeLink" align="right"><default-field title=""><link url="removeAssetFromContainer" icon="fa fa-trash" parameter-map="[assetId:assetId, containerId:containerId]"/></default-field></field></form-list></box-body></container-box></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Asset/Container/FindContainer.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" default-menu-title="Containers"><transition name="createContainer"><service-call name="create#mantle.product.asset.Container" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditContainer"/></transition><transition name="editContainer"><default-response url="../EditContainer"/></transition><transition name="editAsset"><default-response url="../../Asset/AssetDetail"/></transition><transition name="editProduct"><default-response url="//${appRoot}/Catalog/Product/EditProduct"/></transition><transition name="editFacility"><default-response url="//${appRoot}/Facility/EditFacility"/></transition><transition-include name="getAssetList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getFacilityList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><transition-include name="getLocationList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><actions><entity-find entity-name="mantle.facility.Facility" list="facilityList"><econdition field-name="facilityTypeEnumId" value="FcTpWarehouse"/><order-by field-name="facilityName"/></entity-find></actions><widgets><container-dialog id="CreateContainerDialog" button-text="Create Container"><form-single name="CreateContainerForm" transition="createContainer"><field name="containerTypeEnumId"><default-field title="Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ContainerType"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="description"><default-field><text-line size="40"/></default-field></field><field name="serialNumber"><default-field><text-line size="40"/></default-field></field><field name="externalId"><default-field><text-line size="20"/></default-field></field><field name="facilityId"><default-field title="Facility"><drop-down allow-empty="true"><dynamic-options transition="getFacilityList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="locationSeqId"><default-field title="Location"><drop-down allow-empty="true"><dynamic-options transition="getLocationList" server-search="true" min-length="0" depends-optional="true"><depends-on field="facilityId"/></dynamic-options></drop-down></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="ContainerList" list="containerList" skip-form="true" header-dialog="true"><entity-find entity-name="mantle.product.asset.ContainerAndAsset" list="containerList"><search-form-inputs default-order-by="serialNumber,containerId"/></entity-find><row-actions><entity-find-one entity-name="mantle.facility.FacilityLocation" value-field="facLoc" cache="true"/><entity-find entity-name="mantle.product.asset.AssetSummaryView" list="assetList"><econdition field-name="containerId"/><select-field field-name="productId,pseudoId,productName,availableToPromiseTotal,quantityOnHandTotal"/><order-by field-name="pseudoId"/></entity-find></row-actions><field name="serialNumber"><header-field show-order-by="true"><text-find/></header-field><default-field><link url="editContainer" text="${serialNumber}" link-type="anchor"/></default-field></field><field name="containerId"><header-field show-order-by="true"><text-find hide-options="true"/></header-field><default-field><link url="editContainer" text="${containerId}" link-type="anchor"/></default-field></field><field name="containerTypeEnumId"><header-field title="Type" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ContainerType"/><set field="allowEmpty" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="description"><header-field show-order-by="case-insensitive"><text-find/></header-field><default-field><display/></default-field></field><field name="facilityId"><header-field title="Facility" show-order-by="case-insensitive"><drop-down allow-empty="true"><dynamic-options transition="getFacilityList" server-search="true" min-length="0"/></drop-down></header-field><default-field><link url="editFacility" entity-name="mantle.facility.Facility" text="FacilityNameTemplate" link-type="anchor"/></default-field></field><field name="locationSeqId"><header-field title="Location" show-order-by="true"><drop-down allow-empty="true"><dynamic-options transition="getLocationList" server-search="true" min-length="0" depends-optional="true"><depends-on field="facilityId"/></dynamic-options></drop-down></header-field><default-field><label condition="locationSeqId" text-map="facLoc" text="FacilityLocationNameTemplate"/></default-field></field><field name="assetList"><default-field title="Product"><section-iterate name="AssetListSection" list="assetList" entry="assetProduct"><widgets><container><label text="ATP ${ec.l10n.format(assetProduct.availableToPromiseTotal, null)} QOH ${ec.l10n.format(assetProduct.quantityOnHandTotal, null)}"/><link url="editProduct" text="ProductNameTemplate" text-map="assetProduct" link-type="anchor" parameter-map="[productId:assetProduct.productId]"/></container></widgets></section-iterate></default-field></field><field name="assetId"><header-field title="Asset"><drop-down allow-empty="true"><dynamic-options transition="getAssetList" server-search="true" min-length="2"/></drop-down></header-field></field><field name="findButton"><header-field title="Find"><submit/></header-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Asset/Container/MoveContainer.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Move" default-menu-index="3"><parameter name="containerId" required="true"/><transition name="completeMove"><service-call name="update#mantle.product.asset.Container" in-map="true" out-map="context" multi="parameter"/><default-response url="../../Asset/SelectAsset"/><error-response url="."/></transition><transition name="editProduct"><default-response url="//${appRoot}/Catalog/Product/EditProduct"/></transition><transition name="editFacility"><default-response url="//${appRoot}/Facility/EditFacility"/></transition><transition-include name="getFacilityList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><transition-include name="getLocationList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><actions><entity-find-one entity-name="mantle.product.asset.Container" value-field="container"/><set field="facilityId" from="container?.facilityId"/><set field="facLoc" from="container?.location"/></actions><widgets><label text="Move Container ${container?.serialNumber ?: containerId}" type="h4"/><container-row><row-col md="6"><form-single name="ContainerInfoForm" map="asset"><field name="facilityId"><default-field title="Facility"><link url="editFacility" entity-name="mantle.facility.Facility" text="FacilityNameTemplate" link-type="anchor"/></default-field></field><field name="currentLocation"><default-field><display text="FacilityLocationNameTemplate" text-map="facLoc?:[locationSeqId:'N/A']"/></default-field></field></form-single></row-col><row-col md="6"><form-list name="AssetListForm" list="assetList" skip-form="true"><entity-find entity-name="mantle.product.asset.AssetSummaryView" list="assetList"><econdition field-name="containerId"/><select-field field-name="productId,pseudoId,productName"/><order-by field-name="pseudoId"/></entity-find><field name="availableToPromiseTotal"><default-field title="ATP"><display/></default-field></field><field name="quantityOnHandTotal"><default-field title="QOH"><display/></default-field></field><field name="product"><default-field><link url="editProduct" text="ProductNameTemplate" link-type="anchor"/></default-field></field></form-list></row-col></container-row><container-row><row-col md="6"><form-single name="ScanMoveContainerForm" transition="completeMove" focus-field="locationSeqId"><field name="containerId"><default-field><hidden/></default-field></field><field name="facilityId"><default-field title="Facility"><drop-down allow-empty="true"><dynamic-options transition="getFacilityList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="locationSeqId"><default-field title="Scan Location"><text-line size="20"/></default-field></field><field name="submitButton"><default-field title="Move Container"><submit/></default-field></field></form-single></row-col><row-col md="6"><form-single name="EnterMoveContainerForm" transition="completeMove"><field name="containerId"><default-field><hidden/></default-field></field><field name="facilityId"><default-field title="Facility"><drop-down allow-empty="true"><dynamic-options transition="getFacilityList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="locationSeqId"><default-field title="Location"><drop-down allow-empty="true"><dynamic-options transition="getLocationList" server-search="true" min-length="0"><depends-on field="facilityId"/></dynamic-options></drop-down></default-field></field><field name="submitButton"><default-field title="Move Container"><submit/></default-field></field></form-single></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Asset/Container.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Containers" default-menu-index="6"><subscreens default-item="FindContainer"/><widgets><subscreens-panel id="ContainerPanel" type="tab"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Asset/AssetPool/EditAssetPool.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Pool"><parameter name="assetPoolId" required="true"/><transition name="findSummary"><default-response url="../../Asset/FindSummary"/></transition><transition name="findAsset"><default-response url="../../Asset/FindAsset"/></transition><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition name="editProductStore"><default-response url="//${appRoot}/ProductStore/EditProductStore"/></transition><transition name="updateAssetPool"><service-call name="update#mantle.product.asset.AssetPool" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createAssetPoolParty"><service-call name="create#mantle.product.asset.AssetPoolParty" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteAssetPoolParty"><service-call name="delete#mantle.product.asset.AssetPoolParty" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createAssetPoolStore"><service-call name="create#mantle.product.asset.AssetPoolStore" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteAssetPoolStore"><service-call name="delete#mantle.product.asset.AssetPoolStore" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><actions><entity-find-one entity-name="mantle.product.asset.AssetPool" value-field="assetPool"/></actions><widgets><container-row><row-col lg="5"><link url="findSummary" text="Assets (Summary)" parameter-map="[assetPoolId:assetPoolId]"/><link url="findAsset" text="Assets (Detail)" parameter-map="[assetPoolId:assetPoolId]"/><form-single name="UpdateAssetPoolForm" transition="updateAssetPool" map="assetPool"><field name="assetPoolId"><default-field><hidden/></default-field></field><field name="pseudoId"><default-field><text-line size="20"/></default-field></field><field name="description"><default-field><text-line size="40"/></default-field></field><field name="ownerPartyId"><default-field title="Owned By Org"><drop-down><option key="_NA_" text="N/A"/><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></row-col><row-col lg="7"><container-box><box-header title="Parties"/><box-toolbar><container-dialog id="AddPartyDialog" button-text="Add Party"><form-single name="AddPartyForm" transition="createAssetPoolParty"><field name="assetPoolId"><default-field><hidden/></default-field></field><field name="partyId"><default-field title="Party"><drop-down><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="roleTypeId"><default-field title="Role"><drop-down allow-empty="true"><option key="Customer"/><option key="Vendor"/></drop-down></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="PartyListForm" list="poolPartyList" skip-form="true"><entity-find entity-name="mantle.product.asset.AssetPoolPartyDetail" list="poolPartyList"><econdition field-name="assetPoolId"/><select-field field-name="assetPoolId,partyId,pseudoId,firstName,middleName,lastName,organizationName"/><order-by field-name="pseudoId"/></entity-find><field name="partyId"><default-field title="Party"><link url="editParty" text="PartyNameTemplate" link-type="anchor"/></default-field></field><field name="roleDescription"><default-field title="Role"><display/></default-field></field><field name="removeLink" align="right"><default-field title=""><link url="deleteAssetPoolParty" icon="fa fa-trash" confirmation="Remove party from pool?" parameter-map="[assetPoolId:assetPoolId, partyId:partyId]"/></default-field></field></form-list></box-body></container-box><container-box><box-header title="Stores"/><box-toolbar><container-dialog id="AddStoreDialog" button-text="Add Store"><form-single name="AddStoreForm" transition="createAssetPoolStore"><field name="assetPoolId"><default-field><hidden/></default-field></field><field name="productStoreId"><default-field title="Store"><drop-down><entity-options key="${productStoreId}" text="${productStoreId}: ${storeName}"><entity-find entity-name="mantle.product.store.ProductStore"><order-by field-name="storeName"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="StoreListForm" list="poolStoreList" skip-form="true"><entity-find entity-name="mantle.product.asset.AssetPoolStoreDetail" list="poolStoreList"><econdition field-name="assetPoolId"/><select-field field-name="assetPoolId,productStoreId,storeName"/><order-by field-name="storeName"/></entity-find><field name="productStoreId"><default-field title="Store"><link url="editProductStore" text="${productStoreId}: ${storeName}" link-type="anchor"/></default-field></field><field name="removeLink" align="right"><default-field title=""><link url="deleteAssetPoolStore" icon="fa fa-trash" confirmation="Remove store from pool?" parameter-map="[assetPoolId:assetPoolId, productStoreId:productStoreId]"/></default-field></field></form-list></box-body></container-box></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Asset/AssetPool/FindAssetPool.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" default-menu-title="Pools"><transition name="createAssetPool"><service-call name="create#mantle.product.asset.AssetPool" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditAssetPool"/></transition><transition name="editAssetPool"><default-response url="../EditAssetPool"/></transition><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition name="editProductStore"><default-response url="//${appRoot}/ProductStore/EditProductStore"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><widgets><container-dialog id="CreateAssetPoolDialog" button-text="Create Pool"><form-single name="CreateAssetPoolForm" transition="createAssetPool"><field name="pseudoId"><default-field><text-line size="20"/></default-field></field><field name="description"><default-field><text-line size="40"/></default-field></field><field name="ownerPartyId"><default-field title="Owned By Org"><drop-down><option key="_NA_" text="N/A"/><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="AssetPoolList" list="assetPoolList" skip-form="true" header-dialog="true"><entity-find entity-name="mantle.product.asset.AssetPoolDetail" list="assetPoolList"><search-form-inputs default-order-by="pseudoId"/><econdition field-name="partyId" from="findPartyId" ignore-if-empty="true"/><econdition field-name="productStoreId" from="findProductStoreId" ignore-if-empty="true"/><select-field field-name="assetPoolId"/></entity-find><row-actions><entity-find entity-name="mantle.product.asset.AssetPoolPartyDetail" list="poolPartyList"><econdition field-name="assetPoolId"/><order-by field-name="pseudoId"/></entity-find><entity-find entity-name="mantle.product.asset.AssetPoolStoreDetail" list="poolStoreList"><econdition field-name="assetPoolId"/><order-by field-name="storeName"/></entity-find></row-actions><field name="assetPoolId"><default-field><hidden/></default-field></field><field name="pseudoId"><header-field show-order-by="true" title="ID"><text-find hide-options="true"/></header-field><default-field><link url="editAssetPool" text="${pseudoId}" link-type="anchor"/></default-field></field><field name="description"><header-field show-order-by="case-insensitive"><text-find/></header-field><default-field><display/></default-field></field><field name="ownerPartyId"><header-field><drop-down allow-empty="true"><option key="_NA_" text="N/A"/><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></header-field><default-field><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameTemplate"/></default-field></field><field name="findPartyId"><header-field title="Party"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></header-field></field><field name="partyList"><default-field title="Party"><section-iterate name="PartyListSection" list="poolPartyList" entry="poolParty"><widgets><container><link url="editParty" text="PartyNameTemplate" text-map="poolParty" link-type="anchor" parameter-map="[partyId:poolParty.partyId]"/><label text=" (${poolParty.roleDescription})" condition="poolParty.roleDescription"/></container></widgets></section-iterate></default-field></field><field name="findProductStoreId"><header-field title="Party"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></header-field></field><field name="storeList"><default-field title="Store"><section-iterate name="StoreListSection" list="poolStoreList" entry="poolStore"><widgets><container><link url="editProductStore" text="${poolStore.storeName}" link-type="anchor" parameter-map="[productStoreId:poolStore.productStoreId]"/></container></widgets></section-iterate></default-field></field><field name="findButton"><header-field title="Find"><submit/></header-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Asset/AssetPool.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Pools" default-menu-index="7"><subscreens default-item="FindAssetPool"/><widgets><subscreens-active id="AssetPoolPanel"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Asset/Asset/FindAsset.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="assetDetail"><default-response url="../AssetDetail"/></transition><transition name="editProduct"><default-response url="//${appRoot}/Catalog/Product/EditProduct"/></transition><transition name="editFacility"><default-response url="//${appRoot}/Facility/EditFacility"/></transition><transition name="editContainer"><default-response url="//${appRoot}/Asset/Container/EditContainer"/></transition><transition name="orderDetail"><default-response url="//${appRoot}/Order/OrderDetail"/></transition><transition name="createEquipment"><service-call name="mantle.product.EquipmentServices.create#Equipment" in-map="true" out-map="context" multi="parameter"/><default-response url="../AssetDetail"/></transition><transition name="updateProductAcquireCost"><service-call name="mantle.product.AssetServices.update#ProductAcquireCost" in-map="true" out-map="context" multi="parameter"/><default-response url="." parameter-map="[productId:productId, facilityId:facilityId]"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getLotList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getAssetPoolList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getFacilityList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><transition-include name="getLocationList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><transition-include name="getContainerList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><widgets><link url="../FindSummary" text="Asset Summary Find"/><link url="../SelectAsset" text="Move Asset"/><link url="../../Container" text="Containers"/><link url="../../EditLots" text="Lots"/><link url="../../AssetPool" text="Pools"/><container-dialog id="UpdateProductCostDialog" button-text="Bulk Cost Update"><label text="This will update all GL transactions for this Asset including receipt, issuance, and physical inventory changes."/><label text="NOTE: this should only be used to correct data as it rewrites the accounting history for this asset. Do not use to change ownership for a business transaction like a sale." type="p"/><form-single name="UpdateProductCost" transition="updateProductAcquireCost"><field name="productId"><default-field title="Product"><drop-down><dynamic-options transition="getProductList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="facilityId"><default-field title="Facility"><drop-down allow-empty="true"><dynamic-options transition="getFacilityList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="receivedDate_from"><default-field title="Received From"><date-time/></default-field></field><field name="receivedDate_thru"><default-field title="Received Thru"><date-time/></default-field></field><field name="acquireCost"><default-field><text-line size="10" format="#,##0.00##"/></default-field></field><field name="ownerPartyId"><default-field title="Owner Party"><drop-down><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></container-dialog><container-dialog id="NewEquipmentDialog" button-text="New Equipment"><label text="NOTE: for accounting and other traceability record equipment purchase using a purchase order, incoming shipment, and payable invoice; this form is for existing or third party equipment" type="p"/><label text="Use the Asset screen after create for depreciation and other settings." type="p"/><form-single name="CreateEquipment" transition="createEquipment"><field name="assetName"><default-field><text-line size="40"/></default-field></field><field name="classEnumId"><default-field title="Asset Class"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="AssetClass"/></widget-template-include></default-field></field><field name="productId"><default-field title="Model Product"><drop-down><dynamic-options transition="getProductList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="statusId"><default-field title="Initial Status"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="Asset"/><set field="noCurrentSelectedKey" value="AstInUse"/></widget-template-include></default-field></field><field name="ownerPartyId"><default-field title="Owner Party"><drop-down><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="facilityId"><default-field title="Facility"><drop-down allow-empty="true"><dynamic-options transition="getFacilityList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="acquiredDate"><default-field><date-time/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="ListAssets" list="assetList" skip-form="true" header-dialog="true" select-columns="true" saved-finds="true" show-csv-button="true" show-xlsx-button="true"><entity-find entity-name="mantle.product.asset.AssetFindView" list="assetList" use-clone="true"><search-form-inputs default-order-by="-receivedDate,-assetId" require-parameters="true"/><econditions combine="or"><econdition field-name="acquireCost" operator="is-null" ignore="onlyNoAcquireCost != 'true'"/><econdition field-name="acquireCost" from="0.0" ignore="onlyNoAcquireCost != 'true'"/><econdition field-name="acquireCost" to-field-name="acquireUnitAmount" ignore="onlyAcquireMatchPo != 'true'"/></econditions><econdition field-name="locationSeqId" operator="is-null" ignore="onlyNoLocation != 'true'"/><select-field field-name="pseudoId,productName"/></entity-find><row-actions><entity-find-one entity-name="mantle.facility.FacilityLocation" value-field="facLoc" cache="true"/><entity-find-one entity-name="moqui.basic.Uom" value-field="amountUom" cache="true"><field-map field-name="uomId" from="amountUomId"/></entity-find-one></row-actions><field name="assetId"><header-field title="Asset ID" show-order-by="case-insensitive"><text-find size="15" hide-options="true"/></header-field><default-field><link url="assetDetail" text="${assetId}" link-type="anchor" condition="assetId"/></default-field></field><field name="productId"><header-field title="Product" show-order-by="case-insensitive"><drop-down allow-empty="true"><dynamic-options transition="getProductList" server-search="true" min-length="2"/></drop-down></header-field><default-field><link url="editProduct" text="ProductNameTemplate" link-type="anchor" condition="pseudoId"/></default-field></field><field name="ownerPartyId"><header-field title="Owner Party"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></header-field><default-field><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameTemplate"/></default-field></field><field name="acquireCost" align="right"><header-field><range-find size="5"/></header-field><default-field><display format="#,##0.00"/></default-field></field><field name="assetTypeEnumId"><header-field title="Asset Type" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="AssetType"/><set field="allowMultiple" value="true"/><set field="allowEmpty" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="classEnumId"><header-field title="Asset Class" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="AssetClass"/><set field="allowMultiple" value="true"/><set field="allowEmpty" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="statusId"><header-field title="Status" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="Asset"/><set field="allowMultiple" value="true"/><set field="allowEmpty" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="acquireOrderId"><header-field><text-find hide-options="true" default-operator="begins"/></header-field><default-field><link url="orderDetail" text="PO ${acquireOrderId}" link-type="anchor" condition="acquireOrderId" parameter-map="[orderId:acquireOrderId]"/></default-field></field><field name="facilityId"><header-field title="Facility" show-order-by="case-insensitive"><drop-down allow-empty="true"><dynamic-options transition="getFacilityList" server-search="true" min-length="0"/></drop-down></header-field><default-field><link url="editFacility" entity-name="mantle.facility.Facility" text="FacilityNameTemplate" link-type="anchor"/></default-field></field><field name="locationSeqId"><header-field title="Location" show-order-by="true"><drop-down allow-empty="true"><dynamic-options transition="getLocationList" server-search="true" min-length="0" depends-optional="true"><depends-on field="facilityId"/></dynamic-options></drop-down></header-field><default-field><label condition="locationSeqId" text-map="facLoc" text="FacilityLocationNameTemplate"/></default-field></field><field name="onlyNoLocation"><header-field title="No Location"><check><option key="true" text="Only No Location"/></check></header-field></field><field name="containerId"><header-field title="Container" show-order-by="true"><drop-down allow-empty="true"><dynamic-options transition="getContainerList" server-search="true" min-length="0" depends-optional="true"><depends-on field="facilityId"/><depends-on field="locationSeqId"/></dynamic-options></drop-down></header-field><default-field><link url="editContainer" entity-name="mantle.product.asset.Container" text="ContainerNameTemplate" link-type="anchor"/></default-field></field><field name="lotId"><header-field title="Lot"><drop-down allow-empty="true"><dynamic-options transition="getLotList" server-search="true" min-length="0"/></drop-down></header-field><default-field><display-entity entity-name="mantle.product.asset.LotAndMfgParty" text="LotNameTemplate"/></default-field></field><field name="assetPoolId"><header-field title="Asset Pool"><drop-down allow-empty="true"><dynamic-options transition="getAssetPoolList" server-search="true" min-length="0"/></drop-down></header-field><default-field><display-entity entity-name="mantle.product.asset.AssetPool" text="${pseudoId}: ${description}"/></default-field></field><field name="receivedDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="manufacturedDate"><header-field show-order-by="true" title="Mfg Date"><date-period/></header-field><default-field><display/></default-field></field><field name="availableToPromiseTotal" show-total="true" align="right"><header-field title="Available" show-order-by="true"><range-find size="5"/></header-field><default-field><display text="${ec.l10n.format(availableToPromiseTotal, null)} (${amountUom?.description?:'each'})"/></default-field></field><field name="quantityOnHandTotal" show-total="true" align="right"><header-field title="On Hand" show-order-by="true"><range-find size="5"/></header-field><default-field><display text="${ec.l10n.format(quantityOnHandTotal, null)} (${amountUom?.description?:'each'})"/></default-field></field><field name="onlyNoAcquireCost"><header-field title="Acquire Cost"><check><option key="true" text="Only No Cost"/></check></header-field></field><field name="onlyAcquireMatchPo"><header-field title="Acquire Cost"><check><option key="true" text="Only Cost Matches PO Amount"/></check></header-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field><default-field><link url="assetDetail" text="Detail" link-type="anchor-button" condition="assetId"/></default-field></field><form-list-column><field-ref name="submitButton"/></form-list-column><form-list-column><field-ref name="assetId"/><field-ref name="productId"/><field-ref name="assetTypeEnumId"/><field-ref name="classEnumId"/></form-list-column><form-list-column><field-ref name="statusId"/><field-ref name="ownerPartyId"/><field-ref name="assetPoolId"/><field-ref name="acquireOrderId"/></form-list-column><form-list-column><field-ref name="facilityId"/><field-ref name="locationSeqId"/><field-ref name="containerId"/><field-ref name="lotId"/></form-list-column><form-list-column><field-ref name="receivedDate"/><field-ref name="manufacturedDate"/><field-ref name="availableToPromiseTotal"/><field-ref name="quantityOnHandTotal"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Asset/Asset/SelectAsset.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" default-menu-title="Move Asset"><parameter name="facilityId"/><parameter name="locationSeqId"/><parameter name="containerId"/><parameter name="productId"/><parameter name="assetPoolId"/><parameter name="lotId"/><parameter name="quantity"/><parameter name="toScanLocation"/><transition name="moveAsset"><default-response url="../MoveAsset"/></transition><transition name="assetDetail"><default-response url="../AssetDetail"/></transition><transition name="findAsset"><default-response url="../FindAsset"/></transition><transition name="setActiveFacility"><actions><script><![CDATA[ec.user.setPreference('FacilityActive', facilityId)]]></script></actions><default-response url="."/></transition><transition name="checkScanInput" read-only="true"><service-call name="mantle.facility.FacilityServices.get#ScannedIdGeneral" in-map="true" out-map="context" multi="parameter"/><conditional-response url="../MoveAsset"><condition><expression><![CDATA[assetId]]></expression></condition></conditional-response><default-response url="."/></transition><transition name="moveProduct"><service-call name="mantle.product.AssetServices.move#Product" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="editContainer"><default-response url="../../Container/EditContainer"/></transition><transition name="moveContainer"><default-response url="../../Container/MoveContainer"/></transition><transition name="editProduct"><default-response url="//${appRoot}/Catalog/Product/EditProduct"/></transition><transition name="editFacility"><default-response url="//${appRoot}/Facility/EditFacility"/></transition><transition-include name="getFacilityList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><transition-include name="getContainerList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><transition-include name="getLocationList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><transition-include name="getAssetList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getLotList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getAssetPoolList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition name="assetMove"><actions><entity-find-one entity-name="mantle.product.asset.Asset" value-field="asset"><field-map field-name="assetId" from="scanId"/></entity-find-one><set field="assetId" from="asset?.assetId"/><if condition="asset == null"><message error="true"><![CDATA[No asset found for ID ${scanId}]]></message></if></actions><conditional-response url="../MoveAsset" parameter-map="[assetId:assetId]"><condition><expression><![CDATA[assetId]]></expression></condition></conditional-response><default-response url="."/></transition><actions><set field="facilityId" from="facilityId ?: ec.user.getPreference('FacilityActive') ?: ec.user.getPreference('FacilityGeneralDefault')"/><if condition="containerId"><entity-find entity-name="mantle.product.asset.AssetSummaryView" list="contAssetList"><econdition field-name="containerId"/><econdition field-name="productId" ignore-if-empty="true"/><having-econditions><econdition field-name="quantityOnHandTotal" operator="greater" from="0.0"/></having-econditions><select-field field-name="productId,pseudoId,productName,quantityOnHandTotal"/></entity-find><if condition="!productId && contAssetList.size() == 1"><set field="productId" from="contAssetList[0].productId"/></if></if><if condition="facilityId && locationSeqId"><entity-find entity-name="mantle.product.asset.AssetSummaryView" list="locAssetList"><econdition field-name="facilityId"/><econdition field-name="locationSeqId"/><econdition field-name="productId" ignore-if-empty="true"/><having-econditions><econdition field-name="quantityOnHandTotal" operator="greater" from="0.0"/></having-econditions><select-field field-name="productId,pseudoId,productName,quantityOnHandTotal"/></entity-find><if condition="!productId && locAssetList.size() == 1"><set field="productId" from="locAssetList[0].productId"/></if></if><if condition="facilityId && productId"><entity-find entity-name="mantle.product.asset.AssetSummaryView" list="prodAssetList"><econdition field-name="facilityId"/><econdition field-name="productId"/><econdition field-name="locationSeqId" ignore-if-empty="true"/><having-econditions><econdition field-name="quantityOnHandTotal" operator="greater" from="0.0"/></having-econditions><select-field field-name="locationSeqId,containerId,quantityOnHandTotal"/></entity-find><if condition="!locationSeqId && prodAssetList.size() == 1"><set field="locationSeqId" from="prodAssetList[0].locationSeqId"/></if></if><if condition="containerId"><entity-find-one entity-name="mantle.product.asset.Container" value-field="container"/></if><if condition="locationSeqId"><entity-find-one entity-name="mantle.facility.FacilityLocation" value-field="facilityLocation"/></if><if condition="productId"><entity-find-one entity-name="mantle.product.Product" value-field="product"/></if><if condition="productId && facilityId"><entity-find entity-name="mantle.facility.ProductFacilityLocationDetail" list="pickLocList" distinct="true"><econdition field-name="productId"/><econdition field-name="facilityId"/><econdition field-name="locationTypeEnumId" value="FltPick"/><select-field field-name="locationSeqId,description,areaId,aisleId,sectionId,levelId,positionId"/></entity-find><if condition="!pickLocList"><entity-find entity-name="mantle.product.asset.AssetLocationDetail" list="pickLocList" distinct="true"><econdition field-name="productId"/><econdition field-name="facilityId"/><econdition field-name="locationTypeEnumId" value="FltPick"/><select-field field-name="locationSeqId,description,areaId,aisleId,sectionId,levelId,positionId"/></entity-find></if></if><if condition="toScanLocation && facilityId"><service-call name="mantle.product.AssetServices.check#ScanLocation" out-map="toScanOut" in-map="[facilityId:facilityId, scanLocation:toScanLocation]"/><if condition="!toScanOut.locationSeqId && !toScanOut.containerId"><set field="createContainerId" from="toScanLocation"/><set field="toScanLocation" from="null"/></if></if></actions><widgets><container-row style="text-center"><row-col sm="5"><form-single name="ScanAssetForm" transition="checkScanInput" focus-field="scanId"><field name="facilityId"><default-field><hidden/></default-field></field><field name="locationSeqId"><default-field><hidden/></default-field></field><field name="containerId"><default-field><hidden/></default-field></field><field name="productId"><default-field><hidden/></default-field></field><field name="scanId"><default-field title="Scan Asset, Container, Location, Product"><text-line size="20"/></default-field></field><field name="submitButton"><default-field title="Select"><submit/></default-field></field><field-layout><field-row-big><field-ref name="scanId"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single></row-col><row-col sm="7"><form-single name="ActiveFacilityForm" transition="setActiveFacility"><field name="productId"><default-field><hidden/></default-field></field><field name="facilityId"><default-field title="Active Warehouse"><drop-down><dynamic-options transition="getFacilityList" server-search="true" min-length="0" parameter-map="[facilityTypeEnumId:'FcTpWarehouse']"/></drop-down></default-field></field><field name="submitButton"><default-field title="Set WH"><submit/></default-field></field><field-layout><field-row-big><field-ref name="facilityId"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single></row-col></container-row><container-row style="text-center"><row-col sm="5"><form-single name="SelectAssetForm" transition="moveAsset"><field name="assetId"><default-field title="Lookup Asset"><drop-down><dynamic-options transition="getAssetList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="submitButton"><default-field title="Move"><submit/></default-field></field><field-layout><field-row-big><field-ref name="assetId"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single></row-col><row-col sm="7"><form-single name="SelectLocationForm" transition="."><field name="facilityId"><default-field><hidden/></default-field></field><field name="locationSeqId"><default-field title="Location"><drop-down allow-empty="true"><dynamic-options transition="getLocationList" server-search="true" min-length="0"><depends-on field="facilityId"/></dynamic-options></drop-down></default-field></field><field name="containerId"><default-field title="Container"><drop-down allow-empty="true"><dynamic-options transition="getContainerList" server-search="true" min-length="0"><depends-on field="facilityId"/><depends-on field="locationSeqId"/></dynamic-options></drop-down></default-field></field><field name="productId"><default-field title="Product"><drop-down allow-empty="true"><dynamic-options transition="getProductList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="lotId"><default-field title="Lot"><drop-down allow-empty="true"><dynamic-options transition="getLotList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="submitButton"><default-field title="Select"><submit/></default-field></field><field-layout><field-row-big><field-ref name="locationSeqId"/><field-ref name="containerId"/><field-ref name="productId"/><field-ref name="lotId"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single></row-col></container-row><container-row><row-col sm="4"><label text="Location " type="strong" condition="facilityLocation"/><label text="${ec.resource.expand('FacilityLocationNameTemplate', null, facilityLocation)}" type="span" condition="facilityLocation"/><section-iterate name="LocAssetSummary" list="locAssetList" entry="locAsset"><widgets><label text="${ec.resource.expand('ProductNameTemplate', null, locAsset)} - Qty ${ec.l10n.format(locAsset.quantityOnHandTotal, null)}" type="div"/></widgets></section-iterate></row-col><row-col sm="4"><label text="Container " type="strong" condition="container"/><label text="${ec.resource.expand('ContainerNameTemplate', null, container)}" type="span" condition="container"/><section-iterate name="ContAssetSummary" list="contAssetList" entry="contAsset"><widgets><label text="${ec.resource.expand('ProductNameTemplate', null, contAsset)} - Qty ${ec.l10n.format(contAsset.quantityOnHandTotal, null)}" type="div"/></widgets></section-iterate></row-col><row-col sm="4"><label text="Product " type="strong" condition="product"/><label text="${ec.resource.expand('ProductNameTemplate', null, product)}" type="span" condition="product"/></row-col></container-row><container><label text="Pick Locations " type="strong" condition="pickLocList"/><section-iterate name="RecLocList" list="pickLocList" entry="recLoc"><widgets><label text="${locationSeqId?:''} ${description?:''} [${areaId?:' '}:${aisleId?:' '}:${sectionId?:' '}:${levelId?:' '}:${positionId?:' '}]" text-map="recLoc" type="span"/></widgets></section-iterate></container><link url="." text="Reset Selections" condition="containerId || locationSeqId || productId" parameter-map="[containerId:null, locationSeqId:null, productId:null]"/><link url="moveContainer" text="Move Container" condition="containerId"/><link url="findAsset" text="All Container Assets" parameter-map="[containerId:containerId, productId:productId]" condition="containerId"/><link url="findAsset" text="All Location Assets" parameter-map="[facilityId:facilityId, locationSeqId:locationSeqId, productId:productId]" condition="locationSeqId"/><section name="MoveFormsSection" condition="product != null && facilityId"><widgets><container-row><row-col md="6"><form-single name="ScanMoveAssetForm" transition="moveProduct"><field name="facilityId"><default-field><hidden/></default-field></field><field name="locationSeqId"><default-field><hidden/></default-field></field><field name="containerId"><default-field><hidden/></default-field></field><field name="productId"><default-field><hidden/></default-field></field><field name="createContMessage"><conditional-field condition="createContainerId" title=""><label text="Scanned ID was not a known location or container, scan a location to create a container with the ID" style="text-warning"/></conditional-field></field><field name="assetPoolId"><default-field title="From Pool"><drop-down allow-empty="true"><entity-options key="${assetPoolId}" text="${pseudoId}: ${description}"><entity-find entity-name="mantle.product.asset.AssetAndPool" distinct="true"><econdition field-name="facilityId"/><econdition field-name="productId"/><econditions combine="or"><econdition field-name="locationSeqId"/><econdition field-name="containerId"/></econditions><select-field field-name="assetPoolId,pseudoId,description"/></entity-find></entity-options></drop-down></default-field></field><field name="toScanLocation"><default-field title="Scan Location" tooltip="Can be Location ID or Container ID or Serial Number (Plate ID)"><text-line size="20"/></default-field></field><field name="createContainerId"><default-field title="Create Container ID"><text-line size="20"/></default-field></field><field name="toAssetPoolId"><default-field title="To Pool"><drop-down allow-empty="true"><dynamic-options transition="getAssetPoolList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="quantity"><default-field title="Quantity" tooltip="For partial move, defaults to entire asset"><text-line size="20"/></default-field></field><field name="submitButton"><default-field title="Move Asset(s)"><submit/></default-field></field></form-single></row-col><row-col md="6"><form-single name="EnterMoveAssetForm" transition="moveProduct"><field name="facilityId"><default-field><hidden/></default-field></field><field name="locationSeqId"><default-field><hidden/></default-field></field><field name="containerId"><default-field><hidden/></default-field></field><field name="productId"><default-field><hidden/></default-field></field><field name="assetPoolId"><default-field title="From Pool"><drop-down allow-empty="true"><entity-options key="${assetPoolId}" text="${pseudoId}: ${description}"><entity-find entity-name="mantle.product.asset.AssetAndPool" distinct="true"><econdition field-name="facilityId"/><econdition field-name="productId"/><econditions combine="or"><econdition field-name="locationSeqId"/><econdition field-name="containerId"/></econditions><select-field field-name="assetPoolId,pseudoId,description"/></entity-find></entity-options></drop-down></default-field></field><field name="toLocationSeqId" from="locationSeqId"><default-field title="To Location"><drop-down allow-empty="true"><dynamic-options transition="getLocationList" server-search="true" min-length="0"><depends-on field="facilityId"/></dynamic-options></drop-down></default-field></field><field name="toContainerId" from="containerId"><default-field title="To Container"><drop-down><dynamic-options transition="getContainerList" server-search="true" min-length="0"><depends-on field="facilityId"/><depends-on field="toLocationSeqId" parameter="locationSeqId"/></dynamic-options></drop-down></default-field></field><field name="createContainerId"><default-field title="Create Container ID"><text-line size="20"/></default-field></field><field name="toAssetPoolId" from="assetPoolId"><default-field title="To Pool"><drop-down allow-empty="true"><dynamic-options transition="getAssetPoolList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="quantity"><default-field title="Quantity"><text-line size="10"/></default-field></field><field name="submitButton"><default-field title="Move Asset(s)"><submit/></default-field></field><field-layout><fields-not-referenced/><field-row><field-ref name="quantity"/><field-ref name="createContainerId"/></field-row><field-ref name="submitButton"/></field-layout></form-single></row-col></container-row></widgets></section><section name="ContainerSection" condition="container != null"><widgets><section name="ContainerProductSection" condition="product != null"><widgets><form-list name="ContainerAssetList" list="contAssetList" skip-form="true"><entity-find entity-name="mantle.product.asset.Asset" list="contAssetList" limit="10"><econdition field-name="containerId"/><econdition field-name="productId"/><econdition field-name="quantityOnHandTotal" operator="greater" from="0.0"/><order-by field-name="-quantityOnHandTotal"/></entity-find><field name="assetId"><default-field title="Container Asset"><link url="assetDetail" text="${assetId}" link-type="anchor"/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="receivedDate"><default-field><display format="yyyy-MM-dd"/></default-field></field><field name="quantityOnHandTotal"><default-field title="Quantity On Hand"><display format="#,##0.###"/></default-field></field></form-list><label text="No product found in container" condition="!contAssetList"/></widgets><fail-widgets><section-iterate name="ContProdListSection" list="contAssetList" entry="contAsset"><widgets><link url="." text="${ec.resource.expand('ProductNameTemplate', null, contAsset)} (${ec.l10n.format(contAsset.quantityOnHandTotal, null)})"/></widgets></section-iterate></fail-widgets></section></widgets></section><section name="LocationSection" condition="facilityLocation != null"><widgets><section name="LocationProductSection" condition="product != null"><widgets><form-list name="LocationAssetList" list="locAssetList" skip-form="true"><entity-find entity-name="mantle.product.asset.Asset" list="locAssetList" limit="10"><econdition field-name="facilityId"/><econdition field-name="locationSeqId"/><econdition field-name="productId"/><econdition field-name="quantityOnHandTotal" operator="greater" from="0.0"/><order-by field-name="-quantityOnHandTotal"/></entity-find><field name="assetId"><default-field title="Location Asset"><link url="assetDetail" text="${assetId}" link-type="anchor"/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="receivedDate"><default-field><display format="yyyy-MM-dd"/></default-field></field><field name="quantityOnHandTotal"><default-field title="Quantity On Hand"><display format="#,##0.###"/></default-field></field></form-list><label text="No product found in location" condition="!locAssetList"/></widgets><fail-widgets><section-iterate name="LocProdListSection" list="locAssetList" entry="locAsset"><widgets><link url="." text="${ec.resource.expand('ProductNameTemplate', null, locAsset)} (${ec.l10n.format(locAsset.quantityOnHandTotal, null)})"/></widgets></section-iterate></fail-widgets></section></widgets></section><section name="ProductSection" condition="product != null"><widgets><section name="ProductOtherSection" condition="facilityLocation == null && container == null && facilityId"><widgets><label text="No locations or containers found for product" condition="!prodAssetList"/><section-iterate name="ProdOtherListSection" list="prodAssetList" entry="prodAsset"><actions><entity-find-one entity-name="mantle.product.asset.Container" value-field="curContainer"><field-map field-name="containerId" from="prodAsset.containerId"/></entity-find-one><entity-find-one entity-name="mantle.facility.FacilityLocation" value-field="curFacLoc" cache="true"><field-map field-name="facilityId"/><field-map field-name="locationSeqId" from="prodAsset.locationSeqId"/></entity-find-one></actions><widgets><link url="." text="Loc ${ec.resource.expand('FacilityLocationNameTemplate', null, curFacLoc)} - Cont ${curContainer ? ec.resource.expand('ContainerNameTemplate', null, curContainer) : 'N/A'}" parameter-map="[containerId:prodAsset.containerId, locationSeqId:prodAsset.locationSeqId]"/></widgets></section-iterate><form-list name="ProductNoLocAssetList" list="prodNoLocAssetList" skip-form="true"><entity-find entity-name="mantle.product.asset.Asset" list="prodNoLocAssetList" limit="10"><econdition field-name="facilityId"/><econdition field-name="locationSeqId" from="null"/><econdition field-name="productId"/><econdition field-name="quantityOnHandTotal" operator="greater" from="0.0"/><order-by field-name="-quantityOnHandTotal"/></entity-find><field name="assetId"><default-field title="No Location Asset"><link url="assetDetail" text="${assetId}" link-type="anchor"/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="receivedDate"><default-field><display format="yyyy-MM-dd"/></default-field></field><field name="quantityOnHandTotal"><default-field title="Quantity On Hand"><display format="#,##0.###"/></default-field></field></form-list></widgets></section></widgets></section><section name="RecentAssetMoves"><actions><entity-find entity-name="moqui.entity.EntityAuditLog" list="recentMoveList" limit="10"><econdition field-name="changedEntityName" value="mantle.product.asset.Asset"/><econdition field-name="changedFieldName" operator="in" value="locationSeqId,containerId"/><econdition field-name="changedByUserId" from="ec.user.userId"/><econdition field-name="changedDate" operator="greater" from="ec.user.nowTimestamp - 5"/><order-by field-name="-changedDate"/></entity-find></actions><widgets><label text="Recent Asset Moves" type="h4"/><form-list name="RecentMoveForm" list="recentMoveList" skip-form="true"><row-actions><entity-find-one entity-name="mantle.product.asset.Asset" value-field="asset"><field-map field-name="assetId" from="pkPrimaryValue"/></entity-find-one><if condition="changedFieldName == 'locationSeqId'"><then><entity-find-one entity-name="mantle.facility.FacilityLocation" value-field="fromFacLoc" cache="true"><field-map field-name="facilityId" from="asset.facilityId"/><field-map field-name="locationSeqId" from="oldValueText"/></entity-find-one><entity-find-one entity-name="mantle.facility.FacilityLocation" value-field="toFacLoc" cache="true"><field-map field-name="facilityId" from="asset.facilityId"/><field-map field-name="locationSeqId" from="newValueText"/></entity-find-one></then><else-if condition="changedFieldName == 'containerId'"><entity-find-one entity-name="mantle.product.asset.Container" value-field="fromContainer"><field-map field-name="containerId" from="oldValueText"/></entity-find-one><entity-find-one entity-name="mantle.product.asset.Container" value-field="toContainer"><field-map field-name="containerId" from="newValueText"/></entity-find-one></else-if></if></row-actions><field name="assetId" from="asset.assetId"><default-field title="Asset"><link url="assetDetail" text="AssetNameTemplate" text-map="asset" link-type="anchor" parameter-map="[assetId:asset.assetId]"/></default-field></field><field name="productId" from="asset.productId"><default-field title="Product"><link url="editProduct" text="ProductNameTemplate" entity-name="mantle.product.Product" link-type="anchor" parameter-map="[productId:asset.productId]"/></default-field></field><field name="facilityId" from="asset.facilityId"><default-field title="Facility"><link url="editFacility" text="FacilityNameTemplate" entity-name="mantle.facility.Facility" link-type="anchor" parameter-map="[facilityId:asset.facilityId]"/></default-field></field><field name="fromLocation"><default-field><label text="FacilityLocationNameTemplate" text-map="fromFacLoc?:[:]" condition="fromFacLoc"/></default-field></field><field name="toLocation"><default-field><label text="FacilityLocationNameTemplate" text-map="toFacLoc?:[:]" condition="toFacLoc"/></default-field></field><field name="fromContainer"><default-field><label text="ContainerNameTemplate" text-map="fromContainer?:[:]" condition="fromContainer"/></default-field></field><field name="toContainer"><default-field><label text="ContainerNameTemplate" text-map="toContainer?:[:]" condition="toContainer"/></default-field></field><field name="changedDate"><default-field title="Date Moved"><display format="yyyy-MM-dd HH:mm"/></default-field></field><field name="moveAgain"><default-field title=""><link url="moveAsset" text="Move Again" parameter-map="[assetId:asset.assetId]" link-type="anchor-button"/></default-field></field></form-list></widgets></section><section name="RecentContainerMoves"><actions><entity-find entity-name="moqui.entity.EntityAuditLog" list="recentContainerMoveList" limit="10"><econdition field-name="changedEntityName" value="mantle.product.asset.Container"/><econdition field-name="changedFieldName" value="locationSeqId"/><econdition field-name="changedByUserId" from="ec.user.userId"/><econdition field-name="changedDate" operator="greater" from="ec.user.nowTimestamp - 5"/><order-by field-name="-changedDate"/></entity-find></actions><widgets><label text="Recent Container Moves" type="h4"/><form-list name="RecentContainerMoveForm" list="recentContainerMoveList" skip-form="true"><row-actions><entity-find-one entity-name="mantle.product.asset.Container" value-field="container"><field-map field-name="containerId" from="pkPrimaryValue"/></entity-find-one><entity-find-one entity-name="mantle.facility.FacilityLocation" value-field="fromFacLoc" cache="true"><field-map field-name="facilityId" from="container.facilityId"/><field-map field-name="locationSeqId" from="oldValueText"/></entity-find-one><entity-find-one entity-name="mantle.facility.FacilityLocation" value-field="toFacLoc" cache="true"><field-map field-name="facilityId" from="container.facilityId"/><field-map field-name="locationSeqId" from="newValueText"/></entity-find-one></row-actions><field name="container"><default-field><link url="editContainer" text="${container.serialNumber ?: container.containerId}" parameter-map="[containerId:container.containerId]" link-type="anchor"/></default-field></field><field name="containerTypeEnumId" from="container.containerTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="facilityId" from="container.facilityId"><default-field title="Facility"><link url="editFacility" text="FacilityNameTemplate" entity-name="mantle.facility.Facility" link-type="anchor" parameter-map="[facilityId:container.facilityId]"/></default-field></field><field name="fromLocation"><default-field><label text="FacilityLocationNameTemplate" text-map="fromFacLoc?:[:]" condition="fromFacLoc"/></default-field></field><field name="toLocation"><default-field><label text="FacilityLocationNameTemplate" text-map="toFacLoc?:[:]" condition="toFacLoc"/></default-field></field><field name="changedDate"><default-field title="Date Moved"><display format="yyyy-MM-dd HH:mm"/></default-field></field><field name="moveAgain"><default-field title=""><link url="moveContainer" text="Move Again" parameter-map="[containerId:container.containerId]" link-type="anchor-button"/></default-field></field></form-list></widgets></section></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Asset/Asset/AssetDetail.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="true" default-menu-index="1"><parameter name="assetId" required="true"/><transition name="updateAsset"><service-call name="mantle.product.AssetServices.update#Asset" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateAssetAcquireCost"><service-call name="mantle.product.AssetServices.update#AssetAcquireCost" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="checkAssetReservations"><service-call name="mantle.product.AssetServices.check#AssetReservations" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="editProduct"><default-response url="//${appRoot}/Catalog/Product/EditProduct"/></transition><transition name="editFacility"><default-response url="//${appRoot}/Facility/EditFacility"/></transition><transition name="editContainer"><default-response url="//${appRoot}/Asset/Container/EditContainer"/></transition><transition name="orderDetail"><default-response url="//${appRoot}/Order/OrderDetail"/></transition><transition name="shipmentDetail"><default-response url="//${appRoot}/Shipment/ShipmentDetail"/></transition><transition name="findTransactionEntry"><default-response url="//${appRoot}/Accounting/Transaction/FindTransactionEntry"/></transition><transition name="editTransaction"><default-response url="//${appRoot}/Accounting/Transaction/EditTransaction"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getLotList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><actions><service-call name="mantle.product.AssetServices.get#AssetDisplayInfo" in-map="context" out-map="context"/><set field="statusChangeTransition" value="updateAsset"/></actions><widgets><container-row><row-col lg="5"><link url="findTransactionEntry" text="TX Entries" link-type="anchor-button" parameter-map="[assetId:assetId]"/><link url="checkAssetReservations" text="Check Reservations" parameter-map="[assetId:assetId]"/><container-dialog id="UpdateCostDialog" button-text="Update Cost & Owner"><label text="This will update all GL transactions for this Asset including receipt, issuance, and physical inventory changes."/><label text="NOTE: this should only be used to correct data as it rewrites the accounting history for this asset. Do not use to change ownership for a business transaction like a sale." type="p"/><form-single name="UpdateAssetAcquireCost" transition="updateAssetAcquireCost" map="asset"><field name="assetId"><default-field><hidden/></default-field></field><field name="acquireCost"><default-field><text-line size="10" format="#,##0.00##"/></default-field></field><field name="ownerPartyId"><default-field title="Owner Party"><drop-down><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></container-dialog><container-dialog id="AuditLogDialog" button-text="Audit Log" width="960"><form-list name="AuditLogList" list="auditLogList" skip-form="true"><entity-find entity-name="moqui.entity.EntityAuditLog" list="auditLogList"><econdition field-name="changedEntityName" value="mantle.product.asset.Asset"/><econdition field-name="changedFieldName" operator="not-equals" value="statusId"/><econdition field-name="pkPrimaryValue" from="assetId"/><select-field field-name="changedEntityName"/><order-by field-name="-changedDate"/></entity-find><field name="changedDate"><default-field title="Date"><display/></default-field></field><field name="changedByUserId"><default-field title="User"><display-entity text="UsernameTemplate" entity-name="mantle.party.PersonWithUserAccount" key-field-name="userId"/></default-field></field><field name="changedFieldName"><default-field title="Field"><display text="${org.moqui.util.StringUtilities.camelCaseToPretty(changedFieldName)}"/></default-field></field><field name="oldValueText"><default-field title="From"><display text="${ec.entity.formatFieldString(changedEntityName, changedFieldName, oldValueText)}"/></default-field></field><field name="newValueText"><default-field title="To"><display text="${ec.entity.formatFieldString(changedEntityName, changedFieldName, newValueText)}"/></default-field></field></form-list></container-dialog><form-single name="EditAsset" map="asset" transition="updateAsset"><field name="assetId"><default-field><display/></default-field></field><field name="assetTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="classEnumId"><default-field title="Class"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="AssetClass"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="productId"><default-field title="Product"><link url="editProduct" text="ProductNameTemplate" entity-name="mantle.product.Product" link-type="anchor" condition="productId"/></default-field></field><field name="quantityOnHandTotal"><default-field title="QOH"><display text="${ec.l10n.format(asset.quantityOnHandTotal, null)} (${product?.'Amount#moqui.basic.Uom'?.description?:'each'})"/></default-field></field><field name="availableToPromiseTotal"><default-field title="ATP"><display text="${ec.l10n.format(asset.availableToPromiseTotal, null)} (${product?.'Amount#moqui.basic.Uom'?.description?:'each'})"/></default-field></field><field name="facilityId"><default-field title="Facility"><link url="editFacility" entity-name="mantle.facility.Facility" text="FacilityNameTemplate" link-type="anchor"/></default-field></field><field name="locationSeqId"><default-field title="Location"><display text="FacilityLocationNameTemplate" text-map="facilityLocation"/></default-field></field><field name="containerId"><default-field title="Container"><link url="editContainer" text="${containerId}" link-type="anchor"/></default-field></field><field name="assetPoolId"><default-field title="Pool"><display-entity entity-name="mantle.product.asset.AssetPool" text="${pseudoId}: ${description}"/></default-field></field><field name="ownerPartyId"><default-field title="Owner Party"><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameTemplate"/></default-field></field><field name="acquireCost"><default-field><display currency-unit-field="acquireCostUomId"/><link url="orderDetail" text="PO #${asset.acquireOrderId?:'N/A'}" parameter-map="[orderId:asset.acquireOrderId]" link-type="anchor" condition="asset.acquireOrderId"/></default-field></field><field name="acquireShipmentId"><conditional-field title="From Shipment" condition="acquireShipmentId"><link url="shipmentDetail" text="${asset.acquireShipmentId}" link-type="anchor" condition="asset.acquireShipmentId" parameter-map="[shipmentId:asset.acquireShipmentId]"/></conditional-field></field><field name="acquireWorkEffortId"><conditional-field title="From Run" condition="acquireWorkEffortId"><link url="productionRun" text="${asset.acquireWorkEffortId}" link-type="anchor" condition="asset.acquireWorkEffortId" parameter-map="[workEffortId:asset.acquireWorkEffortId]"/></conditional-field></field><field name="receivedDate"><default-field title="Received"><display/></default-field></field><field name="acquiredDate"><default-field title="Acquired"><date-time/></default-field></field><field name="manufacturedDate"><default-field title="Manufactured"><date-time/></default-field></field><field name="lotId"><default-field title="Lot"><drop-down allow-empty="true"><dynamic-options transition="getLotList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="serialNumber"><conditional-field condition="isFixedAsset || hasQuantity != 'Y' || quantityOnHandTotal == 1.0"><text-line size="40"/></conditional-field></field><field name="softIdentifier"><conditional-field title="Soft Identifier" condition="isFixedAsset || hasQuantity != 'Y' || quantityOnHandTotal == 1.0"><text-line size="40"/></conditional-field></field><field name="assetName"><conditional-field title="Name" condition="isFixedAsset"><text-line size="60"/></conditional-field></field><field name="depreciationTypeEnumId"><conditional-field title="Depreciation Type" condition="isFixedAsset"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="DepreciationType"/><set field="allowEmpty" value="true"/></widget-template-include></conditional-field></field><field name="expectedEndOfLife"><conditional-field condition="isFixedAsset"><date-time type="date"/></conditional-field></field><field name="salvageValue"><conditional-field condition="isFixedAsset"><text-line size="8" format="#,##0.00"/></conditional-field></field><field name="depreciation"><conditional-field condition="isFixedAsset"><display currency-unit-field="acquireCostUomId"/></conditional-field></field><field name="yearBeginDepreciation"><conditional-field condition="isFixedAsset"><display currency-unit-field="acquireCostUomId"/></conditional-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field-layout><field-row><field-ref name="assetId"/><field-ref name="assetTypeEnumId"/></field-row><field-ref name="classEnumId"/><field-ref name="productId"/><field-row><field-ref name="quantityOnHandTotal"/><field-ref name="availableToPromiseTotal"/></field-row><field-ref name="facilityId"/><field-ref name="locationSeqId"/><field-ref name="containerId"/><field-row><field-ref name="ownerPartyId"/><field-ref name="acquireCost"/></field-row><fields-not-referenced/></field-layout></form-single></row-col><row-col lg="7"><section-include name="StatusChangeSection" location="component://SimpleScreens/template/basic/StatusWidgets.xml"/><section-include name="StatusHistorySection" location="component://SimpleScreens/template/basic/StatusWidgets.xml"/><container-box><box-header title="Reservations"/><box-body-nopad><form-list name="ReservationsListForm" list="assetReservationList" skip-form="true"><field name="assetReservationId"><default-field title="ID"><display/></default-field></field><field name="reservedDate"><default-field title="Date"><display format="yyyy-MM-dd HH:mm"/></default-field></field><field name="quantity" show-total="true" align="right"><default-field><display/></default-field></field><field name="quantityNotAvailable" show-total="true" align="right"><default-field title="Not Avail"><display/></default-field></field><field name="quantityNotIssued" show-total="true" align="right"><default-field title="Not Issued"><display/></default-field></field><field name="orderId"><default-field title="Order"><link url="orderDetail" text="${orderId}" link-type="anchor" condition="orderId"/></default-field></field></form-list></box-body-nopad></container-box><section name="DetailSection"><widgets><container-box><box-header title="Recent Detail History"/><box-body-nopad><form-list name="AssetDetailList" list="assetDetailList" skip-form="true"><row-actions><entity-find-one entity-name="mantle.product.receipt.AssetReceipt" value-field="assetReceipt"/><entity-find-one entity-name="mantle.product.issuance.AssetIssuance" value-field="assetIssuance"/><entity-find-one entity-name="mantle.product.issuance.AssetReservation" value-field="assetReservation"/><entity-find-one entity-name="mantle.product.asset.PhysicalInventory" value-field="physicalInventory"/><entity-find-one entity-name="moqui.basic.Enumeration" value-field="varianceReasonEnum"><field-map field-name="enumId" from="varianceReasonEnumId"/></entity-find-one></row-actions><field name="effectiveDate"><default-field title="Date"><display format="yyyy-MM-dd HH:mm"/></default-field></field><field name="quantityOnHandDiff"><default-field title="QOH Diff"><display/></default-field></field><field name="availableToPromiseDiff"><default-field title="ATP Diff"><display/></default-field></field><field name="source"><conditional-field condition="assetReceipt"><label text="Receipt #${assetReceiptId}"/><link url="shipmentDetail" text="Shipment #${assetReceipt.shipmentId}" parameter-map="[shipmentId:assetReceipt.shipmentId]" link-type="anchor" condition="assetReceipt.shipmentId"/><link url="orderDetail" text="PO #${assetReceipt.orderId}" parameter-map="[orderId:assetReceipt.orderId]" link-type="anchor" condition="assetReceipt.orderId"/></conditional-field><conditional-field condition="assetIssuance"><label text="Issuance #${assetIssuanceId}"/><link url="shipmentDetail" text="Shipment #${assetIssuance.shipmentId}" parameter-map="[shipmentId:assetIssuance.shipmentId]" link-type="anchor" condition="assetIssuance.shipmentId"/><link url="orderDetail" text="SO #${assetIssuance.orderId}" parameter-map="[orderId:assetIssuance.orderId]" link-type="anchor" condition="assetIssuance.orderId"/></conditional-field><conditional-field condition="assetReservationId"><label text="Reservation #${assetReservationId}"/><label text=" (reservation removed)" condition="!assetReservation"/><link url="orderDetail" text="Order #${assetReservation?.orderId ?: orderId}" link-type="anchor" parameter-map="[orderId:(assetReservation?.orderId ?: orderId)]" condition="assetReservation?.orderId ?: orderId"/></conditional-field><conditional-field condition="otherAssetId"><link url="." text="Move, other asset: ${otherAssetId}" link-type="anchor" parameter-map="[assetId:otherAssetId]"/></conditional-field><conditional-field condition="physicalInventory"><label text="Physical Inventory #${physicalInventoryId} (${varianceReasonEnum?.description})"/></conditional-field><default-field><display text=" "/></default-field></field></form-list></box-body-nopad></container-box></widgets></section><section name="AssetDepreciation" condition="asset.depreciationTypeEnumId"><actions><service-call name="mantle.ledger.AssetAutoPostServices.calculate#FixedAssetDepreciation" in-map="[assetId:assetId]" out-map="curDepOut"/><entity-find entity-name="mantle.product.asset.AssetDepreciation" list="assetDepreciationList"><econdition field-name="assetId"/></entity-find></actions><widgets><container-box><box-header title="Depreciation"/><box-body><label text="Current Depreciation" type="h5"/><container-row><row-col lg="3"><label text="Useful Years" type="strong"/></row-col><row-col lg="1"><label text="${curDepOut.usefulLifeYears}"/></row-col><row-col lg="3"><label text="Remaining" type="strong"/></row-col><row-col lg="1"><label text="${curDepOut.yearsRemaining}"/></row-col><row-col lg="3"><label text="Last Year Period?" type="strong"/></row-col><row-col lg="1"><label text="${curDepOut.isLastYearPeriod ? 'Y' : 'N'}"/></row-col></container-row><container-row><row-col lg="3"><label text="Annual Depr." type="strong"/></row-col><row-col lg="3"><label text="${ec.l10n.formatCurrency(curDepOut.annualDepreciation, asset.acquireCostUomId)}"/></row-col><row-col lg="3"><label text="Monthly Depr." type="strong"/></row-col><row-col lg="3"><label text="${ec.l10n.formatCurrency(curDepOut.monthlyDepreciation, asset.acquireCostUomId)}"/></row-col></container-row><container-row><row-col lg="3"><label text="Net Book Value" type="strong"/></row-col><row-col lg="3"><label text="${ec.l10n.formatCurrency(curDepOut.netBookValue, asset.acquireCostUomId)}"/></row-col><row-col lg="3"><label text="Year Begin Net Book" type="strong"/></row-col><row-col lg="3"><label text="${ec.l10n.formatCurrency(curDepOut.yearBeginNetBookValue, asset.acquireCostUomId)}"/></row-col></container-row><label text="Depreciation History" type="h5"/></box-body><box-body-nopad><form-list name="AssetDepreciationList" list="assetDepreciationList"><field name="timePeriodId"><default-field title="Period"><display-entity entity-name="mantle.party.time.TimePeriod" text="${periodName}"/></default-field></field><field name="usefulLifeYears"><default-field title="Useful Years"><display/></default-field></field><field name="yearsRemaining"><default-field title="Remaining"><display/></default-field></field><field name="isLastYearPeriod"><default-field title="Last Year Period"><display/></default-field></field><field name="monthlyDepreciation"><default-field title="Monthly"><display currency-unit-field="asset.acquireCostUomId"/></default-field></field><field name="annualDepreciation"><default-field title="Annual"><display currency-unit-field="asset.acquireCostUomId"/></default-field></field><field name="yearBeginDepreciation"><default-field title="Year Begin"><display currency-unit-field="asset.acquireCostUomId"/></default-field></field><field name="acctgTransId"><default-field title="TX"><link url="editTransaction" text="${acctgTransId}" link-type="anchor" parameter-map="[acctgTransId:acctgTransId]"/></default-field></field><form-list-column><field-ref name="timePeriodId"/></form-list-column><form-list-column><field-ref name="usefulLifeYears"/><field-ref name="yearsRemaining"/></form-list-column><form-list-column><field-ref name="monthlyDepreciation"/><field-ref name="annualDepreciation"/></form-list-column><form-list-column><field-ref name="yearBeginDepreciation"/><field-ref name="acctgTransId"/></form-list-column></form-list></box-body-nopad></container-box></widgets></section></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Asset/Asset/DetailHistory.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Detail History" default-menu-index="2"><parameter name="assetId" required="true"/><transition name="editProduct"><default-response url="//${appRoot}/Catalog/Product/EditProduct"/></transition><transition name="orderDetail"><default-response url="//${appRoot}/Order/OrderDetail"/></transition><transition name="shipmentDetail"><default-response url="//${appRoot}/Shipment/ShipmentDetail"/></transition><transition name="findTransactionEntry"><default-response url="//${appRoot}/Accounting/Transaction/FindTransactionEntry"/></transition><actions><entity-find entity-name="mantle.product.asset.AssetDetail" list="assetDetailList"><search-form-inputs default-order-by="-effectiveDate"/><econdition field-name="assetId"/></entity-find></actions><widgets><form-list name="AssetDetailList" list="assetDetailList" skip-form="true" header-dialog="true" show-page-size="true"><row-actions><entity-find-one entity-name="mantle.product.receipt.AssetReceipt" value-field="assetReceipt"/><entity-find-one entity-name="mantle.product.issuance.AssetIssuance" value-field="assetIssuance"/><entity-find-one entity-name="mantle.product.issuance.AssetReservation" value-field="assetReservation"/><entity-find-one entity-name="mantle.product.asset.PhysicalInventory" value-field="physicalInventory"/><entity-find-one entity-name="moqui.basic.Enumeration" value-field="varianceReasonEnum"><field-map field-name="enumId" from="varianceReasonEnumId"/></entity-find-one></row-actions><field name="effectiveDate"><header-field title="Date" show-order-by="true"><date-period allow-empty="true"/></header-field><default-field><display format="yyyy-MM-dd HH:mm"/></default-field></field><field name="quantityOnHandDiff" show-total="true" align="right"><header-field title="QOH Diff" show-order-by="true"/><default-field><display/></default-field></field><field name="availableToPromiseDiff" show-total="true" align="right"><header-field title="ATP Diff" show-order-by="true"/><default-field><display/></default-field></field><field name="source"><conditional-field condition="assetReceipt"><label text="Receipt #${assetReceiptId}"/><link url="shipmentDetail" text="Shipment #${assetReceipt.shipmentId}" parameter-map="[shipmentId:assetReceipt.shipmentId]" link-type="anchor" condition="assetReceipt.shipmentId"/><link url="orderDetail" text="PO #${assetReceipt.orderId}" parameter-map="[orderId:assetReceipt.orderId]" link-type="anchor" condition="assetReceipt.orderId"/></conditional-field><conditional-field condition="assetIssuance"><label text="Issuance #${assetIssuanceId}"/><link url="shipmentDetail" text="Shipment #${assetIssuance.shipmentId}" parameter-map="[shipmentId:assetIssuance.shipmentId]" link-type="anchor" condition="assetIssuance.shipmentId"/><link url="orderDetail" text="SO #${assetIssuance.orderId}" parameter-map="[orderId:assetIssuance.orderId]" link-type="anchor" condition="assetIssuance.orderId"/></conditional-field><conditional-field condition="assetReservationId"><label text="Reservation #${assetReservationId}"/><label text=" (reservation removed)" condition="!assetReservation"/><link url="orderDetail" text="Order #${assetReservation?.orderId ?: orderId}" link-type="anchor" parameter-map="[orderId:(assetReservation?.orderId ?: orderId)]" condition="assetReservation?.orderId ?: orderId"/></conditional-field><conditional-field condition="otherAssetId"><link url="." text="Move, other asset: ${otherAssetId}" link-type="anchor" parameter-map="[assetId:otherAssetId]"/></conditional-field><conditional-field condition="physicalInventory"><label text="Physical Inventory #${physicalInventoryId} (${varianceReasonEnum?.description})"/></conditional-field><default-field><display text=" "/></default-field></field><field name="findButton"><header-field title="Find"><submit/></header-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Asset/Asset/FindSummary/PhysicalChange.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="productId" required="true"/><parameter name="facilityId" required="true"/><parameter name="locationSeqId"/><parameter name="ownerPartyId"/><parameter name="lotId"/><parameter name="assetPoolId"/><parameter name="statusId"/><transition name="recordChange"><service-call name="mantle.product.AssetServices.record#PhysicalInventoryChange" in-map="true" out-map="context" multi="parameter"/><default-response type="screen-last"/></transition><actions><entity-find-one entity-name="mantle.facility.Facility" value-field="facility"/><if condition="locationSeqId"><entity-find-one entity-name="mantle.facility.FacilityLocation" value-field="facLoc"/></if><if condition="!ownerPartyId"><set field="ownerPartyId" from="facility?.ownerPartyId"/></if><entity-find entity-name="mantle.product.asset.AssetLotSummary" list="assetLotList"><econdition field-name="productId"/><econdition field-name="facilityId"/><econdition field-name="lotId" operator="is-not-null"/><having-econditions><econdition field-name="quantityOnHandTotal" operator="greater" from="0.0"/></having-econditions><select-field field-name="lotId,quantityOnHandTotal"/></entity-find><set field="qohByLotId" from="[:]"/><iterate list="assetLotList" entry="assetLot"><script><![CDATA[qohByLotId.put(assetLot.lotId, assetLot.quantityOnHandTotal)]]></script></iterate></actions><widgets><label text="For physical inventory assets are grouped by Product, Facility, Location, Lot, Owner, Pool, and Status." type="p"/><label text="Product and Facility are required. If no Location, Lot, Owner, Pool, or Status is selected only assets with no value will be adjusted." type="p"/><label text="If Quantity Difference is negative asset records will be adjusted oldest first, if positive then newest first." type="p"/><form-single name="RecordChange" transition="recordChange" extends="component://SimpleScreens/screen/SimpleScreens/Asset/Asset/FindSummary/PhysicalQuantity.xml#RecordQuantity"><field name="quantity"><default-field><ignored/></default-field></field><field name="quantityChange"><default-field title="Quantity Difference"><text-line size="6"/></default-field></field></form-single></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Asset/Asset/FindSummary/PhysicalQuantity.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="productId" required="true"/><parameter name="facilityId" required="true"/><parameter name="locationSeqId"/><parameter name="ownerPartyId"/><parameter name="lotId"/><parameter name="assetPoolId"/><parameter name="statusId"/><transition name="recordQuantity"><service-call name="mantle.product.AssetServices.record#PhysicalInventoryQuantity" in-map="true" out-map="context" multi="parameter"/><default-response type="screen-last"/></transition><transition-include name="getAssetPoolList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><actions><entity-find-one entity-name="mantle.facility.Facility" value-field="facility"/><if condition="locationSeqId"><entity-find-one entity-name="mantle.facility.FacilityLocation" value-field="facLoc"/></if><if condition="!ownerPartyId"><set field="ownerPartyId" from="facility?.ownerPartyId"/></if><entity-find entity-name="mantle.product.asset.AssetLotSummary" list="assetLotList"><econdition field-name="productId"/><econdition field-name="facilityId"/><econdition field-name="lotId" operator="is-not-null"/><having-econditions><econdition field-name="quantityOnHandTotal" operator="greater" from="0.0"/></having-econditions><select-field field-name="lotId,quantityOnHandTotal"/></entity-find><set field="qohByLotId" from="[:]"/><iterate list="assetLotList" entry="assetLot"><script><![CDATA[qohByLotId.put(assetLot.lotId, assetLot.quantityOnHandTotal)]]></script></iterate></actions><widgets><label text="For physical inventory assets are grouped by Product, Facility, Location, Lot, Owner, Pool, and Status." type="p"/><label text="Product and Facility are required. If no Location, Lot, Owner, Pool, or Status is selected only assets with no value will be included in the currently recorded quantity and only assets with no value will be adjusted." type="p"/><label text="If Quantity is less that current then asset records will be adjusted down oldest first, if greater then adjusted up newest first." type="p"/><form-single name="RecordQuantity" transition="recordQuantity"><field name="productId"><default-field title="Product"><display-entity entity-name="mantle.product.Product" text="ProductNameTemplate"/></default-field></field><field name="facilityId"><default-field title="Facility"><display text="FacilityNameTemplate" text-map="facility"/></default-field></field><field name="locationSeqId"><default-field title="Location"><display text="FacilityLocationNameTemplate" text-map="facLoc?:[locationSeqId:'None']"/></default-field></field><field name="lotId"><default-field title="Lot"><drop-down allow-empty="true"><entity-options key="${lotId}" text="${lotId}: ${pseudoId?:mfgParty?.pseudoId?:''} ${lotNumber?:'No Lot #'} Mfg ${ec.l10n.format(manufacturedDate, 'yyyy-MM-dd')?:'N/A'} Exp ${ec.l10n.format(expirationDate, 'yyyy-MM-dd')} QOH ${ec.l10n.format(qohByLotId.get(lotId), null)}"><entity-find entity-name="mantle.product.asset.LotAndMfgParty"><econdition field-name="lotId" operator="in" from="qohByLotId.keySet()"/><order-by field-name="lotNumber"/></entity-find></entity-options></drop-down></default-field></field><field name="ownerPartyId"><default-field title="Owner Party"><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameTemplate"/></default-field></field><field name="assetPoolId"><default-field title="Pool"><drop-down allow-empty="true"><dynamic-options transition="getAssetPoolList" server-search="true" min-length="0" parameter-map="[partyId:ownerPartyId]"/></drop-down></default-field></field><field name="statusId"><default-field title="Status"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="Asset"/><set field="noCurrentSelectedKey" value="AstAvailable"/></widget-template-include></default-field></field><field name="strictAll" from="'true'"><default-field><hidden/></default-field></field><field name="quantity"><default-field title="Physical Quantity"><text-line size="6"/></default-field></field><field name="quantityChange"><default-field><ignored/></default-field></field><field name="comments"><default-field><text-area cols="60" rows="5"/></default-field></field><field name="varianceReasonEnumId"><default-field title="Variance Reason"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="InventoryVarianceReason"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="physicalInventoryDate" from="ec.user.nowTimestamp"><default-field title="Inventory Date"><date-time/></default-field></field><field name="submitButton"><default-field title="Record"><submit/></default-field></field></form-single></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Asset/Asset/FindSummary.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" default-menu-index="2"><transition name="findAsset"><default-response url="../FindAsset"/></transition><transition name="editProduct"><default-response url="//${appRoot}/Catalog/Product/EditProduct"/></transition><transition name="editFacility"><default-response url="//${appRoot}/Facility/EditFacility"/></transition><transition name="editContainer"><default-response url="//${appRoot}/Asset/Container/EditContainer"/></transition><transition name="assetOnHand"><default-response url="//${appRoot}/Accounting/Reports/AssetOnHand"/></transition><transition name="receiveAsset"><service-call name="mantle.product.AssetServices.receive#Asset" in-map="true" out-map="context" multi="parameter"/><default-response url="../AssetDetail"/><error-response url="."/></transition><transition name="recordChange"><service-call name="mantle.product.AssetServices.record#PhysicalInventoryChange" in-map="true" out-map="context" multi="parameter"/><default-response url=".." parameter-map="[productId:productId, facilityId:facilityId, locationSeqId:locationSeqId]"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getLotList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getAssetPoolList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getFacilityList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><transition-include name="getLocationList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><transition-include name="getContainerList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><actions><entity-find entity-name="mantle.facility.Facility" list="facilityList"><econdition field-name="facilityTypeEnumId" value="FcTpWarehouse"/><order-by field-name="facilityName"/></entity-find><service-call name="org.moqui.impl.BasicServices.find#Enumeration" in-map="[enumTypeId:'RejectionReason']" out-map="reasonOut"/></actions><widgets><link url="../FindAsset" text="Find Individual Assets"/><link url="../SelectAsset" text="Move Asset"/><link url="../../Container" text="Containers"/><link url="../../EditLots" text="Lots"/><link url="../../AssetPool" text="Pools"/><link url="assetOnHand" text="On Hand Report"/><container-dialog id="ReceiveAssetDialog" button-text="Receive Direct" width="800"><label text="NOTE: only receive inventory here if there is no Purchase Order and no Incoming Shipment for the inventory." type="p" style="text-warning"/><form-single name="ReceiveAssetForm" transition="receiveAsset"><field name="productId"><default-field title="Product*"><drop-down><dynamic-options transition="getProductList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="statusId"><default-field title="Status" tooltip="For inventory defaults to Available, otherwise defaults to In Storage"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="Asset"/><set field="allowEmpty" value="true"/><set field="noCurrentSelectedKey" value="AstAvailable"/></widget-template-include></default-field></field><field name="receivedDate" from="ec.user.nowTimestamp"><default-field title="Received Date"><date-time/></default-field></field><field name="mfgPartyId"><default-field title="Manufacturer"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="0" parameter-map="[roleTypeId:'Supplier,Manufacturer']"/></drop-down></default-field></field><field name="lotId"><default-field title="Lot" tooltip="Select an existing Lot, for new enter Lot Number (and Dates) below"><drop-down allow-empty="true"><dynamic-options transition="getLotList" server-search="true" min-length="0"><depends-on field="mfgPartyId"/></dynamic-options></drop-down></default-field></field><field name="lotNumber"><default-field tooltip="For new lot enter Lot Number (and Dates), for existing select above"><text-line size="20"/></default-field></field><field name="manufacturedDate"><default-field title="Manufactured"><date-time type="date"/></default-field></field><field name="expectedEndOfLife"><default-field title="Expiration"><date-time type="date"/></default-field></field><field name="ownerPartyId" from="ownerPartyId ?: activeOrgId"><default-field title="Owner"><label text="Default Asset Owner (${ownerPartyId}) different from Facility owner (${destinationFacility.ownerPartyId}), if not consignment inventory change now" style="text-warning" condition="ownerPartyId && destinationFacility?.ownerPartyId && ownerPartyId != destinationFacility.ownerPartyId"/><label text="Asset Owner will default to Facility owner" condition="!ownerPartyId"/><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="0" parameter-map="[roleTypeId:'Supplier,OrgInternal']"/></drop-down></default-field></field><field name="assetPoolId"><default-field title="Pool"><drop-down allow-empty="true"><dynamic-options transition="getAssetPoolList" server-search="true" min-length="0" depends-optional="true"><depends-on field="ownerPartyId"/></dynamic-options></drop-down></default-field></field><field name="acquireCost"><default-field><text-line size="8" format="#,##0.00"/></default-field></field><field name="quantity"><default-field title="Quantity*"><text-line size="8"/></default-field></field><field name="facilityId"><default-field title="Facility*"><drop-down><dynamic-options transition="getFacilityList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="locationSeqId"><default-field title="Location"><drop-down allow-empty="true"><dynamic-options transition="getLocationList" server-search="true" min-length="0"><depends-on field="facilityId"/></dynamic-options></drop-down></default-field></field><field name="containerId"><default-field title="Container"><drop-down allow-empty="true"><dynamic-options transition="getContainerList" server-search="true" min-length="0"><depends-on field="facilityId"/><depends-on field="locationSeqId"/></dynamic-options></drop-down></default-field></field><field name="comments"><default-field title="Notes"><text-area cols="80" rows="3"/></default-field></field><field name="submitButton"><default-field title="Receive"><submit/></default-field></field><field-layout><field-ref name="productId"/><field-row><field-ref name="statusId"/><field-ref name="receivedDate"/></field-row><field-row><field-ref name="quantity"/></field-row><field-ref name="facilityId"/><field-ref name="ownerPartyId"/><field-ref name="assetPoolId"/><field-ref name="locationSeqId"/><field-ref name="containerId"/><field-ref name="mfgPartyId"/><field-ref name="lotId"/><field-ref name="lotNumber"/><field-row><field-ref name="manufacturedDate"/><field-ref name="expectedEndOfLife"/></field-row><field-ref name="acquireCost"/><field-ref name="comments"/><field-ref name="submitButton"/></field-layout></form-single></container-dialog><container-dialog id="PhysicalManualDialog" button-text="Physical Diff" title="Physical Inventory Difference"><form-single name="PhysicalManualChange" transition="recordChange"><field name="productId"><default-field title="Product"><drop-down><dynamic-options transition="getProductList" server-search="true"/></drop-down></default-field></field><field name="facilityId"><default-field title="Facility"><drop-down><dynamic-options transition="getFacilityList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="locationSeqId"><default-field title="Location"><drop-down allow-empty="true"><dynamic-options transition="getLocationList" server-search="true" min-length="0" depends-optional="true"><depends-on field="facilityId"/></dynamic-options></drop-down></default-field></field><field name="lotId"><default-field title="Lot"><drop-down allow-empty="true"><dynamic-options transition="getLotList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="ownerPartyId"><default-field title="Owner Party"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="assetPoolId"><default-field title="Pool"><drop-down allow-empty="true"><dynamic-options transition="getAssetPoolList" server-search="true" min-length="0" depends-optional="true"><depends-on field="ownerPartyId"/></dynamic-options></drop-down></default-field></field><field name="statusId"><default-field title="Status"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="Asset"/><set field="noCurrentSelectedKey" value="AstAvailable"/></widget-template-include></default-field></field><field name="strictAll" from="'true'"><default-field><hidden/></default-field></field><field name="quantityChange"><default-field title="Quantity Difference"><text-line size="6"/></default-field></field><field name="comments"><default-field><text-area cols="60" rows="5"/></default-field></field><field name="varianceReasonEnumId"><default-field title="Variance Reason"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="InventoryVarianceReason"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="physicalInventoryDate" from="ec.user.nowTimestamp"><default-field title="Inventory Date"><date-time/></default-field></field><field name="submitButton"><default-field title="Record"><submit/></default-field></field></form-single></container-dialog><form-list name="AssetSummary" list="assetList" skip-form="true" header-dialog="true" saved-finds="true" select-columns="true" show-csv-button="true" show-xlsx-button="true" show-all-button="true"><entity-find entity-name="mantle.product.asset.AssetSummaryView" list="assetList" use-clone="true"><search-form-inputs default-order-by="productName,facilityId,lotId" skip-fields="assetTypeEnumId" require-parameters="true"/><econdition field-name="assetTypeEnumId" ignore-if-empty="true"/><having-econditions combine="or"><econdition field-name="quantityOnHandTotal" operator="not-equals" from="0.0" ignore="showZeroQuantity == 'true'"/><econdition field-name="availableToPromiseTotal" operator="not-equals" from="0.0" ignore="showZeroQuantity == 'true'"/></having-econditions><select-field field-name="productId"/></entity-find><row-actions><entity-find-one entity-name="mantle.facility.FacilityLocation" value-field="facLoc" cache="true"/></row-actions><field name="showZeroQuantity"><header-field title="Zero Quantity"><check><option key="true" text="Show summary records with zero QOH and ATP"/></check></header-field></field><field name="assetsLink"><default-field title="Assets"><link url="findAsset" text="Assets" parameter-map="[productId:productId, statusId:statusId,                             facilityId:facilityId, locationSeqId:locationSeqId, lotId:lotId]" condition="pseudoId"/></default-field></field><field name="productId"><header-field title="Product"><drop-down allow-empty="true"><dynamic-options transition="getProductList" server-search="true"/></drop-down></header-field></field><field name="pseudoId"><header-field title="Product ID" show-order-by="true"><text-find size="15" hide-options="true"/></header-field><default-field><link url="editProduct" text="${pseudoId?:productId}" link-type="anchor"/></default-field></field><field name="productName"><header-field show-order-by="case-insensitive"><text-find size="15" hide-options="true"/></header-field><default-field><display/></default-field></field><field name="assetTypeEnumId"><header-field title="Asset Type" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="AssetType"/><set field="allowMultiple" value="true"/><set field="allowEmpty" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="classEnumId"><header-field title="Asset Class" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="AssetClass"/><set field="allowMultiple" value="true"/><set field="allowEmpty" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="statusId"><header-field title="Status" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="Asset"/><set field="allowMultiple" value="true"/><set field="allowEmpty" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="ownerPartyId"><header-field title="Owner Party"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></header-field><default-field><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameTemplate"/></default-field></field><field name="acquireCost"><header-field><range-find size="5"/></header-field><default-field><display/></default-field></field><field name="facilityId"><header-field title="Facility" show-order-by="case-insensitive"><drop-down allow-empty="true"><dynamic-options transition="getFacilityList" server-search="true" min-length="0" parameter-map="[ownerPartId:null]"/></drop-down></header-field><default-field><link url="editFacility" entity-name="mantle.facility.Facility" text="FacilityNameTemplate" link-type="anchor"/></default-field></field><field name="locationSeqId"><header-field title="Location" show-order-by="true"><drop-down allow-empty="true"><dynamic-options transition="getLocationList" server-search="true" min-length="0" depends-optional="true"><depends-on field="facilityId"/></dynamic-options></drop-down></header-field><default-field><label condition="locationSeqId" text-map="facLoc" text="FacilityLocationNameTemplate"/></default-field></field><field name="containerId"><header-field title="Container" show-order-by="true"><drop-down allow-empty="true"><dynamic-options transition="getContainerList" server-search="true" min-length="0" depends-optional="true"><depends-on field="facilityId"/><depends-on field="locationSeqId"/></dynamic-options></drop-down></header-field><default-field><link url="editContainer" entity-name="mantle.product.asset.Container" text="ContainerNameTemplate" link-type="anchor"/></default-field></field><field name="lotId"><header-field title="Lot" show-order-by="true"><drop-down allow-empty="true"><dynamic-options transition="getLotList" server-search="true" min-length="2"/></drop-down></header-field><default-field><display-entity entity-name="mantle.product.asset.LotAndMfgParty" text="LotNameTemplate"/></default-field></field><field name="assetPoolId"><header-field title="Asset Pool"><drop-down allow-empty="true"><dynamic-options transition="getAssetPoolList" server-search="true" min-length="0"/></drop-down></header-field><default-field><display-entity entity-name="mantle.product.asset.AssetPool" text="${pseudoId}: ${description}"/></default-field></field><field name="availableToPromiseTotal" align="right" show-total="true"><header-field title="Available" show-order-by="true"/><default-field><display/></default-field></field><field name="quantityOnHandTotal" align="right" show-total="true"><header-field title="On Hand" show-order-by="true"/><default-field><display/></default-field></field><field name="amountUomId" align="right"><header-field title="UOM"/><default-field><display-entity entity-name="moqui.basic.Uom" default-text="each"/></default-field></field><field name="physicalQuantity"><default-field title="PhI Qty"><dynamic-dialog id="PhysicalQuantityDialog" button-text="PhI Qty" title="Physical Inventory Quantity" transition="PhysicalQuantity" width="800" condition="productId && facilityId"/></default-field></field><field name="physicalChange"><default-field title="PhI Diff"><dynamic-dialog id="PhysicalChange" button-text="PhI Diff" title="Physical Inventory Difference" transition="PhysicalChange" width="800" condition="productId && facilityId"/></default-field></field><field name="moveLink"><default-field title="Move"><link url="../SelectAsset" text="Move" condition="quantityOnHandTotal" parameter-map="[productId:productId, facilityId:facilityId, locationSeqId:locationSeqId,                             containerId:containerId, lotId:lotId, assetPoolId:assetPoolId]"/></default-field></field><field name="findButton"><header-field title="Find"><submit/></header-field></field><form-list-column><field-ref name="assetsLink"/></form-list-column><form-list-column><field-ref name="pseudoId"/><field-ref name="productName"/><field-ref name="classEnumId"/></form-list-column><form-list-column><field-ref name="statusId"/><field-ref name="ownerPartyId"/><field-ref name="assetPoolId"/></form-list-column><form-list-column><field-ref name="facilityId"/><field-ref name="locationSeqId"/><field-ref name="lotId"/></form-list-column><form-list-column><field-ref name="availableToPromiseTotal"/><field-ref name="quantityOnHandTotal"/></form-list-column><form-list-column><field-ref name="physicalQuantity"/></form-list-column><form-list-column><field-ref name="moveLink"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Asset/Asset/MoveAsset.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Move" default-menu-index="3"><parameter name="assetId" required="true"/><transition name="completeMove"><service-call name="mantle.product.AssetServices.move#Asset" in-map="true" out-map="context" multi="parameter"/><default-response url="../SelectAsset"/><error-response url="."/></transition><transition name="editProduct"><default-response url="//${appRoot}/Catalog/Product/EditProduct"/></transition><transition name="editFacility"><default-response url="//${appRoot}/Facility/EditFacility"/></transition><transition name="editContainer"><default-response url="//${appRoot}/Asset/Container/EditContainer"/></transition><transition-include name="getFacilityList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><transition-include name="getLocationList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><transition-include name="getContainerList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><transition-include name="getAssetPoolList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><actions><entity-find-one entity-name="mantle.product.asset.Asset" value-field="asset"/><set field="productId" from="asset?.productId"/><set field="facilityId" from="asset?.facilityId"/><set field="facLoc" from="asset?.location"/><set field="container" from="asset?.container"/><entity-find entity-name="mantle.facility.ProductFacilityLocationDetail" list="pickLocList" distinct="true"><econdition field-name="productId"/><econdition field-name="facilityId"/><econdition field-name="locationTypeEnumId" value="FltPick"/><select-field field-name="locationSeqId,description,areaId,aisleId,sectionId,levelId,positionId"/></entity-find><if condition="!pickLocList"><entity-find entity-name="mantle.product.asset.AssetLocationDetail" list="pickLocList" distinct="true"><econdition field-name="productId"/><econdition field-name="facilityId"/><econdition field-name="locationTypeEnumId" value="FltPick"/><select-field field-name="locationSeqId,description,areaId,aisleId,sectionId,levelId,positionId"/></entity-find></if></actions><widgets><label text="Move Asset ${assetId}" type="h4"/><form-single name="AssetInfoForm" map="asset"><field name="productId"><default-field title="Product"><link url="editProduct" entity-name="mantle.product.Product" text="ProductNameTemplate" link-type="anchor"/></default-field></field><field name="facilityId"><default-field title="Facility"><link url="editFacility" entity-name="mantle.facility.Facility" text="FacilityNameTemplate" link-type="anchor"/></default-field></field><field name="currentLocation"><default-field><display text="FacilityLocationNameTemplate" text-map="facLoc?:[locationSeqId:'N/A']"/></default-field></field><field name="pickLocations"><default-field title="Pick Location(s)"><section-iterate name="RecLocList" list="pickLocList" entry="recLoc"><widgets><label text="${locationSeqId?:''} ${description?:''} [${areaId?:' '}:${aisleId?:' '}:${sectionId?:' '}:${levelId?:' '}:${positionId?:' '}]" text-map="recLoc" type="div"/></widgets></section-iterate></default-field></field><field name="currentContainer"><default-field><link url="editContainer" text="ContainerNameTemplate" text-map="container" condition="container" link-type="anchor"/></default-field></field><field name="quantityOnHandTotal"><default-field title="On Hand"><display/></default-field></field><field name="availableToPromiseTotal"><default-field title="Available"><display/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field-layout><field-row><field-ref name="productId"/><field-ref name="facilityId"/></field-row><field-row><field-ref name="currentLocation"/><field-ref name="pickLocations"/></field-row><field-ref name="currentContainer"/><field-row><field-ref name="quantityOnHandTotal"/><field-ref name="availableToPromiseTotal"/></field-row><field-ref name="statusId"/></field-layout></form-single><container-row><row-col md="6"><form-single name="ScanMoveAssetForm" transition="completeMove" focus-field="scanLocation"><field name="assetId"><default-field><hidden/></default-field></field><field name="facilityId"><default-field title="Facility"><drop-down allow-empty="true"><dynamic-options transition="getFacilityList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="quantity"><default-field title="Quantity" tooltip="For partial move, defaults to entire asset"><text-line size="20"/></default-field></field><field name="scanLocation"><default-field title="Scan Location" tooltip="Can be Location ID or Container ID or Serial Number (Plate ID)"><text-line size="20"/></default-field></field><field name="submitButton"><default-field title="Move Asset"><submit/></default-field></field></form-single></row-col><row-col md="6"><form-single name="EnterMoveAssetForm" transition="completeMove"><field name="assetId"><default-field><hidden/></default-field></field><field name="facilityId"><default-field title="Facility"><drop-down allow-empty="true"><dynamic-options transition="getFacilityList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="locationSeqId"><default-field title="Location"><drop-down allow-empty="true"><dynamic-options transition="getLocationList" server-search="true" min-length="0"><depends-on field="facilityId"/></dynamic-options></drop-down></default-field></field><field name="containerId"><default-field title="Container"><drop-down><dynamic-options transition="getContainerList" server-search="true" min-length="0"><depends-on field="facilityId"/><depends-on field="locationSeqId"/></dynamic-options></drop-down></default-field></field><field name="assetPoolId"><default-field title="Pool"><drop-down allow-empty="true"><dynamic-options transition="getAssetPoolList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="quantity"><default-field title="Quantity" tooltip="For partial move, defaults to entire asset"><text-line size="10"/></default-field></field><field name="submitButton"><default-field title="Move Asset"><submit/></default-field></field></form-single></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Asset/Asset/AssetCalendar.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Calendar" default-menu-index="4"><parameter name="assetId" required="true"/><transition name="createEvent"><service-call name="mantle.work.EventServices.create#Event" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="eventDetail"><default-response url="."/></transition><transition name="getCalendarEvents"><service-call name="mantle.work.EventServices.get#FullCalendarData" web-send-json-response="eventList" in-map="context + [urlGString:(sri.buildUrl('eventDetail').url + '?workEffortId=${workEffort.workEffortId}')]" out-map="context" multi="parameter"/><default-response type="none"/></transition><actions><entity-find-one entity-name="mantle.product.asset.Asset" value-field="asset"/></actions><widgets><container-dialog id="NewEventContainer" button-text="New Event"><form-single name="NewEventForm" transition="createEvent"><field name="assetId"><default-field><hidden/></default-field></field><field name="workEffortName"><default-field title="Name"><text-line size="40"/></default-field></field><field name="purposeEnumId"><default-field title="Purpose"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="WorkEffortPurpose"/><set field="noCurrentSelectedKey" value="WepAssetUsage"/></widget-template-include></default-field></field><field name="facilityId"><default-field title="Facility"><drop-down allow-empty="true"><entity-options key="${facilityId}" text="FacilityNameTemplate"><entity-find entity-name="mantle.facility.Facility" limit="200"><econdition field-name="facilityTypeEnumId" operator="in" value="FcTpBuilding,FcTpOffice,FcTpRoom,FcTpRetailStore,FcTpWarehouse"/><order-by field-name="facilityName"/></entity-find></entity-options></drop-down></default-field></field><field name="estimatedStartDate"><default-field title="Start Date"><date-time/></default-field></field><field name="estimatedWorkTime"><default-field title="Est. Hours"><text-line size="8"/></default-field></field><field name="description"><default-field title="Description"><text-area rows="10" cols="60"/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><render-mode><text type="html,vuet,qvt"><![CDATA[<div id="calendar"></div><script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.1.0/fullcalendar.min.js" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.1.0/locale-all.js" type="text/javascript"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.1.0/fullcalendar.min.css" type="text/css"/><script>
    $('#calendar').fullCalendar({ timezone: false, defaultView: 'agendaWeek',
        header: { left: 'prev,next today', center: 'title', right: 'month,agendaWeek,agendaDay' },
        eventSources: [ { url: "${sri.buildUrl('getCalendarEvents').url}", type: 'POST', data: { moquiSessionToken:'${ec.web.sessionToken}', assetId: '${assetId}' } } ]
    });
                </script>]]></text></render-mode></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Asset/Asset/AssetMeters.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Meter Readings" default-menu-index="4"><parameter name="assetId" required="true"/><transition name="createAssetMeter"><service-call name="create#mantle.product.maintenance.AssetMeter" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateAssetMeter"><service-call name="update#mantle.product.maintenance.AssetMeter" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><entity-find-one entity-name="mantle.product.asset.Asset" value-field="asset"/></actions><widgets><container-dialog id="NewMeterDialog" button-text="New Meter Reading"><form-single name="NewMeterForm" transition="createAssetMeter"><field name="assetId"><default-field><hidden/></default-field></field><field name="readingDate" from="ec.user.nowTimestamp"><default-field><date-time/></default-field></field><field name="productMeterId"><default-field title="Meter"><drop-down><entity-options key="${productMeterId}" text="${meterName} - ${description}"><entity-find entity-name="mantle.product.maintenance.ProductMeterAndUom"><econdition field-name="productId" from="asset.productId"/></entity-find></entity-options></drop-down></default-field></field><field name="meterValue"><default-field><text-line size="10"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog><form-list name="MeterListForm" list="meterList" transition="updateAssetMeter" header-dialog="true"><entity-find entity-name="mantle.product.maintenance.AssetMeter" list="meterList"><search-form-inputs default-order-by="-readingDate"/><econdition field-name="assetId"/></entity-find><field name="assetId"><header-field><hidden/></header-field><default-field><hidden/></default-field></field><field name="readingDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="productMeterId"><header-field title="Meter" show-order-by="true"><drop-down allow-empty="true"><entity-options key="${productMeterId}" text="${meterName} - ${description ?: ''}"><entity-find entity-name="mantle.product.maintenance.ProductMeterAndUom"><econdition field-name="productId" from="asset.productId"/><order-by field-name="meterName"/></entity-find></entity-options></drop-down></header-field><default-field><drop-down><entity-options key="${productMeterId}" text="${meterName} - ${description ?: ''}"><entity-find entity-name="mantle.product.maintenance.ProductMeterAndUom"><econdition field-name="productId" from="asset.productId"/><order-by field-name="meterName"/></entity-find></entity-options></drop-down></default-field></field><field name="meterValue"><header-field><range-find/></header-field><default-field><text-line size="10"/></default-field></field><field name="userId"><default-field title="Read By"><display-entity entity-name="mantle.party.PersonAndUserAccount" text="UsernameTemplate"/></default-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field><default-field title="Update"><submit/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Asset/Asset/AssetMaintenance/FindAssetMaintenance.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Asset Maintenance"><parameter name="assetId" required="true"/><transition name="createAssetMaintenance"><service-call name="mantle.product.EquipmentServices.create#AssetMaintenance" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditAssetMaintenance"/></transition><transition name="editAssetMaintenance"><default-response url="../EditAssetMaintenance"/></transition><actions><entity-find-one entity-name="mantle.product.asset.Asset" value-field="asset"/><set field="productId" from="asset.productId"/></actions><widgets><label text="Scheduled Maintenance" type="h3"/><container-dialog id="AddPlannedMaintenanceDialog" button-text="Add Planned Maintenance"><form-single name="AddPlannedMaintenance" transition="createAssetMaintenance"><field name="assetId"><default-field><hidden/></default-field></field><field name="statusId"><default-field title="Status"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="AssetMaintenance"/><set field="noCurrentSelectKey" value="AsMntCreated"/></widget-template-include></default-field></field><field name="maintenanceDate" from="ec.user.nowTimestamp"><default-field><date-time/></default-field></field><field name="productMaintenanceId"><default-field title="Planned Maintenance"><drop-down><entity-options key="${productMaintenanceId}" text="${description ?: maintTypeDescription ?: ''} - ${ec.l10n.format(intervalQuantity, null)} ${uomDescription ?: meterUomDescription ?: ''}"><entity-find entity-name="mantle.product.maintenance.ProductMaintenanceDetail"><econdition field-name="productId"/><order-by field-name="description,maintTypeDescription"/></entity-find></entity-options></drop-down></default-field></field><field name="intervalQuantity"><default-field><text-line size="10"/></default-field></field><field name="comments"><default-field><text-area rows="5" cols="80"/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><container-dialog id="AddOtherMaintenanceDialog" button-text="Add Other Maintenance"><form-single name="AddOtherMaintenance" transition="createAssetMaintenance"><field name="assetId"><default-field><hidden/></default-field></field><field name="statusId"><default-field title="Status"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="AssetMaintenance"/><set field="noCurrentSelectKey" value="AsMntCreated"/></widget-template-include></default-field></field><field name="maintenanceDate" from="ec.user.nowTimestamp"><default-field><date-time/></default-field></field><field name="maintenanceTypeEnumId"><default-field title="Maint Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="MaintenanceType"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="intervalProductMeterId"><default-field title="Interval Meter"><drop-down allow-empty="true"><entity-options key="${productMeterId}" text="${meterName}${description ? ' - ' + description : ''}"><entity-find entity-name="mantle.product.maintenance.ProductMeterAndUom"><econdition field-name="productId"/><order-by field-name="meterName"/></entity-find></entity-options></drop-down></default-field></field><field name="intervalUomId"><default-field title="or Interval UOM"><drop-down allow-empty="true"><entity-options key="${uomId}" text="${description}"><entity-find entity-name="moqui.basic.Uom"><econdition field-name="uomTypeEnumId" operator="in" value="UT_LENGTH_MEASURE,UT_TIME_FREQ_MEASURE"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="intervalQuantity"><default-field><text-line size="10"/></default-field></field><field name="comments"><default-field><text-area rows="5" cols="80"/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="ProductMaintenanceList" list="productMaintenanceList" transition="createAssetMaintenance"><entity-find entity-name="mantle.product.maintenance.ProductMaintenance" list="productMaintenanceList"><econdition field-name="productId"/><order-by field-name="maintenanceTypeEnumId"/></entity-find><row-actions><service-call name="mantle.product.EquipmentServices.get#AssetMaintenanceNeeded" in-map="[assetId:assetId, productMaintenanceId:productMaintenanceId]" out-map="context"/></row-actions><field name="assetId"><default-field><hidden/></default-field></field><field name="productId"><default-field><hidden/></default-field></field><field name="productMaintenanceId"><default-field><hidden/></default-field></field><field name="maintenanceTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="description"><default-field><display/></default-field></field><field name="intervalProductMeterId"><default-field title="Interval Meter"><display-entity entity-name="mantle.product.maintenance.ProductMeter" text="${meterName}"/></default-field></field><field name="schedIntervalQuantity" from="intervalQuantity"><default-field title="Interval"><display/></default-field></field><field name="intervalUomId"><default-field title="Interval UOM"><display-entity entity-name="moqui.basic.Uom"/></default-field></field><field name="nextMaint"><default-field title="Last/Next:Diff"><label text="${ec.l10n.format(lastMeterValue, null)}/${ec.l10n.format(nextMaintenanceInterval, null)}:${ec.l10n.format(remainingInterval, null)}" style="${remainingInterval > 0 ? 'text-success' : 'text-danger'}"/></default-field></field><field name="repeatCount"><default-field title="Repeat"><display/></default-field></field><field name="statusId"><default-field title="Status"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="AssetMaintenance"/><set field="noCurrentSelectKey" value="AsMntCreated"/></widget-template-include></default-field></field><field name="maintenanceDate" from="ec.user.nowTimestamp"><default-field><date-time/></default-field></field><field name="intervalQuantity" from="null"><default-field title="Interval Reading"><text-line size="8"/></default-field></field><field name="submitButton"><default-field title="New Maint"><submit/></default-field></field></form-list><label text="Maintenance History" type="h3"/><form-list name="MaintenanceListForm" list="maintenanceList" skip-form="true" header-dialog="true"><entity-find entity-name="mantle.product.maintenance.AssetMaintenance" list="maintenanceList"><search-form-inputs default-order-by="-maintenanceDate"/><econdition field-name="assetId"/></entity-find><field name="maintenanceDate"><header-field title="Maint Date" show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="assetMaintenanceId"><header-field title="Maint ID" show-order-by="true"><text-find hide-options="true"/></header-field><default-field><link url="editAssetMaintenance" text="${assetMaintenanceId}"/></default-field></field><field name="statusId"><header-field title="Status"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="AssetMaintenance"/><set field="allowEmpty" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="maintenanceTypeEnumId"><header-field title="Maint Type" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="MaintenanceType"/><set field="allowEmpty" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="productMaintenanceId"><default-field title="Planned Maintenance"><display-entity entity-name="mantle.product.maintenance.ProductMaintenanceDetail" text="${description ?: maintTypeDescription ?: ''} - ${ec.l10n.format(intervalQuantity, null)} ${uomDescription ?: meterUomDescription ?: ''}"/></default-field></field><field name="intervalProductMeterId"><default-field title="Interval Meter"><display-entity entity-name="mantle.product.maintenance.ProductMeterAndUom" text="${meterName} - ${description ?: ''}"/></default-field></field><field name="intervalQuantity"><header-field><range-find/></header-field><default-field><display/></default-field></field><field name="intervalUomId"><header-field title="Interval UOM"><drop-down allow-empty="true"><entity-options key="${uomId}" text="${description}"><entity-find entity-name="moqui.basic.Uom"><econdition field-name="uomTypeEnumId" operator="in" value="UT_LENGTH_MEASURE,UT_TIME_FREQ_MEASURE"/><order-by field-name="description"/></entity-find></entity-options></drop-down></header-field><default-field><display-entity entity-name="moqui.basic.Uom"/></default-field></field><field name="userId"><default-field title="Read By"><display-entity entity-name="mantle.party.PersonAndUserAccount" text="UsernameTemplate"/></default-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Asset/Asset/AssetMaintenance/EditAssetMaintenance.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Edit Maintenance" default-menu-index="1"><parameter name="assetId" required="true"/><parameter name="assetMaintenanceId" required="true"/><transition name="updateAssetMaintenance"><service-call name="update#mantle.product.maintenance.AssetMaintenance" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createContent"><service-call name="mantle.product.EquipmentServices.create#AssetMaintenanceContent" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateContent"><service-call name="mantle.product.EquipmentServices.update#AssetMaintenanceContent" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="downloadContent" read-only="true"><parameter name="contentDate"/><actions><entity-find-one entity-name="mantle.product.maintenance.AssetMaintenanceContent" value-field="curContent"/><script><![CDATA[ec.web.sendResourceResponse(curContent.contentLocation)]]></script></actions><default-response type="none"/></transition><actions><entity-find-one entity-name="mantle.product.asset.Asset" value-field="asset"/><entity-find-one entity-name="mantle.product.maintenance.AssetMaintenance" value-field="assetMaintenance"/><set field="statusId" from="assetMaintenance?.statusId"/><set field="statusChangeTransition" value="updateAssetMaintenance"/><entity-find entity-name="moqui.entity.EntityAuditLog" list="statusHistoryList"><econdition field-name="changedEntityName" value="mantle.product.maintenance.AssetMaintenance"/><econdition field-name="changedFieldName" value="statusId"/><econdition field-name="pkPrimaryValue" from="assetMaintenanceId"/><order-by field-name="changedDate"/></entity-find><entity-find entity-name="mantle.product.maintenance.AssetMaintenanceContent" list="contentList"><econdition field-name="assetMaintenanceId"/><order-by field-name="-contentDate"/></entity-find></actions><widgets><container-row><row-col lg="6"><form-single name="UpdateMaintenanceForm" map="assetMaintenance" transition="updateAssetMaintenance"><field name="assetId"><default-field><hidden/></default-field></field><field name="assetMaintenanceId"><default-field title="Maint ID"><display/></default-field></field><field name="statusId"><default-field title="Status"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="AssetMaintenance"/><set field="noCurrentSelectKey" value="AsMntCreated"/></widget-template-include></default-field></field><field name="maintenanceDate"><default-field title="Maint Date"><date-time type="date"/></default-field></field><field name="maintenanceTypeEnumId"><default-field title="Maint Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="MaintenanceType"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="productMaintenanceId"><default-field title="Planned Maint"><drop-down allow-empty="true"><entity-options key="${productMaintenanceId}" text="${description ?: maintTypeDescription ?: ''} - ${ec.l10n.format(intervalQuantity, null)} ${uomDescription ?: meterUomDescription ?: 'N/A'}"><entity-find entity-name="mantle.product.maintenance.ProductMaintenanceDetail"><econdition field-name="productId" from="asset.productId"/></entity-find></entity-options></drop-down></default-field></field><field name="intervalProductMeterId"><default-field title="Interval Meter"><drop-down allow-empty="true"><entity-options key="${productMeterId}" text="${meterName} - ${description ?: ''}"><entity-find entity-name="mantle.product.maintenance.ProductMeterAndUom"><econdition field-name="productId" from="asset.productId"/><order-by field-name="meterName"/></entity-find></entity-options></drop-down></default-field></field><field name="intervalQuantity"><default-field><text-line size="10"/></default-field></field><field name="intervalUomId"><default-field title="Interval UOM"><drop-down allow-empty="true"><entity-options key="${uomId}" text="${description}"><entity-find entity-name="moqui.basic.Uom"><econdition field-name="uomTypeEnumId" operator="in" value="UT_LENGTH_MEASURE,UT_TIME_FREQ_MEASURE"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="comments"><default-field><text-area rows="5" cols="80"/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></row-col><row-col lg="6"><section-include name="StatusChangeSection" location="component://SimpleScreens/template/basic/StatusWidgets.xml"/><section-include name="StatusHistorySection" location="component://SimpleScreens/template/basic/StatusWidgets.xml"/><container-box><box-header title="Attachments"/><box-toolbar><container-dialog id="NewContentDialog" button-text="Add Attachment"><form-single name="NewContentForm" transition="createContent"><field name="assetId"><default-field><hidden/></default-field></field><field name="assetMaintenanceId"><default-field><hidden/></default-field></field><field name="contentFile"><default-field><file/></default-field></field><field name="description"><default-field><text-area/></default-field></field><field name="submitButton"><default-field title="Add Attachment"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><section-iterate name="ContentIterateSection" list="contentList" entry="content"><actions><entity-find-one entity-name="mantle.party.PersonWithUserAccount" value-field="paua"><field-map field-name="userId" from="content.userId"/></entity-find-one></actions><widgets><container><link url="downloadContent" condition="content.contentLocation" parameter-map="[contentDate:content.contentDate]" text="Download ${content.contentLocation.substring(content.contentLocation.lastIndexOf('/')+1)}"/><container-dialog id="UpdateContentContainer" button-text="Edit Attachment"><form-single name="UpdateContentForm" transition="updateContent" map="content"><field name="assetId"><default-field><hidden/></default-field></field><field name="assetMaintenanceId"><default-field><hidden/></default-field></field><field name="contentDate"><default-field><display/></default-field></field><field name="contentFile"><default-field><file/></default-field></field><field name="description"><default-field><text-area/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></container-dialog><container><label text="By ${ec.resource.expand('UsernameTemplate','',paua+[userId:content.userId])} at ${ec.l10n.format(content.contentDate, 'yyyy-MM-dd HH:mm')}" condition="paua"/></container><label text="${content.description ?: 'No Description'}" type="p"/></container></widgets></section-iterate></box-body></container-box></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Asset/Asset/AssetMaintenance.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Maintenance" default-menu-index="5"><parameter name="assetId" required="true"/><subscreens default-item="FindAssetMaintenance"/><widgets><subscreens-active/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Asset/Asset/AssetRegistrations.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Registrations" default-menu-index="6"><parameter name="assetId" required="true"/><transition name="createAssetRegistration"><service-call name="create#mantle.product.maintenance.AssetRegistration" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateAssetRegistration"><service-call name="update#mantle.product.maintenance.AssetRegistration" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><widgets><container-dialog id="NewRegistrationDialog" button-text="New Registration"><form-single name="NewRegistrationForm" transition="createAssetRegistration"><field name="assetId"><default-field><hidden/></default-field></field><field name="fromDate"><default-field><date-time type="date"/></default-field></field><field name="thruDate"><default-field><date-time type="date"/></default-field></field><field name="registrationDate"><default-field><date-time type="date"/></default-field></field><field name="govAgencyPartyId"><default-field title="Gov Agency"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="registrationNumber"><default-field><text-line size="20"/></default-field></field><field name="licenseNumber"><default-field><text-line size="20"/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="RegistrationsForm" list="registrationList" transition="updateAssetRegistration" header-dialog="true"><entity-find entity-name="mantle.product.maintenance.AssetRegistration" list="registrationList"><search-form-inputs default-order-by="-fromDate"/><econdition field-name="assetId"/></entity-find><field name="assetId"><header-field><hidden/></header-field><default-field><hidden/></default-field></field><field name="assetRegSeqId"><default-field><hidden/></default-field></field><field name="fromDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display format="yyyy-MM-dd"/></default-field></field><field name="thruDate"><header-field show-order-by="true"><date-period/></header-field><default-field><date-time type="date"/></default-field></field><field name="registrationDate"><header-field title="Reg Date" show-order-by="true"><date-period/></header-field><default-field><date-time type="date"/></default-field></field><field name="govAgencyPartyId"><header-field title="Gov Agency"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></header-field><default-field><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="registrationNumber"><header-field title="Reg Number" show-order-by="true"><text-find hide-options="true"/></header-field><default-field><text-line size="20"/></default-field></field><field name="licenseNumber"><header-field show-order-by="true"><text-find hide-options="true"/></header-field><default-field><text-line size="20"/></default-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field><default-field title="Update"><submit/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Asset/Asset/AssetParties.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Assignments" default-menu-index="8"><parameter name="assetId" required="true"/><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition name="addParty"><service-call name="create#mantle.product.asset.AssetPartyAssignment" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updatePartyAssignment"><service-call name="update#mantle.product.asset.AssetPartyAssignment" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><widgets><container-dialog id="AddUserDialog" button-text="Assign Party"><form-single name="AddUserForm" transition="addParty"><field name="assetId"><default-field><hidden/></default-field></field><field name="partyId"><default-field title="Party"><drop-down><dynamic-options transition="searchPartyList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="roleTypeId"><default-field title="Role"><drop-down><entity-options key="${roleTypeId}" text="${description}"><entity-find entity-name="mantle.party.RoleGroupMemberAndType" cache="true"><econdition field-name="roleGroupEnumId" value="RgpPerson"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="fromDate" from="ec.user.nowTimestamp"><default-field><date-time/></default-field></field><field name="thruDate"><default-field><date-time/></default-field></field><field name="submitButton"><default-field title="Add Assignment"><submit/></default-field></field></form-single></container-dialog><form-list name="UpdateUserForm" list="rpapList" transition="updatePartyAssignment" paginate-always-show="false"><entity-find entity-name="mantle.product.maintenance.AssetAndPartyDetail" list="rpapList"><search-form-inputs default-order-by="firstName,lastName,organizationName"/><econdition field-name="assetId"/><select-field field-name="pseudoId,firstName,lastName,organizationName"/></entity-find><field name="assetId"><default-field><hidden/></default-field></field><field name="partyId"><default-field title="Party"><link url="editParty" text="PartyNameTemplate" link-type="anchor"/></default-field></field><field name="username"><header-field show-order-by="case-insensitive"/><default-field><display/></default-field></field><field name="roleTypeId"><header-field title="Role" show-order-by="true"/><default-field><display-entity entity-name="mantle.party.RoleType"/></default-field></field><field name="fromDate"><header-field show-order-by="true"/><default-field><display/></default-field></field><field name="thruDate"><header-field show-order-by="true"/><default-field><date-time/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Asset/Asset.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-index="11" menu-image="/ssstatic/images/Asset.png"><subscreens default-item="FindSummary"/><actions><if condition="assetId"><entity-find-one entity-name="mantle.product.asset.Asset" value-field="asset"/><entity-find-one entity-name="mantle.product.Product" value-field="product"><field-map field-name="productId" from="asset.productId"/></entity-find-one></if></actions><widgets><label text="AssetNameTemplate" text-map="asset" type="strong" condition="asset"/><label text=": ${product.productName}" type="strong" condition="product"/><subscreens-panel id="AssetPanel" type="tab"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Asset.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-index="11" menu-image="/ssstatic/images/Asset.png"><subscreens default-item="dashboard"/><widgets><subscreens-panel id="AssetOuter" type="popup"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Catalog/dashboard.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Dashboard" default-menu-index="1"><widgets><link url="../Product" text="Products"/><link url="../Search" text="Search Products"/><link url="../Category" text="Categories"/><link url="../Feature" text="Features"/><link url="../FeatureGroup" text="Feature Groups"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Catalog/Product/FindProduct.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="editProduct"><default-response url="../EditProduct"/></transition><transition name="createProduct"><service-call name="create#mantle.product.Product" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditProduct"/></transition><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getFeatureList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getCategoryList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><widgets><container-dialog id="NewProductDialog" button-text="New Product"><form-single name="NewProductForm" transition="createProduct"><field name="productName"><default-field><text-line/></default-field></field><field name="productTypeEnumId"><default-field title="Product Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ProductType"/></widget-template-include></default-field></field><field name="ownerPartyId"><default-field title="Owned By Org"><drop-down><option key="_NA_" text="N/A"/><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="ProductsForm" list="productList" skip-form="true" header-dialog="true" select-columns="true" saved-finds="true" show-csv-button="true" show-page-size="true"><entity-find entity-name="mantle.product.ProductFindView" list="productList" cache="false" use-clone="true"><search-form-inputs default-order-by="productName"/><date-filter from-field-name="categoryFromDate" thru-field-name="categoryThruDate" ignore="!productCategoryId"/><date-filter from-field-name="featureFromDate" thru-field-name="featureThruDate" ignore="!productFeatureId"/><select-field field-name="productId"/></entity-find><row-actions><entity-find entity-name="mantle.product.ProductIdentification" list="prodIdentList"><econdition field-name="productId"/><order-by field-name="productIdTypeEnumId"/></entity-find><entity-find entity-name="mantle.product.ProductAssoc" list="prodAssocFromList"><date-filter/><econdition field-name="toProductId" from="productId"/><order-by field-name="productAssocTypeEnumId"/></entity-find></row-actions><field name="pseudoId"><header-field title="ID" show-order-by="case-insensitive"><text-find size="20" default-operator="begins"/></header-field><default-field><link url="editProduct" text="${pseudoId}" link-type="anchor"/></default-field></field><field name="productName"><header-field title="Name" show-order-by="case-insensitive"><text-find size="25" default-operator="begins"/></header-field><default-field><link url="editProduct" text="${productName}" link-type="anchor"/></default-field></field><field name="productTypeEnumId"><header-field title="Product Type" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ProductType"/><set field="allowEmpty" value="true"/><set field="style" value=" "/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="productClassEnumId"><header-field title="Product Class" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ProductClass"/><set field="allowEmpty" value="true"/><set field="style" value=" "/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="assetTypeEnumId"><header-field title="Asset Type" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="AssetType"/><set field="allowEmpty" value="true"/><set field="style" value=" "/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="assetClassEnumId"><header-field title="Asset Class" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="AssetClass"/><set field="allowEmpty" value="true"/><set field="style" value=" "/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="ownerPartyId"><header-field title="Owned By Org"><drop-down allow-empty="true"><option key="_NA_" text="N/A"/><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></header-field><conditional-field condition="ownerPartyId == '_NA_'"><display text=" "/></conditional-field><default-field><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameTemplate"/></default-field></field><field name="prodIdents"><default-field title="Other IDs"><section-iterate name="OtherProductIdSection" list="prodIdentList" entry="prodIdent"><widgets><label text="${prodIdent.idValue} (${prodIdent.type?.description ?: ''})" type="div"/></widgets></section-iterate></default-field></field><field name="idValue"><header-field title="Other ID"><text-find default-operator="begins"/></header-field></field><field name="prodAssocFroms"><default-field title="Assoc From"><section-iterate name="AssocFromSection" list="prodAssocFromList" entry="prodAssoc"><widgets><container><link url="editProduct" link-type="anchor" parameter-map="[productId:prodAssoc.productId]" text="${ec.resource.expand('ProductNameTemplate', '', prodAssoc.product)} (${prodAssoc.type?.description?:''})"/></container></widgets></section-iterate></default-field></field><field name="assocFromProductId"><header-field title="Assoc From (Virtual, BOM)"><drop-down allow-multiple="true"><dynamic-options transition="getProductList" server-search="true" min-length="0"/></drop-down></header-field></field><field name="productFeatureId"><header-field title="Feature"><drop-down allow-multiple="true"><dynamic-options transition="getFeatureList" server-search="true" min-length="0"/></drop-down></header-field></field><field name="productCategoryId"><header-field title="Category"><drop-down allow-multiple="true"><dynamic-options transition="getCategoryList" server-search="true" min-length="0"/></drop-down></header-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field></field><form-list-column><field-ref name="pseudoId"/><field-ref name="productName"/></form-list-column><form-list-column><field-ref name="productTypeEnumId"/><field-ref name="productClassEnumId"/></form-list-column><form-list-column><field-ref name="assetTypeEnumId"/><field-ref name="assetClassEnumId"/></form-list-column><form-list-column><field-ref name="ownerPartyId"/><field-ref name="prodIdents"/></form-list-column><form-list-column><field-ref name="prodAssocFroms"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Catalog/Product/EditProduct.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Product" default-menu-index="1"><parameter name="productId" required="true"/><transition name="findAssetSummary"><default-response url="//${appRoot}/Asset/FindSummary"/></transition><transition name="editFacility"><default-response url="//${appRoot}/Facility/EditFacility"/></transition><transition name="updateProduct"><service-call name="update#mantle.product.Product" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="cloneProduct"><service-call name="mantle.product.ProductServices.clone#Product" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createProductIdentification"><service-call name="create#mantle.product.ProductIdentification" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateProductIdentification"><service-call name="update#mantle.product.ProductIdentification" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteProductIdentification"><parameter name="productIdTypeEnumId"/><service-call name="delete#mantle.product.ProductIdentification" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createProductOtherIdentification"><parameter name="idValue" required="true"/><service-call name="create#mantle.product.ProductOtherIdentification" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateProductOtherIdentification"><service-call name="update#mantle.product.ProductOtherIdentification" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteProductOtherIdentification"><parameter name="productIdTypeEnumId"/><service-call name="delete#mantle.product.ProductOtherIdentification" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="generateUrlSlugOtherIdent"><service-call name="mantle.product.StoreServices.generate#UrlSlugFromProductName" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createProductFeature"><service-call name="mantle.product.ProductServices.create#ProductFeature" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="applyProductFeatures"><service-call name="mantle.product.ProductServices.apply#ProductFeatures" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateProductFeatureAppl"><service-call name="update#mantle.product.feature.ProductFeatureAppl" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="editFeature"><default-response url="../../Feature/EditFeature"/></transition><transition name="createProductDimension"><service-call name="create#mantle.product.ProductDimension" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateProductDimension"><service-call name="update#mantle.product.ProductDimension" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteProductDimension"><service-call name="delete#mantle.product.ProductDimension" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createProductUomDimension"><service-call name="create#mantle.product.ProductUomDimension" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateProductUomDimension"><service-call name="update#mantle.product.ProductUomDimension" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteProductUomDimension"><service-call name="delete#mantle.product.ProductUomDimension" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createProductLocation"><service-call name="create#mantle.facility.ProductFacilityLocation" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateProductLocation"><service-call name="update#mantle.facility.ProductFacilityLocation" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteProductLocation"><service-call name="delete#mantle.facility.ProductFacilityLocation" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createProductMeter"><service-call name="create#mantle.product.maintenance.ProductMeter" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateProductMeter"><service-call name="update#mantle.product.maintenance.ProductMeter" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteProductMeter"><service-call name="delete#mantle.product.maintenance.ProductMeter" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createProductMaintenance"><service-call name="create#mantle.product.maintenance.ProductMaintenance" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateProductMaintenance"><service-call name="update#mantle.product.maintenance.ProductMaintenance" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteProductMaintenance"><service-call name="delete#mantle.product.maintenance.ProductMaintenance" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getFeatureList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getFacilityList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><transition-include name="getLocationList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><actions><entity-find-one entity-name="mantle.product.Product" value-field="product" cache="false"/><if condition="product == null"><return error="true" message="Product not found with ID ${productId}"/></if><entity-find entity-name="moqui.basic.Enumeration" limit="200" cache="true" list="productIdentificationTypeList"><econdition field-name="enumTypeId" value="ProductIdentificationType"/><econdition field-name="enumId" operator="not-in" from="productIdTypeEnumIds" ignore-if-empty="true"/><order-by field-name="description"/></entity-find><entity-find entity-name="mantle.product.ProductIdentification" list="productIdentificationList"><econdition field-name="productId"/></entity-find><set field="productIdTypeEnumIds" from="productIdentificationList*.productIdTypeEnumId"/><entity-find entity-name="mantle.product.store.ProductStore" limit="200" cache="true" list="productStoreList"><order-by field-name="storeName"/></entity-find><entity-find entity-name="mantle.marketing.segment.MarketSegment" limit="200" cache="true" list="marketSegmentList"><order-by field-name="description"/></entity-find><entity-find entity-name="mantle.product.ProductOtherIdentification" list="productOtherIdentificationList"><econdition field-name="productId"/></entity-find><set field="productIdOtherTypeEnumIds" from="productOtherIdentificationList*.productIdTypeEnumId"/><set field="isEquipment" from="product.assetTypeEnumId in ['AstTpEquipment', 'AstTpRental']"/><set field="isInventory" from="product.assetTypeEnumId == 'AstTpInventory'"/></actions><widgets><container-row><row-col lg="6"><container-dialog id="CloneProductDialog" button-text="Clone Product"><form-single name="CloneProductForm" transition="cloneProduct"><field name="productId"><default-field><hidden/></default-field></field><field name="baseProductId" from="productId"><default-field><hidden/></default-field></field><field name="pseudoId"><default-field title="New ID"><text-line size="10"/></default-field></field><field name="productName"><default-field title="New Name"><text-line size="50"/></default-field></field><field name="copyCategories"><default-field><radio no-current-selected-key="true"><option key="true" text="Yes"/><option key="false" text="No"/></radio></default-field></field><field name="copyFeatures"><default-field><radio no-current-selected-key="true"><option key="true" text="Yes"/><option key="false" text="No"/></radio></default-field></field><field name="copyDimensions"><default-field><radio no-current-selected-key="true"><option key="true" text="Yes"/><option key="false" text="No"/></radio></default-field></field><field name="copyAssocFrom"><default-field><radio no-current-selected-key="true"><option key="true" text="Yes"/><option key="false" text="No"/></radio></default-field></field><field name="copyAssocTo"><default-field><radio no-current-selected-key="true"><option key="true" text="Yes"/><option key="false" text="No"/></radio></default-field></field><field name="copyPrices"><default-field><radio no-current-selected-key="true"><option key="true" text="Yes"/><option key="false" text="No"/></radio></default-field></field><field name="copyContent"><default-field><radio no-current-selected-key="true"><option key="true" text="Yes"/><option key="false" text="No"/></radio></default-field></field><field name="copyIdentifications"><default-field><radio no-current-selected-key="true"><option key="true" text="Yes"/><option key="false" text="No"/></radio></default-field></field><field name="submitButton"><default-field title="Clone"><submit/></default-field></field></form-single></container-dialog><link url="findAssetSummary" text="Find Assets" parameter-map="[productId:productId]"/><form-single name="EditProductForm" map="product" transition="updateProduct"><field name="productId"><default-field><hidden/></default-field></field><field name="pseudoId"><default-field title="ID"><text-line size="40"/></default-field></field><field name="productName"><default-field title="Name"><text-line size="80"/></default-field></field><field name="description"><default-field><text-area cols="80" rows="8"/></default-field></field><field name="comments"><default-field title="Internal Comments"><text-area cols="80" rows="4"/></default-field></field><field name="productTypeEnumId"><default-field title="Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ProductType"/></widget-template-include></default-field></field><field name="productClassEnumId"><default-field title="Class"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ProductClass"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="assetTypeEnumId"><conditional-field title="Asset Type" condition="productTypeEnumId in ['PtAsset', 'PtDigitalAsset', 'PtAssetUse', 'PtPickAssembly']"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="AssetType"/><set field="allowEmpty" value="true"/></widget-template-include></conditional-field></field><field name="assetClassEnumId"><conditional-field title="Asset Class" condition="productTypeEnumId in ['PtAsset', 'PtDigitalAsset', 'PtAssetUse', 'PtPickAssembly']"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="AssetClass"/><set field="allowEmpty" value="true"/></widget-template-include></conditional-field></field><field name="ownerPartyId"><default-field title="Owned By Org"><drop-down allow-empty="true"><option key="_NA_" text="N/A"/><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></default-field></field><field name="amountFixed"><default-field title="Amount Included"><text-line size="10" format="0.######"/></default-field></field><field name="amountUomId"><default-field title="UOM"><drop-down allow-empty="true"><entity-options key="${uomId}" text="${description} [${abbreviation}]"><entity-find entity-name="moqui.basic.Uom"><econdition field-name="uomId" operator="in" value="OTH_ct,OTH_ea"/><order-by field-name="description"/></entity-find></entity-options><entity-options key="${uomId}" text="${typeDescription} - ${description} [${abbreviation}]"><entity-find entity-name="moqui.basic.UomAndType"><econdition field-name="uomId" operator="not-in" value="OTH_ct,OTH_ea"/><order-by field-name="typeDescription,description"/></entity-find></entity-options></drop-down></default-field></field><field name="salesIntroductionDate"><default-field title="Sales Intro"><date-time/></default-field></field><field name="salesDiscontinuationDate"><default-field title="Sales Discontinue"><date-time/></default-field></field><field name="signatureRequiredEnumId"><default-field title="Sign Req."><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="SignatureRequired"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="shippingInsuranceReqd"><default-field title="Ship Insure Reqd"><radio no-current-selected-key="N"><option key="Y"/><option key="N"/></radio></default-field></field><field name="originGeoId"><default-field title="Country of Origin"><drop-down allow-empty="true"><entity-options key="${geoId}" text="${geoCodeAlpha3} - ${geoName}"><entity-find entity-name="moqui.basic.Geo" list="geoList"><econdition field-name="geoTypeEnumId" value="GEOT_COUNTRY"/><order-by field-name="geoCodeAlpha2"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field-layout><fields-not-referenced/><field-row><field-ref name="productTypeEnumId"/><field-ref name="productClassEnumId"/></field-row><field-row><field-ref name="assetTypeEnumId"/><field-ref name="assetClassEnumId"/></field-row><field-ref name="ownerPartyId"/><field-row><field-ref name="amountFixed"/><field-ref name="amountUomId"/></field-row><field-row><field-ref name="salesIntroductionDate"/><field-ref name="salesDiscontinuationDate"/></field-row><field-row><field-ref name="signatureRequiredEnumId"/><field-ref name="shippingInsuranceReqd"/></field-row><field-row><field-ref name="originGeoId"/></field-row><field-ref name="submitButton"/></field-layout></form-single></row-col><row-col lg="6"><container-box><box-header title="Identification"/><box-toolbar><container-dialog id="AddIdentificationDialog" button-text="Add Identification"><form-single name="AddIdentificationForm" transition="createProductIdentification"><field name="productId"><default-field><hidden/></default-field></field><field name="productIdTypeEnumId"><default-field title="ID Type"><drop-down><list-options list="productIdentificationTypeList.findAll{!productIdTypeEnumIds.contains(it.enumId)}" key="${enumId}" text="${description}"/></drop-down></default-field></field><field name="idValue"><default-field><text-line size="20"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="IdentificationsForm" list="productIdentificationList" transition="updateProductIdentification"><field name="productId"><default-field><hidden/></default-field></field><field name="productIdTypeEnumId"><default-field title="ID Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="idValue"><default-field><text-line size="20"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field name="removeButton"><default-field title=""><link url="deleteProductIdentification" icon="fa fa-trash" confirmation="Delete this ID?"/></default-field></field></form-list></box-body></container-box><container-box><box-header title="Other Identification"/><box-toolbar><form-single name="GenerateOtherIdentification" transition="generateUrlSlugOtherIdent"><field name="productId"><default-field><hidden/></default-field></field><field name="productName" from="product?.productName"><default-field><hidden/></default-field></field><field name="submitButton"><conditional-field title="Generate Url Slug" tooltip="Generate Url Slug from the Product's Name" condition="productOtherIdentificationList?.findAll{it.productIdTypeEnumId == 'PidtUrlSlug' }?.size() == 0"><submit/></conditional-field></field></form-single><container-dialog id="AddOtherIdentificationDialog" button-text="Add Other Identification"><form-single name="AddOtherIdentificationForm" transition="createProductOtherIdentification"><field name="productId"><default-field><hidden/></default-field></field><field name="productIdTypeEnumId"><default-field title="ID Type"><drop-down><list-options list="productIdentificationTypeList" key="${enumId}" text="${description}"/></drop-down></default-field></field><field name="productStoreId"><default-field><drop-down allow-empty="true"><list-options list="productStoreList" key="${productStoreId}" text="${storeName}"/></drop-down></default-field></field><field name="marketSegmentId"><default-field><drop-down allow-empty="true"><list-options list="marketSegmentList" key="${marketSegmentId}" text="${description}"/></drop-down></default-field></field><field name="idValue"><default-field><text-line size="20"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="OtherIdentificationsForm" list="productOtherIdentificationList" transition="updateProductOtherIdentification"><field name="productId"><default-field><hidden/></default-field></field><field name="productIdTypeEnumId"><default-field title="ID Type"><drop-down><list-options list="productIdentificationTypeList" key="${enumId}" text="${description}"/></drop-down></default-field></field><field name="productStoreId"><default-field><drop-down allow-empty="true"><list-options list="productStoreList" key="${productStoreId}" text="${storeName}"/></drop-down></default-field></field><field name="marketSegmentId"><default-field><drop-down allow-empty="true"><list-options list="marketSegmentList" key="${marketSegmentId}" text="${description}"/></drop-down></default-field></field><field name="idValue"><default-field><text-line size="20"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field name="removeButton"><default-field title=""><link url="deleteProductOtherIdentification" icon="fa fa-trash" btn-type="danger" confirmation="Delete this ID?"/></default-field></field><columns><column><field-ref name="productIdTypeEnumId"/><field-ref name="productStoreId"/></column><column><field-ref name="idValue"/><field-ref name="marketSegmentId"/></column><column><field-ref name="submitButton"/><field-ref name="removeButton"/></column></columns></form-list></box-body></container-box><container-box><box-header title="Features"/><box-toolbar><container-dialog id="NewFeatureDialog" button-text="Apply New Feature"><form-single name="NewFeatureForm" transition="createProductFeature"><field name="productId"><default-field><hidden/></default-field></field><field name="productFeatureTypeEnumId"><default-field title="Feature Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ProductFeatureType"/></widget-template-include></default-field></field><field name="abbrev"><default-field title="Abbreviation"><text-line size="10"/></default-field></field><field name="description"><default-field><text-line/></default-field></field><field name="applTypeEnumId"><default-field title="Appl. Type"><drop-down no-current-selected-key="PfatStandard"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="ProductFeatureApplType"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="sequenceNum"><default-field title="Seq #"><text-line size="4"/></default-field></field><field name="amount"><default-field><text-line size="10" format="#,##0.######"/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><container-dialog id="AddFeatureDialog" button-text="Apply Feature"><form-single name="AddFeatureForm" transition="applyProductFeatures"><field name="productId"><default-field><hidden/></default-field></field><field name="productFeatureTypeEnumId"><default-field title="Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ProductFeatureType"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="productFeatureIdList"><default-field title="Feature"><drop-down allow-multiple="true"><dynamic-options transition="getFeatureList" server-search="true" min-length="0"><depends-on field="productFeatureTypeEnumId"/></dynamic-options></drop-down></default-field></field><field name="applTypeEnumId"><default-field title="Appl. Type"><drop-down no-current-selected-key="PfatStandard"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="ProductFeatureApplType"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="sequenceNum"><default-field title="Seq #"><text-line size="4"/></default-field></field><field name="amount"><default-field><text-line size="10" format="#,##0.######"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body-nopad><form-list name="FeaturesForm" list="pfaaList" transition="updateProductFeatureAppl" multi="true"><entity-find entity-name="mantle.product.feature.ProductFeatureAndAppl" list="pfaaList"><date-filter/><econdition field-name="productId"/><select-field field-name="productId,description,abbrev"/><order-by field-name="typeDescription,sequenceNum,description"/></entity-find><hidden-parameters><parameter name="productId"/></hidden-parameters><field name="fromDate"><default-field><hidden/></default-field></field><field name="typeDescription"><default-field title="Type"><display/></default-field></field><field name="sequenceNum"><default-field title="Seq #"><text-line size="4"/></default-field></field><field name="productFeatureId"><default-field title="Feature"><display text=" "/><link url="editFeature" text="ProductFeatureNameTemplate" link-type="anchor"/></default-field></field><field name="applTypeEnumId"><default-field title="Appl. Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="amount"><default-field><text-line size="10" format="#,##0.######"/></default-field></field><field name="removeButton"><default-field title=""><link url="updateProductFeatureAppl" icon="fa fa-trash" btn-type="danger" confirmation="Remove this feature?" parameter-map="[productId:productId, productFeatureId:productFeatureId, fromDate:fromDate, thruDate:ec.user.nowTimestamp]"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-list></box-body-nopad></container-box><container-box><box-header title="Dimensions"/><box-toolbar><container-dialog id="AddDimensionDialog" button-text="Add Dimension"><form-single name="AddDimensionForm" transition="createProductDimension"><field name="productId"><default-field><hidden/></default-field></field><field name="dimensionTypeId"><default-field title="Type"><drop-down><entity-options key="${dimensionTypeId}" text="${description}"><entity-find entity-name="mantle.product.ProductDimensionType"><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="value"><default-field><text-line size="10" format="#,##0.######"/></default-field></field><field name="valueUomId"><default-field title="Unit"><drop-down allow-empty="true"><entity-options key="${uomId}" text="${typeDescription}: ${description}"><entity-find entity-name="moqui.basic.UomAndType"><order-by field-name="typeDescription,description"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body-nopad><form-list name="DimensionsForm" list="dimensionList" transition="updateProductDimension"><entity-find entity-name="mantle.product.ProductDimensionAndType" list="dimensionList"><econdition field-name="productId"/><order-by field-name="description"/></entity-find><field name="productId"><default-field><hidden/></default-field></field><field name="dimensionTypeId"><default-field><hidden/></default-field></field><field name="description"><default-field title="Type"><display/></default-field></field><field name="value"><default-field><text-line size="10" format="#,##0.######"/></default-field></field><field name="valueUomId"><default-field title="Unit"><drop-down allow-empty="true"><entity-options key="${uomId}" text="${typeDescription}: ${description}"><entity-find entity-name="moqui.basic.UomAndType"><order-by field-name="typeDescription,description"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field name="deleteButton"><default-field title=""><link url="deleteProductDimension" confirmation="Remove dimension?" icon="fa fa-trash" btn-type="danger" parameter-map="[productId:productId, dimensionTypeId:dimensionTypeId]"/></default-field></field></form-list></box-body-nopad></container-box><container-box><box-header title="UOM Dimensions"/><box-toolbar><container-dialog id="AddUomDimensionDialog" button-text="Add UOM Dimension"><form-single name="AddUomDimensionForm" transition="createProductUomDimension"><field name="productId"><default-field><hidden/></default-field></field><field name="uomDimensionTypeId"><default-field title="Type"><drop-down><entity-options key="${uomDimensionTypeId}" text="${description}"><entity-find entity-name="moqui.basic.UomDimensionType"><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="value"><default-field><text-line size="10" format="#,##0.######"/></default-field></field><field name="uomId"><default-field title="Unit"><drop-down allow-empty="true"><entity-options key="${uomId}" text="${typeDescription}: ${description}"><entity-find entity-name="moqui.basic.UomAndType"><order-by field-name="typeDescription,description"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body-nopad><form-list name="UomDimensionsForm" list="uomDimensionList" transition="updateProductUomDimension"><entity-find entity-name="mantle.product.ProductUomDimensionAndType" list="uomDimensionList"><econdition field-name="productId"/><order-by field-name="description"/></entity-find><field name="productId"><default-field><hidden/></default-field></field><field name="productUomDimensionId"><default-field><hidden/></default-field></field><field name="description"><default-field title="Type"><display/></default-field></field><field name="value"><default-field><text-line size="10" format="#,##0.######"/></default-field></field><field name="uomId"><default-field title="Unit"><drop-down allow-empty="true"><entity-options key="${uomId}" text="${typeDescription}: ${description}"><entity-find entity-name="moqui.basic.UomAndType"><order-by field-name="typeDescription,description"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field name="deleteButton"><default-field title=""><link url="deleteProductUomDimension" confirmation="Remove dimension?" icon="fa fa-trash" btn-type="danger" parameter-map="[productId:productId, productUomDimensionId:productUomDimensionId]"/></default-field></field></form-list></box-body-nopad></container-box><section name="FacilityLocationSection" condition="isInventory"><widgets><container-box><box-header title="Facility Locations"/><box-toolbar><container-dialog id="AddLocationDialog" button-text="Add Location"><form-single name="CreateProductLocation" transition="createProductLocation"><field name="productId"><default-field><hidden/></default-field></field><field name="facilityId"><default-field title="Facility"><drop-down><dynamic-options transition="getFacilityList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="locationSeqId"><default-field title="Location"><drop-down><dynamic-options transition="getLocationList" server-search="true" min-length="0"><depends-on field="facilityId"/></dynamic-options></drop-down></default-field></field><field name="minimumStock"><default-field><text-line size="4"/></default-field></field><field name="moveQuantity"><default-field><text-line size="4"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body-nopad><form-list name="ProductLocationList" list="productLocationList" transition="updateProductLocation"><entity-find entity-name="mantle.facility.ProductFacilityLocation" list="productLocationList"><econdition field-name="productId"/><order-by field-name="facilityId,locationSeqId"/></entity-find><row-actions><entity-find-one entity-name="mantle.facility.FacilityLocation" value-field="facLoc" cache="true"><field-map field-name="facilityId"/><field-map field-name="locationSeqId"/></entity-find-one></row-actions><field name="productId"><default-field><hidden/></default-field></field><field name="facilityId"><default-field><hidden/></default-field></field><field name="locationSeqId"><default-field><hidden/></default-field></field><field name="facility" from="facilityId"><default-field title="Facility"><link url="editFacility" text="FacilityNameTemplate" entity-name="mantle.facility.Facility" link-type="anchor"/></default-field></field><field name="location"><default-field><label text="FacilityLocationNameTemplate" text-map="facLoc"/></default-field></field><field name="minimumStock"><default-field title="Min Stock"><text-line size="4"/></default-field></field><field name="moveQuantity"><default-field title="Move Qty"><text-line size="4"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field name="deleteButton"><default-field title=""><link url="deleteProductLocation" confirmation="Remove location?" icon="fa fa-trash" btn-type="danger" parameter-map="[productId:productId, facilityId:facilityId, locationSeqId:locationSeqId]"/></default-field></field></form-list></box-body-nopad></container-box></widgets></section><section name="MeterSection" condition="isEquipment"><widgets><container-box><box-header title="Meters"/><box-toolbar><container-dialog id="AddMeterDialog" button-text="Add Meter"><form-single name="CreateProductMeter" transition="createProductMeter"><field name="productId"><default-field><hidden/></default-field></field><field name="productMeterTypeId"><default-field title="Type"><drop-down><entity-options key="${productMeterTypeId}" text="${description}"><entity-find entity-name="mantle.product.maintenance.ProductMeterType"><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="meterUomId"><default-field title="UOM"><drop-down allow-empty="true"><entity-options key="${uomId}" text="${description}"><entity-find entity-name="moqui.basic.Uom"><econdition field-name="uomTypeEnumId" operator="in" value="UT_LENGTH_MEASURE,UT_TIME_FREQ_MEASURE"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="meterName"><default-field><text-line size="40"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body-nopad><form-list name="ProductMeterList" list="productMeterList" transition="updateProductMeter"><entity-find entity-name="mantle.product.maintenance.ProductMeter" list="productMeterList"><econdition field-name="productId"/><order-by field-name="productMeterTypeId"/></entity-find><field name="productId"><default-field><hidden/></default-field></field><field name="productMeterId"><default-field><hidden/></default-field></field><field name="productMeterTypeId"><default-field title="Type"><drop-down><entity-options key="${productMeterTypeId}" text="${description}"><entity-find entity-name="mantle.product.maintenance.ProductMeterType"><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="meterUomId"><default-field title="UOM"><drop-down allow-empty="true"><entity-options key="${uomId}" text="${description}"><entity-find entity-name="moqui.basic.Uom"><econdition field-name="uomTypeEnumId" operator="in" value="UT_LENGTH_MEASURE,UT_TIME_FREQ_MEASURE"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="meterName"><default-field><text-line size="20"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field name="deleteButton"><default-field title=""><link url="deleteProductMeter" confirmation="Remove meter?" icon="fa fa-trash" btn-type="danger" parameter-map="[productMeterId:productMeterId]"/></default-field></field></form-list></box-body-nopad></container-box></widgets></section></row-col></container-row><section name="MaintenanceSection" condition="isEquipment"><widgets><container-box><box-header title="Scheduled Maintenance"/><box-toolbar><container-dialog id="AddMaintenanceDialog" button-text="Add Maintenance"><form-single name="CreateProductMaintenance" transition="createProductMaintenance"><field name="productId"><default-field><hidden/></default-field></field><field name="productMaintenanceId"><default-field><hidden/></default-field></field><field name="maintenanceTypeEnumId"><default-field title="Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="MaintenanceType"/></widget-template-include></default-field></field><field name="description"><default-field><text-line size="60"/></default-field></field><field name="intervalQuantity"><default-field><text-line size="8"/></default-field></field><field name="intervalProductMeterId"><default-field title="Interval Meter"><drop-down allow-empty="true"><entity-options key="${productMeterId}" text="${meterName}"><entity-find entity-name="mantle.product.maintenance.ProductMeter"><econdition field-name="productId"/><order-by field-name="meterName"/></entity-find></entity-options></drop-down></default-field></field><field name="intervalUomId"><default-field title="OR Interval UOM"><drop-down allow-empty="true"><entity-options key="${uomId}" text="${description}"><entity-find entity-name="moqui.basic.Uom"><econdition field-name="uomTypeEnumId" operator="in" value="UT_LENGTH_MEASURE,UT_TIME_FREQ_MEASURE"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="repeatCount"><default-field><text-line size="4"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body-nopad><form-list name="ProductMaintenanceList" list="productMaintenanceList" transition="updateProductMaintenance"><entity-find entity-name="mantle.product.maintenance.ProductMaintenance" list="productMaintenanceList"><econdition field-name="productId"/><order-by field-name="maintenanceTypeEnumId"/></entity-find><field name="productId"><default-field><hidden/></default-field></field><field name="productMaintenanceId"><default-field><hidden/></default-field></field><field name="maintenanceTypeEnumId"><default-field title="Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="MaintenanceType"/><set field="style" value=" "/></widget-template-include></default-field></field><field name="description"><default-field><text-line size="40"/></default-field></field><field name="intervalQuantity"><default-field><text-line size="8"/></default-field></field><field name="intervalProductMeterId"><default-field title="Interval Meter"><drop-down allow-empty="true"><entity-options key="${productMeterId}" text="${meterName}"><entity-find entity-name="mantle.product.maintenance.ProductMeter"><econdition field-name="productId"/><order-by field-name="meterName"/></entity-find></entity-options></drop-down></default-field></field><field name="intervalUomId"><default-field title="OR Interval UOM"><drop-down allow-empty="true"><entity-options key="${uomId}" text="${description}"><entity-find entity-name="moqui.basic.Uom"><econdition field-name="uomTypeEnumId" operator="in" value="UT_LENGTH_MEASURE,UT_TIME_FREQ_MEASURE"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="repeatCount"><default-field><text-line size="4"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field name="deleteButton"><default-field title=""><link url="deleteProductMaintenance" confirmation="Remove scheduled maintenance?" icon="fa fa-trash" btn-type="danger" parameter-map="[productMaintenanceId:productMaintenanceId]"/></default-field></field></form-list></box-body-nopad></container-box></widgets></section></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Catalog/Product/Content/ContentCompare.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" standalone="true"><parameter name="productContentId" required="true"/><parameter name="versionNameLhs"/><parameter name="versionNameRhs"/><actions><set field="versionNameRhs" from="versionNameRhs ?: versionNameLhs"/><entity-find-one entity-name="mantle.product.ProductContent" value-field="productContent"/><set field="resourceRef" from="ec.resource.getLocationReference(productContent?.contentLocation)"/><set field="pageTextLhs" from="resourceRef?.getText(versionNameLhs) ?: ''"/><set field="pageTextRhs" from="resourceRef?.getText(versionNameRhs) ?: ''"/></actions><widgets><container-box><box-header title="Compare versions ${versionNameLhs} and ${versionNameRhs}"/><box-body><render-mode><text type="html,vuet,qvt"><![CDATA[<pre id="result" class="compare"></pre><textarea id="pageTextLhs" style="display: none;">${pageTextLhs?html}</textarea><textarea id="pageTextRhs" style="display: none;">${pageTextRhs?html}</textarea><script>
    var a = document.getElementById('pageTextLhs');
    var b = document.getElementById('pageTextRhs');
    var result = document.getElementById('result');
    // diffChars, diffWords, diffLines
	var diff = JsDiff['diffChars'](a.textContent, b.textContent);
	var fragment = document.createDocumentFragment();
	for (var i=0; i < diff.length; i++) {
		if (diff[i].added && diff[i + 1] && diff[i + 1].removed) {
			var swap = diff[i];
			diff[i] = diff[i + 1];
			diff[i + 1] = swap;
		}
		var node;
		if (diff[i].removed) {
			node = document.createElement('del');
			node.appendChild(document.createTextNode(diff[i].value));
		} else if (diff[i].added) {
			node = document.createElement('ins');
			node.appendChild(document.createTextNode(diff[i].value));
		} else {
			node = document.createTextNode(diff[i].value);
		}
		fragment.appendChild(node);
	}

	result.textContent = '';
	result.appendChild(fragment);
                </script>]]></text></render-mode></box-body></container-box></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Catalog/Product/Content/ContentDetail.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Detail"><parameter name="productId" required="true"/><parameter name="productContentId" required="true"/><transition name="updateContent"><service-call name="mantle.product.ProductServices.update#ProductContent" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="downloadContent" read-only="true"><parameter name="productContentId"/><actions><entity-find-one entity-name="mantle.product.ProductContent" value-field="productContent"/><script><![CDATA[ec.web.sendResourceResponse(productContent.contentLocation)]]></script></actions><default-response type="none"/></transition><actions><entity-find-one entity-name="mantle.product.ProductContent" value-field="productContent"/><set field="resourceRef" from="ec.resource.getLocationReference(productContent?.contentLocation)"/><if condition="resourceRef != null"><set field="supportsVersion" from="resourceRef.supportsVersion()"/><set field="isText" from="!resourceRef.isBinary()"/><if condition="isText"><set field="contentText" from="resourceRef.getText()"/></if></if><set field="localeStringList" from="[]"/><iterate list="Locale.getAvailableLocales()" entry="lcl"><script><![CDATA[localeStringList.add([locale:lcl.toString(), name:lcl.getDisplayName(ec.user.locale)])]]></script></iterate><order-map-list list="localeStringList"><order-by field-name="name"/></order-map-list></actions><widgets><container-row><row-col lg="9"><container-box><box-header title="Edit Content"/><box-toolbar><link url="downloadContent" text="Download" condition="productContent.contentLocation" tooltip="${productContent.contentLocation}"/></box-toolbar><box-body><form-single name="UpdateContentForm" transition="updateContent" map="productContent"><field name="productId"><default-field><hidden/></default-field></field><field name="productContentId"><default-field title="ID"><display/></default-field></field><field name="productContentTypeEnumId"><default-field title="Content Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ProductContentType"/></widget-template-include></default-field></field><field name="sequenceNum"><default-field><text-line size="4"/></default-field></field><field name="contentLocation"><default-field title="Location" tooltip="Location change will not move current file. Uploading a file will create a new location."><text-line size="60"/></default-field></field><field name="contentFile"><default-field title="Upload File"><file/></default-field></field><field name="description"><default-field><text-line size="60"/></default-field></field><field name="locale"><default-field><drop-down allow-empty="true"><list-options list="localeStringList" key="${locale}" text="${locale}: ${name}"/></drop-down></default-field></field><field name="productFeatureId"><default-field title="Feature"><drop-down allow-empty="true"><entity-options key="${productFeatureId}" text="ProductFeatureAndTypeTemplate"><entity-find entity-name="mantle.product.feature.ProductFeatureAndAppl" list="pfaaList"><date-filter/><econdition field-name="productId"/><select-field field-name="productFeatureId,typeDescription,description,abbrev"/><order-by field-name="typeDescription,sequenceNum,description"/></entity-find></entity-options></drop-down></default-field></field><field name="fromDate"><default-field><date-time/></default-field></field><field name="thruDate"><default-field><date-time/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></box-body></container-box><section name="EditTextSection" condition="isText"><widgets><container-box><box-header title="Edit HTML"/><box-body><form-single name="UpdateTextForm" transition="updateContent" map="productContent"><field name="productId"><default-field><hidden/></default-field></field><field name="productContentId"><default-field><hidden/></default-field></field><field name="contentText"><default-field title=""><text-area cols="110" rows="15" editor-type="html"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></box-body></container-box></widgets></section></row-col><row-col lg="3"><container-box><box-header title="History"/><box-body><section name="HistorySection" condition="supportsVersion"><actions><set field="versionList" from="resourceRef.getVersionHistory()"/><set field="currentVersionName" from="resourceRef.getCurrentVersion()?.getVersionName()"/></actions><widgets><section-iterate name="HistListSection" list="versionList" entry="version"><actions><entity-find-one entity-name="mantle.party.PersonAndUserAccount" value-field="paua"><field-map field-name="userId" from="version.userId"/></entity-find-one><if condition="version_has_next"><set field="nextVersion" from="versionList[version_index+1]"/></if></actions><widgets><dynamic-dialog id="ShowVersionDialog" button-text="Version ${version.versionName}" width="900" transition="../ContentCompare" parameter-map="[versionNameLhs:version.versionName]"/><section name="DiffPrevSection" condition="nextVersion && nextVersion.versionName"><widgets><dynamic-dialog id="DiffPrevDialog" button-text="Diff Prev" width="900" transition="../ContentCompare" parameter-map="[versionNameLhs:nextVersion.versionName, versionNameRhs:version.versionName]"/></widgets></section><section name="DiffCurSection" condition="currentVersionName && version.versionName != currentVersionName"><widgets><dynamic-dialog id="DiffCurDialog" button-text="Diff Cur" width="900" transition="../ContentCompare" parameter-map="[versionNameLhs:version.versionName, versionNameRhs:currentVersionName]"/></widgets></section><label text="By ${paua.firstName?:''} ${paua.lastName?:''} (${paua.username?:'N/A'})" type="div" condition="paua"/><label text="At ${ec.l10n.format(version.versionDate, 'yyyy-MM-dd HH:mm')}" type="div"/></widgets></section-iterate></widgets><fail-widgets><label text="History not supported for this type of resource" type="strong"/></fail-widgets></section></box-body></container-box></row-col></container-row><render-mode><text type="html,vuet,qvt"><![CDATA[<script src="https://cdnjs.cloudflare.com/ajax/libs/jsdiff/3.2.0/diff.min.js" type="text/javascript"></script>]]></text></render-mode></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Catalog/Product/Content/ContentList.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="List"><parameter name="productId" required="true"/><transition name="createContent"><service-call name="mantle.product.ProductServices.create#ProductContent" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createContentWithLocation"><service-call name="create#mantle.product.ProductContent" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="downloadContent" read-only="true"><parameter name="productContentId"/><actions><entity-find-one entity-name="mantle.product.ProductContent" value-field="productContent"/><script><![CDATA[ec.web.sendResourceResponse(productContent.contentLocation)]]></script></actions><default-response type="none"/></transition><actions><entity-find entity-name="mantle.product.ProductContent" list="contentList"><search-form-inputs default-order-by="productContentTypeEnumId,sequenceNum,-fromDate"/><econdition field-name="productId"/></entity-find><set field="localeStringList" from="[]"/><iterate list="Locale.getAvailableLocales()" entry="lcl"><script><![CDATA[localeStringList.add([locale:lcl.toString(), name:lcl.getDisplayName(ec.user.locale)])]]></script></iterate><order-map-list list="localeStringList"><order-by field-name="name"/></order-map-list><entity-find entity-name="mantle.product.feature.ProductFeatureAndAppl" list="pfaaList"><date-filter/><econdition field-name="productId"/><select-field field-name="productFeatureId,typeDescription,description,abbrev"/><order-by field-name="typeDescription,sequenceNum,description"/></entity-find></actions><widgets><container-box><box-header title="Content List"/><box-toolbar><container-dialog id="NewContentDialog" button-text="Upload Content"><form-single name="NewContentForm" transition="createContent"><field name="productId"><default-field><hidden/></default-field></field><field name="productContentTypeEnumId"><default-field title="Content Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ProductContentType"/></widget-template-include></default-field></field><field name="sequenceNum"><default-field><text-line size="4"/></default-field></field><field name="contentFile"><default-field><file/></default-field></field><field name="locale"><default-field><drop-down allow-empty="true"><list-options list="localeStringList" key="${locale}" text="${locale}: ${name}"/></drop-down></default-field></field><field name="productFeatureId"><default-field title="Feature"><drop-down allow-empty="true"><list-options list="pfaaList" key="${productFeatureId}" text="ProductFeatureAndTypeTemplate"/></drop-down></default-field></field><field name="fromDate" from="ec.user.nowTimestamp"><default-field><date-time/></default-field></field><field name="thruDate"><default-field><date-time/></default-field></field><field name="description"><default-field><text-line size="60"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog><container-dialog id="NewLocationDialog" button-text="New by Location"><form-single name="NewLocationForm" transition="createContentWithLocation" extends="NewContentForm"><field name="contentFile"><default-field><ignored/></default-field></field><field name="contentLocation"><default-field><text-line size="70"/></default-field></field><field-layout><fields-not-referenced/><field-ref name="contentLocation"/><field-ref name="submitButton"/></field-layout></form-single></container-dialog><container-dialog id="NewTextDialog" button-text="New HTML Content" width="960"><form-single name="NewTextForm" transition="createContent" extends="NewContentForm"><field name="contentFile"><default-field><ignored/></default-field></field><field name="contentText"><default-field title=""><text-area cols="110" rows="15" editor-type="html"/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="ContentList" list="contentList" skip-form="true" header-dialog="true"><field name="download"><default-field title=""><link url="downloadContent" text="Download" condition="contentLocation" tooltip="${contentLocation}"/></default-field></field><field name="detail"><default-field title=""><link url="../ContentDetail" text="Edit"/></default-field></field><field name="productContentId"><default-field title="ID"><display/></default-field></field><field name="productContentTypeEnumId"><header-field title="Type" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ProductContentType"/><set field="allowEmpty" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="sequenceNum"><header-field title="Seq" show-order-by="true"/><default-field><display/></default-field></field><field name="locale"><header-field show-order-by="true"><drop-down allow-empty="true"><list-options list="localeStringList" key="${locale}" text="${locale}: ${name}"/></drop-down></header-field><default-field><display/></default-field></field><field name="productFeatureId"><header-field title="Feature"><drop-down allow-empty="true"><list-options list="pfaaList" key="${productFeatureId}" text="ProductFeatureAndTypeTemplate"/></drop-down></header-field><default-field><display-entity entity-name="mantle.product.feature.ProductFeatureAndType" text="ProductFeatureAndTypeTemplate"/></default-field></field><field name="userId"><header-field title="User" show-order-by="true"/><default-field><display-entity entity-name="mantle.party.PersonWithUserAccount" text="UsernameTemplate"/></default-field></field><field name="fromDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="thruDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="description"><header-field show-order-by="true"/><default-field><display/></default-field></field><field name="contentLocation"><header-field title="Location" show-order-by="true"><text-find hide-options="true"/></header-field><default-field tooltip="${contentLocation}"><display text="${contentLocation ? contentLocation.substring(contentLocation.lastIndexOf('/')+1) : 'No location set'}"/></default-field></field><form-list-column><field-ref name="download"/></form-list-column><form-list-column><field-ref name="detail"/></form-list-column><form-list-column><field-ref name="productContentId"/></form-list-column><form-list-column><field-ref name="productContentTypeEnumId"/></form-list-column><form-list-column><field-ref name="sequenceNum"/></form-list-column><form-list-column><field-ref name="locale"/></form-list-column><form-list-column><field-ref name="productFeatureId"/></form-list-column><form-list-column><field-ref name="userId"/></form-list-column><form-list-column><field-ref name="fromDate"/><field-ref name="thruDate"/></form-list-column><form-list-column><field-ref name="description"/><field-ref name="contentLocation"/></form-list-column></form-list></box-body></container-box></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Catalog/Product/Content.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Content" default-menu-index="2"><parameter name="productId" required="true"/><subscreens default-item="ContentList"/><widgets><subscreens-active/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Catalog/Product/EditAssocs.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Associated" default-menu-index="3"><parameter name="productId" required="true"/><transition name="editProduct"><default-response url="../EditProduct"/></transition><transition name="editFeature"><default-response url="../../Feature/EditFeature"/></transition><transition name="editFeatureGroup"><default-response url="../../FeatureGroup/EditFeatureGroup"/></transition><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition name="createProductAssoc"><service-call name="create#mantle.product.ProductAssoc" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateProductAssoc"><service-call name="update#mantle.product.ProductAssoc" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createVariants"><service-call name="mantle.product.ProductServices.create#VariantProducts" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><service-call name="mantle.product.ProductServices.find#ProductFeatures" out-map="selectableFeatureOut" in-map="[productId:productId, applTypeEnumId:'PfatSelectable']"/><set field="selectableFeatureList" from="selectableFeatureOut.productFeatureList"/><order-map-list list="selectableFeatureList"><order-by field-name="sequenceNum"/><order-by field-name="productFeatureTypeEnumId"/><order-by field-name="description"/></order-map-list><service-call name="mantle.product.ProductServices.find#ProductFeatureGroups" out-map="context" in-map="[productId:productId, applTypeEnumId:'PfatSelectable']"/><entity-find entity-name="ProductAssocAndTo" list="paatList"><search-form-inputs default-order-by="productName"/><date-filter/><econdition field-name="productId"/></entity-find><entity-find entity-name="ProductAssocAndFrom" list="paafList" limit="20"><date-filter/><econdition field-name="toProductId" from="productId"/></entity-find></actions><widgets><container-row><row-col lg="7"><container-box><box-header title="Associated"/><box-toolbar><container-dialog id="AddAssocToDialog" button-text="Add Assoc"><form-single name="AddAssocToForm" transition="createProductAssoc"><field name="productId"><default-field><hidden/></default-field></field><field name="toProductId"><default-field title="Product"><drop-down><dynamic-options transition="getProductList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="productAssocTypeEnumId"><default-field title="Assoc. Type"><drop-down no-current-selected-key="PatMfgBom"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="ProductAssocType"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="quantity"><default-field><text-line size="10"/></default-field></field><field name="fromDate" from="ec.user.nowTimestamp"><default-field><hidden/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="AssocToListForm" list="paatList" transition="updateProductAssoc" paginate="true"><field name="productId"><default-field><hidden/></default-field></field><field name="toProductId"><default-field title="Product"><display text=" "/><link url="editProduct" text="${productName} [${toProductId}]" parameter-map="[productId:toProductId]" link-type="anchor"/></default-field></field><field name="productTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="productAssocTypeEnumId"><default-field title="Assoc. Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="quantity"><default-field title="Qty"><text-line size="8" format="0.######"/></default-field></field><field name="fromDate"><default-field><hidden/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field name="removeButton"><default-field title=""><link url="updateProductAssoc" text="X" parameter-map="[productId:productId,                             toProductId:toProductId, productAssocTypeEnumId:productAssocTypeEnumId,                             fromDate:fromDate, thruDate:ec.user.nowTimestamp]" confirmation="Remove this association?"/></default-field></field></form-list></box-body></container-box><container-box><box-header title="Associated From"/><box-body><form-list name="AssocFromListForm" list="paafList" skip-form="true"><field name="productId"><default-field title="Product"><link url="editProduct" text="${productName} [${pseudoId}]" parameter-map="[productId:productId]" link-type="anchor"/></default-field></field><field name="productTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="productAssocTypeEnumId"><default-field title="Assoc. Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="quantity"><default-field title="Qty"><display format="0.######"/></default-field></field></form-list></box-body></container-box></row-col><row-col lg="5"><container-box><box-header title="Selectable Features"/><box-toolbar><container-dialog id="CreateVariantsDialog" button-text="Create Variants"><form-single name="CreateVariantsForm" transition="createVariants"><field name="productId"><default-field><hidden/></default-field></field><field name="copyCategoryMembers"><default-field><hidden default-value="true"/></default-field></field><field name="productTypeEnumId"><default-field title="Variant Type"><drop-down><option key="" text="Same"/><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="ProductType"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="productFeatureGroupIdSet"><default-field title="Feature Group(s)"><drop-down allow-multiple="true"><list-options list="productFeatureGroupList" key="${productFeatureGroupId}" text="${description}"/></drop-down></default-field></field><field name="submitButton"><default-field title="Create All Variants"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="AllSelectableFeaturesForm" list="selectableFeatureList" skip-form="true"><row-actions><if condition="selectableFeatureList_entry.getEntityName() == 'mantle.product.feature.ProductFeatureAndGroupAppl'"><entity-find-one entity-name="mantle.product.feature.ProductFeatureGroup" value-field="featureGroup"/></if></row-actions><field name="productFeatureTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="productFeatureId"><default-field title="Feature"><link url="editFeature" text="${description} [${abbrev ?: productFeatureId}]" link-type="anchor"/></default-field></field><field name="productFeatureGroupId"><conditional-field condition="featureGroup"><link url="editFeatureGroup" text="${featureGroup.description} [${productFeatureGroupId}]" link-type="anchor"/></conditional-field><default-field title="Feature Group"><display text=""/></default-field></field></form-list></box-body></container-box></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Catalog/Product/EditCategories.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Categories" default-menu-index="3"><parameter name="productId" required="true"/><transition name="editCategory"><default-response url="../../Category/EditCategory"/></transition><transition name="createProductCategoryMember"><service-call name="create#mantle.product.category.ProductCategoryMember" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateProductCategoryMember"><service-call name="update#mantle.product.category.ProductCategoryMember" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getCategoryList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><widgets><container-dialog id="AddCategoryDialog" button-text="Add to Category"><form-single name="AddCategoryForm" transition="createProductCategoryMember"><field name="productId"><default-field><hidden/></default-field></field><field name="productCategoryId"><default-field title="Category"><drop-down><dynamic-options transition="getCategoryList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="fromDate" from="ec.user.nowTimestamp"><default-field><date-time/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog><form-list name="CategoriesForm" list="pcamList" transition="updateProductCategoryMember" header-dialog="true"><entity-find entity-name="mantle.product.category.ProductCategoryAndMember" list="pcamList"><search-form-inputs default-order-by="categoryName"/><econdition field-name="productId"/></entity-find><field name="productId"><header-field><hidden/></header-field><default-field><hidden/></default-field></field><field name="productCategoryId"><default-field><hidden/></default-field></field><field name="pseudoId"><header-field title="ID" show-order-by="true"><text-find size="10" hide-options="true"/></header-field><default-field><link url="editCategory" text="${pseudoId}" link-type="anchor"/></default-field></field><field name="categoryName"><header-field title="Name" show-order-by="true"><text-find size="30" hide-options="true"/></header-field><default-field><link url="editCategory" text="${categoryName}" link-type="anchor"/></default-field></field><field name="productCategoryTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="fromDate"><header-field show-order-by="true"><date-period allow-empty="true"/></header-field><default-field><display/></default-field></field><field name="thruDate"><header-field show-order-by="true"><date-period allow-empty="true"/></header-field><default-field><date-time/></default-field></field><field name="sequenceNum"><header-field show-order-by="true"/><default-field><text-line size="4"/></default-field></field><field name="quantity"><header-field show-order-by="true"/><default-field><text-line size="4"/></default-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field><default-field title="Update"><submit/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Catalog/Product/EditPrices.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Prices" default-menu-index="5"><parameter name="productId" required="true"/><transition name="createProductPrice"><service-call name="create#mantle.product.ProductPrice" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateProductPrice"><service-call name="update#mantle.product.ProductPrice" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteProductPrice"><service-call name="delete#mantle.product.ProductPrice" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><actions><entity-find entity-name="mantle.product.ProductPrice" list="priceList"><search-form-inputs default-order-by="price"/><econdition field-name="productId"/></entity-find></actions><widgets><container-dialog id="NewPriceDialog" button-text="New Price"><form-single name="NewPriceForm" transition="createProductPrice"><field name="productId"><default-field title="Product"><display-entity entity-name="mantle.product.Product" text="${productName} [${pseudoId}]"/></default-field></field><field name="priceTypeEnumId"><default-field title="Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ProductPriceType"/><set field="noCurrentSelectedKey" value="PptCurrent"/></widget-template-include></default-field></field><field name="pricePurposeEnumId"><default-field title="Purpose"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ProductPricePurpose"/><set field="noCurrentSelectedKey" value="PppPurchase"/></widget-template-include></default-field></field><field name="vendorPartyId"><default-field title="Vendor"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2" parameter-map="[roleTypeId:'Vendor,Supplier']"/></drop-down></default-field></field><field name="customerPartyId"><default-field title="Customer"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2" parameter-map="[roleTypeId:'Customer']"/></drop-down></default-field></field><field name="otherPartyItemId"><default-field title="Other Party Product ID"><text-line size="25"/></default-field></field><field name="fromDate"><default-field><date-time/></default-field></field><field name="thruDate"><default-field><date-time/></default-field></field><field name="productStoreId"><default-field title="Store"><drop-down allow-empty="true"><entity-options key="${productStoreId}" text="${storeName} [${productStoreId}]"><entity-find entity-name="mantle.product.store.ProductStore"><order-by field-name="storeName"/></entity-find></entity-options></drop-down></default-field></field><field name="minQuantity"><default-field><text-line size="10" default-value="1"/></default-field></field><field name="price"><default-field><text-line size="10"/></default-field></field><field name="priceUomId"><default-field title="Currency"><drop-down no-current-selected-key="${ec.user.getPreference('CurrencyDefault') ?: 'USD'}"><entity-options key="${uomId}" text="${description} [${uomId}]"><entity-find entity-name="moqui.basic.Uom"><econdition field-name="uomTypeEnumId" value="UT_CURRENCY_MEASURE"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="PricesForm" list="priceList" transition="updateProductPrice" header-dialog="true"><field name="productPriceId"><default-field><hidden/></default-field></field><field name="productId"><header-field><hidden/></header-field><default-field><hidden/></default-field></field><field name="priceTypeEnumId"><header-field title="Type" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ProductPriceType"/><set field="allowEmpty" value="true"/><set field="style" value=" "/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="pricePurposeEnumId"><header-field title="Purpose" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ProductPricePurpose"/><set field="allowEmpty" value="true"/><set field="style" value=" "/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="vendorPartyId"><header-field show-order-by="true"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2" parameter-map="[roleTypeId:'Vendor,Supplier,OrgInternal']"/></drop-down></header-field><default-field title="Vendor"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2" parameter-map="[roleTypeId:'Vendor,Supplier,OrgInternal']"/></drop-down></default-field></field><field name="customerPartyId"><header-field show-order-by="true"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2" parameter-map="[roleTypeId:'Customer,OrgInternal']"/></drop-down></header-field><default-field title="Customer"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2" parameter-map="[roleTypeId:'Customer,OrgInternal']"/></drop-down></default-field></field><field name="otherPartyItemId"><default-field title="Other Party Product ID"><text-line size="25"/></default-field></field><field name="fromDate"><header-field show-order-by="true"><date-period/></header-field><default-field><date-time/></default-field></field><field name="thruDate"><header-field show-order-by="true"><date-period/></header-field><default-field><date-time/></default-field></field><field name="productStoreId"><default-field title="Store"><drop-down allow-empty="true"><entity-options key="${productStoreId}" text="${storeName} [${productStoreId}]"><entity-find entity-name="mantle.product.store.ProductStore"><order-by field-name="storeName"/></entity-find></entity-options></drop-down></default-field></field><field name="minQuantity"><header-field show-order-by="true"><range-find/></header-field><default-field><text-line size="8"/></default-field></field><field name="price"><header-field show-order-by="true"><range-find/></header-field><default-field><text-line size="8" format="#.00"/></default-field></field><field name="priceUomId"><header-field title="Currency" show-order-by="true"/><default-field><display/></default-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field><default-field title="Update"><submit/></default-field></field><field name="removeButton"><default-field title=""><link url="deleteProductPrice" text=" " icon="fa fa-trash" confirmation="Delete this Price record?"/></default-field></field><form-list-column><field-ref name="priceTypeEnumId"/><field-ref name="pricePurposeEnumId"/></form-list-column><form-list-column><field-ref name="vendorPartyId"/><field-ref name="customerPartyId"/><field-ref name="otherPartyItemId"/></form-list-column><form-list-column><field-ref name="fromDate"/><field-ref name="thruDate"/><field-ref name="productStoreId"/></form-list-column><form-list-column><field-ref name="minQuantity"/></form-list-column><form-list-column><field-ref name="price"/><field-ref name="priceUomId"/></form-list-column><form-list-column><field-ref name="submitButton"/><field-ref name="removeButton"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Catalog/Product.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Products" default-menu-index="2"><subscreens default-item="FindProduct"/><actions><entity-find-one entity-name="mantle.product.Product" value-field="product"/></actions><widgets><label text="ProductNameTemplate" text-map="product" type="strong" condition="product"/><subscreens-panel id="ProductPanel" type="tab"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Catalog/Search.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Search Products" default-menu-index="3"><parameter name="queryString"/><transition name="findProduct"><default-response url="."/></transition><transition name="editProduct"><default-response url="../Product/EditProduct"/></transition><transition-include name="getFeatureList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getCategoryList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition name="addProductCategory"><service-call name="mantle.product.ProductServices.add#ProductsToCategory" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="removeProductCategory"><service-call name="mantle.product.ProductServices.remove#ProductsFromCategory" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="addProductFeature"><service-call name="mantle.product.ProductServices.add#FeatureToProducts" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="removeProductFeature"><service-call name="mantle.product.ProductServices.remove#FeatureFromProducts" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><set field="pageSize" from="pageSize ?: 50"/><set field="indexName" from="searchIndexName ?: 'mantle'"/><set field="documentType" from="searchProductDocType ?: 'MantleProduct'"/><set field="originalQueryString" from="queryString"/><set field="queryString" from="queryString ? elasticQueryAutoWildcard(queryString, false) : ''"/><if condition="pseudoId"><set field="queryString" from="(queryString ? queryString + ' AND ' : '' ) + 'pseudoId:' + pseudoId"/></if><if condition="name"><set field="queryString" from="(queryString ? queryString + ' AND ' : '' ) + 'name:\"' + name + '*\"'"/></if><if condition="idValue"><set field="queryString" from="(queryString ? queryString + ' AND ' : '' ) + 'idValue:' + idValue"/></if><if condition="productTypeEnumId"><set field="queryString" from="(queryString ? queryString + ' AND ' : '' ) + 'productTypeEnumId:' + productTypeEnumId"/></if><if condition="assetTypeEnumId"><set field="queryString" from="(queryString ? queryString + ' AND ' : '' ) + 'assetTypeEnumId:' + assetTypeEnumId"/></if><if condition="assetClassEnumId"><set field="queryString" from="(queryString ? queryString + ' AND ' : '' ) + 'assetClassEnumId:' + assetClassEnumId"/></if><if condition="amountUomId"><set field="queryString" from="(queryString ? queryString + ' AND ' : '' ) + 'amountUomId:' + amountUomId"/></if><if condition="ownerPartyId"><set field="queryString" from="(queryString ? queryString + ' AND ' : '' ) + 'ownerPartyId:' + ownerPartyId"/></if><if condition="productFeatureId"><set field="queryString" from="(queryString ? queryString + ' AND ' : '' ) + 'features.productFeatureId:' + productFeatureId"/></if><if condition="productFeatureId2"><set field="queryString" from="(queryString ? queryString + ' AND ' : '' ) + 'features.productFeatureId:' + productFeatureId2"/></if><if condition="productCategoryId"><set field="queryString" from="(queryString ? queryString + ' AND ' : '' ) + 'categories.productCategoryId:' + productCategoryId"/></if><set field="activeOrgId" from="ec.user.context?.activeOrgId"/><set field="filterOrgIds" from="ec.user.context?.filterOrgIds"/><set field="findFilters" from="ec.artifactExecution.getFindFiltersForUser('mantle.product.Product')"/><if condition="findFilters"><set field="entityFilterSetId" from="findFilters[0].entityFilterSetId"/></if><script><![CDATA[if ('MANTLE_USER_ORG'.equals(entityFilterSetId)) {
                queryString = (queryString ? queryString + ' AND ' : '' ) + 'ownerPartyId:(' + filterOrgIds.join(' OR ') + ')'
            } else if ('MANTLE_ACTIVE_ORG'.equals(entityFilterSetId) && activeOrgId) {
                queryString = (queryString ? queryString + ' AND ' : '' ) + 'ownerPartyId:(' + activeOrgId + ' OR _NA_)'
            }]]></script><if condition="orderByField"><set field="orderByFields" from="[orderByField]"/></if><if condition="queryString"><service-call name="org.moqui.search.SearchServices.search#DataDocuments" out-map="context" in-map="context + [indexName:indexName, documentType:documentType]"/></if><set field="productIds" from="documentList ? documentList*._id : null"/><entity-find entity-name="mantle.product.Product" list="amountUomList" distinct="true"><select-field field-name="amountUomId"/></entity-find><set field="amountUomIds" from="amountUomList.amountUomId"/></actions><widgets><container-dialog id="AddCategoryContainer" button-text="Add All to Category" condition="productIds"><form-single name="AddCategoryForm" transition="addProductCategory"><field name="queryString"><default-field><hidden/></default-field></field><field name="productInfo"><default-field><display text="${productIds?.size() ?: '0'} Products"/></default-field></field><field name="productCategoryId"><default-field title="Category"><drop-down><dynamic-options transition="getCategoryList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="submitButton"><default-field title="Add All"><submit/></default-field></field><field name="productIdList" from="productIds.join(',')"><default-field><hidden/></default-field></field></form-single></container-dialog><container-dialog id="RemoveCategoryContainer" button-text="Remove All from Category" condition="productIds"><form-single name="RemoveCategoryForm" transition="removeProductCategory"><field name="queryString"><default-field><hidden/></default-field></field><field name="productInfo"><default-field><display text="${productIds?.size() ?: '0'} Products"/></default-field></field><field name="productCategoryId"><default-field title="Category"><drop-down><dynamic-options transition="getCategoryList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="submitButton"><default-field title="Remove All"><submit/></default-field></field><field name="productIdList" from="productIds.join(',')"><default-field><hidden/></default-field></field></form-single></container-dialog><container-dialog id="AddFeatureContainer" button-text="Add Feature to All" condition="productIds"><form-single name="AddFeatureForm" transition="addProductFeature"><field name="queryString"><default-field><hidden/></default-field></field><field name="productInfo"><default-field><display text="${productIds?.size() ?: '0'} Products"/></default-field></field><field name="productFeatureId"><default-field title="Feature"><drop-down allow-empty="true"><dynamic-options transition="getFeatureList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="applTypeEnumId"><default-field title="Appl. Type"><drop-down no-current-selected-key="PfatStandard"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="ProductFeatureApplType"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Add to All"><submit/></default-field></field><field name="productIdList" from="productIds.join(',')"><default-field><hidden/></default-field></field></form-single></container-dialog><container-dialog id="RemoveFeatureContainer" button-text="Remove Feature from All" condition="productIds"><form-single name="RemoveFeatureForm" transition="removeProductFeature"><field name="queryString"><default-field><hidden/></default-field></field><field name="productInfo"><default-field><display text="${productIds?.size() ?: '0'} Products"/></default-field></field><field name="productFeatureId"><default-field title="Feature"><drop-down allow-empty="true"><dynamic-options transition="getFeatureList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="submitButton"><default-field title="Remove from All"><submit/></default-field></field><field name="productIdList" from="productIds.join(',')"><default-field><hidden/></default-field></field></form-single></container-dialog><link url="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-query-string-query.html#query-string-syntax" url-type="plain" link-type="anchor" target-window="_blank" text="Search String Reference"/><form-list name="ProductsForm" list="documentList" list-entry="document" skip-form="true" header-dialog="true" select-columns="true" show-page-size="true"><row-actions><set field="productId" from="document?._id"/><script><![CDATA[if (document) context.putAll(document)]]></script></row-actions><row-selection id-field="productId" parameter="productIdList" list-mode="true"><action><dialog button-text="Add to Category" title="Add Selected Products to Category"/><form-single name="AddCategoryFormSelection" transition="addProductCategory" pass-through-parameters="true"><field name="productCategoryId"><default-field title="Category"><drop-down><dynamic-options transition="getCategoryList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="submitButton"><default-field title="Add Selected"><submit/></default-field></field></form-single></action><action><dialog button-text="Remove from Category" title="Remove Selected Products from Category"/><form-single name="RemoveCategoryFormSelection" transition="removeProductCategory" pass-through-parameters="true"><field name="productCategoryId"><default-field title="Category"><drop-down><dynamic-options transition="getCategoryList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="submitButton"><default-field title="Remove Selected"><submit/></default-field></field></form-single></action><action><dialog button-text="Add Feature" title="Add Feature to Selected Products"/><form-single name="AddFeatureFormSelection" transition="addProductFeature" pass-through-parameters="true"><field name="productFeatureId"><default-field title="Feature"><drop-down allow-empty="true"><dynamic-options transition="getFeatureList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="applTypeEnumId"><default-field title="Appl. Type"><drop-down no-current-selected-key="PfatStandard"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="ProductFeatureApplType"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Add to Selected"><submit/></default-field></field></form-single></action><action><dialog button-text="Remove Feature" title="Remove Feature from Selected Products"/><form-single name="RemoveFeatureFormSelection" transition="removeProductFeature" pass-through-parameters="true"><field name="productFeatureId"><default-field title="Feature"><drop-down allow-empty="true"><dynamic-options transition="getFeatureList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="submitButton"><default-field title="Remove from Selected"><submit/></default-field></field></form-single></action></row-selection><field name="productId"><default-field><hidden/></default-field></field><field name="queryString" from="originalQueryString"><header-field title="Any Field"><text-line size="40"/></header-field></field><field name="pseudoId"><header-field title="ID" show-order-by="true"><text-line size="40"/></header-field><default-field><link url="editProduct" text="${pseudoId}" link-type="anchor"/></default-field></field><field name="name"><header-field title="Name" show-order-by="true"><text-line size="60"/></header-field><default-field><link url="editProduct" text="${name}" link-type="anchor"/></default-field></field><field name="idValue"><header-field title="Other IDs"><text-line size="40"/></header-field></field><field name="productTypeEnumId"><header-field title="Product Type" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ProductType"/><set field="allowEmpty" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="ownerPartyId"><header-field title="Product Owner" show-order-by="true"><drop-down allow-empty="true"><option key="_NA_" text="N/A"/><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></header-field><default-field><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameTemplate"/></default-field></field><field name="amountUomId"><header-field title="Amount/UOM" show-order-by="true"><drop-down allow-empty="true"><entity-options key="${uomId}" text="${description} [${uomId}]"><entity-find entity-name="moqui.basic.Uom"><econdition field-name="uomId" operator="in" from="amountUomIds"/><order-by field-name="description"/></entity-find></entity-options></drop-down></header-field><default-field><display-entity entity-name="moqui.basic.Uom" text="${amountFixed?:''} ${description}"/></default-field></field><field name="productFeatureId"><header-field title="Feature"><drop-down allow-empty="true"><dynamic-options transition="getFeatureList" server-search="true" min-length="0"/></drop-down></header-field></field><field name="productFeatureId2"><header-field title="Feature 2"><drop-down allow-empty="true"><dynamic-options transition="getFeatureList" server-search="true" min-length="0"/></drop-down></header-field></field><field name="productCategoryId"><header-field title="Category"><drop-down allow-empty="true"><dynamic-options transition="getCategoryList" server-search="true" min-length="0"/></drop-down></header-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field></field></form-list><label text="Full search string: ${queryString?:''}" type="p"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Catalog/Category/FindCategory.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="findCategory"><default-response url="."/></transition><transition name="editCategory"><default-response url="../EditCategory"/></transition><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition name="createCategory"><service-call name="create#mantle.product.category.ProductCategory" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditCategory"/></transition><widgets><container-dialog id="NewCategoryDialog" button-text="New Category"><form-single name="NewCategoryForm" transition="createCategory"><field name="categoryName"><default-field><text-line/></default-field></field><field name="productCategoryTypeEnumId"><default-field title="Category Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ProductCategoryType"/></widget-template-include></default-field></field><field name="ownerPartyId"><default-field title="Owner Party"><drop-down><option key="_NA_" text="N/A"/><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="partyId" from="activeOrgId" ignore="!activeOrgId"/><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="CategoriesForm" list="categoryList" skip-form="true"><entity-find entity-name="mantle.product.category.ProductCategory" list="categoryList" cache="false"><search-form-inputs default-order-by="categoryName"/><select-field field-name="productCategoryId"/></entity-find><field name="pseudoId"><header-field title="Category ID" show-order-by="case-insensitive"><text-find size="15" hide-options="true"/></header-field><default-field><link url="editCategory" text="${pseudoId}" link-type="anchor"/></default-field></field><field name="categoryName"><header-field title="Name" show-order-by="case-insensitive"><text-find size="15" hide-options="true"/></header-field><default-field><link url="editCategory" text="${categoryName}" link-type="anchor"/></default-field></field><field name="productCategoryTypeEnumId"><header-field title="Category Type" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ProductCategoryType"/><set field="allowEmpty" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="ownerPartyId"><header-field title="Owner Party"><drop-down allow-empty="true"><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></header-field><default-field><link url="editParty" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" link-type="anchor" parameter-map="[partyId:ownerPartyId]"/></default-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field><default-field><display text=" "/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Catalog/Category/EditCategory.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Category" default-menu-index="1"><parameter name="productCategoryId" required="true" from="curProductCategoryId ?: productCategoryId"/><transition name="editFeatureGroup"><default-response url="../../FeatureGroup/EditFeatureGroup"/></transition><transition name="updateCategory"><service-call name="update#mantle.product.category.ProductCategory" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createProductCategoryFeatGrpAppl"><service-call name="create#mantle.product.feature.ProductCategoryFeatGrpAppl" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateProductCategoryFeatGrpAppl"><service-call name="update#mantle.product.feature.ProductCategoryFeatGrpAppl" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createProductCategoryIdent"><service-call name="create#mantle.product.category.ProductCategoryIdent" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateProductCategoryIdent"><service-call name="update#mantle.product.category.ProductCategoryIdent" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteProductCategoryIdent"><service-call name="delete#mantle.product.category.ProductCategoryIdent" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="generateUrlSlugCategoryIdent"><service-call name="mantle.product.StoreServices.generate#UrlSlugFromCategoryName" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createProductCategoryRollup"><service-call name="create#mantle.product.category.ProductCategoryRollup" in-map="context + [productCategoryId:childProductCategoryId]" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateProductCategoryRollup"><service-call name="update#mantle.product.category.ProductCategoryRollup" in-map="context + [productCategoryId:childProductCategoryId]" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteProductCategoryRollup"><service-call name="delete#mantle.product.category.ProductCategoryRollup" in-map="context + [productCategoryId:childProductCategoryId]" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getCategoryList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><actions><entity-find-one entity-name="mantle.product.category.ProductCategory" value-field="category" cache="false"/><if condition="category == null"><return error="true" message="Category not found with ID ${productCategoryId}"/></if><set field="curProductCategoryId" from="productCategoryId"/><entity-find entity-name="moqui.basic.Enumeration" limit="200" cache="true" list="productCategoryIdentTypeList"><econdition field-name="enumTypeId" value="ProductCategoryIdentType"/><order-by field-name="description"/></entity-find><entity-find entity-name="mantle.product.store.ProductStore" limit="200" cache="true" list="productStoreList"><order-by field-name="storeName"/></entity-find><entity-find entity-name="mantle.marketing.segment.MarketSegment" limit="200" cache="true" list="marketSegmentList"><order-by field-name="description"/></entity-find><entity-find entity-name="mantle.product.category.ProductCategoryIdent" list="pciList"><econdition field-name="productCategoryId"/></entity-find></actions><widgets><container-row><row-col md="7"><form-single name="EditCategoryForm" map="category" transition="updateCategory"><field name="productCategoryId"><default-field><hidden/></default-field></field><field name="pseudoId"><default-field title="ID"><text-line size="15"/></default-field></field><field name="categoryName"><default-field title="Name"><text-line size="60"/></default-field></field><field name="productCategoryTypeEnumId"><default-field title="Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ProductCategoryType"/></widget-template-include></default-field></field><field name="ownerPartyId"><default-field title="Owned By Org"><drop-down allow-empty="true"><option key="_NA_" text="N/A"/><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></default-field></field><field name="description"><default-field><text-area cols="65" rows="4"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single><section name="ChildCategorySection"><actions><set field="parentProductCategoryId" from="productCategoryId"/></actions><widgets><container-box><box-header title="Child Categories"/><box-toolbar><container-dialog id="AddChildDialog" button-text="Add Child Category"><form-single name="AddChild" transition="createProductCategoryRollup"><field name="curProductCategoryId"><default-field><hidden/></default-field></field><field name="parentProductCategoryId"><default-field><hidden/></default-field></field><field name="childProductCategoryId"><default-field title="Child"><drop-down><dynamic-options transition="getCategoryList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="fromDate" from="ec.user.nowTimestamp"><default-field><date-time/></default-field></field><field name="thruDate"><default-field><date-time/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body-nopad><form-list name="ChildCategoriesForm" list="pccList" transition="updateProductCategoryRollup"><entity-find entity-name="mantle.product.category.ProductCategoryChildren" list="pccList"><econdition field-name="parentProductCategoryId"/><order-by field-name="sequenceNum,categoryName"/></entity-find><field name="curProductCategoryId"><default-field><hidden/></default-field></field><field name="parentProductCategoryId"><default-field><hidden/></default-field></field><field name="childProductCategoryId"><default-field><hidden/></default-field></field><field name="sequenceNum"><default-field><text-line size="4"/></default-field></field><field name="pseudoId"><default-field title="ID"><link url="." text="${pseudoId}" link-type="anchor" parameter-map="[productCategoryId:childProductCategoryId]"/></default-field></field><field name="categoryName"><default-field><link url="." text="${categoryName}" link-type="anchor" parameter-map="[productCategoryId:childProductCategoryId]"/></default-field></field><field name="fromDate"><default-field><display/></default-field></field><field name="thruDate"><default-field><date-time/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field name="delete"><default-field title=""><link url="deleteProductCategoryRollup" text="" icon="fa fa-trash" confirmation="Delete record of child within category?" parameter-map="[childProductCategoryId:childProductCategoryId, parentProductCategoryId:parentProductCategoryId, fromDate:fromDate]"/></default-field></field></form-list></box-body-nopad></container-box><container-box><box-header title="Category Identification"/><box-toolbar><form-single name="GenerateCategoryIdent" transition="generateUrlSlugCategoryIdent"><field name="productCategoryId"><default-field><hidden/></default-field></field><field name="categoryName" from="category?.categoryName"><default-field><hidden/></default-field></field><field name="submitButton"><conditional-field title="Generate Url Slug" tooltip="Generate Url Slug from the Category's Name" condition="pciList?.findAll{it.identTypeEnumId == 'PcitUrlSlug' }?.size() == 0"><submit/></conditional-field></field></form-single><container-dialog id="AddCategoryIdentDialog" button-text="New Category Identification"><form-single name="AddCategoryIdentForm" transition="createProductCategoryIdent"><field name="productCategoryId"><default-field><hidden/></default-field></field><field name="productCategoryIdentId"><default-field tooltip="Id of Product Category to Product Category Ident Relationship"><text/></default-field></field><field name="identTypeEnumId"><default-field title="Identity Type"><drop-down><list-options list="productCategoryIdentTypeList" key="${enumId}" text="${description}"/></drop-down></default-field></field><field name="productStoreId"><default-field title="Product Store"><drop-down allow-empty="true"><list-options list="productStoreList" key="${productStoreId}" text="${storeName}"/></drop-down></default-field></field><field name="marketSegmentId"><default-field><drop-down allow-empty="true"><list-options list="marketSegmentList" key="${marketSegmentId}" text="${description}"/></drop-down></default-field></field><field name="idValue"><default-field><text-line size="20"/></default-field></field><field name="submitButton"><default-field title="Apply"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="CategoryIdentForm" list="pciList" transition="updateProductCategoryIdent"><field name="productCategoryIdentId"><default-field><hidden/></default-field></field><field name="productCategoryId"><default-field><hidden/></default-field></field><field name="identTypeEnumId"><default-field title="Identity Type"><drop-down size="4"><list-options list="productCategoryIdentTypeList" key="${enumId}" text="${description}"/></drop-down></default-field></field><field name="productStoreId"><default-field title="Product Store"><drop-down size="4" allow-empty="true"><list-options list="productStoreList" key="${productStoreId}" text="${storeName}"/></drop-down></default-field></field><field name="marketSegmentId"><default-field title="Market Segment"><drop-down size="4" allow-empty="true"><list-options list="marketSegmentList" key="${marketSegmentId}" text="${description}"/></drop-down></default-field></field><field name="idValue"><default-field><text-line size="20"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field name="delete"><default-field title=""><link url="deleteProductCategoryIdent" text="" icon="fa fa-trash" confirmation="Delete Product Category Identity Record?"/></default-field></field></form-list></box-body></container-box></widgets></section></row-col><row-col md="5"><container-box><box-header title="Parent Categories"/><box-body-nopad><form-list name="ParentCategoriesForm" list="pcpList" skip-form="true"><entity-find entity-name="mantle.product.category.ProductCategoryParents" list="pcpList"><econdition field-name="productCategoryId"/><select-field field-name="parentProductCategoryId"/><order-by field-name="sequenceNum,categoryName"/></entity-find><field name="pseudoId"><default-field title="ID"><link url="." text="${pseudoId}" link-type="anchor" parameter-map="[productCategoryId:parentProductCategoryId]"/></default-field></field><field name="categoryName"><default-field><link url="." text="${categoryName}" link-type="anchor" parameter-map="[productCategoryId:parentProductCategoryId]"/></default-field></field><field name="fromDate"><default-field><display/></default-field></field><field name="thruDate"><default-field><display/></default-field></field></form-list></box-body-nopad></container-box><container-box><box-header title="Feature Groups"/><box-toolbar><container-dialog id="AddFeatureGroupDialog" button-text="Apply Feature Group"><form-single name="AddFeatureGroupForm" transition="createProductCategoryFeatGrpAppl"><field name="productCategoryId"><default-field><hidden/></default-field></field><field name="productFeatureGroupId"><default-field title="Group"><drop-down><entity-options key="${productFeatureGroupId}" text="${description} [${productFeatureGroupId}]"><entity-find entity-name="mantle.product.feature.ProductFeatureGroup" limit="200"><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="applTypeEnumId"><default-field title="Appl. Type"><drop-down no-current-selected-key="PfatStandard"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="ProductFeatureApplType"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="fromDate" from="ec.user.nowTimestamp"><default-field><hidden/></default-field></field><field name="submitButton"><default-field title="Apply"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="FeatureGroupsForm" list="pfgacaList" transition="updateProductCategoryFeatGrpAppl"><entity-find entity-name="mantle.product.feature.ProductFeatureGroupAndCategoryAppl" list="pfgacaList"><date-filter/><econdition field-name="productCategoryId"/></entity-find><field name="productCategoryId"><default-field><hidden/></default-field></field><field name="productFeatureGroupId"><default-field><hidden/></default-field></field><field name="featureGroup"><default-field><link url="editFeatureGroup" link-type="anchor" text="${description} [${productFeatureGroupId}]"/></default-field></field><field name="applTypeEnumId"><default-field title="Appl. Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="fromDate"><default-field><hidden/></default-field></field><field name="thruDate" from="ec.user.nowTimestamp"><default-field><hidden/></default-field></field><field name="submitButton"><default-field title="Unapply"><submit/></default-field></field></form-list></box-body></container-box></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Catalog/Category/EditProducts.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Products" default-menu-index="2"><parameter name="productCategoryId" required="true"/><transition name="editProduct"><default-response url="../../Product/EditProduct"/></transition><transition name="updateCategory"><service-call name="update#mantle.product.category.ProductCategory" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createProductCategoryMember"><service-call name="create#mantle.product.category.ProductCategoryMember" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateProductCategoryMember"><service-call name="update#mantle.product.category.ProductCategoryMember" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteProductCategoryMember"><service-call name="delete#mantle.product.category.ProductCategoryMember" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><widgets><container-dialog id="AddProductDialog" button-text="Add Product"><form-single name="AddProductForm" transition="createProductCategoryMember"><field name="productCategoryId"><default-field><hidden/></default-field></field><field name="productId"><default-field title="Product"><drop-down><dynamic-options transition="getProductList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="fromDate" from="ec.user.nowTimestamp"><default-field><date-time/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog><form-list name="ProductsForm" list="pcmpList" transition="updateProductCategoryMember" header-dialog="true"><entity-find entity-name="mantle.product.category.ProductCategoryMemberProduct" list="pcmpList"><search-form-inputs default-order-by="sequenceNum,pseudoId"/><econdition field-name="productCategoryId"/></entity-find><field name="productCategoryId"><header-field><hidden/></header-field><default-field><hidden/></default-field></field><field name="productId"><default-field><hidden/></default-field></field><field name="sequenceNum"><header-field show-order-by="true"/><default-field><text-line size="4"/></default-field></field><field name="pseudoId"><header-field title="ID" show-order-by="true"><text-find size="20" hide-options="true"/></header-field><default-field><link url="editProduct" text="${pseudoId}" link-type="anchor"/></default-field></field><field name="productName"><header-field title="Name" show-order-by="true"><text-find size="50" hide-options="true"/></header-field><default-field><link url="editProduct" text="${productName}" link-type="anchor"/></default-field></field><field name="productTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="fromDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="thruDate"><header-field show-order-by="true"><date-period/></header-field><default-field><date-time/></default-field></field><field name="quantity"><header-field show-order-by="true"/><default-field><text-line size="4"/></default-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field><default-field title="Update"><submit/></default-field></field><field name="delete"><default-field title=""><link url="deleteProductCategoryMember" text="" icon="fa fa-trash" confirmation="Delete record of product in category?" parameter-map="[productId:productId, productCategoryId:productCategoryId, fromDate:fromDate]"/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Catalog/Category/Content/ContentCompare.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" standalone="true" default-menu-include="false"><parameter name="productCategoryContentId" required="true"/><parameter name="versionNameLhs"/><parameter name="versionNameRhs"/><actions><set field="versionNameRhs" from="versionNameRhs ?: versionNameLhs"/><entity-find-one entity-name="mantle.product.category.ProductCategoryContent" value-field="productCategoryContent"/><set field="resourceRef" from="ec.resource.getLocationReference(productCategoryContent?.contentLocation)"/><set field="pageTextLhs" from="resourceRef?.getText(versionNameLhs) ?: ''"/><set field="pageTextRhs" from="resourceRef?.getText(versionNameRhs) ?: ''"/></actions><widgets><container-box><box-header title="Compare versions ${versionNameLhs} and ${versionNameRhs}"/><box-body><render-mode><text type="html,vuet,qvt"><![CDATA[<pre id="result" class="compare"></pre><textarea id="pageTextLhs" style="display: none;">${pageTextLhs?html}</textarea><textarea id="pageTextRhs" style="display: none;">${pageTextRhs?html}</textarea><script>
    var a = document.getElementById('pageTextLhs');
    var b = document.getElementById('pageTextRhs');
    var result = document.getElementById('result');
    // diffChars, diffWords, diffLines
	var diff = JsDiff['diffChars'](a.textContent, b.textContent);
	var fragment = document.createDocumentFragment();
	for (var i=0; i < diff.length; i++) {
		if (diff[i].added && diff[i + 1] && diff[i + 1].removed) {
			var swap = diff[i];
			diff[i] = diff[i + 1];
			diff[i + 1] = swap;
		}
		var node;
		if (diff[i].removed) {
			node = document.createElement('del');
			node.appendChild(document.createTextNode(diff[i].value));
		} else if (diff[i].added) {
			node = document.createElement('ins');
			node.appendChild(document.createTextNode(diff[i].value));
		} else {
			node = document.createTextNode(diff[i].value);
		}
		fragment.appendChild(node);
	}

	result.textContent = '';
	result.appendChild(fragment);
                </script>]]></text></render-mode></box-body></container-box></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Catalog/Category/Content/ContentDetail.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Detail"><parameter name="productCategoryId" required="true"/><parameter name="productCategoryContentId" required="true"/><transition name="updateContent"><service-call name="mantle.product.ProductServices.update#ProductCategoryContent" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="downloadContent" read-only="true"><parameter name="productCategoryContentId"/><actions><entity-find-one entity-name="mantle.product.category.ProductCategoryContent" value-field="productCategoryContent"/><script><![CDATA[ec.web.sendResourceResponse(productCategoryContent.contentLocation)]]></script></actions><default-response type="none"/></transition><actions><entity-find-one entity-name="mantle.product.category.ProductCategoryContent" value-field="productCategoryContent"/><set field="resourceRef" from="ec.resource.getLocationReference(productCategoryContent?.contentLocation)"/><if condition="resourceRef != null"><set field="supportsVersion" from="resourceRef.supportsVersion()"/><set field="isText" from="!resourceRef.isBinary()"/><if condition="isText"><set field="contentText" from="resourceRef.getText()"/></if></if><set field="localeStringList" from="[]"/><iterate list="Locale.getAvailableLocales()" entry="lcl"><script><![CDATA[localeStringList.add([locale:lcl.toString(), name:lcl.getDisplayName(ec.user.locale)])]]></script></iterate><order-map-list list="localeStringList"><order-by field-name="name"/></order-map-list></actions><widgets><container-row><row-col lg="9"><container-box><box-header title="Edit Content"/><box-toolbar><link url="downloadContent" text="Download" condition="productCategoryContent.contentLocation" tooltip="${productCategoryContent.contentLocation}"/></box-toolbar><box-body><form-single name="UpdateContentForm" transition="updateContent" map="productCategoryContent"><field name="productCategoryId"><default-field><hidden/></default-field></field><field name="productCategoryContentId"><default-field title="ID"><display/></default-field></field><field name="productCategoryContentTypeEnumId"><default-field title="Content Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ProductCategoryContentType"/></widget-template-include></default-field></field><field name="sequenceNum"><default-field><text-line size="4"/></default-field></field><field name="contentLocation"><default-field title="Location" tooltip="Location change will not move current file. Uploading a file will create a new location."><text-line size="60"/></default-field></field><field name="contentFile"><default-field title="Upload File"><file/></default-field></field><field name="description"><default-field><text-line size="60"/></default-field></field><field name="locale"><default-field><drop-down allow-empty="true"><list-options list="localeStringList" key="${locale}" text="${locale}: ${name}"/></drop-down></default-field></field><field name="fromDate"><default-field><date-time/></default-field></field><field name="thruDate"><default-field><date-time/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></box-body></container-box><section name="EditTextSection" condition="isText"><widgets><container-box><box-header title="Edit HTML"/><box-body><form-single name="UpdateTextForm" transition="updateContent" map="productCategoryContent"><field name="productCategoryId"><default-field><hidden/></default-field></field><field name="productCategoryContentId"><default-field><hidden/></default-field></field><field name="contentText"><default-field title=""><text-area cols="110" rows="15" editor-type="html"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></box-body></container-box></widgets></section></row-col><row-col lg="3"><container-box><box-header title="History"/><box-body><section name="HistorySection" condition="supportsVersion"><actions><set field="versionList" from="resourceRef.getVersionHistory()"/><set field="currentVersionName" from="resourceRef.getCurrentVersion()?.getVersionName()"/></actions><widgets><section-iterate name="HistListSection" list="versionList" entry="version"><actions><entity-find-one entity-name="mantle.party.PersonAndUserAccount" value-field="paua"><field-map field-name="userId" from="version.userId"/></entity-find-one><if condition="version_has_next"><set field="nextVersion" from="versionList[version_index+1]"/></if></actions><widgets><dynamic-dialog id="ShowVersionDialog" button-text="Version ${version.versionName}" width="900" transition="../ContentCompare" parameter-map="[versionNameLhs:version.versionName]"/><section name="DiffPrevSection" condition="nextVersion && nextVersion.versionName"><widgets><dynamic-dialog id="DiffPrevDialog" button-text="Diff Prev" width="900" transition="../ContentCompare" parameter-map="[versionNameLhs:nextVersion.versionName, versionNameRhs:version.versionName]"/></widgets></section><section name="DiffCurSection" condition="currentVersionName && version.versionName != currentVersionName"><widgets><dynamic-dialog id="DiffCurDialog" button-text="Diff Cur" width="900" transition="../ContentCompare" parameter-map="[versionNameLhs:version.versionName, versionNameRhs:currentVersionName]"/></widgets></section><label text="By ${paua.firstName?:''} ${paua.lastName?:''} (${paua.username?:'N/A'})" type="div" condition="paua"/><label text="At ${ec.l10n.format(version.versionDate, 'yyyy-MM-dd HH:mm')}" type="div"/></widgets></section-iterate></widgets><fail-widgets><label text="History not supported for this type of resource" type="strong"/></fail-widgets></section></box-body></container-box></row-col></container-row><render-mode><text type="html,vuet,qvt"><![CDATA[<script src="https://cdnjs.cloudflare.com/ajax/libs/jsdiff/3.2.0/diff.min.js" type="text/javascript"></script>]]></text></render-mode></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Catalog/Category/Content/ContentList.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="List"><parameter name="productCategoryId" required="true"/><transition name="createContent"><service-call name="mantle.product.ProductServices.create#ProductCategoryContent" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createContentWithLocation"><service-call name="create#mantle.product.category.ProductCategoryContent" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="downloadContent" read-only="true"><parameter name="productCategoryContentId"/><actions><entity-find-one entity-name="mantle.product.category.ProductCategoryContent" value-field="productCategoryContent"/><script><![CDATA[ec.web.sendResourceResponse(productCategoryContent.contentLocation)]]></script></actions><default-response type="none"/></transition><actions><entity-find entity-name="mantle.product.category.ProductCategoryContent" list="contentList"><search-form-inputs default-order-by="categoryContentTypeEnumId,sequenceNum,-fromDate"/><econdition field-name="productCategoryId"/></entity-find><set field="localeStringList" from="[]"/><iterate list="Locale.getAvailableLocales()" entry="lcl"><script><![CDATA[localeStringList.add([locale:lcl.toString(), name:lcl.getDisplayName(ec.user.locale)])]]></script></iterate><order-map-list list="localeStringList"><order-by field-name="name"/></order-map-list></actions><widgets><container-box><box-header title="Content List"/><box-toolbar><container-dialog id="NewContentDialog" button-text="Upload Content"><form-single name="NewContentForm" transition="createContent"><field name="productCategoryId"><default-field><hidden/></default-field></field><field name="categoryContentTypeEnumId"><default-field title="Content Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ProductCategoryContentType"/></widget-template-include></default-field></field><field name="sequenceNum"><default-field><text-line size="4"/></default-field></field><field name="contentFile"><default-field><file/></default-field></field><field name="locale"><default-field><drop-down allow-empty="true"><list-options list="localeStringList" key="${locale}" text="${locale}: ${name}"/></drop-down></default-field></field><field name="fromDate" from="ec.user.nowTimestamp"><default-field><date-time/></default-field></field><field name="thruDate"><default-field><date-time/></default-field></field><field name="description"><default-field><text-line size="60"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog><container-dialog id="NewLocationDialog" button-text="New by Location"><form-single name="NewLocationForm" transition="createContentWithLocation" extends="NewContentForm"><field name="contentFile"><default-field><ignored/></default-field></field><field name="contentLocation"><default-field><text-line size="70"/></default-field></field><field-layout><fields-not-referenced/><field-ref name="contentLocation"/><field-ref name="submitButton"/></field-layout></form-single></container-dialog><container-dialog id="NewTextDialog" button-text="New HTML Content" width="960"><form-single name="NewTextForm" transition="createContent" extends="NewContentForm"><field name="contentFile"><default-field><ignored/></default-field></field><field name="contentText"><default-field title=""><text-area cols="110" rows="15" editor-type="html"/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="ContentList" list="contentList" skip-form="true" header-dialog="true"><field name="download"><default-field title=""><link url="downloadContent" text="Download" condition="contentLocation" tooltip="${contentLocation}"/></default-field></field><field name="detail"><default-field title=""><link url="../ContentDetail" text="Edit"/></default-field></field><field name="productContentId"><default-field title="ID"><display/></default-field></field><field name="categoryContentTypeEnumId"><header-field title="Type" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ProductCategoryContentType"/><set field="allowEmpty" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="sequenceNum"><header-field title="Seq" show-order-by="true"/><default-field><display/></default-field></field><field name="locale"><header-field show-order-by="true"><drop-down allow-empty="true"><list-options list="localeStringList" key="${locale}" text="${locale}: ${name}"/></drop-down></header-field><default-field><display/></default-field></field><field name="fromDate"><header-field show-order-by="true"><date-period allow-empty="true"/></header-field><default-field><display/></default-field></field><field name="thruDate"><header-field show-order-by="true"><date-period allow-empty="true"/></header-field><default-field><display/></default-field></field><field name="description"><header-field show-order-by="true"/><default-field><display/></default-field></field><field name="contentLocation"><header-field title="Location" show-order-by="true"><text-find hide-options="true"/></header-field><default-field tooltip="${contentLocation}"><display text="${contentLocation ? contentLocation.substring(contentLocation.lastIndexOf('/')+1) : 'No location set'}"/></default-field></field></form-list></box-body></container-box></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Catalog/Category/Content.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Content" default-menu-index="3"><parameter name="productCategoryId" required="true"/><subscreens default-item="ContentList"/><widgets><subscreens-active/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Catalog/Category.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Categories" default-menu-index="4"><subscreens default-item="FindCategory"/><widgets><subscreens-panel id="CategoryPanel" type="tab"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Catalog/Feature/EditFeature.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Feature"><parameter name="productFeatureId" required="true"/><transition name="createFeature"><service-call name="create#mantle.product.feature.ProductFeature" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateFeature"><service-call name="update#mantle.product.feature.ProductFeature" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createProductFeatureGroupAppl"><service-call name="create#mantle.product.feature.ProductFeatureGroupAppl" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateProductFeatureGroupAppl"><service-call name="update#mantle.product.feature.ProductFeatureGroupAppl" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="editFeatureGroup"><default-response url="../../FeatureGroup/EditFeatureGroup"/></transition><transition name="createProductFeatureAppl"><service-call name="create#mantle.product.feature.ProductFeatureAppl" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateProductFeatureAppl"><service-call name="update#mantle.product.feature.ProductFeatureAppl" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="editProduct"><default-response url="../../Product/EditProduct"/></transition><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><actions><entity-find-one entity-name="mantle.product.feature.ProductFeature" value-field="feature" cache="false"/><if condition="feature == null"><return error="true" message="Feature not found with ID ${productFeatureId}"/></if><entity-find entity-name="mantle.product.feature.ProductFeatureGroupAndAppl" list="pfgaaList"><date-filter/><econdition field-name="productFeatureId"/><order-by field-name="description"/></entity-find><entity-find entity-name="mantle.product.feature.ProductFeatureIactn" list="pfiList"><econdition field-name="productFeatureId"/></entity-find><entity-find entity-name="mantle.product.feature.ProductAndFeatureAppl" list="pafaList"><search-form-inputs default-order-by="productName"/><date-filter/><econdition field-name="productFeatureId"/></entity-find></actions><widgets><container-dialog id="NewFeatureDialog" button-text="New Feature"><form-single name="NewFeatureForm" transition="createFeature"><field name="description"><default-field><text-line/></default-field></field><field name="productFeatureTypeEnumId" from="feature.productFeatureTypeEnumId"><default-field title="Feature Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ProductFeatureType"/></widget-template-include></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><container-row><row-col lg="6"><form-single name="EditFeatureForm" map="feature" transition="updateFeature"><field name="productFeatureId"><default-field title="ID"><display/></default-field></field><field name="abbrev"><default-field title="Abbreviation"><text-line size="10"/></default-field></field><field name="description"><default-field><text-line size="60"/></default-field></field><field name="productFeatureTypeEnumId"><default-field title="Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ProductFeatureType"/></widget-template-include></default-field></field><field name="defaultSequenceNum"><default-field title="Default Seq #"><text-line size="4"/></default-field></field><field name="defaultAmount"><default-field><text-line size="4"/></default-field></field><field name="numberSpecified"><default-field><text-line size="10"/></default-field></field><field name="ownerPartyId"><default-field title="Owned By Org"><drop-down allow-empty="true"><option key="_NA_" text="N/A"/><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single><container-box><box-header title="Feature Groups"/><box-toolbar><container-dialog id="AddFeatureGroupDialog" button-text="Add To Feature Group"><form-single name="AddFeatureGroupForm" transition="createProductFeatureGroupAppl"><field name="productFeatureId"><default-field><hidden/></default-field></field><field name="productFeatureGroupId"><default-field title="Group"><drop-down><entity-options key="${productFeatureGroupId}" text="${description} [${productFeatureGroupId}]"><entity-find entity-name="mantle.product.feature.ProductFeatureGroup" limit="200"><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="fromDate" from="ec.user.nowTimestamp"><default-field><hidden/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="FeatureGroupsForm" list="pfgaaList" transition="updateProductFeatureGroupAppl"><field name="productFeatureId"><default-field><hidden/></default-field></field><field name="productFeatureGroupId"><default-field><hidden/></default-field></field><field name="featureGroup"><default-field><link url="editFeatureGroup" link-type="anchor" text="${description} [${productFeatureGroupId}]"/></default-field></field><field name="fromDate"><default-field><hidden/></default-field></field><field name="thruDate" from="ec.user.nowTimestamp"><default-field><hidden/></default-field></field><field name="submitButton"><default-field title="Remove from Group"><submit/></default-field></field></form-list></box-body></container-box></row-col><row-col lg="6"><container-box><box-header title="Products"/><box-toolbar><container-dialog id="AddProductDialog" button-text="Add To Product"><form-single name="AddProductForm" transition="createProductFeatureAppl"><field name="productFeatureId"><default-field><hidden/></default-field></field><field name="productId"><default-field title="Product"><drop-down><dynamic-options transition="getProductList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="applTypeEnumId"><default-field title="Appl. Type"><drop-down no-current-selected-key="PfatStandard"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="ProductFeatureApplType"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="sequenceNum"><default-field title="Seq #"><text-line size="4"/></default-field></field><field name="amount"><default-field><text-line size="6"/></default-field></field><field name="fromDate" from="ec.user.nowTimestamp"><default-field><hidden/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="ProductsForm" list="pafaList"><field name="productFeatureId"><default-field><hidden/></default-field></field><field name="productId"><default-field><hidden/></default-field></field><field name="product"><default-field><link url="editProduct" link-type="anchor" text="${productName} [${pseudoId}]"/></default-field></field><field name="productTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="applTypeEnumId"><default-field title="Appl. Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="sequenceNum"><default-field title="Seq #"><display/></default-field></field><field name="amount"><default-field><display/></default-field></field></form-list></box-body></container-box></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Catalog/Feature/FindFeature.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="editFeature"><default-response url="../EditFeature"/></transition><transition name="createFeature"><service-call name="mantle.product.ProductServices.create#ProductFeature" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditFeature"/></transition><actions><entity-find entity-name="mantle.product.feature.ProductFeature" list="featureList" cache="false"><search-form-inputs default-order-by="description"/></entity-find></actions><widgets><container-dialog id="NewFeatureDialog" button-text="New Feature"><form-single name="NewFeatureForm" transition="createFeature"><field name="productFeatureTypeEnumId"><default-field title="Feature Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ProductFeatureType"/></widget-template-include></default-field></field><field name="abbrev"><default-field title="Abbreviation"><text-line size="10"/></default-field></field><field name="description"><default-field><text-line/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="FeaturesForm" list="featureList" skip-form="true"><field name="productFeatureId"><header-field title="Feature ID" show-order-by="case-insensitive"><text-find size="15" hide-options="true"/></header-field><default-field><link url="editFeature" text="${productFeatureId}" link-type="anchor"/></default-field></field><field name="description"><header-field show-order-by="case-insensitive"><text-find size="15" hide-options="true"/></header-field><default-field><link url="editFeature" text="${description}" link-type="anchor"/></default-field></field><field name="abbrev"><header-field show-order-by="case-insensitive"><text-find size="8" hide-options="true"/></header-field><default-field><display/></default-field></field><field name="productFeatureTypeEnumId"><header-field title="Feature Type" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ProductFeatureType"/><set field="allowEmpty" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field><default-field><display text=" "/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Catalog/Feature.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Features" default-menu-index="6"><subscreens default-item="FindFeature"/><widgets><subscreens-active/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Catalog/FeatureGroup/EditFeatureGroup.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Feature Group"><parameter name="productFeatureGroupId" required="true"/><transition name="editFeature"><default-response url="../../Feature/EditFeature"/></transition><transition name="editCategory"><default-response url="../../Category/EditCategory"/></transition><transition name="updateFeatureGroup"><service-call name="update#mantle.product.feature.ProductFeatureGroup" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createProductCategoryFeatGrpAppl"><service-call name="create#mantle.product.feature.ProductCategoryFeatGrpAppl" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateProductCategoryFeatGrpAppl"><service-call name="update#mantle.product.feature.ProductCategoryFeatGrpAppl" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createProductFeatureGroupAppl"><actions><if condition="productFeatureId instanceof Collection"><then><iterate list="productFeatureId" entry="curId"><service-call name="create#mantle.product.feature.ProductFeatureGroupAppl" in-map="[productFeatureId:curId, productFeatureGroupId:productFeatureGroupId, fromDate:fromDate]"/></iterate></then><else><service-call name="create#mantle.product.feature.ProductFeatureGroupAppl" in-map="context"/></else></if></actions><default-response url="."/></transition><transition name="updateProductFeatureGroupAppl"><service-call name="update#mantle.product.feature.ProductFeatureGroupAppl" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getCategoryList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><actions><entity-find-one entity-name="mantle.product.feature.ProductFeatureGroup" value-field="featureGroup"/><entity-find entity-name="mantle.product.feature.ProductCategoryAndFeatureGroupAppl" list="pcafgaList"><date-filter/><econdition field-name="productFeatureGroupId"/><order-by field-name="categoryName"/></entity-find><entity-find entity-name="mantle.product.feature.ProductFeatureAndGroupAppl" list="pfagaList"><date-filter/><econdition field-name="productFeatureGroupId"/><order-by field-name="productFeatureTypeEnumId"/><order-by field-name="description"/></entity-find><set field="existingFeatureIdSet" from="pfagaList ? new HashSet(pfagaList.productFeatureId) : null"/></actions><widgets><container-row><row-col lg="6"><form-single name="EditFeatureGroupForm" map="featureGroup" transition="updateFeatureGroup"><field name="productFeatureGroupId"><default-field title="ID"><display/></default-field></field><field name="description"><default-field><text-line size="60"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single><container-box><box-header title="Categories"/><box-toolbar><container-dialog id="AddCategoryDialog" button-text="Apply to Category"><form-single name="AddCategoryForm" transition="createProductCategoryFeatGrpAppl"><field name="productFeatureGroupId"><default-field><hidden/></default-field></field><field name="productCategoryId"><default-field title="Category"><drop-down><dynamic-options transition="getCategoryList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="applTypeEnumId"><default-field title="Appl. Type"><drop-down no-current-selected-key="PfatStandard"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="ProductFeatureApplType"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="fromDate" from="ec.user.nowTimestamp"><default-field><hidden/></default-field></field><field name="submitButton"><default-field title="Apply"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="CategoriesForm" list="pcafgaList" transition="updateProductCategoryFeatGrpAppl"><field name="productFeatureGroupId"><default-field><hidden/></default-field></field><field name="productCategoryId"><default-field><hidden/></default-field></field><field name="categoryName"><default-field title="Category"><link url="editCategory" text="${categoryName} [${pseudoId}]" link-type="anchor"/></default-field></field><field name="productCategoryTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="applTypeEnumId"><default-field title="Appl. Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="fromDate"><default-field><hidden/></default-field></field><field name="thruDate" from="ec.user.nowTimestamp"><default-field><hidden/></default-field></field><field name="submitButton"><default-field title="Remove"><submit/></default-field></field></form-list></box-body></container-box></row-col><row-col lg="6"><container-box><box-header title="Features"/><box-toolbar><container-dialog id="AddFeatureDialog" button-text="Add Feature"><form-single name="AddFeatureForm" transition="createProductFeatureGroupAppl"><field name="productFeatureGroupId"><default-field><hidden/></default-field></field><field name="productFeatureId"><default-field title="Feature"><drop-down allow-multiple="true"><entity-options key="${productFeatureId}" text="${typeDescription} - ${description} [${abbrev ?: productFeatureId}]"><entity-find entity-name="mantle.product.feature.ProductFeatureAndType" limit="200"><econdition field-name="productFeatureId" operator="not-in" from="existingFeatureIdSet" ignore-if-empty="true"/><order-by field-name="typeDescription"/><order-by field-name="categoryName"/></entity-find></entity-options></drop-down></default-field></field><field name="fromDate" from="ec.user.nowTimestamp"><default-field><hidden/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="FeaturesForm" list="pfagaList" transition="updateProductFeatureGroupAppl"><field name="productFeatureGroupId"><default-field><hidden/></default-field></field><field name="productFeatureId"><default-field><hidden/></default-field></field><field name="feature"><default-field><link url="editFeature" link-type="anchor" text="${description} [${abbrev ?: productFeatureId}]"/></default-field></field><field name="productFeatureTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="fromDate"><default-field><hidden/></default-field></field><field name="thruDate" from="ec.user.nowTimestamp"><default-field><hidden/></default-field></field><field name="submitButton"><default-field title="Remove"><submit/></default-field></field></form-list></box-body></container-box></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Catalog/FeatureGroup/FindFeatureGroup.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="editFeatureGroup"><default-response url="../EditFeatureGroup"/></transition><transition name="createFeatureGroup"><service-call name="create#mantle.product.feature.ProductFeatureGroup" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditFeatureGroup"/></transition><actions><entity-find entity-name="mantle.product.feature.ProductFeatureGroup" list="featureGroupList"><search-form-inputs default-order-by="description"/></entity-find></actions><widgets><container-dialog id="NewFeatureGroupDialog" button-text="New Feature Group"><form-single name="NewFeatureGroupForm" transition="createFeatureGroup"><field name="description"><default-field><text-line/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="FeatureGroupsForm" list="featureGroupList" skip-form="true"><field name="productFeatureGroupId"><header-field title="Feature Group ID" show-order-by="case-insensitive"><text-find size="15" hide-options="true"/></header-field><default-field><link url="editFeatureGroup" text="${productFeatureGroupId}" link-type="anchor"/></default-field></field><field name="description"><header-field show-order-by="case-insensitive"><text-find size="15" hide-options="true"/></header-field><default-field><display/></default-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field><default-field><display text=" "/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Catalog/FeatureGroup.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Feature Groups" default-menu-index="7"><subscreens default-item="FindFeatureGroup"/><widgets><subscreens-active/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Catalog.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Catalog" menu-image="/ssstatic/images/Catalog.png"><subscreens default-item="dashboard"/><widgets><subscreens-panel id="CatalogPanel" type="popup"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Customer/CustomerData.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="editCustomer"><default-response url="../EditCustomer"/></transition><transition-include name="getGeoCountryStates" location="component://SimpleScreens/template/party/PartyForms.xml"/><actions><set field="roleTypeId" from="roleTypeId ?: 'Customer'"/></actions><widgets><form-list name="CustomerDataList" list="findPartyList" skip-form="true" select-columns="true" saved-finds="true" header-dialog="true" show-csv-button="true"><entity-find entity-name="mantle.party.FindPartyView" list="findPartyList"><search-form-inputs default-order-by="firstName,lastName,organizationName,pseudoId"/><econdition field-name="disabled" value="N" or-null="true"/><econdition field-name="emailContactMechPurposeId" value="EmailPrimary"/><date-filter from-field-name="emailFromDate" thru-field-name="emailThruDate"/><select-field field-name="partyId,pseudoId,firstName,middleName,lastName,birthDate,organizationName"/></entity-find><field name="partyTypeEnumId"><header-field title="Party Type"><drop-down allow-empty="true"><option key="PtyPerson" text="Person"/><option key="PtyOrganization" text="Organization"/></drop-down></header-field></field><field name="roleTypeId"><header-field title="Role"><drop-down><entity-options key="${roleTypeId}" text="${description}"><entity-find entity-name="mantle.party.RoleType"><order-by field-name="description"/></entity-find></entity-options></drop-down></header-field></field><field name="stateProvinceGeoId"><header-field title="State"><drop-down allow-empty="true"><entity-options key="${toGeoId}" text="${geoName}"><entity-find entity-name="moqui.basic.GeoAssocAndToDetail"><econdition field-name="geoId" value="USA"/><econdition field-name="geoAssocTypeEnumId" value="GAT_REGIONS"/><order-by field-name="geoName"/></entity-find></entity-options></drop-down></header-field></field><field name="pseudoId"><header-field title="ID" show-order-by="true"><text-find size="10" hide-options="true"/></header-field><default-field><link url="editCustomer" text="${pseudoId}" link-type="anchor"/></default-field></field><field name="combinedName"><default-field><link url="editCustomer" text="PartyNameOnlyTemplate" link-type="anchor"/></default-field></field><field name="firstName"><header-field show-order-by="true"><text-find size="30"/></header-field><default-field><display/></default-field></field><field name="middleName"><header-field show-order-by="true"><text-find size="30"/></header-field><default-field><display/></default-field></field><field name="lastName"><header-field show-order-by="true"><text-find size="30"/></header-field><default-field><display/></default-field></field><field name="organizationName"><header-field show-order-by="true"><text-find size="30"/></header-field><default-field><display/></default-field></field><field name="birthDate"><header-field show-order-by="true"><date-find type="date"/></header-field><default-field><display/></default-field></field><field name="birthday"><default-field><display format="MM/dd"/></default-field></field><field name="username"><default-field><display/></default-field></field><field name="partyClassificationId"><header-field title="Class"><drop-down allow-empty="true"><entity-options key="${partyClassificationId}" text="${description}"><entity-find entity-name="mantle.party.PartyClassification"><econdition field-name="classificationTypeEnumId" value="PcltCustomer"/><order-by field-name="description"/></entity-find></entity-options></drop-down></header-field><default-field><display-entity entity-name="mantle.party.PartyClassification"/></default-field></field><field name="emailAddress"><header-field><text-find/></header-field><default-field><display/></default-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field></field><form-list-column><field-ref name="pseudoId"/></form-list-column><form-list-column><field-ref name="firstName"/></form-list-column><form-list-column><field-ref name="lastName"/></form-list-column><form-list-column><field-ref name="organizationName"/></form-list-column><form-list-column><field-ref name="birthday"/></form-list-column><form-list-column><field-ref name="partyClassificationId"/></form-list-column><form-list-column><field-ref name="emailAddress"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Customer/FindCustomer.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="editCustomer"><default-response url="../EditCustomer"/></transition><transition name="findOrder"><default-response url="../../Order/FindOrder"/></transition><transition name="createPerson"><service-call name="mantle.party.PartyServices.create#Person" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditCustomer"/></transition><transition name="createPersonCustomer"><service-call name="mantle.party.PartyServices.create#PersonCustomer" in-map="context + [groupTypeEnumIdList:appUserGroupTypeEnumId]" out-map="context" multi="parameter"/><default-response url="../EditCustomer"/></transition><transition name="createOrganization"><service-call name="mantle.party.PartyServices.create#Organization" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditCustomer"/></transition><transition name="createAccount"><service-call name="mantle.sales.AccountServices.create#Account" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditCustomer"/></transition><transition name="createContact"><service-call name="mantle.sales.AccountServices.create#Contact" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditCustomer"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition-include name="getGeoCountryStates" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition-include name="getPartyClassificationList" location="component://SimpleScreens/template/party/PartyTransitions.xml"/><pre-actions><set field="roleTypeId" value="Customer"/></pre-actions><actions><set field="disabled" from="disabled ?: 'N'"/><service-call name="mantle.party.PartyServices.search#Party" in-map="context" out-map="context"/></actions><widgets><container-dialog id="CreatePersonDialog" button-text="New Person Customer"><form-single name="CreatePersonForm" transition="createPersonCustomer" extends="component://SimpleScreens/screen/SimpleScreens/Party/FindParty.xml#CreatePersonCustForm"><field name="roleTypeId"><default-field><hidden/></default-field></field></form-single></container-dialog><container-dialog id="CreateAccountDialog" button-text="New Sales Account (Organization Customer)"><form-single name="CreateAccountForm" transition="createAccount" extends="component://SimpleScreens/screen/SimpleScreens/Party/FindParty.xml#CreateAccountForm"/></container-dialog><container-dialog id="CreateContactDialog" button-text="New Sales Contact"><form-single name="CreateContactForm" transition="createContact" extends="component://SimpleScreens/screen/SimpleScreens/Party/FindParty.xml#CreateContactForm"/></container-dialog><link url="../CustomerData" text="Customer Data"/><link url="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-query-string-query.html#query-string-syntax" url-type="plain" link-type="anchor" target-window="_blank" text="Search String Reference"/><form-single name="OuterSearchForm" extends="component://SimpleScreens/screen/SimpleScreens/Party/FindParty.xml#OuterSearchForm"/><form-list name="CustomerListForm" list="documentList" skip-form="true" header-dialog="true" extends="component://SimpleScreens/screen/SimpleScreens/Party/FindParty.xml#PartyListForm"><field name="pseudoId"><default-field><link url="editCustomer" text="${pseudoId}" link-type="anchor"/></default-field></field><field name="combinedName"><default-field><link url="editCustomer" text="PartyNameOnlyTemplate" text-map="party" link-type="anchor"/></default-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field><default-field><link url="findOrder" text="Sales Orders" parameter-map="[customerPartyId:partyId]" link-type="anchor"/></default-field></field></form-list><container-row><row-col md="2" style="text-right"><label text="Current Search String" type="strong"/></row-col><row-col><label text="${queryString?:'No Current Search'}"/></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Customer/EditCustomer.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Customer" default-menu-index="1"><parameter name="partyId" required="true"/><transition name="findOrder"><default-response url="//${appRoot}/Order/FindOrder"/></transition><transition name="findShipment"><default-response url="//${appRoot}/Shipment/FindShipment"/></transition><transition name="findRequest"><default-response url="//${appRoot}/Request/FindRequest"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition name="updateParty"><service-call name="mantle.party.PartyServices.update#PartyDetail" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createPartyRole"><service-call name="create#mantle.party.PartyRole" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deletePartyRole"><service-call name="delete#mantle.party.PartyRole" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="setPartyClassification" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty.xml"/><transition-include name="removePartyClassification" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty.xml"/><transition-include name="getPartyClassificationList" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty.xml"/><transition-include name="storePartySetting" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty.xml"/><transition-include name="deletePartySetting" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty.xml"/><transition-include name="getPartySettingList" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty.xml"/><transition name="createPartyIdentification"><service-call name="create#mantle.party.PartyIdentification" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updatePartyIdentification"><service-call name="update#mantle.party.PartyIdentification" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deletePartyIdentification"><parameter name="partyIdTypeEnumId"/><service-call name="delete#mantle.party.PartyIdentification" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createUserAccount"><service-call name="mantle.party.PartyServices.create#PartyUserAccount" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateUserAccount"><service-call name="mantle.party.PartyServices.update#PartyUserAccount" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="enableUserAccount"><service-call name="org.moqui.impl.UserServices.enable#UserAccount" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="disableUserAccount"><service-call name="org.moqui.impl.UserServices.disable#UserAccount" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="resetPassword"><service-call name="org.moqui.impl.UserServices.reset#Password" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createPartyRelationship"><service-call name="create#mantle.party.PartyRelationship" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updatePartyRelationship"><service-call name="update#mantle.party.PartyRelationship" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="addContact"><service-call name="mantle.sales.AccountServices.add#Contact" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createContact"><service-call name="mantle.sales.AccountServices.create#Contact" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="removeContact"><service-call name="mantle.sales.AccountServices.delete#Contact" in-map="[partyRelationshipId:partyRelationshipId]" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updatePaymentMethodInfo"><default-response url="UpdatePaymentMethodInfo"/></transition><transition name="removePaymentMethod"><service-call name="mantle.account.PaymentMethodServices.delete#PaymentMethod" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="editPaymentMethod"><default-response url="../PaymentMethod/EditPaymentMethod"/></transition><transition name="findFinancialAccount"><default-response url="//${appRoot}/Accounting/FinancialAccount/FindFinancialAccount"/></transition><transition name="editFinancialAccount"><default-response url="//${appRoot}/Accounting/FinancialAccount/EditFinancialAccount"/></transition><transition name="storePartyContactMech"><service-call name="mantle.party.ContactServices.store#PartyContactMech" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="removeContactInfo"><service-call name="mantle.party.ContactServices.delete#PartyContactMech" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateContactMechMutable"><service-call name="mantle.party.ContactServices.update#ContactMechMutable" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="validateAddress"><service-call name="mantle.shipment.CarrierServices.validate#PostalAddress" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createContactMechOther"><service-call name="mantle.party.ContactServices.create#ContactMechOther" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updatePartyContactOther"><service-call name="mantle.party.ContactServices.update#PartyContactOther" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getContactMechPurposesByType" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition name="createPartyNote"><service-call name="create#mantle.party.PartyNote" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updatePartyNote"><service-call name="update#mantle.party.PartyNote" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="createContent" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty.xml"/><transition-include name="updateContent" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty.xml"/><transition-include name="downloadContent" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty.xml"/><transition name="receivableStatement"><default-response url="${ec.web.getWebappRootUrl(false, null)}/fop/apps/${appRoot}/Accounting/Invoice/ReceivableStatement" url-type="plain"><parameter name="renderMode" value="xsl-fo"/><parameter name="pageNoLimit" value="true"/><parameter name="toPartyId"/><parameter name="filename" value="Statement-${toPartyId}-${ec.l10n.format(ec.user.nowTimestamp, 'yyyy-MM-dd')}.pdf"/></default-response></transition><subscreens><subscreens-item name="UpdateContactInfo" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty/UpdateContactInfo.xml"/><subscreens-item name="ExpiredContactOther" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty/ExpiredContactOther.xml"/><subscreens-item name="ExpiredPostal" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty/ExpiredPostal.xml"/><subscreens-item name="UpdatePaymentMethodInfo" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty/UpdatePaymentMethodInfo.xml"/><subscreens-item name="FindDuplicates" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty/FindDuplicates.xml"/></subscreens><actions><entity-find-one entity-name="mantle.party.PartyDetail" value-field="party"/><if condition="party == null"><return error="true" message="Customer not found with ID ${partyId}"/></if><entity-find-one entity-name="mantle.party.PartyRole" value-field="customerRole"><field-map field-name="partyId"/><field-map field-name="roleTypeId" value="Customer"/></entity-find-one><if condition="customerRole == null"><return error="true" message="Party ${partyId} is not a Customer"/></if><entity-find entity-name="moqui.security.UserAccount" list="userAccountList"><econdition field-name="partyId"/><econdition field-name="disabled" operator="not-equals" value="Y" or-null="true"/><order-by field-name="userId"/></entity-find><if condition="!userAccountList"><entity-find entity-name="moqui.security.UserAccount" list="userAccountList"><econdition field-name="partyId"/><econdition field-name="disabled" value="Y"/><order-by field-name="userId"/></entity-find></if><set field="userAccount" from="userAccountList ? userAccountList[0] : null"/><entity-find-count entity-name="mantle.request.RequestAndParty" count-field="requestCount"><date-filter/><econdition field-name="partyId"/></entity-find-count><entity-find-count entity-name="mantle.order.OrderPart" count-field="customerOrderPartCount"><econdition field-name="customerPartyId" from="partyId"/></entity-find-count><entity-find-count entity-name="mantle.shipment.Shipment" count-field="toShipmentCount"><econdition field-name="toPartyId" from="partyId"/></entity-find-count><entity-find entity-name="mantle.party.PartyRole" list="partyRoleList"><econdition field-name="partyId"/></entity-find><set field="roleTypeIdList" from="partyRoleList*.roleTypeId"/></actions><widgets><container-row><row-col lg="6"><link url="findRequest" text="Requests" badge="${requestCount}" parameter-map="[partyId:partyId]"/><link url="findOrder" text="Orders" badge="${customerOrderPartCount}" parameter-map="[customerPartyId:partyId]"/><link url="findShipment" text="Shipments To" badge="${toShipmentCount}" parameter-map="[toPartyId:partyId]"/><link url="receivableStatement" text="Statement PDF" parameter-map="[toPartyId:partyId]"/><section-include name="NonUserPerson" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty.xml"/><dynamic-dialog id="FindDuplicatesDialog" button-text="Find Duplicates" transition="FindDuplicates" width="960"/><section-include name="HasDuplicatesSection" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty.xml"/><section-include name="EditPartySection" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty.xml"/><section-include name="RolesSection" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty.xml"/><section-include name="PartyClassificationSection" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty.xml"/><section-include name="PartySettingSection" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty.xml"/><section-include name="PartyIdentificationSection" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty.xml"/><section-include name="UserSecuritySection" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty.xml"/><section-include name="SalesAccountContactSection" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty.xml"/></row-col><row-col lg="6"><section-include name="NotesSection" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty.xml"/><section-include name="ContactInfoSection" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty.xml"/><section-include name="PaymentMethodSection" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty.xml"/><section-include name="FinancialAccountSection" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty.xml"/><section-include name="ContentSection" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty.xml"/></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Customer.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Customers" default-menu-index="12" menu-image="/ssstatic/images/Customer.png"><subscreens default-item="FindCustomer"><subscreens-item name="FinancialInfo" location="component://SimpleScreens/screen/SimpleScreens/Party/FinancialInfo.xml" menu-index="11"/></subscreens><pre-actions><set field="roleTypeId" value="Customer"/></pre-actions><actions><entity-find-one entity-name="mantle.party.PartyDetail" value-field="partyDetail"/></actions><widgets><label text="PartyNameTemplate" text-map="partyDetail" type="strong" condition="partyDetail"/><subscreens-panel id="CustomerPanel" type="tab"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Facility/BoxTypes.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Box Types" default-menu-include="false"><transition name="createBoxType"><service-call name="create#mantle.shipment.ShipmentBoxType" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateBoxType"><service-call name="update#mantle.shipment.ShipmentBoxType" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="BoxTypes.pdf"><default-response url="${ec.web.getWebappRootUrl(false, null)}/fop/apps/${appRoot}/Facility/PrintBoxTypes" url-type="plain"><parameter name="filename" value="BoxTypes.pdf"/></default-response></transition><actions><set field="pageSize" from="pageSize ?: '10'"/></actions><widgets><container-dialog id="AddBoxTypeDialog" button-text="Add Box Type"><form-single name="CreateBoxType" transition="createBoxType"><field name="pseudoId"><default-field title="ID"><text-line size="25"/></default-field></field><field name="description"><default-field><text-line size="40"/></default-field></field><field name="gatewayBoxId"><default-field><text-line size="25"/></default-field></field><field name="boxLength"><default-field title="Length"><text-line size="5"/></default-field></field><field name="boxWidth"><default-field title="Width"><text-line size="5"/></default-field></field><field name="boxHeight"><default-field title="Height"><text-line size="5"/></default-field></field><field name="dimensionUomId"><default-field title="Dimension UOM"><drop-down no-current-selected-key="LEN_in"><entity-options key="${uomId}" text="${description} (${abbreviation})"><entity-find entity-name="moqui.basic.Uom"><econdition field-name="uomTypeEnumId" value="UT_LENGTH_MEASURE"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="boxWeight"><default-field title="Weight"><text-line size="5"/></default-field></field><field name="defaultGrossWeight"><default-field title="Gross Weight"><text-line size="5"/></default-field></field><field name="weightUomId"><default-field title="Weight UOM"><drop-down no-current-selected-key="WT_lb"><entity-options key="${uomId}" text="${description} (${abbreviation})"><entity-find entity-name="moqui.basic.Uom"><econdition field-name="uomTypeEnumId" value="UT_WEIGHT_MEASURE"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="boxCapacity"><default-field title="Capacity"><text-line size="5"/></default-field></field><field name="capacityUomId"><default-field title="Capacity UOM"><drop-down no-current-selected-key="WT_lb"><entity-options key="${uomId}" text="${description} (${abbreviation})"><entity-find entity-name="moqui.basic.Uom"><econdition field-name="uomTypeEnumId" operator="in" value="UT_WEIGHT_MEASURE,UT_VOLUME_DRY_MEAS"/><order-by field-name="uomTypeEnumId,description"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field><submit text="Create"/></default-field></field></form-single></container-dialog><link url="BoxTypes.pdf" text="Box Types PDF"/><form-list name="BoxTypeList" list="boxTypeList" header-dialog="true" select-columns="true" transition="updateBoxType"><entity-find entity-name="mantle.shipment.ShipmentBoxType" list="boxTypeList"><search-form-inputs default-order-by="pseudoId"/></entity-find><field name="shipmentBoxTypeId"><default-field><hidden/></default-field></field><field name="pseudoId"><header-field title="ID" show-order-by="case-insensitive"><text-find hide-options="true"/></header-field><default-field><text-line size="25"/></default-field></field><field name="description"><header-field show-order-by="case-insensitive"><text-find hide-options="true"/></header-field><default-field><text-line size="40"/></default-field></field><field name="gatewayBoxId"><header-field show-order-by="case-insensitive"><text-find hide-options="true"/></header-field><default-field><text-line size="25"/></default-field></field><field name="dimensionUomId"><default-field title="Dimension UOM"><drop-down no-current-selected-key="LEN_in"><entity-options key="${uomId}" text="${description} (${abbreviation})"><entity-find entity-name="moqui.basic.Uom"><econdition field-name="uomTypeEnumId" value="UT_LENGTH_MEASURE"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="boxLength"><header-field title="Length" show-order-by="true"/><default-field><text-line size="5"/></default-field></field><field name="boxWidth"><header-field title="Width" show-order-by="true"/><default-field><text-line size="5"/></default-field></field><field name="boxHeight"><header-field title="Height" show-order-by="true"/><default-field><text-line size="5"/></default-field></field><field name="weightUomId"><default-field title="Weight UOM"><drop-down no-current-selected-key="WT_lb"><entity-options key="${uomId}" text="${description} (${abbreviation})"><entity-find entity-name="moqui.basic.Uom"><econdition field-name="uomTypeEnumId" value="UT_WEIGHT_MEASURE"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="boxWeight"><header-field title="Weight" show-order-by="true"/><default-field><text-line size="5"/></default-field></field><field name="defaultGrossWeight"><header-field title="Gross Weight" show-order-by="true"/><default-field><text-line size="5"/></default-field></field><field name="capacityUomId"><default-field title="Capacity UOM"><drop-down no-current-selected-key="WT_lb"><entity-options key="${uomId}" text="${description} (${abbreviation})"><entity-find entity-name="moqui.basic.Uom"><econdition field-name="uomTypeEnumId" operator="in" value="UT_WEIGHT_MEASURE,UT_VOLUME_DRY_MEAS"/><order-by field-name="uomTypeEnumId,description"/></entity-find></entity-options></drop-down></default-field></field><field name="boxCapacity"><header-field title="Capacity" show-order-by="true"/><default-field><text-line size="5"/></default-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field><default-field><submit text="Update"/></default-field></field><form-list-column><field-ref name="pseudoId"/><field-ref name="description"/><field-ref name="gatewayBoxId"/></form-list-column><form-list-column><field-ref name="dimensionUomId"/><field-ref name="weightUomId"/></form-list-column><form-list-column><field-ref name="boxLength"/><field-ref name="boxWidth"/><field-ref name="boxHeight"/></form-list-column><form-list-column><field-ref name="boxWeight"/><field-ref name="defaultGrossWeight"/></form-list-column><form-list-column><field-ref name="capacityUomId"/><field-ref name="boxCapacity"/></form-list-column><form-list-column><field-ref name="submitButton"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Facility/CarrierShipMethods.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Carrier Shipment Methods" default-menu-include="false"><transition name="createCarrierShipmentMethod"><service-call name="create#mantle.shipment.carrier.CarrierShipmentMethod" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateCarrierShipmentMethod"><service-call name="update#mantle.shipment.carrier.CarrierShipmentMethod" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><set field="pageSize" from="pageSize ?: '20'"/></actions><widgets><container-dialog id="AddCarrierShipmentMethodDialog" button-text="Add Carrier Shipment Method"><form-single name="CreateCarrierShipmentMethod" transition="createCarrierShipmentMethod"><field name="sequenceNum"><default-field title="Sequence"><text-line size="4"/></default-field></field><field name="carrierPartyId"><default-field title="Carrier"><drop-down><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="Carrier"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></default-field></field><field name="shipmentMethodEnumId"><default-field title="Ship Method"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ShipmentMethod"/></widget-template-include></default-field></field><field name="description"><default-field><text-line size="30"/></default-field></field><field name="carrierServiceCode"><default-field title="Carrier Code"><text-line size="15"/></default-field></field><field name="scaCode"><default-field title="SCA Code"><text-line size="10"/></default-field></field><field name="gatewayServiceCode"><default-field title="Gateway Code"><text-line size="35"/></default-field></field><field name="submitButton"><default-field><submit text="Create"/></default-field></field></form-single></container-dialog><form-list name="CarrierShipmentMethodList" list="carrierShipMethList" header-dialog="true" select-columns="true" transition="updateCarrierShipmentMethod" multi="true"><entity-find entity-name="mantle.shipment.carrier.CarrierShipmentMethod" list="carrierShipMethList"><search-form-inputs default-order-by="sequenceNum,carrierPartyId"/></entity-find><field name="sequenceNum"><header-field title="Sequence" show-order-by="true"/><default-field><text-line size="4"/></default-field></field><field name="carrierPartyId"><header-field title="Carrier" show-order-by="true"><drop-down allow-empty="true"><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="Carrier"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></header-field><default-field><display-entity entity-name="mantle.party.PartyDetail" text="${pseudoId}"/></default-field></field><field name="shipmentMethodEnumId"><header-field title="Ship Method" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ShipmentMethod"/><set field="allowMultiple" value="true"/><set field="showNot" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="description"><header-field show-order-by="case-insensitive"><text-find hide-options="true"/></header-field><default-field><text-line size="30"/></default-field></field><field name="carrierServiceCode"><header-field title="Carrier Code" show-order-by="true"><text-find hide-options="true"/></header-field><default-field><text-line size="15"/></default-field></field><field name="scaCode"><header-field title="SCA Code" show-order-by="true"><text-find hide-options="true"/></header-field><default-field><text-line size="10"/></default-field></field><field name="gatewayServiceCode"><header-field title="Gateway Code" show-order-by="true"><text-find hide-options="true"/></header-field><default-field><text-line size="35"/></default-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field><default-field><submit text="Update"/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Facility/FindFacility.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="findFacility"><default-response url="."/></transition><transition name="editFacility"><default-response url="../EditFacility"/></transition><transition name="createFacility"><service-call name="create#mantle.facility.Facility" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditFacility"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><actions><entity-find entity-name="mantle.facility.Facility" list="facilityList"><search-form-inputs default-order-by="facilityName"/></entity-find></actions><widgets><container-dialog id="NewFacilityDialog" button-text="New Facility"><form-single name="NewFacilityForm" transition="createFacility"><field name="pseudoId"><default-field title="ID"><text-line size="15"/></default-field></field><field name="facilityName"><default-field><text-line/></default-field></field><field name="facilityTypeEnumId"><default-field title="Facility Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="FacilityType"/><set field="noCurrentSelectedKey" value="FcTpWarehouse"/></widget-template-include></default-field></field><field name="ownerPartyId"><default-field title="Owner"><drop-down><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><link url="../BoxTypes" text="Box Types"/><link url="../CarrierShipMethods" text="Carrier Ship Methods"/><form-list name="FacilityListForm" list="facilityList" skip-form="true" header-dialog="true" select-columns="true" saved-finds="true" show-csv-button="true"><field name="pseudoId"><header-field title="Facility ID" show-order-by="case-insensitive"><text-find size="15" hide-options="true"/></header-field><default-field><link url="editFacility" text="${pseudoId}" link-type="anchor"/></default-field></field><field name="facilityName"><header-field title="Name" show-order-by="case-insensitive"><text-find size="50" hide-options="true"/></header-field><default-field><link url="editFacility" text="${facilityName}" link-type="anchor"/></default-field></field><field name="facilityTypeEnumId"><header-field title="Type" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="FacilityType"/><set field="allowEmpty" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="ownerPartyId"><header-field title="Owner" show-order-by="true"><drop-down><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></header-field><default-field><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameTemplate"/></default-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field><default-field><display text=" "/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Facility/PrintBoxTypes.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><actions><entity-find entity-name="mantle.shipment.ShipmentBoxTypeDetail" list="boxTypeList"><order-by field-name="pseudoId"/></entity-find></actions><widgets><render-mode><text type="xsl-fo" location="component://SimpleScreens/template/shipment/ShipmentBoxTypes.xsl-fo.ftl" template="true" encode="false" no-boundary-comment="true"/></render-mode></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Facility/EditFacility.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Facility" default-menu-index="1"><parameter name="facilityId" required="true"/><transition name="editFacility"><default-response url="."/></transition><transition name="updateFacility"><service-call name="mantle.facility.FacilityServices.update#Facility" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="validateAddress"><service-call name="mantle.shipment.CarrierServices.validate#PostalAddress" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createFacilityNote"><service-call name="mantle.facility.FacilityServices.create#FacilityNote" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateFacilityNote"><service-call name="update#mantle.facility.FacilityNote" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createFacilityBoxType"><service-call name="create#mantle.facility.FacilityBoxType" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteFacilityBoxType"><service-call name="delete#mantle.facility.FacilityBoxType" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createFacilityLocationType"><service-call name="create#mantle.facility.FacilityLocationType" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateFacilityLocationType"><service-call name="update#mantle.facility.FacilityLocationType" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteFacilityLocationType"><service-call name="delete#mantle.facility.FacilityLocationType" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition-include name="getGeoStateCounties" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition-include name="getGeoCountryStates" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition-include name="getFacilityList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><actions><service-call name="mantle.facility.FacilityServices.get#Facility" in-map="context" out-map="facility" out-map-add-to-existing="false"/><set field="contactInfo" from="facility.contactInfo"/></actions><widgets><container-row><row-col lg="7"><link url="validateAddress" text="Validate Address" parameter-map="[facilityId:facilityId, contactMechId:contactInfo.postalContactMechId]" condition="contactInfo.postalContactMech && (!contactInfo.postalContactMech.trustLevelEnumId || contactInfo.postalContactMech?.trustLevelEnumId == 'CmtlNew')"/><form-single name="EditFacilityForm" map="facility" transition="updateFacility"><field name="facilityId"><default-field><hidden/></default-field></field><field name="pseudoId"><default-field title="ID"><text-line size="15"/></default-field></field><field name="facilityName"><default-field title="Name"><text-line size="50"/></default-field></field><field name="facilityTypeEnumId"><default-field title="Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="FacilityType"/><set field="noCurrentSelectedKey" value="FcTpWarehouse"/></widget-template-include></default-field></field><field name="ownerPartyId"><default-field title="Owner"><drop-down><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="parentFacilityId"><default-field title="Parent Facility"><drop-down allow-empty="true"><dynamic-options transition="getFacilityList" server-search="true" min-length="0" parameter-map="[parentFacilityId:null, facilityTypeEnumId:null, ownerPartyId:ownerPartyId]"/></drop-down><link url="editFacility" text="FacilityNameTemplate" entity-name="mantle.facility.Facility" link-type="anchor" condition="parentFacilityId" parameter-map="[facilityId:parentFacilityId]"/></default-field></field><field name="openedDate"><default-field title="Opened"><date-time type="date"/></default-field></field><field name="closedDate"><default-field title="Closed"><date-time type="date"/></default-field></field><field name="facilitySize"><default-field title="" tooltip="Facility Size"><text-line size="10"/></default-field></field><field name="facilitySizeUomId"><default-field title="" tooltip="Size UOM"><drop-down allow-empty="true"><entity-options key="${uomId}" text="${description}"><entity-find entity-name="moqui.basic.Uom"><econdition field-name="uomTypeEnumId" value="UT_AREA_MEASURE"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="assetAllowOtherOwner"><conditional-field title="Asset Allow Other Owner" condition="facilityTypeEnumId in ['FcTpWarehouse', 'FcTpRetailStore']" tooltip="If Y don't filter by asset owner when reserving inventory"><drop-down allow-empty="true"><option key="Y"/><option key="N"/></drop-down></conditional-field></field><field name="assetAllowIssueOverQoh"><conditional-field title="Asset Allow Issue Over QOH" condition="facilityTypeEnumId in ['FcTpWarehouse', 'FcTpRetailStore']" tooltip="If Y do automatic physical inventory to get QOH back to zero after issuance, otherwise error on pack/issue if QOH not sufficient"><drop-down allow-empty="true"><option key="Y"/><option key="N"/></drop-down></conditional-field></field><field name="assetInventoryLocRequire"><conditional-field title="Require Inventory Location" condition="facilityTypeEnumId in ['FcTpWarehouse', 'FcTpRetailStore']" tooltip="If Y a Location must be specified for all Inventory type Assets on receive and move"><drop-down allow-empty="true"><option key="Y"/><option key="N"/></drop-down></conditional-field></field><field name="defaultDaysToShip"><conditional-field title="Default Days to Ship" condition="facilityTypeEnumId in ['FcTpWarehouse', 'FcTpRetailStore']"><text-line size="5"/></conditional-field></field><field name="toName"><default-field><text-line size="50"/></default-field></field><field name="attnName"><default-field><text-line size="50"/></default-field></field><field name="address1"><default-field title="Address 1"><text-line size="50"/></default-field></field><field name="address2"><default-field title="Address 2"><text-line size="50"/></default-field></field><field name="city"><default-field title="" tooltip="City"><text-line size="30"/></default-field></field><field name="postalCode"><default-field title="" tooltip="Zip/Postal Code"><text-line size="8"/></default-field></field><field name="postalCodeExt"><default-field title="" tooltip="Zip/Postal Code Extension"><text-line size="4"/></default-field></field><field name="countryGeoId"><default-field title=""><drop-down no-current-selected-key="USA"><entity-options key="${geoId}" text="${geoName}"><entity-find entity-name="moqui.basic.Geo" list="geoList"><econdition field-name="geoTypeEnumId" value="GEOT_COUNTRY"/><order-by field-name="geoName"/></entity-find></entity-options></drop-down></default-field></field><field name="stateProvinceGeoId"><default-field title=""><drop-down><dynamic-options transition="getGeoCountryStates" value-field="geoId" label-field="label"><depends-on field="countryGeoId"/></dynamic-options></drop-down></default-field></field><field name="addressTrust"><default-field><display text="${contactInfo.postalTrustLevelEnum?.description ?: 'New'} ${contactInfo.postalContactMech?.validateMessage?:''}"/></default-field></field><field name="latitude"><default-field title="" tooltip="Latitude"><text-line size="15"/></default-field></field><field name="longitude"><default-field title="" tooltip="Longitude"><text-line size="15"/></default-field></field><field name="countryCode"><default-field title="" tooltip="Country Code"><text-line size="3"/></default-field></field><field name="areaCode"><default-field title="" tooltip="Area Code"><text-line size="4"/></default-field></field><field name="contactNumber"><default-field title="" tooltip="Contact Number"><text-line size="10"/></default-field></field><field name="emailAddress"><default-field><text-line size="60"/></default-field></field><field name="description"><default-field><text-area cols="60" rows="4"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field-layout><fields-not-referenced/><field-row><field-ref name="openedDate"/><field-ref name="closedDate"/></field-row><field-row-big title="Size/UOM"><field-ref name="facilitySize"/><field-ref name="facilitySizeUomId"/></field-row-big><field-row><field-ref name="assetAllowIssueOverQoh"/><field-ref name="assetAllowOtherOwner"/></field-row><field-row><field-ref name="assetInventoryLocRequire"/><field-ref name="defaultDaysToShip"/></field-row><field-ref name="toName"/><field-ref name="attnName"/><field-ref name="address1"/><field-ref name="address2"/><field-row-big title="City/Zip"><field-ref name="city"/><field-ref name="postalCode"/><field-ref name="postalCodeExt"/></field-row-big><field-row-big title="Country/State"><field-ref name="countryGeoId"/><field-ref name="stateProvinceGeoId"/></field-row-big><field-ref name="addressTrust"/><field-row-big title="Latitude / Longitude"><field-ref name="latitude"/><field-ref name="longitude"/></field-row-big><field-row-big title="Phone"><field-ref name="countryCode"/><field-ref name="areaCode"/><field-ref name="contactNumber"/></field-row-big><field-ref name="emailAddress"/><field-ref name="description"/><field-ref name="submitButton"/></field-layout></form-single></row-col><row-col lg="5"><section name="ChildSection"><actions><entity-find entity-name="mantle.facility.Facility" list="childFacilityList"><econdition field-name="parentFacilityId" from="facilityId"/><order-by field-name="facilityName"/></entity-find></actions><widgets><container-box><box-header title="Child Facilities"/><box-body-nopad><form-list name="ChildListForm" list="childFacilityList" skip-form="true"><field name="facilityName"><default-field><link url="editFacility" text="FacilityNameTemplate" link-type="anchor"/></default-field></field><field name="facilityTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field></form-list></box-body-nopad></container-box></widgets></section><section name="NotesSection"><actions><entity-find entity-name="mantle.facility.FacilityNote" list="facilityNoteList"><econdition field-name="facilityId"/><order-by field-name="-noteDate"/></entity-find></actions><widgets><container-box><box-header title="Notes"/><box-toolbar><container-dialog id="NewNoteDialog" button-text="Add Note"><form-single name="NewNoteForm" transition="createFacilityNote"><field name="facilityId"><default-field><hidden/></default-field></field><field name="noteText"><default-field title="Note"><text-area cols="60" rows="6"/></default-field></field><field name="submitButton"><default-field title="Add Note"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><section-iterate name="NoteIterateSection" list="facilityNoteList" entry="facilityNote"><actions><entity-find-one entity-name="mantle.party.PersonWithUserAccount" value-field="paua"><field-map field-name="userId" from="facilityNote.userId"/></entity-find-one></actions><widgets><label text="By ${paua?.firstName?:''} ${paua?.lastName?:''} (${paua?.username ?: facilityNote.userId}) at ${ec.l10n.format(facilityNote.noteDate, 'yyyy-MM-dd HH:mm')}" type="strong"/><section name="UpdateNoteSection" condition="facilityNote.userId == ec.user.userId"><widgets><container-dialog id="UpdateNoteContainer" button-text="Edit Note"><form-single name="UpdateNoteForm" transition="updateFacilityNote" map="facilityNote"><field name="facilityId"><default-field><hidden/></default-field></field><field name="noteDate"><default-field><hidden/></default-field></field><field name="noteText"><default-field title="Note"><text-area cols="60" rows="6"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></container-dialog></widgets></section><label text="${facilityNote.noteText}" type="p"/></widgets></section-iterate></box-body></container-box></widgets></section><section name="BoxTypesSection"><widgets><container-box><box-header title="Box Types"/><box-toolbar><container-dialog id="AddBoxTypeDialog" button-text="Add Box Type"><form-single name="AddBoxTypeForm" transition="createFacilityBoxType"><field name="facilityId"><default-field><hidden/></default-field></field><field name="shipmentBoxTypeId"><default-field title="Box Type"><drop-down><entity-options key="${shipmentBoxTypeId}" text="${description}"><entity-find entity-name="mantle.shipment.ShipmentBoxType"><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Add Box Type"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body-nopad><form-list name="BoxTypesForm" list="boxTypeList" skip-form="true" skip-header="true"><entity-find entity-name="mantle.facility.FacilityBoxTypeDetail" list="boxTypeList"><econdition field-name="facilityId"/><order-by field-name="description"/></entity-find><field name="pseudoId"><default-field title="ID"><display/></default-field></field><field name="description"><default-field><display/></default-field></field><field name="removeButton"><default-field title=""><link url="deleteFacilityBoxType" text=" " icon="fa fa-trash" confirmation="Remove box type from facility?"/></default-field></field></form-list></box-body-nopad></container-box></widgets></section><section name="LocationTypesSection"><widgets><container-box><box-header title="Location Types"/><box-toolbar><container-dialog id="AddLocationTypeDialog" button-text="Add Location Type"><form-single name="AddLocationTypeForm" transition="createFacilityLocationType"><field name="facilityId"><default-field><hidden/></default-field></field><field name="locationTypeEnumId"><default-field title="Location Type"><drop-down><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="FacilityLocationType"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="autoStatusId"><default-field title="Auto Status"><drop-down allow-empty="true"><entity-options key="${statusId}" text="${description}"><entity-find entity-name="moqui.basic.StatusItem"><econdition field-name="statusTypeId" value="Asset"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Add Location Type"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body-nopad><form-list name="LocationTypesForm" list="locationTypeList" transition="updateFacilityLocationType" skip-header="true"><entity-find entity-name="mantle.facility.FacilityLocationType" list="locationTypeList"><econdition field-name="facilityId"/><order-by field-name="locationTypeEnumId"/></entity-find><field name="facilityId"><default-field><hidden/></default-field></field><field name="locationTypeEnumId"><default-field title="Location Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="autoStatusId"><default-field title="Auto Status"><drop-down allow-empty="true"><entity-options key="${statusId}" text="${description}"><entity-find entity-name="moqui.basic.StatusItem"><econdition field-name="statusTypeId" value="Asset"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field name="removeButton"><default-field title=""><link url="deleteFacilityLocationType" text=" " icon="fa fa-trash" confirmation="Remove location type from facility?"/></default-field></field></form-list></box-body-nopad></container-box></widgets></section></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Facility/EditFacilityLocations.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Locations" default-menu-index="2"><parameter name="facilityId" required="true"/><transition name="findAsset"><default-response url="//${appRoot}/Asset/FindAsset"/></transition><transition name="createFacilityLocation"><service-call name="mantle.facility.FacilityServices.create#FacilityLocation" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateFacilityLocation"><service-call name="update#mantle.facility.FacilityLocation" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><entity-find entity-name="mantle.facility.FacilityLocation" list="locationList"><search-form-inputs default-order-by="locationSeqId"/><econdition field-name="facilityId"/></entity-find></actions><widgets><container-dialog id="NewLocationDialog" button-text="New Location"><form-single name="NewLocationForm" transition="createFacilityLocation"><field name="facilityId"><default-field title="Facility"><display-entity entity-name="mantle.facility.Facility" text="FacilityNameTemplate"/></default-field></field><field name="locationSeqId"><default-field title="Location ID" tooltip="Leave empty to set to Area+Aisle+Section+Level+Position"><text-line size="30"/></default-field></field><field name="locationTypeEnumId"><default-field title="Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="FacilityLocationType"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="description"><default-field title="Name"><text-line size="20"/></default-field></field><field name="areaId"><default-field title="Area"><text-line size="8"/></default-field></field><field name="aisleId"><default-field title="Aisle"><text-line size="8"/></default-field></field><field name="sectionId"><default-field title="Section"><text-line size="8"/></default-field></field><field name="levelId"><default-field title="Level"><text-line size="8"/></default-field></field><field name="positionId"><default-field title="Position"><text-line size="8"/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="LocationsForm" list="locationList" transition="updateFacilityLocation" header-dialog="true"><field name="facilityId"><header-field><hidden/></header-field><default-field><hidden/></default-field></field><field name="inventory"><default-field title=""><link url="findAsset" text="Inventory" link-type="anchor-button" parameter-map="[facilityId:facilityId, locationSeqId:locationSeqId]"/></default-field></field><field name="locationSeqId"><header-field title="ID" show-order-by="true"><text-find size="6" hide-options="true"/></header-field><default-field><display/></default-field></field><field name="locationTypeEnumId"><header-field title="Type" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="FacilityLocationType"/><set field="allowEmpty" value="true"/><set field="style" value=" "/></widget-template-include></header-field><default-field><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="FacilityLocationType"/><set field="allowEmpty" value="true"/><set field="style" value=" "/></widget-template-include></default-field></field><field name="description"><header-field title="Name" show-order-by="true"><text-find size="15" hide-options="true"/></header-field><default-field><text-line size="20"/></default-field></field><field name="sequenceNum"><header-field title="Seq #" show-order-by="true"><text-find size="6" hide-options="true"/></header-field><default-field><text-line size="4"/></default-field></field><field name="areaId"><header-field title="Area" show-order-by="true"><text-find size="6" hide-options="true"/></header-field><default-field><text-line size="3"/></default-field></field><field name="aisleId"><header-field title="Aisle" show-order-by="true"><text-find size="6" hide-options="true"/></header-field><default-field><text-line size="3"/></default-field></field><field name="sectionId"><header-field title="Section" show-order-by="true"><text-find size="6" hide-options="true"/></header-field><default-field><text-line size="3"/></default-field></field><field name="levelId"><header-field title="Level" show-order-by="true"><text-find size="6" hide-options="true"/></header-field><default-field><text-line size="3"/></default-field></field><field name="positionId"><header-field title="Position" show-order-by="true"><text-find size="6" hide-options="true"/></header-field><default-field><text-line size="3"/></default-field></field><field name="capacity"><header-field show-order-by="true"/><default-field><text-line size="6"/></default-field></field><field name="capacityUomId"><header-field title="Capacity UOM" show-order-by="true"/><default-field><drop-down allow-empty="true"><entity-options key="${uomId}" text="${typeDescription} - ${description}"><entity-find entity-name="moqui.basic.UomAndType"><econdition field-name="uomId" value="OTH_ea"/></entity-find></entity-options><entity-options key="${uomId}" text="${typeDescription} - ${description}"><entity-find entity-name="moqui.basic.UomAndType"><econdition field-name="uomTypeEnumId" operator="in" value="UT_AREA_MEASURE,UT_VOLUME_DRY_MEAS,UT_VOLUME_LIQ_MEAS,UT_WEIGHT_MEASURE"/><order-by field-name="typeDescription,description"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field><default-field title="Update"><submit/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Facility/FacilityCalendar.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Calendar" default-menu-index="3"><parameter name="facilityId" required="true"/><transition name="eventDetail"><default-response url="."/></transition><transition name="getCalendarEvents"><service-call name="mantle.work.EventServices.get#FullCalendarData" web-send-json-response="eventList" in-map="context + [urlGString:(sri.buildUrl('eventDetail').url + '?workEffortId=${workEffort.workEffortId}')]" out-map="context" multi="parameter"/><default-response type="none"/></transition><actions><entity-find-one entity-name="mantle.facility.Facility" value-field="facility"/></actions><widgets><render-mode><text type="html,vuet,qvt"><![CDATA[<div id="calendar"></div><script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.1.0/fullcalendar.min.js" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.1.0/locale-all.js" type="text/javascript"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.1.0/fullcalendar.min.css" type="text/css"/><script>
    $('#calendar').fullCalendar({ timezone: false, defaultView: 'agendaWeek',
        header: { left: 'prev,next today', center: 'title', right: 'month,agendaWeek,agendaDay' },
        eventSources: [ { url: "${sri.buildUrl('getCalendarEvents').url}", type: 'POST', data: { moquiSessionToken:'${ec.web.sessionToken}', facilityId: '${facilityId}' } } ]
    });
                </script>]]></text></render-mode></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Facility/EditFacilityProducts.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Products" default-menu-index="4"><parameter name="facilityId" required="true" from="facilityId ?: facilityId_0"/><transition name="createProductFacility"><service-call name="create#mantle.facility.ProductFacility" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateProductFacility"><service-call name="update#mantle.facility.ProductFacility" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="editProduct"><default-response url="//${appRoot}/Product/EditProduct"/></transition><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><widgets><container-dialog id="AddProductDialog" button-text="Add Product"><form-single name="AddProductForm" transition="createProductFacility"><field name="facilityId"><default-field title="Facility"><display-entity entity-name="mantle.facility.Facility" text="FacilityNameTemplate"/></default-field></field><field name="productId"><default-field title="Product"><drop-down><dynamic-options transition="getProductList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="minimumStock"><default-field><text-line size="10"/></default-field></field><field name="reorderQuantity"><default-field><text-line size="10"/></default-field></field><field name="daysToShip"><default-field><text-line size="4"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog><form-list name="ProductList" list="productList" transition="updateProductFacility" header-dialog="true" multi="true"><entity-find entity-name="mantle.facility.ProductFacility" list="productList"><econdition field-name="facilityId"/></entity-find><field name="facilityId"><header-field><hidden/></header-field><default-field><hidden/></default-field></field><field name="productId"><header-field title="Product"><drop-down><dynamic-options transition="getProductList" server-search="true" min-length="0"/></drop-down></header-field><default-field><display text=" "/><link url="editProduct" text="ProductNameTemplate" entity-name="mantle.product.Product" link-type="anchor"/></default-field></field><field name="minimumStock"><default-field><text-line size="10"/></default-field></field><field name="reorderQuantity"><default-field><text-line size="10"/></default-field></field><field name="daysToShip"><default-field><text-line size="4"/></default-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field><default-field title="Update"><submit/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Facility.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-index="10" menu-image="/ssstatic/images/Facility.png"><subscreens default-item="FindFacility"/><actions><entity-find-one entity-name="mantle.facility.Facility" value-field="facility"/></actions><widgets><label text="FacilityNameTemplate" text-map="facility" type="strong" condition="facility"/><subscreens-panel id="FacilityPanel" type="tab"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/HumanRes/dashboard.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="HR Dashboard" default-menu-index="1"><widgets><link url="//${appRoot}/Party/FindParty" text="Employees" parameter-map="[roleTypeId:'Employee']"/><link url="../EditRateAmounts" text="Labor Rates"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/HumanRes/EditRateAmounts.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Rates" default-menu-index="7" menu-image="/hmstatic/images/rates-internet16.png"><transition name="createRateAmount"><service-call name="create#mantle.humanres.rate.RateAmount" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateRateAmount"><service-call name="mantle.humanres.RateServices.update#RateAmount" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteRateAmount"><service-call name="delete#mantle.humanres.rate.RateAmount" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="getPersonList"><actions><entity-find entity-name="mantle.party.PersonAndUserAccount" list="pauList" limit="20"><econditions combine="or"><econdition field-name="firstName" operator="like" value="%${term}%" ignore-case="true"/><econdition field-name="lastName" operator="like" value="%${term}%" ignore-case="true"/><econdition field-name="username" operator="like" value="%${term}%" ignore-case="true"/></econditions><order-by field-name="^firstName"/><order-by field-name="^lastName"/><order-by field-name="^username"/></entity-find><script><![CDATA[def outList = []
                for (def pau in pauList)
                    outList.add([value:pau.partyId, label:"${pau.firstName} ${pau.lastName} (${pau.username})".toString()])
                ec.web.sendJsonResponse(outList)]]></script></actions><default-response type="none"/></transition><actions><entity-find entity-name="mantle.humanres.rate.RateAmount" list="rateAmountList"><search-form-inputs default-order-by="rateTypeEnumId,ratePurposeEnumId"/></entity-find><entity-find entity-name="mantle.ledger.config.PartyAcctgPreference" list="partyAcctgPreferenceList"/><set field="currencyUomIdList" from="[]"/><iterate list="partyAcctgPreferenceList" entry="partyAcctgPreference"><script><![CDATA[currencyUomIdList.add(partyAcctgPreference.baseCurrencyUomId)]]></script></iterate></actions><widgets><container-dialog id="AddRateAmountDialog" button-text="Add Rate Amount" width="700"><form-single name="CreateRateAmount" transition="createRateAmount"><field name="rateAmountId"><default-field><hidden/></default-field></field><field name="timePeriodUomId"><default-field><hidden default-value="TF_hr"/></default-field></field><field name="rateTypeEnumId"><default-field title="Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="RateType"/><set field="noCurrentSelectedKey" value="RatpStandard"/></widget-template-include></default-field></field><field name="ratePurposeEnumId"><default-field title="Purpose"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="RatePurpose"/></widget-template-include></default-field></field><field name="workEffortId"><default-field title="Project"><drop-down allow-empty="true"><entity-options key="${workEffortId}" text="${workEffortId} - ${workEffortName}"><entity-find entity-name="mantle.work.effort.WorkEffort"><econdition field-name="workEffortTypeEnumId" value="WetProject"/><order-by field-name="workEffortId"/></entity-find></entity-options></drop-down></default-field></field><field name="partyId"><default-field title="Person"><drop-down><dynamic-options transition="getPersonList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="emplPositionClassId"><default-field title="Position Class"><drop-down allow-empty="true"><entity-options key="${emplPositionClassId}" text="${title}"><entity-find entity-name="mantle.humanres.position.EmplPositionClass"><order-by field-name="title"/></entity-find></entity-options></drop-down></default-field></field><field name="workTypeEnumId"><default-field title="Work Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="WorkType"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="fromDate"><default-field><date-time/></default-field></field><field name="thruDate"><default-field><date-time/></default-field></field><field name="rateAmount"><default-field><text-line size="8"/></default-field></field><field name="rateCurrencyUomId"><default-field title="Currency"><drop-down><list-options list="currencyUomIdList"/></drop-down></default-field></field><field name="submitButton"><default-field title="Create Rate Amount"><submit/></default-field></field></form-single></container-dialog><form-list name="EditRateAmounts" list="rateAmountList" transition="updateRateAmount" multi="true"><field name="rateAmountId"><default-field><hidden/></default-field></field><field name="timePeriodUomId"><default-field><hidden default-value="TF_hr"/></default-field></field><field name="rateTypeEnumId"><header-field title="Type" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="RateType"/><set field="allowEmpty" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration" key-field-name="enumId"/></default-field></field><field name="ratePurposeEnumId"><header-field title="Purpose" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="RatePurpose"/><set field="allowEmpty" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration" key-field-name="enumId"/></default-field></field><field name="workEffortId"><header-field title="Project" show-order-by="true"><drop-down allow-empty="true"><entity-options key="${workEffortId}" text="${workEffortId}"><entity-find entity-name="mantle.work.effort.WorkEffort"><econdition field-name="workEffortTypeEnumId" value="WetProject"/><order-by field-name="workEffortId"/></entity-find></entity-options></drop-down></header-field><default-field><display-entity entity-name="mantle.work.effort.WorkEffort" text="${workEffortId} - ${workEffortName}"/></default-field></field><field name="partyId"><header-field title="Party"><drop-down><dynamic-options transition="getPersonList" server-search="true" min-length="2"/></drop-down></header-field><default-field><display-entity entity-name="mantle.party.PartyDetail" text="${organizationName?:''} ${firstName?:''} ${lastName?:''} [${partyId}]"/></default-field></field><field name="emplPositionClassId"><header-field title="Position Class" show-order-by="true"><drop-down allow-empty="true"><entity-options key="${emplPositionClassId}" text="${title}"><entity-find entity-name="mantle.humanres.position.EmplPositionClass"><order-by field-name="title"/></entity-find></entity-options></drop-down></header-field><default-field><display-entity entity-name="mantle.humanres.position.EmplPositionClass" text="${title}"/></default-field></field><field name="workTypeEnumId"><header-field title="Work Type" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="WorkType"/><set field="allowEmpty" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="fromDate"><header-field show-order-by="true"/><default-field><date-time/></default-field></field><field name="thruDate"><header-field show-order-by="true"/><default-field><date-time/></default-field></field><field name="rateAmount"><header-field><range-find size="6"/></header-field><default-field><text-line size="8"/></default-field></field><field name="rateCurrencyUomId"><header-field title="Currency"><drop-down allow-empty="true"><list-options list="currencyUomIdList"/></drop-down></header-field><default-field><display-entity entity-name="moqui.basic.Uom" key-field-name="uomId" text="${description}"/></default-field></field><field name="findButton"><header-field title="Find"><submit/></header-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><form-list-column><field-ref name="rateTypeEnumId"/><field-ref name="ratePurposeEnumId"/></form-list-column><form-list-column><field-ref name="workEffortId"/><field-ref name="partyId"/></form-list-column><form-list-column><field-ref name="emplPositionClassId"/><field-ref name="workTypeEnumId"/></form-list-column><form-list-column><field-ref name="fromDate"/><field-ref name="thruDate"/></form-list-column><form-list-column><field-ref name="rateAmount"/></form-list-column><form-list-column><field-ref name="rateCurrencyUomId"/></form-list-column><form-list-column><field-ref name="findButton"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/HumanRes.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Human Resources" default-menu-index="25" menu-image="fa fa-user-plus" menu-image-type="icon"><subscreens default-item="dashboard"/><widgets><subscreens-panel id="HumanResPanel" type="popup"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Manufacturing/dashboard.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Dashboard" default-menu-index="1"><widgets><link url="../Run" text="Production Runs"/><container><link text="Inventory Assets" url="//${appRoot}/Asset/Asset/FindSummary" parameter-map="[assetTypeEnumId:'AstTpInventory']"/><link text="Equipment Assets" url="//${appRoot}/Asset/Asset/FindAsset" parameter-map="[assetTypeEnumId:'AstTpEquipment']"/></container></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Manufacturing/Run/FindRun.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Production Runs" default-menu-include="false"><parameter name="parentFacilityId"/><transition name="createProductionRun"><service-call name="mantle.work.ManufacturingServices.create#ProductionRun" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditRun"/></transition><transition name="runDetail"><default-response url="../EditRun"/></transition><transition name="editFacility"><default-response url="//${appRoot}/Facility/EditFacility"/></transition><transition name="editProduct"><default-response url="//${appRoot}/Catalog/Product/EditProduct"/></transition><transition-include name="getFacilityList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getProductAmount" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><actions><if condition="parentFacilityId"><entity-find-one entity-name="mantle.facility.Facility" value-field="warehouseFacility"><field-map field-name="facilityId" from="parentFacilityId"/></entity-find-one></if></actions><widgets><container-box><box-header title="Runs"/><box-toolbar><container-dialog id="NewRunContainer" button-text="New Production Run"><label text="Warehouse: ${warehouseFacility?.facilityName ?: ''}" condition="warehouseFacility" type="strong"/><form-single name="NewRunForm" transition="createProductionRun"><field name="workEffortName"><default-field title="Name"><text-line size="60"/></default-field></field><field name="facilityId"><default-field title="WH/Line"><drop-down allow-empty="true"><dynamic-options transition="getFacilityList" server-search="true" min-length="0" parameter-map="[facilityTypeEnumId:'FcTpLine,FcTpPlant,FcTpWarehouse', parentFacilityId:parentFacilityId]"/></drop-down></default-field></field><field name="estimatedStartDate"><default-field title="Run Date"><date-time/></default-field></field><field name="estimatedWorkDuration"><default-field title="Est. Hours"><text-line size="8"/></default-field></field><field name="produceProductId"><default-field title="Product to Produce"><drop-down allow-empty="true"><dynamic-options transition="getProductList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="produceEstimatedQuantity"><default-field title="Est. Quantity"><text-line size="10"/></default-field></field><field name="produceEstimatedAmount"><default-field title=""><display dynamic-transition="getProductAmount"><depends-on field="produceProductId" parameter="productId"/></display></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body-nopad><form-list name="RunList" list="runList" skip-form="true" header-dialog="true" saved-finds="true" select-columns="true"><entity-find entity-name="mantle.work.effort.WorkEffortProductionRunFind" list="runList" distinct="true"><search-form-inputs default-order-by="estimatedStartDate,workEffortId"><default-parameters statusId="WeInPlanning,WeApproved,WeInProgress,WeOnHold" statusId_op="in"/></search-form-inputs><econdition field-name="purposeEnumId" value="WepProductionRun"/><econdition field-name="consumeTypeEnumId" value="WeptConsume" ignore="!consumeProductId"/><econdition field-name="produceTypeEnumId" value="WeptProduce" ignore="!produceProductId"/><select-field field-name="workEffortName"/></entity-find><row-actions><entity-find entity-name="mantle.work.effort.WorkEffortProductDetail" list="allProdList"><date-filter/><econdition field-name="workEffortId"/><order-by field-name="pseudoId,productName"/></entity-find><filter-map-list list="allProdList" to-list="consumeList"><field-map field-name="typeEnumId" value="WeptConsume"/></filter-map-list><order-map-list list="consumeList"><order-by field-name="pseudoId"/></order-map-list><filter-map-list list="allProdList" to-list="produceList"><field-map field-name="typeEnumId" value="WeptProduce"/></filter-map-list><order-map-list list="produceList"><order-by field-name="pseudoId"/></order-map-list></row-actions><field name="workEffortId"><header-field title="Run ID" show-order-by="case-insensitive"><text-find size="10" hide-options="true"/></header-field><default-field><link url="runDetail" text="WorkEffortNameTemplate" link-type="anchor"/></default-field></field><field name="facilityId"><header-field title="WH/Line" show-order-by="true"><drop-down allow-empty="true"><dynamic-options transition="getFacilityList" server-search="true" min-length="0" parameter-map="[facilityTypeEnumId:'FcTpLine,FcTpPlant,FcTpWarehouse']"/></drop-down></header-field><default-field><link url="editFacility" text="FacilityNameTemplate" entity-name="mantle.facility.Facility" link-type="anchor"/></default-field></field><field name="statusId"><header-field title="Status" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="WorkEffort"/><set field="allowEmpty" value="true"/><set field="allowMultiple" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="estimatedStartDate"><header-field title="Start Date" show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="produceProductId"><header-field title="Produce"><drop-down allow-empty="true"><dynamic-options transition="getProductList" server-search="true" min-length="0"/></drop-down></header-field><default-field><section-iterate name="ProduceList" list="produceList" entry="product"><widgets><link url="editProduct" text="${product.pseudoId}" link-type="anchor" parameter-map="[productId:product.productId]"/><label text="${product.productName}" type="p" style="no-margin"/><label text="${ec.l10n.format(product.estimatedQuantity, null)} ${ec.resource.expand('ProductAmountNameTemplate', '', product)}" type="p"/></widgets></section-iterate></default-field></field><field name="consumeProductId"><header-field title="Consume"><drop-down allow-empty="true"><dynamic-options transition="getProductList" server-search="true" min-length="0"/></drop-down></header-field><default-field><section-iterate name="ConsumeList" list="consumeList" entry="product"><widgets><link url="editProduct" text="${product.pseudoId}" link-type="anchor" parameter-map="[productId:product.productId]"/><label text="${product.productName}" type="p" style="no-margin"/><label text="${ec.l10n.format(product.estimatedQuantity, null)} ${ec.resource.expand('ProductAmountNameTemplate', '', product)}" type="p"/></widgets></section-iterate></default-field></field><field name="findButton"><header-field title="Find"><submit/></header-field></field></form-list></box-body-nopad></container-box></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Manufacturing/Run/RunPickDocument.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="workEffortId" required="true"/><actions><service-call name="mantle.work.ManufacturingServices.get#ProductionRunPickInfo" in-map="context" out-map="context"/></actions><widgets><render-mode><text type="xsl-fo" location="component://SimpleScreens/template/work/ProductionRunPick.xsl-fo.ftl" template="true" encode="false" no-boundary-comment="true"/></render-mode></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Manufacturing/Run/EditRun.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Production Run" default-menu-index="1"><parameter name="workEffortId" required="true"/><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition name="editFacility"><default-response url="//${appRoot}/Facility/EditFacility"/></transition><transition name="equipmentDetail"><default-response url="//${appRoot}/Asset/AssetDetail"/></transition><transition name="updateRun"><service-call name="update#mantle.work.effort.WorkEffort" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="cloneWorkEffort"><service-call name="mantle.work.WorkEffortServices.clone#WorkEffort" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createNote"><service-call name="create#mantle.work.effort.WorkEffortNote" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateNote"><service-call name="update#mantle.work.effort.WorkEffortNote" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="addAssetAssign"><service-call name="create#mantle.work.effort.WorkEffortAssetAssign" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateAssetAssign"><service-call name="update#mantle.work.effort.WorkEffortAssetAssign" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="addAssignment"><service-call name="create#mantle.work.effort.WorkEffortParty" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateAssignment"><service-call name="update#mantle.work.effort.WorkEffortParty" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="RunPickDocument.pdf"><default-response url="${ec.web.getWebappRootUrl(false, null)}/fop/apps/${appRoot}/Manufacturing/Run/RunPickDocument" url-type="plain"><parameter name="renderMode" value="xsl-fo"/><parameter name="pageNoLimit" value="true"/><parameter name="workEffortId"/><parameter name="filename" value="RunPick-${workEffortId}.pdf"/></default-response></transition><transition-include name="getFacilityList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><actions><service-call name="mantle.work.ManufacturingServices.get#ProductionRunDisplayInfo" in-map="context" out-map="context"/><set field="statusId" from="workEffort?.statusId"/><set field="statusChangeTransition" value="updateRun"/></actions><widgets><container-row><row-col lg="5"><link url="cloneWorkEffort" text="Clone Run" parameter-map="[baseWorkEffortId:workEffortId, clearDates:true, copyAssetAssign:true]"/><link url="RunPickDocument.pdf" text="Run Pick PDF"/><form-single name="UpdateRun" transition="updateRun" map="workEffort"><field name="workEffortName"><default-field title="Name"><text-line size="60"/></default-field></field><field name="warehouse"><conditional-field condition="inventoryFacility && inventoryFacility.facilityId != workEffort.facilityId"><display text="FacilityNameTemplate" text-map="inventoryFacility"/></conditional-field></field><field name="workEffortId"><default-field><hidden/></default-field></field><field name="facilityId"><default-field title="WH/Line"><drop-down allow-empty="true"><dynamic-options transition="getFacilityList" server-search="true" min-length="0" parameter-map="[facilityTypeEnumId:'FcTpLine,FcTpPlant,FcTpWarehouse']"/></drop-down></default-field></field><field name="estimatedStartDate"><default-field title="Start Date"><date-time/></default-field></field><field name="estimatedWorkDuration"><default-field title="Est. Hours"><text-line size="8"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></row-col><row-col lg="7"><section-include name="StatusChangeAndHistorySection" location="component://SimpleScreens/template/basic/StatusWidgets.xml"/><section name="NotesSection"><actions><entity-find entity-name="mantle.work.effort.WorkEffortNote" list="noteList"><econdition field-name="workEffortId"/><order-by field-name="-noteDate"/></entity-find></actions><widgets><container-box><box-header title="Notes"/><box-toolbar><container-dialog id="NewNoteDialog" button-text="Add Note"><form-single name="NewNoteForm" transition="createNote"><field name="workEffortId"><default-field><hidden/></default-field></field><field name="noteText"><default-field title="Note"><text-area cols="60" rows="6"/></default-field></field><field name="submitButton"><default-field title="Add Note"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><section-iterate name="NoteIterateSection" list="noteList" entry="note"><actions><entity-find-one entity-name="mantle.party.PersonWithUserAccount" value-field="paua"><field-map field-name="userId" from="note.userId"/></entity-find-one></actions><widgets><container-row><row-col sm="4"><label text="${ec.l10n.format(note.noteDate, 'yyyy-MM-dd HH:mm')}" type="strong" style="text-nowrap"/><label text="by ${ec.resource.expand('UsernameTemplate','',paua+[userId:note.userId])}" condition="paua" style="text-nowrap"/></row-col><row-col sm="6"><label text="${note.noteText}"/></row-col><row-col sm="2" style="text-right"><section name="UpdateNoteSection" condition="note.userId == ec.user.userId"><widgets><container-dialog id="UpdateNoteContainer" button-text="Edit"><form-single name="UpdateNoteForm" transition="updateNote" map="note"><field name="workEffortId"><default-field><hidden/></default-field></field><field name="noteDate"><default-field><hidden/></default-field></field><field name="noteText"><default-field title="Note"><text-area cols="60" rows="6"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></container-dialog></widgets></section></row-col></container-row></widgets></section-iterate></box-body></container-box></widgets></section></row-col></container-row><container-box><box-header title="Equipment"/><box-toolbar><container-dialog id="AddEquipment" button-text="Add"><form-single name="AddEquipment" transition="addAssetAssign"><field name="workEffortId"><default-field><hidden/></default-field></field><field name="assetId"><default-field title="Equipment"><drop-down><entity-options key="${assetId}" text="AssetNameTemplate"><entity-find entity-name="mantle.product.asset.Asset"><econdition field-name="facilityId" operator="in" from="currentFacilityIdList"/><econdition field-name="assetTypeEnumId" value="AstTpEquipment"/><order-by field-name="assetName"/></entity-find></entity-options></drop-down></default-field></field><field name="statusId" from="null"><default-field title="Status"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="WorkEffortAssetAssign"/><set field="noCurrentSelectedKey" value="WeaaAssigned"/></widget-template-include></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="EquipmentList" list="equipmentList" transition="updateAssetAssign"><field name="workEffortId"><default-field><hidden/></default-field></field><field name="assetId"><default-field><hidden/></default-field></field><field name="fromDate"><default-field><hidden/></default-field></field><field name="assetName"><default-field><link url="equipmentDetail" text="AssetNameTemplate" link-type="anchor"/></default-field></field><field name="statusId"><default-field title="Status"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusTransitionDropDown"><set field="currentDescription" from="equipmentList_entry?.'WorkEffortAssetAssign#moqui.basic.StatusItem'?.description"/><set field="statusId" from="invoice?.statusId"/></widget-template-include></default-field></field><field name="comments"><default-field><text-area cols="50" rows="2"/></default-field></field><field name="submitButton" align="right"><default-field title="Update"><submit/><link url="updateAssetAssign" icon="fa fa-trash" parameter-map="[workEffortId:workEffortId, assetId:assetId, fromDate:fromDate, thruDate:ec.user.nowTimestamp]"/></default-field></field></form-list></box-body></container-box><container-box><box-header title="Parties Assigned"/><box-toolbar><container-dialog id="AddPartyAssignDialog" button-text="Add Party"><form-single name="AddPartyAssignForm" transition="addAssignment"><field name="workEffortId"><default-field><hidden/></default-field></field><field name="fromDate" from="ec.user.nowTimestamp"><default-field><hidden/></default-field></field><field name="partyId"><default-field title="Person"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="roleTypeId"><default-field title="Role"><drop-down><option key="Worker" text="Worker"/><option key="Manager" text="Manager"/><option key="_NA_" text="Not Applicable"/></drop-down></default-field></field><field name="statusId" from="null"><default-field title="Status"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="WorkEffortParty"/><set field="noCurrentSelectedKey" value="WeptAssigned"/></widget-template-include></default-field></field><field name="submitButton"><default-field title="Add Assignment"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="UpdateAssignForm" list="weapdList" transition="updateAssignment"><row-actions><entity-find-one entity-name="moqui.basic.StatusItem" value-field="currentStatus"/></row-actions><field name="workEffortId"><default-field><hidden/></default-field></field><field name="partyId"><default-field><hidden/></default-field></field><field name="fromDate"><default-field><hidden/></default-field></field><field name="name"><header-field/><default-field><link url="editParty" text="PartyNameTemplate" link-type="anchor"/></default-field></field><field name="username"><default-field><link url="editParty" text="${username?:'--'}" link-type="anchor"/></default-field></field><field name="roleTypeId"><header-field title="Role"/><default-field><display-entity entity-name="mantle.party.RoleType"/></default-field></field><field name="statusId"><default-field title="Status"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusTransitionDropDown"><set field="currentDescription" from="currentStatus?.description"/><set field="statusId"/></widget-template-include></default-field></field><field name="submitButton" align="right"><default-field title="Update"><submit/><link url="updateAssignment" icon="fa fa-trash" parameter-map="[workEffortId:workEffortId, partyId:partyId, roleTypeId:roleTypeId, fromDate:fromDate, thruDate:ec.user.nowTimestamp]"/></default-field></field></form-list></box-body></container-box></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Manufacturing/Run/RunProducts/ConsumeAsset.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="workEffortId" required="true"/><parameter name="facilityId"/><parameter name="productId"/><transition name="issueAssetToWorkEffort"><service-call name="mantle.product.AssetServices.issue#AssetToWorkEffort" in-map="true" out-map="context" multi="parameter"/><default-response url=".."/></transition><transition-include name="getAssetList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getAssetAmount" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getAssetAvailableToPromiseTotal" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><actions><entity-find-one entity-name="mantle.work.effort.WorkEffort" value-field="workEffort"/></actions><widgets><form-single name="ConsumeAssetForm" transition="issueAssetToWorkEffort"><field name="workEffortId"><default-field><hidden/></default-field></field><field name="facilityId" from="inventoryFacilityId ?: facilityId"><default-field title="Facility"><display-entity entity-name="mantle.facility.Facility" text="FacilityNameTemplate"/></default-field></field><field name="productId"><conditional-field condition="productId" title="Product"><display-entity entity-name="mantle.product.Product" text="ProductNameTemplate"/></conditional-field></field><field name="assetId"><default-field title="Asset"><drop-down allow-empty="true"><dynamic-options transition="getAssetList" server-search="true" min-length="0" parameter-map="[facilityId:(inventoryFacilityId?:facilityId), productId:productId, assetTypeEnumId:null, excludeZeroQoh:'true']"/></drop-down></default-field></field><field name="quantity"><default-field><text-line size="10" default-transition="getAssetAvailableToPromiseTotal"><depends-on field="assetId"/></text-line></default-field></field><field name="noConsumeProduct"><conditional-field condition="productId && facilityId"><ignored/></conditional-field><default-field title="No Consume Product"><radio no-current-selected-key="error"><option key="add"/><option key="error"/></radio></default-field></field><field name="noOriginFacility"><default-field><hidden default-value="ignore"/></default-field></field><field name="submitButton"><default-field title="Consume"><submit/></default-field></field></form-single></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Manufacturing/Run/RunProducts/ConsumeProduct.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="workEffortId" required="true"/><parameter name="inventoryFacilityId" required="true"/><parameter name="productId"/><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition name="issueAnyAssetToWorkEffort"><service-call name="mantle.product.AssetServices.issue#AnyAssetToWorkEffort" in-map="true" out-map="context" multi="parameter"/><default-response url=".."/></transition><widgets><form-single name="ConsumeAssetForm" transition="issueAnyAssetToWorkEffort"><field name="workEffortId"><default-field><hidden/></default-field></field><field name="facilityId" from="inventoryFacilityId ?: facilityId"><default-field title="Facility"><display-entity entity-name="mantle.facility.Facility" text="FacilityNameTemplate"/></default-field></field><field name="productId"><conditional-field condition="productId"><hidden/></conditional-field><default-field title="Product"><drop-down><dynamic-options transition="getProductList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="quantity"><default-field><text-line size="10"/></default-field></field><field name="submitButton"><default-field title="Consume"><submit/></default-field></field></form-single></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Manufacturing/Run/RunProducts/ProduceAsset.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="workEffortId" required="true"/><parameter name="productId" required="true"/><parameter name="inventoryFacilityId" required="true"/><transition name="receiveAsset"><service-call name="mantle.product.AssetServices.receive#Asset" in-map="true" out-map="context" multi="parameter"/><default-response url=".."/></transition><actions><entity-find-one entity-name="mantle.work.effort.WorkEffort" value-field="workEffort"/></actions><widgets><form-single name="ReceiveAssetForm" transition="receiveAsset" extends="component://SimpleScreens/screen/SimpleScreens/Manufacturing/Run/RunProduced.xml#ReceiveAssetForm"><field name="productId"><default-field title="Product"><display-entity entity-name="mantle.product.Product" text="ProductNameTemplate"/></default-field></field><field name="defaultProductId"><default-field><ignored/></default-field></field></form-single></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Manufacturing/Run/RunProducts.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Run Products" default-menu-index="2"><parameter name="workEffortId" required="true"/><transition name="editProduct"><default-response url="//${appRoot}/Catalog/Product/EditProduct"/></transition><transition name="findAsset"><default-response url="//${appRoot}/Asset/Asset/FindAsset"/></transition><transition name="addRunProduct"><service-call name="mantle.work.WorkEffortServices.add#WorkEffortProduct" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateRunProduct"><service-call name="update#mantle.work.effort.WorkEffortProduct" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="issueAssetToWorkEffort"><service-call name="mantle.product.AssetServices.issue#AssetToWorkEffort" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="receiveAsset"><service-call name="mantle.product.AssetServices.receive#Asset" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getProductAmount" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getAssetList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getAssetAvailableToPromiseTotal" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><actions><service-call name="mantle.work.ManufacturingServices.get#ProductionRunDisplayInfo" in-map="context" out-map="context"/><service-call name="mantle.work.ManufacturingServices.get#ProductionRunProduceConsumeDetail" out-map="context" in-map="[workEffortId:workEffortId, excludeWithMatchingConsume:true]"/></actions><widgets><container-box><box-header title="Products to Produce"/><box-toolbar><container-dialog id="AddProduceDialog" button-text="Add Product"><form-single name="AddProduceForm" transition="addRunProduct"><field name="workEffortId"><default-field><hidden/></default-field></field><field name="typeEnumId"><default-field><hidden default-value="WeptProduce"/></default-field></field><field name="productId"><default-field title="Product"><drop-down><dynamic-options transition="getProductList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="estimatedQuantity"><default-field title="Est. Quantity"><text-line size="10"/></default-field></field><field name="productAmount"><default-field title=""><display dynamic-transition="getProductAmount"><depends-on field="productId"/></display></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog><container-dialog id="ReceiveAssetDialog" button-text="Produce Asset"><form-single name="ReceiveAssetForm" transition="receiveAsset" extends="component://SimpleScreens/screen/SimpleScreens/Manufacturing/Run/RunProduced.xml#ReceiveAssetForm"/></container-dialog></box-toolbar><box-body-nopad><form-list name="ProduceList" transition="updateRunProduct" list="produceList"><row-actions><filter-map-list list="receiptSummaryList" to-list="currentReceiptList"><field-map field-name="productId"/></filter-map-list><set field="currentReceiptSummary" from="currentReceiptList?.getAt(0)"/><set field="currentReceiptQuantity" from="currentReceiptSummary?.quantityAccepted"/><set field="estReceiptRemaining" from="(estimatedQuantity ?: 0) - (currentReceiptQuantity ?: 0)"/></row-actions><field name="workEffortId"><default-field><hidden/></default-field></field><field name="productId"><default-field><hidden/></default-field></field><field name="fromDate"><default-field><hidden/></default-field></field><field name="pseudoId"><default-field title="Product"><link url="editProduct" link-type="anchor" text="${pseudoId}"/></default-field></field><field name="productName"><default-field title=""><display/></default-field></field><field name="availableToPromiseTotal" from="currentSummary?.availableToPromiseTotal ?: 0" align="right"><default-field title="WH ATP"><display/></default-field></field><field name="quantityOnHandTotal" from="currentSummary?.quantityOnHandTotal ?: 0" align="right"><default-field title="WH QOH"><display/></default-field></field><field name="estimatedQuantity" align="right"><default-field title="Est. Quantity"><text-line size="6"/></default-field></field><field name="amountUomId"><default-field title="UOM" container-style="text-nowrap"><display-entity entity-name="moqui.basic.Uom" text="ProductAmountNameTemplate"/></default-field></field><field name="currentAssets" align="right"><default-field title="Produced"><label text="${ec.l10n.format(currentReceiptSummary?.quantityAccepted, null) ?: 'None'}" style="${(currentReceiptQuantity ?: 0) == estimatedQuantity ? 'text-success' : 'text-danger'}"/></default-field></field><field name="submitButton" align="right"><default-field><submit text="Update"/><link url="updateRunProduct" icon="fa fa-trash" parameter-map="[workEffortId:workEffortId, productId:productId, fromDate:fromDate, thruDate:ec.user.nowTimestamp]"/></default-field></field><field name="assetDialog" align="right"><default-field title=""><dynamic-dialog id="ProduceAssetDialog" button-text="Produce" transition="ProduceAsset" parameter-map="[productId:productId, inventoryFacilityId:inventoryFacilityId, quantity:estReceiptRemaining]"/></default-field></field></form-list></box-body-nopad></container-box><container-box><box-header title="Products to Consume"/><box-toolbar><container-dialog id="AddConsumeDialog" button-text="Add Product"><form-single name="AddConsumeForm" transition="addRunProduct"><field name="workEffortId"><default-field><hidden/></default-field></field><field name="typeEnumId"><default-field><hidden default-value="WeptConsume"/></default-field></field><field name="productId"><default-field title="Product"><drop-down><dynamic-options transition="getProductList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="estimatedQuantity"><default-field><text-line size="10"/></default-field></field><field name="productAmount"><default-field title=""><display dynamic-transition="getProductAmount"><depends-on field="productId"/></display></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog><container-dialog id="IssueAssetDialog" button-text="Consume Asset"><form-single name="IssueAssetForm" transition="issueAssetToWorkEffort" extends="component://SimpleScreens/screen/SimpleScreens/Manufacturing/Run/RunProducts/ConsumeAsset.xml#ConsumeAssetForm"/></container-dialog></box-toolbar><box-body><section-iterate name="ProduceBomDetailSection" list="produceBomDetailList" entry="produceBomDetail"><widgets><label text="Product to Produce: ${ec.resource.expand('ProductNameTemplate','',produceBomDetail.workEffortProductDetail)} - ${ec.l10n.format(produceBomDetail.estimatedQuantity, null)} (${produceBomDetail.workEffortProductDetail.amountUomDescription ?: ''})" type="strong"/><section-iterate name="BomDetailSection" list="produceBomDetail.bomDetailList" entry="bomDetail"><widgets><container><label text="${ec.l10n.format(-bomDetail.quantityRemaining, null)} too many of " style="text-warning" condition="bomDetail.quantityRemaining < 0"/><section-iterate name="BomProductSection" list="bomDetail.productIdSet" entry="bomProductId"><actions><entity-find-one entity-name="mantle.product.Product" value-field="bomProduct"><field-map field-name="productId" from="bomProductId"/></entity-find-one></actions><widgets><link url="addRunProduct" link-type="hidden-form-link" condition="bomDetail.quantityRemaining > 0" text="Add Consume ${bomDetail.quantityRemaining} ${ec.resource.expand('ProductNameTemplate','',bomProduct)}" parameter-map="[workEffortId:workEffortId, typeEnumId:'WeptConsume', productId:bomProductId, estimatedQuantity:bomDetail.quantityRemaining]"/><label text="ProductNameTemplate" text-map="bomProduct" style="text-warning" condition="bomDetail.quantityRemaining < 0"/><label text=" or " condition="bomProductId_has_next && bomDetail.quantityRemaining != 0"/></widgets></section-iterate></container></widgets></section-iterate></widgets></section-iterate><section-iterate name="ConsumeTooMuchSection" list="consumeQuantityRemainingMap" entry="extraQuantity" key="consumeProductId"><actions><entity-find-one entity-name="mantle.product.Product" value-field="bomProduct"><field-map field-name="productId" from="consumeProductId"/></entity-find-one></actions><widgets><label text="Estimated consume for ${ec.resource.expand('ProductNameTemplate','',bomProduct)} is ${ec.l10n.format(extraQuantity, null)} higher than BOM for estimated product to produce" type="p" style="text-warning"/></widgets></section-iterate></box-body><box-body-nopad><form-list name="ConsumeList" transition="updateRunProduct" list="consumeList" extends="ProduceList"><row-actions><filter-map-list list="assetSummaryList" to-list="currentSummaryList"><field-map field-name="productId"/></filter-map-list><set field="currentSummary" from="currentSummaryList?.getAt(0)"/><filter-map-list list="issuanceSummaryList" to-list="currentIssuanceList"><field-map field-name="productId"/></filter-map-list><set field="currentIssuanceSummary" from="currentIssuanceList?.getAt(0)"/><set field="currentIssuanceQuantity" from="currentIssuanceSummary?.quantity"/><set field="estIssueRemaining" from="(estimatedQuantity ?: 0) - (currentIssuanceQuantity ?: 0)"/><entity-find-one entity-name="mantle.product.Product" value-field="consumeProduct"/></row-actions><field name="currentAssets" align="right"><default-field title="Consumed"><label text="${ec.l10n.format(currentIssuanceQuantity, null) ?: 'None'}" style="${(currentIssuanceQuantity ?: 0) == estimatedQuantity ? 'text-success' : 'text-danger'}"/></default-field></field><field name="submitButton" align="right"><default-field><submit text="Update"/><link url="updateRunProduct" icon="fa fa-trash" parameter-map="[workEffortId:workEffortId, productId:productId, fromDate:fromDate, thruDate:ec.user.nowTimestamp]"/></default-field></field><field name="assetDialog" align="right"><conditional-field condition="consumeProduct.assetClassEnumId in ['AsClsInventoryRaw', 'AsClsInventorySub']"><dynamic-dialog id="ConsumeProductDialog" button-text="Consume Any" transition="ConsumeProduct" width="900" parameter-map="[productId:productId, inventoryFacilityId:inventoryFacilityId, quantity:estIssueRemaining]"/><dynamic-dialog id="ConsumeAssetDialog" button-text="Consume" transition="ConsumeAsset" width="900" parameter-map="[productId:productId, facilityId:inventoryFacilityId, quantity:estIssueRemaining]"/></conditional-field><default-field title=""><dynamic-dialog id="ConsumeAssetDialog" button-text="Consume" transition="ConsumeAsset" width="900" parameter-map="[productId:productId, facilityId:inventoryFacilityId, quantity:estIssueRemaining]"/></default-field></field></form-list></box-body-nopad></container-box></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Manufacturing/Run/RunConsumed.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Assets Consumed" default-menu-index="3"><parameter name="workEffortId" required="true"/><transition name="editProduct"><default-response url="//${appRoot}/Catalog/Product/EditProduct"/></transition><transition name="findAsset"><default-response url="//${appRoot}/Asset/Asset/FindAsset"/></transition><transition name="assetDetail"><default-response url="//${appRoot}/Asset/Asset/AssetDetail"/></transition><transition name="issueAssetToWorkEffort"><service-call name="mantle.product.AssetServices.issue#AssetToWorkEffort" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="issueAnyAssetToWorkEffort"><service-call name="mantle.product.AssetServices.issue#AnyAssetToWorkEffort" in-map="true" out-map="context" multi="parameter"/><default-response url=".."/></transition><transition name="receiveAsset"><service-call name="mantle.product.AssetServices.receive#Asset" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getAssetList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getAssetAvailableToPromiseTotal" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><actions><service-call name="mantle.work.ManufacturingServices.get#ProductionRunDisplayInfo" in-map="context" out-map="context"/><entity-find entity-name="mantle.product.issuance.AssetIssuanceDetail" list="assetIssuanceDetailList"><search-form-inputs default-order-by="pseudoId,productName,assetId,-issuedDate"/><econdition field-name="workEffortId"/></entity-find><set field="aidTotal" from="[:]"/><iterate list="assetIssuanceDetailList" entry="aid"><script><![CDATA[if (aidTotal[aid.assetId]) aidTotal[aid.assetId] += aid.quantity
            else aidTotal[aid.assetId] = aid.quantity]]></script></iterate><entity-find entity-name="mantle.product.receipt.AssetReceipt" list="assetReceiptList"><econdition field-name="workEffortId"/></entity-find><set field="arTotal" from="[:]"/><iterate list="assetReceiptList" entry="ar"><script><![CDATA[if (arTotal[ar.assetId]) arTotal[ar.assetId] += ar.quantityAccepted
            else arTotal[ar.assetId] = ar.quantityAccepted]]></script></iterate></actions><widgets><container-dialog id="IssueAssetDialog" button-text="Consume Asset"><form-single name="IssueAssetForm" transition="issueAssetToWorkEffort" extends="component://SimpleScreens/screen/SimpleScreens/Manufacturing/Run/RunProducts/ConsumeAsset.xml#ConsumeAssetForm"/></container-dialog><container-dialog id="IssueProductAssetDialog" button-text="Consume by Product"><form-single name="ConsumeAssetForm" transition="issueAnyAssetToWorkEffort" extends="component://SimpleScreens/screen/SimpleScreens/Manufacturing/Run/RunProducts/ConsumeProduct.xml#ConsumeAssetForm"/></container-dialog><link url="findAsset" text="Warehouse Assets" parameter-map="[facilityId:inventoryFacilityId]" target-window="_blank"/><form-list name="IssuedAssetForm" list="assetIssuanceDetailList" skip-form="true"><row-actions><set field="receiveQuantityBackToInventory" from="quantity"/><if condition="arTotal[assetId]"><script><![CDATA[if (receiveQuantityBackToInventory > (aidTotal[assetId] - arTotal[assetId]))
                        receiveQuantityBackToInventory = aidTotal[assetId] - arTotal[assetId]
                    aidTotal[assetId] -= receiveQuantityBackToInventory]]></script></if></row-actions><field name="pseudoId"><header-field title="Product" show-order-by="true"/><default-field><link url="editProduct" text="${pseudoId}" link-type="anchor"/></default-field></field><field name="productName"><default-field title=""><display/></default-field></field><field name="quantity" align="right"><default-field><display/></default-field></field><field name="assetClassEnumId"><default-field><hidden/></default-field></field><field name="amountUomId"><default-field title="UOM" container-style="text-nowrap"><display-entity entity-name="moqui.basic.Uom" text="ProductAmountNameTemplate"/></default-field></field><field name="assetId"><default-field title="Asset"><link url="assetDetail" text="${assetId}" link-type="anchor"/></default-field></field><field name="availableToPromiseTotal" align="right"><default-field title="ATP"><display/></default-field></field><field name="quantityOnHandTotal" align="right"><default-field title="QOH"><display/></default-field></field><field name="assetIssuanceId"><default-field title="Issuance"><display/></default-field></field><field name="receiveButton"><conditional-field title="" condition="receiveQuantityBackToInventory <= 0"><display text="Received Back to Inventory"/></conditional-field><default-field title=""><link url="receiveAsset" text="Receive ${ec.l10n.format(receiveQuantityBackToInventory, '#,##0')} Back to Inventory" parameter-map="[workEffortId:workEffortId, productId:productId, assetId:assetId, facilityId:inventoryFacilityId,                                 ownerPartyId:ownerPartyId, quantity:receiveQuantityBackToInventory, noProduceProduct:'ignore']"/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Manufacturing/Run/RunProduced.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Assets Produced" default-menu-index="4"><parameter name="workEffortId" required="true"/><transition name="editProduct"><default-response url="//${appRoot}/Catalog/Product/EditProduct"/></transition><transition name="findAsset"><default-response url="//${appRoot}/Asset/Asset/FindAsset"/></transition><transition name="assetDetail"><default-response url="//${appRoot}/Asset/Asset/AssetDetail"/></transition><transition name="containerDetail"><default-response url="//${appRoot}/Asset/Container/ContainerDetail"/></transition><transition name="issueAssetToWorkEffort"><service-call name="mantle.product.AssetServices.issue#AssetToWorkEffort" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="receiveAsset"><service-call name="mantle.product.AssetServices.receive#Asset" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getProductAmount" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><actions><service-call name="mantle.work.ManufacturingServices.get#ProductionRunDisplayInfo" in-map="context" out-map="context"/><entity-find entity-name="mantle.product.issuance.AssetIssuance" list="assetIssuanceList"><econdition field-name="workEffortId"/></entity-find></actions><widgets><container-dialog id="ReceiveAssetDialog" button-text="Produce Asset"><form-single name="ReceiveAssetForm" transition="receiveAsset"><field name="workEffortId"><default-field><hidden/></default-field></field><field name="facilityId" from="inventoryFacilityId ?: facilityId"><default-field title="Facility"><display-entity entity-name="mantle.facility.Facility" text="FacilityNameTemplate"/></default-field></field><field name="productId"><default-field title="Assigned Product"><drop-down allow-empty="true"><list-options list="produceList" key="${productId}" text="ProductNameTemplate"/></drop-down></default-field></field><field name="quantity"><default-field><text-line size="10"/></default-field></field><field name="productAmount"><default-field title=""><display dynamic-transition="getProductAmount"><depends-on field="productId"/></display></default-field></field><field name="containerTypeEnumId"><default-field title="Container Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ContainerType"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="containerId"><default-field title="Add to Container"><text-line size="20"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog><form-list name="ReceivedAssetForm" list="assetReceiptDetailList" skip-form="true"><entity-find entity-name="mantle.product.receipt.AssetReceiptDetail" list="assetReceiptDetailList"><search-form-inputs default-order-by="productName,assetId"/><econdition field-name="workEffortId"/><select-field field-name="workEffortId,pseudoId,productName"/></entity-find><row-actions><filter-map-list list="assetIssuanceList" to-list="currentIssuanceList"><field-map field-name="assetId"/></filter-map-list></row-actions><field name="productId"><default-field title="Product"><link url="editProduct" text="ProductNameTemplate" link-type="anchor"/></default-field></field><field name="amountUomId"><default-field title="UOM"><display-entity entity-name="moqui.basic.Uom" text="ProductAmountNameTemplate"/></default-field></field><field name="quantityAccepted"><default-field title="Quantity"><display/></default-field></field><field name="assetId"><default-field title="Asset"><link url="assetDetail" text="${assetId}" link-type="anchor"/></default-field></field><field name="availableToPromiseTotal"><default-field title="ATP"><display/></default-field></field><field name="quantityOnHandTotal"><default-field title="QOH"><display/></default-field></field><field name="assetReceiptId"><default-field title="Receipt"><display/></default-field></field><field name="containerId"><default-field title="Container"><link url="containerDetail" text="${containerId}" link-type="anchor" condition="containerId"/></default-field></field><field name="issueButton" align="right"><conditional-field condition="currentIssuanceList"><display text="Issued Back to Run"/></conditional-field><default-field title=""><link url="issueAssetToWorkEffort" text="Issue Back to Run" parameter-map="[workEffortId:workEffortId,                         assetId:assetId, quantity:quantityAccepted, noConsumeProduct:'ignore', noOriginFacility:'ignore']"/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Manufacturing/Run.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Runs" default-menu-index="5"><subscreens default-item="FindRun"/><widgets><subscreens-panel id="RunPanel" type="tab"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Manufacturing.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Manufacturing" default-menu-index="11" menu-image="fa fa-industry" menu-image-type="icon"><subscreens default-item="dashboard"/><widgets><subscreens-panel id="MfgPanel" type="popup"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Order/FindOrder.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Find Order" default-menu-include="false"><transition name="orderDetail"><default-response url="../OrderDetail"/></transition><transition name="createOrder"><service-call name="mantle.order.OrderServices.create#Order" in-map="true" out-map="context" multi="parameter"/><default-response url="../OrderDetail"/></transition><transition name="changeOrderPartsStatus"><service-call name="mantle.order.OrderBulkServices.change#OrderPartsStatus" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="editFacility"><default-response url="//${appRoot}/Facility/EditFacility"/></transition><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition name="editSupplier"><default-response url="//${appRoot}/Supplier/EditSupplier"/></transition><transition name="editCustomer"><default-response url="//${appRoot}/Customer/EditCustomer"/></transition><transition name="shipmentDetail"><default-response url="//${appRoot}/Shipment/ShipmentDetail"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getFacilityList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><transition-include name="getGeoCountryStates" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition name="getWhFacilitiesByOwner"><service-call name="mantle.facility.FacilityServices.get#FacilitiesByOwner" in-map="[ownerPartyId:(customerPartyId ?: vendorPartyId), productStoreId:productStoreId, facilityTypeEnumId:'FcTpWarehouse']" web-send-json-response="resultList" out-map="context" multi="parameter"/><default-response type="none"/></transition><transition name="getStoreOrgOrAllOrgInternal"><parameter name="productStoreId"/><actions><if condition="productStoreId"><entity-find-one entity-name="mantle.product.store.ProductStore" value-field="productStore"><field-map field-name="productStoreId"/></entity-find-one><if condition="productStore != null"><entity-find-one entity-name="mantle.party.PartyDetail" value-field="orgParty"><field-map field-name="partyId" from="productStore.organizationPartyId"/></entity-find-one><if condition="orgParty != null"><script><![CDATA[ec.web.sendJsonResponse([[value:orgParty.partyId, label:ec.resource.expand("PartyNameTemplate", "", orgParty)]])]]></script><return/></if></if></if><entity-find entity-name="mantle.party.PartyDetailAndRole" list="partyList"><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find><script><![CDATA[def outList = []
            for (party in partyList) outList.add([value:party.partyId, label:ec.resource.expand("PartyNameTemplate", "", party)])
            ec.web.sendJsonResponse(outList)]]></script></actions><default-response type="none"/></transition><actions><set field="itemTypeEnumId" from="salesItemTypeEnumId ?: purchaseItemTypeEnumId"/><set field="onlyProductQuantityBool" from="'true'.equals(onlyProductQuantity)"/><if condition="onlyProductQuantityBool || inventoryAvailable == 'none'"><entity-find entity-name="moqui.basic.EnumGroupMember" list="productItemTypeEgms" cache="true"><econdition field-name="enumGroupEnumId" value="EngItemsProduct"/></entity-find><set field="itemTypeEnumId" from="productItemTypeEgms*.enumId.join(',')"/></if><set field="orderType" from="orderType ?: 'Any'"/><set field="vendorRole" value="Supplier,Vendor,VendorBillFrom"/><set field="customerRole" value="Customer,CustomerBillTo"/><set field="defaultProductStoreId" from="ec.user.getPreference('OrderSalesStoreDefault')"/><if condition="defaultProductStoreId"><entity-find-one entity-name="mantle.product.store.ProductStore" value-field="defaultProductStore"><field-map field-name="productStoreId" from="defaultProductStoreId"/></entity-find-one><if condition="defaultProductStore == null"><set field="defaultProductStoreId" from="null"/></if></if><set field="defaultFacilityId" from="ec.user.getPreference('FacilityGeneralDefault')"/><if condition="defaultFacilityId"><entity-find-one entity-name="mantle.facility.Facility" value-field="defaultFacility"><field-map field-name="facilityId" from="defaultFacilityId"/></entity-find-one><if condition="defaultFacility == null"><set field="defaultFacilityId" from="null"/></if></if></actions><widgets><container-row><row-col md="5"><container-dialog id="CreateSalesOrderDialog" button-text="Create Sales Order"><form-single name="CreateSalesOrder" transition="createOrder"><field name="productStoreId" from="productStoreId ?: defaultProductStoreId"><default-field title="Store"><drop-down allow-empty="true"><entity-options key="${productStoreId}" text="${productStoreId}: ${storeName}"><entity-find entity-name="mantle.product.store.ProductStore"><order-by field-name="storeName"/></entity-find></entity-options></drop-down></default-field></field><field name="vendorPartyId"><default-field title="Vendor Org"><drop-down><dynamic-options transition="getStoreOrgOrAllOrgInternal" depends-optional="true"><depends-on field="productStoreId"/></dynamic-options></drop-down></default-field></field><field name="facilityId" from="facilityId ?: (!defaultProductStoreId ? defaultFacilityId : null)"><default-field title="Facility"><drop-down><dynamic-options transition="getWhFacilitiesByOwner" value-field="facilityId" label-field="label" depends-optional="true"><depends-on field="vendorPartyId"/><depends-on field="productStoreId"/></dynamic-options></drop-down></default-field></field><field name="customerPartyId"><default-field title="Customer"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2" parameter-map="[roleTypeId:'Customer']"/></drop-down></default-field></field><field name="otherPartyOrderId"><default-field title="Their Order ID"><text-line size="40"/></default-field></field><field name="priority"><default-field><radio no-current-selected-key="5"><option key="1"/><option key="2"/><option key="3"/><option key="4"/><option key="5"/><option key="6"/><option key="7"/><option key="8"/><option key="9"/></radio></default-field></field><field name="shipBeforeDate"><default-field><date-time/></default-field></field><field name="estimatedDeliveryDate"><default-field title="Delivery Date"><date-time/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><link url="../SalesAnalysis" text="Sales Analysis Report" parameter-map="[customerPartyId:customerPartyId]"/><link url="../SalesSummary" text="Sales Summary Charts" parameter-map="[customerPartyIds:customerPartyId]"/><link url="../OrderIssuedInvoiced" text="Issued and Invoiced Report" parameter-map="[customerPartyId:customerPartyId]"/></row-col><row-col md="7" style="text-right"><section name="ApproveOrdersSection" condition="partStatusId && (partStatusId.contains('OrderPlaced') ||                     partStatusId.contains('OrderProcessing') || partStatusId.contains('OrderHold'))"><widgets><container-dialog id="ApproveOrdersDialog" button-text="Approve Orders"><label text="Approves orders matching current find options. Use the Find Options dialog to adjust as needed before doing this." type="p"/><form-single name="ApproveOrdersForm" transition="changeOrderPartsStatus" pass-through-parameters="true"><field name="toStatusId" from="'OrderApproved'"><default-field><hidden/></default-field></field><field name="submitButton"><default-field title="Approve Orders"><submit confirmation="Do the current find options and orders displayed match what you want to approve?"/></default-field></field><field-layout><field-row-big><field-ref name="submitButton"/></field-row-big></field-layout></form-single></container-dialog></widgets></section><section name="CloseOrdersSection" condition="partStatusId && (partStatusId.contains('OrderOpen') ||                     partStatusId.contains('OrderProposed') || partStatusId.contains('OrderPlaced') || partStatusId.contains('OrderProcessing') ||                     partStatusId.contains('OrderHold') || partStatusId.contains('OrderApproved') || partStatusId.contains('OrderSent'))"><widgets><container-dialog id="CloseOrdersDialog" button-text="Close Orders"><label text="Closes orders matching current find options. Use the Find Options dialog to adjust as needed before doing this." type="p"/><label text="Closing an order will cancel all items not yet shipped. If all items cancelled then the order will be Cancelled. If any item was shipped the order will be Completed." type="p"/><form-single name="CloseOrdersForm" transition="changeOrderPartsStatus" pass-through-parameters="true"><field name="toStatusId" from="'OrderCancelled'"><default-field><hidden/></default-field></field><field name="submitButton"><default-field title="Close Orders"><submit confirmation="Do the current find options and orders displayed match what you want to close (cancel all unshipped, complete any partially shipped)?"/></default-field></field><field-layout><field-row-big><field-ref name="submitButton"/></field-row-big></field-layout></form-single></container-dialog></widgets></section><container-dialog id="CreatePurchaseOrderDialog" button-text="Create Purchase Order"><form-single name="CreatePurchaseOrder" transition="createOrder"><field name="vendorPartyId"><default-field title="Supplier"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="0" parameter-map="[roleTypeId:vendorRole]"/></drop-down></default-field></field><field name="customerPartyId"><default-field title="Customer Org"><drop-down><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></default-field></field><field name="facilityId" from="facilityId ?: defaultFacilityId"><default-field title="Facility"><drop-down><dynamic-options transition="getFacilityList" server-search="true" min-length="0" parameter-map="[facilityTypeEnumId:'FcTpWarehouse']"/></drop-down></default-field></field><field name="shipBeforeDate"><default-field><date-time/></default-field></field><field name="estimatedDeliveryDate"><default-field title="Delivery Date"><date-time/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog></row-col></container-row><form-list name="OrderList" list="orderList" skip-form="true" header-dialog="true" select-columns="true" saved-finds="true" show-csv-button="true" show-xlsx-button="true" show-all-button="true"><entity-find entity-name="mantle.order.OrderPartFindView" list="orderList" use-clone="true"><search-form-inputs default-order-by="-entryDate,orderId,orderPartSeqId" skip-fields="vendorRoleTypeId,customerRoleTypeId,customerClassificationId,itemTypeEnumId"><default-parameters partStatusId="OrderProposed,OrderRequested,OrderPlaced,OrderApproved,OrderHold" partStatusId_op="in" entryDate_poffset="-3" entryDate_period="30d"/></search-form-inputs><date-filter from-field-name="customerClassFromDate" thru-field-name="customerClassThruDate" ignore="!customerClassificationId"/><econdition field-name="vendorRoleTypeId" value="OrgInternal" ignore="!'sales'.equalsIgnoreCase(orderType)"/><econdition field-name="customerRoleTypeId" value="OrgInternal" ignore="!'purchase'.equalsIgnoreCase(orderType)"/><econdition field-name="customerClassificationId" ignore-if-empty="true"/><econdition field-name="itemTypeEnumId" operator="in" ignore-if-empty="true" or-null="true"/><econdition field-name="productId" operator="in" from="findProductId" ignore-if-empty="true"/><econdition field-name="quantity" operator="greater-equals" from="findQuantity_from" ignore-if-empty="true"/><econdition field-name="quantity" operator="less-equals" from="findQuantity_thru" ignore-if-empty="true"/><econdition field-name="recurCronExpression" operator="is-not-null" ignore="onlyRecurring != 'true'"/><having-econditions><econdition field-name="issuedQuantity" operator="greater" from="0.0" ignore="onlyPartlyShipped != 'true'"/><econdition field-name="quantityNotAvailable" operator="equals" from="0.0" ignore="inventoryAvailable != 'all'"/><econdition field-name="quantityNotAvailable" operator="greater" from="0.0" ignore="inventoryAvailable != 'partial' && inventoryAvailable != 'notall'"/><econdition field-name="quantityNotAvailable" operator="less" to-field-name="quantity" ignore="inventoryAvailable != 'partial'"/><econdition field-name="quantityNotAvailable" operator="equals" to-field-name="quantity" ignore="inventoryAvailable != 'none'"/></having-econditions><select-field field-name="currencyUomId,orderPartSeqId${onlyPartlyShipped=='true' ? ',issuedQuantity' : ''}${inventoryAvailable in ['all','partial','none','notall'] ? ',quantityNotAvailable' : ''}${inventoryAvailable in ['partial','none'] ? ',quantity' : ''}"/></entity-find><row-actions><entity-find entity-name="mantle.party.PartyClassificationAndAppl" list="custPcaaList"><date-filter/><econdition field-name="partyId" from="customerPartyId"/><econdition field-name="classificationTypeEnumId" value="PcltCustomer"/></entity-find><entity-find entity-name="mantle.order.OrderItemShipSummary" list="oissList"><econdition field-name="orderId"/><econdition field-name="orderPartSeqId"/><having-econditions><econdition field-name="shipmentQuantity" operator="greater" from="0.0"/></having-econditions><select-field field-name="shipmentId,shipmentQuantity,quantityHandled"/></entity-find><entity-find entity-name="mantle.order.OrderPartPartyDetail" list="partPartyList"><econdition field-name="orderId"/><econdition field-name="orderPartSeqId"/><select-field field-name="partyId,pseudoId,firstName,lastName,organizationName,description"/></entity-find><if condition="findQuantity_from || findQuantity_thru"><entity-find entity-name="mantle.order.OrderItemSummary" list="totalQtyList"><econdition field-name="orderId"/><econdition field-name="orderPartSeqId"/><select-field field-name="quantity"/></entity-find><if condition="totalQtyList"><set field="quantityTotal" from="totalQtyList[0].quantity"/></if></if></row-actions><field name="orderType"><header-field><radio no-current-selected-key="Any"><option key="Any"/><option key="Sales"/><option key="Purchase"/></radio></header-field></field><field name="onlyPartlyShipped"><header-field title="Shipped"><check><option key="true" text="Only Partly Shipped"/></check></header-field></field><field name="inventoryAvailable"><header-field title="Inventory Available"><radio no-current-selected-key="any"><option key="any" text="Any"/><option key="all" text="All"/><option key="notall" text="Partial/None"/><option key="partial" text="Partial"/><option key="none" text="None"/></radio></header-field></field><field name="onlyProductQuantity"><header-field title="Quantity"><check><option key="true" text="Only count Product"/></check></header-field></field><field name="onlyRecurring"><header-field title="Recurring"><check><option key="true" text="Only Recurring"/></check></header-field></field><field name="orderId"><header-field title="Order" show-order-by="true"><text-find size="20" hide-options="true"/></header-field><default-field><link text="${orderId}:${orderPartSeqId}" url="orderDetail" link-type="anchor" condition="orderId"/></default-field></field><field name="otherPartyOrderId"><header-field title="Their Order" show-order-by="true"><text-find size="20" hide-options="true"/></header-field><default-field><display/></default-field></field><field name="salesChannelEnumId"><header-field title="Source" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="SalesChannel"/><set field="allowMultiple" value="true"/><set field="showNot" value="true"/></widget-template-include></header-field><default-field container-style="${salesChannelEnumId == 'ScWeb' ? 'text-strong text-success' : ''}"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="orderName"><header-field><text-find size="40"/></header-field><default-field><display/></default-field></field><field name="priority" align="center"><header-field show-order-by="true"><range-find/></header-field><default-field><display text="${priority == 1 ? '-- ' : (priority == 2 || priority == 3 ? '- ' : '')}${priority?:''}${priority == 1 ? ' --' : (priority == 2 || priority == 3 ? ' -' : '')}" style="${priority == 1 ? 'text-strong text-danger' : (priority == 2 || priority == 3 ? 'text-strong text-warning' : '')}"/></default-field></field><field name="entryDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="placedDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="shipAfterDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="shipBeforeDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="partStatusId"><header-field title="Status" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="OrderHeader"/><set field="allowMultiple" value="true"/></widget-template-include></header-field><default-field container-style="text-strong"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="facilityId"><header-field title="Facility" show-order-by="true"><drop-down allow-empty="true"><dynamic-options transition="getFacilityList" server-search="true" min-length="0" parameter-map="[facilityTypeEnumId:'FcTpWarehouse']"/></drop-down></header-field><default-field><link url="editFacility" entity-name="mantle.facility.Facility" text="FacilityNameTemplate" link-type="anchor"/></default-field></field><field name="productStoreId"><header-field title="Store" show-order-by="true"><drop-down allow-empty="true"><entity-options key="${productStoreId}" text="${productStoreId}: ${storeName}"><entity-find entity-name="mantle.product.store.ProductStore"><order-by field-name="storeName"/></entity-find></entity-options></drop-down></header-field><default-field><display-entity entity-name="mantle.product.store.ProductStore" text="${productStoreId}: ${storeName}"/></default-field></field><field name="shippingInstructions"><header-field show-order-by="true"><text-find size="40"/></header-field><default-field><display text="${shippingInstructions?.take(35)?:''}${shippingInstructions?.length() > 35 ? '...' : ''}" style="text-strong"/></default-field></field><field name="vendorPartyId"><header-field title="Vendor" show-order-by="true"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="0" parameter-map="[roleTypeId:'Supplier,Vendor,OrgInternal']"/></drop-down></header-field><default-field><link url="editSupplier" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" link-type="anchor" parameter-map="[partyId:vendorPartyId]"/></default-field></field><field name="customerPartyId"><header-field title="Customer" show-order-by="true"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2" parameter-map="[roleTypeId:'Customer,OrgInternal']"/></drop-down></header-field><default-field><link url="editCustomer" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" link-type="anchor" parameter-map="[partyId:customerPartyId]"/><label text=" - ${custPcaaList*.description.join(', ')}" condition="custPcaaList"/></default-field></field><field name="customerClassificationId"><header-field title="Customer Class"><drop-down allow-empty="true" allow-multiple="true" show-not="true"><entity-options key="${partyClassificationId}" text="${description}"><entity-find entity-name="mantle.party.PartyClassification"><econdition field-name="classificationTypeEnumId" value="PcltCustomer"/><order-by field-name="description"/></entity-find></entity-options></drop-down></header-field></field><field name="otherPartyId"><header-field title="Other Party"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></header-field></field><field name="otherRoleTypeId"><header-field title="Other Role"><drop-down allow-empty="true"><entity-options key="${roleTypeId}" text="${description}"><entity-find entity-name="mantle.party.RoleGroupMemberAndType" cache="true"><econdition field-name="roleGroupEnumId" value="RgpOrder"/><order-by field-name="description"/></entity-find></entity-options></drop-down></header-field></field><field name="otherParties"><default-field><section-iterate name="OtherPartyListSection" list="partPartyList" entry="partParty"><widgets><container><link url="editParty" link-type="anchor" parameter-map="[partyId:partParty.partyId]" text="* ${ec.resource.expand('PartyNameTemplate','',partParty)} - ${partParty.description?:'N/A'}"/></container></widgets></section-iterate></default-field></field><field name="shipmentMethodEnumId"><header-field title="Ship Method" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ShipmentMethod"/><set field="allowMultiple" value="true"/><set field="showNot" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="carrierPartyId"><header-field title="Carrier"><drop-down allow-multiple="true" show-not="true"><option key="_NA_" text="N/A"/><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="Carrier"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName,firstName"/></entity-find></entity-options></drop-down></header-field><default-field><display-entity entity-name="mantle.party.Party" text="${carrierPartyId == '_NA_' ? 'N/A' : pseudoId}"/></default-field></field><field name="shipments"><default-field><section-iterate name="ShipmentListSection" list="oissList" entry="oiss"><widgets><container><link url="shipmentDetail" link-type="anchor" text="${oiss.shipmentId}" parameter-map="[shipmentId:oiss.shipmentId]"/><label text=" (${ec.l10n.format(oiss.quantityHandled, null)} of ${ec.l10n.format(oiss.shipmentQuantity, null)})"/></container></widgets></section-iterate></default-field></field><field name="countryGeoId"><header-field title="Country" show-order-by="true"><drop-down allow-empty="true"><entity-options key="${geoId}" text="${geoName}"><entity-find entity-name="moqui.basic.Geo" list="geoList"><econdition field-name="geoTypeEnumId" value="GEOT_COUNTRY"/><order-by field-name="geoName"/></entity-find></entity-options></drop-down></header-field><default-field><display-entity entity-name="moqui.basic.Geo" text="${geoCodeAlpha3}"/></default-field></field><field name="stateProvinceGeoId"><header-field title="State/Province" show-order-by="true"><drop-down allow-empty="true" allow-multiple="true"><dynamic-options transition="getGeoCountryStates" value-field="geoId" label-field="label"><depends-on field="countryGeoId"/></dynamic-options></drop-down></header-field><default-field><display-entity entity-name="moqui.basic.Geo" text="${geoCodeAlpha2 ?: geoCodeAlpha3}"/></default-field></field><field name="partTotal" align="right" show-total="sum"><header-field show-order-by="true" title="Total"><range-find/></header-field><default-field><display currency-unit-field="currencyUomId"/></default-field></field><field name="quantityTotal" align="right" show-total="sum"><header-field show-order-by="true" title="Quantity Total"><range-find/></header-field><default-field><display/></default-field></field><field name="findQuantity"><header-field title="Item Quantity"><range-find/></header-field></field><field name="quantityNotAvailable" align="right" show-total="sum"><header-field show-order-by="true" title="Qty Not Avail"/><default-field container-style="${quantityNotAvailable ? 'text-danger' : ''}"><display/></default-field></field><field name="issuedQuantity" align="right" show-total="sum"><header-field show-order-by="true" title="Qty Shipped"/><default-field><display/></default-field></field><field name="purchaseItemTypeEnumId"><header-field title="Purchase Item Type"><drop-down allow-multiple="true"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.EnumAndGroup" list="itemTypeEnumList"><econdition field-name="enumGroupEnumId" value="EngItemsPurchase"/><order-by field-name="description"/></entity-find></entity-options></drop-down></header-field></field><field name="salesItemTypeEnumId"><header-field title="Sales Item Type"><drop-down allow-multiple="true"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.EnumAndGroup" list="itemTypeEnumList"><econdition field-name="enumGroupEnumId" value="EngItemsSales"/><order-by field-name="description"/></entity-find></entity-options></drop-down></header-field></field><field name="findProductId"><header-field title="Product"><drop-down allow-multiple="true"><dynamic-options transition="getProductList" server-search="true" min-length="0"/></drop-down></header-field></field><field name="externalId"><header-field show-order-by="true"><text-find hide-options="true" default-operator="begins"/></header-field><default-field><display/></default-field></field><field name="displayId"><header-field show-order-by="true"><text-find hide-options="true" default-operator="begins"/></header-field><default-field><display/></default-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field></field><columns><column><field-ref name="orderId"/><field-ref name="otherPartyOrderId"/><field-ref name="salesChannelEnumId"/></column><column><field-ref name="partStatusId"/><field-ref name="priority"/><field-ref name="partTotal"/></column><column><field-ref name="entryDate"/><field-ref name="placedDate"/><field-ref name="shipBeforeDate"/></column><column><field-ref name="facilityId"/><field-ref name="productStoreId"/><field-ref name="shippingInstructions"/></column><column><field-ref name="vendorPartyId"/><field-ref name="customerPartyId"/><field-ref name="otherParties"/></column><column><field-ref name="shipmentMethodEnumId"/><field-ref name="carrierPartyId"/><field-ref name="shipments"/></column></columns><columns type="mobile"><column><field-ref name="orderId"/><field-ref name="partStatusId"/><field-ref name="partTotal"/></column><column><field-ref name="placedDate"/><field-ref name="productStoreId"/><field-ref name="customerPartyId"/></column></columns></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Order/PrintOrder.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="orderId" required="true"/><actions><service-call name="mantle.order.OrderInfoServices.get#OrderDisplayInfo" in-map="[orderId:orderId]" out-map="context"/><if condition="!templateLocation"><set field="templateLocation" value="component://SimpleScreens/template/order/Order.xsl-fo.ftl"/></if></actions><widgets><render-mode><text type="xsl-fo" location="${templateLocation}" template="true" encode="false" no-boundary-comment="true"/></render-mode></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Order/OrderDetail/EditItem.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="orderId" required="true"/><parameter name="orderItemSeqId" required="true"/><parameter name="pageIndex"/><parameter name="pageSize"/><transition name="updateItem"><service-call name="mantle.order.OrderServices.update#OrderItem" in-map="true" out-map="context" multi="parameter"/><default-response url=".."/></transition><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><actions><entity-find-one entity-name="mantle.order.OrderHeader" value-field="orderHeader"/><service-call name="mantle.order.OrderInfoServices.get#OrderItemDisplayInfo" out-map="context" in-map="[orderId:orderId, orderItemSeqId:orderItemSeqId]"/><entity-find-count entity-name="mantle.party.PartyRole" count-field="isCustomerInternalOrg"><econdition field-name="partyId" from="orderPart.customerPartyId"/><econdition field-name="roleTypeId" value="OrgInternal"/></entity-find-count><entity-find-count entity-name="mantle.party.PartyRole" count-field="isVendorInternalOrg"><econdition field-name="partyId" from="orderPart.vendorPartyId"/><econdition field-name="roleTypeId" value="OrgInternal"/></entity-find-count><entity-find entity-name="mantle.order.OrderPart" list="orderPartList"><econdition field-name="orderId"/><order-by field-name="orderPartSeqId"/></entity-find></actions><widgets><form-single name="EditOrderItem" transition="updateItem" map="orderItem"><field name="orderId"><default-field><hidden/></default-field></field><field name="pageIndex"><default-field><hidden/></default-field></field><field name="pageSize"><default-field><hidden/></default-field></field><field name="orderItemSeqId"><default-field title="Item"><display/></default-field></field><field name="orderPartSeqId"><conditional-field title="Order Part" condition="partEditable && isPromo != 'Y'"><drop-down><list-options list="orderPartList" key="${orderPartSeqId}" text="${orderPartSeqId}"/></drop-down></conditional-field><default-field title="Order Part"><display text="Part ${orderPartSeqId}"/></default-field></field><field name="parentItemSeqId"><conditional-field condition="isProductItemType || orderItemTotalOut.childItemCount"><ignored/></conditional-field><conditional-field condition="partEditable && isPromo != 'Y'" title="Parent"><drop-down allow-empty="true"><list-options list="applicableParentItems" key="${orderItemSeqId}" text="${orderItemSeqId}"/></drop-down></conditional-field><default-field title="Parent Item"><display text="${parentItemSeqId ? 'Parent ' + parentItemSeqId : ''}"/></default-field></field><field name="itemTypeEnumId" from="orderItem.itemTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="productId" from="orderItem.productId"><conditional-field condition="orderItem.productId" title="Product"><display-entity entity-name="mantle.product.Product" text="ProductNameTemplate"/></conditional-field><default-field><ignored/></default-field></field><field name="itemTypeEnumId"><default-field title="Type" container-style="${isProductItemType ? 'text-info' : (itemTypeEnumId == 'ItemDiscount' ? 'text-success' : (itemTypeEnumId in ['ItemSalesTax','ItemVatTax'] ? 'text-warning' : ''))}"><display-entity entity-name="moqui.basic.Enumeration" text="${description}${isPromo ? ' (Promotion)' : ''}"/></default-field></field><field name="productId"><conditional-field title="Product" condition="isProductItemType && partEditable"><drop-down><dynamic-options transition="getProductList" server-search="true" min-length="0"/></drop-down></conditional-field><default-field title="Product"><display-entity entity-name="mantle.product.Product" text="ProductNameTemplate"/></default-field></field><field name="otherPartyProductId"><conditional-field condition="isProductItemType && partEditable"><text-line size="25"/></conditional-field><default-field><display/></default-field></field><field name="itemDescription"><conditional-field title="Description" condition="partEditable && isPromo != 'Y'"><text-line size="60"/></conditional-field><default-field title="Description"><display/></default-field></field><field name="promoCodeText"><conditional-field title="Promo Code" condition="promoCodeText"><display/></conditional-field></field><field name="comments"><conditional-field condition="partEditable && isPromo != 'Y'"><text-line size="30"/></conditional-field><default-field><display/></default-field></field><field name="requiredByDate"><conditional-field condition="isProductItemType && partEditable"><date-time/></conditional-field><default-field><display/></default-field></field><field name="unitListPrice"><default-field title="List Price"><display currency-unit-field="orderHeader.currencyUomId"/></default-field></field><field name="unitAmount"><conditional-field title="Price" condition="partEditable && isPromo != 'Y'"><text-line size="8" format="#,##0.00#"/></conditional-field><default-field title="Price"><display currency-unit-field="orderHeader.currencyUomId"/></default-field></field><field name="unitAmountHist"><default-field title=" "><render-mode><text type="html,vuet"><![CDATA[<#assign popoverContent><table style="width:100%;"><#list itemUnitAmountAuditList as auditInfo><tr><td class="text-right">${ec.l10n.formatCurrency(auditInfo.auditLog.newValueText, orderHeader.currencyUomId, 3)}</td><td class="text-center">${ec.resource.expand('UsernameTemplate', '', auditInfo.userAccount)}</td><td class="text-center">${ec.l10n.format(auditInfo.auditLog.changedDate, 'yyyy-MM-dd HH:mm')}</td><td class="text-center">${(auditInfo.changeReasonEnum.description)!(auditInfo.auditLog.changeReason)!''}</td></tr></#list></table></#assign><a role="button" data-toggle="popover" data-placement="left" data-title="${ec.resource.expand('Price History for Item ${orderItemSeqId}', null)}" data-content="${popoverContent?html}">${ec.l10n.localize('Price History')}</a>]]></text><text type="qvt"><![CDATA[<div class="text-primary cursor-pointer">${ec.l10n.localize('Price History')}<q-tooltip><div>${ec.resource.expand('Price History for Item ${orderItemSeqId}', null)}</div><table style="width:100%;"><#list itemUnitAmountAuditList as auditInfo><tr><td class="text-right">${ec.l10n.formatCurrency(auditInfo.auditLog.newValueText, orderHeader.currencyUomId, 3)}</td><td class="text-center">${ec.resource.expand('UsernameTemplate', '', auditInfo.userAccount)}</td><td class="text-center">${ec.l10n.format(auditInfo.auditLog.changedDate, 'yyyy-MM-dd HH:mm')}</td><td class="text-center">${(auditInfo.changeReasonEnum.description)!(auditInfo.auditLog.changeReason)!''}</td></tr></#list></table></q-tooltip></div>]]></text></render-mode></default-field></field><field name="standardCost"><conditional-field condition="partEditable && isProductItemType && isCustomerInternalOrg"><text-line size="10" format="#,##0.00#"/></conditional-field><conditional-field condition="isProductItemType && isCustomerInternalOrg"><display currency-unit-field="orderHeader.currencyUomId"/></conditional-field></field><field name="quantity"><conditional-field condition="partEditable && isPromo != 'Y'"><text-line size="5"/></conditional-field><default-field><display/></default-field></field><field name="quantity_changeReason"><conditional-field title="Quantity Reason" condition="partEditable && isPromo != 'Y'"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="OrderItemQuantityReason"/><set field="allowEmpty" value="true"/></widget-template-include></conditional-field><default-field><ignored/></default-field></field><field name="quantityHist"><default-field title=" "><render-mode><text type="html,vuet"><![CDATA[<#assign popoverContent><table style="width:100%;"><#list itemQuantityAuditList as auditInfo><tr><td class="text-right">${auditInfo.auditLog.newValueText}</td><td class="text-center">${ec.resource.expand('UsernameTemplate', '', auditInfo.userAccount)}</td><td class="text-center">${ec.l10n.format(auditInfo.auditLog.changedDate, 'yyyy-MM-dd HH:mm')}</td><td class="text-center">${(auditInfo.changeReasonEnum.description)!(auditInfo.auditLog.changeReason)!''}</td></tr></#list></table></#assign><a role="button" data-toggle="popover" data-placement="left" data-title="${ec.resource.expand('Quantity History for Item ${orderItemSeqId}', null)}" data-content="${popoverContent?html}">${ec.l10n.localize('Quantity History')}</a>]]></text><text type="qvt"><![CDATA[<div class="text-primary cursor-pointer">${ec.l10n.localize('Quantity History')}<q-tooltip><div>${ec.resource.expand('Quantity History for Item ${orderItemSeqId}', null)}</div><table style="width:100%;"><#list itemQuantityAuditList as auditInfo><tr><td class="text-right">${auditInfo.auditLog.newValueText}</td><td class="text-center">${ec.resource.expand('UsernameTemplate', '', auditInfo.userAccount)}</td><td class="text-center">${ec.l10n.format(auditInfo.auditLog.changedDate, 'yyyy-MM-dd HH:mm')}</td><td class="text-center">${(auditInfo.changeReasonEnum.description)!(auditInfo.auditLog.changeReason)!''}</td></tr></#list></table></q-tooltip></div>]]></text></render-mode></default-field></field><field name="quantityCancelled"><default-field title="Qty Cancelled"><display/></default-field></field><field name="itemQuantityNotShipped"><default-field title="Qty Not Shipped"><display format="#,##0.###"/></default-field></field><field name="itemNotBilled"><default-field title="Not Billed"><display text="${isProductItemType ? ec.l10n.format(itemQuantityNotBilled, '#,##0.###') : ec.l10n.format(itemAmountNotBilled, '#,##0.00')}"/></default-field></field><field name="submitButton"><default-field title="Update Item"><submit/></default-field></field><field-layout><field-row><field-ref name="orderPartSeqId"/><field-ref name="orderItemSeqId"/></field-row><field-ref name="itemTypeEnumId"/><field-ref name="productId"/><fields-not-referenced/><field-row><field-ref name="unitAmount"/><field-ref name="unitListPrice"/></field-row><field-row><field-ref name="unitAmountHist"/><field-ref name="standardCost"/></field-row><field-row><field-ref name="quantity"/><field-ref name="quantity_changeReason"/></field-row><field-row><field-ref name="quantityHist"/><field-ref name="quantityCancelled"/></field-row><field-row><field-ref name="itemQuantityNotShipped"/><field-ref name="itemNotBilled"/></field-row><field-ref name="submitButton"/></field-layout></form-single><render-mode><text type="html,vuet"><![CDATA[<script>$(function () { $('[data-toggle="popover"]').popover({ sanitize:false, html:true, trigger:"hover click" }); })</script>]]></text></render-mode></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Order/OrderDetail/ItemReserve.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="orderId" required="true"/><parameter name="orderItemSeqId" required="true"/><parameter name="pageIndex"/><transition name="reserveAssetForOrderItem"><service-call name="mantle.product.AssetServices.reserve#AssetForOrderItem" in-map="true" out-map="context" multi="parameter"/><default-response url=".."/></transition><transition-include name="getAssetList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><actions><entity-find-one entity-name="mantle.order.OrderItem" value-field="orderItem"/><set field="orderPart" from="orderItem.part"/></actions><widgets><form-single name="ReserveItem" transition="reserveAssetForOrderItem"><field name="orderId"><default-field><hidden/></default-field></field><field name="orderPartSeqId"><default-field><hidden/></default-field></field><field name="pageIndex"><default-field><hidden/></default-field></field><field name="orderItemSeqId"><default-field title="Item"><display/></default-field></field><field name="productId" from="orderItem.productId"><default-field title="Product"><display-entity entity-name="mantle.product.Product" text="ProductNameTemplate"/></default-field></field><field name="orderQuantity" from="orderItem.quantity"><default-field><display/></default-field></field><field name="assetId"><default-field title="Asset"><drop-down allow-empty="true"><dynamic-options transition="getAssetList" server-search="true" min-length="0" parameter-map="[facilityId:orderPart.facilityId, productId:orderItem.productId, assetTypeEnumId:null, excludeZeroQoh:'true']"/></drop-down></default-field></field><field name="assetIdList"><default-field title="Other Assets"><drop-down allow-multiple="true"><dynamic-options transition="getAssetList" server-search="true" min-length="0" parameter-map="[facilityId:orderPart.facilityId, productId:orderItem.productId, assetTypeEnumId:null, excludeZeroQoh:'true']"/></drop-down></default-field></field><field name="resetReservations"><default-field title=""><check no-current-selected-key="true"><option key="true" text="Reset Reservations"/></check></default-field></field><field name="submitButton"><default-field title="Reserve"><submit/></default-field></field></form-single></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Order/OrderDetail/ReturnItem.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="orderId" required="true"/><parameter name="orderItemSeqId" required="true"/><parameter name="pageIndex"/><transition name="addOrderItemToReturn"><service-call name="mantle.order.ReturnServices.add#OrderItemToReturn" in-map="true" out-map="context" multi="parameter"/><default-response url=".."/></transition><actions><entity-find-one entity-name="mantle.order.OrderItem" value-field="orderItem"/><service-call name="mantle.order.ReturnServices.calculate#OrderItemReturnable" out-map="returnableOut" in-map="[orderId:orderId, orderItemSeqId:orderItem.orderItemSeqId]"/><service-call name="mantle.order.ReturnServices.find#OrderOpenReturns" out-map="openReturnsOut" in-map="[orderId:orderId, orderPartSeqId:orderItem.orderPartSeqId]"/></actions><widgets><form-single name="ReturnItem" transition="addOrderItemToReturn"><field name="orderId"><default-field><hidden/></default-field></field><field name="pageIndex"><default-field><hidden/></default-field></field><field name="orderItemSeqId"><default-field title="Item"><display/></default-field></field><field name="itemTypeEnumId" from="orderItem.itemTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="productId" from="orderItem.productId"><conditional-field condition="orderItem.productId" title="Product"><display-entity entity-name="mantle.product.Product" text="ProductNameTemplate"/></conditional-field><default-field><ignored/></default-field></field><field name="orderQuantity" from="returnableOut.orderQuantity"><conditional-field condition="returnableOut.isProductItemType"><display/></conditional-field></field><field name="billedQuantity" from="returnableOut.invoiceQuantity"><conditional-field condition="returnableOut.isProductItemType"><display/></conditional-field></field><field name="returnedQuantity" from="returnableOut.returnedQuantity"><conditional-field condition="returnableOut.isProductItemType"><display/></conditional-field></field><field name="returnableQuantity" from="returnableOut.returnableQuantity"><conditional-field condition="returnableOut.isProductItemType"><display/></conditional-field></field><field name="orderTotal" from="returnableOut.orderTotal"><conditional-field condition="!returnableOut.isProductItemType"><display format="#,##0.00"/></conditional-field></field><field name="billedTotal" from="returnableOut.invoiceTotal"><conditional-field condition="!returnableOut.isProductItemType"><display format="#,##0.00"/></conditional-field></field><field name="returnedTotal" from="returnableOut.returnedTotal"><conditional-field condition="!returnableOut.isProductItemType"><display format="#,##0.00"/></conditional-field></field><field name="returnableTotal" from="returnableOut.returnableTotal"><conditional-field condition="!returnableOut.isProductItemType"><display format="#,##0.00"/></conditional-field></field><field name="returnId"><default-field title="Return"><drop-down><list-options list="openReturnsOut.openReturnList" key="${returnId}" text="#${returnId} ${ec.l10n.format(entryDate, '')}"/></drop-down></default-field></field><field name="returnQuantity" from="returnableOut.returnableQuantity"><conditional-field condition="returnableOut.isProductItemType"><text-line size="6"/></conditional-field></field><field name="inventoryStatusId"><conditional-field title="Inventory Status" condition="returnableOut.isProductItemType"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="Asset"/><set field="noCurrentSelectedKey" value="AstReturned"/></widget-template-include></conditional-field></field><field name="returnPrice" from="returnableOut.returnableTotal"><conditional-field title="Refund Amount" condition="!returnableOut.isProductItemType"><text-line size="6"/></conditional-field></field><field name="returnReasonEnumId"><default-field title="Reason"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ReturnReason"/><set field="style" value=" "/></widget-template-include></default-field></field><field name="returnResponseEnumId"><default-field title="Response"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ReturnResponse"/><set field="style" value=" "/></widget-template-include></default-field></field><field name="responseImmediate"><default-field title="Immediate?"><drop-down><option key="N" text="N - On Received"/><option key="Y" text="Y - On Approved"/></drop-down></default-field></field><field name="submitButton"><default-field title="Add to Return"><submit/></default-field></field><field-layout><field-row><field-ref name="orderItemSeqId"/><field-ref name="itemTypeEnumId"/></field-row><field-ref name="productId"/><field-row><field-ref name="orderQuantity"/><field-ref name="billedQuantity"/></field-row><field-row><field-ref name="returnableQuantity"/><field-ref name="returnedQuantity"/></field-row><field-row><field-ref name="orderTotal"/><field-ref name="billedTotal"/></field-row><field-row><field-ref name="returnableTotal"/><field-ref name="returnedTotal"/></field-row><field-ref name="returnId"/><field-row><field-ref name="returnQuantity"/><field-ref name="inventoryStatusId"/></field-row><field-ref name="returnPrice"/><field-ref name="returnReasonEnumId"/><field-row><field-ref name="returnResponseEnumId"/><field-ref name="responseImmediate"/></field-row><fields-not-referenced/></field-layout></form-single></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Order/OrderDetail.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Order Detail" default-menu-index="1"><parameter name="orderId" required="true"/><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition name="editSupplier"><default-response url="//${appRoot}/Supplier/EditSupplier"/></transition><transition name="editCustomer"><default-response url="//${appRoot}/Customer/EditCustomer"/></transition><transition name="editFacility"><default-response url="//${appRoot}/Facility/EditFacility"/></transition><transition name="editProduct"><default-response url="//${appRoot}/Product/EditProduct"/></transition><transition name="assetDetail"><default-response url="//${appRoot}/Asset/AssetDetail"/></transition><transition name="editInvoice"><default-response url="//${appRoot}/Accounting/Invoice/EditInvoice"/></transition><transition name="editPayment"><default-response url="//${appRoot}/Accounting/Payment/EditPayment"/></transition><transition name="editPaymentMethod"><default-response url="//${appRoot}/Party/PaymentMethod/EditPaymentMethod"/></transition><transition name="systemMessageDetail"><default-response url="//apps/system/SystemMessage/Message/SystemMessageDetail"/></transition><transition name="updateOrderHeader"><service-call name="mantle.order.OrderServices.update#OrderHeader" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateOrderRecur"><service-call name="mantle.order.OrderServices.update#OrderRecur" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="requestOrder"><service-call name="mantle.order.OrderServices.update#OrderStatus" in-map="[orderId:orderId, orderPartSeqId:orderPartSeqId, statusId:'OrderRequested']" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="proposeOrder"><service-call name="mantle.order.OrderServices.update#OrderStatus" in-map="[orderId:orderId, orderPartSeqId:orderPartSeqId, statusId:'OrderProposed']" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="rejectOrder"><service-call name="mantle.order.OrderServices.update#OrderStatus" in-map="[orderId:orderId, orderPartSeqId:orderPartSeqId, statusId:'OrderRejected']" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="placeOrder"><service-call name="mantle.order.OrderServices.place#Order" in-map="context + [requireInventory:false]" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="approveOrder"><service-call name="mantle.order.OrderServices.approve#Order" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="sendOrder"><service-call name="mantle.order.OrderServices.update#OrderStatus" in-map="[orderId:orderId, orderPartSeqId:orderPartSeqId, statusId:'OrderSent']" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="holdOrder"><service-call name="mantle.order.OrderServices.update#OrderStatus" in-map="[orderId:orderId, orderPartSeqId:orderPartSeqId, statusId:'OrderHold']" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="completeOrderPart"><service-call name="mantle.order.OrderServices.complete#OrderPart" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="cancelOrder"><service-call name="mantle.order.OrderServices.cancel#Order" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="cancelOrderPart"><service-call name="mantle.order.OrderServices.cancel#OrderPart" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="cancelOrderItem"><service-call name="mantle.order.OrderServices.cancel#OrderItem" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="cloneOrder"><service-call name="mantle.order.OrderServices.clone#Order" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="addOrderPromoCode"><service-call name="mantle.product.PromotionServices.add#OrderPromoCode" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="removeOrderPromoCode"><service-call name="mantle.product.PromotionServices.remove#OrderPromoCode" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="sendOrderStoreEmail"><service-call name="mantle.order.OrderInfoServices.send#OrderStoreEmail" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="sendEmailMessage"><service-call name="org.moqui.impl.EmailServices.send#EmailMessage" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="recalcOrderPartItemAmounts"><service-call name="mantle.order.OrderServices.recalc#OrderPartItemAmounts" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="invoiceOrderPart"><service-call name="mantle.account.InvoiceServices.create#EntireOrderPartInvoice" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="shipOrderPart"><service-call name="mantle.shipment.ShipmentServices.create#OrderPartShipment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="addOrderPartToShipment"><service-call name="mantle.shipment.ShipmentServices.add#OrderPartToShipment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="shipmentDetail"><default-response url="//${appRoot}/Shipment/ShipmentDetail"/></transition><transition name="createNote"><service-call name="create#mantle.order.OrderNote" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateNote"><service-call name="update#mantle.order.OrderNote" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createContent"><service-call name="mantle.order.OrderServices.create#OrderContent" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateContent"><service-call name="mantle.order.OrderServices.update#OrderContent" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="downloadContent" read-only="true"><parameter name="orderContentId"/><actions><entity-find-one entity-name="mantle.order.OrderContent" value-field="orderContent"/><script><![CDATA[ec.web.sendResourceResponse(orderContent.contentLocation)]]></script></actions><default-response type="none"/></transition><transition name="setOrderBillingShippingInfo"><service-call name="mantle.order.OrderServices.set#OrderBillingShippingInfo" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="validateAddress"><service-call name="mantle.shipment.CarrierServices.validate#PostalAddress" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createOrderPart"><service-call name="mantle.order.OrderServices.create#OrderPart" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateOrderPart"><service-call name="mantle.order.OrderServices.update#OrderPart" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="addOrderPartPayment"><service-call name="mantle.order.OrderServices.add#OrderPartPayment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updatePayment"><service-call name="mantle.account.PaymentServices.update#Payment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="gatewayAuthorize"><service-call name="mantle.account.PaymentServices.authorize#SinglePayment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createReturnFromOrder"><service-call name="mantle.order.ReturnServices.create#ReturnFromOrder" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="editReturn"><default-response url="//${appRoot}/Return/EditReturn"/></transition><transition name="createOrderPartParty"><service-call name="create#mantle.order.OrderPartParty" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteOrderPartParty"><service-call name="delete#mantle.order.OrderPartParty" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="addProductItem"><service-call name="mantle.order.OrderServices.add#OrderProductQuantity" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createItem"><service-call name="mantle.order.OrderServices.create#OrderItem" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateItem"><service-call name="mantle.order.OrderServices.update#OrderItem" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteItem"><service-call name="mantle.order.OrderServices.delete#OrderItem" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="removeOrderItemReservations"><service-call name="mantle.product.AssetServices.remove#OrderItemReservations" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getProductPrice" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getFacilityList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><transition name="getShippingOptions"><parameter name="orderId"/><parameter name="orderPartSeqId"/><actions><entity-find-one entity-name="mantle.order.OrderHeader" value-field="orderHeader"/><service-call name="mantle.product.StoreServices.get#StoreShippingOptions" out-map="shipOptsOut" in-map="[productStoreId:orderHeader.productStoreId, orderId:orderId, orderPartSeqId:orderPartSeqId,                             postalContactMechId:postalContactMechId, getRates:true]"/><script><![CDATA[outList = []
            for (sop in shipOptsOut.shippingOptions) outList.add([value:"${sop.carrierPartyId}:${sop.shipmentMethodEnumId}".toString(),
                label:"${sop.description ? sop.description : (sop.carrierPartyId != '_NA_' ? (sop.carrierName + ' - ') : '') + sop.shipmentMethodDescription}${sop.shippingTotal != null ? ' ' + ec.l10n.formatCurrency(sop.shippingTotal, orderHeader.currencyUomId) : ''}".toString()])
            ec.web.sendJsonResponse(outList)]]></script></actions><default-response type="none"/></transition><transition name="EmailMessage" read-only="true"><parameter name="emailMessageId"/><actions><entity-find-one entity-name="moqui.basic.email.EmailMessage" value-field="emailMessage"/><script><![CDATA[ec.web.sendTextResponse(emailMessage?.body, "text/html", null)]]></script></actions><default-response type="none"/></transition><transition name="PrintOrder.pdf"><default-response url="${ec.web.getWebappRootUrl(false, null)}/fop/apps/${appRoot}/Order/PrintOrder" url-type="plain"><parameter name="renderMode" value="xsl-fo"/><parameter name="pageNoLimit" value="true"/><parameter name="orderId"/><parameter name="filename" value="Order-${orderId}.pdf"/></default-response></transition><transition name="setItemLimit"><actions><script><![CDATA[ec.user.setPreference('order.detail.item.limit', itemLimit)]]></script></actions><default-response url="."/></transition><subscreens><subscreens-item name="UpdateContactInfo" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty/UpdateContactInfo.xml"/><subscreens-item name="UpdatePaymentMethodInfo" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty/UpdatePaymentMethodInfo.xml"/></subscreens><actions><set field="defaultItemLimit" from="ec.user.getPreference('order.detail.item.limit') ?: '10'"/><set field="itemLimit" from="itemLimit ?: defaultItemLimit"/><service-call name="mantle.order.OrderInfoServices.get#OrderDisplayInfo" in-map="[orderId:orderId, itemLimit:(itemLimit as Integer)]" out-map="context"/><set field="firstPartInfo" from="orderPartInfoList[0]"/><set field="vendorRole" value="OrgInternal,Supplier,Vendor"/><set field="customerRole" value="OrgInternal,Customer"/><entity-find entity-name="moqui.basic.EnumGroupMember" list="productItemTypeEgms" cache="true"><econdition field-name="enumGroupEnumId" value="EngItemsProduct"/></entity-find><set field="productItemTypes" from="productItemTypeEgms*.enumId"/><if condition="orderHeader.statusId in ['OrderPlaced', 'OrderProcessing', 'OrderHold']"><service-call name="mantle.order.OrderInfoServices.check#OrderPreApprove" in-map="[orderId:orderId]" out-map="context"/></if></actions><widgets><section name="OrderHeaderSection"><widgets><container-row><row-col lg="6"><container-row><row-col sm="6"><label text="Order #${orderId}" type="h4"/></row-col><row-col sm="6"><label text="Web Order (ecommerce)" condition="orderHeader?.salesChannelEnumId == 'ScWeb'" type="h4" style="text-success"/></row-col></container-row><label text="Recurring Order: ${recurCronDescription}" condition="recurCronDescription" type="h4" style="text-success"/><section name="PlaceSection" condition="orderHeader.statusId in ['OrderOpen', 'OrderProposed', 'OrderBeingChanged', 'OrderHold']"><widgets><link url="placeOrder" text="Place" link-type="hidden-form" condition="!placeWarnings" style="btn-success"/><container-dialog id="PlaceOrderDialog" button-text="Place Warnings" condition="placeWarnings" type="success"><section-iterate name="PlaceWarningsSection" list="placeWarnings" entry="placeWarning"><widgets><label text="${placeWarning}" type="p"/></widgets></section-iterate><link url="placeOrder" text="Place Order Anyway" link-type="hidden-form"/></container-dialog></widgets></section><section name="ApproveSection" condition="orderHeader.statusId in ['OrderPlaced', 'OrderProcessing', 'OrderHold']"><widgets><link url="approveOrder" text="Approve" link-type="hidden-form" style="btn-success" condition="ec.user.hasPermission('ORDER_APPROVE') && !approveWarnings"/><container-dialog id="ApproveOrderDialog" button-text="Approve Warnings" condition="approveWarnings" type="success"><section-iterate name="ApproveWarningsSection" list="approveWarnings" entry="approveWarning"><widgets><label text="${approveWarning}" type="p"/></widgets></section-iterate><link url="approveOrder" text="Approve Order Anyway" link-type="hidden-form" condition="ec.user.hasPermission('ORDER_APPROVE')"/></container-dialog></widgets></section><link url="placeOrder" text="Un-approve" link-type="hidden-form" condition="orderHeader.statusId == 'OrderApproved'" confirmation="Un-approve order (change status back to Placed)?"/><link url="sendOrder" text="Order Sent" link-type="hidden-form" condition="orderHeader.statusId == 'OrderApproved' && firstPartInfo.isCustomerInternalOrg" confirmation="Mark order as Sent?"/><link url="holdOrder" text="Hold" link-type="hidden-form" confirmation="Really hold order?" condition="orderHeader.statusId in ['OrderPlaced', 'OrderProcessing', 'OrderApproved']"/><link url="requestOrder" text="Quote Requested" link-type="hidden-form" confirmation="Set order as quote requested by customer?" condition="orderHeader.statusId == 'OrderOpen'"/><link url="proposeOrder" text="Propose Quote" link-type="hidden-form" confirmation="Propose quote to customer?" condition="orderHeader.statusId in ['OrderOpen', 'OrderRequested']"/><link url="rejectOrder" text="Reject Quote Request" link-type="hidden-form" confirmation="Reject quote request and reject order?" condition="orderHeader.statusId == 'OrderRequested'"/><container-dialog id="CloseOrderDialog" button-text="Close Order" type="warning" condition="orderHeader.statusId in ['OrderOpen', 'OrderProposed', 'OrderPlaced', 'OrderProcessing', 'OrderApproved', 'OrderHold']"><section-iterate name="CloseOrderPartList" list="orderPartInfoList" entry="orderPartInfo"><actions><set field="partProductItems" from="orderPartInfo.partNoParentOrderItemList?.findAll({ it.itemTypeEnumId in productItemTypes })"/></actions><widgets><label text="Order Part ${orderPartInfo.orderPart.orderPartSeqId} Facility ${ec.resource.expand('FacilityNameTemplate', null, orderPartInfo.facility)}" type="h4"/><form-list name="CloseOrderPartItems" list="partProductItems" skip-form="true"><row-actions><set field="itemQuantityNotShipped" from="quantityNotShippedByItem.get(orderItemSeqId) ?: 0.0"/><set field="itemQuantityShipped" from="(quantity?:0.0) - itemQuantityNotShipped"/></row-actions><field name="orderItemSeqId"><default-field title="Item"><display/></default-field></field><field name="productId"><default-field title="Product"><display-entity entity-name="mantle.product.Product" text="ProductNameTemplate"/></default-field></field><field name="quantity"><default-field><display/></default-field></field><field name="itemQuantityShipped"><default-field title="Shipped"><display/></default-field></field><field name="itemQuantityNotShipped"><default-field title="To Cancel"><display style="${itemQuantityNotShipped ? 'text-danger' : ''}"/></default-field></field></form-list></widgets></section-iterate><label text="OrderDetailConfirmCloseOrder" type="p"/><link url="cancelOrder" text="Close Order" link-type="hidden-form" btn-type="warning" confirmation="OrderDetailConfirmCloseOrder"/></container-dialog><container-dialog id="AddPartDialog" button-text="Add Part" condition="orderHeader.statusId in ['OrderOpen', 'OrderProposed', 'OrderBeingChanged', 'OrderPlaced']"><form-single name="AddPartForm" transition="createOrderPart"><field name="orderId"><default-field><hidden/></default-field></field><field name="vendorPartyId" from="firstPartInfo.orderPart.vendorPartyId"><default-field><hidden/></default-field></field><field name="customerPartyId" from="firstPartInfo.orderPart.customerPartyId"><default-field><hidden/></default-field></field><field name="facilityId" from="firstPartInfo.orderPart.facilityId"><default-field title="Facility"><drop-down><dynamic-options transition="getFacilityList" server-search="true" min-length="0" parameter-map="[facilityTypeEnumId:'FcTpWarehouse']"/></drop-down></default-field></field><field name="shipBeforeDate"><default-field><date-time/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><link url="approveOrder" text="Uncomplete Order" link-type="hidden-form" confirmation="Change back to Approved status to allow shipping, etc?" condition="ec.user.hasPermission('ORDER_APPROVE') && orderHeader.statusId == 'OrderCompleted'"/><link url="PrintOrder.pdf" text="Order PDF"/><link url="cloneOrder" text="Clone" confirmation="Create new order based on this one?" parameter-map="[baseOrderId:orderId]"/><container-dialog id="RecurDialog" button-text="Recurring" type="${orderHeader.recurCronExpression ? (orderHeader.statusId == 'OrderApproved' ? 'success' : 'warning') : 'primary'}"><label text="Order is not in Approved status" type="p" style="text-warning" condition="orderHeader.statusId != 'OrderApproved'"/><label text="Recurring orders in the Approved status will be automatically cloned according to the schedule and the clone will be automatically Placed. If there are no Approve Warnings the cloned order will be automatically Approved. If Auto Invoice is set to Y then if Approved will also create an Invoice for the Order." type="p"/><form-single name="RecurOptions" map="orderHeader" transition="updateOrderRecur"><field name="orderId"><default-field><hidden/></default-field></field><field name="recurCronExpression"><default-field title="Recur Schedule"><drop-down allow-empty="true"><option key="${cronExpression}" text="Current: ${recurCronDescription ?: 'None'}"/><option key="0 0 2 ? * MON" text="Weekly on Monday at 2 AM"/><option key="0 0 2 1 * ?" text="Monthly on the 1st at 2 AM"/><option key="0 0 2 15 * ?" text="Monthly on the 15th at 2 AM"/></drop-down></default-field></field><field name="recurAutoInvoice"><default-field title="Auto Invoice"><radio no-current-selected-key="N"><option key="Y"/><option key="N"/></radio></default-field></field><field name="lodInfo"><default-field title=""><label text="Last Ordered Date will be updated over time as recurring Order Clones are created." type="p"/><label text="If Last Ordered Date is empty the next Order Clone will be created with the next batch." type="p"/><label text="To not create the next Order Clone until the scheduled time, set this to now or any time since the last scheduled time." type="p"/></default-field></field><field name="lastOrderedDate"><default-field><date-time/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></container-dialog><container-dialog id="AuditLogDialog" button-text="Audit Log" width="960"><form-list name="AuditLogList" list="auditLogList" skip-form="true"><entity-find entity-name="moqui.entity.EntityAuditLog" list="auditLogList"><econdition field-name="changedEntityName" operator="in" from="['mantle.order.OrderHeader', 'mantle.order.OrderPart', 'mantle.order.OrderItem']"/><econdition field-name="pkPrimaryValue" from="orderId"/><select-field field-name="changedEntityName"/><order-by field-name="-changedDate,pkSecondaryValue"/></entity-find><field name="changedDate"><default-field title="Date"><display/></default-field></field><field name="changedByUserId"><default-field title="User"><display-entity text="UsernameTemplate" entity-name="mantle.party.PersonWithUserAccount" key-field-name="userId"/></default-field></field><field name="pkSecondaryValue"><default-field title="Part/Item"><display/></default-field></field><field name="changedEntityName"><default-field title="Entity"><display text="${org.moqui.util.StringUtilities.camelCaseToPretty(changedEntityName.substring(changedEntityName.lastIndexOf('.')+1))}"/></default-field></field><field name="changedFieldName"><default-field title="Field"><display text="${org.moqui.util.StringUtilities.camelCaseToPretty(changedFieldName)}"/></default-field></field><field name="oldValueText"><default-field title="From"><display text="${ec.entity.formatFieldString(changedEntityName, changedFieldName, oldValueText)}"/></default-field></field><field name="newValueText"><default-field title="To"><display text="${ec.entity.formatFieldString(changedEntityName, changedFieldName, newValueText)}"/></default-field></field></form-list></container-dialog><section-iterate name="InvoiceLinks" list="invoiceIdSet" entry="invoiceId"><widgets><link url="editInvoice" text="Invoice ${invoiceId}" link-type="anchor-button"/></widgets></section-iterate><form-single name="HeaderForm" transition="updateOrderHeader" map="orderHeader"><field name="orderId"><default-field><hidden/></default-field></field><field name="parentOrderId"><conditional-field title="Parent Order" condition="parentOrderId"><link url="." text="${parentOrderId}" parameter-map="[orderId:parentOrderId]" link-type="anchor"/></conditional-field></field><field name="statusId"><default-field title="Status"><display text="${statusItem.description}"/></default-field></field><field name="entryDate"><default-field title="Entry"><display/></default-field></field><field name="placedDate"><conditional-field condition="orderEditable" title="Placed"><date-time/></conditional-field><default-field title="Placed"><display/></default-field></field><field name="orderName"><conditional-field condition="orderEditable"><text-line size="40"/></conditional-field><default-field title="Name"><display/></default-field></field><field name="orderRevision"><default-field title="Revision"><display also-hidden="false"/></default-field></field><field name="salesChannelEnumId"><conditional-field condition="orderEditable" title="Source"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="SalesChannel"/><set field="allowEmpty" value="true"/></widget-template-include></conditional-field><default-field title="Source"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="systemMessageRemoteId"><conditional-field condition="orderEditable" title="Message Remote"><drop-down allow-empty="true"><entity-options key="${systemMessageRemoteId}" text="${description}"><entity-find entity-name="moqui.service.message.SystemMessageRemote"><order-by field-name="description"/></entity-find></entity-options></drop-down></conditional-field><default-field title="Message Remote"><display-entity entity-name="moqui.service.message.SystemMessageRemote" key-field-name="systemMessageRemoteId"/></default-field></field><field name="displayId"><conditional-field condition="orderEditable"><text-line size="20"/></conditional-field><default-field><display/></default-field></field><field name="externalId"><conditional-field condition="orderEditable"><text-line size="20"/></conditional-field><default-field><display/></default-field></field><field name="externalRevision"><conditional-field title="Ext Rev" condition="externalRevision"><display also-hidden="false"/></conditional-field></field><field name="grandTotal"><default-field><display currency-unit-field="currencyUomId"/></default-field></field><field name="submitButton"><conditional-field condition="orderEditable" title="Update Header"><submit/></conditional-field><default-field><ignored/></default-field></field><field-layout><field-ref name="parentOrderId"/><field-row><field-ref name="statusId"/><field-ref name="orderRevision"/></field-row><field-row><field-ref name="entryDate"/><field-ref name="placedDate"/></field-row><field-ref name="orderName"/><field-row><field-ref name="salesChannelEnumId"/><field-ref name="systemMessageRemoteId"/></field-row><field-row><field-ref name="displayId"/><field-ref name="externalId"/></field-row><field-row><field-ref name="grandTotal"/><field-ref name="externalRevision"/></field-row><field-ref name="submitButton"/></field-layout></form-single><section name="OrderPromoCodeSection"><actions><entity-find entity-name="mantle.product.store.PartyPromoCodeDetail" list="partyPromoCodeDetailList"><date-filter valid-date="orderHeader.placedDate"/><date-filter from-field-name="promoFromDate" thru-field-name="promoThruDate" valid-date="orderHeader.placedDate"/><econdition field-name="partyId" from="firstPart.customerPartyId"/><econdition field-name="productStoreId" from="orderHeader.productStoreId" ignore-if-empty="true"/></entity-find></actions><widgets><container-box><box-header title="Promo Codes"/><box-toolbar><container-dialog id="AddPromoCodeDialog" button-text="Add Promo Code"><form-single name="AddPromoCode" transition="addOrderPromoCode"><field name="orderId"><default-field><hidden/></default-field></field><field name="promoCode"><default-field title="Any Promo Code"><text-line size="8"/></default-field></field><field name="addButton"><default-field title=""><submit text="Add Code"/></default-field></field><field-layout><field-row-big><field-ref name="promoCode"/><field-ref name="addButton"/></field-row-big></field-layout></form-single><section name="AddPartyPromoCodeSection" condition="partyPromoCodeDetailList"><widgets><form-single name="AddPartyPromoCode" transition="addOrderPromoCode"><field name="orderId"><default-field><hidden/></default-field></field><field name="promoCode"><default-field title="Customer Promo Code"><drop-down><list-options list="partyPromoCodeDetailList" key="${promoCode}" text="${promoCode} - ${itemDescription ?: '[' + storePromotionId + ']'}"/></drop-down></default-field></field><field name="addButton"><default-field title=""><submit text="Add Code"/></default-field></field><field-layout><field-row-big><field-ref name="promoCode"/><field-ref name="addButton"/></field-row-big></field-layout></form-single></widgets></section></container-dialog></box-toolbar><box-body-nopad><form-list name="OrderPromoCodeList" list="orderPromoCodeDetailList" transition="removeOrderPromoCode"><field name="orderId"><default-field><hidden/></default-field></field><field name="promoCodeId"><default-field><hidden/></default-field></field><field name="promoCode"><default-field><display/></default-field></field><field name="itemDescription"><default-field title="Promotion"><display text="${itemDescription ?: '[' + storePromotionId + ']'}"/></default-field></field><field name="thruDate"><default-field title="Code Expires"><display/></default-field></field><field name="promoThruDate"><default-field title="Promo Expires"><display/></default-field></field><field name="promoThruDate"><default-field title="Promo Expires"><display/></default-field></field><field name="removeButton"><default-field title=""><submit icon="fa fa-trash"/></default-field></field></form-list></box-body-nopad></container-box></widgets></section></row-col><row-col lg="6"><section name="ItemLimitSection" condition="orderItemNoParentCount > 10"><widgets><form-single name="ItemLimitForm" transition="setItemLimit"><field name="orderId"><default-field><hidden/></default-field></field><field name="itemLimit"><default-field><drop-down><option key="10"/><option key="20"/><option key="50"/><option key="100"/></drop-down></default-field></field><field name="submitBtn"><default-field title="Update"><submit/></default-field></field><field-layout><field-row-big><field-ref name="itemLimit"/><field-ref name="submitBtn"/></field-row-big></field-layout></form-single></widgets></section><section-include name="StatusHistorySection" location="component://SimpleScreens/template/basic/StatusWidgets.xml"/><section name="CustomerNotesSection"><actions><entity-find entity-name="mantle.party.PartyNote" list="customerNoteList"><econdition field-name="partyId" from="firstPartInfo.orderPart.customerPartyId"/><order-by field-name="-noteDate"/></entity-find></actions><widgets><section name="CustomerNotesInner" condition="customerNoteList"><widgets><container-box type="danger"><box-header title="Customer Notes"/><box-body><section-iterate name="CustomerNoteIterate" list="customerNoteList" entry="partyNote"><actions><entity-find-one entity-name="mantle.party.PersonWithUserAccount" value-field="paua"><field-map field-name="userId" from="partyNote.userId"/></entity-find-one></actions><widgets><label text="By ${paua?.firstName?:''} ${paua?.lastName?:''} (${paua?.username ?: partyNote.userId}) at ${ec.l10n.format(partyNote.noteDate, 'yyyy-MM-dd HH:mm')}" type="strong"/><label text="${partyNote.noteText}" type="p"/></widgets></section-iterate></box-body></container-box></widgets></section></widgets></section><section name="NotesSection"><widgets><container-box><box-header title="Order Notes"/><box-toolbar><container-dialog id="NewNoteDialog" button-text="Add Note"><form-single name="NewNoteForm" transition="createNote"><field name="orderId"><default-field><hidden/></default-field></field><field name="noteText"><default-field title="Note"><text-area cols="60" rows="6"/></default-field></field><field name="submitButton"><default-field title="Add Note"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><section-iterate name="NoteIterateSection" list="orderNoteList" entry="note"><actions><entity-find-one entity-name="mantle.party.PersonWithUserAccount" value-field="paua"><field-map field-name="userId" from="note.userId"/></entity-find-one></actions><widgets><label text="By ${paua?.firstName?:''} ${paua?.lastName?:''} (${paua?.username ?: note.userId}) at ${ec.l10n.format(note.noteDate, 'yyyy-MM-dd HH:mm')}" type="strong"/><section name="UpdateNoteSection" condition="note.userId == ec.user.userId"><widgets><container-dialog id="UpdateNoteContainer" button-text="Edit Note"><form-single name="UpdateNoteForm" transition="updateNote" map="note"><field name="orderId"><default-field><hidden/></default-field></field><field name="noteDate"><default-field><hidden/></default-field></field><field name="noteText"><default-field title="Note"><text-area cols="60" rows="6"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></container-dialog></widgets></section><label text="${note.noteText}" type="p"/></widgets></section-iterate></box-body></container-box></widgets></section><section name="ContentSection"><actions><entity-find entity-name="mantle.order.OrderContent" list="contentList"><econdition field-name="orderId"/><order-by field-name="-contentDate"/></entity-find></actions><widgets><container-box><box-header title="Attachments"/><box-toolbar><container-dialog id="NewContentDialog" button-text="Add Attachment"><form-single name="NewContentForm" transition="createContent"><field name="orderId"><default-field><hidden/></default-field></field><field name="contentFile"><default-field><file/></default-field></field><field name="description"><default-field><text-line size="60"/></default-field></field><field name="submitButton"><default-field title="Add Attachment"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><section-iterate name="ContentIterateSection" list="contentList" entry="content"><actions><entity-find-one entity-name="mantle.party.PersonWithUserAccount" value-field="paua"><field-map field-name="userId" from="content.userId"/></entity-find-one></actions><widgets><container><link url="downloadContent" condition="content.contentLocation" parameter-map="[orderContentId:content.orderContentId]" text="Download ${content.contentLocation.substring(content.contentLocation.lastIndexOf('/')+1)}"/><section name="UpdateContentContainerSection" condition="orderEditable"><widgets><container-dialog id="UpdateContentContainer" button-text="Edit Attachment"><form-single name="UpdateContentForm" transition="updateContent" map="content"><field name="orderContentId"><default-field><hidden/></default-field></field><field name="orderId"><default-field><hidden/></default-field></field><field name="contentFile"><default-field><file/></default-field></field><field name="description"><default-field><text-line size="60"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></container-dialog></widgets></section><container><label text="By ${paua?.firstName?:''} ${paua?.lastName?:''} (${paua?.username ?: content.userId}) at ${ec.l10n.format(content.contentDate, 'yyyy-MM-dd HH:mm')}"/></container><label text="${content.description ?: 'No Description'}" type="p"/></container></widgets></section-iterate></box-body></container-box></widgets></section><section name="EmailMessageSection"><widgets><container-box><box-header title="Email Messages"/><box-toolbar><section name="SendPlacedEmailSection" condition="!(orderHeader.statusId in ['OrderBeingChanged'])"><actions><set field="customerPartyId" from="orderPartList[0].customerPartyId"/><if condition="customerPartyId"><service-call name="mantle.party.ContactServices.get#PartyContactInfo" out-map="emailInfo" in-map="[partyId:customerPartyId, emailContactMechPurposeId:'EmailOrder', defaultToPrimaryPurpose:true]"/><set field="toAddresses" from="emailInfo.emailAddress"/></if></actions><widgets><container-dialog id="SendPlacedEmailDialog" button-text="Send Email"><form-single name="SendPlacedEmailForm" transition="sendOrderStoreEmail"><field name="orderId"><default-field><hidden/></default-field></field><field name="forceByType"><default-field><hidden default-value="true"/></default-field></field><field name="emailTypeEnumId" from="'PsetOrderPlaced'"><default-field><hidden/></default-field></field><field name="toAddresses"><default-field title="To Address"><text-line size="40"/></default-field></field><field name="submitButton"><default-field title="Send Email"><submit/></default-field></field></form-single></container-dialog></widgets></section></box-toolbar><box-body-nopad><form-list name="EmailMessageList" list="emailMessageList" skip-form="true"><entity-find entity-name="mantle.order.OrderEmailMessageDetail" list="emailMessageList"><econdition field-name="orderId"/><order-by field-name="sentDate,emailMessageId"/></entity-find><field name="emailMessageId"><default-field title="ID"><link url="EmailMessage" text="${emailMessageId}" link-type="anchor" target-window="_blank"/></default-field></field><field name="orderRevision"><default-field title="Rev"><display/></default-field></field><field name="sentDate"><default-field><display/></default-field></field><field name="toAddresses"><default-field><display/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="receivedDate"><default-field><display/></default-field></field><field name="emailTypeEnumId"><default-field title="Email Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="sendLink"><default-field title=""><link url="sendEmailMessage" text="Send" parameter-map="[emailMessageId:emailMessageId]" condition="!(statusId in ['ES_DRAFT', 'ES_CANCELLED'])" confirmation="Send this email message?"/></default-field></field></form-list></box-body-nopad></container-box></widgets></section><section name="SystemMessageSection" condition="systemMessageList"><widgets><container-box><box-header title="System Messages"/><box-body-nopad><form-list name="SystemMessageList" list="systemMessageList" skip-form="true"><field name="systemMessageId"><default-field title="Message"><link url="systemMessageDetail" text="${systemMessageId}" link-type="anchor"/></default-field></field><field name="isOutgoing"><default-field title="In/Out"><display text="${isOutgoing == 'Y' ? 'Out' : 'In'}"/></default-field></field><field name="initDate"><default-field title="Init"><display/></default-field></field><field name="processedDate"><default-field title="Processed"><display/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="systemMessageTypeId"><default-field title="Type"><display-entity entity-name="moqui.service.message.SystemMessageType" text="${description}"/></default-field></field><field name="systemMessageRemoteId"><default-field title="Remote"><display-entity entity-name="moqui.service.message.SystemMessageRemote" text="${description}"/></default-field></field></form-list></box-body-nopad></container-box></widgets></section><section name="ChildOrders" condition="childOrderList"><widgets><container-box><box-header title="Child/Cloned Orders"/><box-body><form-list name="ChildOrderList" list="childOrderList" skip-form="true"><field name="orderId"><default-field title="Order"><link url="." text="${orderId}" link-type="anchor"/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="entryDate"><default-field><display/></default-field></field><field name="approvedDate"><default-field title="Approved"><display/></default-field></field><field name="grandTotal"><default-field title="Total"><display format="#,##0.00"/></default-field></field></form-list></box-body></container-box></widgets></section></row-col></container-row></widgets></section><section-iterate name="OrderPartSection" list="orderPartInfoList" entry="orderPartInfo"><actions><set field="contactInfo" from="orderPartInfo.facilityContactInfo"/><set field="orderPart" from="orderPartInfo.orderPart"/><set field="orderPartSeqId" from="orderPart.orderPartSeqId"/><set field="customerPartyId" from="orderPart.customerPartyId"/><set field="customerShipToPartyId" from="orderPartInfo.customerShipToDetail?.partyId"/><set field="customerBillToPartyId" from="orderPartInfo.customerBillToDetail?.partyId"/><set field="applicableParentItems" from="orderPartInfo.partNoParentOrderItemList"/><service-call name="mantle.product.StoreServices.get#StoreShippingOptions" out-map="context" in-map="[productStoreId:orderHeader.productStoreId, orderId:orderId, orderPartSeqId:orderPartSeqId,                             postalContactMechId:orderPart.postalContactMechId, getRates:false]"/><set field="shippingPostalAddressList" from="new ArrayList()"/><set field="customerShipPartyIdSet" from="new TreeSet()"/><script><![CDATA[if (customerPartyId) customerShipPartyIdSet.add(customerPartyId)]]></script><script><![CDATA[if (customerShipToPartyId) customerShipPartyIdSet.add(customerShipToPartyId)]]></script><iterate list="customerShipPartyIdSet" entry="curPartyId"><service-call name="mantle.party.ContactServices.get#PartyContactInfoList" out-map="customerShippingInfo" in-map="[partyId:curPartyId, postalContactMechPurposeId:'PostalShippingDest']"/><script><![CDATA[shippingPostalAddressList.addAll(customerShippingInfo.postalAddressList ?: [])]]></script><entity-find entity-name="mantle.facility.Facility" list="curFacList"><econdition field-name="ownerPartyId" from="curPartyId"/></entity-find><iterate list="curFacList" entry="curFac"><service-call name="mantle.facility.ContactServices.get#FacilityContactInfo" out-map="facContactInfo" out-map-add-to-existing="false" in-map="[facilityId:curFac.facilityId, postalContactMechPurposeId:'PostalPrimary',                                 telecomContactMechPurposeId:'PhonePrimary', emailContactMechPurposeId:'EmailPrimary']"/><if condition="facContactInfo.postalContactMech"><script><![CDATA[shippingPostalAddressList.add(facContactInfo)]]></script></if></iterate></iterate><if condition="customerPartyId && orderPart.postalContactMechId && !(orderPart.postalContactMechId in shippingPostalAddressList*.postalContactMechId)"><service-call name="mantle.party.ContactServices.get#PartyContactInfo" out-map="curPaInfo" in-map="[partyId:customerPartyId, postalContactMechId:orderPart.postalContactMechId]"/><script><![CDATA[shippingPostalAddressList.add(0, curPaInfo)]]></script></if><script><![CDATA[Set replacedPostalIdSet = new HashSet()
                for (int i=0; i < shippingPostalAddressList.size(); i++) {
                    String replAddressId = shippingPostalAddressList.get(i).postalContactMech?.replacesContactMechId
                    if (replAddressId && !replAddressId.equals(orderPart.postalContactMechId)) replacedPostalIdSet.add(replAddressId)
                }
                Set shippingPostalIdSet = new HashSet()
                for (int i=0; i < shippingPostalAddressList.size(); ) {
                    String curAddressId = shippingPostalAddressList.get(i).postalContactMechId
                    if (shippingPostalIdSet.contains(curAddressId) || replacedPostalIdSet.contains(curAddressId)) { shippingPostalAddressList.remove(i) }
                    else { shippingPostalIdSet.add(curAddressId); i++ }
                }]]></script><set field="shippingAddressInfo" from="orderPart.postalContactMechId ? shippingPostalAddressList.find({ orderPart.postalContactMechId.equals(it.postalContactMechId) }) : null"/></actions><widgets><container type="hr"/><container-row style="shaded-area"><row-col lg="5"><container><label text="${orderPartInfo.isVendorInternalOrg ? 'Sales' : 'Purchase'} Order Part ${orderPart.orderPartSeqId}" type="h4"/></container><section name="ShipOrderPartSection"><condition><expression><![CDATA[quantityNotShippedByPart.get(orderPart.orderPartSeqId) > 0 && !orderHeader.recurCronExpression &&
                            (orderHeader.statusId == "OrderApproved" || orderHeader.statusId == "OrderSent")]]></expression></condition><actions><entity-find entity-name="mantle.shipment.ShipmentSegmentFacilityStatus" list="ssfsList"><econdition field-name="destPostalContactMechId" from="orderPartInfo.orderPart.postalContactMechId"/><econdition field-name="shipmentMethodEnumId" from="orderPartInfo.orderPart.shipmentMethodEnumId"/><econdition field-name="fromPartyId" from="orderPartInfo.orderPart.vendorPartyId"/><econdition field-name="statusId" operator="in" value="ShipInput,ShipScheduled"/><order-by field-name="shipmentId"/></entity-find></actions><widgets><link url="shipOrderPart" text="Create Shipment" link-type="hidden-form" btn-type="success"><parameter name="orderId"/><parameter name="orderPartSeqId" from="orderPart.orderPartSeqId"/></link><section name="AddPartToShipmentSection" condition="ssfsList"><widgets><container-dialog id="AddOrderPartToShipmentDialog" button-text="Add Part to Shipment"><form-single name="AddOrderPartToShipmentForm" transition="addOrderPartToShipment"><field name="orderId"><default-field><hidden/></default-field></field><field name="orderPartSeqId" from="orderPart.orderPartSeqId"><default-field><hidden/></default-field></field><field name="shipmentId"><default-field title="Shipment"><drop-down><list-options list="ssfsList" key="${shipmentId}" text="${shipmentId}"/></drop-down></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></widgets></section></widgets></section><section-iterate name="ShipmentLinks" list="new ArrayList(orderPartInfo.partShipmentIdSet).reverse()" entry="shipmentId"><widgets><link url="shipmentDetail" text="Shipment ${shipmentId}" link-type="anchor-button"/></widgets></section-iterate><section name="EditPartSection" condition="orderPartInfo.partEditable"><widgets><container-dialog id="EditPartDialog" button-text="Edit Part ${orderPart.orderPartSeqId}" width="960"><form-single name="EditPartForm" transition="updateOrderPart" map="orderPart"><field name="orderId"><default-field><hidden/></default-field></field><field name="orderPartSeqId"><default-field><hidden/></default-field></field><field name="customerPartyId"><conditional-field title="Customer" condition="orderPartInfo.isVendorInternalOrg"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2" parameter-map="[roleTypeId:'Customer']"/></drop-down></conditional-field></field><field name="facilityId"><default-field title="Facility"><drop-down><dynamic-options transition="getFacilityList" server-search="true" min-length="0" parameter-map="[facilityTypeEnumId:'FcTpWarehouse']"/></drop-down></default-field></field><field name="priority"><default-field><radio no-current-selected-key="5"><option key="1"/><option key="2"/><option key="3"/><option key="4"/><option key="5"/><option key="6"/><option key="7"/><option key="8"/><option key="9"/></radio></default-field></field><field name="shipAfterDate"><default-field title="Ship After"><date-time/></default-field></field><field name="shipBeforeDate"><default-field title="Ship Before"><date-time/></default-field></field><field name="estimatedShipDate"><default-field title="Estimated Ship"><date-time/></default-field></field><field name="estimatedDeliveryDate"><default-field title="Estimated Delivery"><date-time/></default-field></field><field name="otherPartyOrderId"><default-field title="Their Order ID"><text-line size="40"/></default-field></field><field name="otherPartyOrderDate"><default-field title="Their Order Date"><date-time/></default-field></field><field name="shippingInstructions"><default-field><text-area rows="6" cols="120"/></default-field></field><field name="signatureRequiredEnumId"><default-field title="Sign Req."><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="SignatureRequired"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="isGift"><default-field><radio no-current-selected-key="N"><option key="N"/><option key="Y"/></radio></default-field></field><field name="giftMessage"><default-field><text-area rows="3" cols="60"/></default-field></field><field name="disablePromotions"><default-field><radio no-current-selected-key="N"><option key="N"/><option key="Y"/></radio></default-field></field><field name="disableShippingCalc"><default-field><radio no-current-selected-key="N"><option key="N"/><option key="Y"/></radio></default-field></field><field name="disableTaxCalc"><default-field><radio no-current-selected-key="N"><option key="N"/><option key="Y"/></radio></default-field></field><field name="reservationAutoEnumId"><default-field title="Auto Res."><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="AssetReservationAuto"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="settlementTermId"><default-field title="Payment Terms"><drop-down allow-empty="true"><entity-options key="${settlementTermId}" text="${description}"><entity-find entity-name="mantle.account.invoice.SettlementTermAndEnumMember"><econdition field-name="enumGroupEnumId" value="EngPaymentTermType"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></container-dialog></widgets><fail-widgets><container-dialog id="EditPartNonEdDialog" button-text="Edit Part ${orderPart.orderPartSeqId}" width="960"><form-single name="EditPartNonEdForm" transition="updateOrderPart" map="orderPart"><field name="orderId"><default-field><hidden/></default-field></field><field name="orderPartSeqId"><default-field><hidden/></default-field></field><field name="priority"><default-field><radio no-current-selected-key="5"><option key="1"/><option key="2"/><option key="3"/><option key="4"/><option key="5"/><option key="6"/><option key="7"/><option key="8"/><option key="9"/></radio></default-field></field><field name="shipAfterDate"><default-field title="Ship After"><date-time/></default-field></field><field name="shipBeforeDate"><default-field title="Ship Before"><date-time/></default-field></field><field name="estimatedShipDate"><default-field title="Estimated Ship"><date-time/></default-field></field><field name="estimatedDeliveryDate"><default-field title="Delivery Date"><date-time/></default-field></field><field name="otherPartyOrderId"><default-field title="Their Order ID"><text-line size="40"/></default-field></field><field name="otherPartyOrderDate"><default-field title="Their Order Date"><date-time/></default-field></field><field name="shippingInstructions"><default-field><text-area rows="6" cols="120"/></default-field></field><field name="signatureRequiredEnumId"><default-field title="Sign Req."><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="isGift"><default-field><radio no-current-selected-key="N"><option key="N"/><option key="Y"/></radio></default-field></field><field name="giftMessage"><default-field><text-area rows="3" cols="80"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></container-dialog></fail-widgets></section><container-dialog id="AddPartPartyDialog" button-text="Add Party"><form-single name="CreateOrderPartParty" transition="createOrderPartParty" map="orderPart"><field name="orderId"><default-field><hidden/></default-field></field><field name="orderPartSeqId"><default-field><hidden/></default-field></field><field name="partyId"><default-field title="Party"><drop-down><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="roleTypeId"><default-field title="Role"><drop-down><entity-options key="${roleTypeId}" text="${description}"><entity-find entity-name="mantle.party.RoleGroupMemberAndType" cache="true"><econdition field-name="roleGroupEnumId" value="RgpOrder"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog><link url="invoiceOrderPart" text="Create Invoice" link-type="hidden-form" parameter-map="[orderPartSeqId:orderPart.orderPartSeqId]" condition="quantityNotBilledByPart.get(orderPartInfo.orderPart.orderPartSeqId) && !orderHeader.recurCronExpression"/><link url="createReturnFromOrder" text="Create Return" condition="!orderPartInfo.openReturnList && !orderHeader.recurCronExpression" confirmation="Really create return for this order part?" parameter-map="[orderId:orderId, orderPartSeqId:orderPart.orderPartSeqId]"/><container-dialog id="ClosePartDialog" button-text="Close Part" type="warning" condition="orderPartInfo.orderPart.statusId in ['OrderOpen', 'OrderPlaced', 'OrderProcessing', 'OrderApproved', 'OrderHold']"><section name="ClosePartInfo"><actions><set field="partProductItems" from="orderPartInfo.partNoParentOrderItemList?.findAll({ it.itemTypeEnumId in productItemTypes })"/></actions><widgets><label text="Order Part ${orderPartInfo.orderPart.orderPartSeqId} Facility ${ec.resource.expand('FacilityNameTemplate', null, orderPartInfo.facility)}" type="h4"/><form-list name="CloseOrderPartItems" list="partProductItems" skip-form="true"><row-actions><set field="itemQuantityNotShipped" from="quantityNotShippedByItem.get(orderItemSeqId) ?: 0.0"/><set field="itemQuantityShipped" from="(quantity?:0.0) - itemQuantityNotShipped"/></row-actions><field name="orderItemSeqId"><default-field title="Item"><display/></default-field></field><field name="productId"><default-field title="Product"><display-entity entity-name="mantle.product.Product" text="ProductNameTemplate"/></default-field></field><field name="quantity"><default-field><display/></default-field></field><field name="itemQuantityShipped"><default-field title="Shipped"><display/></default-field></field><field name="itemQuantityNotShipped"><default-field title="To Cancel"><display style="${itemQuantityNotShipped ? 'text-danger' : ''}"/></default-field></field></form-list></widgets></section><label text="OrderDetailConfirmClosePart" type="p"/><link url="cancelOrderPart" text="Close Part" link-type="hidden-form" btn-type="warning" confirmation="OrderDetailConfirmClosePart"/></container-dialog><label text="Warning: both vendor and customer are internal organizations" style="text-danger" type="p" condition="orderPartInfo.isVendorInternalOrg && orderPartInfo.isCustomerInternalOrg"/><container type="dl" style="dl-horizontal"><label text="Part Total" type="dt"/><label text="${ec.l10n.formatCurrency(orderPartInfo.orderPart.partTotal ?: 0, orderHeader?.currencyUomId)}" type="dd"/><label text="Part Status" type="dt"/><container type="dd"><label text="${orderPartInfo.partStatusItem?.description ?: ''}"/><link url="placeOrder" text="- Place Part" link-type="hidden-form-link" condition="orderHeader.statusId == 'OrderPlaced' && orderPartInfo.orderPart.statusId in ['OrderOpen', 'OrderHold']" parameter-map="[orderId:orderId, orderPartSeqId:orderPartInfo.orderPart.orderPartSeqId]"/><link url="holdOrder" text="- Hold Part" link-type="hidden-form-link" condition="orderHeader.statusId in ['OrderPlaced', 'OrderHold', 'OrderProcessing', 'OrderApproved'] && orderPartInfo.orderPart.statusId in ['OrderPlaced', 'OrderProcessing', 'OrderApproved']" parameter-map="[orderId:orderId, orderPartSeqId:orderPartInfo.orderPart.orderPartSeqId]" confirmation="Really hold order part?"/><link url="approveOrder" text="- Approve Part" link-type="hidden-form-link" condition="orderHeader.statusId == 'OrderApproved' && orderPartInfo.orderPart.statusId in ['OrderPlaced', 'OrderProcessing', 'OrderHold'] && ec.user.hasPermission('ORDER_APPROVE')" parameter-map="[orderId:orderId, orderPartSeqId:orderPartInfo.orderPart.orderPartSeqId]"/><link url="completeOrderPart" text="- Complete Part" link-type="hidden-form-link" parameter-map="[orderId:orderId, orderPartSeqId:orderPart.orderPartSeqId]" condition="orderPartInfo.orderPart.statusId in ['OrderApproved', 'OrderSent']" confirmation="Force complete order part? This normally happens automatically and only when all items are shipped."/></container><label text="Customer" type="dt"/><container type="dd"><link url="editParty" text="PartyNameTemplate" text-map="orderPartInfo.customerDetail" link-type="anchor" parameter-map="[partyId:orderPartInfo.customerDetail.partyId]" condition="orderPartInfo.customerDetail != null && orderPartInfo.isCustomerInternalOrg"/><link url="editCustomer" text="PartyNameTemplate" text-map="orderPartInfo.customerDetail" link-type="anchor" parameter-map="[partyId:orderPartInfo.customerDetail.partyId]" condition="orderPartInfo.customerDetail != null && !orderPartInfo.isCustomerInternalOrg"/><label text="No Customer Selected" style="text-danger" condition="orderPartInfo.customerDetail == null"/></container><label text="Customer Email" type="dt" condition="!isCustomerInternalOrg"/><label text="${orderPartInfo.customerEmail ?: 'No Order or Primary email found'}" type="dd" style="${orderPartInfo.customerEmail ? '' : 'text-warning'}" condition="!isCustomerInternalOrg"/><label text="New Customer" type="dt" style="text-warning" condition="orderPartInfo.orderPart.isNewCustomer == 'Y'"/><label text="First Order" type="dd" style="text-warning" condition="orderPartInfo.orderPart.isNewCustomer == 'Y'"/><label text="Store" type="dt" condition="productStore != null"/><label text="${productStore.productStoreId}: ${productStore.storeName}" type="dd" condition="productStore != null"/><label text="Vendor" type="dt"/><container type="dd"><link url="editParty" text="PartyNameTemplate" text-map="orderPartInfo.vendorDetail" link-type="anchor" parameter-map="[partyId:orderPartInfo.vendorDetail.partyId]" condition="orderPartInfo.isVendorInternalOrg && orderPartInfo.vendorDetail"/><link url="editSupplier" text="PartyNameTemplate" text-map="orderPartInfo.vendorDetail" link-type="anchor" parameter-map="[partyId:orderPartInfo.vendorDetail.partyId]" condition="!orderPartInfo.isVendorInternalOrg && orderPartInfo.vendorDetail"/></container><label text="Ship Method" type="dt"/><label text="${orderPartInfo.shipmentMethodEnum?.description ?: ''}" type="dd"/><label text="Carrier" type="dt" condition="orderPartInfo.carrierPartyDetail"/><label text="${ec.resource.expand('PartyNameTemplate', null, orderPartInfo.carrierPartyDetail)}" type="dd" condition="orderPartInfo.carrierPartyDetail"/><label text="Priority" type="dt" style="${orderPartInfo.orderPart.priority == 1 ? 'text-strong text-danger' : (orderPartInfo.orderPart.priority == 2 || orderPartInfo.orderPart.priority == 3 ? 'text-strong text-warning' : '')}"/><label text="${orderPartInfo.orderPart.priority ?: 5}" type="dd" style="${orderPartInfo.orderPart.priority == 1 ? 'text-strong text-danger' : (orderPartInfo.orderPart.priority == 2 || orderPartInfo.orderPart.priority == 3 ? 'text-strong text-warning' : '')}"/><label text="Ship After" type="dt" condition="orderPartInfo.orderPart.shipAfterDate"/><label text="${ec.l10n.format(orderPartInfo.orderPart.shipAfterDate, 'yyyy-MM-dd HH:mm') ?: '\u00a0'}" type="dd" condition="orderPartInfo.orderPart.shipAfterDate"/><label text="Ship Before" type="dt" condition="orderPartInfo.orderPart.shipBeforeDate"/><label text="${ec.l10n.format(orderPartInfo.orderPart.shipBeforeDate, 'yyyy-MM-dd HH:mm') ?: '\u00a0'}" type="dd" condition="orderPartInfo.orderPart.shipBeforeDate"/><label text="Delivery Date" type="dt" condition="orderPartInfo.orderPart.estimatedDeliveryDate"/><label text="${ec.l10n.format(orderPartInfo.orderPart.estimatedDeliveryDate, 'yyyy-MM-dd HH:mm') ?: '\u00a0'}" type="dd" condition="orderPartInfo.orderPart.estimatedDeliveryDate"/><label text="Pick Up Date" type="dt" condition="orderPartInfo.orderPart.estimatedPickUpDate"/><label text="${ec.l10n.format(orderPartInfo.orderPart.estimatedPickUpDate, 'yyyy-MM-dd HH:mm') ?: '\u00a0'}" type="dd" condition="orderPartInfo.orderPart.estimatedPickUpDate"/><label text="Their Order ID" type="dt"/><label text="${orderPartInfo.orderPart.otherPartyOrderId ?: '\u00a0'}" type="dd"/><label text="Their Order Date" type="dt" condition="orderPartInfo.orderPart.otherPartyOrderDate"/><label text="${ec.l10n.format(orderPartInfo.orderPart.otherPartyOrderDate, 'yyyy-MM-dd HH:mm') ?: '\u00a0'}" type="dd" condition="orderPartInfo.orderPart.otherPartyOrderDate"/><section name="DuplicatesByOtherPartyOrderIdSection" condition="orderPartInfo.duplicateOrderPartList"><widgets><label text="Duplicate Order Parts" type="dt" style="text-danger"/><label text="${orderPartInfo.duplicateOrderPartList.collect({ it.orderId + ':' + it.orderPartSeqId }).join(', ')}" type="dd" style="text-danger"/></widgets></section><label text="Shipping Instructions" type="dt"/><label text="${orderPartInfo.orderPart.shippingInstructions ?: '\u00a0'}" type="dd"/><label text="Signature Required" type="dt" condition="orderPartInfo.orderPart.signatureRequiredEnumId"/><label text="${orderPartInfo.orderPart.signatureRequiredEnum?.description}" type="dd" condition="orderPartInfo.orderPart.signatureRequiredEnumId"/><label text="Is Gift" type="dt"/><label text="${orderPartInfo.orderPart.isGift ?: 'N'}" type="dd"/><label text="Gift Message" type="dt"/><label text="${orderPartInfo.orderPart.giftMessage ?: '\u00a0'}" type="dd"/><label text="Disable Promotions" type="dt" condition="orderPartInfo.orderPart.disablePromotions == 'Y'"/><label text="Y" type="dd" condition="orderPartInfo.orderPart.disablePromotions == 'Y'"/><label text="Disable Tax Calc" type="dt" condition="orderPartInfo.orderPart.disableTaxCalc == 'Y'"/><label text="Y" type="dd" condition="orderPartInfo.orderPart.disableTaxCalc == 'Y'"/><label text="Disable Shipping Calc" type="dt" condition="orderPartInfo.orderPart.disableShippingCalc == 'Y'"/><label text="Y" type="dd" condition="orderPartInfo.orderPart.disableShippingCalc == 'Y'"/><label text="Auto Reservation" type="dt" condition="orderPartInfo.orderPart.reservationAutoEnumId"/><label text="${orderPartInfo.orderPart.reservationAutoEnum?.description}" type="dd" condition="orderPartInfo.orderPart.reservationAutoEnumId"/><label text="Payment Terms" type="dt" condition="orderPartInfo.partSettlementTerm?.description"/><label text="${orderPartInfo.partSettlementTerm.description}" type="dd" condition="orderPartInfo.partSettlementTerm?.description"/><label text="Facility " type="dt"/><container type="dd"><link url="editFacility" text="FacilityNameTemplate" text-map="orderPartInfo.facility" parameter-map="[facilityId:orderPartInfo.facility.facilityId]" link-type="anchor" condition="orderPartInfo.facility"/><text type="html,vuet,qvt" location="component://SimpleScreens/template/party/ContactInfo.html.gstring"/></container></container><section-iterate name="OrderPartRoleSection" list="orderPartInfo.orderPartPartyList" entry="orderPartParty"><widgets><container><link url="deleteOrderPartParty" text="X" link-type="hidden-form-link" parameter-map="[orderId:orderPartParty.orderId, orderPartSeqId:orderPartParty.orderPartSeqId,                                         partyId:orderPartParty.partyId, roleTypeId:orderPartParty.roleTypeId]"/><label text="${orderPartParty.description}: " type="strong"/><label text="PartyNameTemplate" text-map="orderPartParty" type="span"/></container></widgets></section-iterate></row-col><row-col lg="7"><section name="PaymentInfoSection"><widgets><container-box><box-header title="Payment Information"/><box-toolbar><container-dialog id="AddPaymentInfo" button-text="Add Payment" condition="orderPartInfo.partEditable"><form-single name="AddPaymentForm" transition="addOrderPartPayment" focus-field="paymentMethodId"><field name="orderId"><default-field><hidden/></default-field></field><field name="orderPartSeqId" from="orderPartInfo.orderPart.orderPartSeqId"><default-field><hidden/></default-field></field><field name="paymentMethodId"><default-field title="Payment Method"><drop-down allow-empty="true"><entity-options key="${paymentMethodId}" text="PaymentMethodDetailTemplate"><entity-find entity-name="mantle.account.method.PaymentMethodDetail"><date-filter/><econditions combine="or"><econdition field-name="ownerPartyId" from="customerPartyId"/><econdition field-name="ownerPartyId" from="customerBillToPartyId" ignore-if-empty="true"/></econditions></entity-find></entity-options></drop-down></default-field></field><field name="finAccountId"><default-field title="OR Customer Account"><drop-down allow-empty="true"><entity-options key="${finAccountId}" text="FinancialAccountNameTemplate"><entity-find entity-name="mantle.account.financial.FinancialAccount"><econdition field-name="ownerPartyId" from="orderPartInfo.orderPart.customerPartyId"/></entity-find></entity-options></drop-down></default-field></field><field name="paymentInstrumentEnumId"><default-field title="OR Instrument"><drop-down allow-empty="true"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="PaymentInstrument"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="paymentTypeEnumId"><default-field title="Payment Type"><drop-down no-current-selected-key="PtInvoicePayment"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econditions combine="or"><econdition field-name="enumId" value="PtInvoicePayment"/><econdition field-name="parentEnumId" value="PtInvoicePayment"/></econditions><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="dueDate"><default-field><date-time/></default-field></field><field name="amount"><default-field><text-line size="10" default-value="${ec.l10n.format(orderPartInfo.partTotalUnpaid ?: 0, '#0.00')}"/></default-field></field><field name="settlementTermId" from="orderPartInfo.partSettlementTerm?.orderPmtServiceRegisterId ? orderPartInfo.partSettlementTerm.settlementTermId : null"><default-field title="Auto Payments Term"><drop-down allow-empty="true"><entity-options key="${settlementTermId}" text="${description}"><entity-find entity-name="mantle.account.invoice.SettlementTermAndEnumMember"><econdition field-name="enumGroupEnumId" value="EngPaymentTermType"/><econdition field-name="orderPmtServiceRegisterId" operator="is-not-null"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog><dynamic-dialog id="AddCreditCardDialog" button-text="New Credit Card" transition="UpdatePaymentMethodInfo" width="800" parameter-map="[partyId:customerPartyId, paymentMethodTypeEnumId:'PmtCreditCard', orderId:orderId]"/></box-toolbar><box-body><label text="OrderDetailPartPaymentIncomplete" style="text-danger" type="p" condition="orderPartInfo.paymentsTotal < orderPartInfo.orderPart.partTotal"/><label text="Payments total (${ec.l10n.formatCurrency(orderPartInfo.paymentsTotal ?: 0.0, orderHeader?.currencyUomId)}) is greater than order part total (${ec.l10n.formatCurrency(orderPartInfo.orderPart.partTotal ?: 0.0, orderHeader?.currencyUomId)})" style="text-warning" type="p" condition="(orderPartInfo.paymentsTotal?:0.0) > (orderPartInfo.orderPart.partTotal?:0.0)"/><section-iterate name="PaymentInfoListSection" list="orderPartInfo.partPaymentInfoList" entry="partPaymentInfo"><actions><set field="methodInfo" from="partPaymentInfo"/><entity-find entity-name="mantle.account.method.PaymentGatewayResponse" list="gatewayResponseList"><econdition field-name="paymentId" from="partPaymentInfo.partPayment.paymentId"/><order-by field-name="-transactionDate"/></entity-find></actions><widgets><container><label text="${partPaymentInfo.paymentMethodTypeEnum?.description?:(partPaymentInfo.paymentInstrumentEnum?.description?:'')} (${partPaymentInfo.paymentTypeEnum?.description}) ${ec.l10n.formatCurrency(partPaymentInfo.partPayment.amount, partPaymentInfo.partPayment.amountUomId)}" type="strong"/><label text=" - Status: ${partPaymentInfo.statusItem?.description}" type="strong"/><label text=" - Due: ${ec.l10n.format(partPaymentInfo.partPayment.dueDate, 'yyyy-MM-dd')}" type="strong" condition="partPaymentInfo.partPayment.dueDate"/><container-dialog id="UpdatePaymentDialog" button-text="Update" condition="orderPartInfo.partEditable && partPaymentInfo.partPayment.statusId in ['PmntProposed', 'PmntPromised']"><form-single name="UpdatePaymentForm" transition="updatePayment" map="partPaymentInfo.partPayment" extends="AddPaymentForm"><field name="orderId"><default-field><hidden/></default-field></field><field name="paymentId"><default-field><hidden/></default-field></field><field name="amount" from=""><default-field><text-line size="10" format="0.00"/></default-field></field><field name="settlementTermId"><default-field><ignored/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></container-dialog><container-dialog id="GatewayAuthorizeDialog" button-text="Gateway Authorize" condition="partPaymentInfo.partPayment.statusId in ['PmntPromised', 'PmntProposed', 'PmntDeclined']"><form-single name="GatewayAuthorizeForm" map="partPaymentInfo.partPayment" transition="gatewayAuthorize"><field name="orderId"><default-field><hidden/></default-field></field><field name="paymentId"><default-field><hidden/></default-field></field><field name="cardSecurityCode"><default-field><text-line size="4"/></default-field></field><field name="submitButton"><default-field title="Authorize"><submit/></default-field></field></form-single></container-dialog><container-dialog id="GatewayHistoryDialog" button-text="Gateway History" condition="gatewayResponseList" width="900"><form-list name="GatewayResponseList" skip-form="true" extends="component://SimpleScreens/screen/SimpleScreens/Accounting/Payment/EditPayment.xml#GatewayResponseList"/></container-dialog><container><link url="editPayment" text="Edit Payment ${partPaymentInfo.partPayment.paymentId}" link-type="anchor" parameter-map="[paymentId:partPaymentInfo.partPayment.paymentId]"/><link url="editPaymentMethod" text="Edit ${partPaymentInfo.paymentMethod?.description ?: 'Payment Method ' + partPaymentInfo.partPayment.paymentMethodId}" parameter-map="[paymentMethodId:partPaymentInfo.partPayment.paymentMethodId]" link-type="anchor" condition="partPaymentInfo.partPayment.paymentMethodId != null"/></container><text type="html,vuet,qvt" location="component://SimpleScreens/template/party/PaymentMethodInfo.html.gstring"/><label text="CIM ID: ${methodInfo.paymentMethod.gatewayCimId}" type="div" condition="methodInfo.paymentMethod?.gatewayCimId"/><label text="Gateway: ${methodInfo.paymentMethod.gatewayConfig?.description}" type="div" condition="methodInfo.paymentMethod?.paymentGatewayConfigId"/></container></widgets></section-iterate></box-body></container-box></widgets></section><container-box><box-header title="Shipping Address and Method"/><box-toolbar><dynamic-dialog id="AddPostalInfo" button-text="Add Shipping Address" transition="UpdateContactInfo" width="800" condition="orderPartInfo.partEditable" parameter-map="[partyId:customerPartyId, postalContactMechPurposeId:'PostalShippingDest',                                     telecomContactMechPurposeId:'PhoneShippingDest', orderId:orderId, postalContactMechId:null]"/></box-toolbar><box-body><section name="CurrentShippingAddress" condition="shippingAddressInfo != null"><actions><set field="contactInfo" from="shippingAddressInfo"/></actions><widgets><container style="row"><container style="col-sm-6"><text type="html,vuet,qvt" location="component://SimpleScreens/template/party/ContactInfo.html.gstring"/></container><container style="col-sm-6"><dynamic-dialog id="UpdatePostalInfo" button-text="Update Address" transition="UpdateContactInfo" width="800" condition="orderPartInfo.partEditable" parameter-map="[partyId:customerPartyId, postalContactMechId:contactInfo.postalContactMechId,                                                 postalContactMechPurposeId:contactInfo.postalContactMechPurposeId, orderId:orderId,                                                 facilityId:contactInfo.facilityId]"/><container><label text="Trust: ${contactInfo.postalTrustLevelEnum?.description ?: 'New'}${contactInfo.postalContactMech.validateMessage?'*':''}" type="strong" tooltip="${contactInfo.postalContactMech.validateMessage?:''}"/><link url="validateAddress" text="Validate" parameter-map="[orderId:orderId, partyId:customerPartyId, facilityId:contactInfo.facilityId, contactMechId:contactInfo.postalContactMechId]" condition="!contactInfo.postalContactMech.trustLevelEnumId || contactInfo.postalContactMech.trustLevelEnumId == 'CmtlNew'"/></container></container></container></widgets></section><label text="No shipping address selected" style="text-danger" type="p" condition="!orderPartInfo.isCustomerInternalOrg && !orderPart.postalContactMechId"/><label text="No shipment method selected" style="text-warning" type="p" condition="!orderPartInfo.isCustomerInternalOrg && !orderPart.shipmentMethodEnumId"/><container type="hr"/><form-single name="SetOrderInfoForm" transition="setOrderBillingShippingInfo" map="orderPartInfo.orderPart"><field name="orderId"><default-field><hidden/></default-field></field><field name="orderPartSeqId"><default-field><hidden/></default-field></field><field name="paymentMethodId"><default-field><hidden/></default-field></field><field name="shippingPostalContactMechId" from="orderPart.postalContactMechId"><conditional-field title="Shipping Address" condition="orderPartInfo.partEditable"><drop-down><list-options list="shippingPostalAddressList" key="${postalContactMechId}" text="PostalAddressInfoTemplate"/></drop-down></conditional-field><default-field><hidden/></default-field></field><field name="carrierAndShipmentMethod"><conditional-field title="Shipment Method" condition="orderPartInfo.partEditable"><drop-down no-current-selected-key="${orderPart.carrierPartyId ? orderPart.carrierPartyId + ':' + orderPart.shipmentMethodEnumId : ''}"><list-options list="shippingOptions" key="${carrierPartyId}:${shipmentMethodEnumId}" text="${description ? description : (carrierPartyId != '_NA_' ? (carrierName + ' - ') : '') + shipmentMethodDescription}${shippingTotal != null ? ' ' + ec.l10n.formatCurrency(shippingTotal, orderHeader.currencyUomId) : ''}"/><dynamic-options transition="getShippingOptions"/></drop-down></conditional-field><default-field title="Shipment Method"><display text="${orderPartInfo.shipmentMethodEnum?.description ?: ''}${orderPartInfo.carrierPartyDetail ? ' - ' + ec.resource.expand('PartyNameTemplate', null, orderPartInfo.carrierPartyDetail) : ''}"/></default-field></field><field name="submitButton"><conditional-field condition="orderPartInfo.partEditable" title="Set Shipping Address and Method"><submit/></conditional-field><default-field><ignored/></default-field></field></form-single></box-body></container-box></row-col></container-row><section name="AddItemsSection" condition="orderPartInfo.partEditable"><widgets><container-dialog id="AddProductItemContainer" button-text="Add Product Item"><form-single name="AddProductItemForm" transition="addProductItem" focus-field="productId"><field name="orderId"><default-field><hidden/></default-field></field><field name="orderPartSeqId" from="orderPartInfo.orderPart.orderPartSeqId"><default-field><hidden/></default-field></field><field name="updateExisting"><default-field><hidden default-value="false"/></default-field></field><field name="requireInventory"><default-field><hidden default-value="false"/></default-field></field><field name="assetClassEnumId"><default-field title="Asset Class"><drop-down allow-empty="true" no-current-selected-key="AsClsInventoryFin"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="parentEnumId" value="AsClsInventory"/><order-by field-name="sequenceNum,description"/></entity-find></entity-options></drop-down></default-field></field><field name="productId"><default-field title="Product"><drop-down><dynamic-options transition="getProductList" server-search="true" min-length="0" depends-optional="true"><depends-on field="assetClassEnumId"/></dynamic-options></drop-down></default-field></field><field name="quantity"><default-field><text-line size="8" default-value="1"/></default-field></field><field name="unitAmount"><default-field title="Price" tooltip="Leave empty to use Calc Price"><text-line size="10"/></default-field></field><field name="calcAmount"><default-field title="Calc Price"><display dynamic-transition="getProductPrice" parameter-map="[orderId:orderId, orderPartSeqId:orderPartInfo.orderPart.orderPartSeqId, priceFormat:'#,##0.00']"><depends-on field="productId"/><depends-on field="quantity"/></display></default-field></field><field name="standardCost"><conditional-field condition="orderPartInfo.isCustomerInternalOrg" tooltip="Cost for accounting if different from Price, used to set Asset Acquire Cost on receipt"><text-line size="10"/></conditional-field></field><field name="requiredByDate" from="orderPartInfo.orderPart.shipBeforeDate"><default-field><date-time format="yyyy-MM-dd HH:mm"/></default-field></field><field name="itemTypeEnumId" from="null"><conditional-field condition="orderPartInfo.isCustomerInternalOrg" title="Item Type"><drop-down no-current-selected-key="ItemInventory"><option key="ItemInventory" text="Inventory"/><option key="ItemAsset" text="Fixed Asset"/><option key="ItemExpSupplies" text="Supplies"/></drop-down></conditional-field><default-field title="Item Type"><drop-down no-current-selected-key="ItemProduct"><option key="ItemProduct" text="Product"/><option key="ItemAsset" text="Fixed Asset"/><option key="ItemRental" text="Rental Asset"/><option key="ItemReplacement" text="Replacement"/></drop-down></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog><container-dialog id="AddOtherItemContainer" button-text="Add Other Item"><form-single name="AddOtherItemForm" transition="createItem" focus-field="itemTypeEnumId"><field name="orderId"><default-field><hidden/></default-field></field><field name="orderPartSeqId" from="orderPartInfo.orderPart.orderPartSeqId"><default-field><hidden/></default-field></field><field name="requireInventory"><default-field><hidden default-value="false"/></default-field></field><field name="parentItemSeqId"><default-field title="Parent Item"><drop-down allow-empty="true"><list-options list="applicableParentItems" key="${orderItemSeqId}" text="${orderItemSeqId} - ${itemDescription}"/></drop-down></default-field></field><field name="itemTypeEnumId"><default-field title="Item Type"><drop-down no-current-selected-key="ItemShipping"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.EnumAndGroup" list="itemTypeEnumList"><econdition field-name="enumGroupEnumId" from="orderPartInfo.isCustomerInternalOrg ? 'EngItemsPurchase' : 'EngItemsSales'"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="itemDescription"><default-field title="Description"><text-line size="60"/></default-field></field><field name="quantity"><default-field><text-line size="8" default-value="1"/></default-field></field><field name="unitAmount"><default-field title="Price"><text-line size="10"/></default-field></field><field name="requiredByDate"><default-field><date-time format="yyyy-MM-dd HH:mm"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog><link url="../QuickItems" text="Quick Add Items"/><link url="recalcOrderPartItemAmounts" text="Re-Calc Prices" confirmation="Re-calculate price for each Item and reset to calculated price?"/><link url="updateOrderPart" text="Ship Calc" btn-type="danger" icon="fa fa-remove" condition="orderPart.disableShippingCalc == 'Y'" parameter-map="[orderId:orderId, orderPartSeqId:orderPart.orderPartSeqId, disableShippingCalc:'N']"/><link url="updateOrderPart" text="Ship Calc" btn-type="success" icon="fa fa-check" condition="orderPart.disableShippingCalc != 'Y'" parameter-map="[orderId:orderId, orderPartSeqId:orderPart.orderPartSeqId, disableShippingCalc:'Y']"/><link url="updateOrderPart" text="Tax Calc" btn-type="danger" icon="fa fa-remove" condition="orderPart.disableTaxCalc == 'Y'" parameter-map="[orderId:orderId, orderPartSeqId:orderPart.orderPartSeqId, disableTaxCalc:'N']"/><link url="updateOrderPart" text="Tax Calc" btn-type="success" icon="fa fa-check" condition="orderPart.disableTaxCalc != 'Y'" parameter-map="[orderId:orderId, orderPartSeqId:orderPart.orderPartSeqId, disableTaxCalc:'Y']"/><link url="updateOrderPart" text="Promos" btn-type="danger" icon="fa fa-remove" condition="orderPart.disablePromotions == 'Y'" parameter-map="[orderId:orderId, orderPartSeqId:orderPart.orderPartSeqId, disablePromotions:'N']"/><link url="updateOrderPart" text="Promos" btn-type="success" icon="fa fa-check" condition="orderPart.disablePromotions != 'Y'" parameter-map="[orderId:orderId, orderPartSeqId:orderPart.orderPartSeqId, disablePromotions:'Y']"/></widgets></section><label text="Showing ${orderPartInfo.partNoParentOrderItemList.size()} of ${orderPartInfo.partNoParentOrderItemCount} Items" type="strong" style="text-danger" condition="orderPartInfo.partNoParentOrderItemCount > orderPartInfo.partNoParentOrderItemList.size()"/><link url="../OrderItems" text="All Part Items (${orderPartInfo.partNoParentOrderItemCount})" btn-type="success" condition="orderPartInfo.partNoParentOrderItemCount > orderPartInfo.partNoParentOrderItemList.size()" parameter-map="[orderId:orderId, orderPartSeqId:orderPartInfo.orderPart.orderPartSeqId]"/><form-list name="OrderItems" list="orderPartInfo.partOrderItemList" list-entry="orderItem" transition="updateItem"><row-actions><service-call name="mantle.order.OrderServices.get#OrderItemTotal" in-map="[orderItem:orderItem, getChildrenTotals:true]" out-map="orderItemTotalOut"/><set field="product" from="orderItem.product"/><if condition="product != null"><entity-find entity-name="mantle.product.issuance.AssetReservation" list="existingResList"><econdition field-name="orderId"/><econdition field-name="orderItemSeqId"/></entity-find><set field="resInfoList" from="[]"/><set field="lotIdSet" from="new LinkedHashSet()"/><set field="oldestLotExpire" from="null"/><iterate list="existingResList" entry="existingRes"><entity-find-one entity-name="mantle.product.asset.AssetLotAndMfgParty" value-field="assetLot"><field-map field-name="assetId" from="existingRes.assetId"/><select-field field-name="productId,lotId,pseudoId,lotNumber,manufacturedDate,expirationDate"/></entity-find-one><script><![CDATA[if (assetLot?.lotId) lotIdSet.add(assetLot.lotId)
                            if (assetLot?.expirationDate != null && (oldestLotExpire == null || assetLot.expirationDate < oldestLotExpire))
                                oldestLotExpire = assetLot.expirationDate
                            resInfoList.add([existingRes:existingRes, assetLot:assetLot])]]></script></iterate></if><service-call name="mantle.order.ReturnServices.calculate#OrderItemReturnable" out-map="returnableOut" in-map="[orderId:orderId, orderItemSeqId:orderItem.orderItemSeqId,                                         orderItemBillingList:orderItemBillingList, returnItemList:returnItemList]"/><set field="returnIdSet" from="new TreeSet()"/><iterate list="returnItemList" entry="returnItem"><if condition="returnItem.orderItemSeqId != orderItem.orderItemSeqId"><continue/></if><script><![CDATA[returnIdSet.add(returnItem.returnId)]]></script></iterate><set field="itemQuantityAuditList" from="[]"/><set field="itemUnitAmountAuditList" from="[]"/><iterate list="allItemsAuditLogList" entry="auditLog"><if condition="auditLog.pkSecondaryValue != orderItem.orderItemSeqId"><continue/></if><entity-find-one entity-name="mantle.party.PersonWithUserAccount" value-field="userAccount"><field-map field-name="userId" from="auditLog.changedByUserId"/></entity-find-one><entity-find-one entity-name="moqui.basic.Enumeration" value-field="changeReasonEnum"><field-map field-name="enumId" from="auditLog.changeReason"/></entity-find-one><if condition="auditLog.changedFieldName == 'quantity'"><then><script><![CDATA[itemQuantityAuditList.add([auditLog:auditLog, userAccount:userAccount, changeReasonEnum:changeReasonEnum])]]></script></then><else><script><![CDATA[itemUnitAmountAuditList.add([auditLog:auditLog, userAccount:userAccount, changeReasonEnum:changeReasonEnum])]]></script></else></if></iterate><set field="isProductItemType" from="orderItem.itemTypeEnumId in productItemTypes"/><set field="isShippable" from="isProductItemType && product != null ? product.productTypeEnumId in ['PtAsset', 'PtDigitalAsset', 'PtAssetUse', 'PtPickAssembly'] : false"/><set field="itemQuantityNotShipped" from="quantityNotShippedByItem.get(orderItemSeqId) ?: 0.0"/><set field="itemQuantityShipped" from="(orderItem.quantity?:0.0) - itemQuantityNotShipped"/><set field="itemTotalNotBilled" from="totalNotBilledByItem.get(orderItemSeqId) ?: 0.0"/><set field="itemQuantityNotBilled" from="quantityNotBilledByItem.get(orderItemSeqId) ?: 0.0"/><set field="itemCanDelete" from="(!isShippable || itemQuantityNotShipped == quantity) && itemQuantityNotBilled == quantity && returnableOut.returnedQuantity == 0"/><set field="newerThanExpireDate" from="null"/><if condition="orderPartInfo.newerInventory && orderPartInfo.orderPart.customerPartyId"><entity-find entity-name="mantle.product.issuance.AssetIssuanceLotSummary" list="issuanceLotList" limit="1"><econdition field-name="toPartyId" from="orderPartInfo.orderPart.customerPartyId"/><econdition field-name="productId"/><select-field field-name="expirationDate,expectedEndOfLife"/><order-by field-name="-issuedDate"/></entity-find><if condition="issuanceLotList"><set field="newerThanExpireDate" from="issuanceLotList[0].expirationDate ?: issuanceLotList[0].expectedEndOfLife"/></if></if></row-actions><hidden-parameters><parameter name="orderId"/><parameter name="requireInventory" value="false"/></hidden-parameters><field name="orderItemSeqId"><default-field title="Item" container-style="${parentItemSeqId ? 'text-info' : ''}"><display/></default-field></field><field name="orderPartSeqId" align="center"><conditional-field condition="orderPartInfo.partEditable && isPromo != 'Y'"><drop-down><list-options list="orderPartList" key="${orderPartSeqId}" text="${orderPartSeqId}"/></drop-down></conditional-field><default-field title="Part"><display text="Part ${orderPartSeqId}"/></default-field></field><field name="parentItemSeqId" align="center"><conditional-field condition="isProductItemType || orderItemWithChildrenSet.contains(orderItem.orderItemSeqId)"><display text=" "/></conditional-field><conditional-field condition="orderPartInfo.partEditable && isPromo != 'Y'" title="Parent"><drop-down allow-empty="true"><list-options list="applicableParentItems" key="${orderItemSeqId}" text="${orderItemSeqId}"/></drop-down></conditional-field><default-field title="Parent Item"><display text="${parentItemSeqId ? 'Parent ' + parentItemSeqId : ''}"/></default-field></field><field name="itemTypeEnumId"><default-field title="Type" container-style="${isProductItemType ? 'text-info' : (itemTypeEnumId == 'ItemDiscount' ? 'text-success' : (itemTypeEnumId in ['ItemSalesTax','ItemVatTax'] ? 'text-warning' : ''))}"><display-entity entity-name="moqui.basic.Enumeration" text="${description}${isPromo ? ' (Promotion)' : ''}"/></default-field></field><field name="productId"><conditional-field condition="isProductItemType && orderPartInfo.partEditable"><drop-down><dynamic-options transition="getProductList" server-search="true" min-length="0"/></drop-down></conditional-field></field><field name="productLink" from="productId"><default-field title=""><link url="editProduct" text="ProductNameTemplate" entity-name="mantle.product.Product" link-type="anchor" condition="productId"/></default-field></field><field name="otherPartyProductId"><conditional-field condition="isProductItemType && orderPartInfo.partEditable"><text-line size="25"/></conditional-field><default-field><display/></default-field></field><field name="itemDescription"><conditional-field condition="orderPartInfo.partEditable && isPromo != 'Y'" title="Description"><text-line size="30"/><label text="Promo Code: ${promoCodeText}" condition="promoCodeText" type="div"/></conditional-field><default-field title="Description"><display/><label text="Promo Code: ${promoCodeText}" condition="promoCodeText" type="div"/></default-field></field><field name="comments"><conditional-field condition="orderPartInfo.partEditable && isPromo != 'Y'"><text-line size="30"/></conditional-field><default-field><display/></default-field></field><field name="requiredByDate"><conditional-field condition="isProductItemType && orderPartInfo.partEditable"><date-time/></conditional-field><default-field><display/></default-field></field><field name="unitListPrice"><default-field title="List Price"><display currency-unit-field="orderHeader.currencyUomId"/></default-field></field><field name="unitAmount"><conditional-field condition="orderPartInfo.partEditable && isPromo != 'Y'" title="Price"><text-line size="8" format="#,##0.00#"/></conditional-field><default-field title="Price"><display currency-unit-field="orderHeader.currencyUomId"/></default-field></field><field name="unitAmountHist"><default-field title=""><render-mode><text type="html,vuet"><![CDATA[<#assign popoverContent><table style="width:100%;"><#list itemUnitAmountAuditList as auditInfo><tr><td class="text-right">${ec.l10n.formatCurrency(auditInfo.auditLog.newValueText, orderHeader.currencyUomId, 3)}</td><td class="text-center">${ec.resource.expand('UsernameTemplate', '', auditInfo.userAccount)}</td><td class="text-center">${ec.l10n.format(auditInfo.auditLog.changedDate, 'yyyy-MM-dd HH:mm')}</td><td class="text-center">${(auditInfo.changeReasonEnum.description)!(auditInfo.auditLog.changeReason)!''}</td></tr></#list></table></#assign><a role="button" data-toggle="popover" data-placement="left" data-title="${ec.resource.expand('Price History for Item ${orderItemSeqId}', null)}" data-content="${popoverContent?html}">${ec.l10n.localize('Price History')}</a>]]></text><text type="qvt"><![CDATA[<div class="text-primary cursor-pointer">${ec.l10n.localize('Price History')}<q-tooltip><div>${ec.resource.expand('Price History for Item ${orderItemSeqId}', null)}</div><table style="width:100%;"><#list itemUnitAmountAuditList as auditInfo><tr><td class="text-right">${ec.l10n.formatCurrency(auditInfo.auditLog.newValueText, orderHeader.currencyUomId, 3)}</td><td class="text-center">${ec.resource.expand('UsernameTemplate', '', auditInfo.userAccount)}</td><td class="text-center">${ec.l10n.format(auditInfo.auditLog.changedDate, 'yyyy-MM-dd HH:mm')}</td><td class="text-center">${(auditInfo.changeReasonEnum.description)!(auditInfo.auditLog.changeReason)!''}</td></tr></#list></table></q-tooltip></div>]]></text></render-mode></default-field></field><field name="quantity"><conditional-field condition="orderPartInfo.partEditable && isPromo != 'Y'"><text-line size="5"/></conditional-field><default-field><display/></default-field></field><field name="quantity_changeReason"><conditional-field title="Quantity Reason" condition="orderPartInfo.partEditable && isPromo != 'Y'"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="OrderItemQuantityReason"/><set field="allowEmpty" value="true"/></widget-template-include></conditional-field><default-field title="Quantity Reason"><ignored/></default-field></field><field name="quantityHist"><default-field title=""><render-mode><text type="html,vuet"><![CDATA[<#assign popoverContent><table style="width:100%;"><#list itemQuantityAuditList as auditInfo><tr><td class="text-right">${auditInfo.auditLog.newValueText}</td><td class="text-center">${ec.resource.expand('UsernameTemplate', '', auditInfo.userAccount)}</td><td class="text-center">${ec.l10n.format(auditInfo.auditLog.changedDate, 'yyyy-MM-dd HH:mm')}</td><td class="text-center">${(auditInfo.changeReasonEnum.description)!(auditInfo.auditLog.changeReason)!''}</td></tr></#list></table></#assign><a role="button" data-toggle="popover" data-placement="left" data-title="${ec.resource.expand('Quantity History for Item ${orderItemSeqId}', null)}" data-content="${popoverContent?html}">${ec.l10n.localize('Quantity History')}</a>]]></text><text type="qvt"><![CDATA[<div class="text-primary cursor-pointer">${ec.l10n.localize('Quantity History')}<q-tooltip><div>${ec.resource.expand('Quantity History for Item ${orderItemSeqId}', null)}</div><table style="width:100%;"><#list itemQuantityAuditList as auditInfo><tr><td class="text-right">${auditInfo.auditLog.newValueText}</td><td class="text-center">${ec.resource.expand('UsernameTemplate', '', auditInfo.userAccount)}</td><td class="text-center">${ec.l10n.format(auditInfo.auditLog.changedDate, 'yyyy-MM-dd HH:mm')}</td><td class="text-center">${(auditInfo.changeReasonEnum.description)!(auditInfo.auditLog.changeReason)!''}</td></tr></#list></table></q-tooltip></div>]]></text></render-mode></default-field></field><field name="standardCost"><conditional-field condition="orderPartInfo.partEditable && isProductItemType && orderPartInfo.isCustomerInternalOrg"><text-line size="10" format="#,##0.00#"/></conditional-field><default-field><display currency-unit-field="orderHeader.currencyUomId"/></default-field></field><field name="notShippedBilled"><default-field title="Not Shipped/Billed"><label text="${ec.l10n.format(itemQuantityNotShipped, '#,##0.###')} / ${ec.l10n.format(itemQuantityNotBilled, '#,##0.###')}" condition="isProductItemType" type="div"/><label text="N/A / ${ec.l10n.format(itemTotalNotBilled, '#,##0.00')}" condition="!isProductItemType" type="div"/><label text="Cancelled: ${quantityCancelled}" condition="quantityCancelled" type="p"/></default-field></field><field name="assetReservations"><conditional-field condition="isShippable && orderPartInfo.isVendorInternalOrg"><section-iterate name="ReservationInfoSection" list="resInfoList" entry="resInfo"><widgets><container><section name="ComponentProductSection" condition="resInfo.assetLot.productId != orderItem.productId"><actions><entity-find-one entity-name="mantle.product.Product" value-field="componentProduct" cache="true"><field-map field-name="productId" from="resInfo.assetLot.productId"/></entity-find-one></actions><widgets><container><label text="Component: " type="strong"/><link url="editProduct" text="ProductNameTemplate" text-map="componentProduct" link-type="anchor" parameter-map="[productId:componentProduct.productId]"/></container></widgets></section><link url="assetDetail" text="Asset ${resInfo.existingRes.assetId}" parameter-map="[assetId:resInfo.existingRes.assetId]" link-type="anchor"/><label text=" - Res: ${ec.l10n.format(resInfo.existingRes.quantity, null)}, Not Avail: ${ec.l10n.format(resInfo.existingRes.quantityNotAvailable, null)}, Not Issued: ${ec.l10n.format(resInfo.existingRes.quantityNotIssued, null)}" type="span" style="${resInfo.existingRes.quantityNotAvailable ? 'text-danger' : ''}"/><container><label text="Lot" type="strong" condition="resInfo.assetLot?.lotId"/><label text="${ec.resource.expand('LotNameTemplate', '', resInfo.assetLot)}" condition="resInfo.assetLot?.lotId"/></container></container></widgets></section-iterate><label text="Multiple lots ${lotIdSet}" condition="orderPartInfo.singleLot && lotIdSet.size() > 1" type="div" style="text-danger"/><label text="Oldest lot ${ec.l10n.format(oldestLotExpire, 'yyyy-MM-dd')} older than last lot expire ${ec.l10n.format(newerThanExpireDate, 'yyyy-MM-dd')}" condition="orderPartInfo.newerInventory && newerThanExpireDate!=null && oldestLotExpire!=null && oldestLotExpire < newerThanExpireDate" type="div" style="text-danger"/><dynamic-dialog id="ItemReserveDialog" button-text="Reserve Assets" transition="ItemReserve" width="960" condition="orderPartInfo.partEditable || orderPartInfo.orderPart.statusId == 'OrderApproved'"/><link url="removeOrderItemReservations" text="" btn-type="danger" icon="fa fa-trash" condition="resInfoList" confirmation="Remove inventory reservations for item ${orderItemSeqId}?"/></conditional-field><default-field><display text=" "/></default-field></field><field name="itemTotal" from="orderItemTotalOut.itemTotal" align="right"><default-field><display currency-unit-field="orderHeader.currencyUomId"/></default-field></field><field name="itemPlusChildrenTotal" from="orderItemTotalOut.itemPlusChildrenTotal" align="right"><conditional-field condition="productId"><display currency-unit-field="orderHeader.currencyUomId"/></conditional-field><default-field title="With Children"><display text=""/></default-field></field><field name="returns"><default-field><label text="OrderDetailItemBilled" type="div"/><label text="OrderDetailItemReturned" type="div"/><section-iterate name="ReturnLinkSection" list="returnIdSet" entry="returnId"><widgets><link url="editReturn" text="#${returnId}" link-type="anchor"/></widgets></section-iterate><label text="OrderDetailItemReturnable" type="div"/></default-field></field><field name="returnItem"><conditional-field condition="orderPartInfo.openReturnList && returnableOut.returnableQuantity > 0"><dynamic-dialog id="ReturnItemCtr" button-text="Return" transition="ReturnItem"><parameter name="orderId"/><parameter name="orderItemSeqId" from="orderItem.orderItemSeqId"/></dynamic-dialog></conditional-field><default-field title=""><display text=" "/></default-field></field><field name="submitButton"><conditional-field condition="orderPartInfo.partEditable && isPromo != 'Y'"><submit text="Update"/><link url="deleteItem" text="" btn-type="danger" icon="fa fa-trash" condition="itemCanDelete" confirmation="Delete item ${orderItemSeqId}?"/></conditional-field><conditional-field condition="orderPartInfo.partEditable && isPromo == 'Y'"><link url="deleteItem" text="" btn-type="danger" icon="fa fa-trash" condition="itemCanDelete" confirmation="Delete item ${orderItemSeqId}?"/></conditional-field><default-field title=""/></field><field name="closeButton"><default-field title=""><link url="cancelOrderItem" text="Close" btn-type="warning" link-type="hidden-form" confirmation="Really close item? Quantity will be reduced to quantity shipped and remaining quantity (${ec.l10n.format(itemQuantityNotShipped, null)}) will be cancelled." condition="isProductItemType && itemQuantityNotShipped && orderPartInfo.orderPart.statusId in ['OrderOpen', 'OrderPlaced', 'OrderProcessing', 'OrderApproved', 'OrderHold']" parameter-map="[orderItem:null]"/></default-field></field><form-list-column><field-ref name="orderItemSeqId"/><field-ref name="orderPartSeqId"/><field-ref name="parentItemSeqId"/></form-list-column><form-list-column><field-ref name="itemTypeEnumId"/><field-ref name="productId"/><field-ref name="productLink"/><field-ref name="otherPartyProductId"/></form-list-column><form-list-column><field-ref name="itemDescription"/><field-ref name="comments"/><field-ref name="requiredByDate"/></form-list-column><form-list-column><field-ref name="unitListPrice"/><field-ref name="unitAmount"/><field-ref name="unitAmountHist"/><field-ref name="quantity"/><field-ref name="quantity_changeReason"/><field-ref name="quantityHist"/></form-list-column><form-list-column><field-ref name="notShippedBilled"/><field-ref name="assetReservations"/><field-ref name="standardCost"/></form-list-column><form-list-column><field-ref name="itemTotal"/><field-ref name="itemPlusChildrenTotal"/></form-list-column><form-list-column><field-ref name="returns"/><field-ref name="returnItem"/></form-list-column><form-list-column><field-ref name="submitButton"/><field-ref name="closeButton"/></form-list-column></form-list></widgets></section-iterate><text type="html,vuet"><![CDATA[<script>$(function () { $('[data-toggle="popover"]').popover({ sanitize:false, html:true, trigger:"hover click" }); })</script>]]></text></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Order/OrderItems.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Items" default-menu-index="2"><parameter name="orderId" required="true"/><parameter name="orderPartSeqId"/><parameter name="pageIndex"/><parameter name="pageSize"/><transition name="editProduct"><default-response url="//${appRoot}/Product/EditProduct"/></transition><transition name="assetDetail"><default-response url="//${appRoot}/Asset/AssetDetail"/></transition><transition name="addProductItem"><service-call name="mantle.order.OrderServices.add#OrderProductQuantity" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createItem"><service-call name="mantle.order.OrderServices.create#OrderItem" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateItem"><service-call name="mantle.order.OrderServices.update#OrderItem" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteItem"><service-call name="mantle.order.OrderServices.delete#OrderItem" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateOrderPart"><service-call name="mantle.order.OrderServices.update#OrderPart" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="removeOrderItemReservations"><service-call name="mantle.product.AssetServices.remove#OrderItemReservations" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="cancelOrderItem"><service-call name="mantle.order.OrderServices.cancel#OrderItem" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getProductPrice" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><subscreens><subscreens-item name="EditItem" location="component://SimpleScreens/screen/SimpleScreens/Order/OrderDetail/EditItem.xml"/><subscreens-item name="ItemReserve" location="component://SimpleScreens/screen/SimpleScreens/Order/OrderDetail/ItemReserve.xml"/><subscreens-item name="ReturnItem" location="component://SimpleScreens/screen/SimpleScreens/Order/OrderDetail/ReturnItem.xml"/></subscreens><actions><entity-find-one entity-name="mantle.order.OrderHeader" value-field="orderHeader"/><if condition="orderPartSeqId"><entity-find-one entity-name="mantle.order.OrderPart" value-field="orderPart"/></if><if condition="orderPart != null"><entity-find-count entity-name="mantle.party.PartyRole" count-field="isCustomerInternalOrg"><econdition field-name="partyId" from="orderPart.customerPartyId"/><econdition field-name="roleTypeId" value="OrgInternal"/></entity-find-count><entity-find-count entity-name="mantle.party.PartyRole" count-field="isVendorInternalOrg"><econdition field-name="partyId" from="orderPart.vendorPartyId"/><econdition field-name="roleTypeId" value="OrgInternal"/></entity-find-count></if><entity-find entity-name="mantle.order.OrderPart" list="orderPartList"><econdition field-name="orderId"/><order-by field-name="orderPartSeqId"/></entity-find><set field="editableStatusIds" from="new HashSet(['OrderBeingChanged', 'OrderOpen', 'OrderRequested',                 'OrderProposed', 'OrderPlaced', 'OrderHold', 'OrderProcessing', 'OrderWishList', 'OrderGiftRegistry', 'OrderAutoReorder'])"/><set field="orderEditable" from="editableStatusIds.contains(orderHeader.statusId)"/><set field="partEditable" from="orderPart != null ? editableStatusIds.contains(orderPart.statusId) : null"/><set field="pageSize" from="pageSize ?: '10'"/><entity-find entity-name="mantle.order.OrderItem" list="orderItemList"><search-form-inputs default-order-by="orderPartSeqId,orderItemSeqId" skip-fields="orderId"/><econdition field-name="orderId"/><econdition field-name="parentItemSeqId" operator="is-null"/></entity-find><set field="topItemSeqIds" from="orderItemList*.orderItemSeqId"/><if condition="topItemSeqIds"><entity-find entity-name="mantle.order.OrderItem" list="childOrderItemList"><econdition field-name="orderId"/><econdition field-name="parentItemSeqId" operator="in" from="topItemSeqIds"/><order-by field-name="orderItemSeqId"/></entity-find><script><![CDATA[// NOTE: must use orderItemList.size() on each iteration as EntityList size will change with child items added
                for (int oiIdx = 0; oiIdx < orderItemList.size(); oiIdx++) {
                    Map orderItem = (Map) orderItemList.get(oiIdx)
                    String orderItemSeqId = orderItem.orderItemSeqId
                    List childList = childOrderItemList.findAll({ orderItemSeqId.equals(it.parentItemSeqId) })
                    for (int cIdx = 0; cIdx < childList.size(); cIdx++) {
                        Map childItem = (Map) childList.get(cIdx)
                        oiIdx++
                        orderItemList.add(oiIdx, childItem)
                    }
                }]]></script></if></actions><widgets><container><label text="Active Order Part: ${orderPartSeqId}" type="strong" condition="orderPartSeqId"/></container><section name="AddItemsSection" condition="partEditable != null ? partEditable : orderEditable"><widgets><container-dialog id="AddProductItemContainer" button-text="Add Product Item"><form-single name="AddProductItemForm" transition="addProductItem" focus-field="productId"><field name="orderId"><default-field><hidden/></default-field></field><field name="updateExisting"><default-field><hidden default-value="false"/></default-field></field><field name="requireInventory"><default-field><hidden default-value="false"/></default-field></field><field name="orderPartSeqId"><default-field><drop-down><list-options list="orderPartList" key="${orderPartSeqId}" text="${orderPartSeqId}"/></drop-down></default-field></field><field name="assetClassEnumId"><default-field title="Asset Class"><drop-down allow-empty="true" no-current-selected-key="AsClsInventoryFin"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="parentEnumId" value="AsClsInventory"/><order-by field-name="sequenceNum,description"/></entity-find></entity-options></drop-down></default-field></field><field name="productId"><default-field title="Product"><drop-down><dynamic-options transition="getProductList" server-search="true" min-length="0" depends-optional="true"><depends-on field="assetClassEnumId"/></dynamic-options></drop-down></default-field></field><field name="quantity"><default-field><text-line size="8" default-value="1"/></default-field></field><field name="unitAmount"><default-field title="Price" tooltip="Leave empty to use Calc Price"><text-line size="10"/></default-field></field><field name="calcAmount"><default-field title="Calc Price"><display dynamic-transition="getProductPrice" parameter-map="[orderId:orderId, priceFormat:'#,##0.00']"><depends-on field="productId"/><depends-on field="quantity"/><depends-on field="orderPartSeqId"/></display></default-field></field><field name="standardCost"><conditional-field condition="isCustomerInternalOrg" tooltip="Cost for accounting if different from Price, used to set Asset Acquire Cost on receipt"><text-line size="10"/></conditional-field></field><field name="requiredByDate" from="orderPart?.shipBeforeDate"><default-field><date-time format="yyyy-MM-dd HH:mm"/></default-field></field><field name="itemTypeEnumId" from="null"><conditional-field condition="isCustomerInternalOrg" title="Item Type"><drop-down no-current-selected-key="ItemInventory"><option key="ItemInventory" text="Inventory"/><option key="ItemAsset" text="Fixed Asset"/><option key="ItemExpSupplies" text="Supplies"/></drop-down></conditional-field><default-field title="Item Type"><drop-down no-current-selected-key="ItemProduct"><option key="ItemProduct" text="Product"/><option key="ItemAsset" text="Fixed Asset"/><option key="ItemRental" text="Rental Asset"/><option key="ItemReplacement" text="Replacement"/></drop-down></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog><container-dialog id="AddOtherItemContainer" button-text="Add Other Item"><form-single name="AddOtherItemForm" transition="createItem" focus-field="itemTypeEnumId"><field name="orderId"><default-field><hidden/></default-field></field><field name="requireInventory"><default-field><hidden default-value="false"/></default-field></field><field name="orderPartSeqId"><default-field><drop-down><list-options list="orderPartList" key="${orderPartSeqId}" text="${orderPartSeqId}"/></drop-down></default-field></field><field name="parentItemSeqId"><default-field title="Parent Item"><drop-down allow-empty="true"><list-options list="applicableParentItems" key="${orderItemSeqId}" text="${orderItemSeqId} - ${itemDescription}"/></drop-down></default-field></field><field name="itemTypeEnumId"><default-field title="Item Type"><drop-down no-current-selected-key="ItemShipping"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.EnumAndGroup" list="itemTypeEnumList"><econdition field-name="enumGroupEnumId" from="isCustomerInternalOrg ? 'EngItemsPurchase' : 'EngItemsSales'"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="itemDescription"><default-field title="Description"><text-line size="60"/></default-field></field><field name="quantity"><default-field><text-line size="8" default-value="1"/></default-field></field><field name="unitAmount"><default-field title="Price"><text-line size="10"/></default-field></field><field name="requiredByDate"><default-field><date-time format="yyyy-MM-dd HH:mm"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></widgets></section><section name="PartFlagsSection" condition="orderPart != null && partEditable"><widgets><link url="updateOrderPart" text="Ship Calc" btn-type="danger" icon="fa fa-remove" condition="orderPart.disableShippingCalc == 'Y'" parameter-map="[orderId:orderId, orderPartSeqId:orderPart.orderPartSeqId, disableShippingCalc:'N']"/><link url="updateOrderPart" text="Ship Calc" btn-type="success" icon="fa fa-check" condition="orderPart.disableShippingCalc != 'Y'" parameter-map="[orderId:orderId, orderPartSeqId:orderPart.orderPartSeqId, disableShippingCalc:'Y']"/><link url="updateOrderPart" text="Tax Calc" btn-type="danger" icon="fa fa-remove" condition="orderPart.disableTaxCalc == 'Y'" parameter-map="[orderId:orderId, orderPartSeqId:orderPart.orderPartSeqId, disableTaxCalc:'N']"/><link url="updateOrderPart" text="Tax Calc" btn-type="success" icon="fa fa-check" condition="orderPart.disableTaxCalc != 'Y'" parameter-map="[orderId:orderId, orderPartSeqId:orderPart.orderPartSeqId, disableTaxCalc:'Y']"/><link url="updateOrderPart" text="Promos" btn-type="danger" icon="fa fa-remove" condition="orderPart.disablePromotions == 'Y'" parameter-map="[orderId:orderId, orderPartSeqId:orderPart.orderPartSeqId, disablePromotions:'N']"/><link url="updateOrderPart" text="Promos" btn-type="success" icon="fa fa-check" condition="orderPart.disablePromotions != 'Y'" parameter-map="[orderId:orderId, orderPartSeqId:orderPart.orderPartSeqId, disablePromotions:'Y']"/></widgets></section><form-list name="OrderItems" list="orderItemList" list-entry="orderItem" skip-form="true" header-dialog="true" show-page-size="true" select-columns="true" show-csv-button="true" show-xlsx-button="true"><row-actions><if condition="orderPart == null"><set field="orderPart" from="orderPartList.find({ it.orderPartSeqId == orderItem.orderPartSeqId })"/><set field="partEditable" from="orderPart != null ? editableStatusIds.contains(orderPart.statusId) : null"/></if><service-call name="mantle.order.OrderInfoServices.get#OrderItemDisplayInfo" out-map="context" in-map="[orderId:orderId, orderItemSeqId:orderItemSeqId, orderItem:orderItem, orderPart:orderPart]"/></row-actions><hidden-parameters><parameter name="orderId"/><parameter name="requireInventory" value="false"/></hidden-parameters><field name="orderItemSeqId"><header-field show-order-by="true"/><default-field title="Item" container-style="${parentItemSeqId ? 'text-info' : 'text-strong'}"><display/></default-field></field><field name="orderPartSeqId" align="center"><header-field title="Part" show-order-by="true"><drop-down allow-empty="true"><list-options list="orderPartList" key="${orderPartSeqId}" text="${orderPartSeqId}"/></drop-down></header-field><default-field><display text="Part ${orderPartSeqId}"/></default-field></field><field name="parentItemSeqId" align="center"><default-field title="Parent Item"><display text="${parentItemSeqId ? 'Parent ' + parentItemSeqId : ''}"/></default-field></field><field name="itemTypeEnumId"><header-field show-order-by="true"><drop-down allow-multiple="true"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.EnumAndGroup" list="itemTypeEnumList"><econdition field-name="enumGroupEnumId" from="isCustomerInternalOrg ? 'EngItemsPurchase' : 'EngItemsSales'"/><order-by field-name="description"/></entity-find></entity-options></drop-down></header-field><default-field title="Type" container-style="${isProductItemType ? 'text-info text-strong' : (itemTypeEnumId == 'ItemDiscount' ? 'text-success' : (itemTypeEnumId in ['ItemSalesTax','ItemVatTax'] ? 'text-warning' : ''))}"><display-entity entity-name="moqui.basic.Enumeration" text="${description}${isPromo ? ' (Promotion)' : ''}"/></default-field></field><field name="productId"><header-field title="Product"><drop-down allow-empty="true"><dynamic-options transition="getProductList" server-search="true" min-length="0"/></drop-down></header-field><default-field><link url="editProduct" text="ProductNameTemplate" entity-name="mantle.product.Product" link-type="anchor" condition="productId"/></default-field></field><field name="otherPartyProductId"><header-field show-order-by="true"><text-find/></header-field><default-field><display/></default-field></field><field name="itemDescription"><header-field show-order-by="true"><text-find/></header-field><default-field title="Description" container-style="${parentItemSeqId ? '' : 'text-strong'}"><display/></default-field></field><field name="promoCodeText"><header-field show-order-by="true"><text-find/></header-field><default-field title="Promo Code"><display/></default-field></field><field name="comments"><header-field show-order-by="true"><text-find/></header-field><default-field><display/></default-field></field><field name="requiredByDate"><default-field><display/></default-field></field><field name="unitListPrice"><default-field title="List Price"><display currency-unit-field="orderHeader.currencyUomId"/></default-field></field><field name="unitAmount"><header-field show-order-by="true"><range-find size="10"/></header-field><default-field title="Price"><display currency-unit-field="orderHeader.currencyUomId"/></default-field></field><field name="standardCost"><default-field><display currency-unit-field="orderHeader.currencyUomId"/></default-field></field><field name="quantity"><header-field show-order-by="true"><range-find size="10"/></header-field><default-field><display/></default-field></field><field name="quantityCancelled"><header-field show-order-by="true"><range-find size="10"/></header-field><default-field><display/></default-field></field><field name="quantityCancelled"><header-field show-order-by="true"><range-find size="10"/></header-field><default-field><display/></default-field></field><field name="itemQuantityNotShipped"><default-field title="Qty Not Shipped"><display format="#,##0.###"/></default-field></field><field name="itemQuantityNotBilled"><default-field title="Qty Not Billed"><display format="#,##0.###"/></default-field></field><field name="itemAmountNotBilled"><default-field title="Amt Not Billed"><display format="#,##0.00"/></default-field></field><field name="itemNotBilled"><default-field title="Not Billed"><label text="${ec.l10n.format(itemQuantityNotBilled, '#,##0.###')}" condition="isProductItemType"/><label text="${ec.l10n.format(itemAmountNotBilled, '#,##0.00')}" condition="!isProductItemType"/></default-field></field><field name="assetReservations"><conditional-field condition="isShippable && isVendorInternalOrg"><section-iterate name="ReservationInfoSection" list="resInfoList" entry="resInfo"><widgets><container><link url="assetDetail" text="Asset ${resInfo.existingRes.assetId}" parameter-map="[assetId:resInfo.existingRes.assetId]" link-type="anchor"/><label text=" - Res: ${ec.l10n.format(resInfo.existingRes.quantity, null)}, Not Avail: ${ec.l10n.format(resInfo.existingRes.quantityNotAvailable, null)}, Not Issued: ${ec.l10n.format(resInfo.existingRes.quantityNotIssued, null)}" type="span" style="${resInfo.existingRes.quantityNotAvailable ? 'text-danger' : ''}"/><container><label text="Lot" type="strong" condition="resInfo.assetLot?.lotId"/><label text="${ec.resource.expand('LotNameTemplate', '', resInfo.assetLot)}" condition="resInfo.assetLot?.lotId"/></container></container></widgets></section-iterate><label text="Multiple lots ${lotIdSet}" condition="singleLot && lotIdSet.size() > 1" type="div" style="text-danger"/><label text="Oldest lot ${ec.l10n.format(oldestLotExpire, 'yyyy-MM-dd')} older than last lot expire ${ec.l10n.format(newerThanExpireDate, 'yyyy-MM-dd')}" condition="newerInventory && newerThanExpireDate!=null && oldestLotExpire!=null && oldestLotExpire < newerThanExpireDate" type="div" style="text-danger"/><dynamic-dialog id="ItemReserveDialog" button-text="Reserve Assets" transition="ItemReserve" width="960" condition="partEditable || orderPart.statusId == 'OrderApproved'"/><link url="removeOrderItemReservations" text="" btn-type="danger" icon="fa fa-trash" condition="resInfoList" confirmation="Remove inventory reservations for item ${orderItemSeqId}?"/></conditional-field><default-field><display text=" "/></default-field></field><field name="itemTotal" from="orderItemTotalOut?.itemTotal" align="right"><default-field><display currency-unit-field="orderHeader.currencyUomId"/></default-field></field><field name="itemPlusChildrenTotal" from="orderItemTotalOut?.itemPlusChildrenTotal" align="right"><conditional-field condition="productId"><display currency-unit-field="orderHeader.currencyUomId"/></conditional-field><default-field title="With Children"><display text=""/></default-field></field><field name="returns"><default-field><label text="OrderDetailItemBilled" type="div"/><label text="OrderDetailItemReturned" type="div"/><section-iterate name="ReturnLinkSection" list="returnIdSet" entry="returnId"><widgets><link url="editReturn" text="#${returnId}" link-type="anchor"/></widgets></section-iterate><label text="OrderDetailItemReturnable" type="div"/></default-field></field><field name="returnItem"><conditional-field condition="openReturnList && returnableOut.returnableQuantity > 0"><dynamic-dialog id="ReturnItemCtr" button-text="Return" transition="ReturnItem"><parameter name="orderId"/><parameter name="orderItemSeqId" from="orderItem.orderItemSeqId"/></dynamic-dialog></conditional-field><default-field title=""><display text=" "/></default-field></field><field name="editButton"><default-field title="Actions"><dynamic-dialog id="EditItemDialog" button-text="Edit" transition="EditItem"><parameter name="orderId"/><parameter name="orderItemSeqId" from="orderItem.orderItemSeqId"/></dynamic-dialog><link url="deleteItem" text="" btn-type="danger" icon="fa fa-trash" condition="partEditable && itemCanDelete" confirmation="Delete item ${orderItemSeqId}?"/><link url="cancelOrderItem" text="Close" btn-type="warning" link-type="hidden-form" confirmation="Really close item? Quantity will be reduced to quantity shipped and remaining quantity will be cancelled." condition="isProductItemType && itemQuantityNotShipped && orderPart.statusId in ['OrderOpen', 'OrderPlaced', 'OrderProcessing', 'OrderApproved', 'OrderHold']" parameter-map="[orderItem:null]"/></default-field></field><field name="findButton"><header-field title="Find"><submit/></header-field></field><form-list-column><field-ref name="orderItemSeqId"/><field-ref name="orderPartSeqId"/><field-ref name="parentItemSeqId"/></form-list-column><form-list-column><field-ref name="itemTypeEnumId"/><field-ref name="productId"/><field-ref name="otherPartyProductId"/></form-list-column><form-list-column><field-ref name="itemDescription"/><field-ref name="comments"/><field-ref name="requiredByDate"/></form-list-column><form-list-column><field-ref name="unitListPrice"/><field-ref name="unitAmount"/><field-ref name="quantity"/></form-list-column><form-list-column><field-ref name="itemQuantityNotShipped"/><field-ref name="itemNotBilled"/><field-ref name="assetReservations"/><field-ref name="standardCost"/></form-list-column><form-list-column><field-ref name="itemTotal"/><field-ref name="itemPlusChildrenTotal"/></form-list-column><form-list-column><field-ref name="returns"/><field-ref name="returnItem"/></form-list-column><form-list-column><field-ref name="editButton"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Order/QuickItems.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Quick Items" default-menu-index="3"><parameter name="orderId" from="orderId ?: orderId_0" required="true"/><parameter name="orderPartSeqId" from="orderPartSeqId ?: orderPartSeqId_0"/><parameter name="productCategoryId" from="productCategoryId ?: productCategoryId_0"/><transition name="editProduct"><default-response url="//${appRoot}/Product/EditProduct"/></transition><transition name="setItemQuantities"><service-call name="mantle.order.OrderServices.add#OrderProductQuantity" multi="true" in-map="context + [addToQuantity:false, requireInventory:false, quantity:0, customerPartyId:null]" out-map="context"/><actions><log message="Order ${orderId} setItemQuantities parameters: ${ec.web.requestParameters}"/></actions><default-response url="."/></transition><actions><entity-find-one entity-name="mantle.order.OrderHeader" value-field="orderHeader"/><if condition="orderPartSeqId"><entity-find-one entity-name="mantle.order.OrderPart" value-field="orderPart"/><set field="productStoreId" from="orderHeader.productStoreId"/><if condition="!productCategoryId && productStoreId"><entity-find entity-name="mantle.product.store.ProductStoreCategory" list="psCatList" cache="true"><date-filter/><econdition field-name="productStoreId"/><econdition field-name="storeCategoryTypeEnumId" value="PsctQuickInternal"/></entity-find><if condition="!psCatList"><entity-find entity-name="mantle.product.store.ProductStoreCategory" list="psCatList" cache="true"><date-filter/><econdition field-name="productStoreId"/><econdition field-name="storeCategoryTypeEnumId" value="PsctQuickAdd"/></entity-find></if><if condition="!psCatList"><entity-find entity-name="mantle.product.store.ProductStoreCategory" list="psCatList" cache="true"><date-filter/><econdition field-name="productStoreId"/><econdition field-name="storeCategoryTypeEnumId" value="PsctSearch"/></entity-find></if><set field="productCategoryId" from="psCatList ? psCatList[0].productCategoryId : null"/></if><set field="productInfoList" from="[]"/><if condition="productCategoryId"><entity-find entity-name="ProductCategoryMemberProduct" list="productList" cache="true"><date-filter/><econdition field-name="productCategoryId"/><econdition field-name="productTypeEnumId" operator="not-equals" value="PtVirtual"/></entity-find></if><entity-find entity-name="moqui.basic.EnumGroupMember" list="productItemTypeEgms" cache="true"><econdition field-name="enumGroupEnumId" value="EngItemsProduct"/></entity-find><set field="productItemTypes" from="productItemTypeEgms*.enumId"/><entity-find entity-name="mantle.order.OrderItem" list="orderItemList" cache="false"><econdition field-name="orderId"/><econdition field-name="orderPartSeqId"/><econdition field-name="productId" operator="is-not-null"/><econdition field-name="itemTypeEnumId" operator="in" from="productItemTypes"/></entity-find><iterate list="productList" entry="product"><set field="prodItemList" from="orderItemList.findAll({ it.productId == product.productId })"/><if condition="prodItemList"><then><iterate list="prodItemList" entry="prodItem"><script><![CDATA[productInfoList.add(product.getMap() + prodItem.getMap())]]></script></iterate><script><![CDATA[orderItemList.removeByAnd([productId:product.productId])]]></script></then><else><script><![CDATA[productInfoList.add(product.getMap())]]></script></else></if></iterate><iterate list="orderItemList" entry="orderItem"><entity-find-one entity-name="mantle.product.Product" value-field="product" cache="true"><field-map field-name="productId" from="orderItem.productId"/></entity-find-one><script><![CDATA[productInfoList.add(product.getMap() + orderItem.getMap())]]></script></iterate><set field="orderByField" from="orderByField ?: 'pseudoId,orderItemSeqId'"/><script><![CDATA[orderMapList(productInfoList, (orderByField.split(',').collect({it?.trim()}) as List))]]></script></if></actions><widgets><form-single name="QuickItemOptions" transition="."><field name="orderId"><default-field><hidden/></default-field></field><field name="orderByField"><default-field><hidden/></default-field></field><field name="orderPartSeqId"><default-field title="Order Part"><drop-down><entity-options key="${orderPartSeqId}" text="${orderPartSeqId} ${ec.l10n.formatCurrency(partTotal, orderHeader.currencyUomId)}"><entity-find entity-name="mantle.order.OrderPart"><econdition field-name="orderId"/><select-field field-name="orderPartSeqId,partTotal"/><order-by field-name="orderPartSeqId"/></entity-find></entity-options></drop-down></default-field></field><field name="productCategoryId"><default-field title="Category"><drop-down allow-empty="true"><entity-options key="${productCategoryId}" text="${categoryName}"><entity-find entity-name="mantle.product.category.ProductCategory"><econdition field-name="productCategoryTypeEnumId" operator="in" value="PctQuickAdd,PctSearch,PctCatalog"/><order-by field-name="categoryName"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Select"><submit/></default-field></field><field-layout><field-row-big><field-ref name="orderPartSeqId"/><field-ref name="productCategoryId"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single><section name="QuickItemSection" condition="productInfoList"><widgets><form-list name="QuickItemList" list="productInfoList" multi="true" transition="setItemQuantities"><row-actions><service-call name="mantle.product.PriceServices.get#ProductPrice" out-map="priceOut" in-map="[productId:productId, priceUomId:orderHeader.currencyUomId,                                 productStoreId:productStoreId, customerPartyId:orderPart.customerPartyId]"/></row-actions><hidden-parameters><parameter name="orderId"/><parameter name="orderPartSeqId"/><parameter name="productCategoryId"/></hidden-parameters><field name="productId"><default-field><hidden/></default-field></field><field name="pseudoId"><header-field show-order-by="true"/><default-field><link url="editProduct" text="${pseudoId}" link-type="anchor"/></default-field></field><field name="productName"><header-field show-order-by="true"/><default-field><link url="editProduct" text="${productName}" link-type="anchor"/></default-field></field><field name="orderItemSeqId"><header-field title="Item" show-order-by="true"/><default-field><display/></default-field></field><field name="listPrice" from="priceOut.listPrice" align="right"><default-field><display currency-unit-field="orderHeader.currencyUomId" also-hidden="false"/></default-field></field><field name="calcPrice" from="priceOut.price" align="right"><default-field><display currency-unit-field="orderHeader.currencyUomId" also-hidden="false"/></default-field></field><field name="unitAmount" align="right"><conditional-field title="Price" condition="productId"><text-line size="8" format="#,##0.00"/></conditional-field><default-field title="Price"><display/></default-field></field><field name="quantity" align="right"><conditional-field condition="productId"><text-line size="4"/></conditional-field><default-field><display/></default-field></field><field name="itemQuantity" from="quantity" align="right"><default-field title="Cur Qty"><display also-hidden="false"/></default-field></field><field name="itemTotal" from="(quantity?:0.0)*(unitAmount?:0.0)" align="right"><default-field title="Cur Total"><display currency-unit-field="orderHeader.currencyUomId" also-hidden="false"/></default-field></field><field name="submitButton"><default-field title="Set Quantities"><submit/></default-field></field></form-list></widgets></section></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Order.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Orders" default-menu-index="6" menu-image="/ssstatic/images/Sales.png"><subscreens default-item="FindOrder"><subscreens-item name="OrderIssuedInvoiced" menu-include="false" location="component://SimpleScreens/screen/SimpleScreens/Accounting/Reports/OrderIssuedInvoiced.xml"/><subscreens-item name="SalesAnalysis" menu-include="false" location="component://SimpleScreens/screen/SimpleScreens/Accounting/Reports/SalesAnalysis.xml"/><subscreens-item name="SalesSummary" menu-include="false" location="component://SimpleScreens/screen/SimpleScreens/Accounting/Reports/SalesSummary.xml"/></subscreens><widgets><label text="Order ${orderId}" type="strong" condition="orderId"/><subscreens-panel id="OrderPanel" type="tab"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Project/FindProject.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="createProject"><service-call name="mantle.work.ProjectServices.create#Project" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditProject"/></transition><transition name="findProject"><default-response url="."/></transition><transition name="projectSummary"><default-response url="../ProjectSummary"/></transition><transition name="editProject"><default-response url="../EditProject"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><widgets><container-dialog id="NewProjectContainer" button-text="New Project"><form-single name="NewProject" transition="createProject"><field name="workEffortId"><default-field title="ID"><text-line size="8" maxlength="8"/></default-field></field><field name="workEffortName"><default-field title="Project Name"><text-line/></default-field></field><field name="clientPartyId"><default-field title="Client"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="0" parameter-map="[roleTypeId:'Customer,CustomerBillTo,OrgInternal']"/></drop-down></default-field></field><field name="vendorPartyId"><default-field title="Vendor"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="0" parameter-map="[roleTypeId:'Vendor,VendorBillFrom,OrgInternal']"/></drop-down></default-field></field><field name="purposeEnumId"><default-field title="Purpose"><drop-down allow-empty="true"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="WorkEffortPurpose"/><econdition field-name="parentEnumId" value="WetProject"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="ListProjects" list="projectList" skip-form="true" header-dialog="true" saved-finds="true"><entity-find entity-name="mantle.work.effort.WorkEffort" list="projectList"><search-form-inputs default-order-by="workEffortId"/><econdition field-name="workEffortTypeEnumId" value="WetProject"/></entity-find><field name="workEffortId"><header-field title="Project" show-order-by="case-insensitive"><text-find/></header-field><default-field><link url="projectSummary" text="${workEffortId}"/></default-field></field><field name="workEffortName"><header-field title="Name" show-order-by="case-insensitive"><text-find/></header-field><default-field><display also-hidden="false"/></default-field></field><field name="priority"><header-field show-order-by="true"><range-find/></header-field><default-field><display/></default-field></field><field name="statusId"><header-field title="Status" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="WorkEffort"/><set field="allowEmpty" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.StatusItem" also-hidden="false"/></default-field></field><field name="purposeEnumId"><header-field title="Purpose"><drop-down allow-empty="true"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="WorkEffortPurpose"/><econdition field-name="parentEnumId" value="WetProject"/><order-by field-name="description"/></entity-find></entity-options></drop-down></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="estimatedCompletionDate"><header-field title="Due Date" show-order-by="true"><date-period/></header-field><default-field><display format="yyyy-MM-dd"/></default-field></field><field name="estimatedWorkTime"><header-field title="Estimated Hours" show-order-by="true"><range-find/></header-field><default-field><display format="0.00"/></default-field></field><field name="actualWorkTime"><header-field title="Actual Hours" show-order-by="true"><range-find/></header-field><default-field><display format="0.00"/></default-field></field><field name="searchButton"><header-field title="Find Project"><submit/></header-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Project/MilestoneSummary.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><parameter name="milestoneWorkEffortId" required="true"/><parameter name="milestoneWorkEffortId_0"/><transition name="editMilestones"><default-response url="../EditMilestones"/></transition><transition name="editTask"><default-response url="//${appRoot}/Task/TaskSummary"/></transition><transition name="updateTask"><service-call name="mantle.work.TaskServices.update#Task" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><pre-actions><set field="milestoneWorkEffortId" from="milestoneWorkEffortId ?: milestoneWorkEffortId_0"/></pre-actions><actions><entity-find-one entity-name="mantle.work.effort.WorkEffort" value-field="milestoneWorkEffort"><field-map field-name="workEffortId" from="milestoneWorkEffortId"/></entity-find-one><entity-find entity-name="WorkEffortAssocAndTo" list="inactiveTaskList"><econdition field-name="fromWorkEffortId" from="milestoneWorkEffortId"/><econdition field-name="workEffortTypeEnumId" value="WetTask"/><econdition field-name="purposeEnumId" operator="not-equals" value="WepPlaceholder"/><econdition field-name="statusId" operator="in" value="WeInPlanning,WeApproved,WeOnHold"/><date-filter/><order-by field-name="priority"/><order-by field-name="estimatedCompletionDate"/></entity-find><entity-find entity-name="WorkEffortAssocAndTo" list="activeTaskList"><econdition field-name="fromWorkEffortId" from="milestoneWorkEffortId"/><econdition field-name="workEffortTypeEnumId" value="WetTask"/><econdition field-name="purposeEnumId" operator="not-equals" value="WepPlaceholder"/><econdition field-name="statusId" value="WeInProgress"/><date-filter/><order-by field-name="priority"/><order-by field-name="estimatedCompletionDate"/></entity-find><entity-find entity-name="WorkEffortAssocAndTo" list="doneTaskList"><econdition field-name="fromWorkEffortId" from="milestoneWorkEffortId"/><econdition field-name="workEffortTypeEnumId" value="WetTask"/><econdition field-name="purposeEnumId" operator="not-equals" value="WepPlaceholder"/><econdition field-name="statusId" operator="in" value="WeComplete,WeClosed"/><date-filter/><order-by field-name="priority"/><order-by field-name="estimatedCompletionDate"/></entity-find></actions><widgets><label text="Summary for Milestone "${milestoneWorkEffort.workEffortName}" - ${milestoneWorkEffortId}" type="h3"/><link text="Project Milestones" url="editMilestones" link-type="anchor-button"><parameter name="rootWorkEffortId" from="milestoneWorkEffort.rootWorkEffortId"/></link><label text="Inactive Tasks" type="h4"/><form-list name="InactiveTaskList" list="inactiveTaskList" transition="updateTask" multi="true"><row-actions><entity-find-one entity-name="moqui.basic.StatusItem" value-field="currentStatus"/></row-actions><field name="milestoneWorkEffortId"><default-field><hidden/></default-field></field><field name="workEffortId" from="toWorkEffortId"><default-field><hidden/></default-field></field><field name="priority"><header-field show-order-by="true"/><default-field><display/></default-field></field><field name="purposeEnumId"><header-field title="Purpose" show-order-by="true"/><default-field><display-entity entity-name="moqui.basic.Enumeration" also-hidden="false"/></default-field></field><field name="workEffortName"><header-field title="Task" show-order-by="case-insensitive"/><default-field><link url="editTask" text="${toWorkEffortId}: ${workEffortName}" link-type="anchor"><parameter name="workEffortId" from="toWorkEffortId"/></link></default-field></field><field name="statusId"><default-field title="Status"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusTransitionDropDown"><set field="currentDescription" from="currentStatus?.description"/></widget-template-include></default-field></field><field name="estimatedCompletionDate"><default-field title="Due Date"><date-time type="date"/></default-field></field><field name="estimatedWorkTime"><default-field title="Estimated"><text-line size="4"/></default-field></field><field name="actualWorkTime"><default-field title="Actual"><display format="0.00"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-list><label text="Active Tasks" type="h4"/><form-list name="ActiveTaskList" list="activeTaskList" transition="updateTask" extends="InactiveTaskList"/><label text="Completed Tasks" type="h4"/><form-list name="DoneTaskList" list="doneTaskList" transition="updateTask" extends="InactiveTaskList"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Project/ProjectSummary.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Project Summary" default-menu-index="0"><parameter name="workEffortId" from="rootWorkEffortId ?: workEffortId" required="true"/><parameter name="rootWorkEffortId" from="rootWorkEffortId ?: workEffortId"/><transition name="editClient"><default-response url="//${appRoot}/Customer/EditCustomer"/></transition><transition name="editVendor"><default-response url="//${appRoot}/Supplier/EditSupplier"/></transition><transition name="editUser"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition name="projectSummary"><default-response url="../ProjectSummary"/></transition><transition name="milestoneSummary"><default-response url="../MilestoneSummary"/></transition><transition name="taskSummary"><default-response url="//${taskRoot?:appRoot}/Task/TaskSummary"/></transition><pre-actions><if condition="rootWorkEffortId"><set field="workEffortId" from="rootWorkEffortId"/></if><set field="rootWorkEffortId" from="workEffortId"/></pre-actions><actions><entity-find-one entity-name="mantle.work.effort.WorkEffort" value-field="workEffort"/><set field="projectList" from="[workEffort]"/><entity-find entity-name="mantle.work.effort.WorkEffortParty" list="clientWepList"><date-filter/><econdition field-name="workEffortId"/><econdition field-name="roleTypeId" operator="in" value="Customer,CustomerBillTo"/></entity-find><set field="clientWep" from="clientWepList?.getAt(0)"/><entity-find entity-name="mantle.work.effort.WorkEffortParty" list="vendorWepList"><date-filter/><econdition field-name="workEffortId"/><econdition field-name="roleTypeId" operator="in" value="Vendor,VendorBillFrom"/></entity-find><set field="vendorWep" from="vendorWepList?.getAt(0)"/><entity-find entity-name="WorkEffort" list="milestoneList"><econdition field-name="rootWorkEffortId"/><econdition field-name="workEffortTypeEnumId" value="WetMilestone"/><order-by field-name="estimatedStartDate"/></entity-find><entity-find entity-name="mantle.work.effort.WikiPageAndWorkEffort" list="wpaweList"><econdition field-name="workEffortId"/></entity-find><entity-find entity-name="mantle.work.effort.WorkEffortPartyAndPerson" list="wepapList"><econdition field-name="workEffortId" from="rootWorkEffortId"/></entity-find></actions><widgets><section-iterate name="ActiveProjectSection" list="projectList" entry="project" paginate="true"><actions><service-call name="mantle.work.ProjectServices.get#ProjectStats" in-map="[workEffort:project]" out-map="pstats"/><set field="estimatedCompletePercentString" from="ec.l10n.format(pstats.estimatedCompletePercent, '0')"/><set field="estimatedRemainingPercentString" from="ec.l10n.format(pstats.estimatedRemainingPercent, '0')"/><set field="clientBudgetUsedPercentString" from="ec.l10n.format(pstats.clientBudgetUsedPercent, '0')"/><set field="timeBudgetCompletePercentString" from="ec.l10n.format(pstats.timeBudgetCompletePercent, '0')"/><set field="timeBudgetRemainingPercentString" from="ec.l10n.format(pstats.timeBudgetRemainingPercent, '0')"/></actions><widgets><container-box><box-header><link url="projectSummary" text="${project.workEffortId}" link-type="anchor-button" parameter-map="[workEffortId:project.workEffortId]"/><label text="${project.workEffortName}" type="h5"/></box-header><box-toolbar><label text="${pstats.projectDanger ? 'Danger' : (pstats.projectWarning ? 'Warning' : 'On Track')}" style="label ${pstats.projectDanger ? 'label-danger' : (pstats.projectWarning ? 'label-warning' : 'label-success')}"/></box-toolbar><box-body><container-row><row-col lg="7"><container style="shaded-area"><container-row><row-col sm="2"><label text="Hrs Est" type="strong"/></row-col><row-col sm="7"><render-mode><text type="html,vuet" template="true"><![CDATA[<div class="progress middle"><div class="progress-bar <#if pstats.actualPlusRemainingOverEstimated>progress-bar-danger<#else>progress-bar-success</#if>" style="width: ${estimatedCompletePercentString}%;" aria-valuenow="${estimatedCompletePercentString}" aria-valuemin="0" aria-valuemax="100"></div><div class="progress-bar progress-bar-info" style="width: ${estimatedRemainingPercentString}%;" aria-valuenow="${estimatedRemainingPercentString}" aria-valuemin="0" aria-valuemax="100"></div></div>]]></text><text type="qvt" template="true"><![CDATA[<q-linear-progress size="xl" class="q-mt-xs" :value="${pstats.estimatedCompletePercent/100}" :buffer="${pstats.estimatedRemainingPercent/100}"
                                    color="<#if pstats.actualPlusRemainingOverEstimated>negative<#else>positive</#if>" track-color="info"/>]]></text></render-mode></row-col><row-col sm="3"><label text="${ec.l10n.format(pstats.estimatedCompletePercent, '00.00')}%"/><render-mode><text type="html,vuet,qvt" template="true"><![CDATA[<i class="fa <#if pstats.actualPlusRemainingOverEstimated>fa-exclamation-circle text-danger<#else>fa-check-circle text-success</#if>"></i>]]></text></render-mode></row-col></container-row><section name="TimeBudgetGraphs" condition="project.totalTimeAllowed"><widgets><container-row><row-col sm="2"><label text="Hrs Budget" type="strong"/></row-col><row-col sm="7"><render-mode><text type="html,vuet" template="true"><![CDATA[<div class="progress middle"><div class="progress-bar <#if pstats.actualPlusRemainingOverTimeBudget>progress-bar-danger<#else>progress-bar-success</#if>" style="width: ${timeBudgetCompletePercentString}%;" aria-valuenow="${timeBudgetCompletePercentString}" aria-valuemin="0" aria-valuemax="100"></div><div class="progress-bar progress-bar-info" style="width: ${timeBudgetRemainingPercentString}%;" aria-valuenow="${timeBudgetRemainingPercentString}" aria-valuemin="0" aria-valuemax="100"></div></div>]]></text><text type="qvt" template="true"><![CDATA[<q-linear-progress size="xl" class="q-mt-xs" :value="${pstats.timeBudgetCompletePercent/100}" :buffer="${pstats.timeBudgetRemainingPercent/100}"
                                        color="<#if pstats.actualPlusRemainingOverTimeBudget>negative<#else>positive</#if>" track-color="info"/>]]></text></render-mode></row-col><row-col sm="3"><label text="${ec.l10n.format(pstats.timeBudgetCompletePercent, '00.00')}%"/><render-mode><text type="html,vuet,qvt" template="true"><![CDATA[<i class="fa <#if pstats.actualPlusRemainingOverEstimated>fa-exclamation-circle text-danger<#else>fa-check-circle text-success</#if>"></i>]]></text></render-mode></row-col></container-row></widgets></section><section name="CostBudgetGraphs" condition="project.totalClientCostAllowed"><widgets><container-row><row-col sm="2"><label text="Cost Budget" type="strong"/></row-col><row-col sm="7"><render-mode><text type="html,vuet" template="true"><![CDATA[<div class="progress middle"><div class="progress-bar <#if pstats.clientActualOverBudget>progress-bar-danger<#else>progress-bar-success</#if>" style="width: ${clientBudgetUsedPercentString}%;" aria-valuenow="${clientBudgetUsedPercentString}" aria-valuemin="0" aria-valuemax="100"></div></div>]]></text><text type="qvt" template="true"><![CDATA[<q-linear-progress size="xl" class="q-mt-xs" :value="${pstats.clientBudgetUsedPercent/100}"
                                        color="<#if pstats.clientActualOverBudget>negative<#else>positive</#if>"/>]]></text></render-mode></row-col><row-col sm="3"><label text="${ec.l10n.format(pstats.clientBudgetUsedPercent, '00.00')}%"/><render-mode><text type="html,vuet,qvt" template="true"><![CDATA[<i class="fa <#if pstats.clientActualOverBudget>fa-exclamation-circle text-danger<#else>fa-check-circle text-success</#if>"></i>]]></text></render-mode></row-col></container-row><container-row><row-col sm="2"><label text="P-CB Gap" type="strong"/></row-col><row-col sm="7"><render-mode><text type="html,vuet" template="true"><![CDATA[<div class="progress xs" style="height:6px;"><div class="progress-bar <#if pstats.estimatedCompleteOverBudget>progress-bar-warning<#else>progress-bar-success</#if>" style="width: ${estimatedCompletePercentString}%;" aria-valuenow="${estimatedCompletePercentString}" aria-valuemin="0" aria-valuemax="100"></div></div><div class="progress xs" style="height:6px;"><div class="progress-bar <#if pstats.estimatedCompleteOverBudget>progress-bar-warning<#else>progress-bar-success</#if>" style="width: ${clientBudgetUsedPercentString}%;" aria-valuenow="${clientBudgetUsedPercentString}" aria-valuemin="0" aria-valuemax="100"></div></div>]]></text><text type="qvt" template="true"><![CDATA[<q-linear-progress size="sm" class="q-mt-xs" :value="${pstats.estimatedCompletePercent/100}"
                                        color="<#if pstats.estimatedCompleteOverBudget>negative<#else>positive</#if>"/><q-linear-progress size="sm" class="q-mt-xs" :value="${pstats.clientBudgetUsedPercent/100}"
                                        color="<#if pstats.estimatedCompleteOverBudget>negative<#else>positive</#if>"/>]]></text></render-mode></row-col><row-col sm="3"><label text="${ec.l10n.format(pstats.estimatedCompleteBudgetPercentGap, '00.00')}%"/><render-mode><text type="html,vuet,qvt" template="true"><![CDATA[<i class="fa <#if pstats.estimatedCompleteOverBudget>fa-exclamation-circle text-warning<#else>fa-check-circle text-success</#if>"></i>]]></text></render-mode></row-col></container-row></widgets></section><container-row><row-col sm="4"><label text="Estimate ${ec.l10n.format(project.estimatedWorkTime, '#.#')} hrs" type="strong"/></row-col><row-col sm="4"><label text="Worked ${ec.l10n.format(project.actualWorkTime, '#.#')} hrs" type="strong" style="${pstats.actualPlusRemainingOverEstimated ? 'text-danger' : 'text-success'}"/></row-col><row-col sm="4"><label text="Est Rem ${ec.l10n.format(project.remainingWorkTime, '#.#')} hrs" type="strong" style="text-info"/></row-col></container-row><section name="TimeBudgetStats" condition="project.totalTimeAllowed"><widgets><container-row><row-col sm="4"><label text="Budget ${ec.l10n.format(project.totalTimeAllowed, '#.#')} hrs" type="strong"/></row-col><row-col sm="4"><label text="Act Bgt Rem ${ec.l10n.format(project.totalTimeAllowed - (project.actualWorkTime?:0), '#.#')} hrs" type="strong" style="text-info"/></row-col><row-col sm="4"><label text="Est Bgt Rem ${ec.l10n.format(project.totalTimeAllowed - pstats.actualPlusRemainingTime, '#.#')} hrs" type="strong" style="${pstats.actualPlusRemainingOverTimeBudget ? 'text-danger' : 'text-success'}"/></row-col></container-row></widgets></section><container-row><row-col sm="4"><label text="Avg Rate ${ec.l10n.formatCurrency(pstats.clientAverageHourCost, project.costUomId, 2)}" type="strong"/></row-col><row-col sm="4"><label text="Actual Cost ${ec.l10n.formatCurrency(project.actualClientCost, project.costUomId, 2)}" type="strong" style="${pstats.clientActualOverBudget ? 'text-danger' : 'text-success'}"/></row-col><row-col sm="4"><label text="Est Cost ${ec.l10n.formatCurrency(pstats.clientEstimatedCost, project.costUomId, 2)}" type="strong"/></row-col></container-row><section name="CostBudgetStats" condition="project.totalClientCostAllowed"><widgets><container-row><row-col sm="4"><label text="Budget ${ec.l10n.formatCurrency(project.totalClientCostAllowed, project.costUomId, 2)}" type="strong"/></row-col><row-col sm="4"><label text="Rem ${ec.l10n.formatCurrency(pstats.clientBudgetRemaining, project.costUomId, 2)}" type="strong"/></row-col><row-col sm="4"><label text="Est ${ec.l10n.formatCurrency(pstats.clientBudgetEstimateDiff?.abs(), project.costUomId, 2)} ${pstats.clientBudgetEstimateDiff < 0 ? 'over' : 'under'}" type="strong" style="${pstats.clientBudgetEstimateDiff < 0 ? 'text-warning' : 'text-success'}"/></row-col></container-row></widgets></section><container-row><row-col xs="6" style="text-center"><label text="Provider Cost ${ec.l10n.formatCurrency(project.actualCost, project.costUomId, 2)}" type="strong"/></row-col><row-col xs="6" style="text-center"><label text="Profit ${ec.l10n.formatCurrency(pstats.actualProfit, project.costUomId, 2)}" type="strong"/></row-col></container-row></container></row-col><row-col lg="5"><container style="shaded-area"><container-row><row-col sm="3"><container id="status-chart"/><render-mode><text type="html,vuet,qvt" template="true"><![CDATA[<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-sparklines/2.1.2/jquery.sparkline.min.js" type="text/javascript"></script><script>
                                    $("#status-chart_${project_index}").sparkline([${pstats.taskCountByStatusMap.WeApproved!'0'}, ${pstats.taskCountByStatusMap.WeOnHold!'0'}, ${pstats.taskCountByStatusMap.WeInProgress!'0'}, ${pstats.taskCountByStatusMap.WeClosed!'0' + pstats.taskCountByStatusMap.WeComplete!'0'}], {
                                        type: 'pie', width: '80', height: '80', sliceColors: ['#8a6d3b', '#a94442', '#3c763d', '#31708f'], offset: 180,
                                    });
                                </script>]]></text></render-mode></row-col><row-col sm="9"><container-row><row-col xs="12"><label text="${pstats.taskCount} Tasks" type="strong"/></row-col></container-row><container-row><row-col sm="5"><link text="Approved - ${pstats.taskCountByStatusMap.WeApproved?:0}" style="text-warning" url="findTask" link-type="anchor" parameter-map="[rootWorkEffortId:project.workEffortId, statusId:'WeApproved']"/></row-col><row-col sm="7"><link text="On Hold - ${pstats.taskCountByStatusMap.WeOnHold?:0}" style="text-danger" url="findTask" link-type="anchor" parameter-map="[rootWorkEffortId:project.workEffortId, statusId:'WeOnHold']"/></row-col></container-row><container-row><row-col sm="5"><link text="In Progress - ${pstats.taskCountByStatusMap.WeInProgress?:0}" style="text-success" url="findTask" link-type="anchor" parameter-map="[rootWorkEffortId:project.workEffortId, statusId:'WeInProgress']"/></row-col><row-col sm="7"><link text="Complete/Closed - ${((pstats.taskCountByStatusMap.WeComplete?:0) as BigDecimal) + ((pstats.taskCountByStatusMap.WeClosed?:0) as BigDecimal)}" style="text-info" url="findTask" link-type="anchor" parameter-map="[rootWorkEffortId:project.workEffortId, statusId:'WeComplete,WeClosed', statusId_op:'in']"/></row-col></container-row><container-row><row-col sm="5"><link text="In Planning - ${pstats.taskCountByStatusMap.WeInPlanning?:0}" url="findTask" link-type="anchor" parameter-map="[rootWorkEffortId:project.workEffortId, statusId:'WeInPlanning']"/></row-col><row-col sm="7"><link text="Cancelled - ${pstats.taskCountByStatusMap.WeCancelled?:0}" url="findTask" link-type="anchor" parameter-map="[rootWorkEffortId:project.workEffortId, statusId:'WeCancelled']"/></row-col></container-row></row-col></container-row></container></row-col></container-row></box-body></container-box></widgets></section-iterate><container-row><row-col md="6"><tree name="TaskTree"><tree-node name="TaskNode"><actions/><link url="taskSummary" text="${nodeList_entry.workEffortId}: ${nodeList_entry.workEffortName} - ${nodeList_entry.statusDescription?:''}${nodeList_entry.priority ? ' - P ' + nodeList_entry.priority : ''}" id="${treeNodeId == '#' ? '' : treeNodeId + '/'}${nodeList_entry.workEffortId}"><parameter name="workEffortId" from="nodeList_entry.workEffortId"/></link><tree-sub-node node-name="TaskNode" list="childTasks"><actions><set field="taskId" from="treeNodeId.split('/').last()"/><entity-find entity-name="mantle.work.effort.WorkEffortAndStatus" list="childTasks"><econdition field-name="workEffortTypeEnumId" value="WetTask"/><econdition field-name="parentWorkEffortId" from="taskId"/><order-by field-name="statusSequenceNum,priority,workEffortName"/></entity-find></actions></tree-sub-node></tree-node><tree-sub-node node-name="TaskNode" list="topLevelTasks"><actions><entity-find entity-name="mantle.work.effort.WorkEffortAndStatus" list="topLevelTasks"><econdition field-name="workEffortTypeEnumId" value="WetTask"/><econdition field-name="rootWorkEffortId"/><econdition field-name="parentWorkEffortId" from="null"/><order-by field-name="statusSequenceNum,priority,workEffortName"/></entity-find></actions></tree-sub-node></tree></row-col><row-col md="6"><form-single name="ViewProject" map="workEffort"><field name="clientPartyId" from="clientWep?.partyId"><default-field title="Client"><display-entity entity-name="mantle.party.PartyDetail" key-field-name="partyId" text="${organizationName?:''} ${firstName?:''} ${lastName?:''}"/><link url="editClient" text="Edit Client" link-type="anchor"><parameter name="partyId" from="clientWep?.partyId"/></link></default-field></field><field name="vendorPartyId" from="vendorWep?.partyId"><default-field title="Vendor"><display-entity entity-name="mantle.party.PartyDetail" key-field-name="partyId" text="${organizationName?:''} ${firstName?:''} ${lastName?:''}"/><link url="editVendor" text="Edit Vendor" link-type="anchor"><parameter name="partyId" from="vendorWep?.partyId"/></link></default-field></field><field name="priority"><default-field><display/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="statusFlowId"><default-field title="Status Flow"><display-entity entity-name="moqui.basic.StatusFlow"/></default-field></field><field name="estimatedCompletionDate"><default-field title="Due Date"><display format="yyyy-MM-dd"/></default-field></field><field name="estimatedWorkTime"><default-field title="Estimated Hours"><display format="0.00"/></default-field></field><field name="actualWorkTime"><default-field title="Actual Hours"><display format="0.00"/></default-field></field><field name="description"><default-field title="Description"><display/></default-field></field><field-layout><fields-not-referenced/><field-row><field-ref name="clientPartyId"/><field-ref name="vendorPartyId"/></field-row><field-row><field-ref name="priority"/><field-ref name="estimatedCompletionDate"/></field-row><field-row><field-ref name="statusId"/><field-ref name="statusFlowId"/></field-row><field-row><field-ref name="estimatedWorkTime"/><field-ref name="actualWorkTime"/></field-row><field-ref name="description"/></field-layout></form-single><form-list name="MilestoneList" list="milestoneList" skip-form="true"><field name="rootWorkEffortId"><default-field><hidden/></default-field></field><field name="workEffortId"><default-field title="Milestone"><link url="milestoneSummary" text="${workEffortId}" link-type="anchor"><parameter name="milestoneWorkEffortId" from="workEffortId"/></link></default-field></field><field name="workEffortName"><default-field title="Name"><display/></default-field></field><field name="estimatedStartDate"><default-field title="Start Date"><display format="yyyy-MM-dd"/></default-field></field><field name="estimatedCompletionDate"><default-field title="End Date"><display format="yyyy-MM-dd"/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field></form-list><form-list name="ViewWpweForm" list="wpaweList" skip-form="true"><field name="workEffortId"><default-field><hidden/></default-field></field><field name="rootWorkEffortId" from="projectWorkEffortId"><default-field><hidden/></default-field></field><field name="wikiPageId"><default-field><hidden/></default-field></field><field name="wikiSpaceId"><default-field title="Wiki Space"><display text=""/><link text="${wikiSpaceId}" url="//${appRoot}/Wiki/wiki/${wikiSpaceId}"/></default-field></field><field name="pagePath"><default-field title="Page"><display text=""/><link text="${pagePath}" url="//${appRoot}/Wiki/wiki/${wikiSpaceId}/${pagePath?:''}"/></default-field></field></form-list><form-list name="ViewUserAssignForm" list="wepapList" skip-form="true"><field name="rootWorkEffortId"><default-field><hidden/></default-field></field><field name="workEffortId"><default-field><hidden/></default-field></field><field name="partyId"><default-field><hidden/></default-field></field><field name="username"><header-field show-order-by="case-insensitive"/><default-field><link url="editUser" text="${username?:'--'}" link-type="anchor"/></default-field></field><field name="firstName"><header-field title="First##Name" show-order-by="case-insensitive"/><default-field><display also-hidden="false"/></default-field></field><field name="lastName"><header-field title="Last##Name" show-order-by="case-insensitive"/><default-field><display also-hidden="false"/></default-field></field><field name="roleTypeId"><header-field title="Role" show-order-by="true"/><default-field><display-entity entity-name="mantle.party.RoleType"/></default-field></field><field name="fromDate"><header-field show-order-by="true"/><default-field><display format="yyyy-MM-dd"/></default-field></field><field name="thruDate"><header-field show-order-by="true"/><default-field><display format="yyyy-MM-dd"/></default-field></field><field name="expectationEnumId"><header-field title="Expectation" show-order-by="true"/><default-field><display-entity entity-name="moqui.basic.Enumeration" key-field-name="enumId"/></default-field></field><field name="emplPositionClassId"><header-field title="Position Class" show-order-by="true"/><default-field><display-entity entity-name="EmplPositionClass" text="${title}"/></default-field></field><field name="statusId"><header-field title="Status" show-order-by="true"/><default-field><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><form-list-column><field-ref name="username"/><field-ref name="roleTypeId"/></form-list-column><form-list-column><field-ref name="firstName"/><field-ref name="lastName"/></form-list-column><form-list-column><field-ref name="fromDate"/><field-ref name="thruDate"/></form-list-column><form-list-column><field-ref name="expectationEnumId"/><field-ref name="emplPositionClassId"/></form-list-column><form-list-column><field-ref name="statusId"/></form-list-column></form-list></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Project/EditProject.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Project" default-menu-index="1"><parameter name="workEffortId"/><parameter name="rootWorkEffortId" required="true" from="rootWorkEffortId ?: workEffortId"/><transition name="updateProject"><service-call name="mantle.work.ProjectServices.update#Project" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="cloneProject"><service-call name="mantle.work.ProjectServices.clone#Project" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="editClient"><default-response url="../../Client/EditClient"/></transition><transition name="editVendor"><default-response url="../../Vendor/EditVendor"/></transition><transition name="projectSummary"><default-response url="../ProjectSummary"/></transition><transition name="editProject"><default-response url="."/></transition><transition name="findTask"><default-response url="//${appRoot}/Task/FindTask"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><pre-actions><if condition="rootWorkEffortId"><set field="workEffortId" from="rootWorkEffortId"/></if><set field="rootWorkEffortId" from="workEffortId"/></pre-actions><actions><entity-find-one entity-name="mantle.work.effort.WorkEffort" value-field="workEffort"/><set field="projectList" from="[workEffort]"/><entity-find entity-name="mantle.work.effort.WorkEffortParty" list="clientWepList"><date-filter/><econdition field-name="workEffortId"/><econdition field-name="roleTypeId" operator="in" value="Customer,CustomerBillTo"/></entity-find><set field="clientWep" from="clientWepList?.getAt(0)"/><entity-find entity-name="mantle.work.effort.WorkEffortParty" list="vendorWepList"><date-filter/><econdition field-name="workEffortId"/><econdition field-name="roleTypeId" operator="in" value="Vendor,VendorBillFrom"/></entity-find><set field="vendorWep" from="vendorWepList?.getAt(0)"/></actions><widgets><section-include name="ActiveProjectSection" location="component://SimpleScreens/screen/SimpleScreens/Project/ProjectSummary.xml"/><container-dialog id="CloneProjectDialog" button-text="Clone Project"><form-single name="CloneProject" transition="cloneProject"><field name="baseWorkEffortId" from="rootWorkEffortId"><default-field><hidden/></default-field></field><field name="workEffortId" from="null"><default-field title="New ID"><text-line size="8"/></default-field></field><field name="workEffortName"><default-field title="New Name"><text-line size="40"/></default-field></field><field name="priority"><default-field><drop-down no-current-selected-key="5"><option key="1"/><option key="2"/><option key="3"/><option key="4"/><option key="5"/><option key="6"/><option key="7"/><option key="8"/><option key="9"/></drop-down></default-field></field><field name="estimatedStartDate"><default-field title="Start Date"><date-time type="date" format="yyyy-MM-dd"/></default-field></field><field name="estimatedCompletionDate"><default-field title="Due Date"><date-time type="date" format="yyyy-MM-dd"/></default-field></field><field name="submitButton"><default-field title="Deep Clone Project"><submit confirmation="Really clone the project?"/></default-field></field></form-single></container-dialog><form-single name="EditProject" transition="updateProject" map="workEffort"><field name="workEffortId"><default-field title="Project ID"><hidden/></default-field></field><field name="workEffortName"><default-field title="Project Name"><text-line/></default-field></field><field name="clientPartyId" from="clientWep?.partyId"><default-field title="Client"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="0" parameter-map="[roleTypeId:'Customer,CustomerBillTo,OrgInternal']"/></drop-down><link url="editClient" text="Edit Client" link-type="anchor" condition="clientWep"><parameter name="partyId" from="clientWep?.partyId"/></link></default-field></field><field name="vendorPartyId" from="vendorWep?.partyId"><default-field title="Vendor"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="0" parameter-map="[roleTypeId:'Vendor,VendorBillFrom,OrgInternal']"/></drop-down><link url="editVendor" text="Edit Vendor" link-type="anchor" condition="vendorWep"><parameter name="partyId" from="vendorWep?.partyId"/></link></default-field></field><field name="purposeEnumId"><default-field title="Purpose"><drop-down allow-empty="true"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="WorkEffortPurpose"/><econdition field-name="parentEnumId" value="WetProject"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="priority"><default-field><drop-down no-current-selected-key="5"><option key="1"/><option key="2"/><option key="3"/><option key="4"/><option key="5"/><option key="6"/><option key="7"/><option key="8"/><option key="9"/></drop-down></default-field></field><field name="visibilityEnumId"><default-field title="Visibility"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="WorkEffortVisibility"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="statusId"><default-field title="Status"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusTransitionWithFlowDropDown"><set field="currentDescription" from="workEffort?.'WorkEffort#moqui.basic.StatusItem'?.description"/><set field="statusId" from="workEffort.statusId"/><set field="statusFlowId" from="workEffort.statusFlowId ?: 'Default'"/></widget-template-include></default-field></field><field name="statusFlowId"><default-field title="Status Flow"><drop-down allow-empty="true"><entity-options key="${statusFlowId}" text="${description} [${statusFlowId}]"><entity-find entity-name="moqui.basic.StatusFlow"><econdition field-name="statusTypeId" value="WorkEffort" or-null="true"/></entity-find></entity-options></drop-down></default-field></field><field name="estimatedStartDate"><default-field title="Start Date"><date-time type="date" format="yyyy-MM-dd"/></default-field></field><field name="estimatedCompletionDate"><default-field title="Due Date"><date-time type="date" format="yyyy-MM-dd"/></default-field></field><field name="totalClientCostAllowed"><default-field title="Cost Budget"><text-line size="15"/></default-field></field><field name="totalTimeAllowed"><default-field title="Hours Budget"><text-line size="10"/></default-field></field><field name="description"><default-field title="Description"><text-area rows="12" cols="100"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field-layout><fields-not-referenced/><field-row><field-ref name="priority"/><field-ref name="visibilityEnumId"/></field-row><field-row><field-ref name="statusId"/><field-ref name="statusFlowId"/></field-row><field-row><field-ref name="estimatedStartDate"/><field-ref name="estimatedCompletionDate"/></field-row><field-row><field-ref name="totalClientCostAllowed"/><field-ref name="totalTimeAllowed"/></field-row><field-ref name="description"/><field-ref name="submitButton"/></field-layout></form-single></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Project/EditMilestones.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Milestones" default-menu-index="2"><parameter name="rootWorkEffortId" required="true"/><transition name="createMilestone"><service-call name="mantle.work.ProjectServices.create#Milestone" in-map="context" out-map="bogus" multi="parameter"/><default-response url="."/></transition><transition name="updateMilestone"><service-call name="mantle.work.ProjectServices.update#Milestone" in-map="context" out-map="bogus" multi="parameter"/><default-response url="."/></transition><transition name="milestoneSummary"><default-response url="../MilestoneSummary"/></transition><actions><entity-find entity-name="WorkEffort" list="milestoneList"><econdition field-name="rootWorkEffortId"/><econdition field-name="workEffortTypeEnumId" value="WetMilestone"/><order-by field-name="estimatedStartDate"/></entity-find></actions><widgets><container-dialog id="CreateMilestoneDialog" button-text="Create Milestone"><form-single name="CreateMilestoneForm" transition="createMilestone"><field name="rootWorkEffortId"><default-field><hidden/></default-field></field><field name="workEffortId"><default-field title="Milestone ID"><text-line size="10" default-value="${rootWorkEffortId}-"/></default-field></field><field name="workEffortName"><default-field title="Milestone Name"><text-line size="25"/></default-field></field><field name="estimatedStartDate"><default-field title="Start Date"><date-time type="date" format="yyyy-MM-dd"/></default-field></field><field name="estimatedCompletionDate"><default-field title="End Date"><date-time type="date" format="yyyy-MM-dd"/></default-field></field><field name="statusId"><default-field title="Status"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="WorkEffort"/></widget-template-include></default-field></field><field name="submitButton"><default-field title="Create Milestone"><submit/></default-field></field></form-single></container-dialog><form-list name="MilestoneList" list="milestoneList" transition="updateMilestone"><row-actions><entity-find-one entity-name="moqui.basic.StatusItem" value-field="currentStatus"/></row-actions><field name="rootWorkEffortId"><default-field><hidden/></default-field></field><field name="workEffortId"><default-field title="Milestone"><display/><link url="milestoneSummary" text="Summary"><parameter name="milestoneWorkEffortId" from="workEffortId"/></link></default-field></field><field name="workEffortName"><default-field title="Name"><text-line size="25"/></default-field></field><field name="estimatedStartDate"><default-field title="Start Date"><date-time type="date" format="yyyy-MM-dd"/></default-field></field><field name="estimatedCompletionDate"><default-field title="End Date"><date-time type="date" format="yyyy-MM-dd"/></default-field></field><field name="statusId"><default-field title="Status"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusTransitionDropDown"><set field="currentDescription" from="currentStatus?.description"/></widget-template-include></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Project/EditUsers.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Parties" default-menu-index="3"><parameter name="workEffortId"/><parameter name="rootWorkEffortId" required="true" from="rootWorkEffortId ?: workEffortId"/><transition name="addUserAssign"><service-call name="create#mantle.work.effort.WorkEffortParty" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateUserAssign"><service-call name="update#mantle.work.effort.WorkEffortParty" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><actions><set field="workEffortId" from="rootWorkEffortId"/></actions><widgets><container-dialog id="AddUserAssignDialog" button-text="Add User Assignment"><form-single name="AddUserAssignForm" transition="addUserAssign"><field name="rootWorkEffortId"><default-field><hidden/></default-field></field><field name="workEffortId"><default-field><hidden/></default-field></field><field name="partyId"><default-field title="Person"><drop-down><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="roleTypeId"><default-field title="Role"><drop-down no-current-selected-key="Assignee"><entity-options key="${roleTypeId}" text="${description}"><entity-find entity-name="mantle.party.RoleGroupMemberAndType" cache="true"><econdition field-name="roleGroupEnumId" value="RgpProject"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="roleNote"><default-field title=""><display also-hidden="false" text="Must be in Assignee or Team roles to assign to a task. Parties may be assigned in multiple roles."/></default-field></field><field name="fromDate" from="ec.user.nowTimestamp"><default-field><date-time/></default-field></field><field name="thruDate"><default-field><date-time/></default-field></field><field name="expectationEnumId"><default-field title="Expectation"><drop-down allow-empty="true"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="Enumeration"><econdition field-name="enumTypeId" value="WorkEffortPartyExpectation"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="emplPositionClassId"><default-field title="Position Class"><drop-down allow-empty="true"><entity-options key="${emplPositionClassId}" text="${title}"><entity-find entity-name="EmplPositionClass"/></entity-options></drop-down></default-field></field><field name="statusId"><default-field title="Status"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="WorkEffortParty"/></widget-template-include></default-field></field><field name="submitButton"><default-field title="Add Assignment"><submit/></default-field></field></form-single></container-dialog><form-list name="UpdateUserAssignForm" list="wepapList" transition="updateUserAssign"><entity-find entity-name="mantle.work.effort.WorkEffortAndPartyDetail" list="wepapList"><search-form-inputs default-order-by="firstName,lastName,organizationName"/><econdition field-name="workEffortId" from="rootWorkEffortId"/></entity-find><row-actions><entity-find-one entity-name="moqui.basic.StatusItem" value-field="currentStatus"/><entity-find entity-name="moqui.security.UserAccount" list="uaList"><econdition field-name="partyId"/></entity-find><set field="usernames" from="uaList*.username.join(', ')"/></row-actions><hidden-parameters><parameter name="rootWorkEffortId"/><parameter name="workEffortId"/></hidden-parameters><field name="partyId"><default-field><hidden/></default-field></field><field name="pseudoId"><header-field title="ID" show-order-by="case-insensitive"/><default-field><link url="editParty" text="${pseudoId}" link-type="anchor"/></default-field></field><field name="usernames"><default-field><link url="editParty" text="${usernames}" link-type="anchor" condition="usernames"/></default-field></field><field name="firstName"><header-field title="First##Name" show-order-by="case-insensitive"/><default-field><link url="editParty" text="${firstName}" link-type="anchor" condition="firstName"/></default-field></field><field name="lastName"><header-field title="Last##Name" show-order-by="case-insensitive"/><default-field><display also-hidden="false"/></default-field></field><field name="organizationName"><header-field title="Org" show-order-by="case-insensitive"/><default-field><link url="editParty" text="${organizationName}" link-type="anchor" condition="organizationName"/></default-field></field><field name="roleTypeId"><header-field title="Role" show-order-by="true"/><default-field><display-entity entity-name="RoleType" text="${description}"/></default-field></field><field name="fromDate"><header-field show-order-by="true"/><default-field><display/></default-field></field><field name="thruDate"><header-field show-order-by="true"/><default-field><date-time/></default-field></field><field name="expectationEnumId"><header-field title="Expectation" show-order-by="true"/><default-field><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="WorkEffortPartyExpectation"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="emplPositionClassId"><header-field title="Position Class" show-order-by="true"/><default-field><drop-down allow-empty="true"><entity-options key="${emplPositionClassId}" text="${title}"><entity-find entity-name="EmplPositionClass"/></entity-options></drop-down></default-field></field><field name="statusId"><header-field title="Status" show-order-by="true"/><default-field><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusTransitionDropDown"><set field="currentDescription" from="currentStatus?.description"/></widget-template-include></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><form-list-column><field-ref name="pseudoId"/><field-ref name="usernames"/><field-ref name="roleTypeId"/></form-list-column><form-list-column><field-ref name="firstName"/><field-ref name="lastName"/><field-ref name="organizationName"/></form-list-column><form-list-column><field-ref name="fromDate"/><field-ref name="thruDate"/></form-list-column><form-list-column><field-ref name="expectationEnumId"/><field-ref name="emplPositionClassId"/></form-list-column><form-list-column><field-ref name="statusId"/><field-ref name="submitButton"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Project/ProjectTimeEntries.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Time Entries" default-menu-index="3"><parameter name="workEffortId"/><parameter name="rootWorkEffortId" required="true" from="rootWorkEffortId ?: workEffortId"/><parameter name="showInvoiced"/><transition name="editInvoice"><default-response url="//${appRoot}/Accounting/Invoice/EditInvoice"/></transition><transition name="recordTimeEntry"><service-call name="mantle.work.TimeServices.store#TimeEntry" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="resetAndGetRates"><service-call name="mantle.work.TimeServices.resetAndGet#ProjectTimeEntryRates" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createProjectInvoiceItems"><service-call name="mantle.account.InvoiceServices.create#ProjectInvoiceItems" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getProjectList" location="component://SimpleScreens/template/work/WorkTransitions.xml"/><transition-include name="getOpenClientInvoicesByProject" location="component://SimpleScreens/template/work/WorkTransitions.xml"/><transition-include name="getOpenVendorInvoicesByFromParty" location="component://SimpleScreens/template/work/WorkTransitions.xml"/><transition-include name="getProjectParties" location="component://SimpleScreens/template/work/WorkTransitions.xml"/><actions><set field="workEffortId" from="rootWorkEffortId"/><set field="showInvoicedBool" from="showInvoiced == 'true'"/></actions><widgets><link url="." text="Show Invoiced" parameter-map="[showInvoiced:'true']" condition="!showInvoicedBool"/><link url="." text="Hide Invoiced" parameter-map="[showInvoiced:null]" condition="showInvoicedBool"/><link url="resetAndGetRates" text="Update Rates" parameter-map="[rootWorkEffortId:rootWorkEffortId]"/><section-include name="ProjectInvoiceSection" location="component://SimpleScreens/screen/SimpleScreens/Accounting/Invoice/FindInvoice.xml"/><form-list name="TimeEntryListForm" list="teaweList" transition="recordTimeEntry" header-dialog="true" saved-finds="true" show-all-button="true"><entity-find entity-name="mantle.work.time.TimeEntryAndWorkEffort" list="teaweList"><search-form-inputs default-order-by="-thruDate" skip-fields="workEffortId"/><econdition field-name="rootWorkEffortId"/><econdition field-name="invoiceId" from="null" ignore="showInvoicedBool"/><select-field field-name="workEffortName"/></entity-find><row-actions><set field="entryEditable" from="!invoiceId && !vendorInvoiceId"/></row-actions><field name="rootWorkEffortId"><header-field><hidden/></header-field><default-field><hidden/></default-field></field><field name="timeEntryId"><default-field><hidden/></default-field></field><field name="fromDate"><header-field show-order-by="true"><date-period allow-empty="true"/></header-field><conditional-field condition="entryEditable"><date-time/></conditional-field><default-field><display/></default-field></field><field name="thruDate"><header-field show-order-by="true"><date-period allow-empty="true"/></header-field><conditional-field condition="entryEditable"><date-time/></conditional-field><default-field><display/></default-field></field><field name="hours" align="right"><header-field show-order-by="true"/><conditional-field condition="entryEditable"><text-line size="6" format="0.00"/></conditional-field><default-field><display/></default-field></field><field name="partyId"><default-field title="Worker"><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameTemplate"/></default-field></field><field name="clientPartyId"><default-field title="Client"><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameTemplate"/></default-field></field><field name="workEffortId"><header-field title="Task" show-order-by="true"/><default-field><label text="WorkEffortNameTemplate"/></default-field></field><field name="rateTypeEnumId"><header-field title="Rate Type" show-order-by="true"><drop-down allow-empty="true"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="RateType"/><econdition field-name="enumId" operator="not-in" value="RatpPiece,RatpPieceOvertime,RatpPieceDoubleTime"/><order-by field-name="description"/></entity-find></entity-options></drop-down></header-field><conditional-field condition="entryEditable"><drop-down allow-empty="true"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="RateType"/><econdition field-name="enumId" operator="not-in" value="RatpPiece,RatpPieceOvertime,RatpPieceDoubleTime"/><order-by field-name="description"/></entity-find></entity-options></drop-down></conditional-field><default-field><display-entity entity-name="moqui.basic.Enumeration" key-field-name="enumId"/></default-field></field><field name="rateAmountId"><default-field title="Client Hour Rate"><display-entity text="C: ${ec.l10n.format(rateAmount, '0.00')} (${rateAmountId})" entity-name="mantle.humanres.rate.RateAmount" use-cache="true"/></default-field></field><field name="vendorRateAmountId"><default-field title="Vendor Hour Rate"><display-entity text="V: ${ec.l10n.format(rateAmount, '0.00')} (${rateAmountId})" entity-name="mantle.humanres.rate.RateAmount" use-cache="true"/></default-field></field><field name="comments"><header-field show-order-by="true"/><conditional-field condition="entryEditable"><text-area cols="40" rows="3"/></conditional-field><default-field><display/></default-field></field><field name="invoiceId"><header-field show-order-by="true"/><default-field title="Client Invoice"><link url="editInvoice" text="C: ${invoiceId}" link-type="anchor" condition="invoiceId" parameter-map="[invoiceId:invoiceId]"/></default-field></field><field name="vendorInvoiceId"><header-field show-order-by="true"/><default-field title="Vendor Invoice"><link url="editInvoice" text="V: ${vendorInvoiceId}" link-type="anchor" condition="vendorInvoiceId" parameter-map="[invoiceId:vendorInvoiceId]"/></default-field></field><field name="findButton" align="right"><header-field title="Find"><submit/></header-field><conditional-field condition="entryEditable" title="Update"><submit/></conditional-field><default-field><hidden/></default-field></field><form-list-column><field-ref name="fromDate"/><field-ref name="thruDate"/></form-list-column><form-list-column><field-ref name="hours"/></form-list-column><form-list-column><field-ref name="partyId"/><field-ref name="clientPartyId"/></form-list-column><form-list-column><field-ref name="workEffortId"/></form-list-column><form-list-column><field-ref name="rateTypeEnumId"/><field-ref name="rateAmountId"/><field-ref name="vendorRateAmountId"/></form-list-column><form-list-column><field-ref name="comments"/></form-list-column><form-list-column><field-ref name="invoiceId"/><field-ref name="vendorInvoiceId"/></form-list-column><form-list-column><field-ref name="findButton"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Project/EditWikiPages.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Wiki Pages" default-menu-index="5"><parameter name="rootWorkEffortId" required="true"/><transition name="addWpwe"><service-call name="create#mantle.work.effort.WikiPageWorkEffort" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteWpwe"><service-call name="delete#mantle.work.effort.WikiPageWorkEffort" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="getSpacePages"><actions><service-call name="org.moqui.impl.WikiServices.get#UserSpaceWikiPageSimpleList" in-map="context" out-map="context"/><script><![CDATA[ec.web.sendJsonResponse(resultList)]]></script></actions><default-response type="none"/></transition><actions><set field="workEffortId" from="rootWorkEffortId"/><set field="projectWorkEffortId" from="rootWorkEffortId"/><entity-find entity-name="mantle.work.effort.WikiPageAndWorkEffort" list="wpaweList"><econdition field-name="workEffortId"/></entity-find><service-call name="org.moqui.impl.WikiServices.get#UserWikiSpaces" in-map="[userId:ec.user.userId]" out-map="context"/></actions><widgets><container-dialog id="AddWpweDialog" button-text="Add Wiki Page"><form-single name="AddWpweForm" transition="addWpwe"><field name="userId" from="ec.user.userId"><default-field><hidden/></default-field></field><field name="workEffortId"><default-field><hidden/></default-field></field><field name="rootWorkEffortId"><default-field><hidden/></default-field></field><field name="wikiSpaceId"><default-field title="Space"><drop-down><list-options list="wikiSpaceAndUserList" key="${wikiSpaceId}" text="${wikiSpaceId}: ${description}"/></drop-down></default-field></field><field name="wikiPageId"><default-field title="Page"><drop-down combo-box="true"><dynamic-options transition="getSpacePages" value-field="wikiPageId" label-field="pageLabel"><depends-on field="userId"/><depends-on field="wikiSpaceId"/></dynamic-options></drop-down></default-field></field><field name="submitButton"><default-field title="Add Page"><submit/></default-field></field></form-single></container-dialog><form-list name="DeleteWpweForm" list="wpaweList" transition="deleteWpwe"><field name="workEffortId"><default-field><hidden/></default-field></field><field name="rootWorkEffortId" from="projectWorkEffortId"><default-field><hidden/></default-field></field><field name="wikiPageId"><default-field><hidden/></default-field></field><field name="wikiSpaceId"><default-field title="Space"><display text=""/><link text="${wikiSpaceId}" url="//${appRoot}/Wiki/wiki/${wikiSpaceId}"/></default-field></field><field name="pagePath"><default-field title="Page"><display text=""/><link text="${pagePath}" url="//${appRoot}/Wiki/wiki/${wikiSpaceId}/${pagePath?:''}"/></default-field></field><field name="submitButton"><default-field title="Delete"><submit/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Project/ProjectProgressReport.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Progress" default-menu-index="9"><parameter name="workEffortId"/><parameter name="rootWorkEffortId" required="true" from="rootWorkEffortId ?: workEffortId"/><transition name="milestoneSummary"><default-response url="../MilestoneSummary"/></transition><transition name="taskSummary"><default-response url="//${taskRoot?:appRoot}/Task/TaskSummary"/></transition><pre-actions><if condition="rootWorkEffortId"><set field="workEffortId" from="rootWorkEffortId"/></if><set field="rootWorkEffortId" from="workEffortId"/></pre-actions><actions><service-call name="mantle.work.ProjectServices.get#WorkEffortChildStats" in-map="[workEffortId:rootWorkEffortId]" out-map="context"/><service-call name="mantle.work.ProjectServices.get#ProjectMilestoneSummary" in-map="[workEffortId:rootWorkEffortId]" out-map="context"/></actions><widgets><label text="Tasks by Top Level" type="h4"/><form-list name="ChildStatsListDays" list="childStatsList"><field name="priority"><default-field><display/></default-field></field><field name="workEffortId"><default-field title="Task"><link url="taskSummary" text="WorkEffortNameTemplate" link-type="anchor"/></default-field></field><field name="actualWorkTime" align="right"><default-field title="Actual (h)"><display format="#,##0.00"/></default-field></field><field name="actualWorkDays" align="right"><default-field title="Actual (d)"><display format="#,##0.00"/></default-field></field><field name="remainingWorkTime" align="right"><default-field title="Remaining (h)"><display format="#,##0.00"/></default-field></field><field name="remainingWorkDays" align="right"><default-field title="Remaining (d)"><display format="#,##0.00"/></default-field></field><field name="estimatedWorkTime" align="right"><default-field title="Estimated (h)"><display format="#,##0.00"/></default-field></field><field name="estimatedWorkDays" align="right"><default-field title="Estimated (d)"><display format="#,##0.00"/></default-field></field><field name="totalTimeAllowed" align="right"><default-field title="Budget (h)"><display format="#,##0.00"/></default-field></field><field name="totalTimeAllowedDays" align="right"><default-field title="Budget (d)"><display format="#,##0.00"/></default-field></field><field name="workActualPercent" align="right"><default-field title="Act/Est %"><display format="00.00"/></default-field></field><field name="workActRemPercent" align="right"><default-field title="Act+Rem/Est %"><display format="00.00"/></default-field></field><field name="budgetActualPercent" align="right"><default-field title="Act/Bgt %"><display format="00.00"/></default-field></field><field name="budgetActRemPercent" align="right"><default-field title="Act+Rem/Bgt %"><display format="00.00"/></default-field></field><form-list-column><field-ref name="priority"/></form-list-column><form-list-column><field-ref name="workEffortId"/></form-list-column><form-list-column><field-ref name="actualWorkTime"/><field-ref name="actualWorkDays"/></form-list-column><form-list-column><field-ref name="remainingWorkTime"/><field-ref name="remainingWorkDays"/></form-list-column><form-list-column><field-ref name="estimatedWorkTime"/><field-ref name="estimatedWorkDays"/></form-list-column><form-list-column><field-ref name="workActualPercent"/><field-ref name="workActRemPercent"/></form-list-column><form-list-column><field-ref name="totalTimeAllowed"/><field-ref name="totalTimeAllowedDays"/></form-list-column><form-list-column><field-ref name="budgetActualPercent"/><field-ref name="budgetActRemPercent"/></form-list-column></form-list><label text="Milestones" type="h4"/><form-list name="MilestoneStatsList" list="milestoneStatsList"><field name="estimatedStartDate"><default-field><display/></default-field></field><field name="workEffortId"><default-field title="Milestone"><link url="milestoneSummary" text="WorkEffortNameTemplate" link-type="anchor"/></default-field></field><field name="actualWorkTime" align="right"><default-field title="Actual (h)"><display format="#,##0.00"/></default-field></field><field name="remainingWorkTime" align="right"><default-field title="Remaining (h)"><display format="#,##0.00"/></default-field></field><field name="estimatedWorkTime" align="right"><default-field title="Estimated (h)"><display format="#,##0.00"/></default-field></field><field name="actualWorkDays" align="right"><default-field title="Actual (d)"><display format="#,##0.00"/></default-field></field><field name="remainingWorkDays" align="right"><default-field title="Remaining (d)"><display format="#,##0.00"/></default-field></field><field name="estimatedWorkDays" align="right"><default-field title="Estimated (d)"><display format="#,##0.00"/></default-field></field><field name="workActualPercent" align="right"><default-field title="Act/Est %"><display format="00.00"/></default-field></field><field name="workActRemPercent" align="right"><default-field title="Act+Rem/Est %"><display format="00.00"/></default-field></field><form-list-column><field-ref name="estimatedStartDate"/></form-list-column><form-list-column><field-ref name="workEffortId"/></form-list-column><form-list-column><field-ref name="actualWorkTime"/><field-ref name="actualWorkDays"/></form-list-column><form-list-column><field-ref name="remainingWorkTime"/><field-ref name="remainingWorkDays"/></form-list-column><form-list-column><field-ref name="estimatedWorkTime"/><field-ref name="estimatedWorkDays"/></form-list-column><form-list-column><field-ref name="workActualPercent"/><field-ref name="workActRemPercent"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Project.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Projects" default-menu-index="12" menu-image="/ssstatic/images/project-business120.png"><subscreens default-item="FindProject"/><widgets><subscreens-panel id="task-panel" type="tab"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Request/FindRequest.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="findRequest"><default-response url="."/></transition><transition name="editRequest"><default-response url="../EditRequest"/></transition><transition name="createRequest"><service-call name="mantle.request.RequestServices.create#Request" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="projectSummary"><default-response url="//${appRoot}/Project/ProjectSummary"/></transition><transition name="editFacility"><default-response url="//${appRoot}/Facility/EditFacility"/></transition><transition name="editStore"><default-response url="//apps/${appRoot}/ProductStore/EditStore"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><actions><set field="partyId" from="partyId ?: findPartyId"/></actions><widgets><container-dialog id="NewRequestContainer" button-text="New Request"><form-single name="NewRequestForm" transition="createRequest"><field name="customerPartyId"><default-field title="Customer"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2" parameter-map="[roleTypeId:'Customer']"/></drop-down></default-field></field><field name="productStoreId"><default-field title="Store"><drop-down allow-empty="true"><entity-options key="${productStoreId}" text="${productStoreId}: ${storeName}"><entity-find entity-name="mantle.product.store.ProductStore"><order-by field-name="storeName"/></entity-find></entity-options></drop-down></default-field></field><field name="rootWorkEffortId"><default-field title="Project"><drop-down allow-empty="true"><entity-options key="${workEffortId}" text="WorkEffortNameTemplate"><entity-find entity-name="mantle.work.effort.WorkEffortAndParty"><econditions combine="or"><econdition field-name="visibilityEnumId" operator="in" value="WevGeneral,WevAllUsers"/><econditions><date-filter/><econdition field-name="partyId" from="ec.user.userAccount.partyId"/></econditions></econditions><econdition field-name="workEffortTypeEnumId" value="WetProject"/><order-by field-name="workEffortId"/></entity-find></entity-options></drop-down></default-field></field><field name="facilityId"><default-field title="Facility"><drop-down allow-empty="true"><entity-options key="${facilityId}" text="FacilityNameTemplate"><entity-find entity-name="mantle.facility.Facility" list="facilityList"><econdition field-name="facilityTypeEnumId" value="FcTpWarehouse"/><order-by field-name="facilityName"/></entity-find></entity-options></drop-down></default-field></field><field name="assignToPartyId"><default-field title="Assign To" tooltip="If empty will be assigned to current user"><drop-down><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="priority"><default-field><drop-down no-current-selected-key="5"><option key="1"/><option key="2"/><option key="3"/><option key="4"/><option key="5"/><option key="6"/><option key="7"/><option key="8"/><option key="9"/></drop-down></default-field></field><field name="responseRequiredDate"><default-field title="Due Date"><date-time type="date-time"/></default-field></field><field name="requestTypeEnumId"><default-field title="Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="RequestType"/><set field="noCurrentSelectedKey" value="RqtSupport"/></widget-template-include></default-field></field><field name="statusId"><default-field title="Initial Status"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="Request"/><set field="noCurrentSelectedKey" value="ReqSubmitted"/></widget-template-include></default-field></field><field name="requestName"><default-field title="Request Name"><text-line size="60"/></default-field></field><field name="description"><default-field title="Description"><text-area rows="10"/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="ListRequests" list="requestList" skip-form="true" header-dialog="true" select-columns="true" saved-finds="true" show-page-size="true"><entity-find entity-name="mantle.request.RequestAndParty" list="requestList" distinct="true"><search-form-inputs default-order-by="priority,requestDate"><default-parameters statusId="ReqDraft,ReqSubmitted,ReqReviewed,ReqInProgress" statusId_op="in"/></search-form-inputs><date-filter ignore="!partyId"/></entity-find><row-actions><entity-find entity-name="mantle.request.RequestParty" list="partyList"><date-filter/><econdition field-name="requestId"/></entity-find><set field="customerRp" from="partyList.find({ it.roleTypeId == 'Customer' })"/><set field="assigneeRp" from="partyList.find({ it.roleTypeId == 'Assignee' })"/></row-actions><field name="findPartyId"><header-field title="Party"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></header-field></field><field name="roleTypeId"><header-field title="Has Role"><drop-down allow-empty="true"><entity-options key="${roleTypeId}" text="${description}"><entity-find entity-name="mantle.party.RoleGroupMemberAndType" cache="true"><econdition field-name="roleGroupEnumId" value="RgpRequest"/><order-by field-name="description"/></entity-find></entity-options></drop-down></header-field></field><field name="priority"><header-field show-order-by="true" title="Pri"><drop-down allow-empty="true"><option key="1"/><option key="2"/><option key="3"/><option key="4"/><option key="5"/><option key="6"/><option key="7"/><option key="8"/><option key="9"/></drop-down></header-field><default-field><display/></default-field></field><field name="requestId"><header-field title="ID"><text-find size="10" hide-options="true"/></header-field><default-field><link url="editRequest" text="${requestId}" link-type="anchor"/></default-field></field><field name="requestName"><header-field title="Name" show-order-by="true"><text-find size="30"/></header-field><default-field><link url="editRequest" text="${requestName}" link-type="anchor"/></default-field></field><field name="productStoreId"><header-field title="Store"><drop-down allow-empty="true"><entity-options key="${productStoreId}" text="${productStoreId}: ${storeName}"><entity-find entity-name="mantle.product.store.ProductStore"><order-by field-name="storeName"/></entity-find></entity-options></drop-down></header-field><default-field><link url="editStore" entity-name="mantle.product.store.ProductStore" text="${storeName}" link-type="anchor"/></default-field></field><field name="rootWorkEffortId"><header-field title="Project"><drop-down allow-empty="true"><entity-options key="${workEffortId}" text="WorkEffortNameTemplate"><entity-find entity-name="mantle.work.effort.WorkEffortAndParty"><econditions combine="or"><econdition field-name="visibilityEnumId" operator="in" value="WevGeneral,WevAllUsers"/><econditions><date-filter/><econdition field-name="partyId" from="ec.user.userAccount.partyId"/></econditions></econditions><econdition field-name="workEffortTypeEnumId" value="WetProject"/><order-by field-name="workEffortId"/></entity-find></entity-options></drop-down></header-field><default-field><link url="projectSummary" entity-name="mantle.work.effort.WorkEffort" text="WorkEffortNameTemplate" link-type="anchor"/></default-field></field><field name="facilityId"><header-field title="Facility"><drop-down allow-empty="true"><entity-options key="${facilityId}" text="FacilityNameTemplate"><entity-find entity-name="mantle.facility.Facility" list="facilityList"><econdition field-name="facilityTypeEnumId" value="FcTpWarehouse"/><order-by field-name="facilityName"/></entity-find></entity-options></drop-down></header-field><default-field><link url="editFacility" entity-name="mantle.facility.Facility" text="FacilityNameTemplate" link-type="anchor"/></default-field></field><field name="requestTypeEnumId"><header-field title="Type" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="RequestType"/><set field="allowMultiple" value="true"/><set field="showNot" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="statusId"><header-field title="Status" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="Request"/><set field="allowEmpty" value="true"/><set field="allowMultiple" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="requestResolutionEnumId"><header-field title="Resolution" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="RequestResolution"/><set field="allowEmpty" value="true"/><set field="allowMultiple" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="requestDate"><header-field title="Request Date" show-order-by="true"><date-period allow-empty="true"/></header-field><default-field><display/></default-field></field><field name="responseRequiredDate"><header-field title="Due Date" show-order-by="true"><date-period allow-empty="true"/></header-field><default-field><display/></default-field></field><field name="customerPartyId" from="customerRp?.partyId"><default-field title="Customer"><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameTemplate"/></default-field></field><field name="assignToPartyId" from="assigneeRp?.partyId"><default-field title="Assigned To"><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameTemplate"/></default-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field></field><form-list-column><field-ref name="priority"/></form-list-column><form-list-column><field-ref name="requestDate"/><field-ref name="responseRequiredDate"/></form-list-column><form-list-column><field-ref name="requestName"/><field-ref name="requestId"/></form-list-column><form-list-column><field-ref name="productStoreId"/><field-ref name="rootWorkEffortId"/><field-ref name="facilityId"/></form-list-column><form-list-column><field-ref name="requestTypeEnumId"/></form-list-column><form-list-column><field-ref name="statusId"/><field-ref name="requestResolutionEnumId"/></form-list-column><form-list-column><field-ref name="customerPartyId"/><field-ref name="assignToPartyId"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Request/EditRequest/RequestCommentNested.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><parameter name="requestId"/><parameter name="currentCe"/><actions><filter-map-list list="childCeList" to-list="filteredCeList"><field-map field-name="parentCommEventId" from="currentCe.communicationEventId"/></filter-map-list></actions><widgets><container style="task-comment-child"><section-iterate name="CommentChildList" list="filteredCeList" entry="childCe"><actions><set field="uniqueExtension" from="uniqueExtension + '_' + childCe_index"/><entity-find-one entity-name="mantle.party.Person" value-field="fromPerson" cache="true"><field-map field-name="partyId" from="childCe.fromPartyId"/></entity-find-one><filter-map-list list="childCeList" to-list="childFilteredCeList"><field-map field-name="parentCommEventId" from="childCe.communicationEventId"/></filter-map-list></actions><widgets><label text="${childCe.subject}" type="strong"/><label text="from ${fromPerson ? fromPerson.firstName + ' ' + fromPerson?.lastName : 'Unknown'}"/><label text="at ${ec.l10n.format(childCe.entryDate, 'yyyy-MM-dd HH:mm')}"/><dynamic-dialog id="ReplyCommentContainer${uniqueExtension}" button-text="Reply" transition="RequestCommentReply"><parameter name="parentCommEventId" from="childCe.communicationEventId"/></dynamic-dialog><dynamic-dialog id="EditCommentContainer${uniqueExtension}" button-text="Edit" transition="RequestCommentUpdate" condition="childCe.fromPartyId == ec.user.userAccount.partyId || ec.user.isInGroup('ADMIN') || ec.user.isInGroup('HIVE_MIND_ADMIN')"><parameter name="communicationEventId" from="childCe.communicationEventId"/></dynamic-dialog><label text="${childCe.body}" type="pre" encode="false"/><section name="ChildNestedComments" condition="childFilteredCeList"><actions><set field="currentCe" from="childCe"/></actions><widgets><include-screen location="component://SimpleScreens/screen/SimpleScreens/Request/EditRequest/RequestCommentNested.xml"/></widgets></section></widgets></section-iterate></container></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Request/EditRequest/RequestCommentReply.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="requestId"/><parameter name="parentCommEventId"/><transition name="replyComment"><service-call name="mantle.party.CommunicationServices.reply#CommunicationEvent" in-map="true" out-map="context" multi="parameter"/><default-response url=".."/></transition><actions><entity-find-one entity-name="mantle.party.communication.CommunicationEvent" value-field="communicationEvent"><field-map field-name="communicationEventId" from="parentCommEventId"/></entity-find-one></actions><widgets><form-single name="ReplyCommentForm" transition="replyComment"><field name="requestId"><default-field><hidden/></default-field></field><field name="parentCommEventId"><default-field><hidden/></default-field></field><field name="subject"><default-field><text-line default-value="Re: ${communicationEvent.subject}"/></default-field></field><field name="body"><default-field title="Comment"><text-area rows="10"/></default-field></field><field name="submitButton"><default-field title="Reply"><submit/></default-field></field></form-single></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Request/EditRequest/RequestCommentUpdate.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="requestId"/><parameter name="communicationEventId"/><transition name="updateComment"><service-call name="mantle.request.RequestServices.update#RequestComment" in-map="true" out-map="context" multi="parameter"/><default-response url=".."/></transition><actions><entity-find-one entity-name="mantle.party.communication.CommunicationEvent" value-field="communicationEvent"><field-map field-name="communicationEventId"/></entity-find-one></actions><widgets><form-single name="ReplyCommentForm" transition="updateComment"><field name="requestId"><default-field><hidden/></default-field></field><field name="communicationEventId"><default-field><hidden/></default-field></field><field name="subject"><default-field><text-line default-value="${communicationEvent.subject}"/></default-field></field><field name="body"><default-field title="Comment"><text-area rows="10" default-value="${communicationEvent.body}"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Request/EditRequest.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Request" default-menu-index="1"><parameter name="requestId" required="true"/><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition name="projectSummary"><default-response url="../../Project/ProjectSummary"/></transition><transition name="taskSummary"><default-response url="//${taskRoot?:appRoot}/Task/TaskSummary"/></transition><transition name="updateRequest"><service-call name="mantle.request.RequestServices.update#Request" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateStatus"><service-call name="mantle.request.RequestServices.update#Request" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="addParty"><service-call name="create#mantle.request.RequestParty" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateParty"><service-call name="update#mantle.request.RequestParty" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition name="createNote"><service-call name="create#mantle.request.RequestNote" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateNote"><service-call name="update#mantle.request.RequestNote" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="addComment"><service-call name="mantle.request.RequestServices.add#RequestComment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteComment"><service-call name="mantle.request.RequestServices.delete#RequestComment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createContent"><service-call name="mantle.request.RequestServices.create#RequestContent" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateContent"><service-call name="mantle.request.RequestServices.update#RequestContent" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="downloadContent" read-only="true"><parameter name="requestContentId"/><actions><entity-find-one entity-name="mantle.request.RequestContent" value-field="requestContent"/><script><![CDATA[ec.web.sendResourceResponse(requestContent?.contentLocation)]]></script></actions><default-response type="none"/></transition><actions><entity-find-one entity-name="mantle.request.Request" value-field="request"/><set field="statusId" from="request.statusId"/><set field="changedEntityName" value="mantle.request.Request"/><set field="pkPrimaryValue" from="requestId"/><entity-find entity-name="mantle.request.RequestParty" list="customerRpList"><date-filter/><econdition field-name="requestId"/><econdition field-name="roleTypeId" value="Customer"/></entity-find><set field="customerRp" from="customerRpList?.getAt(0)"/><entity-find entity-name="mantle.request.RequestParty" list="assignToRpList"><date-filter/><econdition field-name="requestId"/><econdition field-name="roleTypeId" value="Assignee"/></entity-find><set field="assignToRp" from="assignToRpList?.getAt(0)"/></actions><widgets><container-row><row-col md="7"><label text="Request #${requestId}" type="h4"/><form-single name="EditRequest" transition="updateRequest" map="request"><field name="requestId"><default-field title="Request ID"><display/></default-field></field><field name="requestDate"><default-field><display/></default-field></field><field name="filedByPartyId"><default-field title="Filed By"><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameTemplate"/></default-field></field><field name="displayCustomerId" from="customerRp?.partyId"><default-field title="Customer"><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameTemplate"/></default-field></field><field name="productStoreId"><default-field title="Store"><drop-down allow-empty="true"><entity-options key="${productStoreId}" text="${storeName}"><entity-find entity-name="mantle.product.store.ProductStore"><order-by field-name="storeName"/></entity-find></entity-options></drop-down></default-field></field><field name="rootWorkEffortId"><default-field title="Project"><drop-down allow-empty="true"><entity-options key="${workEffortId}" text="WorkEffortNameTemplate"><entity-find entity-name="mantle.work.effort.WorkEffortAndParty"><econditions combine="or"><econdition field-name="visibilityEnumId" operator="in" value="WevGeneral,WevAllUsers"/><econditions><date-filter/><econdition field-name="partyId" from="ec.user.userAccount.partyId"/></econditions></econditions><econdition field-name="workEffortTypeEnumId" value="WetProject"/><order-by field-name="workEffortId"/></entity-find></entity-options></drop-down></default-field></field><field name="facilityId"><default-field title="Facility"><drop-down allow-empty="true"><entity-options key="${facilityId}" text="FacilityNameTemplate"><entity-find entity-name="mantle.facility.Facility" list="facilityList"><econdition field-name="facilityTypeEnumId" value="FcTpWarehouse"/><order-by field-name="facilityName"/></entity-find></entity-options></drop-down></default-field></field><field name="displayAssigneeId" from="assignToRp?.partyId"><default-field title="Assignee"><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameTemplate"/></default-field></field><field name="assignToPartyId"><default-field title="Set Assignee"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="priority"><default-field><drop-down allow-empty="true"><option key="1"/><option key="2"/><option key="3"/><option key="4"/><option key="5"/><option key="6"/><option key="7"/><option key="8"/><option key="9"/></drop-down></default-field></field><field name="responseRequiredDate"><default-field title="Due Date"><date-time type="date-time"/></default-field></field><field name="requestTypeEnumId"><default-field title="Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="RequestType"/><set field="noCurrentSelectedKey" value="RqtSupport"/></widget-template-include></default-field></field><field name="requestResolutionEnumId"><default-field title="Resolution"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="RequestResolution"/><set field="noCurrentSelectedKey" value="RrUnresolved"/></widget-template-include></default-field></field><field name="requestName"><default-field title="Name"><text-line/></default-field></field><field name="description"><default-field><text-area rows="20"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field-layout><field-row><field-ref name="requestId"/><field-ref name="requestDate"/></field-row><field-row><field-ref name="filedByPartyId"/></field-row><field-row><field-ref name="displayCustomerId"/><field-ref name="displayAssigneeId"/></field-row><field-row><field-ref name="productStoreId"/><field-ref name="assignToPartyId"/></field-row><field-row><field-ref name="rootWorkEffortId"/><field-ref name="facilityId"/></field-row><field-row><field-ref name="priority"/><field-ref name="responseRequiredDate"/></field-row><field-row><field-ref name="requestTypeEnumId"/><field-ref name="requestResolutionEnumId"/></field-row><fields-not-referenced/></field-layout></form-single><section name="CommentsSection"><actions><entity-find entity-name="mantle.request.RequestCommEventDetail" list="commEventDetailList"><econdition field-name="requestId"/><order-by field-name="entryDate"/></entity-find></actions><widgets><container-box><box-header title="Comments"/><box-toolbar><container-dialog id="AddCommentDialog" button-text="Add Comment"><form-single name="AddCommentForm" transition="addComment"><field name="requestId"><default-field><hidden/></default-field></field><field name="subject" from="request.requestName"><default-field><text-line/></default-field></field><field name="body"><default-field title="Comment"><text-area rows="10"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><section-iterate name="CommentList" list="commEventDetailList" entry="commEventDetail"><actions><set field="uniqueExtension" from="commEventDetail_index"/><entity-find-one entity-name="mantle.party.Person" value-field="fromPerson" cache="true"><field-map field-name="partyId" from="commEventDetail.fromPartyId"/></entity-find-one><entity-find entity-name="mantle.party.communication.CommunicationEvent" list="childCeList"><econdition field-name="rootCommEventId" from="commEventDetail.communicationEventId"/><order-by field-name="entryDate"/></entity-find></actions><widgets><container style="task-comment"><label text="${commEventDetail.subject}" type="strong"/><label text="from ${fromPerson ? fromPerson.firstName + ' ' + fromPerson?.lastName : 'Unknown'}"/><label text="at ${ec.l10n.format(commEventDetail.entryDate, 'yyyy-MM-dd HH:mm')}"/><dynamic-dialog id="ReplyCommentContainer${uniqueExtension}" button-text="Reply" transition="RequestCommentReply"><parameter name="parentCommEventId" from="commEventDetail.communicationEventId"/></dynamic-dialog><dynamic-dialog id="EditCommentContainer${uniqueExtension}" button-text="Edit" transition="RequestCommentUpdate" condition="commEventDetail.fromPartyId == ec.user.userAccount.partyId || ec.user.isInGroup('ADMIN') || ec.user.isInGroup('HIVE_MIND_ADMIN')"><parameter name="communicationEventId" from="commEventDetail.communicationEventId"/></dynamic-dialog><link text="Delete" url="deleteComment" parameter-map="[requestId:requestId, communicationEventId:commEventDetail.communicationEventId]" condition="commEventDetail.fromPartyId == ec.user.userAccount.partyId || ec.user.isInGroup('ADMIN') || ec.user.isInGroup('HIVE_MIND_ADMIN')" confirmation="Delete comment ${commEventDetail.subject}?"/><label text="${commEventDetail.body}" type="pre" encode="false"/><section name="ChildNestedComments"><condition><expression><![CDATA[childCeList]]></expression></condition><actions><set field="currentCe" from="commEventDetail"/></actions><widgets><include-screen location="component://SimpleScreens/screen/SimpleScreens/Request/EditRequest/RequestCommentNested.xml"/></widgets></section></container></widgets></section-iterate></box-body></container-box></widgets></section></row-col><row-col md="5"><section-include name="StatusChangeSection" location="component://SimpleScreens/template/basic/StatusWidgets.xml"/><section-include name="StatusHistorySection" location="component://SimpleScreens/template/basic/StatusWidgets.xml"/><container-box><box-header title="Parties"/><box-toolbar><container-dialog id="AddPartyDialog" button-text="Add Party"><form-single name="AddPartyForm" transition="addParty"><field name="requestId"><default-field><hidden/></default-field></field><field name="partyId"><default-field title="Party"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="roleTypeId"><default-field title="Role"><drop-down><entity-options key="${roleTypeId}" text="${description}"><entity-find entity-name="mantle.party.RoleGroupMemberAndType" cache="true"><econdition field-name="roleGroupEnumId" value="RgpRequest"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Add Party"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body-nopad><form-list name="UpdatePartyForm" list="rpapList" transition="updateParty"><entity-find entity-name="mantle.request.RequestParty" list="rpapList"><date-filter/><econdition field-name="requestId"/><order-by field-name="roleTypeId"/></entity-find><field name="requestId"><default-field><hidden/></default-field></field><field name="fromDate"><default-field><hidden/></default-field></field><field name="thruDate" from="ec.user.nowTimestamp"><default-field><hidden/></default-field></field><field name="roleTypeId"><default-field title="Role"><display-entity entity-name="mantle.party.RoleType" text="${description}"/></default-field></field><field name="partyId"><default-field title="Name"><link url="editParty" text="PartyNameTemplate" entity-name="mantle.party.PartyDetail" link-type="anchor"/><display text=""/></default-field></field><field name="submitButton"><default-field title=""><submit icon="fa fa-trash"/></default-field></field></form-list></box-body-nopad></container-box><section name="NotesSection"><actions><entity-find entity-name="mantle.request.RequestNote" list="requestNoteList"><econdition field-name="requestId"/><order-by field-name="-noteDate"/></entity-find></actions><widgets><container-box><box-header title="Notes"/><box-toolbar><container-dialog id="NewNoteDialog" button-text="Add Note"><form-single name="NewNoteForm" transition="createNote"><field name="requestId"><default-field><hidden/></default-field></field><field name="noteText"><default-field title="Note"><text-area cols="60" rows="6"/></default-field></field><field name="submitButton"><default-field title="Add Note"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><section-iterate name="NoteIterateSection" list="requestNoteList" entry="note"><actions><entity-find-one entity-name="mantle.party.PersonWithUserAccount" value-field="paua"><field-map field-name="userId" from="note.userId"/></entity-find-one></actions><widgets><label text="By ${paua?.firstName?:''} ${paua?.lastName?:''} (${paua?.username ?: note.userId}) at ${ec.l10n.format(note.noteDate, 'yyyy-MM-dd HH:mm')}" type="strong"/><section name="UpdateNoteSection" condition="note.userId == ec.user.userId || ec.user.isInGroup('ADMIN') || ec.user.isInGroup('HIVE_MIND_ADMIN')"><widgets><container-dialog id="UpdateNoteContainer" button-text="Edit Note"><form-single name="UpdateNoteForm" transition="updateNote" map="note"><field name="requestId"><default-field><hidden/></default-field></field><field name="noteDate"><default-field><hidden/></default-field></field><field name="noteText"><default-field title="Note"><text-area cols="60" rows="6"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></container-dialog></widgets></section><label text="${note.noteText}" type="p"/></widgets></section-iterate></box-body></container-box></widgets></section><section name="ContentSection"><actions><entity-find entity-name="mantle.request.RequestContent" list="contentList"><econdition field-name="requestId"/><order-by field-name="-contentDate"/></entity-find></actions><widgets><container-box><box-header title="Content"/><box-toolbar><container-dialog id="NewContentDialog" button-text="Add Content"><form-single name="NewContentForm" transition="createContent"><field name="requestId"><default-field><hidden/></default-field></field><field name="contentTypeEnumId"><default-field title="Content Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="RequestContentType"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="contentFile"><default-field><file/></default-field></field><field name="description"><default-field><text-line size="60"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><section-iterate name="ContentIterateSection" list="contentList" entry="content"><actions><entity-find-one entity-name="mantle.party.PersonWithUserAccount" value-field="paua"><field-map field-name="userId" from="content.userId"/></entity-find-one><entity-find-one entity-name="moqui.basic.Enumeration" value-field="contentTypeEnum"><field-map field-name="enumId" from="content.contentTypeEnumId"/></entity-find-one></actions><widgets><container><container><label text="${contentTypeEnum?.description?:'No Type'}" type="strong"/></container><link url="downloadContent" condition="content.contentLocation" parameter-map="[requestContentId:content.requestContentId]" text="Download ${content.contentLocation.substring(content.contentLocation.lastIndexOf('/')+1)}"/><container-dialog id="UpdateContentContainer" button-text="Edit Content"><form-single name="UpdateContentForm" transition="updateContent" map="content"><field name="requestContentId"><default-field><hidden/></default-field></field><field name="requestId"><default-field><hidden/></default-field></field><field name="contentTypeEnumId"><default-field title="Content Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="RequestContentType"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="contentFile"><default-field><file/></default-field></field><field name="description"><default-field><text-line size="60"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></container-dialog><container><label condition="paua" text="By ${ec.resource.expand('UsernameTemplate','',paua+[userId:content.userId])} at ${ec.l10n.format(content.contentDate, 'yyyy-MM-dd HH:mm')}"/></container><label text="${content.description ?: 'No Description'}" type="p"/></container></widgets></section-iterate></box-body></container-box></widgets></section><section name="TasksSection"><actions><entity-find entity-name="mantle.request.RequestWorkEffortDetail" list="requestWeDetailList"><econdition field-name="requestId"/><order-by field-name="priority,workEffortId"/></entity-find></actions><widgets><container-box><box-header title="Tasks"/><box-body-nopad><form-list name="RequestTaskList" list="requestWeDetailList" skip-form="true"><field name="priority"><default-field title="Pri"><display/></default-field></field><field name="workEffortId"><default-field title="Task"><link text="${workEffortId}: ${workEffortName}" url="taskSummary" link-type="anchor"/></default-field></field><field name="rootWorkEffortId"><default-field title="Project"><link url="projectSummary" text="${rootWorkEffortId}" link-type="anchor" condition="rootWorkEffortId"><parameter name="workEffortId" from="rootWorkEffortId"/></link></default-field></field><field name="purposeEnumId"><default-field title="Purpose"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="estimatedCompletionDate"><default-field title="Due"><display format="yyyy-MM-dd"/></default-field></field></form-list></box-body-nopad></container-box></widgets></section></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Request/EditUsers.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Assignments" default-menu-index="2"><parameter name="requestId" required="true"/><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition name="addUser"><service-call name="create#mantle.request.RequestParty" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateUser"><service-call name="update#mantle.request.RequestParty" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><widgets><container-dialog id="AddUserDialog" button-text="Add Party"><form-single name="AddUserForm" transition="addUser"><field name="requestId"><default-field><hidden/></default-field></field><field name="partyId"><default-field title="Party"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="roleTypeId"><default-field title="Role"><drop-down><entity-options key="${roleTypeId}" text="${description}"><entity-find entity-name="mantle.party.RoleGroupMemberAndType" cache="true"><econdition field-name="roleGroupEnumId" value="RgpRequest"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="fromDate" from="ec.user.nowTimestamp"><default-field><date-time/></default-field></field><field name="thruDate"><default-field><date-time/></default-field></field><field name="receiveNotifications"><default-field><drop-down no-current-selected-key="N"><option key="Y"/><option key="N"/></drop-down></default-field></field><field name="submitButton"><default-field title="Add Assignment"><submit/></default-field></field></form-single></container-dialog><form-list name="UpdateUserForm" list="rpapList" transition="updateUser"><entity-find entity-name="mantle.request.RequestAndPartyDetail" list="rpapList"><search-form-inputs default-order-by="firstName,lastName,organizationName"/><econdition field-name="requestId"/></entity-find><row-actions><entity-find entity-name="moqui.security.UserAccount" list="uaList"><econdition field-name="partyId"/></entity-find><set field="usernames" from="uaList*.username.join(', ')"/></row-actions><field name="requestId"><default-field><hidden/></default-field></field><field name="partyId"><default-field><hidden/></default-field></field><field name="pseudoId"><header-field title="ID" show-order-by="case-insensitive"/><default-field><link url="editParty" text="${pseudoId}" link-type="anchor"/></default-field></field><field name="usernames"><default-field><link url="editParty" text="${usernames}" link-type="anchor" condition="usernames"/></default-field></field><field name="firstName"><header-field title="First##Name" show-order-by="case-insensitive"/><default-field><display also-hidden="false"/></default-field></field><field name="lastName"><header-field title="Last##Name" show-order-by="case-insensitive"/><default-field><display also-hidden="false"/></default-field></field><field name="organizationName"><header-field title="Organization" show-order-by="case-insensitive"/><default-field><display also-hidden="false"/></default-field></field><field name="roleTypeId"><header-field title="Role" show-order-by="true"/><default-field><display-entity entity-name="RoleType" text="${description}"/></default-field></field><field name="fromDate"><header-field show-order-by="true"/><default-field><display/></default-field></field><field name="thruDate"><header-field show-order-by="true"/><default-field><date-time/></default-field></field><field name="receiveNotifications"><default-field title="Notifications"><drop-down no-current-selected-key="N"><option key="Y"/><option key="N"/></drop-down></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Request/EditRequestItems.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Items" default-menu-index="2"><parameter name="requestId" required="true"/><transition name="addRequestItem"><service-call name="create#mantle.request.RequestItem" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateRequestItem"><service-call name="update#mantle.request.RequestItem" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteRequestItem"><service-call name="delete#mantle.request.RequestItem" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createPurchaseOrder"><service-call name="mantle.order.OrderServices.create#PurchaseRequestOrder" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><actions><entity-find entity-name="mantle.request.RequestItemOrder" list="requestItemOrderList" distinct="true"><econdition field-name="requestId"/><select-field field-name="orderId"/></entity-find><entity-find entity-name="mantle.request.RequestParty" list="customerRpList"><date-filter/><econdition field-name="requestId"/><econdition field-name="roleTypeId" value="Customer"/></entity-find><set field="customerRp" from="customerRpList?.first"/></actions><widgets><container-dialog id="NewRequestItem" button-text="New Request Item"><form-single name="NewRequestItemForm" transition="addRequestItem"><field name="requestId"><default-field><hidden/></default-field></field><field name="requiredByDate"><default-field title="Required By"><date-time/></default-field></field><field name="productId"><default-field title="Product"><drop-down><dynamic-options transition="getProductList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="quantity"><default-field><text-line size="8" default-value="1"/></default-field></field><field name="maximumAmount"><default-field><text-line size="8"/></default-field></field><field name="supplierPartyId"><default-field title="Supplier"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2" parameter-map="[roleTypeId:'Supplier']"/></drop-down></default-field></field><field name="description"><default-field><text-area/></default-field></field><field name="submit"><default-field><submit text="Add"/></default-field></field></form-single></container-dialog><link url="createPurchaseOrder" text="Create Purchase Order" link-type="hidden-form"><parameter name="customerPartyId" from="customerRp?.partyId"/></link><section-iterate name="OrderSection" list="requestItemOrderList" entry="item"><widgets><link url="//${appRoot}/Order/OrderDetail" text="Order ${item.orderId}"><parameter name="orderId" from="item.orderId"/></link></widgets></section-iterate><form-list name="RequestItemListForm" list="requestItemList" transition="updateRequestItem"><entity-find entity-name="mantle.request.RequestItem" list="requestItemList"><econdition field-name="requestId"/></entity-find><field name="requestId"><default-field><hidden/></default-field></field><field name="requestItemSeqId"><default-field title="Item"><display/></default-field></field><field name="requiredByDate"><default-field title="Required By"><date-time/></default-field></field><field name="productId"><default-field title="Product"><drop-down><dynamic-options transition="getProductList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="quantity"><default-field><text-line size="5"/></default-field></field><field name="maximumAmount"><default-field title="Max Amt"><text-line size="5"/></default-field></field><field name="description"><default-field><text-area cols="40" rows="3"/></default-field></field><field name="supplierPartyId"><default-field title="Supplier"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2" parameter-map="[roleTypeId:'Supplier']"/></drop-down></default-field></field><field name="submit"><default-field><submit text="Update"/><link url="deleteRequestItem" text="Delete" confirmation="Delete item?"/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Request/EditTasks.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Tasks" default-menu-index="3"><parameter name="requestId" required="true"/><transition name="addRwe"><service-call name="create#mantle.request.RequestWorkEffort" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteRwe"><service-call name="delete#mantle.request.RequestWorkEffort" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="projectSummary"><default-response url="../../Project/ProjectSummary"/></transition><transition name="milestoneSummary"><default-response url="../../Project/MilestoneSummary"/></transition><transition name="taskSummary"><default-response url="//${taskRoot?:appRoot}/Task/TaskSummary"/></transition><transition name="createTask"><service-call name="mantle.work.TaskServices.create#Task" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="getProjectMilestones"><actions><service-call name="mantle.work.ProjectServices.get#ProjectMilestones" in-map="context" out-map="context"/><script><![CDATA[ec.web.sendJsonResponse(resultList)]]></script></actions><default-response type="none"/></transition><transition name="getProjectTasks"><actions><service-call name="mantle.work.ProjectServices.get#ProjectTasks" in-map="context" out-map="context"/><script><![CDATA[ec.web.sendJsonResponse(resultList)]]></script></actions><default-response type="none"/></transition><transition name="getProjectParties"><actions><service-call name="mantle.work.ProjectServices.get#ProjectParties" in-map="context" out-map="context"/><script><![CDATA[ec.web.sendJsonResponse(resultList)]]></script></actions><default-response type="none"/></transition><actions><entity-find-one entity-name="mantle.request.Request" value-field="request"/><if condition="request.requestTypeEnumId == 'RqtBugFix'"><set field="purposeEnumId" value="WepFix"/><else-if condition="request.requestTypeEnumId == 'RqtNewFeature'"><set field="purposeEnumId" value="WepNewFeature"/></else-if><else><set field="purposeEnumId" value="WepTask"/></else></if><entity-find entity-name="mantle.request.RequestWorkEffortDetail" list="rwedList"><econdition field-name="requestId"/></entity-find><entity-find entity-name="mantle.work.effort.WorkEffortAndParty" list="myProjectList"><econditions combine="or"><econdition field-name="visibilityEnumId" operator="in" value="WevGeneral,WevAllUsers"/><econditions><date-filter/><econdition field-name="partyId" from="ec.user.userAccount.partyId"/></econditions></econditions><econdition field-name="workEffortTypeEnumId" value="WetProject"/><order-by field-name="workEffortId"/></entity-find></actions><widgets><container-dialog id="AddRweDialog" button-text="Add Task"><form-single name="AddRweForm" transition="addRwe"><field name="requestId"><default-field><hidden/></default-field></field><field name="rootWorkEffortId"><default-field title="Project"><drop-down><list-options list="myProjectList" key="${workEffortId}" text="${workEffortId}: ${workEffortName}"/></drop-down></default-field></field><field name="workEffortId"><default-field title="Task"><drop-down><dynamic-options transition="getProjectTasks" value-field="workEffortId" label-field="taskLabel"><depends-on field="rootWorkEffortId"/></dynamic-options></drop-down></default-field></field><field name="submitButton"><default-field title="Add Task"><submit/></default-field></field></form-single></container-dialog><container-dialog id="NewTaskContainer" button-text="New Task for Request"><form-single name="NewTaskForm" transition="createTask"><field name="requestId"><default-field><hidden/></default-field></field><field name="rootWorkEffortId"><default-field title="Project"><drop-down><list-options list="myProjectList" key="${workEffortId}" text="${workEffortId}: ${workEffortName}"/></drop-down></default-field></field><field name="milestoneWorkEffortId"><default-field title="Milestone"><drop-down allow-empty="true"><dynamic-options transition="getProjectMilestones" value-field="workEffortId" label-field="milestoneLabel"><depends-on field="rootWorkEffortId"/></dynamic-options></drop-down></default-field></field><field name="parentWorkEffortId"><default-field title="Parent Task"><drop-down allow-empty="true"><dynamic-options transition="getProjectTasks" value-field="workEffortId" label-field="taskLabel"><depends-on field="rootWorkEffortId"/></dynamic-options></drop-down></default-field></field><field name="assignToPartyId"><default-field title="Assign To"><drop-down no-current-selected-key="${ec.user.userAccount.partyId}" current="selected" allow-empty="true"><dynamic-options transition="getProjectParties" value-field="partyId" label-field="name"><depends-on field="rootWorkEffortId"/></dynamic-options></drop-down></default-field></field><field name="workEffortName" from="request.requestName"><default-field title="Task Name"><text-line size="40"/></default-field></field><field name="priority" from="request.priority"><default-field><drop-down no-current-selected-key="5"><option key="1"/><option key="2"/><option key="3"/><option key="4"/><option key="5"/><option key="6"/><option key="7"/><option key="8"/><option key="9"/></drop-down></default-field></field><field name="purposeEnumId"><default-field title="Purpose"><drop-down no-current-selected-key="WepTask" current="selected"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="WorkEffortPurpose"/><econdition field-name="parentEnumId" value="WetTask"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="statusId"><default-field title="Status"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="WorkEffort"/></widget-template-include></default-field></field><field name="estimatedCompletionDate" from="request.responseRequiredDate"><default-field title="Due Date"><date-time/></default-field></field><field name="estimatedWorkTime"><default-field title="Estimated Hours"><text-line size="5"/></default-field></field><field name="description" from="request.description"><default-field title="Description"><text-area rows="10" cols="60"/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="UpdateRweForm" list="rwedList" skip-form="true"><field name="priority"><default-field title="Pri"><display/></default-field></field><field name="workEffortId"><default-field title="Task"><link text="${workEffortId}: ${workEffortName}" url="taskSummary" link-type="anchor"/></default-field></field><field name="rootWorkEffortId"><default-field title="Project"><link url="projectSummary" text="${rootWorkEffortId}" link-type="anchor" condition="rootWorkEffortId"><parameter name="workEffortId" from="rootWorkEffortId"/></link></default-field></field><field name="purposeEnumId"><default-field title="Purpose"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="StatusItem"/></default-field></field><field name="estimatedCompletionDate"><default-field title="Due"><display format="yyyy-MM-dd"/></default-field></field><field name="estimatedWorkTime"><default-field title="Est"><display format="0.00"/></default-field></field><field name="actualWorkTime"><default-field title="Act"><display format="0.00"/></default-field></field><field name="links"><default-field title=" "><link url="deleteRwe" text="" icon="fa fa-trash" confirmation="Remove task association from request?"/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Request/EditWikiPages.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Wiki Pages" default-menu-index="4"><parameter name="requestId" required="true"/><transition name="addWpr"><service-call name="create#mantle.request.WikiPageRequest" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteWpr"><service-call name="delete#mantle.request.WikiPageRequest" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="getSpacePages"><actions><service-call name="org.moqui.impl.WikiServices.get#UserSpaceWikiPageSimpleList" in-map="context" out-map="context"/><script><![CDATA[ec.web.sendJsonResponse(resultList)]]></script></actions><default-response type="none"/></transition><actions><entity-find entity-name="mantle.request.WikiPageAndRequest" list="wparList"><econdition field-name="requestId"/></entity-find><service-call name="org.moqui.impl.WikiServices.get#UserWikiSpaces" in-map="[userId:ec.user.userId]" out-map="context"/></actions><widgets><container-dialog id="AddWprDialog" button-text="Add Wiki Page"><form-single name="AddWprForm" transition="addWpr"><field name="userId" from="ec.user.userId"><default-field><hidden/></default-field></field><field name="requestId"><default-field><hidden/></default-field></field><field name="wikiSpaceId"><default-field title="Space"><drop-down><list-options list="wikiSpaceAndUserList" key="${wikiSpaceId}" text="${wikiSpaceId}: ${description}"/></drop-down></default-field></field><field name="wikiPageId"><default-field title="Page"><drop-down combo-box="true"><dynamic-options transition="getSpacePages" value-field="wikiPageId" label-field="pageLabel"><depends-on field="userId"/><depends-on field="wikiSpaceId"/></dynamic-options></drop-down></default-field></field><field name="submitButton"><default-field title="Add Page"><submit/></default-field></field></form-single></container-dialog><form-list name="DeleteWprForm" list="wparList" transition="deleteWpr"><field name="requestId"><default-field><hidden/></default-field></field><field name="wikiPageId"><default-field><hidden/></default-field></field><field name="wikiSpaceId"><default-field title="Space"><display text=""/><link text="${wikiSpaceId}" url="//${appRoot}/Wiki/wiki/${wikiSpaceId}" link-type="anchor"/></default-field></field><field name="pagePath"><default-field title="Page"><display text=""/><link text="${pagePath}" url="//${appRoot}/Wiki/wiki/${wikiSpaceId}/${pagePath?:''}" link-type="anchor"/></default-field></field><field name="submitButton"><default-field title="Delete"><submit/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Request.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Requests" default-menu-index="5" menu-image="/ssstatic/images/Request.png"><subscreens default-item="FindRequest"/><widgets><subscreens-panel id="RequestPanel" type="tab"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Return/FindReturn.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" default-menu-title="Returns"><transition name="editReturn"><default-response url="../EditReturn"/></transition><transition name="createReturn"><service-call name="mantle.order.ReturnServices.create#Return" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditReturn"/></transition><transition name="editFacility"><default-response url="//${appRoot}/Facility/EditFacility"/></transition><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition name="orderDetail"><default-response url="//${appRoot}/Order/OrderDetail"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition-include name="getFacilityList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><transition name="getWhFacilitiesByVendor"><service-call name="mantle.facility.FacilityServices.get#FacilitiesByOwner" in-map="[ownerPartyId:vendorPartyId, facilityTypeEnumId:'FcTpWarehouse']" web-send-json-response="resultList" out-map="context" multi="parameter"/><default-response type="none"/></transition><actions><set field="returnType" from="returnType ?: 'Any'"/><set field="vendorRole" value="Supplier,Vendor,VendorBillFrom"/><set field="customerRole" value="Customer,CustomerBillTo"/><set field="defaultFacilityId" from="ec.user.getPreference('FacilityGeneralDefault')"/></actions><widgets><container-dialog id="CreateReturnDialog" button-text="Create Customer Return"><form-single name="CreateReturn" transition="createReturn"><field name="customerPartyId"><default-field title="Customer"><drop-down><dynamic-options transition="searchPartyList" server-search="true" min-length="2" parameter-map="[roleTypeId:'Customer']"/></drop-down></default-field></field><field name="vendorPartyId"><default-field title="Vendor Org"><drop-down><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="partyId" from="activeOrgId" ignore="!activeOrgId"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName,firstName,lastName"/></entity-find></entity-options></drop-down></default-field></field><field name="facilityId" from="facilityId ?: defaultFacilityId"><default-field title="Vendor Warehouse"><drop-down><dynamic-options transition="getWhFacilitiesByVendor" value-field="facilityId" label-field="label"><depends-on field="vendorPartyId"/></dynamic-options></drop-down></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><container-dialog id="CreateSupplierReturnDialog" button-text="Create Supplier Return"><form-single name="CreateSupplierReturn" transition="createReturn"><field name="vendorPartyId"><default-field title="Supplier"><drop-down><dynamic-options transition="searchPartyList" server-search="true" min-length="2" parameter-map="[roleTypeId:vendorRole]"/></drop-down></default-field></field><field name="customerPartyId"><default-field title="Customer Org"><drop-down><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="partyId" from="activeOrgId" ignore="!activeOrgId"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName,firstName,lastName"/></entity-find></entity-options></drop-down></default-field></field><field name="facilityId" from="facilityId ?: defaultFacilityId"><default-field title="Facility"><drop-down><dynamic-options transition="getFacilityList" server-search="true" min-length="0" parameter-map="[facilityTypeEnumId:'FcTpWarehouse']"/></drop-down></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="ReturnHeaderList" list="returnHeaderList" skip-form="true" header-dialog="true" saved-finds="true"><entity-find entity-name="mantle.order.return.ReturnHeaderDetail" list="returnHeaderList" distinct="true" use-clone="true"><search-form-inputs default-order-by="-entryDate,returnId" skip-fields="orderId"><default-parameters statusId="ReturnCreated,ReturnRequested,ReturnApproved,ReturnShipped,ReturnReceived" statusId_op="in" entryDate_poffset="-3" entryDate_period="30d"/></search-form-inputs><econdition field-name="vendorRoleTypeId" value="OrgInternal" ignore="!'customer'.equalsIgnoreCase(returnType)"/><econdition field-name="customerRoleTypeId" value="OrgInternal" ignore="!'supplier'.equalsIgnoreCase(returnType)"/></entity-find><row-actions><entity-find entity-name="mantle.order.return.ReturnItem" list="returnOrderList" distinct="true"><econdition field-name="returnId"/><econdition field-name="statusId" operator="not-equals" value="ReturnCancelled"/><select-field field-name="orderId"/></entity-find></row-actions><field name="returnType"><header-field><radio no-current-selected-key="Any"><option key="Any"/><option key="Customer"/><option key="Supplier"/></radio></header-field></field><field name="returnId"><header-field show-order-by="case-insensitive"><text-find hide-options="true" size="10"/></header-field><default-field><link url="editReturn" text="${returnId}" link-type="anchor"/></default-field></field><field name="statusId"><header-field title="Status" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="Return"/><set field="allowEmpty" value="true"/><set field="allowMultiple" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="entryDate"><header-field show-order-by="case-insensitive"><date-period/></header-field><default-field><display/></default-field></field><field name="vendorPartyId"><header-field title="Vendor"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="0" parameter-map="[roleTypeId:'Supplier,Vendor,OrgInternal']"/></drop-down></header-field><default-field><link url="editParty" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" link-type="anchor" parameter-map="[partyId:vendorPartyId]"/></default-field></field><field name="customerPartyId"><header-field title="Customer"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2" parameter-map="[roleTypeId:'Customer,OrgInternal']"/></drop-down></header-field><default-field><link url="editParty" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" link-type="anchor" parameter-map="[partyId:customerPartyId]"/></default-field></field><field name="facilityId"><header-field title="Warehouse"><drop-down allow-empty="true"><dynamic-options transition="getFacilityList" server-search="true" min-length="0" parameter-map="[facilityTypeEnumId:'FcTpWarehouse']"/></drop-down></header-field><default-field><link url="editFacility" entity-name="mantle.facility.Facility" text="FacilityNameTemplate" link-type="anchor"/></default-field></field><field name="orderId"><header-field><text-find default-operator="begins" hide-options="true"/></header-field></field><field name="orderDisplayId"><header-field><text-find default-operator="begins" hide-options="true"/></header-field></field><field name="orderIds"><default-field><section-iterate name="OrderListSection" list="returnOrderList" entry="orderInfo"><widgets><container><link url="orderDetail" link-type="anchor" text="${orderInfo.orderId}" parameter-map="[orderId:orderInfo.orderId]"/></container></widgets></section-iterate></default-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Return/EditReturn.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Return" default-menu-index="1"><parameter name="returnId" required="true"/><transition name="updateReturn"><service-call name="update#mantle.order.return.ReturnHeader" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="requestReturn"><service-call name="mantle.order.ReturnServices.request#Return" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="approveReturn"><service-call name="mantle.order.ReturnServices.approve#Return" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="cancelReturn"><service-call name="mantle.order.ReturnServices.cancel#Return" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="editFacility"><default-response url="//${appRoot}/Facility/EditFacility"/></transition><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition name="editFinancialAccount"><default-response url="//${appRoot}/Accounting/FinancialAccount/EditFinancialAccount"/></transition><transition name="orderDetail"><default-response url="//${appRoot}/Order/OrderDetail"/></transition><transition name="shipmentDetail"><default-response url="//${appRoot}/Shipment/ShipmentDetail"/></transition><transition name="editPayment"><default-response url="//${appRoot}/Accounting/Payment/EditPayment"/></transition><transition name="editInvoice"><default-response url="//${appRoot}/Accounting/Invoice/EditInvoice"/></transition><actions><set field="statusChangeTransition" value="updateReturn"/><service-call name="mantle.order.ReturnServices.get#ReturnDisplayInfo" in-map="context" out-map="context"/></actions><widgets><container-row><row-col lg="6"><section-iterate name="SalesOrderLinks" list="salesOrderIdSet" entry="orderId"><widgets><link url="orderDetail" text="Order #${orderId}" link-type="anchor-button"/></widgets></section-iterate><section-iterate name="ReplacementOrderLinks" list="replacementOrderIdSet" entry="orderId"><widgets><link url="orderDetail" text="Replacement Order #${orderId}" link-type="anchor-button"/></widgets></section-iterate><section-iterate name="ReceivingShipmentLinks" list="receivingShipmentIdSet" entry="shipmentId"><widgets><link url="shipmentDetail" text="Return Shipment #${shipmentId}" link-type="anchor-button"/></widgets></section-iterate><section-iterate name="RefundPaymentLinks" list="refundPaymentIdSet" entry="paymentId"><widgets><link url="editPayment" text="Refund Payment #${paymentId}" link-type="anchor-button"/></widgets></section-iterate><section-iterate name="CreditMemoLinks" list="creditMemoIdSet" entry="invoiceId"><widgets><link url="editInvoice" text="Credit Memo Invoice #${invoiceId}" link-type="anchor-button"/></widgets></section-iterate><container-dialog id="AuditLogDialog" button-text="Audit Log" width="960"><form-list name="AuditLogList" list="auditLogList" skip-form="true"><entity-find entity-name="moqui.entity.EntityAuditLog" list="auditLogList"><econdition field-name="changedEntityName" operator="in" from="['mantle.order.return.ReturnHeader', 'mantle.order.return.ReturnItem']"/><econdition field-name="changedFieldName" operator="not-equals" value="statusId"/><econdition field-name="pkPrimaryValue" from="returnId"/><select-field field-name="changedEntityName"/><order-by field-name="-changedDate,pkSecondaryValue"/></entity-find><field name="changedDate"><default-field title="Date"><display/></default-field></field><field name="changedByUserId"><default-field title="User"><display-entity text="UsernameTemplate" entity-name="mantle.party.PersonWithUserAccount" key-field-name="userId"/></default-field></field><field name="pkSecondaryValue"><default-field title="Item"><display/></default-field></field><field name="changedFieldName"><default-field title="Field"><display text="${org.moqui.util.StringUtilities.camelCaseToPretty(changedFieldName)}"/></default-field></field><field name="oldValueText"><default-field title="From"><display text="${ec.entity.formatFieldString(changedEntityName, changedFieldName, oldValueText)}"/></default-field></field><field name="newValueText"><default-field title="To"><display text="${ec.entity.formatFieldString(changedEntityName, changedFieldName, newValueText)}"/></default-field></field></form-list></container-dialog><form-single name="UpdateReturn" transition="updateReturn" map="returnHeader"><field name="returnId"><default-field><display/></default-field></field><field name="entryDate"><default-field><display/></default-field></field><field name="vendorPartyId"><default-field title="Vendor"><link url="editParty" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" link-type="anchor" parameter-map="[partyId:vendorPartyId]"/></default-field></field><field name="customerPartyId"><default-field title="Customer"><link url="editParty" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" link-type="anchor" parameter-map="[partyId:customerPartyId]"/></default-field></field><field name="facilityId"><conditional-field title="Warehouse" condition="returnChangeable"><drop-down><entity-options key="${facilityId}" text="FacilityNameTemplate"><entity-find entity-name="mantle.facility.Facility"><econdition field-name="ownerPartyId" from="orgPartyId"/><order-by field-name="pseudoId"/></entity-find></entity-options></drop-down><link url="editFacility" entity-name="mantle.facility.Facility" text="FacilityNameTemplate" link-type="anchor"/></conditional-field><default-field title="Warehouse"><link url="editFacility" entity-name="mantle.facility.Facility" text="FacilityNameTemplate" link-type="anchor"/></default-field></field><field name="finAccountId"><conditional-field condition="returnChangeable && isVendorOrgInternal" title="Credit Account"><drop-down allow-empty="true"><entity-options text="FinancialAccountNameTemplate"><entity-find entity-name="mantle.account.financial.FinancialAccount"><econdition field-name="ownerPartyId" from="customerPartyId"/><order-by field-name="finAccountName"/></entity-find></entity-options></drop-down><link condition="finAccountId" text="Edit Account" link-type="anchor" url="editFinancialAccount"/></conditional-field><conditional-field condition="isVendorOrgInternal" title="Credit Account"><link condition="finAccountId" link-type="anchor" url="editFinancialAccount" text="FinancialAccountNameTemplate" entity-name="mantle.account.financial.FinancialAccount"/></conditional-field><default-field><ignored/></default-field></field><field name="postalContactMechId"><conditional-field title="Shipping Address" condition="returnChangeable"><drop-down allow-empty="true"><list-options list="postalAddressList" key="${contactMechId}" text="PostalAddressSimpleTemplate"/></drop-down></conditional-field><default-field title="Shipping Address"><display-entity entity-name="mantle.party.contact.PartyContactMechPostalAddress" text="PostalAddressSimpleTemplate"/></default-field></field><field name="telecomContactMechId"><conditional-field title="Shipping Phone" condition="returnChangeable"><drop-down allow-empty="true"><list-options list="telecomNumberList" key="${contactMechId}" text="TelecomNumberSimpleTemplate"/></drop-down></conditional-field><default-field title="Shipping Phone"><display-entity entity-name="mantle.party.contact.PartyContactMechTelecomNumber" text="TelecomNumberSimpleTemplate"/></default-field></field><field name="shipmentMethodEnumId"><conditional-field title="Shipment Method" condition="returnChangeable"><drop-down allow-empty="true"><entity-options><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="ShipmentMethod"/><order-by field-name="description"/></entity-find></entity-options></drop-down></conditional-field><default-field title="Shipment Method"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="submitButton"><conditional-field title="Update" condition="returnChangeable"><submit/></conditional-field></field></form-single></row-col><row-col lg="6"><link url="requestReturn" condition="returnHeader.statusId == 'ReturnCreated'" text="Set Requested"/><link url="approveReturn" condition="returnHeader.statusId in ['ReturnCreated', 'ReturnRequested']" text="Approve" confirmation="Approve this return?"/><link url="cancelReturn" condition="returnHeader.statusId in ['ReturnCreated', 'ReturnRequested', 'ReturnApproved']" text="Cancel" confirmation="Are you sure you want to cancel this return?"/><section-include name="StatusHistorySection" location="component://SimpleScreens/template/basic/StatusWidgets.xml"/></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Return/EditReturnItems.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Items" default-menu-index="2"><parameter name="returnId" required="true"/><transition name="updateReturnItem"><service-call name="mantle.order.ReturnServices.update#ReturnItem" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteReturnItem"><service-call name="mantle.order.ReturnServices.delete#ReturnItem" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="processReturnItemResponses"><service-call name="mantle.order.ReturnServices.process#ReturnItemResponses" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="receiveReturnWithoutShipment"><service-call name="mantle.order.ReturnServices.receive#ReturnWithoutShipment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createReturnShipment"><service-call name="mantle.order.ReturnServices.create#ReturnShipment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="salesOrderDetail"><default-response url="//${appRoot}/Order/OrderDetail"/></transition><transition name="editFinancialAccount"><default-response url="//${appRoot}/Accounting/FinancialAccount/EditFinancialAccount"/></transition><transition name="editPayment"><default-response url="//${appRoot}/Accounting/Payment/EditPayment"/></transition><transition name="editInvoice"><default-response url="//${appRoot}/Accounting/Invoice/EditInvoice"/></transition><transition name="shipmentDetail"><default-response url="//${appRoot}/Shipment/ShipmentDetail"/></transition><actions><entity-find-one entity-name="mantle.order.return.ReturnHeader" value-field="returnHeader"/><if condition="returnHeader == null"><return error="true" message="Return not found with ID ${returnId}"/></if><set field="returnChangeable" from="returnHeader.statusId in ['ReturnCreated', 'ReturnRequested', 'ReturnApproved']"/><entity-find entity-name="mantle.order.return.ReturnItem" list="returnItemList"><econdition field-name="returnId"/><order-by field-name="returnItemSeqId"/></entity-find><script><![CDATA[returnItemWithChildrenSet = new HashSet()
            List reverseList = returnItemList.cloneList().orderByFields(["-returnItemSeqId"])
            for (returnItem in reverseList) {
                if (returnItem.parentItemSeqId) {
                    returnItemWithChildrenSet.add(returnItem.parentItemSeqId)
                    returnItemList.move(returnItemList.indexMatching([returnItemSeqId:returnItem.returnItemSeqId]),
                            returnItemList.indexMatching([returnItemSeqId:returnItem.parentItemSeqId])+1)
                }
            }]]></script><set field="allResponses" from="true"/><set field="allReceived" from="true"/><set field="rootItemList" from="[]"/><iterate list="returnItemList" entry="returnItem"><if condition="returnItem.responseDate == null"><set field="allResponses" from="false"/></if><if condition="returnItem.statusId in ['ReturnCreated', 'ReturnRequested', 'ReturnApproved', 'ReturnShipped']"><set field="allReceived" from="false"/></if><if condition="!returnItem.parentItemSeqId"><script><![CDATA[rootItemList.add(returnItem)]]></script></if></iterate><entity-find entity-name="mantle.shipment.ShipmentItemSource" list="allItemSisList"><econdition field-name="returnId"/></entity-find><entity-find entity-name="mantle.order.return.ReturnItemBilling" list="allItemBillingList"><econdition field-name="returnId"/></entity-find><entity-find entity-name="moqui.basic.EnumGroupMember" list="productItemTypeEgms" cache="true"><econdition field-name="enumGroupEnumId" value="EngItemsProduct"/></entity-find><set field="productItemTypes" from="productItemTypeEgms*.enumId"/><set field="allOnShipments" from="true"/><iterate list="returnItemList" entry="returnItem"><if condition="returnItem.productId"><entity-find-one entity-name="mantle.product.Product" value-field="product" cache="true"><field-map field-name="productId" from="returnItem.productId"/></entity-find-one><set field="isProductItemType" from="returnItem.itemTypeEnumId in productItemTypes"/><set field="isShippable" from="isProductItemType && product != null ? product.productTypeEnumId in ['PtAsset', 'PtDigitalAsset', 'PtAssetUse', 'PtPickAssembly'] : false"/><if condition="isShippable"><set field="itemSisQuantity" from="allItemSisList.findAll({ it.returnItemSeqId == returnItem.returnItemSeqId })*.quantity.sum()"/><if condition="itemSisQuantity < returnItem.returnQuantity"><set field="allOnShipments" from="false"/></if></if></if></iterate></actions><widgets><link url="processReturnItemResponses" text="Process Item Responses" condition="!allResponses" confirmation="Will process items not yet processed in Received and Completed statuses or with Immediate=Y in Approved and Shipped statuses"/><link url="receiveReturnWithoutShipment" text="Receive without Shipment" condition="!allReceived" confirmation="Are you sure, and are all return quantities correct? This will cancel the return shipment, receive full quantity of all Approved or Shipped items, and process item responses."/><link url="createReturnShipment" text="Create Return Shipment" condition="!allOnShipments" confirmation="Create new shipment for items not already on an incoming return shipment?"/><form-list name="ReturnItemList" list="returnItemList" transition="updateReturnItem"><row-actions><set field="itemChangeable" from="statusId in ['ReturnCreated', 'ReturnRequested', 'ReturnApproved']"/><set field="itemStrictChangeable" from="statusId in ['ReturnCreated', 'ReturnRequested']"/><if condition="finAccountTransId"><entity-find-one entity-name="mantle.account.financial.FinancialAccountTrans" value-field="finAccountTrans"/><set field="finAccountId" from="finAccountTrans.finAccountId"/></if><filter-map-list list="allItemBillingList" to-list="curItemBillingList"><field-map field-name="returnItemSeqId"/></filter-map-list><set field="invoiceId" from="curItemBillingList ? curItemBillingList[0].invoiceId : null"/><filter-map-list list="allItemSisList" to-list="curItemSisList"><field-map field-name="returnItemSeqId"/></filter-map-list><if condition="productId"><entity-find-one entity-name="mantle.product.Product" value-field="product" cache="true"/><set field="isProductItemType" from="itemTypeEnumId in productItemTypes"/><set field="isShippable" from="isProductItemType && product != null ? product.productTypeEnumId in ['PtAsset', 'PtDigitalAsset', 'PtAssetUse', 'PtPickAssembly'] : false"/><if condition="itemStrictChangeable && isProductItemType"><entity-find entity-name="mantle.product.ProductAssoc" list="virtualAssocList"><date-filter/><econdition field-name="toProductId" from="productId"/><econdition field-name="productAssocTypeEnumId" value="PatVariant"/></entity-find><if condition="virtualAssocList"><entity-find entity-name="mantle.product.ProductAssoc" list="variantAssocList"><date-filter/><econdition field-name="productId" operator="in" from="virtualAssocList*.productId"/><econdition field-name="productAssocTypeEnumId" value="PatVariant"/></entity-find><set field="variantProductIdSet" from="new HashSet(variantAssocList*.toProductId)"/><set field="variantProductList" from="new ArrayList(variantProductIdSet.size())"/><iterate list="variantProductIdSet" entry="variantProductId"><entity-find-one entity-name="mantle.product.Product" value-field="variantProduct" cache="true"><field-map field-name="productId" from="variantProductId"/></entity-find-one><script><![CDATA[variantProductList.add(variantProduct)]]></script></iterate><order-map-list list="variantProductList"><order-by field-name="pseudoId"/></order-map-list></if></if></if></row-actions><field name="returnId"><default-field><hidden/></default-field></field><field name="returnItemSeqId"><default-field title="Item"><display/></default-field></field><field name="parentItemSeqId" align="center"><conditional-field condition="itemChangeable"><drop-down allow-empty="true"><list-options list="rootItemList.findAll({it.returnItemSeqId!=returnItemSeqId})" key="${returnItemSeqId}" text="${returnItemSeqId}"/></drop-down></conditional-field><default-field title="Parent"><display/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="returnReasonEnumId"><conditional-field condition="itemChangeable"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ReturnReason"/><set field="style" value=" "/></widget-template-include></conditional-field><default-field title="Reason"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="returnResponseEnumId"><conditional-field condition="itemChangeable"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ReturnResponse"/><set field="style" value=" "/></widget-template-include></conditional-field><default-field title="Response"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="responseImmediate"><conditional-field condition="itemChangeable"><drop-down allow-empty="true"><option key="N" text="N - On Received"/><option key="Y" text="Y - On Approved"/></drop-down></conditional-field><default-field title="Immediate?"><display/></default-field></field><field name="itemTypeEnumId"><default-field title="Item Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="productId"><default-field title="Product"><display-entity entity-name="mantle.product.Product" text="ProductNameTemplate"/></default-field></field><field name="replacementProductId"><conditional-field condition="itemStrictChangeable && variantProductList"><drop-down allow-empty="true"><list-options list="variantProductList" key="${productId}" text="ProductNameTemplate"/></drop-down></conditional-field><default-field title="Replacement Product"><display-entity entity-name="mantle.product.Product" text="ProductNameTemplate"/></default-field></field><field name="description"><conditional-field condition="itemChangeable"><text-line size="30"/></conditional-field><default-field><display/></default-field></field><field name="orderItem"><default-field><link url="salesOrderDetail" text="${orderId}:${orderItemSeqId}" link-type="anchor" condition="orderId"/></default-field></field><field name="returnQuantity"><conditional-field condition="itemChangeable && !responseAmount"><text-line size="4"/></conditional-field><default-field><display/></default-field></field><field name="inventoryStatusId"><conditional-field condition="itemChangeable && isShippable"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="Asset"/><set field="noCurrentSelectedKey" value="AstReturned"/><set field="style" value=" "/></widget-template-include></conditional-field><default-field title="Inventory Status"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="returnPrice"><conditional-field condition="itemChangeable && !responseAmount"><text-line size="8"/></conditional-field><default-field><display currency-unit-field="returnHeader.currencyUomId"/></default-field></field><field name="receivedQuantity" from="receivedQuantity ?: 0.0"><default-field><display/></default-field></field><field name="shipments"><default-field><section-iterate name="ItemShipmentList" list="curItemSisList" entry="curItemSis"><widgets><link url="shipmentDetail" text="${curItemSis.shipmentId} (${curItemSis.quantity})" link-type="anchor" parameter-map="[shipmentId:curItemSis.shipmentId]"/></widgets></section-iterate></default-field></field><field name="responseDate"><default-field><display/></default-field></field><field name="replacementOrderId"><default-field title="Replacement Order"><link url="salesOrderDetail" text="${replacementOrderId}" link-type="anchor" condition="replacementOrderId" parameter-map="[orderId:replacementOrderId]"/></default-field></field><field name="responseAmount"><default-field><display currency-unit-field="returnHeader.currencyUomId"/></default-field></field><field name="finAccountTransId"><default-field title="Refund Credit Trans"><link url="editFinancialAccount" text="${finAccountTransId} (Account #${finAccountId})" link-type="anchor" condition="finAccountTransId"/></default-field></field><field name="refundPaymentId"><default-field title="Refund Payment"><link url="editPayment" text="P: ${refundPaymentId}" link-type="anchor" condition="refundPaymentId" parameter-map="[paymentId:refundPaymentId]"/></default-field></field><field name="invoiceId"><default-field title="Credit Memo Invoice"><link url="editInvoice" text="I: ${invoiceId}" link-type="anchor" condition="invoiceId" parameter-map="[invoiceId:invoiceId]"/></default-field></field><field name="submitButton"><conditional-field title="Update" condition="itemChangeable"><submit/></conditional-field><default-field title=""><display text=" "/></default-field></field><field name="buttons"><default-field title=""><link url="deleteReturnItem" text="" btn-type="danger" icon="fa fa-trash" condition="statusId in ['ReturnCreated', 'ReturnRequested', 'ReturnCancelled']" confirmation="Delete item ${returnItemSeqId}?"/></default-field></field><form-list-column><field-ref name="returnItemSeqId"/><field-ref name="parentItemSeqId"/></form-list-column><form-list-column><field-ref name="statusId"/><field-ref name="orderItem"/><field-ref name="itemTypeEnumId"/></form-list-column><form-list-column><field-ref name="returnReasonEnumId"/><field-ref name="inventoryStatusId"/></form-list-column><form-list-column><field-ref name="returnResponseEnumId"/><field-ref name="responseImmediate"/></form-list-column><form-list-column><field-ref name="productId"/><field-ref name="replacementProductId"/><field-ref name="description"/></form-list-column><form-list-column><field-ref name="returnQuantity"/><field-ref name="returnPrice"/></form-list-column><form-list-column><field-ref name="receivedQuantity"/><field-ref name="shipments"/><field-ref name="responseDate"/><field-ref name="replacementOrderId"/></form-list-column><form-list-column><field-ref name="responseAmount"/><field-ref name="finAccountTransId"/><field-ref name="refundPaymentId"/><field-ref name="invoiceId"/></form-list-column><form-list-column><field-ref name="submitButton"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Return/AddOrderItems.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Add From Orders" default-menu-index="3"><parameter name="returnId" required="true"/><parameter name="lookBackDays"/><transition name="addOrderItemToReturn"><service-call name="mantle.order.ReturnServices.add#OrderItemToReturn" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditReturnItems"/></transition><transition name="orderDetail"><default-response url="//${appRoot}/Order/OrderDetail"/></transition><actions><entity-find-one entity-name="mantle.order.return.ReturnHeader" value-field="returnHeader"/><if condition="returnHeader == null"><return error="true" message="Return not found with ID ${returnId}"/></if><set field="returnChangeable" from="returnHeader.statusId in ['ReturnCreated', 'ReturnRequested', 'ReturnApproved']"/><if condition="returnChangeable"><service-call name="mantle.order.ReturnServices.find#ReturnableOrderItems" out-map="context" in-map="[returnId:returnId, lookBackDays:lookBackDays]"/></if></actions><widgets><section name="AddItemsSection" condition="returnChangeable"><widgets><form-single name="LookBackDaysForm" transition="."><field name="returnId"><default-field><hidden/></default-field></field><field name="lookBackDays"><default-field><text-line size="4" default-value="30"/></default-field></field><field name="submitButton"><default-field title="Set"><submit/></default-field></field><field-layout><field-row-big><field-ref name="lookBackDays"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single><form-list name="AddOrderItemToReturn" list="orderItemInfoList" transition="addOrderItemToReturn"><field name="returnId"><default-field><hidden/></default-field></field><field name="orderId"><default-field title="Order"><display text=" "/><link url="orderDetail" text="${orderId}" link-type="anchor"/></default-field></field><field name="orderItemSeqId"><default-field title="Item"><display/></default-field></field><field name="itemTypeEnumId"><default-field title="Item Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="productId"><default-field title="Product"><display-entity entity-name="mantle.product.Product" text="ProductNameTemplate"/></default-field></field><field name="returnQuantity" from="isProductItemType ? returnableQuantity : 1.0"><default-field><text-line size="6"/></default-field></field><field name="responseAmount" from="!isProductItemType ? returnableTotal : null"><default-field title="Refund Amount"><text-line size="6"/></default-field></field><field name="inventoryStatusId"><conditional-field condition="isShippable"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="Asset"/><set field="noCurrentSelectedKey" value="AstReturned"/></widget-template-include></conditional-field><default-field title="Inventory Status"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="returnReasonEnumId"><default-field title="Reason"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ReturnReason"/><set field="style" value=" "/></widget-template-include></default-field></field><field name="returnResponseEnumId"><default-field title="Response"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ReturnResponse"/><set field="style" value=" "/></widget-template-include></default-field></field><field name="responseImmediate"><default-field title="Immediate?"><drop-down><option key="N" text="N - On Received"/><option key="Y" text="Y - On Approved"/></drop-down></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-list></widgets><fail-widgets><label text="Return ${returnId} cannot be changed" type="strong"/></fail-widgets></section></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Return.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Returns" default-menu-index="6" menu-image="/ssstatic/images/Return.png"><subscreens default-item="FindReturn"/><widgets><subscreens-panel id="ReturnPanel" type="tab"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Shipment/FindShipment.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Find Shipments" default-menu-include="false"><transition name="createShipment"><service-call name="mantle.shipment.ShipmentServices.create#Shipment" in-map="true" out-map="context" multi="parameter"/><default-response url="../ShipmentDetail"/></transition><transition name="shipmentDetail"><default-response url="../ShipmentDetail"/></transition><transition name="packShipmentScreen"><default-response url="//${appRoot}/Shipping/PackShipment"/></transition><transition name="orderDetail"><default-response url="//${appRoot}/Order/OrderDetail"/></transition><transition name="picklistDetail"><default-response url="//${appRoot}/Shipping/Picklist/PicklistDetail"/></transition><transition name="editFacility"><default-response url="//${appRoot}/Facility/EditFacility"/></transition><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition name="editSupplier"><default-response url="//${appRoot}/Supplier/EditSupplier"/></transition><transition name="editCustomer"><default-response url="//${appRoot}/Customer/EditCustomer"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getFacilityList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><actions><service-call name="org.moqui.impl.BasicServices.find#EnumerationByParent" out-map="incomingTypeOut" in-map="[parentEnumId:'ShpTpIncoming']"/><service-call name="org.moqui.impl.BasicServices.find#EnumerationByParent" out-map="outgoingTypeOut" in-map="[parentEnumId:'ShpTpOutgoing']"/><if condition="parentShipmentType == 'ShpTpIncoming'"><set field="shipmentTypeSet" from="incomingTypeOut.enumIdSet"/></if><if condition="parentShipmentType == 'ShpTpOutgoing'"><set field="shipmentTypeSet" from="outgoingTypeOut.enumIdSet"/></if><set field="defaultFacilityId" from="ec.user.getPreference('FacilityGeneralDefault')"/></actions><widgets><container-dialog id="NewOutgoingShipmentDialog" button-text="New Outgoing Shipment"><form-single name="NewOutgoingShipment" transition="createShipment"><field name="shipmentTypeEnumId"><default-field title="Type"><drop-down><list-options list="outgoingTypeOut.enumerationList" key="${enumId}" text="${description}"/></drop-down></default-field></field><field name="originFacilityId" from="originFacilityId ?: defaultFacilityId"><default-field title="Origin Facility"><drop-down allow-empty="true"><dynamic-options transition="getFacilityList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="toPartyId"><default-field title="To Party"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="estimatedReadyDate"><default-field title="Ready Date"><date-time/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><container-dialog id="NewIncomingShipmentDialog" button-text="New Incoming Shipment"><form-single name="NewIncomingShipment" transition="createShipment"><field name="shipmentTypeEnumId"><default-field title="Type"><drop-down><list-options list="incomingTypeOut.enumerationList" key="${enumId}" text="${description}"/></drop-down></default-field></field><field name="fromPartyId"><default-field title="From Party"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="destinationFacilityId" from="destinationFacilityId ?: defaultFacilityId"><default-field title="Destination Facility"><drop-down allow-empty="true"><dynamic-options transition="getFacilityList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="estimatedArrivalDate"><default-field title="Arrival Date"><date-time/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><container-dialog id="NewTransferShipmentDialog" button-text="New Transfer Shipment"><form-single name="NewTransferShipment" transition="createShipment"><field name="shipmentTypeEnumId" from="'ShpTpTransfer'"><default-field><hidden/></default-field></field><field name="originFacilityId" from="originFacilityId ?: defaultFacilityId"><default-field title="Origin Facility"><drop-down allow-empty="true"><dynamic-options transition="getFacilityList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="destinationFacilityId" from="destinationFacilityId ?: defaultFacilityId"><default-field title="Destination Facility"><drop-down allow-empty="true"><dynamic-options transition="getFacilityList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="toPartyId"><default-field title="To Party"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="estimatedReadyDate"><default-field title="Ready Date"><date-time/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><link url="../PackageTracking" text="Package Tracking"/><form-list name="ShipmentList" list="shipmentList" skip-form="true" header-dialog="true" select-columns="true" saved-finds="true" show-csv-button="true"><entity-find entity-name="mantle.shipment.ShipmentFindView" list="shipmentList" distinct="true" use-clone="true"><search-form-inputs default-order-by="-entryDate,shipmentId"><default-parameters statusId="ShipInput,ShipScheduled,ShipPicked" statusId_op="in" entryDate_poffset="-3" entryDate_period="30d"/></search-form-inputs><date-filter from-field-name="customerClassFromDate" thru-field-name="customerClassThruDate" ignore="!customerClassificationId"/><econdition field-name="shipmentTypeEnumId" operator="in" from="shipmentTypeSet" ignore="!shipmentTypeSet"/><econdition field-name="productId" operator="in" from="findProductId" ignore-if-empty="true"/><select-field field-name="shipmentId"/></entity-find><row-actions><entity-find entity-name="mantle.party.PartyClassificationAndAppl" list="custPcaaList"><date-filter/><econdition field-name="partyId" from="toPartyId"/><econdition field-name="classificationTypeEnumId" value="PcltCustomer"/></entity-find><entity-find entity-name="mantle.shipment.ShipmentItemSource" list="sisList" distinct="true"><econdition field-name="shipmentId"/><select-field field-name="orderId"/></entity-find><entity-find entity-name="mantle.shipment.ShipmentPackageRouteSeg" list="sprsList" distinct="true"><econdition field-name="shipmentId"/><select-field field-name="trackingCode,returnTrackingCode"/></entity-find><entity-find entity-name="mantle.order.OrderHeader" list="orderHeaderList"><econdition field-name="orderId" operator="in" from="sisList*.orderId"/><select-field field-name="orderId,salesChannelEnumId"/></entity-find><entity-find entity-name="mantle.order.OrderPartPartyDetail" list="orderPartyList"><econdition field-name="orderId" operator="in" from="sisList*.orderId"/><select-field field-name="partyId,pseudoId,firstName,lastName,organizationName,description"/></entity-find></row-actions><field name="shipmentId"><header-field title="Shipment" show-order-by="true"><text-find size="10" hide-options="true"/></header-field><default-field><link url="shipmentDetail" text="${shipmentId}" link-type="anchor"/></default-field></field><field name="shipmentMethodEnumId"><header-field title="Ship Method" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ShipmentMethod"/><set field="allowMultiple" value="true"/><set field="showNot" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="shipmentTypeEnumId"><header-field title="Type" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ShipmentType"/><set field="allowEmpty" value="true"/><set field="showNot" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="priority" align="center"><header-field show-order-by="true"><range-find size="4"/></header-field><default-field><display text="${priority == 1 ? '-- ' : (priority == 2 || priority == 3 ? '- ' : '')}${priority?:''}${priority == 1 ? ' --' : (priority == 2 || priority == 3 ? ' -' : '')}" style="${priority == 1 ? 'text-strong text-danger' : (priority == 2 || priority == 3 ? 'text-strong text-warning' : '')}"/></default-field></field><field name="entryDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="statusId"><header-field title="Status" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="Shipment"/><set field="allowMultiple" value="true"/><set field="showNot" value="true"/></widget-template-include></header-field><default-field container-style="text-strong"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="shipWorkEffortId"><header-field title="Picklist" show-order-by="true"><text-find size="15" hide-options="true"/></header-field><default-field><link url="picklistDetail" text="${shipWorkEffortId}" link-type="anchor" parameter-map="[workEffortId:shipWorkEffortId]" condition="shipWorkEffortId"/></default-field></field><field name="findProductId"><header-field title="Product"><drop-down allow-multiple="true"><dynamic-options transition="getProductList" server-search="true" min-length="0"/></drop-down></header-field></field><field name="shipAfterDate"><header-field title="Ship After" show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="shipBeforeDate"><header-field title="Ship Before" show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="actualStartDate"><header-field title="Actual Start" show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="actualArrivalDate"><header-field title="Actual Arrival" show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="originFacilityId"><header-field title="Origin Facility"><drop-down allow-empty="true"><dynamic-options transition="getFacilityList" server-search="true" min-length="0"/></drop-down></header-field><default-field><link url="editFacility" entity-name="mantle.facility.Facility" text="FacilityNameTemplate" link-type="anchor" parameter-map="[facilityId:originFacilityId]"/></default-field></field><field name="destinationFacilityId"><header-field title="Dest. Facility"><drop-down allow-empty="true"><dynamic-options transition="getFacilityList" server-search="true" min-length="0"/></drop-down></header-field><default-field><link url="editFacility" entity-name="mantle.facility.Facility" text="FacilityNameTemplate" link-type="anchor" parameter-map="[facilityId:destinationFacilityId]"/></default-field></field><field name="productStoreId"><header-field title="Store"><drop-down allow-empty="true"><entity-options key="${productStoreId}" text="${productStoreId}: ${storeName}"><entity-find entity-name="mantle.product.store.ProductStore"><order-by field-name="storeName"/></entity-find></entity-options></drop-down></header-field><default-field><display-entity entity-name="mantle.product.store.ProductStore" text="${productStoreId}: ${storeName}"/></default-field></field><field name="handlingInstructions"><header-field title="Shipping Instructions" show-order-by="true"><text-find/></header-field><default-field><display text="${handlingInstructions?.take(35)?:''}${handlingInstructions?.length() > 35 ? '...' : ''}" style="text-strong"/></default-field></field><field name="fromPartyId"><header-field title="From Party"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></header-field><default-field><link url="editSupplier" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" link-type="anchor" parameter-map="[partyId:fromPartyId]"/></default-field></field><field name="toPartyId"><header-field title="To Party"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></header-field><default-field><link url="editCustomer" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" link-type="anchor" parameter-map="[partyId:toPartyId]"/><label text=" - ${custPcaaList*.description.join(', ')}" condition="custPcaaList"/></default-field></field><field name="customerClassificationId"><header-field title="Customer Class"><drop-down allow-empty="true"><entity-options key="${partyClassificationId}" text="${description}"><entity-find entity-name="mantle.party.PartyClassification"><econdition field-name="classificationTypeEnumId" value="PcltCustomer"/><order-by field-name="description"/></entity-find></entity-options></drop-down></header-field></field><field name="orderPartyId"><header-field><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></header-field></field><field name="orderRoleTypeId"><header-field><drop-down allow-empty="true"><entity-options key="${roleTypeId}" text="${description}"><entity-find entity-name="mantle.party.RoleGroupMemberAndType" cache="true"><econdition field-name="roleGroupEnumId" value="RgpOrder"/><order-by field-name="description"/></entity-find></entity-options></drop-down></header-field></field><field name="orderParties"><default-field><section-iterate name="OtherPartyListSection" list="orderPartyList" entry="partParty"><widgets><container><link url="editParty" link-type="anchor" text="${ec.resource.expand('PartyNameTemplate','',partParty)} - ${partParty.description?:'N/A'}" parameter-map="[partyId:partParty.partyId]"/></container></widgets></section-iterate></default-field></field><field name="trackingCode"><header-field><text-find default-operator="begins"/></header-field></field><field name="returnTrackingCode"><header-field title="Return Tracking"><text-find default-operator="begins"/></header-field></field><field name="orderId"><header-field><text-find default-operator="begins"/></header-field></field><field name="salesChannelEnumId"><header-field title="Order Source"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="SalesChannel"/><set field="allowEmpty" value="true"/></widget-template-include></header-field></field><field name="trackingCodes"><default-field><section-iterate name="TrackingSprsList" list="sprsList" entry="sprs"><widgets><container><label text="${sprs.trackingCode?:''}${sprs.returnTrackingCode ? ' R: ' + sprs.returnTrackingCode :''}"/></container></widgets></section-iterate></default-field></field><field name="orderIds"><default-field title="Orders"><section-iterate name="OrderSisList" list="orderHeaderList" entry="orderHeader"><widgets><link url="orderDetail" text="${orderHeader.orderId}" link-type="anchor" condition="orderHeader.orderId" parameter-map="[orderId:orderHeader.orderId]"/><label text=" - ${orderHeader.salesChannel?.description?:''}" condition="orderHeader.salesChannelEnumId"/></widgets></section-iterate></default-field></field><field name="otherPartyOrderId"><header-field title="Their Order" show-order-by="true"><text-find size="20" hide-options="true"/></header-field><default-field><display/></default-field></field><field name="estimatedArrivalDate"><header-field title="Est. Arrival" show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="estimatedReadyDate"><header-field title="Est. Ready" show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="packScreenLink"><default-field title="Pack"><link url="packShipmentScreen" text="Pack" link-type="anchor"/></default-field></field><field name="findButton"><header-field title="Find"><submit/></header-field></field><form-list-column><field-ref name="shipmentId"/><field-ref name="shipmentMethodEnumId"/><field-ref name="shipmentTypeEnumId"/></form-list-column><form-list-column><field-ref name="entryDate"/><field-ref name="statusId"/></form-list-column><form-list-column><field-ref name="priority"/><field-ref name="shipWorkEffortId"/></form-list-column><form-list-column><field-ref name="originFacilityId"/><field-ref name="destinationFacilityId"/><field-ref name="productStoreId"/></form-list-column><form-list-column><field-ref name="fromPartyId"/><field-ref name="toPartyId"/><field-ref name="handlingInstructions"/></form-list-column><form-list-column><field-ref name="otherPartyOrderId"/><field-ref name="orderIds"/><field-ref name="trackingCodes"/></form-list-column><form-list-column><field-ref name="shipAfterDate"/><field-ref name="estimatedReadyDate"/><field-ref name="actualStartDate"/></form-list-column><form-list-column><field-ref name="shipBeforeDate"/><field-ref name="estimatedArrivalDate"/><field-ref name="actualArrivalDate"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Shipment/PackageTracking.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Package Tracking" default-menu-include="false"><transition name="shipmentDetail"><default-response url="../ShipmentDetail"/></transition><transition name="editFacility"><default-response url="//${appRoot}/Facility/EditFacility"/></transition><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition name="editCustomer"><default-response url="//${appRoot}/Customer/EditCustomer"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition-include name="getFacilityList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><actions><service-call name="org.moqui.impl.BasicServices.find#EnumerationByParent" out-map="outgoingTypeOut" in-map="[parentEnumId:'ShpTpOutgoing']"/><set field="shipmentTypeSet" from="outgoingTypeOut.enumIdSet"/><set field="defaultFacilityId" from="ec.user.getPreference('FacilityGeneralDefault')"/><set field="hoursPastEta" from="hoursPastEta ?: '12'"/><set field="hoursPastEtaInt" from="hoursPastEta as int"/><if condition="hoursPastEtaInt > 0"><set field="etaLookBack" from="new Timestamp(java.time.ZonedDateTime.now().minusHours(hoursPastEtaInt).withMinute(0).withSecond(0).toInstant().toEpochMilli())"/></if><set field="daysSincePacked" from="daysSincePacked ?: '5'"/><set field="daysSincePackedInt" from="daysSincePacked as int"/><if condition="daysSincePackedInt > 0"><set field="packedLookBack" from="new Timestamp(java.time.ZonedDateTime.now().minusDays(daysSincePackedInt).withMinute(0).withSecond(0).toInstant().toEpochMilli())"/></if><set field="daysSinceLastTrack" from="daysSinceLastTrack ?: '0'"/><set field="daysSinceLastTrackInt" from="daysSinceLastTrack as int"/><if condition="daysSinceLastTrackInt > 0"><set field="lastTrackLookBack" from="new Timestamp(java.time.ZonedDateTime.now().minusDays(daysSinceLastTrackInt).withMinute(0).withSecond(0).toInstant().toEpochMilli())"/></if><set field="summaryString" value=""/><if condition="etaLookBack != null"><set field="summaryString" value="with ETA or Orig ETA before ${ec.l10n.format(etaLookBack, null)}"/></if><if condition="packedLookBack != null"><set field="summaryString" from="(summaryString ? summaryString + ' OR ' : '') + 'Packed before ' + ec.l10n.format(packedLookBack, null)"/></if><if condition="lastTrackLookBack != null"><set field="summaryString" from="(summaryString ? summaryString + ' OR ' : '') + 'Last Track before ' + ec.l10n.format(lastTrackLookBack, null)"/></if></actions><widgets><label text="Packages ${summaryString}" type="h5" condition="summaryString"/><form-list name="EtaPackageList" list="packageList" skip-form="true" header-dialog="true" saved-finds="true"><entity-find entity-name="mantle.shipment.ShipmentPackageFindView" list="packageList"><search-form-inputs default-order-by="-packedDate,-shipmentId"><default-parameters trackingStatusEnumId_op="in" trackingStatusEnumId="ShTsUnknown,ShTsTransit,ShTsReturned,ShTsFailure"/></search-form-inputs><date-filter from-field-name="customerClassFromDate" thru-field-name="customerClassThruDate" ignore="!customerClassificationId"/><econdition field-name="shipmentTypeEnumId" operator="in" from="shipmentTypeSet" ignore="!shipmentTypeSet"/><econditions combine="or"><econdition field-name="trackingEta" operator="less" from="etaLookBack" ignore-if-empty="true"/><econdition field-name="trackingOrigEta" operator="less" from="etaLookBack" ignore-if-empty="true"/><econdition field-name="packedDate" operator="less" from="packedLookBack" ignore-if-empty="true"/><econdition field-name="trackingStatusDate" operator="less" from="lastTrackLookBack" ignore-if-empty="true"/></econditions><select-field field-name="trackingUrl"/></entity-find><row-actions><entity-find entity-name="mantle.party.PartyClassificationAndAppl" list="custPcaaList"><date-filter/><econdition field-name="partyId" from="toPartyId"/><econdition field-name="classificationTypeEnumId" value="PcltCustomer"/></entity-find></row-actions><field name="orFields"><header-field title=""><label text="Results match any of Hours Past ETA, Days Since Packed, and Days Since Last Track (OR) and must match all other options selected (AND)"/></header-field></field><field name="hoursPastEta"><header-field title="Hours Past ETA"><text-line size="4"/><label text="Defaults to 12, set to 0 to ignore"/></header-field></field><field name="daysSincePacked"><header-field><text-line size="4"/><label text="Defaults to 5, set to 0 to ignore"/></header-field></field><field name="daysSinceLastTrack"><header-field><text-line size="4"/><label text="Defaults to 0 (ignored)"/></header-field></field><field name="shipmentId"><header-field title="Shipment" show-order-by="true"><text-find size="10" hide-options="true"/></header-field><default-field><link url="shipmentDetail" text="${shipmentId}" link-type="anchor"/></default-field></field><field name="packedDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="trackingStatusEnumId"><header-field title="Track Status" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ShipmentTrackingStatus"/><set field="allowEmpty" value="true"/><set field="allowMultiple" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="shipmentTypeEnumId"><header-field title="Type" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ShipmentType"/><set field="allowEmpty" value="true"/><set field="allowMultiple" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="trackingEta"><header-field title="ETA" show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="trackingOrigEta"><header-field title="Orig. ETA" show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="trackingCode"><header-field><text-find default-operator="begins"/></header-field><default-field><link url="${trackingUrl}" text="${trackingCode}" url-type="plain" link-type="anchor" target-window="_blank"/></default-field></field><field name="trackingStatusDate"><header-field title="Last Track" show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="estimatedArrivalDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="estimatedReadyDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="customerClassificationId"><header-field title="Customer Class"><drop-down allow-empty="true"><entity-options key="${partyClassificationId}" text="${description}"><entity-find entity-name="mantle.party.PartyClassification"><econdition field-name="classificationTypeEnumId" value="PcltCustomer"/><order-by field-name="description"/></entity-find></entity-options></drop-down></header-field></field><field name="toPartyId"><header-field title="To Party" show-order-by="true"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></header-field><default-field><link url="editCustomer" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" link-type="anchor" parameter-map="[partyId:toPartyId]"/><label text=" - ${custPcaaList*.description.join(', ')}" condition="custPcaaList"/></default-field></field><field name="originFacilityId"><header-field title="Origin Facility"><drop-down allow-empty="true"><dynamic-options transition="getFacilityList" server-search="true" min-length="0"/></drop-down></header-field><default-field><link url="editFacility" entity-name="mantle.facility.Facility" text="FacilityNameTemplate" link-type="anchor" parameter-map="[facilityId:originFacilityId]"/></default-field></field><field name="findButton"><header-field title="Find"><submit/></header-field></field><form-list-column><field-ref name="shipmentId"/><field-ref name="packedDate"/></form-list-column><form-list-column><field-ref name="trackingStatusEnumId"/><field-ref name="shipmentTypeEnumId"/></form-list-column><form-list-column><field-ref name="trackingEta"/><field-ref name="trackingOrigEta"/></form-list-column><form-list-column><field-ref name="trackingCode"/><field-ref name="trackingStatusDate"/></form-list-column><form-list-column><field-ref name="estimatedArrivalDate"/><field-ref name="estimatedReadyDate"/></form-list-column><form-list-column><field-ref name="toPartyId"/><field-ref name="originFacilityId"/></form-list-column></form-list><section name="ShowSql" condition="packageList_xafind?.getQueryTextList()"><widgets><container-dialog id="ShowSqlDialog" button-text="Show SQL"><section-iterate name="ShowSqlIter" list="packageList_xafind?.getQueryTextList()" entry="queryText"><widgets><label text="${queryText}" type="p"/><label text="${packageList_xafind}" type="p"/></widgets></section-iterate></container-dialog></widgets></section></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Shipment/ShipmentByPackage.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="shipmentId" required="true"/><actions><service-call name="mantle.shipment.ShipmentServices.get#ShipmentPickPackInfo" in-map="[shipmentId:shipmentId, templateSettingSuffix:'TemplateShipmentByPackage']" out-map="context"/><if condition="!templateLocation"><set field="templateLocation" value="component://SimpleScreens/template/shipment/ShipmentByPackage.xsl-fo.ftl"/></if></actions><widgets><render-mode><text type="xsl-fo" location="${templateLocation}" template="true" encode="false" no-boundary-comment="true"/></render-mode></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Shipment/ShipmentInsert.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="shipmentId" required="true"/><actions><service-call name="mantle.shipment.ShipmentServices.get#ShipmentPickPackInfo" in-map="[shipmentId:shipmentId, templateSettingSuffix:'TemplateShipmentInsert']" out-map="context"/><if condition="!templateLocation"><set field="templateLocation" value="component://SimpleScreens/template/shipment/ShipmentInsert.xsl-fo.ftl"/></if></actions><widgets><render-mode><text type="xsl-fo" location="${templateLocation}" template="true" encode="false" no-boundary-comment="true"/></render-mode></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Shipment/ShipmentPack.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="shipmentId" required="true"/><actions><service-call name="mantle.shipment.ShipmentServices.get#ShipmentPickPackInfo" in-map="[shipmentId:shipmentId, templateSettingSuffix:'TemplateShipmentPack']" out-map="context"/><if condition="!templateLocation"><set field="templateLocation" value="component://SimpleScreens/template/shipment/ShipmentPack.xsl-fo.ftl"/></if></actions><widgets><render-mode><text type="xsl-fo" location="${templateLocation}" template="true" encode="false" no-boundary-comment="true"/></render-mode></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Shipment/ShipmentPick.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="shipmentId" required="true"/><actions><service-call name="mantle.shipment.ShipmentServices.get#ShipmentPickPackInfo" in-map="[shipmentId:shipmentId, templateSettingSuffix:'TemplateShipmentPick']" out-map="context"/><if condition="!templateLocation"><set field="templateLocation" value="component://SimpleScreens/template/shipment/ShipmentPick.xsl-fo.ftl"/></if></actions><widgets><render-mode><text type="xsl-fo" location="${templateLocation}" no-boundary-comment="true"/></render-mode></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Shipment/ShipmentDetail/ItemReserve.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="shipmentId" required="true"/><parameter name="orderId" required="true"/><parameter name="orderItemSeqId" required="true"/><parameter name="filterProductId"/><parameter name="onlyRemaining"/><parameter name="pageIndex"/><transition name="reserveAssetForOrderItem"><service-call name="mantle.product.AssetServices.reserve#AssetForOrderItem" in-map="true" out-map="context" multi="parameter"/><default-response url=".."/></transition><transition-include name="getAssetList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><actions><entity-find-one entity-name="mantle.order.OrderItem" value-field="orderItem"/><set field="orderPart" from="orderItem.part"/></actions><widgets><form-single name="ReserveItem" transition="reserveAssetForOrderItem"><field name="shipmentId"><default-field><hidden/></default-field></field><field name="filterProductId"><default-field><hidden/></default-field></field><field name="onlyRemaining"><default-field><hidden/></default-field></field><field name="pageIndex"><default-field><hidden/></default-field></field><field name="orderId"><default-field title="Order"><display/></default-field></field><field name="orderItemSeqId"><default-field title="Order Item"><display/></default-field></field><field name="productId" from="orderItem.productId"><default-field title="Product"><display-entity entity-name="mantle.product.Product" text="ProductNameTemplate"/></default-field></field><field name="orderQuantity" from="orderItem.quantity"><default-field><display/></default-field></field><field name="assetId"><default-field title="Asset"><drop-down allow-empty="true"><dynamic-options transition="getAssetList" server-search="true" min-length="0" parameter-map="[facilityId:orderPart.facilityId, productId:orderItem.productId, assetTypeEnumId:null, excludeZeroQoh:'true']"/></drop-down></default-field></field><field name="assetIdList"><default-field title="Other Assets"><drop-down allow-multiple="true"><dynamic-options transition="getAssetList" server-search="true" min-length="0" parameter-map="[facilityId:orderPart.facilityId, productId:orderItem.productId, assetTypeEnumId:null, excludeZeroQoh:'true']"/></drop-down></default-field></field><field name="resetReservations"><default-field title=""><check no-current-selected-key="true"><option key="true" text="Reset Reservations"/></check></default-field></field><field name="submitButton"><default-field title="Reserve"><submit/></default-field></field></form-single></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Shipment/ShipmentDetail/ReceiveItem.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="shipmentId" required="true"/><parameter name="productId"/><parameter name="statusId"/><parameter name="filterProductId"/><parameter name="onlyRemaining"/><parameter name="pageIndex"/><transition name="receive"><service-call name="mantle.shipment.ShipmentServices.receive#ShipmentProduct" in-map="true" out-map="context" multi="parameter"/><default-response url=".."/></transition><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getLotList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getAssetPoolList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition-include name="getLocationList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><transition-include name="getContainerList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><actions><set field="origProductId" from="productId"/><service-call name="mantle.product.ProductServices.find#ProductByIdValue" out-map="productByIdOut" in-map="[idValue:productId, shipmentId:shipmentId]"/><set field="productId" from="productByIdOut.productId ?: productId"/><entity-find-one entity-name="mantle.product.Product" value-field="product"/><if condition="product == null"><return error="true" message="No Product found with ID ${origProductId}"/></if><entity-find-one entity-name="mantle.shipment.ShipmentItem" value-field="shipmentItem"/><if condition="shipmentItem == null"><return error="true" message="Shipment ${shipmentId} item ${productId} not found"/></if><service-call name="mantle.shipment.ShipmentServices.get#ShipmentDisplayInfo" in-map="[shipmentId:shipmentId]" out-map="context"/><service-call name="org.moqui.impl.BasicServices.find#Enumeration" in-map="[enumTypeId:'RejectionReason']" out-map="reasonOut"/><set field="facilityId" from="shipmentRouteSegmentList ? shipmentRouteSegmentList[shipmentRouteSegmentList.size()-1].destinationFacilityId : null"/><set field="quantityAccepted" from="shipmentItem.quantity"/><entity-find entity-name="mantle.product.receipt.AssetReceipt" list="assetReceiptList"><econdition field-name="shipmentId"/><econdition field-name="productId"/></entity-find><iterate list="assetReceiptList" entry="assetReceipt"><set field="quantityAccepted" from="quantityAccepted - (assetReceipt.quantityAccepted ?: 0.0) - (assetReceipt.quantityRejected ?: 0.0)"/></iterate><entity-find entity-name="mantle.shipment.ShipmentItemSource" list="shipmentItemSourceList"><econdition field-name="shipmentId"/><econdition field-name="productId"/></entity-find><set field="returnShipmentItemSourceList" from="shipmentItemSourceList.findAll({ it.returnId && it.returnItemSeqId })"/><iterate list="returnShipmentItemSourceList" entry="returnShipmentItemSource"><entity-find-one entity-name="mantle.order.return.ReturnItem" value-field="returnItem"><field-map field-name="returnId" from="returnShipmentItemSource.returnId"/><field-map field-name="returnItemSeqId" from="returnShipmentItemSource.returnItemSeqId"/></entity-find-one><if condition="returnItem?.inventoryStatusId"><set field="statusId" from="returnItem.inventoryStatusId"/><break/></if></iterate><entity-find entity-name="mantle.shipment.ShipmentParty" list="assetOwnerPartyList"><econdition field-name="shipmentId"/><econdition field-name="roleTypeId" value="AssetOwner"/><order-by field-name="partyId"/></entity-find><set field="ownerPartyId" from="assetOwnerPartyList ? assetOwnerPartyList[0].partyId : null"/><set field="orderShipmentItemSourceList" from="shipmentItemSourceList.findAll({ it.orderId && it.orderItemSeqId })"/><iterate list="orderShipmentItemSourceList" entry="shipmentItemSource"><if condition="(!acquireCost || !ownerPartyId) && shipmentItemSource.orderId && shipmentItemSource.orderItemSeqId"><entity-find-one entity-name="mantle.order.OrderItem" value-field="orderItem"><field-map field-name="orderId" from="shipmentItemSource.orderId"/><field-map field-name="orderItemSeqId" from="shipmentItemSource.orderItemSeqId"/></entity-find-one><if condition="!acquireCost"><set field="acquireCost" from="orderItem?.standardCost ?: orderItem?.unitAmount"/></if><if condition="!ownerPartyId"><set field="orderPart" from="orderItem?.'mantle.order.OrderPart'"/><set field="ownerPartyId" from="orderPart?.customerPartyId"/></if></if></iterate><if condition="!ownerPartyId"><set field="ownerPartyId" from="activeOrgId"/></if><if condition="!ownerPartyId"><set field="ownerPartyId" from="product?.ownerPartyId"/></if><if condition="shipment.shipmentTypeEnumId == 'ShpTpSalesReturn'"><then><if condition="!ownerPartyId"><entity-find-one entity-name="mantle.facility.Facility" value-field="destFacility"/><set field="ownerPartyId" from="destFacility.ownerPartyId"/></if></then><else><if condition="!ownerPartyId"><set field="ownerPartyId" from="shipment.fromPartyId"/></if><if condition="!mfgPartyId"><set field="mfgPartyId" from="shipment.fromPartyId"/></if></else></if><entity-find entity-name="mantle.product.issuance.AssetIssuance" list="assetIssuanceList"><econdition field-name="shipmentId"/><econdition field-name="productId"/></entity-find><iterate list="assetIssuanceList" entry="assetIssuance"><set field="asset" from="assetIssuance.asset"/><if condition="!lotId && asset?.lotId"><set field="lotId" from="asset.lotId"/></if><if condition="!acquireCost && asset?.acquireCost"><set field="acquireCost" from="asset.acquireCost"/></if></iterate></actions><widgets><form-single name="ReceiveForm" transition="receive"><field name="shipmentId"><default-field><hidden/></default-field></field><field name="filterProductId"><default-field><hidden/></default-field></field><field name="onlyRemaining"><default-field><hidden/></default-field></field><field name="pageIndex"><default-field><hidden/></default-field></field><field name="fromPartyName"><default-field title="Supplier"><display text="PartyNameTemplate" text-map="fromPartyDetail"/></default-field></field><field name="productId"><conditional-field condition="productId" title="Product"><display-entity entity-name="mantle.product.Product" text="ProductNameTemplate"/></conditional-field><default-field title="Product"><drop-down allow-empty="true"><dynamic-options transition="getProductList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="statusId"><default-field title="Status" tooltip="For inventory defaults to Available, otherwise defaults to In Storage"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="Asset"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="receivedDate" from="ec.user.nowTimestamp"><default-field title="Received Date"><date-time/></default-field></field><field name="mfgPartyId"><default-field title="Manufacturer"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="0" parameter-map="[roleTypeId:'Supplier,Manufacturer']"/></drop-down></default-field></field><field name="lotId"><default-field title="Lot" tooltip="Select an existing Lot, for new enter Lot Number (and Dates) below"><drop-down allow-empty="true"><dynamic-options transition="getLotList" server-search="true" min-length="0"><depends-on field="mfgPartyId"/></dynamic-options></drop-down></default-field></field><field name="lotNumber"><default-field tooltip="For new lot enter Lot Number (and Dates), for existing select above"><text-line size="20"/></default-field></field><field name="manufacturedDate"><default-field title="Manufactured"><date-time type="date"/></default-field></field><field name="expectedEndOfLife"><default-field title="Expiration"><date-time type="date"/></default-field></field><field name="ownerPartyId"><default-field title="Owner"><label text="Default Asset Owner (${ownerPartyId}) different from Facility owner (${destinationFacility.ownerPartyId}), if not consignment inventory change now" style="text-warning" condition="ownerPartyId && destinationFacility?.ownerPartyId && ownerPartyId != destinationFacility.ownerPartyId"/><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="0" parameter-map="[roleTypeId:'Supplier,OrgInternal']"/></drop-down></default-field></field><field name="assetPoolId"><default-field title="Pool"><drop-down allow-empty="true"><dynamic-options transition="getAssetPoolList" server-search="true" min-length="0" depends-optional="true"><depends-on field="ownerPartyId"/></dynamic-options></drop-down></default-field></field><field name="acquireCost"><default-field tooltip="Defaults to Standard Cost or Price (Unit Amount) on related order item"><text-line size="8" format="#,##0.00"/></default-field></field><field name="quantityAccepted"><default-field><text-line size="8"/></default-field></field><field name="quantityRejected"><default-field><text-line size="8"/></default-field></field><field name="serialNumber"><default-field tooltip="If specified Quantity Accepted will be set to 1 (one) unless Quantity Rejected is 1"><text-line size="25"/></default-field></field><field name="rejectionReasonEnumId"><default-field title="Rejection Reason"><drop-down allow-empty="true"><list-options list="reasonOut.enumerationList" key="${enumId}" text="${description}"/></drop-down></default-field></field><field name="facilityId"><default-field title="Facility"><display-entity entity-name="mantle.facility.Facility" text="FacilityNameTemplate"/></default-field></field><field name="locationSeqId"><default-field title="Location"><drop-down allow-empty="true"><dynamic-options transition="getLocationList" server-search="true" min-length="0"><depends-on field="facilityId"/></dynamic-options></drop-down></default-field></field><field name="containerId"><default-field title="Container"><drop-down><dynamic-options transition="getContainerList" server-search="true" min-length="0"><depends-on field="facilityId"/><depends-on field="locationSeqId"/></dynamic-options></drop-down></default-field></field><field name="comments"><default-field title="Notes"><text-area cols="80" rows="3"/></default-field></field><field name="submitButton"><default-field title="Receive"><submit/></default-field></field><field-layout><field-ref name="fromPartyName"/><field-ref name="productId"/><field-row><field-ref name="statusId"/><field-ref name="receivedDate"/></field-row><field-ref name="mfgPartyId"/><field-ref name="lotId"/><field-ref name="lotNumber"/><field-row><field-ref name="manufacturedDate"/><field-ref name="expectedEndOfLife"/></field-row><field-ref name="ownerPartyId"/><field-ref name="assetPoolId"/><field-ref name="acquireCost"/><field-row><field-ref name="quantityAccepted"/><field-ref name="quantityRejected"/></field-row><field-row><field-ref name="serialNumber"/><field-ref name="rejectionReasonEnumId"/></field-row><field-row><field-ref name="facilityId"/><field-ref name="containerId"/></field-row><field-ref name="locationSeqId"/><field-ref name="comments"/><field-ref name="submitButton"/></field-layout></form-single></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Shipment/ShipmentDetail/UpdateItemAsset.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="shipmentId" required="true"/><parameter name="productId" required="true"/><parameter name="assetId" required="true"/><parameter name="statusId"/><parameter name="filterProductId"/><parameter name="onlyRemaining"/><parameter name="pageIndex"/><transition name="updateAsset"><service-call name="mantle.product.AssetServices.update#AssetAndReceipt" in-map="true" out-map="context" multi="parameter"/><default-response url=".."/></transition><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getLotList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getAssetPoolList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition-include name="getLocationList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><transition-include name="getContainerList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><actions><service-call name="mantle.shipment.ShipmentServices.get#ShipmentDisplayInfo" in-map="[shipmentId:shipmentId]" out-map="context"/><service-call name="org.moqui.impl.BasicServices.find#Enumeration" in-map="[enumTypeId:'RejectionReason']" out-map="reasonOut"/><set field="facilityId" from="shipmentRouteSegmentList?.first?.destinationFacilityId"/><set field="passedStatusId" from="statusId"/><entity-find-one entity-name="mantle.product.asset.Asset" value-field="asset"/><script><![CDATA[context.putAll(asset)]]></script><set field="statusId" from="passedStatusId"/><if condition="lotId"><entity-find-one entity-name="mantle.product.asset.Lot" value-field="lot"><field-map field-name="lotId"/></entity-find-one><if condition="lot != null"><set field="lotNumber" from="lot.lotNumber"/><set field="mfgPartyId" from="lot.mfgPartyId"/></if></if><entity-find entity-name="mantle.product.receipt.AssetReceipt" list="assetReceiptList"><econdition field-name="assetId"/><econdition field-name="shipmentId"/><order-by field-name="assetReceiptId"/></entity-find><set field="originalAssetReceipt" from="assetReceiptList?.first"/><script><![CDATA[if (originalAssetReceipt) context.putAll(originalAssetReceipt)]]></script><set field="rejectionReasonEnumId" from="originalAssetReceipt?.rejectionReasonEnumId"/></actions><widgets><form-single name="UpdateForm" transition="updateAsset" extends="component://SimpleScreens/screen/SimpleScreens/Shipment/ShipmentDetail/ReceiveItem.xml#ReceiveForm"><field name="assetId"><default-field><hidden/></default-field></field><field name="acquireCost"><default-field><display format="#,##0.00"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Shipment/ShipmentDetail.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Shipment" default-menu-index="1"><parameter name="shipmentId" required="true"/><transition name="packShipmentScreen"><default-response url="//${appRoot}/Shipping/PackShipment"/></transition><transition name="orderDetail"><default-response url="//${appRoot}/Order/OrderDetail"/></transition><transition name="editReturn"><default-response url="//${appRoot}/Return/EditReturn"/></transition><transition name="editInvoice"><default-response url="//${appRoot}/Accounting/Invoice/EditInvoice"/></transition><transition name="editPayment"><default-response url="//${appRoot}/Accounting/Payment/EditPayment"/></transition><transition name="editTransaction"><default-response url="//${appRoot}/Accounting/Transaction/EditTransaction"/></transition><transition name="editProduct"><default-response url="//${appRoot}/Product/EditProduct"/></transition><transition name="assetDetail"><default-response url="//${appRoot}/Asset/AssetDetail"/></transition><transition name="picklistDetail"><default-response url="//${appRoot}/Shipping/Picklist/PicklistDetail"/></transition><transition name="editFacility"><default-response url="//${appRoot}/Facility/EditFacility"/></transition><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition name="editSupplier"><default-response url="//${appRoot}/Supplier/EditSupplier"/></transition><transition name="editCustomer"><default-response url="//${appRoot}/Customer/EditCustomer"/></transition><transition name="updateShipment"><service-call name="mantle.shipment.ShipmentServices.update#ShipmentAndRouteSegment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="scheduleShipment"><service-call name="update#mantle.shipment.Shipment" in-map="[shipmentId:shipmentId, statusId:'ShipScheduled']" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="pickShipment"><service-call name="update#mantle.shipment.Shipment" in-map="[shipmentId:shipmentId, statusId:'ShipPicked']" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="packShipment"><service-call name="mantle.shipment.ShipmentServices.pack#Shipment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="shipShipment"><service-call name="mantle.shipment.ShipmentServices.ship#Shipment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="unshipShipment"><service-call name="update#mantle.shipment.Shipment" in-map="[shipmentId:shipmentId, statusId:'ShipPacked']" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deliverShipment"><service-call name="mantle.shipment.ShipmentServices.deliver#Shipment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="receiveEntireShipment"><service-call name="mantle.shipment.ShipmentServices.receive#EntireShipment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="cancelShipment"><service-call name="mantle.shipment.ShipmentServices.cancel#Shipment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="validateAddress"><service-call name="mantle.shipment.CarrierServices.validate#PostalAddress" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="sendShipmentStoreEmail"><service-call name="mantle.shipment.ShipmentServices.send#ShipmentStoreEmail" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="sendEmailMessage"><service-call name="org.moqui.impl.EmailServices.send#EmailMessage" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createShipmentParty"><service-call name="create#mantle.shipment.ShipmentParty" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteShipmentParty"><service-call name="delete#mantle.shipment.ShipmentParty" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createContent"><service-call name="mantle.shipment.ShipmentServices.create#ShipmentContent" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateContent"><service-call name="mantle.shipment.ShipmentServices.update#ShipmentContent" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="downloadContent" read-only="true"><parameter name="shipmentContentId"/><actions><entity-find-one entity-name="mantle.shipment.ShipmentContent" value-field="shipmentContent"/><script><![CDATA[ec.web.sendResourceResponse(shipmentContent.contentLocation)]]></script></actions><default-response type="none"/></transition><transition name="addItem"><service-call name="mantle.shipment.ShipmentServices.create#ShipmentItem" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateItem"><service-call name="mantle.shipment.ShipmentServices.update#ShipmentItem" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="pickMoveShipmentProduct"><service-call name="mantle.shipment.ShipmentServices.pickMove#ShipmentProduct" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="packShipmentProductScan"><service-call name="mantle.shipment.ShipmentServices.pack#ShipmentProductScan" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="packItem"><service-call name="mantle.shipment.ShipmentServices.pack#ShipmentProduct" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="packItemSource"><service-call name="mantle.shipment.ShipmentServices.pack#ShipmentItemSource" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="packAssemblyComponent"><service-call name="mantle.shipment.ShipmentServices.pack#ShipmentAssemblyComponent" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="produceAvailableAssemblies"><service-call name="mantle.work.ManufacturingServices.produce#AvailableAssemblies" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="unpackItemIssuance"><service-call name="mantle.shipment.ShipmentServices.unpack#ShipmentItemIssuance" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="addItemToPackage"><service-call name="mantle.shipment.ShipmentServices.add#ItemToPackage" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createPackage"><service-call name="mantle.shipment.ShipmentServices.create#ShipmentPackage" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="resetShipmentPackage"><service-call name="mantle.shipment.ShipmentServices.reset#ShipmentPackage" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deletePackage"><service-call name="mantle.shipment.ShipmentServices.delete#ShipmentPackage" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updatePackageAndRouteSeg"><service-call name="mantle.shipment.ShipmentServices.update#ShipmentPackageAndRouteSeg" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updatePackageContent"><service-call name="mantle.shipment.ShipmentServices.update#ShipmentPackageContent" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createShipmentAutoPackages"><service-call name="mantle.shipment.ShipmentServices.create#ShipmentAutoPackages" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="requestShipmentLabels"><service-call name="mantle.shipment.CarrierServices.request#ShipmentLabels" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="refundShipmentLabels"><service-call name="mantle.shipment.CarrierServices.refund#ShipmentLabels" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="trackShipmentLabels"><service-call name="mantle.shipment.CarrierServices.track#ShipmentLabels" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="removeShipmentLabelInfo"><service-call name="mantle.shipment.CarrierServices.remove#ShipmentLabelInfo" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="removeShipmentReturnLabelInfo"><service-call name="mantle.shipment.CarrierServices.remove#ShipmentReturnLabelInfo" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="printShipmentLabels"><service-call name="mantle.shipment.ShipmentServices.print#ShipmentLabels" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getAssetList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getContainerList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><transition-include name="getPackageWeight" location="component://SimpleScreens/template/shipment/ShipmentTransitions.xml"/><transition-include name="getShippingOptions" location="component://SimpleScreens/template/shipment/ShipmentTransitions.xml"/><transition-include name="getShipmentLabel" location="component://SimpleScreens/template/shipment/ShipmentTransitions.xml"/><transition name="EmailMessage" read-only="true"><parameter name="emailMessageId"/><actions><entity-find-one entity-name="moqui.basic.email.EmailMessage" value-field="emailMessage"/><script><![CDATA[ec.web.sendTextResponse(emailMessage?.body, "text/html", null)]]></script></actions><default-response type="none"/></transition><transition name="ShipmentPick.pdf"><default-response url="${ec.web.getWebappRootUrl(false, null)}/fop/apps/${appRoot}/Shipment/ShipmentPick" url-type="plain"><parameter name="shipmentId"/><parameter name="filename" value="ShipmentPick-${shipmentId}.pdf"/></default-response></transition><transition name="ShipmentPack.pdf"><default-response url="${ec.web.getWebappRootUrl(false, null)}/fop/apps/${appRoot}/Shipment/ShipmentPack" url-type="plain"><parameter name="shipmentId"/><parameter name="filename" value="ShipmentPack-${shipmentId}.pdf"/></default-response></transition><transition name="ShipmentByPackage.pdf"><default-response url="${ec.web.getWebappRootUrl(false, null)}/fop/apps/${appRoot}/Shipment/ShipmentByPackage" url-type="plain"><parameter name="shipmentId"/><parameter name="filename" value="ShipmentByPackage-${shipmentId}.pdf"/></default-response></transition><transition name="ShipmentInsert.pdf"><default-response url="${ec.web.getWebappRootUrl(false, null)}/fop/apps/${appRoot}/Shipment/ShipmentInsert" url-type="plain"><parameter name="shipmentId"/><parameter name="filename" value="ShipmentInsert-${shipmentId}.pdf"/></default-response></transition><transition name="setItemLimit"><actions><script><![CDATA[ec.user.setPreference('shipment.detail.item.limit', pageSize)]]></script></actions><default-response url="."/></transition><subscreens><subscreens-item name="UpdateContactInfo" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty/UpdateContactInfo.xml"/></subscreens><actions><set field="defaultItemLimit" from="ec.user.getPreference('shipment.detail.item.limit') ?: '10'"/><set field="pageSize" from="pageSize ?: defaultItemLimit"/><service-call name="mantle.shipment.ShipmentInfoServices.get#ShipmentDisplayInfo" in-map="[shipmentId:shipmentId]" out-map="context"/><set field="activePackage" from="shipmentPackageList?.find({ it.weight == null || it.shipmentBoxTypeId == null })"/><set field="activePackageSeqId" from="activePackage?.shipmentPackageSeqId"/><set field="filteredShipmentPackageList" from="shipmentPackageList"/><if condition="filterProductId"><filter-map-list list="allShipmentPackageContentList" to-list="filteredShipmentPackageContentList"><field-map field-name="productId" from="filterProductId"/></filter-map-list><set field="shipmentPackageSeqIdSet" from="new HashSet(filteredShipmentPackageContentList*.shipmentPackageSeqId)"/><set field="filteredShipmentPackageList" from="shipmentPackageList.findAll({ shipmentPackageSeqIdSet.contains(it.shipmentPackageSeqId) })"/></if><entity-find entity-name="mantle.facility.Facility" list="facilityList"><econdition field-name="facilityTypeEnumId" value="FcTpWarehouse"/><order-by field-name="facilityName"/></entity-find><entity-find entity-name="mantle.order.OrderNote" list="orderNoteList"><econdition field-name="orderId" operator="in" from="orderIdSet"/><order-by field-name="-noteDate"/></entity-find><set field="shippingPostalAddressList" from="[]"/><if condition="(isOutgoing || isTransfer) && toPartyId"><service-call name="mantle.party.ContactServices.get#PartyContactInfoList" out-map="toPartyShippingInfo" in-map="[partyId:toPartyId, postalContactMechPurposeId:'PostalShippingDest']"/><set field="shippingPostalAddressList" from="toPartyShippingInfo.postalAddressList ?: []"/><if condition="isTransfer && lastRouteSegment.destinationFacilityId"><service-call name="mantle.facility.ContactServices.get#FacilityContactInfo" out-map="destFacShippingInfo" in-map="[facilityId:lastRouteSegment.destinationFacilityId, postalContactMechPurposeId:'PostalShippingDest']"/><if condition="destFacShippingInfo.postalAddress"><script><![CDATA[shippingPostalAddressList.add(0, destFacShippingInfo)]]></script></if></if><if condition="lastRouteSegment.destPostalContactMechId"><service-call name="mantle.party.ContactServices.get#PartyContactInfo" out-map="curDestPaInfo" in-map="[partyId:toPartyId, postalContactMechId:lastRouteSegment.destPostalContactMechId]"/><if condition="!(lastRouteSegment.destPostalContactMechId in shippingPostalAddressList*.postalContactMechId)"><script><![CDATA[shippingPostalAddressList.add(0, curDestPaInfo)]]></script></if></if></if><if condition="isIncoming && fromPartyId"><service-call name="mantle.party.ContactServices.get#PartyContactInfoList" out-map="fromPartyShippingDestInfo" in-map="[partyId:fromPartyId, postalContactMechPurposeId:'PostalShippingDest']"/><service-call name="mantle.party.ContactServices.get#PartyContactInfoList" out-map="fromPartyShippingOriginInfo" in-map="[partyId:fromPartyId, postalContactMechPurposeId:'PostalShippingOrigin']"/><set field="shippingPostalAddressList" from="(fromPartyShippingDestInfo.postalAddressList ?: []) + (fromPartyShippingOriginInfo.postalAddressList ?: [])"/><if condition="firstRouteSegment.originPostalContactMechId"><service-call name="mantle.party.ContactServices.get#PartyContactInfo" out-map="curOriginPaInfo" in-map="[partyId:fromPartyId, postalContactMechId:firstRouteSegment.originPostalContactMechId]"/><if condition="!(firstRouteSegment.originPostalContactMechId in shippingPostalAddressList*.postalContactMechId)"><script><![CDATA[shippingPostalAddressList.add(0, curOriginPaInfo)]]></script></if></if></if><script><![CDATA[Set replacedPostalIdSet = new HashSet()
            for (int i=0; i < shippingPostalAddressList.size(); i++) {
                String replAddressId = shippingPostalAddressList.get(i).postalContactMech?.replacesContactMechId
                if (replAddressId && !(replAddressId.equals(firstRouteSegment.originPostalContactMechId) || replAddressId.equals(lastRouteSegment.destPostalContactMechId)))
                    replacedPostalIdSet.add(replAddressId)
            }
            Set shippingPostalIdSet = new HashSet()
            for (int i=0; i < shippingPostalAddressList.size(); ) {
                String curAddressId = shippingPostalAddressList.get(i).postalContactMechId
                if (shippingPostalIdSet.contains(curAddressId) || replacedPostalIdSet.contains(curAddressId)) { shippingPostalAddressList.remove(i) }
                else { shippingPostalIdSet.add(curAddressId); i++ }
            }]]></script><if condition="isOutgoing || isTransfer"><service-call name="mantle.shipment.ShipmentInfoServices.get#ShipmentShippingOptions" out-map="context" in-map="[shipmentId:shipmentId, getRates:false]"/></if><entity-find-count entity-name="mantle.shipment.ShipmentEmailMessage" count-field="emailMessageCount"><econdition field-name="shipmentId"/></entity-find-count><entity-find entity-name="mantle.facility.FacilityBoxTypeDetail" list="boxTypeList"><econdition field-name="facilityId" from="firstRouteSegment.originFacilityId"/><order-by field-name="description"/></entity-find><if condition="!boxTypeList"><entity-find entity-name="mantle.shipment.ShipmentBoxType" list="boxTypeList"><order-by field-name="description"/></entity-find></if><set field="localPrintAllLabels" from="false"/><if condition="ec.web.sessionAttributes.get('qzPackShipment' + shipmentId)"><set field="localPrintAllLabels" from="true"/><script><![CDATA[ec.web.sessionAttributes.put('qzPackShipment' + shipmentId, false)]]></script></if><set field="getShipmentLabelPath" from="sri.buildUrl('getShipmentLabel').path"/><set field="defaultNetworkPrinterId" from="ec.user.getPreference('Shipment.networkPrinterId.default')"/><entity-find entity-name="moqui.basic.print.NetworkPrinter" list="networkPrinterList"><order-by field-name="description,printerName"/></entity-find></actions><widgets><container-row><row-col md="6"><label text="${isIncoming ? 'Incoming' : (isOutgoing ? 'Outgoing' : (isTransfer ? 'Transfer' : 'Unknown Type'))} Shipment #${shipmentId}" type="h4"/><section name="ShipInputSection" condition="shipment.statusId == 'ShipInput'"><widgets><section name="ShipInputInOutSection" condition="isIncoming"><widgets><link url="scheduleShipment" text="Set Scheduled" btn-type="success"/></widgets><fail-widgets><link url="scheduleShipment" text="Set Scheduled" btn-type="success"/><link url="pickShipment" text="Set Picked"/></fail-widgets></section></widgets></section><section name="ShipScheduledSection" condition="shipment.statusId == 'ShipScheduled'"><widgets><section name="ShipScheduledInOutSection" condition="isIncoming"><widgets><link url="receiveEntireShipment" text="Receive Entire Shipment"/><link url="requestShipmentLabels" text="Get Labels" condition="shippingGatewayConfigId && !hasAllLabels"/></widgets><fail-widgets><link url="pickShipment" text="Set Picked" condition="!hasNoItems"/><link url="shipShipment" text="Set Shipped" condition="hasNoItems"/></fail-widgets></section></widgets></section><section-include name="PackShipmentSection" location="component://SimpleScreens/screen/SimpleScreens/Shipment/ShipmentItems.xml"/><section-include name="ShipShipmentSection" location="component://SimpleScreens/screen/SimpleScreens/Shipment/ShipmentPackages.xml"/><section-include name="DeliverShipmentSection" location="component://SimpleScreens/screen/SimpleScreens/Shipment/ShipmentItems.xml"/><section-include name="RequestLabelsSection" location="component://SimpleScreens/screen/SimpleScreens/Shipment/ShipmentPackages.xml"/><link url="trackShipmentLabels" text="Track Labels" condition="shippingGatewayConfigId && hasAnyLabels"/><section-include name="PrintLabelsSection" location="component://SimpleScreens/screen/SimpleScreens/Shipment/ShipmentPackages.xml"/><section-include name="QzPrintLabelsSection" location="component://SimpleScreens/screen/SimpleScreens/Shipment/ShipmentPackages.xml"/><section name="ShipPackedSection" condition="shipment.statusId == 'ShipPacked'"><widgets><section name="ShipPackedInSection" condition="isIncoming"><widgets><link url="receiveEntireShipment" text="Receive Entire Shipment"><parameter name="shipmentId"/></link></widgets></section></widgets></section><section name="ShipShippedSection" condition="shipment.statusId == 'ShipShipped'"><widgets><section name="ShipShippedInOutSection" condition="isIncoming"><widgets><link url="unshipShipment" text="Set Packed (Un-Ship)"><parameter name="shipmentId"/></link><link url="receiveEntireShipment" text="Receive Entire Shipment" confirmation="Receive full quantity of all items with defaults?"><parameter name="shipmentId"/></link></widgets><fail-widgets><link url="unshipShipment" text="Set Packed (Un-Ship)" confirmation="Set shipment status back to Packed?"/></fail-widgets></section></widgets></section><section name="ShipDeliveredSection" condition="shipment.statusId == 'ShipDelivered'"><widgets><link url="shipShipment" text="Set Shipped (Un-deliver)"/></widgets></section><container-dialog id="CancelDialog" button-text="Cancel Shipment" condition="!(shipment.statusId in ['ShipDelivered', 'ShipRejected', 'ShipCancelled'])"><label text="Invoices associated with this shipment will be CANCELLED: ${invoiceIdSet.join(', ')}" condition="isOutgoing && invoiceIdSet" type="p" style="text-danger"/><label text="Invoices (found ${invoiceIdSet.size()} associated with this shipment) will not be changed, must be cancelled manually" condition="!isOutgoing && invoiceIdSet" type="p" style="text-warning"/><label text="Items have been packed/issued, these will be un-packed and returned to inventory" condition="anyItemPacked" type="p" style="text-danger"/><label text="Items have been received, all receipt quantities will be set to zero" condition="anyReceived" type="p" style="text-danger"/><label text="Labels will not be refunded automatically, refund manually if needed" condition="hasAnyLabels" type="p" style="text-warning"/><label text="Payments associated with this shipment through order or invoice will not be changed" type="p" style="text-warning"/><label text="Emails have been sent, these cannot be unsent" type="p" style="text-danger" condition="emailMessageCount"/><label text="Are you sure you want to cancel this shipment?"/><link url="cancelShipment" text="Cancel Shipment"/></container-dialog><container-dialog id="AuditLogDialog" button-text="Audit Log" width="960"><form-list name="AuditLogList" list="auditLogList" skip-form="true"><entity-find entity-name="moqui.entity.EntityAuditLog" list="auditLogList"><econdition field-name="changedEntityName" operator="in" from="['mantle.shipment.Shipment', 'mantle.shipment.ShipmentItem', 'mantle.shipment.ShipmentPackage', 'mantle.shipment.ShipmentRouteSegment', 'mantle.shipment.ShipmentPackageRouteSeg']"/><econdition field-name="changedFieldName" operator="not-equals" value="statusId"/><econdition field-name="pkPrimaryValue" from="shipmentId"/><select-field field-name="changedEntityName"/><order-by field-name="-changedDate,pkSecondaryValue"/></entity-find><field name="changedDate"><default-field title="Date"><display/></default-field></field><field name="changedByUserId"><default-field title="User"><display-entity text="UsernameTemplate" entity-name="mantle.party.PersonWithUserAccount" key-field-name="userId"/></default-field></field><field name="pkSecondaryValue"><default-field title="Item"><display/></default-field></field><field name="changedFieldName"><default-field title="Field"><display text="${org.moqui.util.StringUtilities.camelCaseToPretty(changedFieldName)}"/></default-field></field><field name="oldValueText"><default-field title="From"><display text="${ec.entity.formatFieldString(changedEntityName, changedFieldName, oldValueText)}"/></default-field></field><field name="newValueText"><default-field title="To"><display text="${ec.entity.formatFieldString(changedEntityName, changedFieldName, newValueText)}"/></default-field></field></form-list></container-dialog><container><section name="OutgoingTransferSection" condition="isOutgoing || isTransfer"><widgets><link url="ShipmentPick.pdf" text="Pick" icon="fa fa-download" style="${shipment.statusId in ['ShipScheduled', 'ShipPicked'] ? 'btn-info' : ''}"/><render-mode><text type="vuet,qvt"><![CDATA[<button v-if="$root.qzVue" class="btn btn-default btn-sm" onclick="moqui.printUrlMain('/fop/apps/${appRoot}/Shipment/ShipmentPick?shipmentId=${shipmentId}')"><i class="fa fa-print"></i> Pick</button>]]></text></render-mode><link url="ShipmentPack.pdf" text="Pack" icon="fa fa-download" style="${shipment.statusId in ['ShipShipped', 'ShipPacked'] ? 'btn-info' : ''}"/><render-mode><text type="vuet,qvt"><![CDATA[<button v-if="$root.qzVue" class="btn btn-default btn-sm" onclick="moqui.printUrlMain('/fop/apps/${appRoot}/Shipment/ShipmentPack?shipmentId=${shipmentId}')"><i class="fa fa-print"></i> Pack</button>]]></text></render-mode><link url="ShipmentByPackage.pdf" text="Package##Shipment" icon="fa fa-download" style="${shipment.statusId in ['ShipScheduled', 'ShipPicked'] ? 'btn-info' : ''}"/><render-mode><text type="vuet,qvt"><![CDATA[<button v-if="$root.qzVue" class="btn btn-default btn-sm" onclick="moqui.printUrlMain('/fop/apps/${appRoot}/Shipment/ShipmentByPackage?shipmentId=${shipmentId}')"><i class="fa fa-print"></i> Package</button>]]></text></render-mode><link url="ShipmentInsert.pdf" text="Insert" icon="fa fa-download" style="${shipment.statusId in ['ShipShipped', 'ShipPacked'] ? 'btn-info' : ''}"/><render-mode><text type="vuet,qvt"><![CDATA[<button v-if="$root.qzVue" class="btn btn-default btn-sm" onclick="moqui.printUrlMain('/fop/apps/${appRoot}/Shipment/ShipmentInsert?shipmentId=${shipmentId}')"><i class="fa fa-print"></i> Insert</button>]]></text></render-mode></widgets></section><section-iterate name="OrderLinks" list="orderIdSet" entry="orderId"><widgets><link url="orderDetail" text="Order ${orderId}" link-type="anchor-button"/></widgets></section-iterate><section-iterate name="ReturnLinks" list="returnIdSet" entry="returnId"><widgets><link url="editReturn" text="Return ${returnId}" link-type="anchor-button"/></widgets></section-iterate><section-iterate name="InvoiceLinks" list="invoiceIdSet" entry="invoiceId"><widgets><link url="editInvoice" text="Invoice ${invoiceId}" link-type="anchor-button"/></widgets></section-iterate><link url="packShipmentScreen" text="Pack Screen"/></container><section name="PostalAddressOtherDestSection" condition="isOutgoing || isTransfer"><widgets><container><dynamic-dialog id="AddPostalInfoDest" button-text="Add Dest. Address" transition="UpdateContactInfo" width="800" parameter-map="[partyId:toPartyId, postalContactMechPurposeId:'PostalShippingDest', shipmentId:shipmentId,                             shipmentRouteSegmentSeqId:lastRouteSegment.shipmentRouteSegmentSeqId, shipmentSetDest:'true']" condition="allowUpdate || shipment.statusId == 'ShipPacked'"/></container><label text="No origin shipping address selected" style="text-danger" type="p" condition="!lastRouteSegment.destPostalContactMechId"/><label text="No shipment method selected" style="text-warning" type="p" condition="!firstRouteSegment.shipmentMethodEnumId"/></widgets></section><section name="ShippedShippingDestInfo" condition="curDestPaInfo"><actions><set field="contactInfo" from="curDestPaInfo"/></actions><widgets><container type="dl" style="dl-horizontal"><label text="Destination Address" type="dt"/><container type="dd"><render-mode><text type="html,vuet,qvt" location="component://SimpleScreens/template/party/ContactInfo.html.gstring"/></render-mode><dynamic-dialog id="UpdatePostalInfo" button-text="Update Address" transition="UpdateContactInfo" width="800" condition="allowUpdate || shipment.statusId == 'ShipPacked'" parameter-map="[partyId:toPartyId, postalContactMechId:contactInfo.postalContactMechId,                                             postalContactMechPurposeId:contactInfo.postalContactMechPurposeId, shipmentId:shipmentId,                                             shipmentRouteSegmentSeqId:lastRouteSegment.shipmentRouteSegmentSeqId, shipmentSetDest:'true']"/><container><label text="Trust: ${contactInfo.postalTrustLevelEnum?.description ?: 'New'}${contactInfo.postalContactMech.validateMessage?'*':''}" type="strong" tooltip="${contactInfo.postalContactMech.validateMessage?:''}"/><link url="validateAddress" text="Validate" parameter-map="[shipmentId:shipmentId, partyId:toPartyId, contactMechId:contactInfo.postalContactMechId]" condition="!contactInfo.postalContactMech.trustLevelEnumId || contactInfo.postalContactMech.trustLevelEnumId == 'CmtlNew'"/></container></container></container></widgets></section><section name="PostalAddressOtherOriginSection" condition="isIncoming"><widgets><container><dynamic-dialog id="AddPostalInfoOrigin" button-text="Add Origin Address" transition="UpdateContactInfo" width="800" parameter-map="[partyId:fromPartyId, postalContactMechPurposeId:'PostalShippingDest', shipmentId:shipmentId,                             shipmentRouteSegmentSeqId:firstRouteSegment.shipmentRouteSegmentSeqId, shipmentSetDest:'true']" condition="allowUpdate"/></container><label text="No shipping address selected" style="text-danger" type="p" condition="!lastRouteSegment.destPostalContactMechId"/><label text="No shipment method selected" style="text-warning" type="p" condition="!firstRouteSegment.shipmentMethodEnumId"/></widgets></section><section name="ShippedShippingOriginInfo" condition="curOriginPaInfo"><actions><set field="contactInfo" from="curOriginPaInfo"/></actions><widgets><container type="dl" style="dl-horizontal"><label text="Origin Address" type="dt"/><container type="dd"><render-mode><text type="html,vuet,qvt" location="component://SimpleScreens/template/party/ContactInfo.html.gstring"/></render-mode><dynamic-dialog id="UpdatePostalInfoOrigin" button-text="Update Address" transition="UpdateContactInfo" width="800" condition="allowUpdate" parameter-map="[partyId:fromPartyId, postalContactMechId:contactInfo.postalContactMechId,                                             postalContactMechPurposeId:contactInfo.postalContactMechPurposeId, shipmentId:shipmentId]"/><container><label text="Trust: ${contactInfo.postalTrustLevelEnum?.description ?: 'New'}${contactInfo.postalContactMech.validateMessage?'*':''}" type="strong" tooltip="${contactInfo.postalContactMech.validateMessage?:''}"/><link url="validateAddress" text="Validate" parameter-map="[shipmentId:shipmentId, partyId:fromPartyId, contactMechId:contactInfo.postalContactMechId]" condition="!contactInfo.postalContactMech.trustLevelEnumId || contactInfo.postalContactMech.trustLevelEnumId == 'CmtlNew'"/></container></container></container></widgets></section><container type="dl" style="dl-horizontal"><label text="Store" type="dt" condition="productStore != null"/><label text="${productStore.productStoreId}: ${productStore.storeName}" type="dd" condition="productStore != null"/><label text="Shipping Gateway" type="dt" condition="shippingGatewayConfig != null"/><label text="${shippingGatewayConfig.description}" type="dd" condition="shippingGatewayConfig != null"/><label text="Order Ship By" type="dt"/><label text="${orderCarrierShipmentMethod?.description ? orderCarrierShipmentMethod.description : (orderCarrierDetail ? orderCarrierDetail.pseudoId : 'N/A') + ' ' + (orderShipmentMethodEnum ? orderShipmentMethodEnum.description : 'None')}" type="dd"/></container><form-single name="EditShipment" transition="updateShipment" map="shipment"><field name="shipmentId"><default-field><hidden/></default-field></field><field name="originPostalContactMechId" from="firstRouteSegment.originPostalContactMechId"><conditional-field title="Origin Address" condition="isIncoming && (allowUpdate || shipment.statusId == 'ShipPacked')"><drop-down allow-empty="true"><list-options list="shippingPostalAddressList" key="${postalContactMechId}" text="PostalAddressInfoTemplate"/></drop-down></conditional-field><default-field><hidden/></default-field></field><field name="destPostalContactMechId" from="lastRouteSegment.destPostalContactMechId"><conditional-field title="Destination Address" condition="(isOutgoing || isTransfer) && (allowUpdate || shipment.statusId == 'ShipPacked')"><drop-down allow-empty="true"><list-options list="shippingPostalAddressList" key="${postalContactMechId}" text="PostalAddressInfoTemplate"/></drop-down></conditional-field><default-field><hidden/></default-field></field><field name="carrierAndShipmentMethod"><conditional-field title="Ship By" condition="!hasAllLabels || !packageRouteSegList"><drop-down allow-empty="true" no-current-selected-key="${firstRouteSegment.carrierPartyId ? firstRouteSegment.carrierPartyId + ':' + firstRouteSegment.shipmentMethodEnumId : ''}"><list-options list="shippingOptions" key="${carrierPartyId}:${shipmentMethodEnumId}" text="${description ? description : (carrierPartyId != '_NA_' ? (carrierName + ' - ') : '') + shipmentMethodDescription}${shippingTotal != null ? ' ' + ec.l10n.formatCurrency(shippingTotal, orderHeader.currencyUomId) : ''}"/><dynamic-options transition="getShippingOptions"/></drop-down></conditional-field><default-field title="Ship By"><display text="${curCarrierShipmentMethod?.description ? curCarrierShipmentMethod?.description : (curCarrierDetail ? curCarrierDetail.pseudoId : 'N/A') + (curShipmentMethodEnum ? curShipmentMethodEnum.description : 'None')}"/></default-field></field><field name="shipmentTypeEnumId"><default-field title="Type"><display text="${shipmentTypeEnum.description}" also-hidden="false"/></default-field></field><field name="statusId"><default-field title="Status"><display text="${statusItem.description}" also-hidden="false"/></default-field></field><field name="shipWorkEffortId"><conditional-field condition="shipWorkEffortId" title="Picklist"><link url="picklistDetail" text="${shipWorkEffortId}" link-type="anchor" parameter-map="[workEffortId:shipWorkEffortId]" condition="shipWorkEffortId"/></conditional-field></field><field name="fromPartyId"><conditional-field title="From Party" condition="isIncoming && allowUpdate"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down><link url="editSupplier" text="${ec.resource.expand('PartyNameTemplate', '', fromPartyDetail)}" link-type="anchor" condition="toPartyDetail" parameter-map="[partyId:fromPartyId]"/></conditional-field><conditional-field title="From Party" condition="fromPartyId"><link url="editSupplier" text="${ec.resource.expand('PartyNameTemplate', '', fromPartyDetail)}" link-type="anchor" condition="toPartyDetail" parameter-map="[partyId:fromPartyId]"/></conditional-field></field><field name="toPartyId"><conditional-field title="To Party" condition="(isOutgoing || isTransfer) && allowUpdate"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down><link url="editCustomer" text="${ec.resource.expand('PartyNameTemplate', '', toPartyDetail)}" link-type="anchor" condition="toPartyDetail" parameter-map="[partyId:toPartyId]"/></conditional-field><conditional-field condition="toPartyId" title="To Party"><link url="editCustomer" text="${ec.resource.expand('PartyNameTemplate', '', toPartyDetail)}" link-type="anchor" condition="toPartyDetail" parameter-map="[partyId:toPartyId]"/></conditional-field></field><field name="originFacilityId" from="firstRouteSegment.originFacilityId"><conditional-field title="Origin Facility" condition="(isOutgoing || isTransfer) && allowUpdate"><drop-down><list-options list="facilityList" key="${facilityId}" text="FacilityNameTemplate"/></drop-down></conditional-field><conditional-field title="Origin Facility" condition="isOutgoing || isTransfer"><link url="editFacility" text="${ec.resource.expand('FacilityNameTemplate', '', originFacility)}" link-type="anchor" parameter-map="[facilityId:firstRouteSegment.originFacilityId]"/></conditional-field></field><field name="destinationFacilityId" from="lastRouteSegment.destinationFacilityId"><conditional-field title="Destination Facility" condition="(isIncoming || isTransfer) && allowUpdate"><drop-down><list-options list="facilityList" key="${facilityId}" text="FacilityNameTemplate"/></drop-down><link url="editFacility" text="${ec.resource.expand('FacilityNameTemplate', '', destinationFacility)}" link-type="anchor" parameter-map="[facilityId:lastRouteSegment.destinationFacilityId]"/></conditional-field><conditional-field title="Destination Facility" condition="isIncoming || isTransfer"><link url="editFacility" text="${ec.resource.expand('FacilityNameTemplate', '', destinationFacility)}" link-type="anchor" parameter-map="[facilityId:lastRouteSegment.destinationFacilityId]"/></conditional-field></field><field name="pickContainerId"><conditional-field title="Pick Container" condition="(isOutgoing || isTransfer) && allowUpdate"><drop-down allow-empty="true"><dynamic-options transition="getContainerList" server-search="true" min-length="2"/></drop-down></conditional-field><conditional-field condition="(isOutgoing || isTransfer) && pickContainerId" title="Pick Container"><display-entity entity-name="mantle.product.asset.Container" text="ContainerNameTemplate"/></conditional-field></field><field name="priority"><default-field><radio no-current-selected-key="5"><option key="1"/><option key="2"/><option key="3"/><option key="4"/><option key="5"/><option key="6"/><option key="7"/><option key="8"/><option key="9"/></radio></default-field></field><field name="handlingInstructions"><default-field title="Shipping Instructions"><text-area rows="3" cols="80"/></default-field></field><field name="otherPartyOrderId"><conditional-field condition="!isTransfer" title="Their Order" tooltip="Other party purchase or sales order ID"><text-line size="40"/></conditional-field></field><field name="signatureRequiredEnumId"><conditional-field title="Sign Req." condition="isOutgoing"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="SignatureRequired"/><set field="allowEmpty" value="true"/></widget-template-include></conditional-field></field><field name="shipAfterDate"><default-field title="Ship After"><date-time/></default-field></field><field name="shipBeforeDate"><default-field title="Ship Before"><date-time/></default-field></field><field name="estimatedReadyDate"><conditional-field condition="isOutgoing || isTransfer" title="Est Ready"><date-time/></conditional-field></field><field name="entryDate"><default-field title="Entry"><display/></default-field></field><field name="packedDate"><default-field title="Packed"><display/></default-field></field><field name="estimatedShipDate"><default-field title="Est Ship"><date-time/></default-field></field><field name="estimatedArrivalDate"><default-field title="Est Arrival"><date-time/></default-field></field><field name="actualStartDate" from="firstRouteSegment.actualStartDate"><default-field title="Actual Start"><display/></default-field></field><field name="actualArrivalDate" from="lastRouteSegment.actualArrivalDate"><default-field title="Actual Arrival"><display/></default-field></field><field name="submitButton"><default-field title="Update Shipment"><submit/></default-field></field><field-layout><field-ref name="originPostalContactMechId"/><field-ref name="destPostalContactMechId"/><field-ref name="carrierAndShipmentMethod"/><field-row><field-ref name="shipmentTypeEnumId"/><field-ref name="statusId"/></field-row><fields-not-referenced/><field-row><field-ref name="otherPartyOrderId"/><field-ref name="signatureRequiredEnumId"/></field-row><field-row><field-ref name="shipAfterDate"/><field-ref name="shipBeforeDate"/></field-row><field-row><field-ref name="estimatedReadyDate"/></field-row><field-row><field-ref name="estimatedShipDate"/><field-ref name="estimatedArrivalDate"/></field-row><field-row><field-ref name="entryDate"/><field-ref name="packedDate"/></field-row><field-row><field-ref name="actualStartDate"/><field-ref name="actualArrivalDate"/></field-row><field-ref name="submitButton"/></field-layout></form-single></row-col><row-col md="6"><section name="ItemLimitSection" condition="(shipmentItemDetailList.size() > 10) || (shipmentPackageList.size() > 10)"><widgets><form-single name="ItemLimitForm" transition="setItemLimit"><field name="shipmentId"><default-field><hidden/></default-field></field><field name="pageSize"><default-field title="Item & Package Limit"><drop-down><option key="10"/><option key="20"/><option key="50"/><option key="100"/></drop-down></default-field></field><field name="submitBtn"><default-field title="Update"><submit/></default-field></field><field-layout><field-row-big><field-ref name="pageSize"/><field-ref name="submitBtn"/></field-row-big></field-layout></form-single></widgets></section><section name="ScanReceiveSection" condition="((isIncoming && shipment.statusId in ['ShipScheduled', 'ShipShipped']) ||                         (isTransfer && shipment.statusId == 'ShipShipped'))"><actions><set field="scanReceiveUrl" from="sri.buildUrl('ReceiveItem').addParameter('shipmentId', shipmentId).addParameter('statusId', 'AstAvailable')"/></actions><widgets><render-mode><text type="vuet,qvt"><![CDATA[<form name="ReceiveByProductId" id="ReceiveByProductId"><fieldset class="form-horizontal"><div class="form-group"><div class="col-sm-12"><div class="big-row-item"><div class="form-group"><input id="ReceiveByProductId_scanId"  type="text" name="scanId" value="" size="15" class="form-control"></div></div><div class="big-row-item"><div class="form-group"><button type="submit" name="submitButton" value="submitButton" id="ReceiveByProductId_submitButton" class="btn btn-primary btn-sm">Receive</button></div></div></div></div></fieldset></form><dynamic-dialog id="ScanReceiveContainer" url="${scanReceiveUrl.urlWithParams}" width="800" title="Receive Product" :dynamic-params="{'productId':'ReceiveByProductId_scanId'}"></dynamic-dialog><m-script>
                    $("#ReceiveByProductId_scanId").focus();
                    $("#ReceiveByProductId").on("submit", function(evt) { evt.preventDefault(); $("#ScanReceiveContainer").modal("show"); });
                </m-script>]]></text></render-mode></widgets></section><section name="PackScanSection" condition="isOutgoing && shipment.statusId in ['ShipInput', 'ShipScheduled', 'ShipPicked']"><widgets><form-single name="PackScanForm" transition="packShipmentProductScan" focus-field="scanInput"><field name="shipmentId"><default-field><hidden/></default-field></field><field name="quantity" from="1"><default-field><text-line size="4"/></default-field></field><field name="scanInput"><default-field title="Product"><text-line size="20"/></default-field></field><field name="shipmentPackageSeqId" from="activePackageSeqId"><default-field title="Package"><drop-down><option key="" text="New"/><list-options list="shipmentPackageList" key="${shipmentPackageSeqId}" text="${shipmentPackageSeqId}"/></drop-down></default-field></field><field name="packButton"><default-field title="Pack Item"><submit/></default-field></field><field-layout><field-row-big><field-ref name="quantity"/><field-ref name="scanInput"/><field-ref name="shipmentPackageSeqId"/><field-ref name="packButton"/></field-row-big></field-layout></form-single></widgets></section><section name="PickScanSection" condition="isOutgoing && shipment.statusId in ['ShipInput', 'ShipScheduled']"><actions><entity-find-one entity-name="mantle.product.asset.Container" value-field="pickContainer"><field-map field-name="containerId" from="shipment.pickContainerId"/></entity-find-one></actions><widgets><form-single name="PickScanForm" transition="pickMoveShipmentProduct"><field name="shipmentId"><default-field><hidden/></default-field></field><field name="quantity" from="1"><default-field><text-line size="4"/></default-field></field><field name="scanProduct"><default-field title="Product"><text-line size="20"/></default-field></field><field name="scanLocation"><default-field title="From Location"><text-line size="20"/></default-field></field><field name="pickButton"><default-field title=""><submit text="Pick${pickContainer ? ' and Move to Container ' + (pickContainer.serialNumber ?: pickContainer.containerId) : ''}"/></default-field></field><field-layout><field-row-big><field-ref name="quantity"/><field-ref name="scanProduct"/><field-ref name="scanLocation"/><field-ref name="pickButton"/></field-row-big></field-layout></form-single></widgets></section><section-include name="StatusHistorySection" location="component://SimpleScreens/template/basic/StatusWidgets.xml"/><section name="CustomerNotesSection" condition="isOutgoing"><actions><entity-find entity-name="mantle.party.PartyNote" list="customerNoteList"><econdition field-name="partyId" from="shipment.toPartyId"/><order-by field-name="-noteDate"/></entity-find></actions><widgets><section name="CustomerNotesInner" condition="customerNoteList"><widgets><container-box type="danger"><box-header title="Customer Notes"/><box-body><section-iterate name="CustomerNoteIterate" list="customerNoteList" entry="partyNote"><actions><entity-find-one entity-name="mantle.party.PersonWithUserAccount" value-field="paua"><field-map field-name="userId" from="partyNote.userId"/></entity-find-one></actions><widgets><label text="By ${paua?.firstName?:''} ${paua?.lastName?:''} (${paua?.username ?: partyNote.userId}) at ${ec.l10n.format(partyNote.noteDate, 'yyyy-MM-dd HH:mm')}" type="strong"/><label text="${partyNote.noteText}" type="p"/></widgets></section-iterate></box-body></container-box></widgets></section></widgets></section><section name="OrderNotesSection" condition="orderNoteList"><widgets><container-box type="danger"><box-header title="Order Notes"/><box-body><section-iterate name="NoteIterateSection" list="orderNoteList" entry="note"><actions><entity-find-one entity-name="mantle.party.PersonWithUserAccount" value-field="paua"><field-map field-name="userId" from="note.userId"/></entity-find-one></actions><widgets><label text="By ${paua?.firstName?:''} ${paua?.lastName?:''} (${paua?.username ?: note.userId}) at ${ec.l10n.format(note.noteDate, 'yyyy-MM-dd HH:mm')}" type="strong"/><label text="${note.noteText}" type="p"/></widgets></section-iterate></box-body></container-box></widgets></section><container-box><box-header title="Payments"/><box-body-nopad><form-list name="ShipmentOrderPaymentList" list="shipmentPaymentList"><entity-find entity-name="mantle.shipment.ShipmentOrderPayment" list="shipmentPaymentList" distinct="true"><econdition field-name="shipmentId"/><select-field field-name="orderId,paymentId,paymentInstrumentEnumId,statusId,paymentRefNum,amountUomId"/><order-by field-name="orderId,paymentId"/></entity-find><field name="orderId"><default-field title="Order"><link url="orderDetail" text="${orderId}" link-type="anchor"/></default-field></field><field name="paymentId"><default-field title="Payment"><link url="editPayment" text="${paymentId}" link-type="anchor"/></default-field></field><field name="amount"><default-field title="Amount"><display currency-unit-field="amountUomId"/></default-field></field><field name="paymentInstrumentEnumId"><default-field title="Instrument"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="statusId"><default-field title="Status" container-style="strong ${statusId in ['PmntDelivered','PmntConfirmed'] ? 'text-success' : 'text-danger'}"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="paymentRefNum" from="payment?.paymentRefNum"><default-field title="Ref"><display/></default-field></field></form-list><form-list name="ShipmentInvoicePaymentList" list="shipmentPaymentList"><entity-find entity-name="mantle.shipment.ShipmentInvoicePayment" list="shipmentPaymentList" distinct="true"><econdition field-name="shipmentId"/><select-field field-name="invoiceId,paymentId,amountApplied,appliedDate,paymentInstrumentEnumId,statusId,paymentRefNum,amountUomId"/><order-by field-name="invoiceId,paymentId"/></entity-find><field name="invoiceId"><default-field title="Invoice"><link url="editInvoice" text="${invoiceId}" link-type="anchor"/></default-field></field><field name="paymentId"><default-field title="Payment"><link url="editPayment" text="${paymentId}" link-type="anchor"/></default-field></field><field name="amountApplied"><default-field title="Amount"><display currency-unit-field="amountUomId"/></default-field></field><field name="appliedDate"><default-field title="Applied"><display/></default-field></field><field name="paymentInstrumentEnumId"><default-field title="Instrument"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="statusId"><default-field title="Status" container-style="strong ${statusId in ['PmntDelivered','PmntConfirmed'] ? 'text-success' : 'text-danger'}"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="paymentRefNum" from="payment?.paymentRefNum"><default-field title="Ref"><display/></default-field></field></form-list></box-body-nopad></container-box><container-box><box-header title="Parties"/><box-toolbar><container-dialog id="AddPartyDialog" button-text="Add Party"><form-single name="AddParty" transition="createShipmentParty"><field name="shipmentId"><default-field><hidden/></default-field></field><field name="partyId"><default-field title="Party"><drop-down><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="roleTypeId"><default-field title="Role"><drop-down><entity-options key="${roleTypeId}" text="${description}"><entity-find entity-name="mantle.party.RoleGroupMemberAndType" cache="true"><econdition field-name="roleGroupEnumId" value="RgpShipment"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="submitBtn"><default-field><submit text="Add"/></default-field></field></form-single></container-dialog></box-toolbar><box-body-nopad><form-list name="RolesForm" list="shipmentPartyList" transition="deleteShipmentParty" skip-header="true"><entity-find entity-name="mantle.shipment.ShipmentParty" list="shipmentPartyList"><econdition field-name="shipmentId"/><order-by field-name="roleTypeId,partyId"/></entity-find><field name="shipmentId"><default-field><hidden/></default-field></field><field name="roleTypeId"><default-field title="Role"><display-entity entity-name="mantle.party.RoleType"/></default-field></field><field name="partyId"><default-field title="Party"><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameTemplate"/></default-field></field><field name="submitButton"><default-field title=""><submit icon="fa fa-trash" confirmation="Remove Party from Shipment?"/></default-field></field></form-list></box-body-nopad></container-box><container-box><box-header title="Content"/><box-toolbar><container-dialog id="NewContentDialog" button-text="Add Content"><form-single name="NewContentForm" transition="createContent"><field name="shipmentId"><default-field><hidden/></default-field></field><field name="contentFile"><default-field><file/></default-field></field><field name="description"><default-field><text-line size="60"/></default-field></field><field name="submitButton"><default-field title="Add Attachment"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><section-iterate name="ContentIterateSection" list="contentList" entry="content"><actions><entity-find-one entity-name="mantle.party.PersonWithUserAccount" value-field="paua"><field-map field-name="userId" from="content.userId"/></entity-find-one></actions><widgets><container><link url="downloadContent" condition="content.contentLocation" parameter-map="[shipmentContentId:content.shipmentContentId]" text="Download ${content.contentLocation.substring(content.contentLocation.lastIndexOf('/')+1)}"/><container-dialog id="UpdateContentContainer" button-text="Edit Attachment"><form-single name="UpdateContentForm" transition="updateContent" map="content"><field name="shipmentContentId"><default-field><hidden/></default-field></field><field name="shipmentId"><default-field><hidden/></default-field></field><field name="contentFile"><default-field><file/></default-field></field><field name="description"><default-field><text-line size="60"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></container-dialog><container><label text="By ${paua?.firstName?:''} ${paua?.lastName?:''} (${paua?.username ?: content.userId}) at ${ec.l10n.format(content.contentDate, 'yyyy-MM-dd HH:mm')}"/></container><label text="${content.description ?: 'No Description'}" type="p"/></container></widgets></section-iterate></box-body></container-box><section name="EmailMessageSection"><widgets><container-box><box-header title="Email Messages"/><box-toolbar><section name="SendPlacedEmailSection" condition="shipment.statusId in ['ShipPacked', 'ShipShipped', 'ShipDelivered']"><actions><if condition="shipment.toPartyId"><service-call name="mantle.party.ContactServices.get#PartyContactInfo" out-map="emailInfo" in-map="[partyId:shipment.toPartyId, emailContactMechPurposeId:'EmailShippingDest', defaultToPrimaryPurpose:true]"/><set field="toAddresses" from="emailInfo.emailAddress"/></if></actions><widgets><container-dialog id="SendPlacedEmailDialog" button-text="Send Email"><form-single name="SendPlacedEmailForm" transition="sendShipmentStoreEmail"><field name="shipmentId"><default-field><hidden/></default-field></field><field name="forceByType"><default-field><hidden default-value="true"/></default-field></field><field name="emailTypeEnumId" from="'PsetShipmentShipped'"><default-field><hidden/></default-field></field><field name="toAddresses"><default-field title="To Address"><text-line size="40"/></default-field></field><field name="submitButton"><default-field title="Send Email"><submit/></default-field></field></form-single></container-dialog></widgets></section></box-toolbar><box-body><form-list name="EmailMessageList" list="emailMessageList" skip-form="true"><entity-find entity-name="mantle.shipment.ShipmentEmailMessageDetail" list="emailMessageList"><econdition field-name="shipmentId"/><order-by field-name="sentDate,emailMessageId"/></entity-find><field name="emailMessageId"><default-field title="ID"><link url="EmailMessage" text="${emailMessageId}" link-type="anchor" target-window="_blank"/></default-field></field><field name="sentDate"><default-field><display/></default-field></field><field name="toAddresses"><default-field><display/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="receivedDate"><default-field><display/></default-field></field><field name="emailTypeEnumId"><default-field title="Email Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="sendLink"><default-field title=""><link url="sendEmailMessage" text="Send" parameter-map="[emailMessageId:emailMessageId]" condition="!(statusId in ['ES_DRAFT', 'ES_CANCELLED'])" confirmation="Send this email message?"/></default-field></field></form-list></box-body></container-box></widgets></section><section name="AssemblyInfoSection" condition="shipment.assemblyWorkEffortId"><widgets><container-box type="${assemblyWorkEffort.statusId == 'WeComplete' ? 'success' : 'danger'}"><box-header title="Assembly Task ${shipment.assemblyWorkEffortId}"/><box-toolbar><container-dialog id="ProduceAssembliesDialog" button-text="Produce" condition="assemblyAssetInfo?.componentIssuedAvailable"><form-single name="ProduceAssembliesForm" transition="produceAvailableAssemblies"><field name="shipmentId"><default-field><hidden/></default-field></field><field name="workEffortId" from="shipment.assemblyWorkEffortId"><default-field><hidden/></default-field></field><field name="receivedDate" from="ec.user.nowTimestamp"><default-field title="Pack Date"><date-time/></default-field></field><field name="submitButton"><default-field title="Produce and Pack Available Assemblies"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body-nopad><form-list name="AssemblyProduceProducts" list="assemblyAssetInfo.produceWepList" skip-form="true"><row-actions><set field="assemblyReceived" from="assemblyAssetInfo.assemblyReceivedByProduct.get(productId) ?: 0.0"/></row-actions><field name="productId"><default-field title="Assembly Product"><display-entity entity-name="mantle.product.Product" text="ProductNameTemplate"/></default-field></field><field name="estimatedQuantity"><default-field title="Total"><display/></default-field></field><field name="assemblyReceived"><default-field title="Completed"><display style="text-strong ${assemblyReceived >= estimatedQuantity ? 'text-success' : 'text-danger'}"/></default-field></field></form-list><form-list name="AssemblyConsumeProducts" list="assemblyAssetInfo.consumeWepList" skip-form="true"><row-actions><set field="componentIssued" from="assemblyAssetInfo.componentIssuedQtyByProduct.get(productId) ?: 0.0"/><set field="componentUsed" from="assemblyAssetInfo.componentUsedQtyByProduct.get(productId) ?: 0.0"/><set field="componentAvailable" from="assemblyAssetInfo.componentIssuedAvailable.get(productId) ?: 0.0"/></row-actions><field name="productId"><default-field title="Component Product"><display-entity entity-name="mantle.product.Product" text="ProductNameTemplate"/></default-field></field><field name="estimatedQuantity"><default-field title="Total"><display/></default-field></field><field name="componentIssued"><default-field title="Packed"><display style="text-strong ${componentIssued >= estimatedQuantity ? 'text-success' : 'text-danger'}"/></default-field></field><field name="componentUsed"><default-field title="Used"><display style="text-strong ${componentUsed >= estimatedQuantity ? 'text-success' : 'text-danger'}"/></default-field></field><field name="componentAvailable"><default-field title="Unused"><display style="text-strong ${componentAvailable == 0.0 ? 'text-success' : 'text-danger'}"/></default-field></field></form-list></box-body-nopad></container-box></widgets></section></row-col></container-row><container-box><box-header title="Shipment Items"/><box-toolbar><section name="ShipItemInputSection" condition="shipment.statusId in ['ShipInput', 'ShipScheduled'] && !(shipment.shipmentTypeEnumId in ['ShpTpSalesReturn', 'ShpTpPurchaseReturn'])"><widgets><container-dialog id="AddItemContainer" button-text="Add Item"><label text="WARNING: items added this way will not be associated with an order and will not count toward order item shipped quantity." type="strong" style="text-warning"/><form-single name="AddItemForm" transition="addItem"><field name="shipmentId"><default-field><hidden/></default-field></field><field name="productId"><default-field title="Product"><drop-down><dynamic-options transition="getProductList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="quantity"><default-field><text-line size="10"/></default-field></field><field name="submitButton"><default-field title="Add Item"><submit/></default-field></field></form-single></container-dialog></widgets></section></box-toolbar><box-body><label text="Showing ${pageSize} of ${shipmentItemDetailList.size()} Items" type="strong" style="text-danger" condition="shipmentItemDetailList.size() > (pageSize as Integer)"/><link url="../ShipmentItems" text="See All ${shipmentItemDetailList.size()} Items" btn-type="success" condition="shipmentItemDetailList.size() > (pageSize as Integer)"/><section-include name="ShipmentItemsSection" location="component://SimpleScreens/screen/SimpleScreens/Shipment/ShipmentItems.xml"/></box-body></container-box><section name="ShipmentPackageSection"><widgets><container-box><box-header title="Packages##Shipment"/><box-toolbar><link url="createShipmentAutoPackages" text="Auto Packages" condition="shippingGatewayConfig?.getAutoPackageInfoName" parameter-map="[resetExisting:true]" confirmation="Remove existing packages and create new based on auto-package data?"/><link url="createPackage" text="Add Package"/></box-toolbar><box-body><label text="Showing ${pageSize} of ${shipmentPackageList.size()} Packages" type="strong" style="text-danger" condition="shipmentPackageList.size() > (pageSize as Integer)"/><link url="../ShipmentPackages" text="See All ${shipmentPackageList.size()} Packages" btn-type="success" condition="shipmentPackageList.size() > (pageSize as Integer)"/><section-include name="PackageListSection" location="component://SimpleScreens/screen/SimpleScreens/Shipment/ShipmentPackages.xml"/></box-body></container-box></widgets></section></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Shipment/ShipmentItems.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Items" default-menu-index="2"><parameter name="shipmentId" required="true"/><parameter name="filterProductId"/><parameter name="onlyRemaining"/><parameter name="pageIndex"/><transition name="orderDetail"><default-response url="//${appRoot}/Order/OrderDetail"/></transition><transition name="editInvoice"><default-response url="//${appRoot}/Accounting/Invoice/EditInvoice"/></transition><transition name="editTransaction"><default-response url="//${appRoot}/Accounting/Transaction/EditTransaction"/></transition><transition name="editProduct"><default-response url="//${appRoot}/Product/EditProduct"/></transition><transition name="assetDetail"><default-response url="//${appRoot}/Asset/AssetDetail"/></transition><transition name="packShipment"><service-call name="mantle.shipment.ShipmentServices.pack#Shipment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deliverShipment"><service-call name="mantle.shipment.ShipmentServices.deliver#Shipment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="addItem"><service-call name="mantle.shipment.ShipmentServices.create#ShipmentItem" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateItem"><service-call name="mantle.shipment.ShipmentServices.update#ShipmentItem" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="packItem"><service-call name="mantle.shipment.ShipmentServices.pack#ShipmentProduct" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="packItemSource"><service-call name="mantle.shipment.ShipmentServices.pack#ShipmentItemSource" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="packAssemblyComponent"><service-call name="mantle.shipment.ShipmentServices.pack#ShipmentAssemblyComponent" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="unpackItemIssuance"><service-call name="mantle.shipment.ShipmentServices.unpack#ShipmentItemIssuance" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="addItemToPackage"><service-call name="mantle.shipment.ShipmentServices.add#ItemToPackage" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getAssetList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><subscreens><subscreens-item name="ReceiveItem" location="component://SimpleScreens/screen/SimpleScreens/Shipment/ShipmentDetail/ReceiveItem.xml"/><subscreens-item name="UpdateItemAsset" location="component://SimpleScreens/screen/SimpleScreens/Shipment/ShipmentDetail/UpdateItemAsset.xml"/><subscreens-item name="ItemReserve" location="component://SimpleScreens/screen/SimpleScreens/Shipment/ShipmentDetail/ItemReserve.xml"/></subscreens><actions><service-call name="mantle.shipment.ShipmentInfoServices.get#ShipmentDisplayInfo" in-map="[shipmentId:shipmentId]" out-map="context"/><set field="activePackage" from="shipmentPackageList?.find({ it.weight == null || it.shipmentBoxTypeId == null })"/><set field="activePackageSeqId" from="activePackage?.shipmentPackageSeqId"/><log message="activePackageSeqId ${activePackageSeqId}"/><set field="allProductIds" from="shipmentItemDetailList*.productId"/><entity-find entity-name="mantle.product.Product" list="allProductList"><econdition field-name="productId" operator="in" from="allProductIds"/><order-by field-name="pseudoId"/></entity-find><if condition="filterProductId"><filter-map-list list="shipmentItemDetailList"><field-map field-name="productId" from="filterProductId"/></filter-map-list></if><if condition="onlyRemaining == 'Y'"><set field="tempItemDetailList" from="new ArrayList()"/><iterate list="shipmentItemDetailList" entry="sid"><if condition="isOutgoing || isTransfer"><if condition="(sid.quantity - (sid.quantityTotal ?: 0.0)) > 0.0"><script><![CDATA[tempItemDetailList.add(sid)]]></script><continue/></if></if><if condition="isIncoming || isTransfer"><if condition="(sid.quantity - (sid.quantityAcceptedTotal ?: 0.0) - (sid.quantityRejectedTotal ?: 0.0)) > 0.0"><script><![CDATA[tempItemDetailList.add(sid)]]></script><continue/></if></if></iterate><set field="shipmentItemDetailList" from="tempItemDetailList"/></if><set field="pageSize" from="pageSize ?: '10'"/></actions><widgets><container-box><box-header title="Shipment Items"/><box-toolbar><section name="PackShipmentSection" condition="!isIncoming && shipment.statusId in ['ShipScheduled', 'ShipPicked']"><widgets><container-dialog id="SetPackedDialog" button-text="Set Packed" condition="anyItemPacked" type="success"><label text="Not all items are packed, item quantities will be reduced to packed quantities." type="p" style="text-danger" condition="!allItemsPacked"/><section-iterate name="UnPackedItemMessage" list="shipmentItemDetailList" entry="sid"><actions><set field="quantityPackRemaining" from="sid.quantity - (sid.quantityTotal ?: 0)"/></actions><widgets><label text="${ec.resource.expand('ProductNameTemplate', '', sid)} - ${ec.l10n.format(sid.quantityTotal ?: 0.0, '0.##')} of ${ec.l10n.format(sid.quantity, '0.##')} packed" type="p" style="text-danger" condition="quantityPackRemaining"/></widgets></section-iterate><label text="An Invoice will be generated for this Shipment when it is Packed and the Invoice Date will be set to the Packed Date." type="p"/><section name="AssemblyPackWarnings" condition="assemblyAssetInfo?.componentIssuedAvailable"><actions><set field="componentsUnusedList" from="assemblyAssetInfo.componentIssuedAvailable.entrySet().collect({ [productId:it.key, quantity:it.value] })"/></actions><widgets><container-box type="danger"><box-header title="Remove Unused Assembly Components Before Continuing"/><box-body><label text="These items will be removed from the Assembly Task automatically, so must be removed from packages before continuing." type="strong" style="text-danger"/></box-body><box-body-nopad><form-list name="AssemblyPackUnusedComponents" list="componentsUnusedList" skip-form="true"><field name="productId"><default-field title="Component Product"><display-entity entity-name="mantle.product.Product" text="ProductNameTemplate"/></default-field></field><field name="quantity"><default-field><display style="text-strong text-danger"/></default-field></field></form-list></box-body-nopad></container-box></widgets></section><form-single name="SetPackedForm" transition="packShipment" focus-field="submitButton"><field name="shipmentId"><default-field><display/></default-field></field><field name="packedDate" from="ec.user.nowTimestamp"><default-field><date-time/></default-field></field><field name="submitButton"><default-field title="Set Packed"><submit/></default-field></field></form-single></container-dialog></widgets></section><section name="DeliverShipmentSection" condition="(anyReceived && shipment.statusId in ['ShipScheduled', 'ShipPacked', 'ShipShipped']) ||                     (isOutgoing && shipment.statusId in ['ShipPacked', 'ShipShipped'])"><widgets><container-dialog id="SetDeliveredDialog" button-text="Set Delivered"><label text="Set as Delivered and generate invoice for order items if needed?" condition="isIncoming" type="p"/><label text="Set as Delivered?" condition="isOutgoing" type="p"/><label text="Set to Delivered? No additional items may be received once Delivered." condition="isTransfer"/><label text="Not all items are received, item quantities will be reduced to received quantities." type="p" style="text-warning" condition="isIncoming && !allReceived"/><form-single name="SetDeliveredForm" transition="deliverShipment" focus-field="submitButton"><field name="shipmentId"><default-field><display/></default-field></field><field name="actualArrivalDate" from="ec.user.nowTimestamp"><default-field title="Actual Arrival"><date-time/></default-field></field><field name="submitButton"><default-field title="Set Delivered"><submit/></default-field></field></form-single></container-dialog></widgets></section><section name="ShipItemInputSection" condition="shipment.statusId in ['ShipInput', 'ShipScheduled'] && !(shipment.shipmentTypeEnumId in ['ShpTpSalesReturn', 'ShpTpPurchaseReturn'])"><widgets><container-dialog id="AddItemContainer" button-text="Add Item"><form-single name="AddItemForm" transition="addItem"><field name="shipmentId"><default-field><hidden/></default-field></field><field name="productId"><default-field title="Product"><drop-down><dynamic-options transition="getProductList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="quantity"><default-field><text-line size="10"/></default-field></field><field name="submitButton"><default-field title="Add Item"><submit confirmation="WARNING: items added this way will not be associated with an order and will not count toward order item shipped quantity."/></default-field></field></form-single></container-dialog></widgets></section></box-toolbar><box-body><form-single name="ItemsOptionsForm" transition="." pass-through-parameters="true"><field name="filterProductId"><default-field title="Product"><drop-down allow-empty="true"><list-options list="allProductList" key="${productId}" text="ProductNameTemplate"/></drop-down></default-field></field><field name="onlyRemaining"><default-field><radio no-current-selected-key="N"><option key="Y"/><option key="N"/></radio></default-field></field><field name="submitBtn"><default-field title="Filter"><submit/></default-field></field><field-layout><field-row-big><field-ref name="filterProductId"/><field-ref name="onlyRemaining"/><field-ref name="submitBtn"/></field-row-big></field-layout></form-single><section-iterate name="ShipmentItemsSection" list="shipmentItemDetailList" entry="sid" paginate="true"><actions><if condition="isOutgoing || isTransfer"><set field="quantityPackRemaining" from="sid.quantity - (sid.quantityTotal ?: 0)"/><entity-find entity-name="mantle.product.issuance.AssetAndIssuance" list="assetIssuanceList"><econdition field-name="shipmentId"/><econdition field-name="productId" from="sid.productId"/></entity-find></if><set field="allowPack" from="(isOutgoing || isTransfer) && shipment.statusId in ['ShipInput', 'ShipScheduled', 'ShipPicked'] && quantityPackRemaining > 0"/><if condition="isIncoming || isTransfer"><set field="quantityRecRemaining" from="sid.quantity - (sid.quantityAcceptedTotal ?: 0) - (sid.quantityRejectedTotal ?: 0)"/><entity-find entity-name="mantle.product.asset.AssetAndReceipt" list="assetReceiptList"><econdition field-name="shipmentId"/><econdition field-name="productId" from="sid.productId"/></entity-find></if><set field="allowReceive" from="((isIncoming && shipment.statusId in ['ShipScheduled', 'ShipShipped']) ||                         (isTransfer && shipment.statusId == 'ShipShipped')) && quantityRecRemaining > 0"/><entity-find-one entity-name="moqui.basic.Uom" value-field="productUom"><field-map field-name="uomId" from="sid.amountUomId"/></entity-find-one><entity-find entity-name="mantle.shipment.ShipmentItemSource" list="sisList"><econdition field-name="shipmentId"/><econdition field-name="productId" from="sid.productId"/></entity-find><entity-find-one entity-name="mantle.product.Product" value-field="product" cache="true"><field-map field-name="productId" from="sid.productId"/></entity-find-one><entity-find entity-name="mantle.shipment.ShipmentPackageContent" list="packageContentList"><econdition field-name="shipmentId"/><econdition field-name="productId" from="sid.productId"/></entity-find><set field="packageContentTotal" from="(packageContentList*.quantity).sum() ?: 0.0"/><set field="quantityNotInPackage" from="((BigDecimal) sid.quantity ?: 0.0) - packageContentTotal"/></actions><widgets><container-box type="info"><box-header title="${ec.resource.expand('ProductNameTemplate', '', sid)} (Qty ${ec.l10n.format(sid.quantity ?: 0, '#.##')})"/><box-toolbar><section name="PackItemSection" condition="allowPack"><widgets><container-dialog id="PackItemContainer" button-text="Pack/Issue Item" type="success"><form-single name="PackItemForm" transition="packItem" map="sid" pass-through-parameters="true"><field name="shipmentId"><default-field><hidden/></default-field></field><field name="filterProductId"><default-field><hidden/></default-field></field><field name="onlyRemaining"><default-field><hidden/></default-field></field><field name="pageIndex"><default-field><hidden/></default-field></field><field name="productId"><default-field title="Product"><display-entity entity-name="mantle.product.Product" text="ProductNameTemplate"/></default-field></field><field name="shipmentPackageSeqId" from="activePackageSeqId"><default-field title="Package##Shipment"><drop-down><option key="" text="New Package"/><list-options list="shipmentPackageList" key="${shipmentPackageSeqId}" text="${shipmentPackageSeqId}"/></drop-down></default-field></field><field name="quantity" from="quantityPackRemaining"><default-field><text-line size="8"/></default-field></field><field name="packDate" from="shipment.estimatedShipDate ?: ec.user.nowTimestamp"><default-field title="Pack Date"><date-time/></default-field></field><field name="assetId"><default-field title="Asset"><drop-down><dynamic-options transition="getAssetList" server-search="true" min-length="0" parameter-map="[facilityId:firstRouteSegment.originFacilityId, productId:productId,                                                 assetTypeEnumId:null, ownerPartyId:null, excludeZeroQoh:'true']"/></drop-down></default-field></field><field name="submitButton"><default-field title="Pack Quantity"><submit/></default-field></field></form-single></container-dialog><section name="PackComponentsSection" condition="product.productTypeEnumId == 'PtPickAssembly'"><actions><entity-find entity-name="mantle.product.ProductAssoc" list="bomAssocList"><date-filter/><econdition field-name="productId" from="product.productId"/><econdition field-name="productAssocTypeEnumId" value="PatMfgBom"/></entity-find><if condition="shipment.assemblyWorkEffortId"><entity-find entity-name="mantle.product.issuance.AssetIssuance" list="issuanceList"><econdition field-name="workEffortId" from="shipment.assemblyWorkEffortId"/></entity-find><set field="componentIssuedQtyByProduct" from="[:]"/><iterate list="issuanceList" entry="weIssuance"><script><![CDATA[addToBigDecimalInMap(weIssuance.productId, weIssuance.quantity, componentIssuedQtyByProduct)]]></script></iterate></if></actions><widgets><container-dialog id="PackComponentsContainer" button-text="Pack/Issue Assembly Components" type="success" width="960"><form-list name="PackComponentsForm" list="bomAssocList" list-entry="bomAssoc" transition="packAssemblyComponent"><row-actions><set field="componentQtyRemaining" from="(quantityPackRemaining ?: 0.0) * (bomAssoc.quantity ?: 1.0)"/><set field="componentQtyAdjusted" from="componentQtyRemaining - (componentIssuedQtyByProduct?.get(bomAssoc.toProductId) ?: 0.0)"/><if condition="componentQtyAdjusted < 0.0"><set field="componentQtyAdjusted" from="0.0"/></if></row-actions><hidden-parameters><parameter name="shipmentId"/><parameter name="assemblyProductId" from="product.productId"/><parameter name="filterProductId"/><parameter name="onlyRemaining"/><parameter name="pageIndex"/></hidden-parameters><field name="productId" from="bomAssoc.toProductId"><default-field title="Component Product"><display-entity entity-name="mantle.product.Product" text="ProductNameTemplate"/></default-field></field><field name="bomQuantity" from="(bomAssoc.quantity ?: 1.0)"><default-field title="BOM Quantity"><display/></default-field></field><field name="shipmentPackageSeqId" from="activePackageSeqId"><default-field title="Package##Shipment"><drop-down><option key="" text="New Package"/><list-options list="shipmentPackageList" key="${shipmentPackageSeqId}" text="${shipmentPackageSeqId}"/></drop-down></default-field></field><field name="quantity" from="componentQtyAdjusted"><default-field title="Pack Quantity"><text-line size="8"/></default-field></field><field name="packDate" from="shipment.estimatedShipDate ?: ec.user.nowTimestamp"><default-field title="Pack Date"><date-time/></default-field></field><field name="assetId"><default-field title="Asset"><drop-down><dynamic-options transition="getAssetList" server-search="true" min-length="0" parameter-map="[facilityId:firstRouteSegment.originFacilityId, productId:bomAssoc.toProductId,                                                 assetTypeEnumId:null, ownerPartyId:null, excludeZeroQoh:'true']"/></drop-down></default-field></field><field name="submitButton"><default-field title="Pack"><submit/></default-field></field><columns><column><field-ref name="productId"/><field-ref name="shipmentPackageSeqId"/></column><column><field-ref name="bomQuantity"/><field-ref name="quantity"/></column><column><field-ref name="packDate"/><field-ref name="assetId"/></column><column><field-ref name="submitButton"/></column></columns></form-list></container-dialog></widgets></section></widgets></section><section name="ReceiveItemSection" condition="allowReceive"><widgets><dynamic-dialog id="ReceiveProductContainer" button-text="Receive Product" transition="ReceiveItem" width="800" type="success"><parameter name="shipmentId"/><parameter name="productId" from="sid.productId"/><parameter name="statusId" value="AstAvailable"/></dynamic-dialog></widgets></section></box-toolbar><box-body><container-row><row-col lg="5"><label condition="isOutgoing || isTransfer" text="Packed/Issued: ${ec.l10n.format(sid.quantityTotal ?: 0, '#.##')}, Remaining: ${ec.l10n.format(quantityPackRemaining, '#.##')}  (Unit: ${productUom?.description ?: 'N/A'})" type="div"/><label condition="isIncoming || isTransfer" text="Receive Accepted: ${ec.l10n.format(sid.quantityAcceptedTotal ?: 0, '#.##')}, Rejected: ${ec.l10n.format(sid.quantityRejectedTotal ?: 0, '#.##')}, Remaining: ${ec.l10n.format(quantityRecRemaining, '#.##')}  (Unit: ${productUom?.description ?: 'N/A'})" type="div"/></row-col><row-col lg="3"><section name="ShipItemUpdateSection" condition="allowUpdate"><widgets><form-single name="UpdateItemForm" transition="updateItem" map="sid" pass-through-parameters="true"><field name="shipmentId"><default-field><hidden/></default-field></field><field name="productId"><default-field><hidden/></default-field></field><field name="filterProductId"><default-field><hidden/></default-field></field><field name="onlyRemaining"><default-field><hidden/></default-field></field><field name="pageIndex"><default-field><hidden/></default-field></field><field name="quantity"><default-field title=""><text-line size="6"/></default-field></field><field name="submitButton"><default-field title="Update Quantity"><submit/></default-field></field><field-layout><field-row-big><field-ref name="quantity"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single></widgets></section></row-col><row-col lg="4"><section name="ShipItemPackageSection" condition="quantityNotInPackage"><widgets><form-single name="AddItemToPackageForm" transition="addItemToPackage" map="sid" pass-through-parameters="true"><field name="shipmentId"><default-field><hidden/></default-field></field><field name="productId"><default-field><hidden/></default-field></field><field name="filterProductId"><default-field><hidden/></default-field></field><field name="onlyRemaining"><default-field><hidden/></default-field></field><field name="pageIndex"><default-field><hidden/></default-field></field><field name="shipmentPackageSeqId" from="activePackageSeqId"><default-field title=""><drop-down><option key="" text="New"/><list-options list="shipmentPackageList" key="${shipmentPackageSeqId}" text="${shipmentPackageSeqId}"/></drop-down></default-field></field><field name="quantity" from="quantityNotInPackage"><default-field title=""><text-line size="6"/></default-field></field><field name="submitButton"><default-field title="Add to Package"><submit/></default-field></field><field-layout><field-row-big><field-ref name="shipmentPackageSeqId"/><field-ref name="quantity"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single></widgets></section></row-col></container-row></box-body><box-body-nopad><section name="ItemAssetPackSection" condition="isOutgoing || isTransfer"><widgets><form-list name="ItemSourceIssuanceList" list="sisList" transition="packItemSource"><row-actions><entity-find entity-name="mantle.product.issuance.AssetReservation" list="existingResList"><econdition field-name="orderId"/><econdition field-name="orderItemSeqId"/></entity-find><set field="resPackForm" from="allowPack && quantityNotHandled > 0.0 && existingResList && product.productTypeEnumId != 'PtPickAssembly'"/></row-actions><field name="shipmentId"><default-field><hidden/></default-field></field><field name="shipmentItemSourceId"><default-field><hidden/></default-field></field><field name="filterProductId"><default-field><hidden/></default-field></field><field name="onlyRemaining"><default-field><hidden/></default-field></field><field name="orderId"><default-field title="Order Item"><link url="orderDetail" text="${orderId?:''}:${orderItemSeqId?:''}" link-type="anchor" condition="orderId"/></default-field></field><field name="quantitySis" from="quantity"><default-field title="Quantity"><display/></default-field></field><field name="quantityPicked"><default-field title="Picked"><display/></default-field></field><field name="quantityIssued" from="(quantity ?: 0.0) - (quantityNotHandled ?: 0.0)"><default-field title="Issued"><display/></default-field></field><field name="invoiceId"><default-field title="Invoice Item"><link url="editInvoice" text="${invoiceId?:''}:${invoiceItemSeqId?:''}" link-type="anchor" condition="invoiceId"/></default-field></field><field name="assetReservations"><conditional-field condition="existingResList"><section-iterate name="ReservationInfoSection" list="existingResList" entry="existingRes"><actions><entity-find-one entity-name="mantle.product.asset.AssetLotAndMfgParty" value-field="assetLot"><field-map field-name="assetId" from="existingRes.assetId"/></entity-find-one></actions><widgets><section name="ComponentProductSection" condition="assetLot.productId != sid.productId"><actions><entity-find-one entity-name="mantle.product.Product" value-field="componentProduct" cache="true"><field-map field-name="productId" from="assetLot.productId"/></entity-find-one></actions><widgets><container><label text="Component: " type="strong"/><link url="editProduct" text="ProductNameTemplate" text-map="componentProduct" link-type="anchor" parameter-map="[productId:componentProduct.productId]"/></container></widgets></section><container><label text="Res: ${ec.l10n.format(existingRes.quantity, null)}, Not Avail: ${ec.l10n.format(existingRes.quantityNotAvailable, null)}, Not Issued: ${ec.l10n.format(existingRes.quantityNotIssued, null)}" type="span" style="${existingRes.quantityNotAvailable ? 'text-danger' : ''}"/><link url="assetDetail" text="Asset ${existingRes.assetId}" parameter-map="[assetId:existingRes.assetId]" link-type="anchor"/></container><label text="LotNameTemplate" text-map="assetLot" condition="assetLot?.lotId"/></widgets></section-iterate></conditional-field><default-field><display text=" "/></default-field></field><field name="reserveItem"><conditional-field condition="orderId" title=""><dynamic-dialog id="ItemReserveDialog" button-text="Reserve" transition="ItemReserve" width="960" condition="quantityNotHandled > 0.0"/></conditional-field></field><field name="packDate" from="shipment.estimatedShipDate ?: ec.user.nowTimestamp"><conditional-field condition="resPackForm" title="Pack Date"><date-time/></conditional-field><default-field title="Pack Date"><display text=" "/></default-field></field><field name="shipmentPackageSeqId" from="activePackageSeqId"><conditional-field condition="resPackForm" title="Package##Shipment"><drop-down><option key="" text="New"/><list-options list="shipmentPackageList" key="${shipmentPackageSeqId}" text="${shipmentPackageSeqId}"/></drop-down></conditional-field><default-field title="Package##Shipment"><display text=" "/></default-field></field><field name="quantity" from="quantityNotHandled"><conditional-field condition="resPackForm" title="Pack Quantity"><text-line size="6"/></conditional-field><default-field title="Pack Quantity"><display text=" "/></default-field></field><field name="packButton"><conditional-field condition="resPackForm" title="Issue & Pack"><submit/></conditional-field><default-field title=""><display text=" "/></default-field></field></form-list><section-iterate name="PaReservedComponentPack" list="sisList" entry="sis" condition="allowPack && sis.quantityNotHandled && product.productTypeEnumId == 'PtPickAssembly'"><actions><entity-find entity-name="mantle.product.issuance.AssetReservationSummary" list="existingResSumList"><econdition field-name="orderId" from="sis.orderId"/><econdition field-name="orderItemSeqId" from="sis.orderItemSeqId"/><select-field field-name="productId,quantity,quantityNotIssued"/></entity-find></actions><widgets><form-list name="PaComponentPackForm" list="existingResSumList" transition="packAssemblyComponent"><hidden-parameters><parameter name="shipmentId"/><parameter name="assemblyProductId" from="product.productId"/><parameter name="filterProductId"/><parameter name="onlyRemaining"/><parameter name="pageIndex"/></hidden-parameters><field name="productId"><default-field title="Component"><display-entity entity-name="mantle.product.Product" text="ProductNameTemplate"/></default-field></field><field name="packDate" from="shipment.estimatedShipDate ?: ec.user.nowTimestamp"><default-field title="Pack Date"><date-time/></default-field></field><field name="shipmentPackageSeqId" from="activePackageSeqId"><default-field title="Package##Shipment"><drop-down><option key="" text="New"/><list-options list="shipmentPackageList" key="${shipmentPackageSeqId}" text="${shipmentPackageSeqId}"/></drop-down></default-field></field><field name="quantity" from="quantityNotIssued"><default-field title="Pack Quantity"><text-line size="6"/></default-field></field><field name="packButton"><default-field title="Issue & Pack Component"><submit/></default-field></field></form-list></widgets></section-iterate><form-list name="ItemAssetIssuanceList" list="assetIssuanceList" skip-form="true"><row-actions><entity-find-one entity-name="mantle.facility.FacilityLocation" value-field="facLoc"/><entity-find-one entity-name="mantle.product.issuance.AssetReservation" value-field="res"/><filter-map-list list="acctgTransList" to-list="issAcctgTransList"><field-map field-name="assetIssuanceId"/></filter-map-list></row-actions><field name="assetIssuanceId"><default-field title="Issuance"><display/></default-field></field><field name="issuedDate"><default-field title="Issued Date"><display/></default-field></field><field name="quantity"><default-field title="Quantity"><display/></default-field></field><field name="assetId"><default-field><link url="assetDetail" text="${assetId}" link-type="anchor"/></default-field></field><field name="assetReservationId"><conditional-field condition="res"><display text="${assetReservationId} - Res: ${ec.l10n.format(res.quantity, null)}, Not Avail: ${ec.l10n.format(res.quantityNotAvailable, null)}, Not Issued: ${ec.l10n.format(res.quantityNotIssued, null)}"/></conditional-field><default-field title="Reservation"><display/></default-field></field><field name="orderId"><default-field title="Order Item"><link url="orderDetail" text="${orderId}:${orderItemSeqId?:''}" link-type="anchor" condition="orderId"/></default-field></field><field name="invoiceId"><default-field title="Invoice Item"><link url="editInvoice" text="${invoiceId?:''}:${invoiceItemSeqId?:''}" link-type="anchor" condition="invoiceId"/></default-field></field><field name="acctgTransList"><default-field title="TX"><section-iterate name="IssAcctgTransList" list="issAcctgTransList" entry="issAcctgTrans"><widgets><link url="editTransaction" text="${issAcctgTrans.acctgTransId}" link-type="anchor" parameter-map="[acctgTransId:issAcctgTrans.acctgTransId]"/></widgets></section-iterate></default-field></field><field name="locationSeqId"><default-field title="Was Stored At"><display text="FacilityLocationNameTemplate" text-map="facLoc?:[:]"/></default-field></field><field name="lotId"><default-field title="Lot"><display-entity entity-name="mantle.product.asset.LotAndMfgParty" text="LotNameTemplate"/></default-field></field><field name="unpackLink"><default-field title=""><link url="unpackItemIssuance" text="Unpack" parameter-map="[shipmentId:shipmentId, assetIssuanceId:assetIssuanceId, filterProductId:filterProductId, onlyRemaining:onlyRemaining]" condition="!invoiceId && quantity" confirmation="Are you sure? Only do this when necessary to avoid processing a return to receive the item back into inventory."/></default-field></field></form-list></widgets></section><section name="ItemAssetReceiptSection" condition="isIncoming || isTransfer"><widgets><form-list name="ItemSourceReceiptList" list="sisList" skip-form="true"><row-actions><if condition="isTransfer"><set field="quantityNotHandled" from="quantity"/><entity-find entity-name="mantle.product.receipt.AssetReceipt" list="assetReceiptList"><econdition field-name="shipmentItemSourceId"/></entity-find><iterate list="assetReceiptList" entry="assetReceipt"><set field="quantityNotHandled" from="quantityNotHandled - (assetReceipt.quantityAccepted ?: 0.0) - (assetReceipt.quantityRejected ?: 0.0)"/></iterate></if></row-actions><field name="orderId"><default-field title="Order"><link url="orderDetail" text="${orderId?:''}" link-type="anchor"/></default-field></field><field name="orderItemSeqId"><default-field title="Item"><display/></default-field></field><field name="quantity"><default-field><display/></default-field></field><field name="quantityNotHandled"><default-field><display/></default-field></field><field name="invoiceId"><default-field title="Invoice"><link url="editInvoice" text="${invoiceId?:''}" link-type="anchor"/></default-field></field><field name="invoiceItemSeqId"><default-field title="Item"><display/></default-field></field></form-list><form-list name="ItemAssetReceiptList" list="assetReceiptList" skip-form="true"><row-actions><entity-find-one entity-name="mantle.facility.FacilityLocation" value-field="facLoc"/><filter-map-list list="acctgTransList" to-list="recAcctgTransList"><field-map field-name="assetReceiptId"/></filter-map-list></row-actions><field name="statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="receivedDate"><default-field title="Received Date"><display/></default-field></field><field name="quantityOnHandTotal" align="right"><default-field title="QOH"><display/></default-field></field><field name="quantityAccepted" align="right"><default-field title="Accepted"><display/></default-field></field><field name="quantityRejected" align="right"><default-field title="Rejected"><display/></default-field></field><field name="assetId"><default-field title="Asset"><link url="assetDetail" text="${assetId}" link-type="anchor"/></default-field></field><field name="orderId"><default-field title="Order"><link url="orderDetail" text="${orderId}" link-type="anchor"/></default-field></field><field name="orderItemSeqId"><default-field title="Item"><display/></default-field></field><field name="acctgTransList"><default-field title="TX"><section-iterate name="RecAcctgTransList" list="recAcctgTransList" entry="recAcctgTrans"><widgets><link url="editTransaction" text="${recAcctgTrans.acctgTransId}" link-type="anchor" parameter-map="[acctgTransId:recAcctgTrans.acctgTransId]"/></widgets></section-iterate></default-field></field><field name="locationSeqId"><default-field title="Stored At"><display text="FacilityLocationNameTemplate" text-map="facLoc?:[:]"/></default-field></field><field name="lotId"><default-field title="Lot"><display-entity entity-name="mantle.product.asset.LotAndMfgParty" text="LotNameTemplate"/></default-field></field><field name="serialNumber"><default-field title="Ser. #"><display/></default-field></field><field name="updateDialog"><header-field title=""/><conditional-field condition="shipment.statusId == 'ShipInput'"><dynamic-dialog id="UpdateAssetCntr" button-text="Update" transition="UpdateItemAsset" width="800"><parameter name="shipmentId"/><parameter name="assetId"/><parameter name="statusId" value="AstIncoming"/></dynamic-dialog></conditional-field><conditional-field condition="statusId == 'AstIncoming'"><dynamic-dialog id="UpdateAssetCntr" button-text="Receive" transition="UpdateItemAsset" width="800"><parameter name="shipmentId"/><parameter name="assetId"/><parameter name="statusId" value="AstAvailable"/></dynamic-dialog></conditional-field><default-field><dynamic-dialog id="UpdateAssetCntr" button-text="Update" transition="UpdateItemAsset" width="800"><parameter name="shipmentId"/><parameter name="assetId"/></dynamic-dialog></default-field></field></form-list></widgets></section></box-body-nopad></container-box></widgets></section-iterate></box-body></container-box></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Shipment/ShipmentPackages.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Packages" default-menu-index="3"><parameter name="shipmentId" required="true"/><parameter name="filterProductId"/><parameter name="pageIndex"/><transition name="shipShipment"><service-call name="mantle.shipment.ShipmentServices.ship#Shipment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createPackage"><service-call name="mantle.shipment.ShipmentServices.create#ShipmentPackage" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="resetShipmentPackage"><service-call name="mantle.shipment.ShipmentServices.reset#ShipmentPackage" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deletePackage"><service-call name="mantle.shipment.ShipmentServices.delete#ShipmentPackage" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updatePackageAndRouteSeg"><service-call name="mantle.shipment.ShipmentServices.update#ShipmentPackageAndRouteSeg" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updatePackageContent"><service-call name="mantle.shipment.ShipmentServices.update#ShipmentPackageContent" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createShipmentAutoPackages"><service-call name="mantle.shipment.ShipmentServices.create#ShipmentAutoPackages" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="requestShipmentLabels"><service-call name="mantle.shipment.CarrierServices.request#ShipmentLabels" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="refundShipmentLabels"><service-call name="mantle.shipment.CarrierServices.refund#ShipmentLabels" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="trackShipmentLabels"><service-call name="mantle.shipment.CarrierServices.track#ShipmentLabels" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="removeShipmentLabelInfo"><service-call name="mantle.shipment.CarrierServices.remove#ShipmentLabelInfo" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="removeShipmentReturnLabelInfo"><service-call name="mantle.shipment.CarrierServices.remove#ShipmentReturnLabelInfo" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="printShipmentLabels"><service-call name="mantle.shipment.ShipmentServices.print#ShipmentLabels" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getPackageWeight" location="component://SimpleScreens/template/shipment/ShipmentTransitions.xml"/><transition-include name="getShipmentLabel" location="component://SimpleScreens/template/shipment/ShipmentTransitions.xml"/><actions><set field="pageSize" from="pageSize ?: '10'"/><service-call name="mantle.shipment.ShipmentInfoServices.get#ShipmentDisplayInfo" in-map="[shipmentId:shipmentId]" out-map="context"/><set field="filteredShipmentPackageList" from="shipmentPackageList"/><if condition="filterProductId"><filter-map-list list="allShipmentPackageContentList" to-list="filteredShipmentPackageContentList"><field-map field-name="productId" from="filterProductId"/></filter-map-list><set field="shipmentPackageSeqIdSet" from="new HashSet(filteredShipmentPackageContentList*.shipmentPackageSeqId)"/><set field="filteredShipmentPackageList" from="shipmentPackageList.findAll({ shipmentPackageSeqIdSet.contains(it.shipmentPackageSeqId) })"/></if><set field="allProductIds" from="shipmentItemDetailList*.productId"/><entity-find entity-name="mantle.product.Product" list="allProductList"><econdition field-name="productId" operator="in" from="allProductIds"/><order-by field-name="pseudoId"/></entity-find><entity-find entity-name="mantle.facility.FacilityBoxTypeDetail" list="boxTypeList"><econdition field-name="facilityId" from="firstRouteSegment.originFacilityId"/><order-by field-name="description"/></entity-find><if condition="!boxTypeList"><entity-find entity-name="mantle.shipment.ShipmentBoxType" list="boxTypeList"><order-by field-name="description"/></entity-find></if><set field="localPrintAllLabels" from="false"/><if condition="ec.web.sessionAttributes.get('qzPackShipment' + shipmentId)"><set field="localPrintAllLabels" from="true"/><script><![CDATA[ec.web.sessionAttributes.put('qzPackShipment' + shipmentId, false)]]></script></if><set field="getShipmentLabelPath" from="sri.buildUrl('getShipmentLabel').path"/><set field="defaultNetworkPrinterId" from="ec.user.getPreference('Shipment.networkPrinterId.default')"/><entity-find entity-name="moqui.basic.print.NetworkPrinter" list="networkPrinterList"><order-by field-name="description,printerName"/></entity-find></actions><widgets><section name="ShipmentPackageSection"><widgets><container-box><box-header title="Packages##Shipment"/><box-toolbar><section name="ShipShipmentSection" condition="(isIncoming && shipment.statusId in ['ShipInput', 'ShipScheduled', 'ShipPicked', 'ShipPacked']) ||                         ((isOutgoing || isTransfer) && shipment.statusId == 'ShipPacked')"><widgets><container-dialog id="SetShippedDialog" button-text="Set Shipped" type="${isOutgoing || isTransfer ? (!hasAllTrackingCodes ? 'danger' : (!hasAllLabels ? 'warning' : 'success')) : 'primary'}"><label text="Set as Shipped? If a Shipment Shipped email is configured it will be sent to the Customer." condition="isOutgoing" style="text-success" type="p"/><container><label text="Not all packages have Labels" type="strong" style="text-warning" condition="!hasAllLabels"/></container><container><label text="Not all packages have Tracking Codes" type="strong" style="text-danger" condition="!hasAllTrackingCodes"/></container><form-single name="SetShippedForm" transition="shipShipment" focus-field="submitButton"><field name="shipmentId"><default-field><display/></default-field></field><field name="actualStartDate" from="ec.user.nowTimestamp"><default-field title="Actual Start"><date-time/></default-field></field><field name="submitButton"><default-field title="Set Shipped"><submit/></default-field></field></form-single></container-dialog></widgets></section><section name="RequestLabelsSection" condition="shippingGatewayConfigId && !hasAllLabels && (isOutgoing || isTransfer) &&                     ((shipment.statusId == 'ShipScheduled' && hasNoItems) || (shipment.statusId in ['ShipPacked', 'ShipShipped']))"><widgets><link url="requestShipmentLabels" text="Get Labels" condition="destContactMechValid"/><container-dialog id="RequestLabelsDialog" button-text="Get Labels" type="warning" condition="!destContactMechValid"><label text="Warning: destination address is incomplete or invalid according to address validation." style="text-warning"/><link url="requestShipmentLabels" text="Get Labels Anyway"/></container-dialog></widgets></section><link url="trackShipmentLabels" text="Track Labels" condition="shippingGatewayConfigId && hasAnyLabels"/><section name="PrintLabelsSection" condition="hasAnyLabels && networkPrinterList"><widgets><container-dialog id="PrintLabelsDialog" button-text="Net Print Labels"><form-single name="PrintAllShipmentLabels" transition="printShipmentLabels"><field name="shipmentId"><default-field><hidden/></default-field></field><field name="networkPrinterId" from="defaultNetworkPrinterId"><default-field title="Printer"><drop-down><list-options list="networkPrinterList" key="${networkPrinterId}" text="${description ?: printerName} (${serverHost})"/></drop-down></default-field></field><field name="makeDefaultPrinter"><default-field title="Make Default"><check><option key="true" text=" "/></check></default-field></field><field name="returnLabels"><default-field title=""><radio no-current-selected-key="false"><option key="false" text="Outgoing Labels"/><option key="true" text="Return Labels"/></radio></default-field></field><field name="submitButton"><default-field title="Submit"><submit/></default-field></field></form-single></container-dialog></widgets></section><section name="QzPrintLabelsSection" condition="hasAnyLabels"><widgets><render-mode><text type="vuet"><![CDATA[<m-script>
                        qzPrintAllLabels = function() {
                            if (!moqui.webrootVue.qzVue || !moqui.printUrlLabel) { return };
                            moqui.printUrlLabel([
                            <#list packageRouteSegList! as packageRouteSeg><#if packageRouteSeg.labelUrl?has_content>'${getShipmentLabelPath}?shipmentId=${packageRouteSeg.shipmentId}&shipmentPackageSeqId=${packageRouteSeg.shipmentPackageSeqId}&shipmentRouteSegmentSeqId=${packageRouteSeg.shipmentRouteSegmentSeqId}',</#if><#if packageRouteSeg.returnLabelUrl?has_content>'${getShipmentLabelPath}?retLabel=true&shipmentId=${packageRouteSeg.shipmentId}&shipmentPackageSeqId=${packageRouteSeg.shipmentPackageSeqId}&shipmentRouteSegmentSeqId=${packageRouteSeg.shipmentRouteSegmentSeqId}',</#if></#list>
                            ]);
                            moqui.printUrlMain([
                            <#list packageRouteSegList! as packageRouteSeg><#if packageRouteSeg.internationalInvoiceUrl?has_content>'${getShipmentLabelPath}?intlInvoiceLabel=true&shipmentId=${packageRouteSeg.shipmentId}&shipmentPackageSeqId=${packageRouteSeg.shipmentPackageSeqId}&shipmentRouteSegmentSeqId=${packageRouteSeg.shipmentRouteSegmentSeqId}',</#if><#if packageRouteSeg.returnIntlInvoiceUrl?has_content>'${getShipmentLabelPath}?retLabel=true&intlInvoiceLabel=true&shipmentId=${packageRouteSeg.shipmentId}&shipmentPackageSeqId=${packageRouteSeg.shipmentPackageSeqId}&shipmentRouteSegmentSeqId=${packageRouteSeg.shipmentRouteSegmentSeqId}',</#if></#list>
                            ]);
                        }
                        <#if localPrintAllLabels! == true>qzPrintAllLabels();</#if></m-script><button v-if="$root.qzVue" class="btn btn-default btn-sm" onclick="qzPrintAllLabels();"><i class="fa fa-print"></i> All Labels</button>]]></text></render-mode></widgets></section><link url="createShipmentAutoPackages" text="Auto Packages" condition="shippingGatewayConfig?.getAutoPackageInfoName" parameter-map="[resetExisting:true]" confirmation="Remove existing packages and create new based on auto-package data?"/><link url="createPackage" text="Add Package"/></box-toolbar><box-body><form-single name="PackageOptionsForm" transition="." pass-through-parameters="true"><field name="filterProductId"><default-field title="Product"><drop-down allow-empty="true"><list-options list="allProductList" key="${productId}" text="ProductNameTemplate"/></drop-down></default-field></field><field name="submitBtn"><default-field title="Filter"><submit/></default-field></field><field-layout><field-row-big><field-ref name="filterProductId"/><field-ref name="submitBtn"/></field-row-big></field-layout></form-single><section-iterate name="PackageListSection" list="filteredShipmentPackageList" entry="shipmentPackage" paginate="true"><actions><set field="shipmentBoxType" from="shipmentPackage.boxType"/><set field="weightUom" from="shipmentPackage.weightUom"/><set field="shipmentPackageContentList" from="allShipmentPackageContentList.findAll({ it.shipmentPackageSeqId == shipmentPackage.shipmentPackageSeqId })"/><set field="packageRouteSeg" from="packageRouteSegList.find({ it.shipmentPackageSeqId == shipmentPackage.shipmentPackageSeqId && it.shipmentRouteSegmentSeqId == firstRouteSegment.shipmentRouteSegmentSeqId })"/><set field="hasLabel" from="packageRouteSeg.gatewayLabelId || packageRouteSeg.labelImage != null || packageRouteSeg.labelUrl"/><set field="hasReturnLabel" from="packageRouteSeg.returnTrackingCode || packageRouteSeg.returnGatewayLabelId || packageRouteSeg.returnLabelImage != null || packageRouteSeg.returnLabelUrl"/><set field="trackingStatusEnum" from="packageRouteSeg?.trackingStatusEnum"/><set field="returnTrackingStatusEnum" from="packageRouteSeg?.returnTrackingStatusEnum"/><script><![CDATA[packageAndRouteSeg = new HashMap(shipmentPackage); packageAndRouteSeg.putAll(packageRouteSeg)]]></script></actions><widgets><container-box type="warning"><box-header title="Package ${shipmentPackage.shipmentPackageSeqId}"/><box-toolbar><container-dialog id="UpdatePackageDialog" button-text="Update Package"><form-single name="UpdatePackageForm" map="packageAndRouteSeg" transition="updatePackageAndRouteSeg"><field name="shipmentId"><default-field><hidden/></default-field></field><field name="shipmentPackageSeqId"><default-field><hidden/></default-field></field><field name="shipmentRouteSegmentSeqId"><default-field><hidden/></default-field></field><field name="filterProductId"><default-field><hidden/></default-field></field><field name="shipmentBoxTypeId"><default-field title="Box Type"><drop-down allow-empty="true"><list-options list="boxTypeList" key="${shipmentBoxTypeId}" text="${description}"/></drop-down></default-field></field><field name="weightUomId"><default-field title="Weight UOM"><drop-down allow-empty="true" no-current-selected-key="WT_lb"><entity-options key="${uomId}" text="${description} (${abbreviation})"><entity-find entity-name="moqui.basic.Uom"><econdition field-name="uomTypeEnumId" value="UT_WEIGHT_MEASURE"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="weight"><default-field><text-line size="8" default-transition="getPackageWeight" parameter-map="[shipmentId:shipmentId, shipmentPackageSeqId:shipmentPackageSeqId]"><depends-on field="shipmentBoxTypeId"/><depends-on field="weightUomId"/></text-line></default-field></field><field name="trackingCode"><default-field><text-line size="30"/></default-field></field><field name="estimatedAmount"><default-field title="Est. Cost"><text-line size="10"/></default-field></field><field name="returnTrackingCode"><default-field title="Return Tracking"><text-line size="30"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></container-dialog><link url="requestShipmentLabels" text="Get Label" condition="shippingGatewayConfigId && !hasLabel && (destContactMechValid || isIncoming)" parameter-map="[shipmentId:shipmentId, shipmentPackageSeqId:shipmentPackage.shipmentPackageSeqId,                                     shipmentRouteSegmentSeqId:packageRouteSeg.shipmentRouteSegmentSeqId]"/><container-dialog id="RequestPkgLabelDialog" button-text="Get Label" type="warning" condition="shippingGatewayConfigId && !hasLabel && !destContactMechValid"><label text="Warning: destination address is incomplete or invalid according to address validation." style="text-warning"/><link url="requestShipmentLabels" text="Get Label Anyway" parameter-map="[shipmentId:shipmentId, shipmentPackageSeqId:shipmentPackage.shipmentPackageSeqId,                                         shipmentRouteSegmentSeqId:packageRouteSeg.shipmentRouteSegmentSeqId]"/></container-dialog><container-dialog id="RequestRetLabelDialog" button-text="Get Return Label" condition="shippingGatewayConfigId && hasLabel && !hasReturnLabel"><form-single name="RequestRetLabel" transition="requestShipmentLabels"><field name="shipmentId"><default-field><hidden/></default-field></field><field name="filterProductId"><default-field><hidden/></default-field></field><field name="shipmentPackageSeqId" from="shipmentPackage.shipmentPackageSeqId"><default-field><hidden/></default-field></field><field name="shipmentRouteSegmentSeqId" from="packageRouteSeg.shipmentRouteSegmentSeqId"><default-field><hidden/></default-field></field><field name="getReturnLabels" from="'true'"><default-field><hidden/></default-field></field><field name="shipmentMethodEnumId" from="firstRouteSegment.shipmentMethodEnumId"><default-field title="Return By"><drop-down><entity-options key="${shipmentMethodEnumId}" text="${description}"><entity-find entity-name="mantle.shipment.carrier.CarrierShipmentMethod" list="carrierShipmentMethods"><econdition field-name="carrierPartyId" from="firstRouteSegment.carrierPartyId"/><order-by field-name="sequenceNum,description"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Get Return Label"><submit/></default-field></field></form-single></container-dialog><link url="refundShipmentLabels" text="Refund Label" btn-type="danger" confirmation="Request refund? If package has not yet shipped a refund will be processed and label will not be valid for shipping." condition="shippingGatewayConfigId && packageRouteSeg?.gatewayLabelId && !packageRouteSeg?.gatewayRefundId && packageRouteSeg?.gatewayRefundStatus != 'SUCCESS'" parameter-map="[shipmentId:shipmentId, shipmentPackageSeqId:shipmentPackage.shipmentPackageSeqId,                                     shipmentRouteSegmentSeqId:packageRouteSeg.shipmentRouteSegmentSeqId]"/><link url="removeShipmentLabelInfo" text="Reset Label" btn-type="danger" confirmation="Clear label data? This will allow getting a new label, and system keeps a history of label IDs, but otherwise current label will no longer be tracked. Use only when there are errors, etc with the label." condition="shippingGatewayConfigId && packageRouteSeg?.gatewayLabelId" parameter-map="[shipmentId:shipmentId, shipmentPackageSeqId:shipmentPackage.shipmentPackageSeqId,                                     shipmentRouteSegmentSeqId:packageRouteSeg.shipmentRouteSegmentSeqId]"/><link url="removeShipmentReturnLabelInfo" text="Reset Ret Label" btn-type="danger" confirmation="Clear return label data? This will allow getting a new label, and system keeps a history of label IDs, but otherwise current label will no longer be tracked. Use only when there are errors, etc with the label." condition="shippingGatewayConfigId && packageRouteSeg?.returnGatewayLabelId" parameter-map="[shipmentId:shipmentId, shipmentPackageSeqId:shipmentPackage.shipmentPackageSeqId,                                     shipmentRouteSegmentSeqId:packageRouteSeg.shipmentRouteSegmentSeqId]"/><link url="resetShipmentPackage" text="Reset Pkg" confirmation="Reset box type, weight, and contents?" btn-type="danger" parameter-map="[shipmentId:packageAndRouteSeg.shipmentId, shipmentPackageSeqId:packageAndRouteSeg.shipmentPackageSeqId]"/><link url="deletePackage" text="Delete" condition="!shipmentPackageContentList" btn-type="danger" confirmation="Delete package ${shipmentPackage.shipmentPackageSeqId}?" parameter-map="[shipmentId:shipmentId, shipmentPackageSeqId:shipmentPackage.shipmentPackageSeqId]"/><link url="trackShipmentLabels" text="Track" btn-type="warning" condition="shippingGatewayConfigId && packageRouteSeg?.gatewayLabelId" parameter-map="[shipmentId:shipmentId, shipmentPackageSeqId:shipmentPackage.shipmentPackageSeqId,                                     shipmentRouteSegmentSeqId:packageRouteSeg.shipmentRouteSegmentSeqId]"/><link url="${packageRouteSeg.trackingUrl}" text="Carrier Track" url-type="plain" target-window="_blank" btn-type="warning" condition="packageRouteSeg?.trackingUrl"/><link url="${packageRouteSeg.returnTrackingUrl}" text="Carrier Ret Track" url-type="plain" btn-type="info" target-window="_blank" condition="packageRouteSeg?.returnTrackingUrl"/><link url="${packageRouteSeg.labelUrl}" text="Label" url-type="plain" target-window="_blank" btn-type="info" icon="fa fa-download" condition="packageRouteSeg?.labelUrl"/><link url="getShipmentLabel" text="Label" target-window="_blank" btn-type="info" icon="fa fa-download" condition="packageRouteSeg?.labelImage" parameter-map="[shipmentId:shipmentId, shipmentPackageSeqId:packageRouteSeg.shipmentPackageSeqId, shipmentRouteSegmentSeqId:packageRouteSeg.shipmentRouteSegmentSeqId]"/><section name="QzPrintLabelSection" condition="packageRouteSeg?.labelUrl || packageRouteSeg?.labelImage"><widgets><render-mode><text type="vuet"><![CDATA[<button v-if="$root.qzVue" class="btn btn-default btn-sm" onclick="moqui.printUrlLabel('${getShipmentLabelPath}?shipmentId=${packageRouteSeg.shipmentId}&shipmentPackageSeqId=${packageRouteSeg.shipmentPackageSeqId}&shipmentRouteSegmentSeqId=${packageRouteSeg.shipmentRouteSegmentSeqId}')"><i class="fa fa-print"></i> Label</button>]]></text></render-mode></widgets></section><link url="${packageRouteSeg.internationalInvoiceUrl}" text="Com. Invoice" url-type="plain" target-window="_blank" btn-type="info" icon="fa fa-download" condition="packageRouteSeg?.internationalInvoiceUrl"/><section name="QzPrintIntlInvcSection" condition="packageRouteSeg?.internationalInvoiceUrl || packageRouteSeg?.internationalInvoice"><widgets><render-mode><text type="vuet"><![CDATA[<button v-if="$root.qzVue" class="btn btn-default btn-sm" onclick="moqui.printUrlMain('${getShipmentLabelPath}?intlInvoiceLabel=true&shipmentId=${packageRouteSeg.shipmentId}&shipmentPackageSeqId=${packageRouteSeg.shipmentPackageSeqId}&shipmentRouteSegmentSeqId=${packageRouteSeg.shipmentRouteSegmentSeqId}')"><i class="fa fa-print"></i> Com. Invoice</button>]]></text></render-mode></widgets></section><link url="${packageRouteSeg.returnLabelUrl}" text="Ret Label" url-type="plain" target-window="_blank" btn-type="info" icon="fa fa-download" condition="packageRouteSeg?.returnLabelUrl"/><link url="getShipmentLabel" text="Ret Label" target-window="_blank" btn-type="info" icon="fa fa-download" condition="packageRouteSeg?.returnLabelImage" parameter-map="[retLabel:'true', shipmentId:shipmentId, shipmentPackageSeqId:packageRouteSeg.shipmentPackageSeqId, shipmentRouteSegmentSeqId:packageRouteSeg.shipmentRouteSegmentSeqId]"/><section name="QzPrintRetLabelSection" condition="packageRouteSeg?.returnLabelUrl || packageRouteSeg?.returnLabelImage"><widgets><render-mode><text type="vuet"><![CDATA[<button v-if="$root.qzVue" class="btn btn-default btn-sm" onclick="moqui.printUrlLabel('${getShipmentLabelPath}?retLabel=true&shipmentId=${packageRouteSeg.shipmentId}&shipmentPackageSeqId=${packageRouteSeg.shipmentPackageSeqId}&shipmentRouteSegmentSeqId=${packageRouteSeg.shipmentRouteSegmentSeqId}')"><i class="fa fa-print"></i> Ret Lbl</button>]]></text></render-mode></widgets></section><link url="${packageRouteSeg.returnIntlInvoiceUrl}" text="Ret Com Invc" url-type="plain" target-window="_blank" btn-type="info" icon="fa fa-download" condition="packageRouteSeg?.returnIntlInvoiceUrl"/><section name="QzPrintRetIntlInvcSection" condition="packageRouteSeg?.returnIntlInvoiceUrl"><widgets><render-mode><text type="vuet"><![CDATA[<button v-if="$root.qzVue" class="btn btn-default btn-sm" onclick="moqui.printUrlMain('${getShipmentLabelPath}?retLabel=true&intlInvoiceLabel=true&shipmentId=${packageRouteSeg.shipmentId}&shipmentPackageSeqId=${packageRouteSeg.shipmentPackageSeqId}&shipmentRouteSegmentSeqId=${packageRouteSeg.shipmentRouteSegmentSeqId}')"><i class="fa fa-print"></i> Ret Com Invc</button>]]></text></render-mode></widgets></section><container-dialog id="PrintLabelDialog" button-text="Net Print" type="success" condition="(packageRouteSeg?.labelUrl || packageRouteSeg?.labelImage != null) && networkPrinterList"><form-single name="PrintShipmentLabel" transition="printShipmentLabels"><field name="shipmentId"><default-field><hidden/></default-field></field><field name="filterProductId"><default-field><hidden/></default-field></field><field name="shipmentPackageSeqId" from="shipmentPackage.shipmentPackageSeqId"><default-field><hidden/></default-field></field><field name="shipmentRouteSegmentSeqId" from="packageRouteSeg.shipmentRouteSegmentSeqId"><default-field><hidden/></default-field></field><field name="networkPrinterId" from="defaultNetworkPrinterId"><default-field title="Printer"><drop-down><list-options list="networkPrinterList" key="${networkPrinterId}" text="${description ?: printerName} (${serverHost})"/></drop-down></default-field></field><field name="makeDefaultPrinter"><default-field title="Make Default"><check><option key="true" text=" "/></check></default-field></field><field name="returnLabels"><default-field title=""><radio no-current-selected-key="false"><option key="false" text="Outgoing Labels"/><option key="true" text="Return Labels"/></radio></default-field></field><field name="submitButton"><default-field title="Print"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><container-row><row-col sm="1"><label text="Status" type="strong"/></row-col><row-col sm="2"><label text="${trackingStatusEnum?.description?:'N/A'}${packageRouteSeg.trackingSubStatus ? ' (' + packageRouteSeg.trackingSubStatus + ')' : ''}"/></row-col><row-col sm="1"><label text="Box" type="strong"/></row-col><row-col sm="4"><label text="${shipmentBoxType?.description?:'N/A'} - ${ec.l10n.format(shipmentPackage.weight, null)?:'N/A'} ${weightUom?.description?:''}" style="text-info"/></row-col><row-col sm="1"><label text="Tracking" type="strong"/></row-col><row-col sm="3"><label text="${packageRouteSeg?.trackingCode?:'N/A'}" type="div"/></row-col></container-row><container-row><row-col sm="1"><label text="ETA" type="strong"/></row-col><row-col sm="2"><label text="${packageRouteSeg?.trackingEta ? ec.l10n.format(packageRouteSeg.trackingEta, null) : 'N/A'}" style="${packageRouteSeg?.trackingEta <= packageRouteSeg?.trackingOrigEta ? 'text-success' : 'text-warning'}"/></row-col><row-col sm="1"><label text="Orig. ETA" type="strong"/></row-col><row-col sm="2"><label text="${packageRouteSeg?.trackingOrigEta ? ec.l10n.format(packageRouteSeg.trackingOrigEta, null) : 'N/A'}"/></row-col><row-col sm="1"><label text="Label ID" type="strong"/></row-col><row-col sm="3"><label text="${packageRouteSeg?.gatewayLabelId?:'N/A'}"/></row-col><row-col sm="1"><label text="Amount" type="strong"/></row-col><row-col sm="1"><label text="${ec.l10n.format(packageRouteSeg?.estimatedAmount, '#,##0.00')}" style="text-success"/></row-col></container-row><section name="InsuranceSection" condition="packageRouteSeg?.insuredAmount || packageRouteSeg?.insuranceAmount"><widgets><container-row><row-col sm="1"><label text="Insured Amt" type="strong"/></row-col><row-col sm="2"><label text="${ec.l10n.format(packageRouteSeg.insuredAmount, '#,##0.00')}"/></row-col><row-col sm="1"><label text="Ins. Cost" type="strong"/></row-col><row-col sm="1"><label text="${ec.l10n.format(packageRouteSeg.insuranceAmount, '#,##0.00')}"/></row-col></container-row></widgets></section><container-row><row-col sm="1"><label text="Gateway" type="strong"/></row-col><row-col sm="2"><label text="${packageRouteSeg?.gatewayStatus?:'N/A'}"/></row-col><row-col sm="1"><label text="Message" type="strong"/></row-col><row-col sm="8"><label text="${packageRouteSeg?.gatewayMessage?:'N/A'}"/></row-col></container-row><section name="LabelRefundSection" condition="packageRouteSeg?.gatewayRefundStatus"><widgets><container-row><row-col sm="1"><label text="Refund" type="strong"/></row-col><row-col sm="1"><label text="${packageRouteSeg?.gatewayRefundStatus?:'N/A'}"/></row-col><row-col sm="1"><label text="Refund ID" type="strong"/></row-col><row-col sm="3"><label text="${packageRouteSeg?.gatewayRefundId?:'N/A'}"/></row-col></container-row></widgets></section><section name="LabelReturnSection" condition="hasReturnLabel"><widgets><container-row><row-col sm="1"><label text="Ret Status" type="strong"/></row-col><row-col sm="1"><label text="${returnTrackingStatusEnum?.description?:'N/A'}"/></row-col><row-col sm="1"><label text="Ret Message" type="strong"/></row-col><row-col sm="5"><label text="${packageRouteSeg?.returnGatewayMessage?:'N/A'}"/></row-col><row-col sm="1"><label text="Ret Tracking" type="strong"/></row-col><row-col sm="3"><label text="${packageRouteSeg?.returnTrackingCode?:'N/A'}"/></row-col></container-row><container-row><row-col sm="1"><label text="Ret Label" type="strong"/></row-col><row-col sm="3"><label text="${packageRouteSeg?.returnGatewayLabelId?:'N/A'}"/></row-col><row-col sm="1"><label text="Ret Amount" type="strong"/></row-col><row-col sm="3"><label text="${ec.l10n.format(packageRouteSeg?.returnEstimatedAmount, '#,##0.00')}" style="text-success"/></row-col></container-row></widgets></section></box-body><box-body-nopad><form-list name="ShipmentPackageContentList" list="shipmentPackageContentList" transition="updatePackageContent"><field name="shipmentId"><default-field><hidden/></default-field></field><field name="shipmentPackageSeqId"><default-field><hidden/></default-field></field><field name="filterProductId"><default-field><hidden/></default-field></field><field name="productId"><default-field title="Product"><display-entity entity-name="mantle.product.Product" text="ProductNameTemplate"/></default-field></field><field name="quantity"><default-field><text-line size="6"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-list></box-body-nopad></container-box></widgets></section-iterate></box-body></container-box></widgets></section></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Shipment.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Shipments" default-menu-index="8" menu-image="/ssstatic/images/Shipping.png"><subscreens default-item="FindShipment"/><widgets><label text="Shipment ${shipmentId}" type="strong" condition="shipmentId"/><subscreens-panel id="ShipmentPanel"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Shipping/PackShipment/PackSummary/PackCompleted.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="shipmentId" required="true"/><transition name="completeShipmentPack"><service-call name="mantle.shipment.ShipmentServices.complete#ShipmentPack" in-map="true" out-map="context" multi="parameter"/><actions><if condition="localQzPrint == 'true' && !ec.getMessage().hasError()"><script><![CDATA[ec.web.sessionAttributes.put('qzPackShipment' + shipmentId, true)]]></script></if></actions><default-response url=".."/></transition><actions><entity-find-one entity-name="mantle.shipment.Shipment" value-field="shipment"/><entity-find entity-name="mantle.shipment.ShipmentRouteSegment" list="shipmentRouteSegmentList"><econdition field-name="shipmentId"/><order-by field-name="shipmentRouteSegmentSeqId"/></entity-find><set field="firstRouteSegment" from="shipmentRouteSegmentList ? shipmentRouteSegmentList.first() : null"/><set field="shippingGatewayConfigId" from="firstRouteSegment.shippingGatewayConfigId ?: ec.user.getPreference('DefaultShipmentGatewayConfigId')"/><if condition="shippingGatewayConfigId"><entity-find-one entity-name="mantle.shipment.carrier.ShippingGatewayConfig" value-field="shippingGatewayConfig"/></if><entity-find entity-name="mantle.product.store.ProductStoreSettingLookup" list="settingsLookupList" distinct="true"><date-filter/><econdition field-name="shipmentId"/><econdition field-name="settingTypeEnumId" operator="in" value="PsstGetReturnLabels,PsstShipRestrictCarriers"/><select-field field-name="productStoreId,settingTypeEnumId,settingValue"/></entity-find><set field="retLabelSettings" from="settingsLookupList.findAll({it.settingTypeEnumId == 'PsstGetReturnLabels'})*.settingValue"/><set field="defaultGetReturnLabels" from="retLabelSettings.contains('true') ? 'true' : ''"/><set field="restrictCarrierProductStoreId" from="null"/><iterate list="settingsLookupList.findAll({it.settingTypeEnumId == 'PsstShipRestrictCarriers'})" entry="restrictCarrierSetting"><if condition="restrictCarrierSetting.settingValue == 'true'"><set field="restrictCarrierProductStoreId" from="restrictCarrierSetting.productStoreId"/></if></iterate><set field="carrierPartyIdList" from="null"/><if condition="restrictCarrierProductStoreId"><entity-find entity-name="mantle.product.store.ProductStoreShippingGateway" list="storeShippingGatewayList" cache="true"><econdition field-name="productStoreId" from="restrictCarrierProductStoreId"/></entity-find><set field="carrierPartyIdList" from="storeShippingGatewayList*.carrierPartyId"/></if><service-call name="mantle.shipment.ShipmentServices.get#ShipmentShippingOptions" out-map="context" in-map="[shipmentId:shipmentId, carrierPartyIdList:carrierPartyIdList, getRates:true]"/><set field="curShipmentMethodEnumId" from="firstRouteSegment.shipmentMethodEnumId"/><set field="lowestCarrierAndShipmentMethod" from="firstRouteSegment.carrierPartyId ? firstRouteSegment.carrierPartyId + ':' + firstRouteSegment.shipmentMethodEnumId : ''"/><set field="lowestRate" from="10000.0"/><iterate list="shippingOptions" entry="shipOption"><set field="shippingTotalBd" from="shipOption.shippingTotal ? new BigDecimal(shipOption.shippingTotal) : null"/><if condition="shippingTotalBd && shippingTotalBd < lowestRate && (!curShipmentMethodEnumId || curShipmentMethodEnumId == shipOption.shipmentMethodEnumId)"><set field="lowestCarrierAndShipmentMethod" from="shipOption.carrierPartyId + ':' + shipOption.shipmentMethodEnumId"/><set field="lowestRate" from="shippingTotalBd"/></if></iterate><entity-find entity-name="moqui.basic.print.NetworkPrinter" list="networkPrinterList"><order-by field-name="description,printerName"/></entity-find><set field="defaultNetworkPrinterId" from="ec.user.getPreference('Shipment.networkPrinterId.default')"/><entity-find entity-name="mantle.shipment.ShipmentItemSourceOrderItem" list="sisOrderItemList" distinct="true"><econdition field-name="shipmentId"/><econdition field-name="orderId" operator="is-not-null"/><econdition field-name="orderPartSeqId" operator="is-not-null"/><select-field field-name="orderId,orderPartSeqId"/></entity-find><if condition="sisOrderItemList"><entity-find-one entity-name="mantle.order.OrderPart" value-field="firstOrderPart"><field-map field-name="orderId" from="sisOrderItemList[0].orderId"/><field-map field-name="orderPartSeqId" from="sisOrderItemList[0].orderPartSeqId"/></entity-find-one><if condition="firstOrderPart != null"><if condition="firstOrderPart.carrierPartyId && firstOrderPart.carrierPartyId != '_NA_'"><entity-find-one entity-name="mantle.party.PartyDetail" value-field="orderCarrierDetail" cache="true"><field-map field-name="partyId" from="firstOrderPart.carrierPartyId"/></entity-find-one></if><entity-find-one entity-name="moqui.basic.Enumeration" value-field="orderShipmentMethodEnum"><field-map field-name="enumId" from="firstOrderPart.shipmentMethodEnumId"/></entity-find-one><entity-find-one entity-name="mantle.shipment.carrier.CarrierShipmentMethod" value-field="orderCarrierShipmentMethod"><field-map field-name="carrierPartyId" from="firstOrderPart.carrierPartyId"/><field-map field-name="shipmentMethodEnumId" from="firstOrderPart.shipmentMethodEnumId"/></entity-find-one></if></if><if condition="shipment.assemblyWorkEffortId"><entity-find-one entity-name="mantle.work.effort.WorkEffort" value-field="assemblyWorkEffort"><field-map field-name="workEffortId" from="shipment.assemblyWorkEffortId"/></entity-find-one><service-call name="mantle.work.ManufacturingServices.get#ConsumedAssetRemaining" in-map="[workEffortId:shipment.assemblyWorkEffortId]" out-map="assemblyAssetInfo"/></if></actions><widgets><section-iterate name="headerErrors" list="ec.message.errors" entry="errorMessage"><widgets><label text="${errorMessage}" type="p"/></widgets></section-iterate><section-iterate name="headerValidationErrors" list="ec.message.validationErrors" entry="validationError"><widgets><label text="${validationError.message} (for field ${validationError.fieldPretty})" type="p"/></widgets></section-iterate><section name="AssemblyPackWarnings" condition="assemblyAssetInfo?.componentIssuedAvailable"><actions><set field="componentsUnusedList" from="assemblyAssetInfo.componentIssuedAvailable.entrySet().collect({ [productId:it.key, quantity:it.value] })"/></actions><widgets><container-box type="danger"><box-header title="Remove Unused Assembly Components Before Continuing"/><box-body><label text="These items will be removed from the Assembly Task automatically, so must be removed from packages before continuing." type="strong" style="text-danger"/></box-body><box-body-nopad><form-list name="AssemblyPackUnusedComponents" list="componentsUnusedList" skip-form="true"><field name="productId"><default-field title="Component Product"><display-entity entity-name="mantle.product.Product" text="ProductNameTemplate"/></default-field></field><field name="quantity"><default-field><display style="text-strong text-danger"/></default-field></field></form-list></box-body-nopad></container-box></widgets></section><container type="dl" style="dl-horizontal"><label text="Store" type="dt" condition="productStore != null"/><label text="${productStore.productStoreId}: ${productStore.storeName}" type="dd" condition="productStore != null"/><label text="Shipping Gateway" type="dt"/><label text="${shippingGatewayConfig?.description ?: 'No Shipping Gateway'}" type="dd"/><label text="Order Ship By" type="dt"/><label text="${orderCarrierShipmentMethod?.description ? orderCarrierShipmentMethod.description : (orderCarrierDetail ? orderCarrierDetail.pseudoId : 'N/A') + ' ' + (orderShipmentMethodEnum ? orderShipmentMethodEnum.description : 'None')}" type="dd"/></container><form-single name="PackCompletedForm" transition="completeShipmentPack"><field name="shipmentId"><default-field><hidden/></default-field></field><field name="carrierAndShipmentMethod"><default-field title="Ship By"><drop-down allow-empty="true" no-current-selected-key="${lowestCarrierAndShipmentMethod}"><list-options list="shippingOptions" key="${carrierPartyId}:${shipmentMethodEnumId}" text="${description ? description : (carrierPartyId != '_NA_' ? (carrierName + ' - ') : '') + shipmentMethodDescription}${shippingTotal != null ? ' ' + ec.l10n.format(shippingTotal, '#,##0.00') : ''}"/></drop-down></default-field></field><field name="getLabels" from="shippingGatewayConfig != null ? 'true' : ''"><default-field title="Get Labels"><check><option key="true" text=" "/></check></default-field></field><field name="getReturnLabels" from="defaultGetReturnLabels"><default-field title="Get Return Labels"><check><option key="true" text=" "/></check></default-field></field><field name="networkPrinterId" from="defaultNetworkPrinterId"><conditional-field title="Printer" condition="networkPrinterList"><drop-down><list-options list="networkPrinterList" key="${networkPrinterId}" text="${description ?: printerName} (${serverHost})"/></drop-down></conditional-field></field><field name="makeDefaultPrinter"><conditional-field title="Make Default" condition="networkPrinterList"><check><option key="true" text=" "/></check></conditional-field></field><field name="localQzPrint"><default-field title="Local Print"><check all-checked="true"><option key="true" text="(only if QZ Print setup)"/></check></default-field></field><field name="submitButton"><default-field title="Complete Pack"><submit/></default-field></field></form-single></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Shipping/PackShipment/PackSummary.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Pack Shipment" default-menu-index="1"><parameter name="shipmentId" required="true"/><transition name="shipmentDetail"><default-response url="//${appRoot}/Shipment/ShipmentDetail"/></transition><transition name="orderDetail"><default-response url="//${appRoot}/Order/OrderDetail"/></transition><transition name="editInvoice"><default-response url="//${appRoot}/Accounting/Invoice/EditInvoice"/></transition><transition name="editPayment"><default-response url="//${appRoot}/Accounting/Payment/EditPayment"/></transition><transition name="editTransaction"><default-response url="//${appRoot}/Accounting/Transaction/EditTransaction"/></transition><transition name="assetDetail"><default-response url="//${appRoot}/Asset/AssetDetail"/></transition><transition name="picklistDetail"><default-response url="//${appRoot}/Shipping/Picklist/PicklistDetail"/></transition><transition name="editFacility"><default-response url="//${appRoot}/Facility/EditFacility"/></transition><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition name="editSupplier"><default-response url="//${appRoot}/Supplier/EditSupplier"/></transition><transition name="editCustomer"><default-response url="//${appRoot}/Customer/EditCustomer"/></transition><transition name="shipShipment"><service-call name="mantle.shipment.ShipmentServices.ship#Shipment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="cancelShipment"><service-call name="mantle.shipment.ShipmentServices.cancel#Shipment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateItem"><service-call name="mantle.shipment.ShipmentServices.update#ShipmentItem" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="packShipmentProduct"><service-call name="mantle.shipment.ShipmentServices.pack#ShipmentProduct" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="packShipmentProductScan"><service-call name="mantle.shipment.ShipmentServices.pack#ShipmentProductScan" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="produceAvailableAssemblies"><service-call name="mantle.work.ManufacturingServices.produce#AvailableAssemblies" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updatePackageAndRouteSeg"><service-call name="mantle.shipment.ShipmentServices.update#ShipmentPackageAndRouteSeg" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="requestShipmentLabels"><service-call name="mantle.shipment.CarrierServices.request#ShipmentLabels" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="printShipmentLabels"><service-call name="mantle.shipment.ShipmentServices.print#ShipmentLabels" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="removeShipmentLabelInfo"><service-call name="mantle.shipment.CarrierServices.remove#ShipmentLabelInfo" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="removeShipmentReturnLabelInfo"><service-call name="mantle.shipment.CarrierServices.remove#ShipmentReturnLabelInfo" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getAssetList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getPackageWeight" location="component://SimpleScreens/template/shipment/ShipmentTransitions.xml"/><transition-include name="getShipmentLabel" location="component://SimpleScreens/template/shipment/ShipmentTransitions.xml"/><transition name="ShipmentPack.pdf"><default-response url="${ec.web.getWebappRootUrl(false, null)}/fop/apps/${appRoot}/Shipping/ShipmentPack" url-type="plain"><parameter name="shipmentId"/><parameter name="filename" value="ShipmentPack-${shipmentId}.pdf"/></default-response></transition><transition name="ShipmentByPackage.pdf"><default-response url="${ec.web.getWebappRootUrl(false, null)}/fop/apps/${appRoot}/Shipping/ShipmentByPackage" url-type="plain"><parameter name="shipmentId"/><parameter name="filename" value="ShipmentByPackage-${shipmentId}.pdf"/></default-response></transition><transition name="ShipmentInsert.pdf"><default-response url="${ec.web.getWebappRootUrl(false, null)}/fop/apps/${appRoot}/Shipping/ShipmentInsert" url-type="plain"><parameter name="shipmentId"/><parameter name="filename" value="ShipmentInsert-${shipmentId}.pdf"/></default-response></transition><actions><service-call name="mantle.shipment.ShipmentInfoServices.get#ShipmentDisplayInfo" in-map="[shipmentId:shipmentId]" out-map="context"/><if condition="!isOutgoing && !isTransfer"><return error="true" message="Shipment ${shipmentId} is not an outgoing or transfer shipment"/></if><set field="statusPrePacked" from="shipment.statusId in ['ShipInput', 'ShipScheduled', 'ShipPicked']"/><entity-find entity-name="mantle.facility.FacilityBoxTypeDetail" list="boxTypeList"><econdition field-name="facilityId" from="firstRouteSegment.originFacilityId"/><order-by field-name="description"/></entity-find><if condition="!boxTypeList"><entity-find entity-name="mantle.shipment.ShipmentBoxType" list="boxTypeList"><order-by field-name="description"/></entity-find></if><set field="shippingPostalAddressList" from="[]"/><if condition="isOutgoing && toPartyId"><service-call name="mantle.party.ContactServices.get#PartyContactInfoList" out-map="toPartyShippingInfo" in-map="[partyId:toPartyId, postalContactMechPurposeId:'PostalShippingDest']"/><set field="shippingPostalAddressList" from="toPartyShippingInfo.postalAddressList ?: []"/><if condition="lastRouteSegment.destPostalContactMechId"><service-call name="mantle.party.ContactServices.get#PartyContactInfo" out-map="curDestPaInfo" in-map="[partyId:toPartyId, postalContactMechId:lastRouteSegment.destPostalContactMechId]"/><if condition="!(lastRouteSegment.destPostalContactMechId in shippingPostalAddressList*.postalContactMechId)"><script><![CDATA[shippingPostalAddressList.add(0, curDestPaInfo)]]></script></if></if></if><set field="activePackage" from="shipmentPackageList?.find({ it.weight == null || it.shipmentBoxTypeId == null })"/><set field="activePackageSeqId" from="activePackage?.shipmentPackageSeqId"/><if condition="activePackage != null"><set field="activePackageRouteSeg" from="packageRouteSegList.find({ it.shipmentPackageSeqId == activePackage.shipmentPackageSeqId && it.shipmentRouteSegmentSeqId == firstRouteSegment.shipmentRouteSegmentSeqId })"/><script><![CDATA[activePackageAndRouteSeg = new HashMap(activePackage); activePackageAndRouteSeg.putAll(activePackageRouteSeg)]]></script></if><entity-find entity-name="mantle.shipment.ShipmentOrderPayment" list="shipmentPaymentList" distinct="true"><econdition field-name="shipmentId"/><econdition field-name="statusId" operator="not-in" value="PmntCancelled,PmntVoid"/><select-field field-name="paymentId,paymentInstrumentEnumId,statusId"/></entity-find><set field="packagesComplete" from="shipmentPackageList" type="Boolean"/><iterate list="shipmentPackageList" entry="shipmentPackage"><set field="shipmentPackageContentList" from="allShipmentPackageContentList.findAll({ it.shipmentPackageSeqId == shipmentPackage.shipmentPackageSeqId })"/><if condition="shipmentPackageContentList && (!shipmentPackage.shipmentBoxTypeId || !shipmentPackage.weight)"><set field="packagesComplete" from="false"/><break/></if></iterate><set field="localPrintAllLabels" from="false"/><if condition="ec.web.sessionAttributes.get('qzPackShipment' + shipmentId)"><set field="localPrintAllLabels" from="true"/><script><![CDATA[ec.web.sessionAttributes.put('qzPackShipment' + shipmentId, false)]]></script></if><set field="getShipmentLabelPath" from="sri.buildUrl('getShipmentLabel').path"/><set field="defaultNetworkPrinterId" from="ec.user.getPreference('Shipment.networkPrinterId.default')"/><entity-find entity-name="moqui.basic.print.NetworkPrinter" list="networkPrinterList"><order-by field-name="description,printerName"/></entity-find></actions><widgets><container-row><row-col md="6"><container-box><box-header title="Pack Shipment ${shipmentId}"/><box-toolbar><container-dialog id="CancelDialog" button-text="Cancel" type="danger" condition="!(shipment.statusId in ['ShipDelivered', 'ShipRejected', 'ShipCancelled'])"><label text="Invoices associated with this shipment will be CANCELLED: ${invoiceIdSet.join(', ')}" condition="isOutgoing && invoiceIdSet" type="p" style="text-danger"/><label text="Invoices (found ${invoiceIdSet.size()} associated with this shipment) will not be changed, must be cancelled manually" condition="!isOutgoing && invoiceIdSet" type="p" style="text-warning"/><label text="Items have been packed/issued, these will be un-packed and returned to inventory" condition="anyItemPacked" type="p" style="text-danger"/><label text="Items have been received, all receipt quantities will be set to zero" condition="anyReceived" type="p" style="text-danger"/><label text="Labels will not be refunded automatically, refund manually if needed" condition="hasAnyLabels" type="p" style="text-warning"/><label text="Payments associated with this shipment through order or invoice will not be changed" type="p" style="text-warning"/><label text="Emails have been sent, these cannot be unsent" type="p" style="text-danger" condition="emailMessageCount"/><label text="Are you sure you want to cancel this shipment?"/><link url="cancelShipment" text="Cancel Shipment"/></container-dialog><link url="ShipmentInsert.pdf" text="Insert" style="${shipment.statusId in ['ShipShipped', 'ShipPacked'] ? 'btn-info' : ''}" icon="fa fa-download"/><render-mode><text type="vuet"><![CDATA[<button v-if="$root.qzVue" class="btn btn-default btn-sm" onclick="moqui.printUrlMain('/fop/apps/${appRoot}/Shipment/ShipmentInsert?shipmentId=${shipmentId}')"><i class="fa fa-print"></i> Insert</button>]]></text></render-mode><container-dialog id="PackCompletedErrorDialog" button-text="Pack Completed" type="warning" condition="statusPrePacked && (!anyItemPacked || !packagesComplete)"><label text="No items packed" condition="!anyItemPacked" style="text-danger" type="p"/><label text="Not all quantity of all items packed" condition="anyItemPacked && !allItemsPacked" style="text-warning" type="p"/><section-iterate name="PackComplShipmentPackageList" list="shipmentPackageList" entry="shipmentPackage"><widgets><label text="Package ${shipmentPackage.shipmentPackageSeqId} missing box type" condition="!shipmentPackage.shipmentBoxTypeId" style="text-danger" type="p"/><label text="Package ${shipmentPackage.shipmentPackageSeqId} missing weight" condition="!shipmentPackage.weight" style="text-danger" type="p"/></widgets></section-iterate></container-dialog><dynamic-dialog id="PackCompletedDialog" button-text="Pack Completed" transition="PackCompleted" type="success" condition="statusPrePacked && anyItemPacked && packagesComplete"/><dynamic-dialog id="GetLabelsDialog" button-text="Get Labels" transition="PackCompleted" type="success" condition="!statusPrePacked && anyItemPacked && packagesComplete && !hasAllLabels"/><container-dialog id="PrintLabelsDialog" button-text="Net Print" condition="hasAnyLabels && networkPrinterList"><form-single name="PrintAllShipmentLabels" transition="printShipmentLabels"><field name="shipmentId"><default-field><hidden/></default-field></field><field name="networkPrinterId" from="defaultNetworkPrinterId"><default-field title="Printer"><drop-down><list-options list="networkPrinterList" key="${networkPrinterId}" text="${description ?: printerName} (${serverHost})"/></drop-down></default-field></field><field name="makeDefaultPrinter"><default-field title="Make Default"><check><option key="true" text=" "/></check></default-field></field><field name="returnLabels"><default-field title=""><radio no-current-selected-key="false"><option key="false" text="Outgoing Labels"/><option key="true" text="Return Labels"/></radio></default-field></field><field name="submitButton"><default-field title="Submit"><submit/></default-field></field></form-single></container-dialog><section name="QzPrintLabelsSection" condition="hasAnyLabels"><widgets><render-mode><text type="vuet"><![CDATA[<m-script>
                        qzPrintAllLabels = function() {
                            if (!moqui.webrootVue.qzVue || !moqui.printUrlLabel) { return };
                            moqui.printUrlLabel([
                            <#list packageRouteSegList! as packageRouteSeg><#if packageRouteSeg.labelUrl?has_content>'${getShipmentLabelPath}?shipmentId=${packageRouteSeg.shipmentId}&shipmentPackageSeqId=${packageRouteSeg.shipmentPackageSeqId}&shipmentRouteSegmentSeqId=${packageRouteSeg.shipmentRouteSegmentSeqId}',</#if><#if packageRouteSeg.returnLabelUrl?has_content>'${getShipmentLabelPath}?retLabel=true&shipmentId=${packageRouteSeg.shipmentId}&shipmentPackageSeqId=${packageRouteSeg.shipmentPackageSeqId}&shipmentRouteSegmentSeqId=${packageRouteSeg.shipmentRouteSegmentSeqId}',</#if></#list>
                            ]);
                            moqui.printUrlMain([
                            <#list packageRouteSegList! as packageRouteSeg><#if packageRouteSeg.internationalInvoiceUrl?has_content>'${getShipmentLabelPath}?intlInvoiceLabel=true&shipmentId=${packageRouteSeg.shipmentId}&shipmentPackageSeqId=${packageRouteSeg.shipmentPackageSeqId}&shipmentRouteSegmentSeqId=${packageRouteSeg.shipmentRouteSegmentSeqId}',</#if><#if packageRouteSeg.returnIntlInvoiceUrl?has_content>'${getShipmentLabelPath}?retLabel=true&intlInvoiceLabel=true&shipmentId=${packageRouteSeg.shipmentId}&shipmentPackageSeqId=${packageRouteSeg.shipmentPackageSeqId}&shipmentRouteSegmentSeqId=${packageRouteSeg.shipmentRouteSegmentSeqId}',</#if></#list>
                            ]);
                        }
                        <#if localPrintAllLabels! == true>qzPrintAllLabels();</#if></m-script><button v-if="$root.qzVue" class="btn btn-default btn-sm" onclick="qzPrintAllLabels();"><i class="fa fa-print"></i> All Labels</button>]]></text></render-mode></widgets></section><section name="ShipShipmentSection" condition="shipment.statusId == 'ShipPacked'"><widgets><container-dialog id="SetShippedDialog" button-text="Set Shipped" type="${!hasAllTrackingCodes ? 'danger' : (!hasAllLabels ? 'warning' : 'success')}"><label text="Set as Shipped? If a Shipment Shipped email is configured it will be sent to the Customer." condition="isOutgoing" style="text-success" type="p"/><container><label text="Not all packages have Labels" type="strong" style="text-warning" condition="!hasAllLabels"/></container><container><label text="Not all packages have Tracking Codes" type="strong" style="text-danger" condition="!hasAllTrackingCodes"/></container><form-single name="SetShippedForm" transition="shipShipment" focus-field="submitButton"><field name="shipmentId"><default-field><display/></default-field></field><field name="actualStartDate" from="ec.user.nowTimestamp"><default-field title="Actual Start"><date-time/></default-field></field><field name="submitButton"><default-field title="Set Shipped"><submit/></default-field></field></form-single></container-dialog></widgets></section></box-toolbar><box-body><section name="PackScanSection" condition="statusPrePacked"><widgets><form-single name="PackScanForm" transition="packShipmentProductScan" focus-field="scanInput"><field name="shipmentId"><default-field><hidden/></default-field></field><field name="quantity" from="1"><default-field><text-line size="4"/></default-field></field><field name="scanInput"><default-field title="Product"><text-line size="25"/></default-field></field><field name="shipmentPackageSeqId" from="activePackageSeqId"><default-field title="Package"><drop-down><option key="" text="New"/><list-options list="shipmentPackageList" key="${shipmentPackageSeqId}" text="${shipmentPackageSeqId}"/></drop-down></default-field></field><field name="packButton"><default-field title="Pack Item"><submit/></default-field></field><field-layout><field-row-big><field-ref name="quantity"/><field-ref name="scanInput"/><field-ref name="shipmentPackageSeqId"/><field-ref name="packButton"/></field-row-big></field-layout></form-single></widgets></section><section name="PackedSummarySection"><actions><set field="quantityTotal" from="shipmentItemSourceList*.quantity.sum()"/><set field="quantityNotHandledTotal" from="shipmentItemSourceList*.quantityNotHandled.sum({ it ?: 0.0 })"/><set field="quantityHandledTotal" from="quantityTotal - quantityNotHandledTotal"/></actions><widgets><container style="text-center"><label text="Packed ${ec.l10n.format(quantityHandledTotal, '#,##0.##')} of ${ec.l10n.format(quantityTotal, '#,##0.##')}" type="h3" style="${quantityHandledTotal ? (quantityHandledTotal == quantityTotal ? 'text-success' : 'text-warning') : 'text-danger'}"/></container></widgets></section></box-body></container-box><section name="ActivePackageSection" condition="activePackageAndRouteSeg"><actions><set field="shipmentPackageContentList" from="allShipmentPackageContentList.findAll({ activePackageSeqId.equals(it.shipmentPackageSeqId) })"/></actions><widgets><container-box><box-header title="Active Package ${activePackageAndRouteSeg.shipmentPackageSeqId}"/><box-body><form-single name="ClosePackageForm" map="activePackageAndRouteSeg" transition="updatePackageAndRouteSeg"><field name="shipmentId"><default-field><hidden/></default-field></field><field name="shipmentRouteSegmentSeqId"><default-field><hidden/></default-field></field><field name="shipmentPackageSeqId"><default-field><hidden/></default-field></field><field name="shipmentBoxTypeId"><default-field title="Box Type"><drop-down allow-empty="true"><list-options list="boxTypeList" key="${shipmentBoxTypeId}" text="${pseudoId}: ${description}"/></drop-down></default-field></field><field name="weight"><default-field><text-line size="4" default-transition="getPackageWeight" parameter-map="[shipmentId:shipmentId, shipmentPackageSeqId:shipmentPackageSeqId]"><depends-on field="shipmentBoxTypeId"/><depends-on field="weightUomId"/></text-line></default-field></field><field name="weightUomId" from="weightUomId ?: 'WT_lb'"><default-field title=""><display-entity entity-name="moqui.basic.Uom" text="${abbreviation ?: description}"/></default-field></field><field name="submitButton"><default-field title="Close Pkg ${shipmentPackageSeqId}"><submit/></default-field></field><field-layout><field-row-big><field-ref name="shipmentPackageSeqId"/><field-ref name="shipmentBoxTypeId"/><field-ref name="weight"/><field-ref name="weightUomId"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single></box-body><box-body-nopad><form-list name="ShipmentPackageContentList" list="shipmentPackageContentList" skip-form="true"><field name="productId"><default-field title="Product"><display-entity entity-name="mantle.product.Product" text="ProductNameTemplate"/></default-field></field><field name="quantity"><default-field><display/></default-field></field></form-list></box-body-nopad></container-box></widgets></section></row-col><row-col md="6"><container-box><box-header><container style="text-strong"><label text="Pack Shipment "/><link url="shipmentDetail" text="${shipmentId}" link-type="anchor"/><label text=" (${statusItem.description})" condition="statusItem"/></container></box-header><box-body><section-iterate name="ShipmentPaymentListSection" list="shipmentPaymentList" entry="shipmentPayment"><actions><entity-find-one entity-name="moqui.basic.StatusItem" value-field="pmntStatus"><field-map field-name="statusId" from="shipmentPayment.statusId"/></entity-find-one><entity-find-one entity-name="moqui.basic.Enumeration" value-field="pmntInstrumentEnum"><field-map field-name="enumId" from="shipmentPayment.paymentInstrumentEnumId"/></entity-find-one></actions><widgets><label text="Payment ${shipmentPayment.paymentId} - ${pmntInstrumentEnum?.description ?: 'Unknown Type'} - ${pmntStatus?.description}" type="p" style="text-strong ${shipmentPayment.statusId in ['PmntAuthorized', 'PmntDelivered', 'PmntConfirmed'] ? 'text-success' : (shipmentPayment.paymentInstrumentEnumId == 'PiCreditCard' ? 'text-danger' : 'text-warning')}"/></widgets></section-iterate><container-row><row-col md="6"><container-row><row-col xs="3" style="text-right"><label text="Ship By" type="strong"/></row-col><row-col xs="9"><label text="${curCarrierShipmentMethod?.description ? curCarrierShipmentMethod.description : (curCarrierDetail ? curCarrierDetail.pseudoId : 'N/A') + ' ' + (curShipmentMethodEnum ? curShipmentMethodEnum.description : 'None')}"/></row-col></container-row><container-row><row-col xs="3" style="text-right"><label text="Order" type="strong"/></row-col><row-col xs="9"><label text="${orderCarrierShipmentMethod?.description ? orderCarrierShipmentMethod.description : (orderCarrierDetail ? orderCarrierDetail.pseudoId : 'N/A') + ' ' + (orderShipmentMethodEnum ? orderShipmentMethodEnum.description : 'None')}"/></row-col></container-row><section name="ShippedShippingInfo" condition="curDestPaInfo"><actions><set field="contactInfo" from="curDestPaInfo"/></actions><widgets><container-row><row-col xs="3" style="text-right"><label text="Dest" type="strong"/></row-col><row-col xs="9"><render-mode><text type="html,vuet,qvt" location="component://SimpleScreens/template/party/ContactInfo.html.gstring"/></render-mode><container><label text="Trust: ${contactInfo.postalTrustLevelEnum?.description ?: 'New'}" type="strong"/></container></row-col></container-row></widgets></section></row-col><row-col md="6"><container-row><row-col xs="3" style="text-right"><label text="Status" type="strong"/></row-col><row-col xs="9"><label text="${statusItem.description}" type="strong"/></row-col></container-row><container-row><row-col xs="3" style="text-right"><label text="To" type="strong"/></row-col><row-col xs="9"><label text="${toPartyDetail ? ec.resource.expand('PartyNameTemplate', '', toPartyDetail) : 'Not Set'}"/></row-col></container-row><container-row><row-col xs="3" style="text-right"><label text="Facility" type="strong"/></row-col><row-col xs="9"><label text="${ec.resource.expand('FacilityNameTemplate', '', originFacility)}"/></row-col></container-row><container-row><row-col xs="3" style="text-right"><label text="Type" type="strong"/></row-col><row-col xs="9"><label text="${shipmentTypeEnum?.description}"/></row-col></container-row></row-col></container-row><section name="ShippingInstructionsSection" condition="shipment.handlingInstructions"><widgets><container-row><row-col xs="3" style="text-right"><label text="Instructions" type="strong"/></row-col><row-col xs="9"><label text="${shipment.handlingInstructions}"/></row-col></container-row></widgets></section></box-body></container-box><section-include name="AssemblyInfoSection" location="component://SimpleScreens/screen/SimpleScreens/Shipment/ShipmentDetail.xml"/></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Shipping/PackShipment/PackItems.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Items" default-menu-index="2"><parameter name="shipmentId" required="true"/><parameter name="filterProductId"/><parameter name="onlyRemaining"/><parameter name="pageIndex"/><transition name="shipmentDetail"><default-response url="//${appRoot}/Shipment/ShipmentDetail"/></transition><transition name="orderDetail"><default-response url="//${appRoot}/Order/OrderDetail"/></transition><transition name="editInvoice"><default-response url="//${appRoot}/Accounting/Invoice/EditInvoice"/></transition><transition name="assetDetail"><default-response url="//${appRoot}/Asset/AssetDetail"/></transition><transition name="updateItem"><service-call name="mantle.shipment.ShipmentServices.update#ShipmentItem" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="packShipmentProduct"><service-call name="mantle.shipment.ShipmentServices.pack#ShipmentProduct" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="packItemSource"><service-call name="mantle.shipment.ShipmentServices.pack#ShipmentItemSource" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="packAssemblyComponent"><service-call name="mantle.shipment.ShipmentServices.pack#ShipmentAssemblyComponent" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="unpackItemIssuance"><service-call name="mantle.shipment.ShipmentServices.unpack#ShipmentItemIssuance" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="addItemToPackage"><service-call name="mantle.shipment.ShipmentServices.add#ItemToPackage" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getAssetList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getPackageWeight" location="component://SimpleScreens/template/shipment/ShipmentTransitions.xml"/><transition-include name="getShipmentLabel" location="component://SimpleScreens/template/shipment/ShipmentTransitions.xml"/><actions><service-call name="mantle.shipment.ShipmentInfoServices.get#ShipmentDisplayInfo" in-map="[shipmentId:shipmentId]" out-map="context"/><if condition="!isOutgoing && !isTransfer"><return error="true" message="Shipment ${shipmentId} is not an outgoing or transfer shipment"/></if><set field="statusPrePacked" from="shipment.statusId in ['ShipInput', 'ShipScheduled', 'ShipPicked']"/><set field="activePackage" from="shipmentPackageList?.find({ it.weight == null || it.shipmentBoxTypeId == null })"/><set field="activePackageSeqId" from="activePackage?.shipmentPackageSeqId"/><if condition="activePackage != null"><set field="activePackageRouteSeg" from="packageRouteSegList.find({ it.shipmentPackageSeqId == activePackage.shipmentPackageSeqId && it.shipmentRouteSegmentSeqId == firstRouteSegment.shipmentRouteSegmentSeqId })"/><script><![CDATA[activePackageAndRouteSeg = new HashMap(activePackage); activePackageAndRouteSeg.putAll(activePackageRouteSeg)]]></script></if><set field="allProductIds" from="shipmentItemDetailList*.productId"/><entity-find entity-name="mantle.product.Product" list="allProductList"><econdition field-name="productId" operator="in" from="allProductIds"/><order-by field-name="pseudoId"/></entity-find><if condition="filterProductId"><filter-map-list list="shipmentItemDetailList"><field-map field-name="productId" from="filterProductId"/></filter-map-list></if><if condition="onlyRemaining == 'Y'"><set field="tempItemDetailList" from="new ArrayList()"/><iterate list="shipmentItemDetailList" entry="sid"><if condition="isOutgoing || isTransfer"><if condition="(sid.quantity - (sid.quantityTotal ?: 0.0)) > 0.0"><script><![CDATA[tempItemDetailList.add(sid)]]></script><continue/></if></if><if condition="isIncoming || isTransfer"><if condition="(sid.quantity - (sid.quantityAcceptedTotal ?: 0.0) - (sid.quantityRejectedTotal ?: 0.0)) > 0.0"><script><![CDATA[tempItemDetailList.add(sid)]]></script><continue/></if></if></iterate><set field="shipmentItemDetailList" from="tempItemDetailList"/></if><set field="pageSize" from="pageSize ?: '10'"/></actions><widgets><container style="text-strong"><label text="Pack Shipment - Items"/><link url="shipmentDetail" text="${shipmentId}" link-type="anchor"/><label text=" (${statusItem.description})" condition="statusItem"/></container><form-single name="ItemsOptionsForm" transition="." pass-through-parameters="true"><field name="filterProductId"><default-field title="Product"><drop-down allow-empty="true"><list-options list="allProductList" key="${productId}" text="ProductNameTemplate"/></drop-down></default-field></field><field name="onlyRemaining"><default-field><radio no-current-selected-key="N"><option key="Y"/><option key="N"/></radio></default-field></field><field name="submitBtn"><default-field title="Filter"><submit/></default-field></field><field-layout><field-row-big><field-ref name="filterProductId"/><field-ref name="onlyRemaining"/><field-ref name="submitBtn"/></field-row-big></field-layout></form-single><section-iterate name="ShipmentItemsSection" list="shipmentItemDetailList" entry="sid" paginate="true"><actions><if condition="isOutgoing || isTransfer"><set field="quantityPackRemaining" from="sid.quantity - (sid.quantityTotal ?: 0)"/><entity-find entity-name="mantle.product.issuance.AssetAndIssuance" list="assetIssuanceList"><econdition field-name="shipmentId"/><econdition field-name="productId" from="sid.productId"/></entity-find></if><set field="allowPack" from="(isOutgoing || isTransfer) && shipment.statusId in ['ShipInput', 'ShipScheduled', 'ShipPicked'] && quantityPackRemaining > 0"/><entity-find-one entity-name="moqui.basic.Uom" value-field="productUom"><field-map field-name="uomId" from="sid.amountUomId"/></entity-find-one><entity-find entity-name="mantle.shipment.ShipmentItemSource" list="sisList"><econdition field-name="shipmentId"/><econdition field-name="productId" from="sid.productId"/></entity-find><entity-find-one entity-name="mantle.product.Product" value-field="product"><field-map field-name="productId" from="sid.productId"/></entity-find-one><entity-find entity-name="mantle.shipment.ShipmentPackageContent" list="packageContentList"><econdition field-name="shipmentId"/><econdition field-name="productId" from="sid.productId"/></entity-find><set field="packageContentTotal" from="(packageContentList*.quantity).sum() ?: 0.0"/><set field="quantityNotInPackage" from="((BigDecimal) sid.quantity ?: 0.0) - packageContentTotal"/></actions><widgets><container-box><box-header title="${ec.resource.expand('ProductNameTemplate', '', sid)} (Qty ${ec.l10n.format(sid.quantity ?: 0, '#.##')})"/><box-toolbar><section name="PackItemSection" condition="allowPack"><widgets><container-dialog id="PackItemContainer" button-text="Pack/Issue Item" type="success"><form-single name="PackItemForm" transition="packShipmentProduct" map="sid" pass-through-parameters="true"><field name="shipmentId"><default-field><hidden/></default-field></field><field name="productId"><default-field title="Product"><display-entity entity-name="mantle.product.Product" text="ProductNameTemplate"/></default-field></field><field name="shipmentPackageSeqId" from="activePackageSeqId"><default-field title="Package##Shipment"><drop-down><option key="" text="New Package"/><list-options list="shipmentPackageList" key="${shipmentPackageSeqId}" text="${shipmentPackageSeqId}"/></drop-down></default-field></field><field name="quantity" from="quantityPackRemaining"><default-field><text-line size="8"/></default-field></field><field name="packDate" from="shipment.estimatedShipDate ?: ec.user.nowTimestamp"><default-field title="Pack Date"><date-time/></default-field></field><field name="assetId"><default-field title="Asset"><drop-down><dynamic-options transition="getAssetList" server-search="true" min-length="0" parameter-map="[facilityId:firstRouteSegment.originFacilityId, productId:productId, assetTypeEnumId:null, excludeZeroQoh:'true']"/></drop-down></default-field></field><field name="submitButton"><default-field title="Pack Quantity"><submit/></default-field></field></form-single></container-dialog><section-include name="PackComponentsSection" location="component://SimpleScreens/screen/SimpleScreens/Shipment/ShipmentItems.xml"/></widgets></section></box-toolbar><box-body><label condition="isOutgoing || isTransfer" type="p" style="text-strong" text="Packed/Issued: ${ec.l10n.format(sid.quantityTotal ?: 0, '#.##')}, Remaining: ${ec.l10n.format(quantityPackRemaining, '#.##')}  (Unit: ${productUom?.description ?: 'N/A'})"/><container-row><row-col lg="5"><section name="ShipItemUpdateSection" condition="allowUpdate"><widgets><form-single name="UpdateItemForm" transition="updateItem" map="sid" pass-through-parameters="true"><field name="shipmentId"><default-field><hidden/></default-field></field><field name="productId"><default-field><hidden/></default-field></field><field name="quantity"><default-field title=""><text-line size="6"/></default-field></field><field name="submitButton"><default-field title="Update Quantity"><submit/></default-field></field><field-layout><field-row-big><field-ref name="quantity"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single></widgets></section></row-col><row-col lg="7"><section name="ShipItemPackageSection" condition="quantityNotInPackage"><widgets><form-single name="AddItemToPackageForm" transition="addItemToPackage" map="sid" pass-through-parameters="true"><field name="shipmentId"><default-field><hidden/></default-field></field><field name="productId"><default-field><hidden/></default-field></field><field name="shipmentPackageSeqId"><default-field title=""><drop-down><option key="" text="New"/><list-options list="shipmentPackageList" key="${shipmentPackageSeqId}" text="${shipmentPackageSeqId}"/></drop-down></default-field></field><field name="quantity" from="quantityNotInPackage"><default-field title=""><text-line size="6"/></default-field></field><field name="submitButton"><default-field title="Add to Package"><submit/></default-field></field><field-layout><field-row-big><field-ref name="shipmentPackageSeqId"/><field-ref name="quantity"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single></widgets></section></row-col></container-row></box-body><box-body-nopad><section name="ItemAssetPackSection" condition="isOutgoing || isTransfer"><widgets><form-list name="ItemSourceIssuanceList" list="sisList" transition="packItemSource"><row-actions><entity-find entity-name="mantle.product.issuance.AssetReservation" list="existingResList"><econdition field-name="orderId"/><econdition field-name="orderItemSeqId"/></entity-find><set field="resPackForm" from="allowPack && quantityNotHandled > 0.0 && existingResList && product.productTypeEnumId != 'PtPickAssembly'"/></row-actions><field name="shipmentId"><default-field><hidden/></default-field></field><field name="shipmentItemSourceId"><default-field><hidden/></default-field></field><field name="orderId"><default-field title="Order Item"><link url="orderDetail" text="${orderId?:''}:${orderItemSeqId?:''}" link-type="anchor" condition="orderId"/></default-field></field><field name="quantitySis" from="quantity"><default-field title="Qty"><display/></default-field></field><field name="quantityNotHandled"><default-field title="Rem"><display/></default-field></field><field name="assetReservations"><conditional-field condition="existingResList"><section-iterate name="ReservationInfoSection" list="existingResList" entry="existingRes"><actions><entity-find-one entity-name="mantle.product.asset.AssetLotAndMfgParty" value-field="assetLot"><field-map field-name="assetId" from="existingRes.assetId"/></entity-find-one></actions><widgets><container><label text="Res: ${ec.l10n.format(existingRes.quantity, null)}, Not Avail: ${ec.l10n.format(existingRes.quantityNotAvailable, null)}, Not Issued: ${ec.l10n.format(existingRes.quantityNotIssued, null)}" type="span"/><link url="assetDetail" text="Asset ${existingRes.assetId}" parameter-map="[assetId:existingRes.assetId]" link-type="anchor"/></container><label text="LotNameTemplate" text-map="assetLot" condition="assetLot?.lotId"/></widgets></section-iterate></conditional-field><default-field><display text=" "/></default-field></field><field name="shipmentPackageSeqId" from="activePackageSeqId"><conditional-field condition="resPackForm" title="Package##Shipment"><drop-down><option key="" text="New"/><list-options list="shipmentPackageList" key="${shipmentPackageSeqId}" text="${shipmentPackageSeqId}"/></drop-down></conditional-field><default-field title="Package##Shipment"><display text=" "/></default-field></field><field name="quantity" from="quantityNotHandled"><conditional-field condition="resPackForm" title="Pack Qty"><text-line size="3"/></conditional-field><default-field title="Pack Qty"><display text=" "/></default-field></field><field name="packButton"><conditional-field condition="resPackForm" title="Pack"><submit/></conditional-field><default-field title=""><display text=" "/></default-field></field></form-list><section-include name="PaReservedComponentPack" location="component://SimpleScreens/screen/SimpleScreens/Shipment/ShipmentItems.xml"/><form-list name="ItemAssetIssuanceList" list="assetIssuanceList" skip-form="true"><row-actions><entity-find-one entity-name="mantle.facility.FacilityLocation" value-field="facLoc"/><entity-find-one entity-name="mantle.product.issuance.AssetReservation" value-field="res"/></row-actions><field name="quantity"><default-field title="Issued"><display/></default-field></field><field name="issuedDate"><default-field title="Issued Date"><display/></default-field></field><field name="orderId"><default-field title="Order Item"><link url="orderDetail" text="${orderId?:''}:${orderItemSeqId?:''}" link-type="anchor"/></default-field></field><field name="assetId"><default-field title="Asset"><link url="assetDetail" text="${assetId}" link-type="anchor"/></default-field></field><field name="assetReservationId"><conditional-field condition="res"><display text="${assetReservationId} - Res: ${ec.l10n.format(res.quantity, null)}, Not Avail: ${ec.l10n.format(res.quantityNotAvailable, null)}, Not Issued: ${ec.l10n.format(res.quantityNotIssued, null)}"/></conditional-field><default-field title="Reservation"><display/></default-field></field><field name="lotId"><default-field title="Lot"><display-entity entity-name="mantle.product.asset.LotAndMfgParty" text="LotNameTemplate"/></default-field></field><field name="locationSeqId"><default-field title="Was Stored At"><display text="FacilityLocationNameTemplate" text-map="facLoc?:[:]"/></default-field></field><field name="unpackLink"><default-field title=""><link url="unpackItemIssuance" text="Unpack" parameter-map="[shipmentId:shipmentId, assetIssuanceId:assetIssuanceId]" condition="!invoiceId && quantity" confirmation="Are you sure? Only do this when necessary to avoid processing a return to receive the item back into inventory."/></default-field></field><form-list-column><field-ref name="quantity"/></form-list-column><form-list-column><field-ref name="orderId"/><field-ref name="assetId"/></form-list-column><form-list-column><field-ref name="assetReservationId"/><field-ref name="lotId"/></form-list-column><form-list-column><field-ref name="locationSeqId"/></form-list-column><form-list-column><field-ref name="unpackLink"/></form-list-column></form-list></widgets></section></box-body-nopad></container-box></widgets></section-iterate></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Shipping/PackShipment/PackPackages.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Packages" default-menu-index="3"><parameter name="shipmentId" required="true"/><parameter name="filterProductId"/><parameter name="pageIndex"/><transition name="shipmentDetail"><default-response url="//${appRoot}/Shipment/ShipmentDetail"/></transition><transition name="updatePackageAndRouteSeg"><service-call name="mantle.shipment.ShipmentServices.update#ShipmentPackageAndRouteSeg" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="addItemToPackage"><service-call name="mantle.shipment.ShipmentServices.add#ItemToPackage" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updatePackageContent"><service-call name="mantle.shipment.ShipmentServices.update#ShipmentPackageContent" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createShipmentAutoPackages"><service-call name="mantle.shipment.ShipmentServices.create#ShipmentAutoPackages" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="resetShipmentPackage"><service-call name="mantle.shipment.ShipmentServices.reset#ShipmentPackage" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deletePackage"><service-call name="mantle.shipment.ShipmentServices.delete#ShipmentPackage" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="requestShipmentLabels"><service-call name="mantle.shipment.CarrierServices.request#ShipmentLabels" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="printShipmentLabels"><service-call name="mantle.shipment.ShipmentServices.print#ShipmentLabels" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="removeShipmentLabelInfo"><service-call name="mantle.shipment.CarrierServices.remove#ShipmentLabelInfo" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="removeShipmentReturnLabelInfo"><service-call name="mantle.shipment.CarrierServices.remove#ShipmentReturnLabelInfo" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getAssetList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getPackageWeight" location="component://SimpleScreens/template/shipment/ShipmentTransitions.xml"/><transition-include name="getShipmentLabel" location="component://SimpleScreens/template/shipment/ShipmentTransitions.xml"/><actions><set field="pageSize" from="pageSize ?: '10'"/><service-call name="mantle.shipment.ShipmentServices.get#ShipmentDisplayInfo" in-map="[shipmentId:shipmentId]" out-map="context"/><if condition="!isOutgoing && !isTransfer"><return error="true" message="Shipment ${shipmentId} is not an outgoing or transfer shipment"/></if><set field="statusPrePacked" from="shipment.statusId in ['ShipInput', 'ShipScheduled', 'ShipPicked']"/><set field="filteredShipmentPackageList" from="shipmentPackageList"/><if condition="filterProductId"><filter-map-list list="allShipmentPackageContentList" to-list="filteredShipmentPackageContentList"><field-map field-name="productId" from="filterProductId"/></filter-map-list><set field="shipmentPackageSeqIdSet" from="new HashSet(filteredShipmentPackageContentList*.shipmentPackageSeqId)"/><set field="filteredShipmentPackageList" from="shipmentPackageList.findAll({ shipmentPackageSeqIdSet.contains(it.shipmentPackageSeqId) })"/></if><set field="allProductIds" from="shipmentItemDetailList*.productId"/><entity-find entity-name="mantle.product.Product" list="allProductList"><econdition field-name="productId" operator="in" from="allProductIds"/><order-by field-name="pseudoId"/></entity-find><entity-find entity-name="mantle.facility.FacilityBoxTypeDetail" list="boxTypeList"><econdition field-name="facilityId" from="firstRouteSegment.originFacilityId"/><order-by field-name="description"/></entity-find><if condition="!boxTypeList"><entity-find entity-name="mantle.shipment.ShipmentBoxType" list="boxTypeList"><order-by field-name="description"/></entity-find></if><set field="activePackage" from="shipmentPackageList?.find({ it.weight == null || it.shipmentBoxTypeId == null })"/><set field="activePackageSeqId" from="activePackage?.shipmentPackageSeqId"/><if condition="activePackage != null"><set field="activePackageRouteSeg" from="packageRouteSegList.find({ it.shipmentPackageSeqId == activePackage.shipmentPackageSeqId && it.shipmentRouteSegmentSeqId == firstRouteSegment.shipmentRouteSegmentSeqId })"/><script><![CDATA[activePackageAndRouteSeg = new HashMap(activePackage); activePackageAndRouteSeg.putAll(activePackageRouteSeg)]]></script></if><set field="getShipmentLabelPath" from="sri.buildUrl('getShipmentLabel').path"/><set field="defaultNetworkPrinterId" from="ec.user.getPreference('Shipment.networkPrinterId.default')"/><entity-find entity-name="moqui.basic.print.NetworkPrinter" list="networkPrinterList"><order-by field-name="description,printerName"/></entity-find></actions><widgets><container style="text-strong"><label text="Pack Shipment - Packages"/><link url="shipmentDetail" text="${shipmentId}" link-type="anchor"/><label text=" (${statusItem.description})" condition="statusItem"/></container><form-single name="PackageOptionsForm" transition="." pass-through-parameters="true"><field name="filterProductId"><default-field title="Product"><drop-down allow-empty="true"><list-options list="allProductList" key="${productId}" text="ProductNameTemplate"/></drop-down></default-field></field><field name="submitBtn"><default-field title="Filter"><submit/></default-field></field><field-layout><field-row-big><field-ref name="filterProductId"/><field-ref name="submitBtn"/></field-row-big></field-layout></form-single><section-iterate name="PackageListSection" list="filteredShipmentPackageList" entry="shipmentPackage" paginate="true"><actions><set field="shipmentBoxType" from="shipmentPackage.boxType"/><set field="weightUom" from="shipmentPackage.weightUom"/><set field="shipmentPackageContentList" from="allShipmentPackageContentList.findAll({ it.shipmentPackageSeqId == shipmentPackage.shipmentPackageSeqId })"/><set field="packageRouteSeg" from="packageRouteSegList.find({ it.shipmentPackageSeqId == shipmentPackage.shipmentPackageSeqId && it.shipmentRouteSegmentSeqId == firstRouteSegment.shipmentRouteSegmentSeqId })"/><set field="hasLabel" from="packageRouteSeg.gatewayLabelId || packageRouteSeg.labelImage != null || packageRouteSeg.labelUrl"/><set field="hasReturnLabel" from="packageRouteSeg.returnTrackingCode || packageRouteSeg.returnGatewayLabelId || packageRouteSeg.returnLabelImage != null || packageRouteSeg.returnLabelUrl"/><set field="trackingStatusEnum" from="packageRouteSeg?.trackingStatusEnum"/><set field="returnTrackingStatusEnum" from="packageRouteSeg?.returnTrackingStatusEnum"/><script><![CDATA[packageAndRouteSeg = new HashMap(shipmentPackage); packageAndRouteSeg.putAll(packageRouteSeg)]]></script></actions><widgets><container-box type="${shipmentBoxType && shipmentPackage.weight ? 'success' : (activePackageSeqId == shipmentPackage.shipmentPackageSeqId ? 'info' : 'warning')}"><box-header title="Package ${shipmentPackage.shipmentPackageSeqId}"/><box-toolbar><container-dialog id="UpdatePackageDialog" button-text="Update"><form-single name="UpdatePackageForm" map="packageAndRouteSeg" transition="updatePackageAndRouteSeg" pass-through-parameters="true"><field name="shipmentId"><default-field><hidden/></default-field></field><field name="shipmentPackageSeqId"><default-field><hidden/></default-field></field><field name="shipmentRouteSegmentSeqId"><default-field><hidden/></default-field></field><field name="shipmentBoxTypeId"><default-field title="Box Type"><drop-down allow-empty="true"><list-options list="boxTypeList" key="${shipmentBoxTypeId}" text="${description}"/></drop-down></default-field></field><field name="weightUomId"><default-field title="Weight UOM"><drop-down allow-empty="true" no-current-selected-key="WT_lb"><entity-options key="${uomId}" text="${description} (${abbreviation})"><entity-find entity-name="moqui.basic.Uom"><econdition field-name="uomTypeEnumId" value="UT_WEIGHT_MEASURE"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="weight"><default-field><text-line size="8" default-transition="getPackageWeight" parameter-map="[shipmentId:shipmentId, shipmentPackageSeqId:shipmentPackageSeqId]"><depends-on field="shipmentBoxTypeId"/><depends-on field="weightUomId"/></text-line></default-field></field><field name="trackingCode"><default-field><text-line size="30"/></default-field></field><field name="estimatedAmount"><default-field title="Est. Cost"><text-line size="10"/></default-field></field><field name="returnTrackingCode"><default-field title="Return Tracking"><text-line size="30"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></container-dialog><link url="requestShipmentLabels" text="Get Label" condition="shippingGatewayConfigId && !hasLabel && shipmentPackage.shipmentBoxTypeId && destContactMechValid" parameter-map="[shipmentId:shipmentId, shipmentPackageSeqId:shipmentPackage.shipmentPackageSeqId,                             shipmentRouteSegmentSeqId:packageRouteSeg.shipmentRouteSegmentSeqId]"/><container-dialog id="RequestPkgLabelDialog" button-text="Get Label" type="warning" condition="shippingGatewayConfigId && !hasLabel && shipmentPackage.shipmentBoxTypeId && !destContactMechValid"><label text="Warning: destination address is incomplete or invalid according to address validation." style="text-warning"/><link url="requestShipmentLabels" text="Get Label Anyway" parameter-map="[shipmentId:shipmentId, shipmentPackageSeqId:shipmentPackage.shipmentPackageSeqId,                                 shipmentRouteSegmentSeqId:packageRouteSeg.shipmentRouteSegmentSeqId]"/></container-dialog><container-dialog id="RequestRetLabelDialog" button-text="Return Label" condition="shippingGatewayConfigId && hasLabel && !hasReturnLabel"><form-single name="RequestRetLabel" transition="requestShipmentLabels" pass-through-parameters="true"><field name="shipmentId"><default-field><hidden/></default-field></field><field name="shipmentPackageSeqId" from="shipmentPackage.shipmentPackageSeqId"><default-field><hidden/></default-field></field><field name="shipmentRouteSegmentSeqId" from="packageRouteSeg.shipmentRouteSegmentSeqId"><default-field><hidden/></default-field></field><field name="getReturnLabels" from="'true'"><default-field><hidden/></default-field></field><field name="shipmentMethodEnumId" from="firstRouteSegment.shipmentMethodEnumId"><default-field title="Return By"><drop-down><entity-options key="${shipmentMethodEnumId}" text="${description}"><entity-find entity-name="mantle.shipment.carrier.CarrierShipmentMethod" list="carrierShipmentMethods"><econdition field-name="carrierPartyId" from="firstRouteSegment.carrierPartyId"/><order-by field-name="sequenceNum,description"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Get Return Label"><submit/></default-field></field></form-single></container-dialog><link url="removeShipmentLabelInfo" text="Reset Label" btn-type="danger" confirmation="Clear label data? This will allow getting a new label, and system keeps a history of label IDs, but otherwise current label will no longer be tracked. Use only when there are errors, etc with the label." condition="shippingGatewayConfigId && packageRouteSeg?.gatewayLabelId" parameter-map="[shipmentId:shipmentId, shipmentPackageSeqId:shipmentPackage.shipmentPackageSeqId,                                 shipmentRouteSegmentSeqId:packageRouteSeg.shipmentRouteSegmentSeqId]"/><link url="removeShipmentReturnLabelInfo" text="Reset Ret Label" btn-type="danger" confirmation="Clear return label data? This will allow getting a new label, and system keeps a history of label IDs, but otherwise current label will no longer be tracked. Use only when there are errors, etc with the label." condition="shippingGatewayConfigId && packageRouteSeg?.returnGatewayLabelId" parameter-map="[shipmentId:shipmentId, shipmentPackageSeqId:shipmentPackage.shipmentPackageSeqId,                                 shipmentRouteSegmentSeqId:packageRouteSeg.shipmentRouteSegmentSeqId]"/><link url="resetShipmentPackage" text="Reset Pkg" confirmation="Reset box type, weight, and contents?" style="btn-danger" condition="!packageRouteSeg?.labelUrl" parameter-map="[shipmentId:packageAndRouteSeg.shipmentId, shipmentPackageSeqId:packageAndRouteSeg.shipmentPackageSeqId]"/><link url="deletePackage" text="Delete" condition="!shipmentPackageContentList" style="btn-danger" confirmation="Delete package ${shipmentPackage.shipmentPackageSeqId}?" parameter-map="[shipmentId:shipmentId, shipmentPackageSeqId:shipmentPackage.shipmentPackageSeqId]"/><link url="${packageRouteSeg.labelUrl}" text="Label" url-type="plain" target-window="_blank" btn-type="info" icon="fa fa-download" condition="packageRouteSeg?.labelUrl"/><link url="getShipmentLabel" text="Label" target-window="_blank" btn-type="info" icon="fa fa-download" condition="packageRouteSeg?.labelImage" parameter-map="[shipmentId:shipmentId, shipmentPackageSeqId:packageRouteSeg.shipmentPackageSeqId, shipmentRouteSegmentSeqId:packageRouteSeg.shipmentRouteSegmentSeqId]"/><section name="QzPrintLabelSection" condition="packageRouteSeg?.labelUrl || packageRouteSeg?.labelImage"><widgets><render-mode><text type="vuet"><![CDATA[<button v-if="$root.qzVue" class="btn btn-default btn-sm" onclick="moqui.printUrlLabel('${getShipmentLabelPath}?shipmentId=${packageRouteSeg.shipmentId}&shipmentPackageSeqId=${packageRouteSeg.shipmentPackageSeqId}&shipmentRouteSegmentSeqId=${packageRouteSeg.shipmentRouteSegmentSeqId}')"><i class="fa fa-print"></i> Label</button>]]></text></render-mode></widgets></section><link url="${packageRouteSeg.returnLabelUrl}" text="Ret Label" url-type="plain" target-window="_blank" btn-type="info" icon="fa fa-download" condition="packageRouteSeg?.returnLabelUrl"/><link url="getShipmentLabel" text="Ret Label" target-window="_blank" btn-type="info" icon="fa fa-download" condition="packageRouteSeg?.returnLabelImage" parameter-map="[retLabel:'true', shipmentId:shipmentId, shipmentPackageSeqId:packageRouteSeg.shipmentPackageSeqId, shipmentRouteSegmentSeqId:packageRouteSeg.shipmentRouteSegmentSeqId]"/><section name="QzPrintRetLabelSection" condition="packageRouteSeg?.returnLabelUrl || packageRouteSeg?.returnLabelImage"><widgets><render-mode><text type="vuet"><![CDATA[<button v-if="$root.qzVue" class="btn btn-default btn-sm" onclick="moqui.printUrlLabel('${getShipmentLabelPath}?retLabel=true&shipmentId=${packageRouteSeg.shipmentId}&shipmentPackageSeqId=${packageRouteSeg.shipmentPackageSeqId}&shipmentRouteSegmentSeqId=${packageRouteSeg.shipmentRouteSegmentSeqId}')"><i class="fa fa-print"></i> Ret Lbl</button>]]></text></render-mode></widgets></section><container-dialog id="PrintLabelDialog" button-text="Net Print" type="success" condition="(packageRouteSeg?.labelUrl || packageRouteSeg?.labelImage != null) && networkPrinterList"><form-single name="PrintShipmentLabel" transition="printShipmentLabels" pass-through-parameters="true"><field name="shipmentId"><default-field><hidden/></default-field></field><field name="shipmentPackageSeqId" from="shipmentPackage.shipmentPackageSeqId"><default-field><hidden/></default-field></field><field name="shipmentRouteSegmentSeqId" from="packageRouteSeg.shipmentRouteSegmentSeqId"><default-field><hidden/></default-field></field><field name="networkPrinterId" from="defaultNetworkPrinterId"><default-field title="Printer"><drop-down><list-options list="networkPrinterList" key="${networkPrinterId}" text="${description ?: printerName} (${serverHost})"/></drop-down></default-field></field><field name="makeDefaultPrinter"><default-field title="Make Default"><check><option key="true" text=" "/></check></default-field></field><field name="returnLabels"><default-field title=""><radio no-current-selected-key="false"><option key="false" text="Outgoing Labels"/><option key="true" text="Return Labels"/></radio></default-field></field><field name="submitButton"><default-field title="Print"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><container-row><row-col sm="2"><label text="Box" type="strong"/></row-col><row-col sm="6"><label text="${shipmentBoxType?.description?:'N/A'} - ${ec.l10n.format(shipmentPackage.weight, '0.0#')?:'N/A'} ${weightUom?.description?:''}" type="strong"/></row-col><row-col sm="2"><label text="Status" type="strong" condition="trackingStatusEnum"/></row-col><row-col sm="2"><label text="${trackingStatusEnum?.description?:'N/A'}${packageRouteSeg.trackingSubStatus ? ' (' + packageRouteSeg.trackingSubStatus + ')' : ''}" condition="trackingStatusEnum"/></row-col></container-row><container-row><row-col sm="2"><label text="Tracking" type="strong" condition="packageRouteSeg?.trackingCode"/></row-col><row-col sm="6"><label text="${packageRouteSeg?.trackingCode?:'N/A'}" type="div" condition="packageRouteSeg?.trackingCode"/></row-col><row-col sm="2"><label text="Amount" type="strong" condition="packageRouteSeg?.estimatedAmount"/></row-col><row-col sm="2"><label text="${ec.l10n.format(packageRouteSeg?.estimatedAmount, '#,##0.00')}" style="text-success" condition="packageRouteSeg?.estimatedAmount"/></row-col></container-row><section name="InsuranceSection" condition="packageRouteSeg?.insuredAmount || packageRouteSeg?.insuranceAmount"><widgets><container-row><row-col sm="1"><label text="Insured Amt" type="strong"/></row-col><row-col sm="2"><label text="${packageRouteSeg.insuredAmount?:'N/A'}"/></row-col><row-col sm="1"><label text="Ins. Cost" type="strong"/></row-col><row-col sm="1"><label text="${packageRouteSeg.insuranceAmount?:'N/A'}"/></row-col></container-row></widgets></section><container-row><row-col sm="2"><label text="Gateway" type="strong" condition="packageRouteSeg?.gatewayStatus"/></row-col><row-col sm="2"><label text="${packageRouteSeg?.gatewayStatus?:'N/A'}" condition="packageRouteSeg?.gatewayStatus"/></row-col><row-col sm="2"><label text="Message" type="strong" condition="packageRouteSeg?.gatewayMessage"/></row-col><row-col sm="6"><label text="${packageRouteSeg?.gatewayMessage?:'N/A'}" condition="packageRouteSeg?.gatewayMessage"/></row-col></container-row><section name="LabelRefundSection" condition="packageRouteSeg?.gatewayRefundStatus"><widgets><container-row><row-col sm="2"><label text="Refund" type="strong"/></row-col><row-col sm="2"><label text="${packageRouteSeg?.gatewayRefundStatus?:'N/A'}"/></row-col><row-col sm="2"><label text="Refund ID" type="strong"/></row-col><row-col sm="6"><label text="${packageRouteSeg?.gatewayRefundId?:'N/A'}"/></row-col></container-row></widgets></section><section name="LabelReturnSection" condition="hasReturnLabel"><widgets><container-row><row-col sm="2"><label text="Ret Tracking" type="strong"/></row-col><row-col sm="6"><label text="${packageRouteSeg?.returnTrackingCode?:'N/A'}"/></row-col><row-col sm="2"><label text="Ret Status" type="strong" condition="returnTrackingStatusEnum"/></row-col><row-col sm="2"><label text="${returnTrackingStatusEnum?.description?:'N/A'}" condition="returnTrackingStatusEnum"/></row-col></container-row></widgets></section></box-body><box-body-nopad><form-list name="ShipmentPackageContentList" list="shipmentPackageContentList" transition="updatePackageContent"><field name="shipmentId"><default-field><hidden/></default-field></field><field name="shipmentPackageSeqId"><default-field><hidden/></default-field></field><field name="productId"><default-field title="Product"><display-entity entity-name="mantle.product.Product" text="ProductNameTemplate"/></default-field></field><field name="quantity"><default-field><text-line size="6"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-list></box-body-nopad></container-box></widgets></section-iterate></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Shipping/PackShipment.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Pack Shipment" default-menu-include="false"><parameter name="shipmentId" required="true"/><subscreens default-item="PackSummary"/><widgets><subscreens-panel id="PackPanel" type="tab"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Shipping/dashboard.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Dashboard" default-menu-index="1"><transition name="findOrder"><default-response url="//${appRoot}/Order/FindOrder"/></transition><transition name="packShipment"><default-response url="//${appRoot}/Shipping/PackShipment"/></transition><transition name="selectAsset"><default-response url="//${appRoot}/Asset/SelectAsset"/></transition><actions><entity-find entity-name="moqui.basic.EnumGroupMember" list="productItemTypeEgms" cache="true"><econdition field-name="enumGroupEnumId" value="EngItemsProduct"/></entity-find><set field="itemTypeEnumIdList" from="productItemTypeEgms*.enumId"/><entity-find entity-name="mantle.facility.FacilityShippingReservationSummary" list="fsrsList"><econdition field-name="partStatusId" value="OrderApproved"/><select-field field-name="facilityId,shipmentMethodEnumId,carrierPartyId,quantity,quantityNotAvailable,quantityNotIssued"/></entity-find><entity-find entity-name="mantle.facility.FacilityShippingReservationSummary" list="fsrsPickList"><econdition field-name="partStatusId" value="OrderApproved"/><econdition field-name="locationTypeEnumId" value="FltPick"/><select-field field-name="facilityId,shipmentMethodEnumId,carrierPartyId,quantity,quantityNotAvailable,quantityNotIssued"/></entity-find></actions><widgets><container-row><row-col md="6"><link url="../Picklist" text="Picklists"/><link url="../PickLocationMoves" text="Pick Location Moves"/><link url="selectAsset" text="Move Assets"/></row-col><row-col md="6"><form-single name="PackShipmentForm" transition="packShipment" focus-field="shipmentId"><field name="shipmentId"><default-field title=""><text-line size="20"/></default-field></field><field name="packButton"><default-field title="Pack Shipment"><submit/></default-field></field><field-layout><field-row-big><field-ref name="shipmentId"/><field-ref name="packButton"/></field-row-big></field-layout></form-single></row-col></container-row><form-list name="FacilitySummary" list="facilitySummaryList" skip-form="true" paginate-always-show="false"><entity-find entity-name="mantle.facility.FacilityShippingSummary"><search-form-inputs default-order-by="pseudoId,shipmentMethodSequenceNum,carrierPartyId"/><econdition field-name="facilityTypeEnumId" value="FcTpWarehouse"/><econdition field-name="partStatusId" value="OrderApproved"/><econdition field-name="vendorRoleTypeId" value="OrgInternal"/><econdition field-name="itemTypeEnumId" operator="in" from="itemTypeEnumIdList"/><select-field field-name="facilityId,pseudoId,facilityName,shipmentMethodEnumId"/></entity-find><row-actions><entity-find-one entity-name="moqui.basic.Enumeration" value-field="shipMethEnum" cache="true"><field-map field-name="enumId" from="shipmentMethodEnumId"/></entity-find-one><set field="resSummary" from="fsrsList.find({ it.facilityId == facilityId && it.shipmentMethodEnumId == shipmentMethodEnumId && it.carrierPartyId == carrierPartyId})"/><set field="resPickSummary" from="fsrsPickList.find({ it.facilityId == facilityId && it.shipmentMethodEnumId == shipmentMethodEnumId && it.carrierPartyId == carrierPartyId})"/><set field="resQuantity" from="resSummary?.quantity ?: 0.0"/><set field="resPickQuantity" from="resPickSummary?.quantity ?: 0.0"/></row-actions><field name="pseudoId"><header-field title="Facility" show-order-by="true"/><default-field><display text="FacilityNameTemplate"/></default-field></field><field name="shipmentMethodSequenceNum"><header-field title="Ship Method" show-order-by="true"/><default-field><display text="${shipmentMethodSequenceNum != null ? shipmentMethodSequenceNum + ' - ' : ''}${shipMethEnum?.description ?: ''}"/></default-field></field><field name="carrierPartyId"><header-field title="Carrier" show-order-by="true"/><default-field><display-entity entity-name="mantle.party.Party" text="${carrierPartyId == '_NA_' ? 'N/A' : pseudoId}"/></default-field></field><field name="quantityTotal"><default-field title="Appr Order Qty"><link url="findOrder" link-type="anchor" text="${ec.l10n.format(quantityTotal, '#,##0.###')}" parameter-map="[orderType:'Sales', statusId:'OrderApproved', facilityId:facilityId, shipmentMethodEnumId:shipmentMethodEnumId, carrierPartyId:carrierPartyId]"/></default-field></field><field name="quantityNotAvailable" from="resSummary?.quantityNotAvailable"><default-field title="Not Avail"><display/></default-field></field><field name="quantityNotIssued" from="resSummary?.quantityNotIssued"><default-field title="Not Issued"><display/></default-field></field><field name="resPickQuantity"><default-field title="Pick Loc Qty"><display style="${(resPickQuantity == resQuantity) ? 'text-success' : 'text-danger'}"/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Shipping/Picklist/BulkPicklist.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Bulk Create Picklists" default-menu-include="false"><transition name="shipmentDetail"><default-response url="//${appRoot}/Shipment/ShipmentDetail"/></transition><transition name="orderDetail"><default-response url="//${appRoot}/Order/OrderDetail"/></transition><transition name="editFacility"><default-response url="//${appRoot}/Facility/EditFacility"/></transition><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition name="editSupplier"><default-response url="//${appRoot}/Supplier/EditSupplier"/></transition><transition name="editCustomer"><default-response url="//${appRoot}/Customer/EditCustomer"/></transition><transition name="createPicklists" begin-transaction="false"><service-call name="mantle.work.ShipmentWorkServices.create#ShipmentLoadsForOrders" in-map="true" out-map="context" multi="parameter"/><default-response url="." parameter-map="ec.web?.requestParameters"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getFacilityList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><actions><set field="excludeOnPicklist" from="excludeOnPicklist ?: 'true'"/><set field="excludeNotPickLoc" from="excludeNotPickLoc ?: 'true'"/><entity-find entity-name="moqui.basic.EnumGroupMember" list="productItemTypeEgms" cache="true"><econdition field-name="enumGroupEnumId" value="EngItemsProduct"/></entity-find><set field="itemTypeEnumIdList" from="productItemTypeEgms*.enumId"/><set field="facilityId" from="facilityId ?: ec.user.getPreference('FacilityActive') ?: ec.user.getPreference('FacilityGeneralDefault')"/><service-call name="mantle.work.ShipmentWorkServices.make#ShipmentLoadOrderConditions" out-map="context" in-map="[excludeOnPicklist:excludeOnPicklist, inventoryCategoryId:inventoryCategoryId]"/></actions><widgets><label text="Use Find Options to search for orders and when you have the set you want use the form to create picklists." type="p"/><section name="CheckOptionsSection" condition="facilityId"><widgets><form-single name="CreatePicklistsForm" transition="createPicklists" pass-through-parameters="true"><field name="facilityId"><default-field title="Facility"><display-entity entity-name="mantle.facility.Facility" text="FacilityNameTemplate"/></default-field></field><field name="workEffortName"><default-field title="Name Prefix"><text-line size="30"/></default-field></field><field name="ordersPerPicklist"><default-field title="Orders per Pick"><text-line size="8"/></default-field></field><field name="estimatedStartDate" from="ec.user.nowTimestamp"><default-field title="Start Date"><date-time/></default-field></field><field name="estimatedWorkDuration"><default-field title="Est. Hours"><text-line size="4" default-value="1"/></default-field></field><field name="submitButton"><default-field title="Create Picklists"><submit confirmation="Do the current find options and orders displayed match what you want to create picklists for?"/></default-field></field><field-layout><field-row-big><field-ref name="facilityId"/><field-ref name="workEffortName"/><field-ref name="ordersPerPicklist"/><field-ref name="estimatedStartDate"/><field-ref name="estimatedWorkDuration"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single></widgets><fail-widgets><label text="You must at least select a Facility." style="text-warning" type="p"/></fail-widgets></section><form-list name="AddOrderList" list="orderList" transition="" skip-form="true" multi="false" header-dialog="true" select-columns="true" saved-finds="true" extends="component://SimpleScreens/screen/SimpleScreens/Shipping/Picklist/AddOrder.xml#AddOrderList"><hidden-parameters><parameter name="workEffortId" from="null"/></hidden-parameters><field name="_useRowSubmit"><default-field><ignored/></default-field></field><field name="_rowSubmit"><default-field><ignored/></default-field></field><field name="binLocationNumber"><default-field><ignored/></default-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field><default-field><ignored/></default-field></field><form-list-column><field-ref name="shipmentMethodSequenceNum"/><field-ref name="carrierPartyId"/><field-ref name="shipments"/></form-list-column><form-list-column><field-ref name="placedDate"/><field-ref name="shipBeforeDate"/><field-ref name="entryDate"/></form-list-column><form-list-column><field-ref name="orderId"/><field-ref name="otherPartyOrderId"/><field-ref name="salesChannelEnumId"/></form-list-column><form-list-column><field-ref name="partStatusId"/><field-ref name="facilityId"/><field-ref name="productStoreId"/></form-list-column><form-list-column><field-ref name="vendorPartyId"/><field-ref name="customerPartyId"/></form-list-column><form-list-column><field-ref name="partTotal"/><field-ref name="quantityTotal"/><field-ref name="resPickLocQuantity"/></form-list-column></form-list><section name="ShowSql" condition="orderList_xafind?.getQueryTextList()"><widgets><container-dialog id="ShowSqlDialog" button-text="Show SQL" type="info"><section-iterate name="ShowSqlIter" list="orderList_xafind?.getQueryTextList()" entry="queryText"><widgets><label text="${queryText}" type="p"/><label text="${orderList_xafind}" type="p"/></widgets></section-iterate></container-dialog></widgets></section></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Shipping/Picklist/FindPicklist.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Picklists" default-menu-include="false"><transition name="createPicklist"><service-call name="mantle.work.ShipmentWorkServices.create#ShipmentLoadShip" in-map="true" out-map="context" multi="parameter"/><default-response url="../PicklistDetail"/></transition><transition name="picklistDetail"><default-response url="../PicklistDetail"/></transition><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition name="editFacility"><default-response url="//${appRoot}/Facility/EditFacility"/></transition><transition name="shipmentDetail"><default-response url="//${appRoot}/Shipment/ShipmentDetail"/></transition><transition name="equipmentDetail"><default-response url="//${appRoot}/Asset/AssetDetail"/></transition><transition-include name="getFacilityList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition-include name="getAssetList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><widgets><container><container-dialog id="NewPicklistContainer" button-text="New Picklist"><form-single name="NewPicklist" transition="createPicklist"><field name="facilityId"><default-field title="Facility"><drop-down><dynamic-options transition="getFacilityList" server-search="true" min-length="0" parameter-map="[facilityTypeEnumId:'FcTpWarehouse,FcTpDock']"/></drop-down></default-field></field><field name="ownerPartyId"><default-field title="Owner Org"><drop-down allow-empty="true"><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></default-field></field><field name="productStoreId"><default-field title="Store"><drop-down allow-empty="true"><entity-options key="${productStoreId}" text="${productStoreId}: ${storeName}"><entity-find entity-name="mantle.product.store.ProductStore"><order-by field-name="storeName"/></entity-find></entity-options></drop-down></default-field></field><field name="workEffortName"><default-field title="Name"><text-line size="40"/></default-field></field><field name="estimatedStartDate" from="ec.user.nowTimestamp"><default-field title="Est. Start"><date-time/></default-field></field><field name="estimatedWorkDuration"><default-field title="Est. Hours"><text-line size="8" default-value="1"/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><link url="../BulkPicklist" text="Bulk Create Picklists"/></container><form-list name="PicklistList" list="picklistList" skip-form="true" header-dialog="true" select-columns="true" saved-finds="true"><entity-find entity-name="mantle.work.effort.WorkEffortShipmentLoadFind" list="picklistList" use-clone="true"><search-form-inputs default-order-by="estimatedStartDate"><default-parameters statusId="WeInPlanning,WeApproved,WeInProgress,WeOnHold" statusId_op="in"/></search-form-inputs><econdition field-name="purposeEnumId" value="WepShipmentShip"/><select-field field-name="workEffortName,facilityOwnerPartyId"/></entity-find><row-actions><entity-find entity-name="mantle.work.effort.WorkEffortAndPartyDetail" list="weapdList"><date-filter/><econdition field-name="workEffortId"/><order-by field-name="firstName,organizationName"/></entity-find><entity-find entity-name="mantle.work.effort.WorkEffortAssetAndAssign" list="assetList" use-clone="true"><date-filter/><econdition field-name="workEffortId"/><order-by field-name="assetName"/></entity-find><entity-find entity-name="mantle.shipment.Shipment" list="shipmentList" use-clone="true"><econdition field-name="shipWorkEffortId" from="workEffortId"/><order-by field-name="shipmentId"/></entity-find></row-actions><field name="statusId"><header-field title="Status" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="WorkEffort"/><set field="allowMultiple" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="estimatedStartDate"><header-field title="Start Date" show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="workEffortId"><header-field title="Picklist" show-order-by="true"><text-find size="10" hide-options="true"/></header-field><default-field><link url="picklistDetail" text="WorkEffortNameTemplate" link-type="anchor"/></default-field></field><field name="facilityId"><header-field title="Facility" show-order-by="true"><drop-down allow-empty="true"><dynamic-options transition="getFacilityList" server-search="true" min-length="0" parameter-map="[facilityTypeEnumId:'FcTpWarehouse,FcTpDock']"/></drop-down></header-field><default-field><link url="editFacility" entity-name="mantle.facility.Facility" text="FacilityNameTemplate" link-type="anchor"/></default-field></field><field name="productStoreId"><header-field title="Store" show-order-by="true"><drop-down allow-empty="true"><entity-options key="${productStoreId}" text="${productStoreId}: ${storeName}"><entity-find entity-name="mantle.product.store.ProductStore"><order-by field-name="storeName"/></entity-find></entity-options></drop-down></header-field><default-field><display-entity entity-name="mantle.product.store.ProductStore" text="${productStoreId}: ${storeName}"/></default-field></field><field name="ownerPartyId"><header-field title="Owner Org"><drop-down allow-empty="true"><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></header-field><default-field><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameTemplate"/></default-field></field><field name="partyId"><header-field title="Person"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="0" parameter-map="[roleTypeId:'Employee,Worker']"/></drop-down></header-field></field><field name="partyList"><default-field title="People"><section-iterate name="PartyList" list="weapdList" entry="weapd"><widgets><container><link url="editParty" text="PartyNameTemplate" text-map="weapd" link-type="anchor" parameter-map="[partyId:weapd.partyId]"/></container></widgets></section-iterate></default-field></field><field name="assetId"><header-field title="Equipment"><drop-down allow-empty="true"><dynamic-options transition="getAssetList" server-search="true" min-length="0" parameter-map="[assetTypeEnumId:'AstTpEquipment']"/></drop-down></header-field></field><field name="assetList"><default-field title="Equipment"><section-iterate name="AssetList" list="assetList" entry="asset"><widgets><container><link url="equipmentDetail" text="AssetNameTemplate" text-map="asset" link-type="anchor" parameter-map="[assetId:asset.assetId]"/></container></widgets></section-iterate></default-field></field><field name="shipmentId"><header-field title="Shipments"><text-find size="10" hide-options="true"/></header-field></field><field name="shipmentList"><default-field title="Shipments"><section-iterate name="ShipmentList" list="shipmentList" entry="shipment"><widgets><container><link url="shipmentDetail" text="${shipment.shipmentId}" link-type="anchor" parameter-map="[shipmentId:shipment.shipmentId]"/></container></widgets></section-iterate></default-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field><default-field><display text=" "/></default-field></field><form-list-column><field-ref name="workEffortId"/><field-ref name="estimatedStartDate"/></form-list-column><form-list-column><field-ref name="statusId"/><field-ref name="facilityId"/></form-list-column><form-list-column><field-ref name="productStoreId"/><field-ref name="ownerPartyId"/></form-list-column><form-list-column><field-ref name="partyList"/></form-list-column><form-list-column><field-ref name="assetList"/><field-ref name="shipmentList"/></form-list-column><form-list-column><field-ref name="submitButton"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Shipping/Picklist/ShipmentLoadPick.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="workEffortId" required="true"/><actions><service-call name="mantle.shipment.ShipmentServices.get#ShipmentLoadPickInfo" in-map="[workEffortId:workEffortId]" out-map="context"/></actions><widgets><render-mode><text type="xsl-fo" location="component://SimpleScreens/template/shipment/ShipmentLoadPick.xsl-fo.ftl" template="true" encode="false" no-boundary-comment="true"/></render-mode></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Shipping/Picklist/ShipmentLoadPickAndPack.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="workEffortId" required="true"/><actions><service-call name="mantle.shipment.ShipmentServices.get#ShipmentLoadPickInfo" in-map="[workEffortId:workEffortId]" out-map="context"/></actions><widgets><render-mode><text type="xsl-fo" location="component://SimpleScreens/template/shipment/ShipmentLoadPickAndPack.xsl-fo.ftl" template="true" encode="false" no-boundary-comment="true"/></render-mode></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Shipping/Picklist/PicklistDetail.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Picklist" default-menu-index="1"><parameter name="workEffortId" from="workEffortId ?: workEffortId_0" required="true"/><parameter name="workEffortId_0"/><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition name="shipmentDetail"><default-response url="//${appRoot}/Shipment/ShipmentDetail"/></transition><transition name="packShipment"><default-response url="//${appRoot}/Shipping/PackShipment"/></transition><transition name="equipmentDetail"><default-response url="//${appRoot}/Asset/AssetDetail"/></transition><transition name="orderDetail"><default-response url="//${appRoot}/Order/OrderDetail"/></transition><transition name="editCustomer"><default-response url="//${appRoot}/Customer/EditCustomer"/></transition><transition name="addShipment"><default-response url="../AddShipment"/></transition><transition name="removeShipment"><parameter name="shipmentId"/><service-call name="update#mantle.shipment.Shipment" in-map="[shipmentId:shipmentId, shipWorkEffortId:null, binLocationNumber:null]" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="completeShipmentLoadShip"><service-call name="mantle.work.ShipmentWorkServices.complete#ShipmentLoadShip" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="closeShipmentLoadShip"><service-call name="mantle.work.ShipmentWorkServices.close#ShipmentLoadShip" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="setStatusFromShipments"><service-call name="mantle.work.ShipmentWorkServices.set#ShipmentLoadStatusFromShipments" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateShipmentLoad"><service-call name="update#mantle.work.effort.WorkEffort" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateShipment"><service-call name="update#mantle.shipment.Shipment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="addAssetAssign"><service-call name="create#mantle.work.effort.WorkEffortAssetAssign" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateAssetAssign"><service-call name="update#mantle.work.effort.WorkEffortAssetAssign" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="addAssignment"><service-call name="create#mantle.work.effort.WorkEffortParty" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateAssignment"><service-call name="update#mantle.work.effort.WorkEffortParty" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getFacilityList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition-include name="getAssetList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition name="Picklist.pdf"><default-response url="${ec.web.getWebappRootUrl(false, null)}/fop/apps/${appRoot}/Shipping/Picklist/ShipmentLoadPick" url-type="plain"><parameter name="renderMode" value="xsl-fo"/><parameter name="pageNoLimit" value="true"/><parameter name="workEffortId"/><parameter name="filename" value="Picklist-${workEffortId}.pdf"/></default-response></transition><transition name="PicklistAndPackSheets.pdf"><default-response url="${ec.web.getWebappRootUrl(false, null)}/fop/apps/${appRoot}/Shipping/Picklist/ShipmentLoadPickAndPack" url-type="plain"><parameter name="renderMode" value="xsl-fo"/><parameter name="pageNoLimit" value="true"/><parameter name="workEffortId"/><parameter name="filename" value="PicklistAndPackSheets-${workEffortId}.pdf"/></default-response></transition><actions><entity-find-one entity-name="mantle.work.effort.WorkEffort" value-field="workEffort"/><set field="statusId" from="workEffort?.statusId"/><set field="statusChangeTransition" value="updateShipmentLoad"/><set field="changedEntityName" value="mantle.work.effort.WorkEffort"/><set field="pkPrimaryValue" from="workEffortId"/><entity-find-count entity-name="mantle.shipment.Shipment" count-field="shipmentCount"><econdition field-name="shipWorkEffortId" from="workEffortId"/></entity-find-count><entity-find entity-name="mantle.work.effort.WorkEffortAssetAndAssign" list="assetList"><date-filter/><econdition field-name="workEffortId"/><order-by field-name="assetName"/></entity-find><entity-find entity-name="mantle.work.effort.WorkEffortAndPartyDetail" list="weapdList"><date-filter/><econdition field-name="workEffortId"/><order-by field-name="firstName,organizationName"/></entity-find></actions><widgets><container-row><row-col lg="6"><link url="Picklist.pdf" text="Picklist PDF"/><link url="PicklistAndPackSheets.pdf" text="Picklist and Pack PDF"/><form-single name="UpdateShipmentLoad" transition="updateShipmentLoad" map="workEffort"><field name="workEffortId"><default-field title="ID"><display/></default-field></field><field name="workEffortName"><default-field title="Name"><text-line size="40"/></default-field></field><field name="facilityId"><default-field title="Facility"><drop-down><dynamic-options transition="getFacilityList" server-search="true" min-length="0" parameter-map="[facilityTypeEnumId:'FcTpWarehouse,FcTpDock']"/></drop-down></default-field></field><field name="ownerPartyId"><default-field title="Owner Org"><drop-down allow-empty="true"><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></default-field></field><field name="productStoreId"><default-field title="Store"><drop-down allow-empty="true"><entity-options key="${productStoreId}" text="${productStoreId}: ${storeName}"><entity-find entity-name="mantle.product.store.ProductStore"><order-by field-name="storeName"/></entity-find></entity-options></drop-down></default-field></field><field name="estimatedStartDate"><default-field title="Est. Start"><date-time/></default-field></field><field name="estimatedWorkDuration"><default-field title="Est. Hours"><text-line size="8"/></default-field></field><field name="actualStartDate"><default-field title="Actual Start"><date-time/></default-field></field><field name="actualCompletionDate"><default-field title="Actual Complete"><date-time/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field-layout><field-row><field-ref name="workEffortId"/><field-ref name="workEffortName"/></field-row><fields-not-referenced/><field-row><field-ref name="estimatedStartDate"/><field-ref name="estimatedWorkDuration"/></field-row><field-row><field-ref name="actualStartDate"/><field-ref name="actualCompletionDate"/></field-row><field-ref name="submitButton"/></field-layout></form-single></row-col><row-col lg="6"><container-box><box-header title="Status: ${workEffort.status?.description ?: statusId}"/><box-toolbar><link url="updateShipmentLoad" text="Approve" parameter-map="[statusId:'WeApproved']" condition="shipmentCount && statusId == 'WeInPlanning'" btn-type="success"/><link url="updateShipmentLoad" text="Begin (In Progress)" parameter-map="[statusId:'WeInProgress']" condition="shipmentCount && statusId in ['WeInPlanning', 'WeApproved']"/><link url="completeShipmentLoadShip" text="Force Complete" btn-type="warning" condition="shipmentCount && !(statusId in ['WeInPlanning', 'WeComplete', 'WeClosed', 'WeCancelled'])" confirmation="Remove all Shipments in the Input and Scheduled statuses and set Picklist status to Complete (or Cancelled if no remaining Shipments or all remaining are Cancelled)?"/><link url="closeShipmentLoadShip" text="Force Close" btn-type="danger" condition="!(statusId in ['WeClosed', 'WeCancelled'])" confirmation="Remove all Shipments in the Input, Scheduled, Picked, and Packed statuses and set Picklist status to Closed (or Cancelled if no remaining Shipments or all remaining are Cancelled)?"/><link url="setStatusFromShipments" text="Auto Set" confirmation="Auto set status from Shipment statuses?"/></box-toolbar><box-body-nopad/></container-box><section-include name="StatusHistorySection" location="component://SimpleScreens/template/basic/StatusWidgets.xml"/><section name="OldStatusSection" condition="allStatus"><widgets><section-include name="StatusChangeAndHistorySection" location="component://SimpleScreens/template/basic/StatusWidgets.xml"/></widgets></section></row-col></container-row><container-box><box-header title="Shipments"/><box-toolbar><link url="addShipment" text="Add Shipments"/></box-toolbar><box-body><form-list name="ListShipments" list="shipmentList" transition="updateShipment" multi="true"><entity-find entity-name="mantle.shipment.ShipmentFindView" list="shipmentList"><econdition field-name="shipWorkEffortId" from="workEffortId"/><select-field field-name="shipmentMethodEnumId"/><order-by field-name="binLocationNumber,shipmentMethodSequenceNum,shipmentId"/></entity-find><row-actions><entity-find-one entity-name="moqui.basic.Enumeration" value-field="shipMethEnum" cache="true"><field-map field-name="enumId" from="shipmentMethodEnumId"/></entity-find-one><entity-find entity-name="mantle.party.PartyClassificationAndAppl" list="custPcaaList"><date-filter/><econdition field-name="partyId" from="toPartyId"/><econdition field-name="classificationTypeEnumId" value="PcltCustomer"/></entity-find><entity-find entity-name="mantle.shipment.ShipmentItemSource" list="sisList" distinct="true"><econdition field-name="shipmentId"/><select-field field-name="orderId"/></entity-find><entity-find entity-name="mantle.order.OrderHeader" list="orderHeaderList"><econdition field-name="orderId" operator="in" from="sisList*.orderId"/><select-field field-name="orderId,salesChannelEnumId"/></entity-find><entity-find entity-name="mantle.shipment.ShipmentItemSourceSummary" list="sisSummaryList"><econdition field-name="shipmentId"/><select-field field-name="quantity,quantityNotHandled"/></entity-find><set field="quantityTotal" from="sisSummaryList.first()?.quantity ?: 0.0"/><set field="quantityNotHandled" from="sisSummaryList.first()?.quantityNotHandled ?: 0.0"/><entity-find entity-name="mantle.product.issuance.AssetAndReservationSummary" list="resPickLocList"><econdition field-name="shipmentId"/><econdition field-name="locationTypeEnumId" value="FltPick"/><select-field field-name="quantity"/></entity-find><set field="resPickLocQuantity" from="resPickLocList.first()?.quantity ?: 0.0"/><set field="_rowSubmit" from="(resPickLocQuantity == quantityTotal) ? 'true' : 'false'"/></row-actions><field name="shipmentId"><default-field><hidden/></default-field></field><field name="workEffortId"><default-field><hidden/></default-field></field><field name="binLocationNumber"><default-field title="Pick Bin #"><text-line size="4"/></default-field></field><field name="shipmentMethodSequenceNum"><default-field title="Ship Method"><display text="${shipmentMethodSequenceNum != null ? shipmentMethodSequenceNum + ' - ' : ''}${shipMethEnum?.description ?: ''}"/></default-field></field><field name="shipmentLink"><default-field title="Shipment"><link url="shipmentDetail" text="${shipmentId}" link-type="anchor"/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem" also-hidden="false"/></default-field></field><field name="shipmentTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration" also-hidden="false"/></default-field></field><field name="originFacilityId"><default-field title="Facility"><display-entity entity-name="mantle.facility.Facility" text="FacilityNameTemplate" also-hidden="false" style="${originFacilityId == workEffort.facilityId ? 'text-success' : 'text-danger'}"/></default-field></field><field name="toPartyId"><default-field title="To Party"><link url="editCustomer" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" link-type="anchor" parameter-map="[partyId:toPartyId]"/><label text=" - ${custPcaaList*.description.join(', ')}" condition="custPcaaList"/></default-field></field><field name="orderIds"><default-field title="Orders"><section-iterate name="OrderSisList" list="orderHeaderList" entry="orderHeader"><widgets><link url="orderDetail" text="${orderHeader.orderId}" link-type="anchor" condition="orderHeader.orderId" parameter-map="[orderId:orderHeader.orderId]"/><label text=" - ${orderHeader.salesChannel?.description?:''}" condition="orderHeader.salesChannelEnumId"/></widgets></section-iterate></default-field></field><field name="otherPartyOrderId"><default-field title="Their Order"><display also-hidden="false"/></default-field></field><field name="entryDate"><default-field title="Entry Date"><display also-hidden="false"/></default-field></field><field name="estimatedReadyDate"><default-field title="Ready Date"><display also-hidden="false"/></default-field></field><field name="quantityTotal" align="center"><default-field title="Quantity Total"><display/></default-field></field><field name="resPickLocQuantity" align="center"><default-field title="Pick Loc Qty"><display style="text-strong ${(resPickLocQuantity == quantityTotal) ? 'text-success' : 'text-danger'}"/></default-field></field><field name="packButton"><default-field title=""><link url="packShipment" text="Pack"/></default-field></field><field name="removeButton"><default-field title=""><link url="removeShipment" text=" " icon="fa fa-trash"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><form-list-column><field-ref name="binLocationNumber"/></form-list-column><form-list-column><field-ref name="shipmentMethodSequenceNum"/></form-list-column><form-list-column><field-ref name="statusId"/></form-list-column><form-list-column><field-ref name="shipmentLink"/><field-ref name="shipmentTypeEnumId"/></form-list-column><form-list-column><field-ref name="toPartyId"/><field-ref name="originFacilityId"/></form-list-column><form-list-column><field-ref name="orderIds"/><field-ref name="otherPartyOrderId"/></form-list-column><form-list-column><field-ref name="entryDate"/><field-ref name="estimatedReadyDate"/></form-list-column><form-list-column><field-ref name="quantityTotal"/><field-ref name="resPickLocQuantity"/></form-list-column><form-list-column><field-ref name="packButton"/></form-list-column><form-list-column><field-ref name="removeButton"/></form-list-column></form-list></box-body></container-box><container-box><box-header title="People Assigned"/><box-toolbar><container-dialog id="AddPartyAssignDialog" button-text="Add Person"><form-single name="AddPartyAssignForm" transition="addAssignment"><field name="workEffortId"><default-field><hidden/></default-field></field><field name="fromDate" from="ec.user.nowTimestamp"><default-field><hidden/></default-field></field><field name="partyId"><default-field title="Person"><drop-down><dynamic-options transition="searchPartyList" server-search="true" min-length="0" parameter-map="[roleTypeId:'Employee,Worker']"/></drop-down></default-field></field><field name="roleTypeId"><default-field><hidden default-value="_NA_"/></default-field></field><field name="statusId" from="null"><default-field title="Status"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="WorkEffortParty"/><set field="noCurrentSelectedKey" value="WeptAssigned"/></widget-template-include></default-field></field><field name="submitButton"><default-field title="Add Assignment"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="UpdateAssignForm" list="weapdList" transition="updateAssignment"><row-actions><entity-find-one entity-name="moqui.basic.StatusItem" value-field="currentStatus"/></row-actions><field name="workEffortId"><default-field><hidden/></default-field></field><field name="partyId"><default-field><hidden/></default-field></field><field name="fromDate"><default-field><hidden/></default-field></field><field name="name"><header-field/><default-field><link url="editParty" text="PartyNameTemplate" link-type="anchor"/></default-field></field><field name="username"><default-field><link url="editParty" text="${username?:'--'}" link-type="anchor"/></default-field></field><field name="roleTypeId"><default-field><hidden/></default-field></field><field name="statusId"><default-field title="Status"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusTransitionDropDown"><set field="currentDescription" from="currentStatus?.description"/><set field="statusId"/></widget-template-include></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-list></box-body></container-box><container-box><box-header title="Equipment"/><box-toolbar><container-dialog id="AddAsset" button-text="Add Equipment"><form-single name="AddAsset" transition="addAssetAssign"><field name="workEffortId"><default-field><hidden/></default-field></field><field name="assetId"><default-field title="Truck / Equipment"><drop-down><dynamic-options transition="getAssetList" server-search="true" min-length="0" parameter-map="[assetTypeEnumId:'AstTpEquipment']"/></drop-down></default-field></field><field name="statusId" from="null"><default-field><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="WorkEffortAssetAssign"/><set field="noCurrentSelectedKey" value="WeaaAssigned"/></widget-template-include></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><section-iterate name="AssetListSection" list="assetList" entry="assetAssign"><actions><script><![CDATA[context.putAll(assetAssign)]]></script><set field="changedEntityName" from="null"/><set field="statusChangeTransition" value="updateAssetAssign"/><entity-find entity-name="moqui.entity.EntityAuditLog" list="statusHistoryList"><econdition field-name="changedEntityName" value="mantle.work.effort.WorkEffortAssetAssign"/><econdition field-name="changedFieldName" value="statusId"/><econdition field-name="pkPrimaryValue" from="workEffortId"/><econdition field-name="pkSecondaryValue" from="assetId"/><order-by field-name="changedDate"/></entity-find></actions><widgets><container-box><box-header title="AssetNameTemplate"/><box-toolbar><link url="equipmentDetail" text="Edit Equipment"/><link url="updateAssetAssign" text="Remove from Load" parameter-map="[workEffortId:workEffortId, assetId:assetId, fromDate:fromDate,                                             thruDate:ec.user.nowTimestamp]"/></box-toolbar><box-body><container-row><row-col lg="5"><section-include name="AssetStatusChangeAndHistorySection" location="component://SimpleScreens/template/basic/StatusWidgets.xml#StatusChangeSection"/></row-col><row-col lg="7"><form-single name="UpdateAssetAssign" transition="updateAssetAssign" map="assetAssign"><field name="workEffortId"><default-field><hidden/></default-field></field><field name="assetId"><default-field><hidden/></default-field></field><field name="fromDate"><default-field><hidden/></default-field></field><field name="comments"><default-field><text-area cols="80" rows="5"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></row-col></container-row></box-body></container-box></widgets></section-iterate></box-body></container-box></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Shipping/Picklist/AddOrder.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Add Orders" default-menu-index="2"><parameter name="workEffortId" required="true"/><transition name="shipmentDetail"><default-response url="//${appRoot}/Shipment/ShipmentDetail"/></transition><transition name="picklistDetail"><default-response url="../PicklistDetail"/></transition><transition name="orderDetail"><default-response url="//${appRoot}/Order/OrderDetail"/></transition><transition name="editFacility"><default-response url="//${appRoot}/Facility/EditFacility"/></transition><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition name="editSupplier"><default-response url="//${appRoot}/Supplier/EditSupplier"/></transition><transition name="editCustomer"><default-response url="//${appRoot}/Customer/EditCustomer"/></transition><transition name="addOrderPartToLoad"><service-call name="mantle.work.ShipmentWorkServices.add#OrderPartToShipmentLoad" in-map="true" out-map="context" multi="parameter"/><default-response url="../PicklistDetail"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getFacilityList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><actions><set field="excludeOnPicklist" from="excludeOnPicklist ?: 'true'"/><set field="excludeNotPickLoc" from="excludeNotPickLoc ?: 'true'"/><entity-find entity-name="moqui.basic.EnumGroupMember" list="productItemTypeEgms" cache="true"><econdition field-name="enumGroupEnumId" value="EngItemsProduct"/></entity-find><set field="itemTypeEnumIdList" from="productItemTypeEgms*.enumId"/><entity-find-one entity-name="mantle.work.effort.WorkEffort" value-field="workEffort"/><entity-find-related-one value-field="workEffort" relationship-name="mantle.facility.Facility" to-value-field="facility"/><set field="facilityId" from="facilityId != null ? facilityId : (facility?.parentFacilityId ?: facility?.facilityId)"/><if condition="workEffort.ownerPartyId"><set field="vendorPartyId" from="workEffort.ownerPartyId"/></if><if condition="workEffort.productStoreId"><set field="productStoreId" from="workEffort.productStoreId"/></if><service-call name="mantle.work.ShipmentWorkServices.make#ShipmentLoadOrderConditions" out-map="context" in-map="[excludeOnPicklist:excludeOnPicklist, inventoryCategoryId:inventoryCategoryId]"/></actions><widgets><form-list name="AddOrderList" list="orderList" transition="addOrderPartToLoad" multi="true" header-dialog="true" select-columns="true" saved-finds="true"><entity-find entity-name="mantle.order.OrderPartFindView" list="orderList" use-clone="true"><search-form-inputs default-order-by="shipmentMethodSequenceNum,placedDate,orderId,orderPartSeqId" skip-fields="vendorRoleTypeId,customerRoleTypeId,customerClassificationId,itemTypeEnumId,orderType,partStatusId,facilityId,workEffortId"/><date-filter from-field-name="customerClassFromDate" thru-field-name="customerClassThruDate" ignore="!customerClassificationId"/><econdition field-name="partStatusId" value="OrderApproved"/><econdition field-name="vendorRoleTypeId" value="OrgInternal"/><econdition field-name="itemTypeEnumId" operator="in" from="itemTypeEnumIdList"/><econdition field-name="facilityId" ignore-if-empty="true"/><econdition field-name="customerClassificationId" ignore-if-empty="true"/><econdition field-name="productId" operator="in" from="findProductId" ignore-if-empty="true"/><econdition field-name="quantity" operator="greater-equals" from="findQuantity_from" ignore-if-empty="true"/><econdition field-name="quantity" operator="less-equals" from="findQuantity_thru" ignore-if-empty="true"/><econdition field-name="locationTypeEnumId" value="FltPick"/><econdition-object field="excludeOnPicklistCond"/><econdition-object field="inventoryCategoryCond"/><having-econditions><econdition field-name="itemBomQuantityTotal" to-field-name="resQuantity" ignore="excludeNotPickLoc == 'false'"/><econdition field-name="issuedQuantity" operator="greater" from="0.0" ignore="onlyPartlyShipped != 'true'"/></having-econditions><select-field field-name="orderId,orderPartSeqId,shipmentMethodEnumId,quantityTotal"/><select-field field-name="resQuantity${onlyPartlyShipped != 'true' ? '' : ',issuedQuantity'}${excludeNotPickLoc == 'false' ? '' : ',itemBomQuantityTotal'}"/></entity-find><row-actions><entity-find-one entity-name="moqui.basic.Enumeration" value-field="shipMethEnum" cache="true"><field-map field-name="enumId" from="shipmentMethodEnumId"/></entity-find-one><entity-find entity-name="mantle.party.PartyClassificationAndAppl" list="custPcaaList"><date-filter/><econdition field-name="partyId" from="customerPartyId"/><econdition field-name="classificationTypeEnumId" value="PcltCustomer"/></entity-find><entity-find entity-name="mantle.order.OrderItemShipSummary" list="oissList" use-clone="true"><econdition field-name="orderId"/><econdition field-name="orderPartSeqId"/><having-econditions><econdition field-name="shipmentQuantity" operator="greater" from="0.0"/></having-econditions><select-field field-name="shipmentId,shipmentQuantity,quantityHandled"/></entity-find><entity-find entity-name="mantle.order.OrderPartPartyDetail" list="partPartyList" use-clone="true"><econdition field-name="orderId"/><econdition field-name="orderPartSeqId"/><select-field field-name="partyId,pseudoId,firstName,lastName,organizationName,description"/></entity-find><if condition="findQuantity_from || findQuantity_thru || itemBomQuantityTotal == null"><entity-find entity-name="mantle.order.OrderItem" list="productOrderItemList" use-clone="true"><econdition field-name="orderId"/><econdition field-name="orderPartSeqId"/><econdition field-name="itemTypeEnumId" operator="in" from="itemTypeEnumIdList"/><select-field field-name="productId,quantity"/></entity-find><set field="quantityTotal" from="0.0"/><set field="itemBomQuantityTotal" from="0.0"/><iterate list="productOrderItemList" entry="productOrderItem"><set field="quantityTotal" from="quantityTotal + productOrderItem.quantity"/><entity-find-one entity-name="mantle.product.Product" value-field="product" cache="true"><field-map field-name="productId" from="productOrderItem.productId"/></entity-find-one><if condition="product?.productTypeEnumId == 'PtPickAssembly'"><then><entity-find entity-name="mantle.product.ProductAssoc" list="assocList" cache="true"><date-filter/><econdition field-name="productId" from="productOrderItem.productId"/><econdition field-name="productAssocTypeEnumId" value="PatMfgBom"/></entity-find><set field="bomQtyTotal" from="assocList*.quantity.sum()"/><set field="itemBomQuantityTotal" from="(bomQtyTotal ?: 0.0) * quantityTotal"/></then><else><set field="itemBomQuantityTotal" from="quantityTotal"/></else></if></iterate></if><set field="resPickLocQuantity" from="resQuantity ?: 0.0"/><set field="_rowSubmit" from="(resPickLocQuantity == itemBomQuantityTotal) ? 'true' : 'false'"/></row-actions><hidden-parameters><parameter name="workEffortId"/></hidden-parameters><field name="_useRowSubmit"><default-field><hidden default-value="true"/></default-field></field><field name="_rowSubmit"><default-field title="Add"><check><option key="true" text=" "/></check></default-field></field><field name="binLocationNumber"><header-field title="Pick Bin #" show-order-by="true"/><default-field><text-line size="3"/></default-field></field><field name="shipmentMethodEnumId"><header-field title="Ship Method"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ShipmentMethod"/><set field="allowMultiple" value="true"/><set field="showNot" value="true"/></widget-template-include></header-field></field><field name="shipmentMethodSequenceNum"><header-field title="Ship Method" show-order-by="true"/><default-field><display text="${shipmentMethodSequenceNum != null ? shipmentMethodSequenceNum + ' - ' : ''}${shipMethEnum?.description ?: ''}"/></default-field></field><field name="carrierPartyId"><header-field title="Carrier"><drop-down allow-multiple="true" show-not="true"><option key="_NA_" text="N/A"/><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="Carrier"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName,firstName"/></entity-find></entity-options></drop-down></header-field><default-field><display-entity entity-name="mantle.party.Party" text="${carrierPartyId == '_NA_' ? 'N/A' : pseudoId}"/></default-field></field><field name="shipments"><default-field><section-iterate name="ShipmentListSection" list="oissList" entry="oiss"><widgets><container><link url="shipmentDetail" link-type="anchor" text="${oiss.shipmentId}" parameter-map="[shipmentId:oiss.shipmentId]"/><label text=" (${ec.l10n.format(oiss.quantityHandled, null)} of ${ec.l10n.format(oiss.shipmentQuantity, null)})"/></container></widgets></section-iterate></default-field></field><field name="excludeOnPicklist"><header-field title="Exclude On Picklist"><radio><option key="true" text="Yes"/><option key="false" text="No"/></radio></header-field></field><field name="excludeNotPickLoc"><header-field title="Exclude Not in Pick Loc"><radio><option key="true" text="Yes"/><option key="false" text="No"/></radio></header-field></field><field name="onlyPartlyShipped"><header-field title="Shipped"><check><option key="true" text="Only Partly Shipped"/></check></header-field></field><field name="entryDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="placedDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="shipBeforeDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="orderId"><header-field title="Order" show-order-by="true"><text-find size="20" hide-options="true"/></header-field><default-field><display text=""/><link text="${orderId}:${orderPartSeqId}" url="orderDetail" link-type="anchor" condition="orderId"/></default-field></field><field name="orderPartSeqId"><default-field><hidden/></default-field></field><field name="otherPartyOrderId"><header-field title="Their Order" show-order-by="true"><text-find size="20" hide-options="true"/></header-field><default-field><display/></default-field></field><field name="salesChannelEnumId"><header-field title="Source" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="SalesChannel"/><set field="allowMultiple" value="true"/><set field="showNot" value="true"/></widget-template-include></header-field><default-field container-style="${salesChannelEnumId == 'ScWeb' ? 'text-strong text-success' : ''}"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="partStatusId"><header-field title="Status" show-order-by="true"/><default-field container-style="text-strong"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="facilityId"><header-field title="Facility" show-order-by="true"><drop-down allow-empty="true"><dynamic-options transition="getFacilityList" server-search="true" min-length="0" parameter-map="[facilityTypeEnumId:'FcTpWarehouse']"/></drop-down></header-field><default-field><link url="editFacility" entity-name="mantle.facility.Facility" text="FacilityNameTemplate" link-type="anchor"/></default-field></field><field name="productStoreId"><header-field title="Store" show-order-by="true"><drop-down allow-empty="true"><entity-options key="${productStoreId}" text="${productStoreId}: ${storeName}"><entity-find entity-name="mantle.product.store.ProductStore"><order-by field-name="storeName"/></entity-find></entity-options></drop-down></header-field><default-field><display-entity entity-name="mantle.product.store.ProductStore" text="${productStoreId}: ${storeName}"/></default-field></field><field name="vendorPartyId"><header-field title="Vendor" show-order-by="true"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="0" parameter-map="[roleTypeId:'Supplier,Vendor,OrgInternal']"/></drop-down></header-field><default-field><link url="editSupplier" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" link-type="anchor" parameter-map="[partyId:vendorPartyId]"/></default-field></field><field name="customerPartyId"><header-field title="Customer" show-order-by="true"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2" parameter-map="[roleTypeId:'Customer,OrgInternal']"/></drop-down></header-field><default-field><link url="editCustomer" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" link-type="anchor" parameter-map="[partyId:customerPartyId]"/><label text=" - ${custPcaaList*.description.join(', ')}" condition="custPcaaList"/></default-field></field><field name="customerClassificationId"><header-field title="Customer Class"><drop-down allow-empty="true" allow-multiple="true" show-not="true"><entity-options key="${partyClassificationId}" text="${description}"><entity-find entity-name="mantle.party.PartyClassification"><econdition field-name="classificationTypeEnumId" value="PcltCustomer"/><order-by field-name="description"/></entity-find></entity-options></drop-down></header-field></field><field name="partTotal" align="right"><header-field show-order-by="true" title="Amount Total"><range-find/></header-field><default-field><display currency-unit-field="currencyUomId"/></default-field></field><field name="quantityTotal" align="right"><header-field show-order-by="true" title="Quantity Total"><range-find/></header-field><default-field><display/></default-field></field><field name="itemBomQuantityTotal" align="right"><header-field show-order-by="true" title="Quantity w/BOM Total"><range-find/></header-field><default-field><display/></default-field></field><field name="resPickLocQuantity" align="right"><default-field title="Pick Loc Qty"><display style="text-strong ${(resPickLocQuantity == itemBomQuantityTotal) ? 'text-success' : 'text-danger'}"/></default-field></field><field name="findQuantity"><header-field title="Item Quantity"><range-find/></header-field></field><field name="issuedQuantity" align="right"><header-field show-order-by="true" title="Shipped"/><default-field><display/></default-field></field><field name="findProductId"><header-field title="Product"><drop-down allow-multiple="true"><dynamic-options transition="getProductList" server-search="true" min-length="0"/></drop-down></header-field></field><field name="inventoryCategoryId"><header-field title="Inventory Category"><drop-down allow-multiple="true"><entity-options key="${productCategoryId}" text="ProductCategoryNameTemplate"><entity-find entity-name="mantle.product.category.ProductCategory"><econdition field-name="productCategoryTypeEnumId" value="PctInventoryGroup"/><econdition field-name="ownerPartyId" from="workEffort?.ownerPartyId" ignore-if-empty="true"/></entity-find></entity-options></drop-down></header-field></field><field name="externalId"><header-field><text-find hide-options="true" default-operator="begins"/></header-field><default-field><display/></default-field></field><field name="displayId"><header-field><text-find hide-options="true" default-operator="begins"/></header-field><default-field><display/></default-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field><default-field title="Add to Picklist"><submit/></default-field></field><form-list-column><field-ref name="_rowSubmit"/></form-list-column><form-list-column><field-ref name="binLocationNumber"/></form-list-column><form-list-column><field-ref name="shipmentMethodSequenceNum"/><field-ref name="carrierPartyId"/><field-ref name="shipments"/></form-list-column><form-list-column><field-ref name="placedDate"/><field-ref name="shipBeforeDate"/><field-ref name="entryDate"/></form-list-column><form-list-column><field-ref name="orderId"/><field-ref name="otherPartyOrderId"/><field-ref name="salesChannelEnumId"/></form-list-column><form-list-column><field-ref name="partStatusId"/><field-ref name="facilityId"/><field-ref name="productStoreId"/></form-list-column><form-list-column><field-ref name="vendorPartyId"/><field-ref name="customerPartyId"/></form-list-column><form-list-column><field-ref name="partTotal"/><field-ref name="quantityTotal"/><field-ref name="resPickLocQuantity"/></form-list-column><form-list-column><field-ref name="submitButton"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Shipping/Picklist/AddShipment.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Add Shipments" default-menu-index="3"><parameter name="workEffortId" required="true"/><transition name="shipmentDetail"><default-response url="//${appRoot}/Shipment/ShipmentDetail"/></transition><transition name="picklistDetail"><default-response url="../PicklistDetail"/></transition><transition name="orderDetail"><default-response url="//${appRoot}/Order/OrderDetail"/></transition><transition name="editFacility"><default-response url="//${appRoot}/Facility/EditFacility"/></transition><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition name="editCustomer"><default-response url="//${appRoot}/Customer/EditCustomer"/></transition><transition name="addShipmentToLoad"><service-call name="mantle.work.ShipmentWorkServices.add#ShipmentToShipmentLoad" in-map="true" out-map="context" multi="parameter"/><default-response url="../PicklistDetail"/></transition><transition-include name="getFacilityList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><actions><set field="excludeOnPicklist" from="excludeOnPicklist ?: 'true'"/><set field="includeOnPicklist" from="excludeOnPicklist == 'false'"/><entity-find-one entity-name="mantle.work.effort.WorkEffort" value-field="workEffort"/><entity-find-related-one value-field="workEffort" relationship-name="mantle.facility.Facility" to-value-field="facility"/><set field="originFacilityId" from="originFacilityId != null ? originFacilityId : (facility?.parentFacilityId ?: facility?.facilityId)"/><if condition="workEffort.ownerPartyId"><set field="fromPartyId" from="workEffort.ownerPartyId"/></if><if condition="workEffort.productStoreId"><set field="productStoreId" from="workEffort.productStoreId"/></if><set field="statusId" from="statusId ?: 'ShipInput,ShipScheduled,ShipPicked'"/><set field="statusId_op" value="in"/><service-call name="org.moqui.impl.BasicServices.find#EnumerationByParent" out-map="shipmentTypeOut" in-map="[parentEnumId:'ShpTpOutgoing']"/></actions><widgets><form-list name="AddShipmentList" list="shipmentList" transition="addShipmentToLoad" multi="true" header-dialog="true" select-columns="true" saved-finds="true"><entity-find entity-name="mantle.shipment.ShipmentFindView" list="shipmentList"><search-form-inputs default-order-by="binLocationNumber,shipmentMethodSequenceNum,shipmentId" skip-fields="originFacilityId"/><econdition field-name="shipmentTypeEnumId" operator="in" from="shipmentTypeSet" ignore="!shipmentTypeSet"/><econdition field-name="originFacilityId" ignore-if-empty="true"/><econdition field-name="shipWorkEffortId" operator="is-null" ignore="includeOnPicklist"/><select-field field-name="shipmentMethodEnumId"/></entity-find><row-actions><entity-find-one entity-name="moqui.basic.Enumeration" value-field="shipMethEnum" cache="true"><field-map field-name="enumId" from="shipmentMethodEnumId"/></entity-find-one><entity-find entity-name="mantle.party.PartyClassificationAndAppl" list="custPcaaList"><date-filter/><econdition field-name="partyId" from="toPartyId"/><econdition field-name="classificationTypeEnumId" value="PcltCustomer"/></entity-find><entity-find entity-name="mantle.shipment.ShipmentItemSource" list="sisList" distinct="true"><econdition field-name="shipmentId"/><select-field field-name="orderId"/></entity-find><entity-find entity-name="mantle.order.OrderHeader" list="orderHeaderList"><econdition field-name="orderId" operator="in" from="sisList*.orderId"/><select-field field-name="orderId,salesChannelEnumId"/></entity-find><entity-find entity-name="mantle.order.OrderPartPartyDetail" list="orderPartyList"><econdition field-name="orderId" operator="in" from="sisList*.orderId"/><select-field field-name="partyId,pseudoId,firstName,lastName,organizationName,description"/></entity-find><entity-find entity-name="mantle.shipment.ShipmentItemSourceSummary" list="sisSummaryList"><econdition field-name="shipmentId"/><select-field field-name="quantity,quantityNotHandled"/></entity-find><set field="quantityTotal" from="sisSummaryList.first()?.quantity ?: 0.0"/><set field="quantityNotHandled" from="sisSummaryList.first()?.quantityNotHandled ?: 0.0"/><entity-find entity-name="mantle.product.issuance.AssetAndReservationSummary" list="resPickLocList"><econdition field-name="shipmentId"/><econdition field-name="locationTypeEnumId" value="FltPick"/><select-field field-name="quantity"/></entity-find><set field="resPickLocQuantity" from="resPickLocList.first()?.quantity ?: 0.0"/><set field="_rowSubmit" from="(resPickLocQuantity == quantityTotal) ? 'true' : 'false'"/></row-actions><hidden-parameters><parameter name="workEffortId"/></hidden-parameters><field name="_useRowSubmit"><default-field><hidden default-value="true"/></default-field></field><field name="_rowSubmit"><default-field title="Add"><check><option key="true" text=" "/></check></default-field></field><field name="binLocationNumber"><header-field title="Pick Bin #" show-order-by="true"/><default-field><text-line size="3"/></default-field></field><field name="shipmentMethodEnumId"><header-field title="Ship Method"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ShipmentMethod"/><set field="allowMultiple" value="true"/><set field="showNot" value="true"/></widget-template-include></header-field></field><field name="shipmentMethodSequenceNum"><header-field title="Ship Method" show-order-by="true"/><default-field><display text="${shipmentMethodSequenceNum != null ? shipmentMethodSequenceNum + ' - ' : ''}${shipMethEnum?.description ?: ''}"/></default-field></field><field name="shipmentId"><header-field title="Shipment" show-order-by="case-insensitive"><text-find size="10" hide-options="true"/></header-field><default-field><display text=""/><link url="shipmentDetail" text="${shipmentId}" link-type="anchor"/></default-field></field><field name="shipmentTypeEnumId"><header-field title="Type" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="ShipmentType"/><set field="allowEmpty" value="true"/><set field="allowMultiple" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration" also-hidden="false"/></default-field></field><field name="statusId"><header-field title="Status" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="Shipment"/><set field="allowMultiple" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.StatusItem" also-hidden="false"/></default-field></field><field name="shipWorkEffortId"><header-field title="Picklist" show-order-by="true"><text-find size="15" hide-options="true"/></header-field><default-field><link url="picklistDetail" text="${shipWorkEffortId}" link-type="anchor" style="${workEffortId == shipWorkEffortId ? 'text-success' : 'text-danger'}" parameter-map="[workEffortId:shipWorkEffortId]" condition="shipWorkEffortId"/></default-field></field><field name="excludeOnPicklist"><header-field title="Exclude On Picklist"><radio><option key="true" text="Yes"/><option key="false" text="No"/></radio></header-field></field><field name="originFacilityId"><header-field title="Origin Facility"><drop-down allow-empty="true"><dynamic-options transition="getFacilityList" server-search="true" min-length="0"/></drop-down></header-field><default-field><link url="editFacility" entity-name="mantle.facility.Facility" text="FacilityNameTemplate" link-type="anchor" parameter-map="[facilityId:originFacilityId]"/></default-field></field><field name="productStoreId"><header-field title="Store"><drop-down allow-empty="true"><entity-options key="${productStoreId}" text="${productStoreId}: ${storeName}"><entity-find entity-name="mantle.product.store.ProductStore"><order-by field-name="storeName"/></entity-find></entity-options></drop-down></header-field><default-field><display-entity entity-name="mantle.product.store.ProductStore" text="${productStoreId}: ${storeName}"/></default-field></field><field name="fromPartyId"><header-field title="From Party"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="0" parameter-map="[roleTypeId:'Supplier,Vendor,OrgInternal']"/></drop-down></header-field><default-field><link url="editSupplier" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" link-type="anchor" parameter-map="[partyId:vendorPartyId]"/></default-field></field><field name="toPartyId"><header-field title="To Party"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></header-field><default-field><link url="editCustomer" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" link-type="anchor" parameter-map="[partyId:toPartyId]"/><label text=" - ${custPcaaList*.description.join(', ')}" condition="custPcaaList"/></default-field></field><field name="customerClassificationId"><header-field title="Customer Class"><drop-down allow-empty="true"><entity-options key="${partyClassificationId}" text="${description}"><entity-find entity-name="mantle.party.PartyClassification"><econdition field-name="classificationTypeEnumId" value="PcltCustomer"/><order-by field-name="description"/></entity-find></entity-options></drop-down></header-field></field><field name="orderPartyId"><header-field><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></header-field></field><field name="orderRoleTypeId"><header-field><drop-down allow-empty="true"><entity-options key="${roleTypeId}" text="${description}"><entity-find entity-name="mantle.party.RoleGroupMemberAndType" cache="true"><econdition field-name="roleGroupEnumId" value="RgpOrder"/><order-by field-name="description"/></entity-find></entity-options></drop-down></header-field></field><field name="orderParties"><default-field><section-iterate name="OtherPartyListSection" list="orderPartyList" entry="partParty"><widgets><container><link url="editParty" link-type="anchor" text="${ec.resource.expand('PartyNameTemplate','',partParty)} - ${partParty.description?:'N/A'}" parameter-map="[partyId:partParty.partyId]"/></container></widgets></section-iterate></default-field></field><field name="orderId"><header-field><text-find default-operator="begins"/></header-field></field><field name="salesChannelEnumId"><header-field title="Order Source"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="SalesChannel"/><set field="allowEmpty" value="true"/></widget-template-include></header-field></field><field name="orderIds"><default-field title="Orders"><section-iterate name="OrderSisList" list="orderHeaderList" entry="orderHeader"><widgets><link url="orderDetail" text="${orderHeader.orderId}" link-type="anchor" condition="orderHeader.orderId" parameter-map="[orderId:orderHeader.orderId]"/><label text=" - ${orderHeader.salesChannel?.description?:''}" condition="orderHeader.salesChannelEnumId"/></widgets></section-iterate></default-field></field><field name="otherPartyOrderId"><header-field title="Their Order" show-order-by="true"><text-find size="20" hide-options="true"/></header-field><default-field><display also-hidden="false"/></default-field></field><field name="entryDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display also-hidden="false"/></default-field></field><field name="estimatedReadyDate"><header-field title="Ready Date" show-order-by="true"><date-period/></header-field><default-field><display also-hidden="false"/></default-field></field><field name="quantityTotal" align="right"><default-field title="Quantity Total"><display/></default-field></field><field name="resPickLocQuantity" align="right"><default-field title="Pick Loc Qty"><display style="text-strong ${(resPickLocQuantity == quantityTotal) ? 'text-success' : 'text-danger'}"/></default-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field><default-field title="Add to Picklist"><submit/></default-field></field><form-list-column><field-ref name="_rowSubmit"/></form-list-column><form-list-column><field-ref name="binLocationNumber"/></form-list-column><form-list-column><field-ref name="shipmentMethodSequenceNum"/><field-ref name="shipmentId"/></form-list-column><form-list-column><field-ref name="statusId"/><field-ref name="shipWorkEffortId"/></form-list-column><form-list-column><field-ref name="shipmentTypeEnumId"/><field-ref name="originFacilityId"/></form-list-column><form-list-column><field-ref name="toPartyId"/><field-ref name="orderParties"/></form-list-column><form-list-column><field-ref name="otherPartyOrderId"/><field-ref name="orderIds"/></form-list-column><form-list-column><field-ref name="entryDate"/><field-ref name="estimatedReadyDate"/></form-list-column><form-list-column><field-ref name="quantityTotal"/><field-ref name="resPickLocQuantity"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Shipping/Picklist.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Picklists" default-menu-index="3" menu-image="/ssstatic/images/Picking.png"><subscreens default-item="FindPicklist"/><widgets><subscreens-panel id="PicklistPanel" type="tab"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Shipping/PickLocationMoves/QuickMove.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="productId" required="true"/><parameter name="facilityId" required="true"/><parameter name="locationSeqId"/><parameter name="quantity"/><transition name="moveProduct"><service-call name="mantle.product.AssetServices.moveVerify#Product" in-map="true" out-map="context" multi="parameter"/><default-response type="screen-last"/></transition><actions><if condition="locationSeqId"><entity-find-one entity-name="mantle.facility.FacilityLocation" value-field="facilityLocation"/><entity-find entity-name="mantle.product.asset.AssetQuantitySummary" list="locQtySummaryList"><econdition field-name="productId"/><econdition field-name="facilityId"/><econdition field-name="locationSeqId"/><select-field field-name="quantityOnHandTotal"/></entity-find><set field="quantityOnHandTotal" from="locQtySummaryList ? locQtySummaryList[0].quantityOnHandTotal : 0.0"/></if><entity-find entity-name="mantle.product.asset.AssetLocationSummary" list="pickLocQtyList"><econdition field-name="productId"/><econdition field-name="facilityId"/><econdition field-name="locationTypeEnumId" value="FltPick"/><select-field field-name="availableToPromiseTotal"/></entity-find><set field="pickAtpTotal" from="pickLocQtyList ? (pickLocQtyList[0].availableToPromiseTotal ?: 0.0) : 0.0"/><set field="reservedQuantity" from="quantity ? new BigDecimal((String) quantity) : 0.0"/><set field="needQuantity" from="reservedQuantity > pickAtpTotal ? (reservedQuantity - pickAtpTotal) : 0.0"/></actions><widgets><form-single name="ScanMoveAssetForm" transition="moveProduct" focus-field="scanLocation"><field name="productId"><default-field title="Product"><display-entity entity-name="mantle.product.Product" text="ProductNameTemplate"/></default-field></field><field name="facilityId"><default-field title="Facility"><display-entity entity-name="mantle.facility.Facility" text="FacilityNameTemplate"/></default-field></field><field name="locationSeqId"><default-field title="From Location"><display text="${locationSeqId?:'N/A'} - ${description?:''} ${areaId?:' '}:${aisleId?:' '}:${sectionId?:' '}:${levelId?:' '}:${positionId?:' '} - QOH ${ec.l10n.format(quantityOnHandTotal, '#,##0.##')}" text-map="facilityLocation"/></default-field></field><field name="verifyLocationSeqId"><default-field title="Verify From Location"><text-line size="20"/></default-field></field><field name="toScanLocation"><default-field title="Scan To Location" tooltip="Can be Location ID or Container ID or Serial Number (Plate ID)"><text-line size="20"/></default-field></field><field name="needQuantity"><default-field tooltip="Reserved Quantity - Pick Location Available Quantity"><display text="${ec.l10n.format(needQuantity, '#,##0.##')} (Res ${ec.l10n.format(reservedQuantity, '#,##0.##')} - Pick ATP ${ec.l10n.format(pickAtpTotal, '#,##0.##')})"/></default-field></field><field name="quantity" from="needQuantity"><default-field title="Quantity"><text-line size="20"/></default-field></field><field name="submitButton"><default-field title="Move Asset(s)"><submit/></default-field></field></form-single></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Shipping/PickLocationMoves.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Pick Location Moves" default-menu-index="4"><transition name="editFacility"><default-response url="//${appRoot}/Facility/EditFacility"/></transition><transition name="findSummary"><default-response url="//${appRoot}/Asset/Asset/FindSummary"/></transition><transition name="assetDetail"><default-response url="//${appRoot}/Asset/Asset/AssetDetail"/></transition><transition name="moveAsset"><default-response url="//${appRoot}/Asset/Asset/MoveAsset"/></transition><transition name="selectAsset"><default-response url="//${appRoot}/Asset/Asset/SelectAsset"/></transition><transition name="editProduct"><default-response url="//${appRoot}/Catalog/Product/EditProduct"/></transition><transition-include name="getFacilityList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><widgets><form-list name="PickMoveList" list="pickMoveList" skip-form="true" header-dialog="true" select-columns="true" saved-finds="true" show-csv-button="true" show-xlsx-button="true" show-page-size="true"><entity-find entity-name="mantle.product.issuance.AssetAndReservationSummary" list="pickMoveList"><search-form-inputs default-order-by="-quantity" require-parameters="true"/><econdition field-name="locationTypeEnumId" operator="not-equals" value="FltPick" or-null="true"/><having-econditions><econdition field-name="quantityOnHandTotal" operator="greater" from="0.0"/></having-econditions><select-field field-name="productId,facilityId,locationSeqId,description,areaId,aisleId,sectionId,levelId,positionId"/><select-field field-name="quantity,reservationCount"/></entity-find><row-actions><entity-find-one entity-name="mantle.product.ProductIdentification" value-field="upcaProdIdent" cache="true"><field-map field-name="productId"/><field-map field-name="productIdTypeEnumId" value="PidtUpca"/></entity-find-one><entity-find entity-name="mantle.facility.ProductFacilityLocationDetail" list="pickLocList" distinct="true"><econdition field-name="productId"/><econdition field-name="facilityId"/><econdition field-name="locationTypeEnumId" value="FltPick"/><select-field field-name="locationSeqId,description,areaId,aisleId,sectionId,levelId,positionId"/></entity-find><if condition="!pickLocList"><entity-find entity-name="mantle.product.asset.AssetLocationSummary" list="pickLocList" distinct="true"><econdition field-name="productId"/><econdition field-name="facilityId"/><econdition field-name="locationTypeEnumId" value="FltPick"/><having-econditions><econdition field-name="quantityOnHandTotal" operator="greater" from="0.0" ignore="showAllPickLocations == 'Y'"/></having-econditions><select-field field-name="locationSeqId,description,areaId,aisleId,sectionId,levelId,positionId,quantityOnHandTotal"/></entity-find></if><entity-find entity-name="mantle.product.asset.AssetLocationSummary" list="pickLocQtyList"><econdition field-name="productId"/><econdition field-name="facilityId"/><econdition field-name="locationTypeEnumId" value="FltPick"/><select-field field-name="availableToPromiseTotal"/></entity-find><set field="pickAtpTotal" from="pickLocQtyList ? (pickLocQtyList[0].availableToPromiseTotal ?: 0.0) : 0.0"/><set field="needQuantity" from="quantity > pickAtpTotal ? (quantity - pickAtpTotal) : 0.0"/></row-actions><field name="productId"><header-field title="Product"><drop-down allow-multiple="true"><dynamic-options transition="getProductList" server-search="true" min-length="0"/></drop-down></header-field><default-field><link url="editProduct" entity-name="mantle.product.Product" text="ProductNameTemplate" link-type="anchor"/></default-field></field><field name="upca"><default-field title="UPC-A"><display text="${upcaProdIdent?.idValue?:''}"/></default-field></field><field name="facilityId"><header-field title="Facility" show-order-by="true"><drop-down allow-empty="true"><dynamic-options transition="getFacilityList" server-search="true" min-length="0" parameter-map="[facilityTypeEnumId:'FcTpWarehouse']"/></drop-down></header-field><default-field><link url="editFacility" entity-name="mantle.facility.Facility" text="FacilityNameTemplate" link-type="anchor"/></default-field></field><field name="locationSeqId"><default-field title="Location"><display text="${description?:''} ${areaId?:' '}:${aisleId?:' '}:${sectionId?:' '}:${levelId?:' '}:${positionId?:' '}"/></default-field></field><field name="locationTypeEnumId"><header-field title="Loc Type" show-order-by="true"/><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="areaId"><header-field title="Area"><text-find default-operator="begins" size="10"/></header-field></field><field name="aisleId"><header-field title="Aisle"><text-find default-operator="begins" size="10"/></header-field></field><field name="containerId"><default-field title="Container"><display-entity entity-name="mantle.product.asset.Container" text="ContainerNameTemplate"/></default-field></field><field name="lotId"><default-field title="Lot"><display-entity entity-name="mantle.product.asset.LotAndMfgParty" text="LotNameTemplate"/></default-field></field><field name="assetId"><default-field title="Asset"><link url="assetDetail" text="${assetId}" link-type="anchor"/></default-field></field><field name="quantityOnHandTotal" from="(quantityOnHandTotal ?: 0.0) / (reservationCount ?: 1.0)"><header-field title="QOH" show-order-by="true"/><default-field><display/></default-field></field><field name="reservationCount"><header-field title="Res Cnt" show-order-by="true"/><default-field><display/></default-field></field><field name="quantity"><header-field title="Res Qty" show-order-by="true"/><default-field><display/></default-field></field><field name="needQuantity"><default-field title="Need Qty"><display text="${ec.l10n.format(needQuantity, '#,##0.##')} (Pick ATP ${ec.l10n.format(pickAtpTotal, '#,##0.##')})"/></default-field></field><field name="recLocations"><default-field title="Pick Location(s)"><section-iterate name="RecLocList" list="pickLocList" entry="recLoc"><widgets><label text="${description?:''} ${areaId?:' '}:${aisleId?:' '}:${sectionId?:' '}:${levelId?:' '}:${positionId?:' '} - QOH ${ec.l10n.format(quantityOnHandTotal, '#,##0.##')}" text-map="recLoc" type="div"/></widgets></section-iterate></default-field></field><field name="moveDialog"><default-field><dynamic-dialog id="QuickMoveDialog" button-text="Move" transition="QuickMove"/></default-field></field><field name="moveLink"><default-field title="Move Link"><link url="selectAsset" text="Move Screen" parameter-map="[quantity:quantity]"/><link url="moveAsset" text="Move Asset" condition="assetId" parameter-map="[quantity:quantity]"/></default-field></field><field name="assetSummaryLink"><default-field title="Assets Link"><link url="findSummary" text="Product Assets" parameter-map="[productId:productId, facilityId:facilityId]" link-type="anchor"/></default-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field></field><columns><column><field-ref name="productId"/><field-ref name="facilityId"/></column><column><field-ref name="upca"/></column><column><field-ref name="locationSeqId"/><field-ref name="locationTypeEnumId"/></column><column><field-ref name="quantityOnHandTotal"/></column><column><field-ref name="quantity"/><field-ref name="reservationCount"/></column><column><field-ref name="needQuantity"/></column><column><field-ref name="recLocations"/></column><column><field-ref name="moveDialog"/></column><column><field-ref name="moveLink"/></column><column><field-ref name="assetSummaryLink"/></column></columns></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Shipping.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Shipping" default-menu-index="14" menu-image="/ssstatic/images/Picking.png"><subscreens default-item="dashboard"><subscreens-item name="ShipmentPack" menu-include="false" location="component://SimpleScreens/screen/SimpleScreens/Shipment/ShipmentPack.xml"/><subscreens-item name="ShipmentByPackage" menu-include="false" location="component://SimpleScreens/screen/SimpleScreens/Shipment/ShipmentByPackage.xml"/><subscreens-item name="ShipmentInsert" menu-include="false" location="component://SimpleScreens/screen/SimpleScreens/Shipment/ShipmentInsert.xml"/></subscreens><widgets><subscreens-panel id="ShippingPanel" type="popup"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/ProductStore/FindProductStore.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition name="editStore"><default-response url="../EditProductStore"/></transition><transition name="createStore"><service-call name="create#mantle.product.store.ProductStore" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditProductStore"/></transition><actions><entity-find entity-name="mantle.product.store.ProductStore" list="storeList"><search-form-inputs default-order-by="storeName"/></entity-find></actions><widgets><container-dialog id="NewStoreDialog" button-text="New Store"><form-single name="NewStoreForm" transition="createStore"><field name="productStoreId"><default-field title="ID"><text-line size="20"/></default-field></field><field name="storeName"><default-field title="Name"><text-line size="40"/></default-field></field><field name="organizationPartyId"><default-field title="Organization Party"><drop-down><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><link url="//${appRoot}/Gateway/Payment" text="Payment Gateways"/><link url="//${appRoot}/Gateway/Shipping" text="Shipping Gateways"/><form-list name="StoresForm" list="storeList" skip-form="true" header-dialog="true" select-columns="true" saved-finds="true" show-csv-button="true"><field name="productStoreId"><header-field title="ID" show-order-by="case-insensitive"><text-find size="10" hide-options="true"/></header-field><default-field><link url="editStore" text="${productStoreId}" link-type="anchor"/></default-field></field><field name="storeName"><header-field title="Name" show-order-by="case-insensitive"><text-find size="25" hide-options="true"/></header-field><default-field><link url="editStore" text="${storeName}" link-type="anchor"/></default-field></field><field name="organizationPartyId"><header-field title="Organization" show-order-by="case-insensitive"><text-find size="25" hide-options="true"/></header-field><default-field><link url="editParty" text="PartyNameTemplate" entity-name="mantle.party.PartyDetail" parameter-map="[partyId:organizationPartyId]" link-type="anchor"/></default-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field><default-field><display text=" "/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/ProductStore/EditProductStore.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Product Store" default-menu-index="1"><parameter name="productStoreId" required="true"/><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition name="editShippingGateway"><default-response url="//${appRoot}/Gateway/EditShippingGateway"/></transition><transition name="editPaymentGateway"><default-response url="//${appRoot}/Gateway/EditPaymentGateway"/></transition><transition name="updateStore"><service-call name="update#mantle.product.store.ProductStore" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="cloneProductStore"><service-call name="mantle.product.StoreServices.clone#ProductStore" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createShippingOption"><service-call name="mantle.product.StoreServices.create#StoreShippingOption" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateShippingOption"><service-call name="update#mantle.product.store.ProductStoreShipOption" multi="true" in-map="context" out-map="context"/><default-response url="."/></transition><transition name="deleteShippingOption"><service-call name="delete#mantle.product.store.ProductStoreShipOption" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createShippingGateway"><service-call name="create#mantle.product.store.ProductStoreShippingGateway" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateShippingGateway"><service-call name="update#mantle.product.store.ProductStoreShippingGateway" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteShippingGateway"><service-call name="delete#mantle.product.store.ProductStoreShippingGateway" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createPaymentGateway"><service-call name="create#mantle.product.store.ProductStorePaymentGateway" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deletePaymentGateway"><service-call name="delete#mantle.product.store.ProductStorePaymentGateway" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createStoreDataDocument"><service-call name="create#mantle.product.store.ProductStoreDataDocument" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateStoreDataDocument"><service-call name="update#mantle.product.store.ProductStoreDataDocument" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteStoreDataDocument"><service-call name="delete#mantle.product.store.ProductStoreDataDocument" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getFacilityList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><actions><entity-find-one entity-name="mantle.product.store.ProductStore" value-field="store"><field-map field-name="productStoreId" from="productStoreId"/></entity-find-one><set field="localeStringList" from="[]"/><iterate list="Locale.getAvailableLocales()" entry="lcl"><script><![CDATA[if (lcl.toString()) localeStringList.add([locale:lcl.toString(), name:lcl.getDisplayName(ec.user.locale)])]]></script></iterate><order-map-list list="localeStringList"><order-by field-name="name"/></order-map-list></actions><widgets><container-row><row-col lg="5"><container-dialog id="CloneProductStoreDialog" button-text="Clone Store"><form-single name="CloneProductStoreForm" transition="cloneProductStore"><field name="baseProductStoreId" from="productStoreId"><default-field><hidden/></default-field></field><field name="productStoreId"><default-field title="New ID"><text-line size="10"/></default-field></field><field name="storeName"><default-field title="New Name"><text-line size="50"/></default-field></field><field name="copyCategories"><default-field><radio no-current-selected-key="true"><option key="true" text="Yes"/><option key="false" text="No"/></radio></default-field></field><field name="copyEmails"><default-field><radio no-current-selected-key="true"><option key="true" text="Yes"/><option key="false" text="No"/></radio></default-field></field><field name="copyFacilities"><default-field><radio no-current-selected-key="true"><option key="true" text="Yes"/><option key="false" text="No"/></radio></default-field></field><field name="copyParties"><default-field><radio no-current-selected-key="true"><option key="true" text="Yes"/><option key="false" text="No"/></radio></default-field></field><field name="copyProducts"><default-field><radio no-current-selected-key="true"><option key="true" text="Yes"/><option key="false" text="No"/></radio></default-field></field><field name="copySettings"><default-field><radio no-current-selected-key="true"><option key="true" text="Yes"/><option key="false" text="No"/></radio></default-field></field><field name="submitButton"><default-field title="Clone"><submit/></default-field></field></form-single></container-dialog><form-single name="EditStoreForm" map="store" transition="updateStore"><field name="productStoreId"><default-field title="Product Store ID"><display/></default-field></field><field name="storeName"><default-field title="Name"><text-line size="50"/></default-field></field><field name="organizationPartyId"><default-field title="Organization"><drop-down allow-empty="true"><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></default-field></field><field name="inventoryFacilityId"><default-field title="Facility"><drop-down allow-empty="true"><dynamic-options transition="getFacilityList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="reservationAutoEnumId"><default-field title="Auto Reservation"><drop-down allow-empty="true"><entity-options key="${enumId}" text="EnumerationNameTemplate"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="AssetReservationAuto"/><order-by field-name="enumId"/></entity-find></entity-options></drop-down></default-field></field><field name="requireInventory"><default-field title="Require Inventory"><radio no-current-selected-key="N"><option key="Y"/><option key="N"/></radio></default-field></field><field name="defaultDisablePromotions"><default-field><radio no-current-selected-key="N"><option key="Y"/><option key="N"/></radio></default-field></field><field name="defaultDisableShippingCalc"><default-field><radio no-current-selected-key="N"><option key="Y"/><option key="N"/></radio></default-field></field><field name="defaultDisableTaxCalc"><default-field><radio no-current-selected-key="N"><option key="Y"/><option key="N"/></radio></default-field></field><field name="markupOrderShipLabels"><default-field title="Markup Order Shipping Price"><radio no-current-selected-key="N"><option key="Y"/><option key="N"/></radio></default-field></field><field name="markupShipmentShipLabels"><default-field><radio no-current-selected-key="N"><option key="Y"/><option key="N"/></radio></default-field></field><field name="shipmentAnyCarrierMethod"><default-field title="Any Carrier Method?" tooltip="Set to Y to show all Carrier Shipment Methods on Shipments instead of only Shipping Options for this Store"><radio no-current-selected-key="N"><option key="Y"/><option key="N"/></radio></default-field></field><field name="insurancePackageThreshold"><default-field title="Insurance Threshold" tooltip="Buy insurance on packages where total cost of contents is above this amount"><text-line size="10" format="#,##0.00"/></default-field></field><field name="autoApproveDelay"><default-field tooltip="Delay in minutes, set to 0 to try auto-approve immediately when placed"><text-line size="5"/></default-field></field><field name="storeDomain"><default-field title="Store Domain"><text-line size="30"/></default-field></field><field name="profileUrlPath"><default-field title="Profile Url Path"><text-line size="30"/></default-field></field><field name="wikiSpaceId"><default-field title="Wiki Space ID"><drop-down allow-empty="true"><entity-options key="${wikiSpaceId}" text="${wikiSpaceId}: ${description ?: ''}"><entity-find entity-name="moqui.resource.wiki.WikiSpace"><order-by field-name="wikiSpaceId"/></entity-find></entity-options></drop-down></default-field></field><field name="defaultLocale"><default-field title="Default Locale"><drop-down allow-empty="true"><list-options list="localeStringList" key="${locale}" text="${name}"/></drop-down></default-field></field><field name="defaultCurrencyUomId"><default-field title="Default Currency"><drop-down allow-empty="true"><entity-options key="${uomId}" text="UomNameTemplate"><entity-find entity-name="moqui.basic.Uom"><econdition field-name="uomTypeEnumId" value="UT_CURRENCY_MEASURE"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="defaultSalesChannelEnumId"><default-field title="Default Order Source"><drop-down allow-empty="true"><entity-options key="${enumId}" text="EnumerationNameTemplate"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="SalesChannel"/><order-by field-name="enumId"/></entity-find></entity-options></drop-down></default-field></field><field name="requireCustomerRole"><default-field title="Require Customer Role"><drop-down allow-empty="true"><option key="Y"/><option key="N"/></drop-down></default-field></field><field name="taxGatewayConfigId"><default-field title="Tax Gateway"><drop-down allow-empty="true"><entity-options key="${taxGatewayConfigId}" text="${description ?: ''} [${taxGatewayConfigId}]"><entity-find entity-name="mantle.other.tax.TaxGatewayConfig"><order-by field-name="taxGatewayConfigId"/></entity-find></entity-options></drop-down></default-field></field><field name="systemMessageRemoteId"><default-field title="Remote"><drop-down allow-empty="true"><entity-options key="${systemMessageRemoteId}" text="${description}"><entity-find entity-name="moqui.service.message.SystemMessageRemote"><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></row-col><row-col lg="7"><section name="ShippingOptionsSection"><widgets><container-box><box-header title="Shipping Options"/><box-toolbar><container-dialog id="NewShippingOptionDialog" button-text="Add Shipping Option"><form-single name="NewShippingOptionForm" transition="createShippingOption"><field name="productStoreId"><default-field title="Product Store"><hidden/></default-field></field><field name="carrierAndShipmentMethod"><default-field title="Shipment Method"><drop-down><entity-options key="${carrierPartyId}:${shipmentMethodEnumId}" text="${description ? description : (carrierPartyId != '_NA_' ? (carrierPseudoId + ' - ') : '') + shipmentMethodDescription}"><entity-find entity-name="mantle.shipment.carrier.CarrierShipmentMethodDetail"><order-by field-name="description,carrierPseudoId,shipmentMethodDescription"/></entity-find></entity-options></drop-down></default-field></field><field name="sequenceNum"><default-field><text-line size="4" format="#"/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="ShipOptionsForm" list="shipOptionsList" multi="true" transition="updateShippingOption"><entity-find entity-name="mantle.product.store.ProductStoreShipOptionDetail" list="shipOptionsList"><econdition field-name="productStoreId"/><select-field field-name="carrierPseudoId,shipmentMethodDescription"/><order-by field-name="sequenceNum,description,carrierPseudoId"/></entity-find><field name="productStoreId"><default-field><hidden/></default-field></field><field name="carrierPartyId"><default-field><hidden/></default-field></field><field name="shipmentMethodEnumId"><default-field><hidden/></default-field></field><field name="description"><default-field title="Shipment Method"><display text="${description ? description : (carrierPartyId != '_NA_' ? (carrierPseudoId + ' - ') : '') + shipmentMethodDescription}"/></default-field></field><field name="sequenceNum"><default-field title="Sequence"><text-line size="3" format="#"/></default-field></field><field name="markupPercent"><default-field title="Markup %" tooltip="Label cost markup as percent of carrier rate"><text-line size="4" format="0.0"/></default-field></field><field name="markupAmount"><default-field title="Markup Amt" tooltip="Label cost markup as a fixed amount"><text-line size="4" format="0.00"/></default-field></field><field name="deleteButton" align="right"><default-field title=""><link url="deleteShippingOption" icon="fa fa-trash" parameter-map="[productStoreId:productStoreId, carrierPartyId:carrierPartyId, shipmentMethodEnumId:shipmentMethodEnumId]" confirmation="Are you sure you want to remove this Shipping Option?"/></default-field></field><field name="submitButton" align="right"><default-field title="Update"><submit/></default-field></field></form-list></box-body></container-box></widgets></section><section name="ShippingGatewaysSection"><widgets><container-box><box-header title="Shipping Gateways"/><box-toolbar><container-dialog id="NewShippingGatewayDialog" button-text="Add Shipping Gateway"><form-single name="NewShippingGatewayForm" transition="createShippingGateway"><field name="productStoreId"><default-field><hidden/></default-field></field><field name="carrierPartyId"><default-field title="Carrier"><drop-down><entity-options key="${partyId}" text="PartyNameTemplate"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="Carrier"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></default-field></field><field name="shippingGatewayConfigId"><default-field title="Gateway Config"><drop-down><entity-options key="${shippingGatewayConfigId}" text="${description ?: ''} [${shippingGatewayConfigId}]"><entity-find entity-name="mantle.shipment.carrier.ShippingGatewayConfig"><order-by field-name="shippingGatewayConfigId"/></entity-find></entity-options></drop-down></default-field></field><field name="billingType"><default-field><drop-down allow-empty="true"><option key="SENDER" text="Sender"/><option key="RECIPIENT" text="Recipient"/><option key="THIRD_PARTY" text="Third Party"/></drop-down></default-field></field><field name="billingAccount"><default-field><text-line size="40"/></default-field></field><field name="billingCountry"><default-field><drop-down allow-empty="true"><entity-options key="${geoCodeAlpha2}" text="${geoCodeAlpha2} - ${geoName}"><entity-find entity-name="moqui.basic.Geo"><order-by field-name="geoCodeAlpha2"/></entity-find></entity-options></drop-down></default-field></field><field name="billingZip"><default-field><text-line size="10"/></default-field></field><field name="insurancePercent"><default-field title="Insurance Percent" tooltip="Record estimated cost of insurance using this percentage of the insured amount"><text-line size="6"/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="ShippingGatewaysForm" list="shippingGatewayList" transition="updateShippingGateway"><entity-find entity-name="mantle.product.store.ProductStoreShippingGateway" list="shippingGatewayList"><econdition field-name="productStoreId"/><select-field field-name="productStoreId,carrierPartyId,shippingGatewayConfigId"/></entity-find><hidden-parameters><parameter name="productStoreId"/></hidden-parameters><field name="carrierPartyId"><default-field title="Carrier"><display text=" "/><link url="editParty" text="PartyNameTemplate" entity-name="mantle.party.PartyDetail" parameter-map="[partyId:carrierPartyId]" link-type="anchor"/></default-field></field><field name="shippingGatewayConfigId"><default-field title="Shipment Gateway"><display text=" "/><link url="editShippingGateway" entity-name="mantle.shipment.carrier.ShippingGatewayConfig" text="${description}" link-type="anchor"/></default-field></field><field name="billingType"><default-field><drop-down allow-empty="true"><option key="SENDER" text="Sender"/><option key="RECIPIENT" text="Recipient"/><option key="THIRD_PARTY" text="Third Party"/></drop-down></default-field></field><field name="billingAccount"><default-field><text-line size="25"/></default-field></field><field name="billingCountry"><default-field><drop-down allow-empty="true"><entity-options key="${geoCodeAlpha2}" text="${geoCodeAlpha2} - ${geoName}"><entity-find entity-name="moqui.basic.Geo"><econdition field-name="geoTypeEnumId" value="GEOT_COUNTRY"/><order-by field-name="geoCodeAlpha2"/></entity-find></entity-options></drop-down></default-field></field><field name="billingZip"><default-field><text-line size="10"/></default-field></field><field name="insurancePercent"><default-field title="Ins. Percent" tooltip="Record estimated cost of insurance using this percentage of the insured amount"><text-line size="6"/></default-field></field><field name="submitButton"><default-field title=""><submit text="Update"/></default-field></field><field name="deleteButton" align="right"><default-field title=""><link url="deleteShippingGateway" icon="fa fa-trash" parameter-map="[productStoreId:productStoreId, carrierPartyId:carrierPartyId]" confirmation="Are you sure you want to remove this Shipping Gateway?"/></default-field></field><columns><column><field-ref name="carrierPartyId"/><field-ref name="shippingGatewayConfigId"/></column><column><field-ref name="billingCountry"/><field-ref name="billingAccount"/></column><column><field-ref name="billingZip"/><field-ref name="billingType"/></column><column><field-ref name="insurancePercent"/></column><column><field-ref name="submitButton"/><field-ref name="deleteButton"/></column></columns></form-list></box-body></container-box></widgets></section><section name="PaymentGatewaysSection"><actions><entity-find entity-name="mantle.product.store.ProductStorePaymentGateway" list="storePaymentGateway"><econdition field-name="productStoreId"/></entity-find></actions><widgets><container-box><box-header title="Payment Gateways"/><box-toolbar><container-dialog id="NewPaymentGatewayDialog" button-text="Add Payment Gateway"><form-single name="NewPaymentGatewayForm" transition="createPaymentGateway"><field name="productStoreId"><default-field><hidden/></default-field></field><field name="paymentInstrumentEnumId"><default-field title="Instrument"><drop-down><entity-options key="${enumId}" text="${enumId}: ${description ?: ''}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="PaymentInstrument"/><order-by field-name="enumId"/></entity-find></entity-options></drop-down></default-field></field><field name="paymentGatewayConfigId"><default-field title="Gateway Config"><drop-down><entity-options key="${paymentGatewayConfigId}" text="${description ?: ''} [${paymentGatewayConfigId}]"><entity-find entity-name="mantle.account.method.PaymentGatewayConfig"><order-by field-name="paymentGatewayConfigId"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="PaymentGatewayForm" list="storePaymentGateway" skip-form="true" header-dialog="false" select-columns="false" saved-finds="false" show-csv-button="false"><field name="paymentInstrumentEnumId"><default-field title="Instrument"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="paymentGatewayConfigId"><header-field title="Gateway Config"/><default-field><link url="editPaymentGateway" entity-name="mantle.account.method.PaymentGatewayConfig" text="${description}" link-type="anchor"/></default-field></field><field name="deleteButton" align="right"><default-field title=""><link url="deletePaymentGateway" icon="fa fa-trash" parameter-map="[productStoreId:productStoreId, paymentInstrumentEnumId:paymentInstrumentEnumId, paymentGatewayConfigId:paymentGatewayConfigId]" confirmation="Are you sure you want to remove this Payment Gateway?"/></default-field></field></form-list></box-body></container-box></widgets></section><section name="StoreDataDocumentSection"><actions><entity-find entity-name="mantle.product.store.ProductStoreDataDocument" limit="200" cache="true" list="storeDataDocumentList"><econdition field-name="productStoreId"/></entity-find><entity-find entity-name="moqui.entity.document.DataDocument" limit="200" cache="true" list="dataDocumentList"><order-by field-name="documentName"/></entity-find><entity-find entity-name="moqui.basic.Enumeration" limit="200" cache="true" list="storeDataDocumentTypeList"><econdition field-name="enumTypeId" value="ProductStoreDataDocumentType"/><order-by field-name="enumId"/></entity-find></actions><widgets><container-box><box-header title="Store Data Documents"/><box-toolbar><container-dialog id="NewStoreDataDocumentDialog" button-text="Add Store Data Document"><form-single name="NewStoreDataDocumentForm" transition="createStoreDataDocument"><field name="productStoreId"><default-field><hidden/></default-field></field><field name="typeEnumId"><default-field title="Store Data Document Type"><drop-down><list-options list="storeDataDocumentTypeList.findAll{!storeDataDocumentList.typeEnumId.contains(it.enumId)}" key="${enumId}" text="${enumId}: ${description ?: ''}"/></drop-down></default-field></field><field name="dataDocumentId"><default-field title="Data Document"><drop-down><list-options list="dataDocumentList" key="${dataDocumentId}" text="${dataDocumentId} - ${documentName}"/></drop-down></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="StoreDataDocumentForm" list="storeDataDocumentList" transition="updateStoreDataDocument"><field name="productStoreId"><default-field><hidden/></default-field></field><field name="typeEnumId"><default-field title="Store Data Document Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="dataDocumentId"><default-field title="Data Document"><drop-down><list-options list="dataDocumentList" key="${dataDocumentId}" text="${dataDocumentId} - ${documentName}"/></drop-down></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field name="deleteButton" align="right"><default-field title=""><link url="deleteStoreDataDocument" icon="fa fa-trash" confirmation="Are you sure you want to remove this Store Data Document?"/></default-field></field></form-list></box-body></container-box></widgets></section></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/ProductStore/Promotion/FindPromotion.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Store Promotions" default-menu-index="2"><parameter name="productStoreId" required="true"/><transition name="editPromotion"><default-response url="../EditPromotion"/></transition><transition name="createPromotion"><service-call name="create#mantle.product.store.ProductStorePromotion" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditPromotion"/></transition><transition name="updatePromotion"><service-call name="update#mantle.product.store.ProductStorePromotion" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deletePromotion"><service-call name="delete#mantle.product.store.ProductStorePromotion" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><widgets><container-dialog id="NewPromotionDialog" button-text="New Store Promotion"><form-single name="NewPromotionForm" transition="createPromotion"><field name="productStoreId"><default-field><hidden/></default-field></field><field name="itemDescription"><default-field title="Item Description"><text-line size="50"/></default-field></field><field name="serviceRegisterId"><default-field title="Service"><drop-down><entity-options key="${serviceRegisterId}" text="${description}"><entity-find entity-name="moqui.service.ServiceRegister"><econdition field-name="serviceTypeEnumId" value="ProductStorePromotion"/><order-by field-name="serviceRegisterId"/></entity-find></entity-options></drop-down></default-field></field><field name="fromDate"><default-field><date-time type="date-time"/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><label text="NOTE: Promotions are applied in the order of the Sequence Num. Higher value promotions should have lower sequence numbers." type="p"/><form-list name="PromotionsForm" list="promotionList" header-dialog="true" transition="updatePromotion" multi="true"><entity-find entity-name="mantle.product.store.ProductStorePromotion" list="promotionList"><search-form-inputs default-order-by="sequenceNum,storePromotionId"/><econdition field-name="productStoreId"/></entity-find><field name="productStoreId"><header-field><hidden/></header-field><default-field><hidden/></default-field></field><field name="sequenceNum"><header-field title="Seq Num" show-order-by="true"><text-find size="3" hide-options="true"/></header-field><default-field><text-line size="3"/></default-field></field><field name="storePromotionId"><header-field title="ID" show-order-by="true"><text-find size="10" hide-options="true"/></header-field><default-field><display text=" "/><link url="editPromotion" text="${storePromotionId}" link-type="anchor"/></default-field></field><field name="itemDescription"><header-field title="Item Description" show-order-by="case-insensitive"><text-find size="25" hide-options="true"/></header-field><default-field><link url="editPromotion" text="${itemDescription}" link-type="anchor"/></default-field></field><field name="serviceRegisterId"><header-field title="Service" show-order-by="true"><drop-down allow-empty="true"><entity-options key="${serviceRegisterId}" text="${description}"><entity-find entity-name="moqui.service.ServiceRegister"><econdition field-name="serviceTypeEnumId" value="ProductStorePromotion"/><order-by field-name="serviceRegisterId"/></entity-find></entity-options></drop-down></header-field><default-field><display-entity entity-name="moqui.service.ServiceRegister" text="${description}"/></default-field></field><field name="fromDate"><header-field title="From Date" show-order-by="true"><date-period/></header-field><default-field><date-time type="date-time"/></default-field></field><field name="thruDate"><header-field title="Thru Date" show-order-by="true"><date-period/></header-field><default-field><date-time type="date-time"/></default-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field><default-field title="Update"><submit/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/ProductStore/Promotion/EditPromotion.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Promotion" default-menu-index="1"><parameter name="productStoreId" required="true"/><parameter name="storePromotionId" required="true"/><transition name="editPromotion"><default-response url="."/></transition><transition name="editProduct"><default-response url="//${appRoot}/Catalog/Product/EditProduct"/></transition><transition name="updatePromotion"><service-call name="update#mantle.product.store.ProductStorePromotion" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="storePromoParameters"><service-call name="store#mantle.product.store.ProductStorePromoParameter" multi="true" in-map="true" out-map="context"/><default-response url="."/></transition><transition name="deletePromoParam"><service-call name="delete#mantle.product.store.ProductStorePromoParameter" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createPromoProduct"><service-call name="create#mantle.product.store.ProductStorePromoProduct" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deletePromoProduct"><service-call name="delete#mantle.product.store.ProductStorePromoProduct" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><actions><entity-find-one entity-name="mantle.product.store.ProductStorePromotion" value-field="storePromotion"><field-map field-name="productStoreId" from="productStoreId"/><field-map field-name="storePromotionId" from="storePromotionId"/></entity-find-one><entity-find-one entity-name="moqui.service.ServiceRegister" value-field="promoService"><field-map field-name="serviceRegisterId" from="storePromotion.serviceRegisterId"/></entity-find-one></actions><widgets><container-row><row-col md="6"><form-single name="EditPromotionForm" map="storePromotion" transition="updatePromotion"><field name="productStoreId"><default-field><hidden/></default-field></field><field name="storePromotionId"><default-field title="ID"><display/></default-field></field><field name="serviceRegisterId"><default-field title="Service"><display text="${promoService.description}"/></default-field></field><field name="itemDescription"><default-field title="Item Description"><text-line size="50"/></default-field></field><field name="sequenceNum"><default-field><text-line size="5"/></default-field></field><field name="fromDate"><default-field><date-time type="date-time"/></default-field></field><field name="thruDate"><default-field><date-time type="date-time"/></default-field></field><field name="requireCode"><default-field title="Require Code"><drop-down allow-empty="true"><option key="Y"/><option key="N"/></drop-down></default-field></field><field name="useLimitPerOrder"><default-field title="Limit Per Order"><text-line size="5" format="#"/></default-field></field><field name="useLimitPerCustomer"><default-field title="Per Customer"><text-line size="5" format="#"/></default-field></field><field name="useLimitPerPromotion"><default-field title="Per Promotion"><text-line size="5" format="#"/></default-field></field><field name="freeGroundShipping"><default-field title="Free Ground Ship"><radio no-current-selected-key="N"><option key="Y"/><option key="N"/></radio></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></row-col><row-col md="6"><section name="PromoParameterSection"><actions><set field="defaultSD" from="ec.service.getServiceDefinition('mantle.product.PromotionServices.apply#Promotion')"/><set field="sd" from="ec.service.getServiceDefinition(promoService.serviceName)"/><set field="paramList" from="new ArrayList()"/><script><![CDATA[def defaultParameterNames = defaultSD.getInParameterNames();
                        def inParameterNames = sd.getInParameterNames();
                        for (def name in inParameterNames) {
                            if(!defaultParameterNames.contains(name)) {
                                def param = sd.getInParameter(name)
                                def description = param.first("description")?.text ?: ""
                                def type = param.attribute("type")
                                paramList.add([parameterName:name, parameterDescription:description, parameterType:type])
                            }
                        }]]></script></actions><widgets><container-box><box-header title="Parameters"/><box-body><form-list name="PromoParameterForm" list="paramList" multi="true" transition="storePromoParameters"><row-actions><entity-find-one entity-name="mantle.product.store.ProductStorePromoParameter" value-field="promoParameter"><field-map field-name="storePromotionId"/><field-map field-name="parameterName"/></entity-find-one><set field="parameterValue" from="promoParameter?.parameterValue"/></row-actions><hidden-parameters><parameter name="productStoreId"/><parameter name="storePromotionId"/></hidden-parameters><field name="parameterName"><default-field title="Name"><display text="${org.moqui.util.StringUtilities.camelCaseToPretty(parameterName)}"/></default-field></field><field name="parameterDescription"><default-field title="Description"><display/></default-field></field><field name="parameterValue"><conditional-field condition="parameterType == 'Boolean'" title="Value"><check><option key="true" text=" "/></check></conditional-field><default-field title="Value"><text-line size="3" format="#"/></default-field></field><field name="deleteButton" align="right"><default-field title=""><link url="deletePromoParam" icon="fa fa-trash" parameter-map="[storePromotionId:storePromotionId, parameterName:parameterName]" confirmation="Are you sure you want to remove this Promo Param?"/></default-field></field><field name="submitButton" align="right"><default-field title="Update"><submit/></default-field></field></form-list></box-body></container-box></widgets></section><container-box><box-header title="Products"/><box-toolbar><container-dialog id="AddProductDialog" button-text="Add Product"><form-single name="AddProductForm" transition="createPromoProduct"><field name="productStoreId"><default-field><hidden/></default-field></field><field name="storePromotionId"><default-field><hidden/></default-field></field><field name="productId"><default-field title="Product"><drop-down><dynamic-options transition="getProductList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="excludeProduct"><default-field title="Exclude"><radio no-current-selected-key="N"><option key="N"/><option key="Y"/></radio></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="ProductsForm" list="psppdList" skip-form="true"><entity-find entity-name="mantle.product.store.ProductStorePromoProductDetail" list="psppdList"><econdition field-name="storePromotionId"/><select-field field-name="productId"/><order-by field-name="pseudoId"/></entity-find><field name="pseudoId"><default-field title="ID"><link url="editProduct" text="${pseudoId}" link-type="anchor"/></default-field></field><field name="productName"><default-field title="Name"><link url="editProduct" text="${productName}" link-type="anchor"/></default-field></field><field name="productTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="assetClassEnumId"><default-field title="A. Class"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="excludeProduct"><default-field title="Exclude"><display/></default-field></field><field name="delete"><default-field title=""><link url="deletePromoProduct" text="" icon="fa fa-trash" confirmation="Remove product from promotion?" parameter-map="[productId:productId]"/></default-field></field></form-list></box-body></container-box></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/ProductStore/Promotion/PromoCode/FindPromoCode.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Find Promo Code" default-menu-include="false"><parameter name="productStoreId" required="true"/><parameter name="storePromotionId" required="true"/><transition name="editPromoCode"><default-response url="../EditPromoCode"/></transition><transition name="createPromoCode"><service-call name="create#mantle.product.store.ProductStorePromoCode" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditPromoCode"/></transition><transition name="updatePromoCode"><service-call name="update#mantle.product.store.ProductStorePromoCode" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deletePromoCode"><service-call name="delete#mantle.product.store.ProductStorePromoCode" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions/><widgets><container-dialog id="NewPromoCodeDialog" button-text="New Promo Code"><form-single name="NewPromoCodeForm" transition="createPromoCode"><field name="productStoreId"><default-field><hidden/></default-field></field><field name="storePromotionId"><default-field><hidden/></default-field></field><field name="promoCode"><default-field title="Code"><text-line size="30"/></default-field></field><field name="fromDate"><default-field><date-time/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="PromoCodeForm" list="promoCodeList" header-dialog="true" skip-form="true"><entity-find entity-name="mantle.product.store.ProductStorePromoCode" list="promoCodeList"><search-form-inputs default-order-by="promoCode"/><econdition field-name="storePromotionId"/><select-field field-name="promoCodeId"/></entity-find><field name="productStoreId"><header-field><hidden/></header-field></field><field name="storePromotionId"><header-field><hidden/></header-field></field><field name="promoCode"><header-field title="Promo Code" show-order-by="case-insensitive"><text-find size="25" hide-options="true"/></header-field><default-field><display text=" "/><link url="editPromoCode" text="${promoCode}" link-type="anchor"/></default-field></field><field name="fromDate"><header-field title="From Date" show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="thruDate"><header-field title="Thru Date" show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="useLimitPerCode"><default-field title="Limit Per Code"><display/></default-field></field><field name="useLimitPerCustomer"><default-field title="Per Customer"><display/></default-field></field><field name="findButton"><header-field title="Find"><submit/></header-field></field><field name="deleteButton" align="right"><default-field title=""><link url="deletePromoCode" icon="fa fa-trash" parameter-map="[productStoreId:productStoreId, storePromotionId:storePromotionId, promoCodeId:promoCodeId]" confirmation="Are you sure you want to remove this Promo Code?"/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/ProductStore/Promotion/PromoCode/EditPromoCode.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Edit Promo Code" default-menu-index="1"><parameter name="productStoreId" required="true"/><parameter name="storePromotionId" required="true"/><parameter name="promoCodeId" required="true"/><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition name="updatePromoCode"><service-call name="update#mantle.product.store.ProductStorePromoCode" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createPromoCodeParty"><service-call name="create#mantle.product.store.ProductStorePromoCodeParty" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deletePromoCodeParty"><service-call name="delete#mantle.product.store.ProductStorePromoCodeParty" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><entity-find-one entity-name="mantle.product.store.ProductStorePromoCode" value-field="storePromoCode"><field-map field-name="storePromotionId" from="storePromotionId"/><field-map field-name="promoCodeId" from="promoCodeId"/></entity-find-one></actions><widgets><container-row><row-col lg="7"><form-single name="EditPromoCodeForm" map="storePromoCode" transition="updatePromoCode"><field name="productStoreId"><default-field><hidden/></default-field></field><field name="storePromotionId"><default-field><hidden/></default-field></field><field name="promoCodeId"><default-field title="ID"><display/></default-field></field><field name="promoCode"><default-field title="Promo Code"><text-line size="30"/></default-field></field><field name="fromDate"><default-field><date-time type="date-time"/></default-field></field><field name="thruDate"><default-field><date-time type="date-time"/></default-field></field><field name="useLimitPerCode"><default-field title="Limit Per Code"><text-line size="5" format="#"/></default-field></field><field name="useLimitPerCustomer"><default-field title="Per Customer"><text-line size="5" format="#"/></default-field></field><field name="requireParty"><default-field title="Require Party"><drop-down allow-empty="true"><option key="Y"/><option key="N"/></drop-down></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></row-col><row-col lg="5"><section name="PromoCodePartySection"><actions><entity-find entity-name="mantle.product.store.ProductStorePromoCodeParty" list="storePromoCodeParty"><econdition field-name="promoCodeId" value="${promoCodeId}"/></entity-find></actions><widgets><container-box><box-header title="Promo Code Party"/><box-toolbar><container-dialog id="NewPromoCodePartyDialog" button-text="Add Promo Code Party"><form-single name="NewPromoCodePartyForm" transition="createPromoCodeParty"><field name="productStoreId"><default-field><hidden/></default-field></field><field name="storePromotionId"><default-field><hidden/></default-field></field><field name="promoCodeId"><default-field><hidden/></default-field></field><field name="partyId"><default-field title="Party"><drop-down><dynamic-options transition="searchPartyList" server-search="true" min-length="2" parameter-map="[roleTypeId:'Customer']"/></drop-down></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="PromoCodePartyForm" list="storePromoCodeParty" skip-form="true"><field name="partyId"><header-field title="Party" show-order-by="case-insensitive"/><default-field><link url="editParty" text="PartyNameTemplate" entity-name="mantle.party.PartyDetail" link-type="anchor"/></default-field></field><field name="deleteButton" align="right"><default-field title=""><link url="deletePromoCodeParty" icon="fa fa-trash" parameter-map="[promoCodeId:promoCodeId, partyId:partyId]" confirmation="Are you sure you want to remove this Promo Code Party?"/></default-field></field></form-list></box-body></container-box></widgets></section></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/ProductStore/Promotion/PromoCode.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Promo Codes" default-menu-index="23" menu-image="/ssstatic/images/Promotions.png"><parameter name="productStoreId" required="true"/><parameter name="storePromotionId" required="true"/><subscreens default-item="FindPromoCode"/><widgets><subscreens-panel id="PromoCodePanel" type="tab"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/ProductStore/Promotion.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Promotions" default-menu-index="2" menu-image="/ssstatic/images/Promotions.png"><parameter name="productStoreId" required="true"/><subscreens default-item="FindPromotion"><subscreens-item name="FindPromotion" menu-include="false" location="component://SimpleScreens/screen/SimpleScreens/ProductStore/Promotion/FindPromotion.xml"/><subscreens-item name="EditPromotion" menu-index="1" location="component://SimpleScreens/screen/SimpleScreens/ProductStore/Promotion/EditPromotion.xml"/></subscreens><widgets><subscreens-panel id="PromotionsPanel" type="tab"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/ProductStore/FindProductStoreEmails.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Emails" default-menu-index="3"><parameter name="productStoreId" required="true"/><transition name="createStoreEmail"><service-call name="create#mantle.product.store.ProductStoreEmail" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateStoreEmail"><service-call name="update#mantle.product.store.ProductStoreEmail" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteStoreEmail"><service-call name="delete#mantle.product.store.ProductStoreEmail" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><entity-find entity-name="mantle.product.store.ProductStoreEmail" list="storeEmails"><search-form-inputs default-order-by="emailTypeEnumId"/><econdition field-name="productStoreId"/></entity-find></actions><widgets><container-dialog id="NewStoreEmailDialog" button-text="New Store Email"><form-single name="NewStoreEmailForm" transition="createStoreEmail"><field name="productStoreId"><default-field><hidden/></default-field></field><field name="emailTypeEnumId"><default-field title="Email Type"><drop-down><entity-options key="${enumId}" text="EnumerationNameTemplate"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="ProductStoreEmailType"/><order-by field-name="sequenceNum,description"/></entity-find></entity-options></drop-down></default-field></field><field name="fromDate" from="ec.user.nowTimestamp"><default-field><date-time type="date-time"/></default-field></field><field name="emailTemplateId"><default-field title="Template"><drop-down><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.email.EmailTemplate"><order-by field-name="emailTemplateId"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="StoreEmailsForm" list="storeEmails" header-dialog="true" transition="updateStoreEmail"><field name="productStoreId"><default-field><hidden/></default-field></field><field name="emailTypeEnumId"><header-field title="Email Type" show-order-by="true"><drop-down allow-multiple="true"><entity-options key="${enumId}" text="EnumerationNameTemplate"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="ProductStoreEmailType"/><order-by field-name="sequenceNum,description"/></entity-find></entity-options></drop-down></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="emailTemplateId"><header-field title="Email Template" show-order-by="case-insensitive"><text-find size="25" hide-options="true"/></header-field><default-field><display-entity entity-name="moqui.basic.email.EmailTemplate" text="${description}"/></default-field></field><field name="fromDate"><header-field title="From Date" show-order-by="case-insensitive"><date-period allow-empty="true"/></header-field><default-field><display/></default-field></field><field name="thruDate"><header-field title="Thru Date" show-order-by="case-insensitive"><date-period allow-empty="true"/></header-field><default-field><date-time type="date-time"/></default-field></field><field name="headerImagePath"><header-field title="Header Image Path" show-order-by="case-insensitive"><text-find size="25" hide-options="true"/></header-field><default-field><text-line size="30"/></default-field></field><field name="detailLinkPath"><header-field title="Detail Link Path" show-order-by="case-insensitive"><text-find size="25" hide-options="true"/></header-field><default-field><text-line size="30"/></default-field></field><field name="webOrderBcc"><header-field title="Web Order BCC" show-order-by="case-insensitive"><text-find size="25" hide-options="true"/></header-field><default-field><text-line size="30"/></default-field></field><field name="submitButton" align="right"><default-field title="Update"><submit/></default-field></field><field name="deleteButton" align="right"><default-field title=""><link url="deleteStoreEmail" icon="fa fa-trash" parameter-map="[productStoreId:productStoreId, emailTypeEnumId:emailTypeEnumId, fromDate:fromDate]" confirmation="Are you sure you want to remove this Email?"/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/ProductStore/FindProductStoreCategory.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Categories" default-menu-index="4"><parameter name="productStoreId" required="true"/><transition name="editCategory"><default-response url="//${appRoot}/Catalog/Category/EditCategory"/></transition><transition name="createStoreCategory"><service-call name="create#mantle.product.store.ProductStoreCategory" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateStoreCategory"><service-call name="update#mantle.product.store.ProductStoreCategory" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteStoreCategory"><service-call name="delete#mantle.product.store.ProductStoreCategory" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getCategoryList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><widgets><container-dialog id="NewStoreCategoryDialog" button-text="Add Store Category"><form-single name="NewStoreCategoryForm" transition="createStoreCategory"><field name="productStoreId"><default-field><hidden/></default-field></field><field name="productCategoryId"><default-field title="Category"><drop-down><dynamic-options transition="getCategoryList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="storeCategoryTypeEnumId"><default-field title="Store Category Type"><drop-down><entity-options key="${enumId}" text="${description ?: ''}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="ProductStoreCategoryType"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="fromDate"><default-field><date-time type="date-time"/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="StoreCategoriesForm" list="storeCategories" header-dialog="true" transition="updateStoreCategory"><entity-find entity-name="mantle.product.store.ProductStoreCategory" list="storeCategories"><search-form-inputs default-order-by="productCategoryId"/><econdition field-name="productStoreId"/></entity-find><field name="productStoreId"><default-field><hidden/></default-field></field><field name="sequenceNum"><header-field show-order-by="true"/><default-field><text-line size="4"/></default-field></field><field name="storeCategoryTypeEnumId"><header-field title="Store Category Type" show-order-by="true"/><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="productCategoryId"><header-field title="Product Category" show-order-by="true"/><default-field><display text=" "/><link url="editCategory" entity-name="mantle.product.category.ProductCategory" text="${categoryName}" link-type="anchor"/></default-field></field><field name="fromDate"><header-field title="From Date" show-order-by="true"/><default-field><display/></default-field></field><field name="thruDate"><header-field title="Thru Date" show-order-by="true"/><default-field><date-time/></default-field></field><field name="submitButton" align="right"><default-field title="Update"><submit/></default-field></field><field name="deleteButton" align="right"><default-field title=""><link url="deleteStoreCategory" icon="fa fa-trash" parameter-map="[productStoreId:productStoreId, productCategoryId:productCategoryId,                       storeCategoryTypeEnumId:storeCategoryTypeEnumId, fromDate:fromDate]" confirmation="Are you sure you want to remove this Store Category?"/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/ProductStore/FindProductStoreParty.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Parties" default-menu-index="5"><parameter name="productStoreId" required="true"/><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition name="createProductStoreParty"><service-call name="create#mantle.product.store.ProductStoreParty" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateProductStoreParty"><service-call name="update#mantle.product.store.ProductStoreParty" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteProductStoreParty"><service-call name="delete#mantle.product.store.ProductStoreParty" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><actions><entity-find entity-name="mantle.product.store.ProductStoreParty" list="storePartyList"><search-form-inputs default-order-by="partyId"/><econdition field-name="productStoreId"/></entity-find></actions><widgets><container-dialog id="NewStorePartyDialog" button-text="New Store Party"><form-single name="NewStorePartyForm" transition="createProductStoreParty"><field name="productStoreId"><default-field><hidden/></default-field></field><field name="partyId"><default-field title="Party"><drop-down><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="roleTypeId"><default-field title="Role Type"><drop-down><entity-options key="${roleTypeId}" text="${description}"><entity-find entity-name="mantle.party.RoleType"><order-by field-name="roleTypeId"/></entity-find></entity-options></drop-down></default-field></field><field name="fromDate" from="ec.user.nowTimestamp"><default-field><date-time type="date-time"/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="StorePartyFormList" list="storePartyList" header-dialog="true" transition="updateProductStoreParty"><field name="productStoreId"><default-field><hidden/></default-field></field><field name="partyId"><header-field title="Party" show-order-by="case-insensitive"/><default-field><display text=" "/><link url="editParty" text="PartyNameTemplate" entity-name="mantle.party.PartyDetail" link-type="anchor"/></default-field></field><field name="roleTypeId"><header-field title="Role Type" show-order-by="case-insensitive"/><default-field><display-entity entity-name="mantle.party.RoleType"/></default-field></field><field name="fromDate"><header-field title="From Date" show-order-by="case-insensitive"/><default-field><display/></default-field></field><field name="thruDate"><header-field title="Thru Date" show-order-by="case-insensitive"><date-period/></header-field><default-field><date-time type="date-time"/></default-field></field><field name="sequenceNum"><header-field title="Sequence Num" show-order-by="case-insensitive"/><default-field><text-line size="4" format="#"/></default-field></field><field name="submitButton" align="right"><default-field title="Update"><submit/></default-field></field><field name="deleteButton" align="right"><default-field title=""><link url="deleteProductStoreParty" icon="fa fa-trash" parameter-map="[productStoreId:productStoreId, partyId:partyId, roleTypeId:roleTypeId, fromDate:fromDate]" confirmation="Are you sure you want to remove this Party?"/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/ProductStore/FindProductStoreFacility.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Facilities" default-menu-index="6"><parameter name="productStoreId" required="true"/><transition name="editFacility"><default-response url="//${appRoot}/Facility/EditFacility"/></transition><transition name="updateProductStoreFacility"><service-call name="update#mantle.product.store.ProductStoreFacility" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createProductStoreFacility"><service-call name="create#mantle.product.store.ProductStoreFacility" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteProductStoreFacility"><service-call name="delete#mantle.product.store.ProductStoreFacility" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><entity-find entity-name="mantle.product.store.ProductStoreFacility" list="storeFacilityList"><search-form-inputs default-order-by="facilityId"/><econdition field-name="productStoreId"/></entity-find></actions><widgets><container-dialog id="NewStoreFacilityDialog" button-text="New Store Facility"><form-single name="NewStoreFacilityForm" transition="createProductStoreFacility"><field name="productStoreId"><default-field><hidden/></default-field></field><field name="facilityId"><default-field title="Facility"><drop-down><entity-options key="${facilityId}" text="${facilityName}"><entity-find entity-name="mantle.facility.Facility"><order-by field-name="facilityId"/></entity-find></entity-options></drop-down></default-field></field><field name="fromDate"><default-field><date-time type="date-time"/></default-field></field><field name="thruDate"><default-field><date-time type="date-time"/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="StoreFacilityFormList" list="storeFacilityList" transition="updateProductStoreFacility"><field name="productStoreId"><default-field><hidden/></default-field></field><field name="facilityId"><header-field title="Facility" show-order-by="case-insensitive"/><default-field><display text=" "/><link url="editFacility" text="${facilityName}" entity-name="mantle.facility.Facility" link-type="anchor"/></default-field></field><field name="fromDate"><header-field title="From Date" show-order-by="case-insensitive"/><default-field><display/></default-field></field><field name="thruDate"><header-field title="Thru Date" show-order-by="case-insensitive"/><default-field><date-time type="date-time"/></default-field></field><field name="sequenceNum"><header-field title="Sequence Num" show-order-by="case-insensitive"/><default-field><text-line size="4" format="#"/></default-field></field><field name="submitButton" align="right"><default-field title="Update"><submit/></default-field></field><field name="deleteButton" align="right"><default-field title=""><link url="deleteProductStoreFacility" icon="fa fa-trash" parameter-map="[productStoreId:productStoreId, facilityId:facilityId, fromDate:fromDate]" confirmation="Are you sure you want to remove this Facility?"/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/ProductStore/FindProductStoreSettings.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Settings" default-menu-index="6"><parameter name="productStoreId" required="true"/><transition name="createStoreSetting"><service-call name="create#mantle.product.store.ProductStoreSetting" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateStoreSetting"><service-call name="update#mantle.product.store.ProductStoreSetting" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteStoreSetting"><service-call name="delete#mantle.product.store.ProductStoreSetting" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getEnumRelatedByTypeList" location="component://webroot/template/screen/BasicTransitions.xml"/><widgets><container-dialog id="SelectStoreSettingDialog" button-text="Select Store Setting"><form-single name="SelectStoreSettingForm" transition="createStoreSetting"><field name="productStoreId"><default-field><hidden/></default-field></field><field name="settingTypeEnumId"><default-field title="Setting Type"><drop-down><entity-options key="${enumId}" text="EnumerationNameTemplate"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="ProductStoreSettingType"/><econdition field-name="relatedEnumTypeId" operator="is-not-null"/><order-by field-name="sequenceNum,description"/></entity-find></entity-options></drop-down></default-field></field><field name="fromDate" from="ec.user.nowTimestamp"><default-field><date-time type="date-time"/></default-field></field><field name="settingValue"><default-field title="Value"><drop-down><dynamic-options transition="getEnumRelatedByTypeList" value-field="enumId" label-field="description"><depends-on field="settingTypeEnumId" parameter="enumId"/></dynamic-options></drop-down></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><container-dialog id="NewStoreSettingDialog" button-text="Enter Store Setting"><form-single name="NewStoreSettingForm" transition="createStoreSetting"><field name="productStoreId"><default-field><hidden/></default-field></field><field name="settingTypeEnumId"><default-field title="Setting Type"><drop-down><entity-options key="${enumId}" text="EnumerationNameTemplate"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="ProductStoreSettingType"/><order-by field-name="sequenceNum,description"/></entity-find></entity-options></drop-down></default-field></field><field name="fromDate" from="ec.user.nowTimestamp"><default-field><date-time type="date-time"/></default-field></field><field name="settingValue"><default-field title="Value"><text-line size="80"/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="StoreSettingsForm" list="storeSettings" header-dialog="true" transition="updateStoreSetting"><entity-find entity-name="mantle.product.store.ProductStoreSetting" list="storeSettings"><search-form-inputs default-order-by="settingTypeEnumId"/><econdition field-name="productStoreId"/></entity-find><row-actions><entity-find-one entity-name="moqui.basic.Enumeration" value-field="settingTypeEnum"><field-map field-name="enumId" from="settingTypeEnumId"/></entity-find-one></row-actions><field name="productStoreId"><default-field><hidden/></default-field></field><field name="settingTypeEnumId"><header-field title="Setting Type" show-order-by="true"><drop-down allow-multiple="true"><entity-options key="${enumId}" text="EnumerationNameTemplate"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="ProductStoreSettingType"/><order-by field-name="sequenceNum,description"/></entity-find></entity-options></drop-down></header-field><default-field><display text="${description}" text-map="settingTypeEnum"/></default-field></field><field name="settingValue"><header-field title="Value" show-order-by="case-insensitive"><text-find size="40" hide-options="true"/></header-field><conditional-field condition="settingTypeEnum.relatedEnumTypeId"><drop-down><dynamic-options transition="getEnumRelatedByTypeList" value-field="enumId" label-field="description" parameter-map="[enumId:settingTypeEnumId]"/></drop-down></conditional-field><default-field><text-line size="60"/></default-field></field><field name="fromDate"><header-field title="From Date" show-order-by="case-insensitive"><date-period allow-empty="true"/></header-field><default-field><display/></default-field></field><field name="thruDate"><header-field title="Thru Date" show-order-by="case-insensitive"><date-period allow-empty="true"/></header-field><default-field><date-time type="date-time"/></default-field></field><field name="submitButton" align="right"><default-field title="Update"><submit/></default-field></field><field name="deleteButton" align="right"><default-field title=""><link url="deleteStoreSetting" icon="fa fa-trash" parameter-map="[productStoreId:productStoreId, settingTypeEnumId:settingTypeEnumId, fromDate:fromDate]" confirmation="Are you sure you want to remove this Setting?"/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/ProductStore.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Stores" default-menu-index="23" menu-image="/ssstatic/images/ProductStore.png"><subscreens default-item="FindProductStore"/><actions><entity-find-one entity-name="mantle.product.store.ProductStore" value-field="productStore"/></actions><widgets><label text="${productStoreId}: ${productStore.storeName}" type="strong" condition="productStore"/><subscreens-panel id="StorePanel" type="tab"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Supplier/FindSupplier.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="editSupplier"><default-response url="../EditSupplier"/></transition><transition name="findOrder"><default-response url="../../Order/FindOrder"/></transition><transition name="createPerson"><service-call name="mantle.party.PartyServices.create#Person" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditSupplier"/></transition><transition name="createOrganization"><service-call name="mantle.party.PartyServices.create#Organization" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditSupplier"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition-include name="getPartyClassificationList" location="component://SimpleScreens/template/party/PartyTransitions.xml"/><pre-actions><set field="roleTypeId" value="Supplier"/></pre-actions><actions><service-call name="mantle.party.PartyServices.search#Party" in-map="context" out-map="context"/></actions><widgets><container-dialog id="CreatePersonDialog" button-text="New Person Supplier"><form-single name="CreatePersonForm" transition="createPerson" extends="component://SimpleScreens/screen/SimpleScreens/Party/FindParty.xml#CreatePersonForm"/></container-dialog><container-dialog id="CreateOrganizationDialog" button-text="New Organization Supplier"><form-single name="CreateOrganizationForm" transition="createOrganization" extends="component://SimpleScreens/screen/SimpleScreens/Party/FindParty.xml#CreateOrganizationForm"/></container-dialog><link url="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-query-string-query.html#query-string-syntax" url-type="plain" link-type="anchor" target-window="_blank" text="Search String Reference"/><form-single name="OuterSearchForm" extends="component://SimpleScreens/screen/SimpleScreens/Party/FindParty.xml#OuterSearchForm"/><form-list name="SupplierListForm" list="documentList" skip-form="true" header-dialog="true" extends="component://SimpleScreens/screen/SimpleScreens/Party/FindParty.xml#PartyListForm"><field name="pseudoId"><default-field><link url="editSupplier" text="${pseudoId}" link-type="anchor"/></default-field></field><field name="combinedName"><default-field><link url="editSupplier" text="PartyNameOnlyTemplate" text-map="party" link-type="anchor"/></default-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field><default-field><link url="findOrder" text="Purchase Orders" parameter-map="[vendorPartyId:partyId]" link-type="anchor"/></default-field></field></form-list><container-row><row-col md="2" style="text-right"><label text="Current Search String" type="strong"/></row-col><row-col><label text="${queryString?:'No Current Search'}"/></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Supplier/EditSupplier.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Supplier" default-menu-index="1"><parameter name="partyId" required="true"/><transition name="findOrder"><default-response url="../../Order/FindOrder"/></transition><transition name="updateParty"><service-call name="mantle.party.PartyServices.update#PartyDetail" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createPartyRole"><service-call name="create#mantle.party.PartyRole" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deletePartyRole"><service-call name="delete#mantle.party.PartyRole" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createPartyIdentification"><service-call name="create#mantle.party.PartyIdentification" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updatePartyIdentification"><service-call name="update#mantle.party.PartyIdentification" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deletePartyIdentification"><parameter name="partyIdTypeEnumId"/><service-call name="delete#mantle.party.PartyIdentification" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updatePaymentMethodInfo"><default-response url="UpdatePaymentMethodInfo"/></transition><transition name="removePaymentMethod"><service-call name="mantle.account.PaymentMethodServices.delete#PaymentMethod" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="findFinancialAccount"><default-response url="//${appRoot}/Accounting/FinancialAccount/FindFinancialAccount"/></transition><transition name="editFinancialAccount"><default-response url="//${appRoot}/Accounting/FinancialAccount/EditFinancialAccount"/></transition><transition name="storePartyContactMech"><service-call name="mantle.party.ContactServices.store#PartyContactMech" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="removeContactInfo"><service-call name="mantle.party.ContactServices.delete#PartyContactMech" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateContactMechMutable"><service-call name="mantle.party.ContactServices.update#ContactMechMutable" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="validateAddress"><service-call name="mantle.shipment.CarrierServices.validate#PostalAddress" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createContactMechOther"><service-call name="mantle.party.ContactServices.create#ContactMechOther" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updatePartyContactOther"><service-call name="mantle.party.ContactServices.update#PartyContactOther" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getContactMechPurposesByType" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition name="createPartyNote"><service-call name="create#mantle.party.PartyNote" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updatePartyNote"><service-call name="update#mantle.party.PartyNote" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="createContent" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty.xml"/><transition-include name="updateContent" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty.xml"/><transition-include name="downloadContent" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty.xml"/><subscreens><subscreens-item name="UpdateContactInfo" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty/UpdateContactInfo.xml"/><subscreens-item name="ExpiredContactOther" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty/ExpiredContactOther.xml"/><subscreens-item name="ExpiredPostal" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty/ExpiredPostal.xml"/><subscreens-item name="UpdatePaymentMethodInfo" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty/UpdatePaymentMethodInfo.xml"/><subscreens-item name="FindDuplicates" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty/FindDuplicates.xml"/></subscreens><actions><entity-find-one entity-name="mantle.party.PartyDetail" value-field="party"/><if condition="party == null"><return error="true" message="Supplier not found with ID ${partyId}"/></if><entity-find-one entity-name="mantle.party.PartyRole" value-field="supplierRole"><field-map field-name="partyId"/><field-map field-name="roleTypeId" value="Supplier"/></entity-find-one><if condition="supplierRole == null"><return error="true" message="Party ${partyId} is not a Supplier"/></if></actions><widgets><container-row><row-col lg="6"><link url="findOrder" text="Orders" parameter-map="[vendorPartyId:partyId]"/><dynamic-dialog id="FindDuplicatesDialog" button-text="Find Duplicates" transition="FindDuplicates" width="960"/><section-include name="HasDuplicatesSection" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty.xml"/><section-include name="EditPartySection" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty.xml"/><section-include name="RolesSection" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty.xml"/><section-include name="PartyIdentificationSection" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty.xml"/></row-col><row-col lg="6"><section-include name="NotesSection" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty.xml"/><section-include name="ContactInfoSection" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty.xml"/><section-include name="PaymentMethodSection" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty.xml"/><section-include name="FinancialAccountSection" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty.xml"/><section-include name="ContentSection" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty.xml"/></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Supplier.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Suppliers" default-menu-index="11" menu-image="/ssstatic/images/Supplier.png"><subscreens default-item="FindSupplier"><subscreens-item name="FinancialInfo" location="component://SimpleScreens/screen/SimpleScreens/Party/FinancialInfo.xml" menu-index="11"/></subscreens><pre-actions><set field="roleTypeId" value="Supplier"/></pre-actions><actions><entity-find-one entity-name="mantle.party.PartyDetail" value-field="partyDetail"/></actions><widgets><label text="PartyNameTemplate" text-map="partyDetail" type="strong" condition="partyDetail"/><subscreens-panel id="supplier-panel" type="tab"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Survey/FindSurvey.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="createSurvey"><service-call name="create#moqui.screen.form.DbForm" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditSurvey"/></transition><transition name="editSurvey"><default-response url="../EditSurvey"/></transition><actions><set field="purposeEnumId" from="purposeEnumId ?: 'DbfpSurvey'"/></actions><widgets><container-box><box-header title="Survey"/><box-toolbar><container-dialog id="NewSurveyContainer" button-text="New Survey"><form-single name="NewSurveyForm" transition="createSurvey"><field name="purposeEnumId"><default-field><hidden/></default-field></field><field name="description"><default-field><text-line size="70"/></default-field></field><field name="comments"><default-field><text-area cols="60" rows="6"/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body-nopad><form-list name="SurveyList" list="surveyList" skip-form="true" header-dialog="true" select-columns="true" saved-finds="true" show-csv-button="true"><entity-find entity-name="moqui.screen.form.DbForm" list="surveyList"><search-form-inputs default-order-by="description"/></entity-find><field name="formId"><header-field title="Survey ID" show-order-by="case-insensitive"><text-find size="10" hide-options="true"/></header-field><default-field><link url="editSurvey" text="${formId}" link-type="anchor"/></default-field></field><field name="description"><header-field title="Description" show-order-by="case-insensitive"><text-find size="25" hide-options="true"/></header-field><default-field><link url="editSurvey" text="${description}" link-type="anchor"/></default-field></field><field name="purposeEnumId"><header-field title="Purpose"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="DbFormPurpose"/><set field="allowEmpty" value="true"/><set field="showNot" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="comments"><header-field title="Comments" show-order-by="case-insensitive"><text-find size="25" hide-options="true"/></header-field><default-field><display text="${comments}"/></default-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field><default-field><display text=" "/></default-field></field></form-list></box-body-nopad></container-box></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Survey/EditSurvey.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Survey" default-menu-index="1"><parameter name="formId" required="true"/><transition name="updateSurvey"><service-call name="update#moqui.screen.form.DbForm" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="addUserGroup"><service-call name="create#moqui.screen.form.DbFormUserGroup" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteDbFormUserGroup"><service-call name="delete#moqui.screen.form.DbFormUserGroup" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><set field="formLocation" value="DbForm#${formId}"/><entity-find-one entity-name="moqui.screen.form.DbForm" value-field="survey"><field-map field-name="formId" from="formId"/></entity-find-one></actions><widgets><container-row><row-col lg="7"><form-single name="EditSurveyForm" map="survey" transition="updateSurvey"><field name="formId"><default-field title="Survey ID"><display text="${formId}"/></default-field></field><field name="description"><default-field title="Description"><text-line size="70"/></default-field></field><field name="comments"><default-field><text-area cols="60" rows="6"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></row-col><row-col lg="5" style="position: right;"><section name="UserGroupSection"><widgets><container-box><box-header title="User Groups"/><box-toolbar><container-dialog id="NewUserGroupDialog" button-text="Add User Group"><form-single name="NewUserGroupForm" transition="addUserGroup"><field name="formId"><default-field title="Survey ID"><hidden/></default-field></field><field name="userGroupId"><default-field title="User Group ID"><drop-down><entity-options key="${userGroupId}" text="${description ? description : userGroupId}"><entity-find entity-name="moqui.security.UserGroup"><econdition field-name="groupTypeEnumId" value="UgtPopcAdmin"/><order-by field-name="description,userGroupId,groupTypeEnumId"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="UserGroupForm" list="userGroupList"><entity-find entity-name="moqui.screen.form.DbFormAndUserGroup" list="dbFormUserGroupList"><econdition field-name="formId"/><select-field field-name="description"/><order-by field-name="description,groupTypeEnumId"/></entity-find><field name="formId"><default-field><hidden/></default-field></field><field name="userGroupId"><default-field><hidden/></default-field></field><field name="description"><default-field title="User Group"><display text="${description ? description : userGroupId}"/></default-field></field><field name="deleteButton" align="right"><default-field title=""><link url="deleteDbFormUserGroup" icon="fa fa-trash" parameter-map="[formId:formId, userGroupId:userGroupId]" confirmation="Are you sure you want to remove this User Group?"/></default-field></field></form-list></box-body></container-box></widgets></section></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Survey/Fields.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Fields" default-menu-index="2"><parameter name="formId" required="true"/><transition name="addDbFormField"><service-call name="create#moqui.screen.form.DbFormField" in-map="context + [condition:null, fieldName:org.moqui.util.StringUtilities.prettyToCamelCase(title, false)]" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateDbFormField"><service-call name="org.moqui.impl.ScreenServices.update#DbFormField" in-map="context + [condition:null]" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteDbFormField"><service-call name="org.moqui.impl.ScreenServices.delete#DbFormField" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="addFieldOption"><service-call name="create#moqui.screen.form.DbFormFieldOption" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateFieldOption"><service-call name="update#moqui.screen.form.DbFormFieldOption" multi="true" in-map="context" out-map="context"/><default-response url="."/></transition><transition name="deleteFieldOption"><service-call name="delete#moqui.screen.form.DbFormFieldOption" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><entity-find entity-name="moqui.screen.form.DbFormField" list="dbFormFieldList"><econdition field-name="formId" from="formId"/><order-by field-name="layoutSequenceNum"/></entity-find><script><![CDATA[enumFieldOptionsList = [];
            enumFieldOptionsList.addAll(dbFormFieldList.cloneList().filterByAnd([fieldTypeEnumId: 'DBFFT_check']))
            enumFieldOptionsList.addAll(dbFormFieldList.cloneList().filterByAnd([fieldTypeEnumId: 'DBFFT_drop-down']))
            enumFieldOptionsList.addAll(dbFormFieldList.cloneList().filterByAnd([fieldTypeEnumId: 'DBFFT_radio']))
            enumFieldOptionsList = org.moqui.util.CollectionUtilities.orderMapList(enumFieldOptionsList, ['layoutSequenceNum'])]]></script></actions><widgets><container-dialog id="NewDbFormFieldDialog" button-text="Add Survey Field"><form-single name="NewDbFormFieldForm" transition="addDbFormField"><field name="formId"><default-field title="Survey ID"><hidden/></default-field></field><field name="title"><default-field title="Title"><text-line size="50"/></default-field></field><field name="fieldName" from="org.moqui.util.StringUtilities.prettyToCamelCase(title, false)"><default-field title=""><hidden/></default-field></field><field name="fieldTypeEnumId"><default-field title="Type"><drop-down><entity-options key="${enumId}" text="${description ?: enumId}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="DbFormFieldType"/><order-by field-name="description,enumId"/></entity-find></entity-options></drop-down></default-field></field><field name="layoutSequenceNum"><default-field title="Layout Sequence"><text-line size="10"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog><container-dialog id="SurveyPreviewContainer" button-text="Survey Form Preview"><form-single name="SurveyPreview" extends="DbForm#${formId}" dynamic="true"><field name="formLocation"><default-field><hidden default-value="DbForm#${formId}"/></default-field></field><field name="formId" from="formId"><default-field><hidden/></default-field></field></form-single></container-dialog><container-row><row-col lg="7"><section name="DbFormFields" condition="dbFormFieldList"><widgets><form-list name="DbFormFieldList" list="dbFormFieldList" transition="updateDbFormField"><field name="formId"><default-field><hidden/></default-field></field><field name="fieldName"><default-field><display/></default-field></field><field name="title"><default-field><text-line size="25"/></default-field></field><field name="fieldTypeEnumId"><default-field title="Type"><drop-down><entity-options key="${enumId}" text="${description ?: enumId}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="DbFormFieldType"/><order-by field-name="description,enumId"/></entity-find></entity-options></drop-down></default-field></field><field name="layoutSequenceNum"><default-field title="Sequence"><text-line size="5"/></default-field></field><field name="submitButton" align="right"><default-field><submit text="Update"/><link url="deleteDbFormField" icon="fa fa-trash" parameter-map="[formId:formId, fieldName:fieldName]" confirmation="Are you sure you want to remove this Field?"/></default-field></field></form-list></widgets></section></row-col><row-col lg="5"><section-iterate name="EnumDbFormFieldOptions" list="enumFieldOptionsList" entry="field"><widgets><section name="fieldOption"><widgets><container-box><box-header title="Options for ${field.title}"/><box-toolbar><container-dialog id="NewFieldOptionDialog" button-text="Add Option"><form-single name="NewFieldOptionForm" transition="addFieldOption"><field name="formId"><default-field title=""><hidden/></default-field></field><field name="fieldName" from="field.fieldName"><default-field title=""><hidden/></default-field></field><field name="title" from="field.title"><default-field><display/></default-field></field><field name="keyValue"><default-field><text-line size="15"/></default-field></field><field name="text"><default-field title="Description"><text-line size="25"/></default-field></field><field name="sequenceNum"><default-field><text-line size="5"/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="FieldOptionForm" list="fieldOptionList" multi="true" transition="updateFieldOption"><entity-find entity-name="moqui.screen.form.DbFormFieldOption" list="fieldOptionList"><econdition field-name="formId" from="field.formId"/><econdition field-name="fieldName" from="field.fieldName"/><order-by field-name="sequenceNum"/></entity-find><field name="formId"><default-field><hidden/></default-field></field><field name="fieldName"><default-field><hidden/></default-field></field><field name="sequenceNum"><default-field title="Sequence"><display/></default-field></field><field name="keyValue"><default-field><text-line size="10"/></default-field></field><field name="text"><default-field title="Description"><text-line size="30"/></default-field></field><field name="deleteButton" align="right"><default-field title=""><link url="deleteFieldOption" icon="fa fa-trash" parameter-map="[formId:formId, fieldName:fieldName, sequenceNum:sequenceNum]" confirmation="Are you sure you want to remove this Field Option?"/></default-field></field><field name="submitButton" align="right"><default-field title="Update"><submit/></default-field></field></form-list></box-body></container-box></widgets></section></widgets></section-iterate></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Survey/Responses.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Responses" default-menu-index="3"><parameter name="formId" required="true"/><transition name="createFormResponse"><service-call name="org.moqui.impl.ScreenServices.create#FormResponse" in-map="[formLocation:formLocation, formId:formId, responseMap:ec.web.parameters]" out-map="context" multi="parameter"/><default-response url="../EditSurvey"/></transition><transition name="responseDetails"><default-response url="../ResponseDetails"/></transition><actions><entity-find entity-name="moqui.screen.form.FormResponse" list="responseList"><search-form-inputs default-order-by="-responseDate"/><econdition field-name="formId"/></entity-find></actions><widgets><form-list name="ResponseListForm" list="responseList"><field name="formResponseId"><default-field title="Survey Response ID"><link url="responseDetails" text="${formResponseId}" link-type="anchor"/></default-field></field><field name="formLocation"><header-field title="Form" show-order-by="case-insensitive"><text-find hide-options="true"/></header-field><default-field><display also-hidden="false"/></default-field></field><field name="userId"><header-field title="User ID" show-order-by="case-insensitive"><text-find hide-options="true"/></header-field><default-field><display also-hidden="false"/></default-field></field><field name="responseDate"><header-field title="Date" show-order-by="true"><date-period/></header-field><default-field title=""><display/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Survey/ResponseDetails.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Response Details" default-menu-index="4"><parameter name="formResponseId" required="true"/><parameter name="formId" required="true"/><actions><service-call name="org.moqui.impl.ScreenServices.get#FormResponse" in-map="context" out-map="context"/></actions><widgets><form-single name="ResponseDetailsForm" map="responseMap" extends="${formLocation}" dynamic="true"><field name="formResponseId"><default-field><hidden/></default-field></field><field name="formId"><default-field><hidden/></default-field></field></form-single></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Survey/ResponseStats.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Response Stats" default-menu-index="5"><parameter name="formId" required="true"/><actions><service-call name="org.moqui.impl.ScreenServices.get#FormResponseStats" in-map="context" out-map="context"/></actions><widgets><container-row><row-col sm="2"><label text="Total Survey Response:" type="strong"/></row-col><row-col sm="2"><label text="${formResponseCount}" type="strong"/></row-col></container-row><container-row><row-col lg="6"><section name="DbFormFields"><condition><expression><![CDATA[textDbFormFieldResponseCountList]]></expression></condition><widgets><form-list name="TextDbFormFieldResponseCountList" list="textDbFormFieldResponseCountList"><field name="title"><default-field><display/></default-field></field><field name="count"><default-field><display/></default-field></field></form-list></widgets></section></row-col><row-col lg="6"><section-iterate name="EnumDbFormFieldResponseCountList" list="enumDbFormFieldResponseCountList" entry="field"><widgets><section name="enumDbFormFieldResponse"><widgets><container-box><box-header title="${field.title}"/><box-body><form-list name="FieldOptionForm" list="field.fieldOptionList"><field name="text"><default-field><display/></default-field></field><field name="count"><default-field><display/></default-field></field></form-list></box-body></container-box></widgets></section></widgets></section-iterate></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Survey.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Survey" default-menu-index="18" menu-image="fa fa-pencil-square-o" menu-image-type="icon"><subscreens default-item="FindSurvey"/><widgets><subscreens-panel id="SurveyPanel" type="tab"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Task/FindTask.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="findTask"><default-response url="."/></transition><transition name="editTask"><default-response url="../TaskSummary"/></transition><transition name="projectSummary"><default-response url="../../Project/ProjectSummary"/></transition><transition name="milestoneSummary"><default-response url="../../Project/MilestoneSummary"/></transition><transition name="createTask"><service-call name="mantle.work.TaskServices.create#Task" in-map="context" out-map="context" multi="parameter"/><default-response url="../TaskSummary"/></transition><transition name="updateTask"><service-call name="mantle.work.TaskServices.update#Task" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="addWorkEffortParty"><service-call name="mantle.work.WorkEffortServices.add#WorkEffortParty" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="removeWorkEffortParty"><service-call name="mantle.work.WorkEffortServices.remove#WorkEffortParty" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="getProjectMilestones"><service-call name="mantle.work.ProjectServices.get#ProjectMilestones" web-send-json-response="resultList" in-map="true" out-map="context" multi="parameter"/><default-response type="none"/></transition><transition-include name="getTaskList" location="component://SimpleScreens/template/work/WorkTransitions.xml"/><transition name="getProjectParties"><service-call name="mantle.work.ProjectServices.get#ProjectParties" web-send-json-response="resultList" in-map="true" out-map="context" multi="parameter"/><default-response type="none"/></transition><transition name="getProjectTeams"><service-call name="mantle.work.ProjectServices.get#ProjectTeams" web-send-json-response="resultList" in-map="true" out-map="context" multi="parameter"/><default-response type="none"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition name="TaskList.csv"><default-response url="."><parameter name="renderMode" value="csv"/><parameter name="pageNoLimit" value="true"/><parameter name="lastStandalone" value="true"/></default-response></transition><pre-actions><set field="html_title" value="Find Task"/></pre-actions><actions><entity-find entity-name="mantle.work.effort.WorkEffortAndParty" list="myProjectList"><econditions combine="or"><econdition field-name="visibilityEnumId" operator="in" value="WevGeneral,WevAllUsers"/><econditions><date-filter/><econdition field-name="partyId" from="ec.user.userAccount.partyId"/></econditions></econditions><econdition field-name="workEffortTypeEnumId" value="WetProject"/><order-by field-name="workEffortId"/></entity-find><set field="myProjectIds" from="myProjectList.workEffortId"/><if condition="!queryString"><then><entity-find entity-name="mantle.work.effort.PartyTaskSummary" list="taskList"><search-form-inputs default-order-by="priority,workEffortId"><default-parameters statusId="WeInPlanning,WeApproved,WeInProgress,WeOnHold,WeComplete" statusId_op="in"/></search-form-inputs><econdition field-name="workEffortTypeEnumId" value="WetTask"/><econdition field-name="rootWorkEffortId" operator="in" from="myProjectIds" or-null="true"/><select-field field-name="rootWorkEffortId,milestoneWorkEffortId,parentWorkEffortId,workEffortId"/><select-field field-name="workEffortName,priority,purposeEnumId,statusId,resolutionEnumId"/><select-field field-name="estimatedCompletionDate,estimatedWorkTime,remainingWorkTime,actualWorkTime,lastUpdatedStamp"/></entity-find></then><else><set field="searchInputs" from="new HashMap(ec.web.parameters)"/><if condition="rootWorkEffortId"><set field="queryString" value="${queryString} AND project:${rootWorkEffortId}"/><set field="searchInputs.rootWorkEffortId" value=""/></if><if condition="parentWorkEffortId"><set field="queryString" value="${queryString} AND parent:${parentWorkEffortId}"/><set field="searchInputs.parentWorkEffortId" value=""/></if><if condition="workEffortId"><set field="queryString" value="${queryString} AND workEffortId:${workEffortId}"/><set field="searchInputs.workEffortId" value=""/></if><if condition="purposeEnumId"><set field="queryString" value="${queryString} AND purposeEnumId:${purposeEnumId}"/><set field="searchInputs.purposeEnumId" value=""/></if><if condition="statusId"><set field="queryString" value="${queryString} AND statusId:${statusId}"/><set field="searchInputs.statusId" value=""/></if><if condition="resolutionEnumId"><set field="queryString" value="${queryString} AND resolutionEnumId:${resolutionEnumId}"/><set field="searchInputs.resolutionEnumId" value=""/></if><service-call name="org.moqui.search.SearchServices.search#DataDocuments" out-map="context" in-map="context + [indexName:'mantle', documentType:'MantleTask']"/><set field="workEffortIdList" from="documentList._id"/><entity-find entity-name="mantle.work.effort.PartyTaskSummary" list="taskList"><search-form-inputs default-order-by="priority,workEffortId" input-fields-map="searchInputs"/><econdition field-name="workEffortId" operator="in" from="workEffortIdList"/><econdition field-name="rootWorkEffortId" operator="in" from="myProjectIds" or-null="true"/><econdition field-name="workEffortTypeEnumId" value="WetTask"/><select-field field-name="rootWorkEffortId,milestoneWorkEffortId,parentWorkEffortId,workEffortId"/><select-field field-name="workEffortName,priority,purposeEnumId,statusId,resolutionEnumId"/><select-field field-name="estimatedCompletionDate,estimatedWorkTime,remainingWorkTime,actualWorkTime,lastUpdatedStamp"/></entity-find></else></if></actions><widgets><container-row><row-col md="6"><form-single name="SearchOptions" transition="findTask" focus-field="queryString"><field name="queryString" from="ec.web.parameters.queryString"><default-field title=""><text-line size="40"/></default-field></field><field name="submitButton"><default-field title="Text Search"><submit/></default-field></field><field-layout><field-row-big><field-ref name="queryString"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single></row-col><row-col md="6" style="text-right"><container-dialog id="NewTaskContainer" button-text="New Task"><form-single name="NewTaskForm" transition="createTask"><field name="rootWorkEffortId"><default-field title="Project"><drop-down allow-empty="true"><list-options list="myProjectList" key="${workEffortId}" text="WorkEffortNameTemplate"/></drop-down></default-field></field><field name="milestoneWorkEffortId"><default-field title="Milestone"><drop-down allow-empty="true"><dynamic-options transition="getProjectMilestones" value-field="workEffortId" label-field="milestoneLabel"><depends-on field="rootWorkEffortId"/></dynamic-options></drop-down></default-field></field><field name="parentWorkEffortId"><default-field title="Parent Task"><drop-down allow-empty="true"><dynamic-options transition="getTaskList" min-length="2" server-search="true" depends-optional="true"><depends-on field="rootWorkEffortId"/></dynamic-options></drop-down></default-field></field><field name="assignToPartyId"><default-field title="Assign To"><drop-down no-current-selected-key="${ec.user.userAccount.partyId}" allow-empty="true"><dynamic-options transition="getProjectParties" value-field="partyId" label-field="name" depends-optional="true" server-search="true" min-length="0" parameter-map="[addOptional:'false']"><depends-on field="rootWorkEffortId"/></dynamic-options></drop-down></default-field></field><field name="workEffortName"><default-field title="Task Name"><text-line/></default-field></field><field name="priority"><default-field><drop-down no-current-selected-key="5"><option key="1"/><option key="2"/><option key="3"/><option key="4"/><option key="5"/><option key="6"/><option key="7"/><option key="8"/><option key="9"/></drop-down></default-field></field><field name="purposeEnumId"><default-field title="Purpose"><drop-down no-current-selected-key="WepTask"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="WorkEffortPurpose"/><econdition field-name="parentEnumId" value="WetTask"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="statusId"><default-field title="Status"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="WorkEffort"/></widget-template-include></default-field></field><field name="estimatedCompletionDate"><default-field title="Due Date"><date-time type="date" format="yyyy-MM-dd"/></default-field></field><field name="estimatedWorkTime"><default-field title="Estimated Hours"><text-line size="5"/></default-field></field><field name="description"><default-field title="Description"><text-area rows="10" cols="60"/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog></row-col></container-row><form-list name="ListTasks" list="taskList" skip-form="true" header-dialog="true" saved-finds="true" select-columns="true" show-page-size="true" show-csv-button="true" show-xlsx-button="true"><row-actions><entity-find entity-name="mantle.work.effort.WorkEffortAndPartyDetail" list="weapdList"><date-filter/><econdition field-name="workEffortId"/><select-field field-name="firstName,lastName,organizationName"/><order-by field-name="firstName,lastName,organizationName"/></entity-find></row-actions><row-selection id-field="workEffortId"><action><dialog button-text="Assign" title="Assign Selected Tasks to Party"/><form-single name="AssignTaskSelected" transition="addWorkEffortParty" pass-through-parameters="true"><field name="partyId"><default-field title="Person"><drop-down><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="roleTypeId"><default-field title="Role"><drop-down no-current-selected-key="Assignee"><entity-options key="${roleTypeId}" text="${description}"><entity-find entity-name="mantle.party.RoleGroupMemberAndType" cache="true"><econdition field-name="roleGroupEnumId" value="RgpTask"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="expectationEnumId"><default-field title="Expectation"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="WorkEffortPartyExpectation"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="emplPositionClassId"><default-field title="Position Class"><drop-down allow-empty="true"><entity-options key="${emplPositionClassId}" text="${title}"><entity-find entity-name="EmplPositionClass"/></entity-options></drop-down></default-field></field><field name="statusId" from="'WeptAssigned'"><default-field title="Status"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="WorkEffortParty"/></widget-template-include></default-field></field><field name="submitButton"><default-field title="Assign Selected Tasks"><submit/></default-field></field></form-single></action><action><dialog button-text="Un-Assign" title="Un-Assign Selected Tasks from Party"/><form-single name="UnAssignTaskSelected" transition="removeWorkEffortParty" pass-through-parameters="true"><field name="partyId"><default-field title="Person"><drop-down><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="roleTypeId"><default-field title="Role"><drop-down allow-empty="true"><entity-options key="${roleTypeId}" text="${description}"><entity-find entity-name="mantle.party.RoleGroupMemberAndType" cache="true"><econdition field-name="roleGroupEnumId" value="RgpTask"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Un-Assign Selected Tasks"><submit/></default-field></field></form-single></action><action><dialog button-text="Update" title="Update Selected Tasks"/><form-single name="UpdateTaskSelected" transition="updateTask" exclude-empty-fields="true" pass-through-parameters="true"><field name="projectNote"><conditional-field title="" condition="!rootWorkEffortId"><label text="Selecting a Project will move tasks to that Project. If updating Project, Milestone, or Parent Task first select a Project in the Find Options and submit the form." type="strong" style="text-danger"/></conditional-field><default-field><label text="Viewing Project: ${rootWorkEffortId}" type="strong"/><label text="Selecting a different Project will move tasks to that Project." type="strong" style="text-warning"/></default-field></field><field name="rootWorkEffortId"><default-field title="Project"><drop-down allow-empty="true"><list-options list="myProjectList" key="${workEffortId}" text="WorkEffortNameTemplate"/></drop-down></default-field></field><field name="milestoneWorkEffortId"><default-field title="Milestone"><drop-down allow-empty="true"><dynamic-options transition="getProjectMilestones" value-field="workEffortId" label-field="milestoneLabel"><depends-on field="rootWorkEffortId"/></dynamic-options></drop-down></default-field></field><field name="parentWorkEffortId"><default-field title="Parent Task"><drop-down allow-empty="true"><dynamic-options transition="getTaskList" min-length="2" server-search="true" depends-optional="true"><depends-on field="rootWorkEffortId"/></dynamic-options></drop-down></default-field></field><field name="priority"><default-field><drop-down allow-empty="true"><option key="1"/><option key="2"/><option key="3"/><option key="4"/><option key="5"/><option key="6"/><option key="7"/><option key="8"/><option key="9"/></drop-down></default-field></field><field name="purposeEnumId"><default-field title="Purpose"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="WorkEffortPurpose"/><set field="parentEnumId" value="WetTask"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="statusId" from="null"><default-field title="Status"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="WorkEffort"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="resolutionEnumId"><default-field title="Resolution"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="WorkEffortResolution"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="estimatedCompletionDate"><default-field title="Due Date"><date-time type="date" format="yyyy-MM-dd"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></action></row-selection><field name="queryString" from="ec.web.parameters.queryString"><header-field title="Text Search"><text-line size="70"/></header-field></field><field name="priority"><header-field show-order-by="true"><range-find/></header-field><default-field title="Pri"><display/></default-field></field><field name="workEffortId"><header-field title="ID" show-order-by="true"><text-find/></header-field><default-field><link text="${workEffortId}" url="editTask" link-type="anchor"/></default-field></field><field name="workEffortName"><header-field title="Name" show-order-by="true"><text-find/></header-field><default-field><link text="${workEffortName}" url="editTask" link-type="anchor"/></default-field></field><field name="rootWorkEffortId"><header-field title="Project" show-order-by="true"><drop-down allow-empty="true"><list-options list="myProjectList" key="${workEffortId}" text="WorkEffortNameTemplate"/></drop-down></header-field><default-field><link url="projectSummary" text="${rootWorkEffortId}" link-type="anchor" condition="rootWorkEffortId"><parameter name="workEffortId" from="rootWorkEffortId"/></link></default-field></field><field name="parentWorkEffortId"><header-field title="Parent" show-order-by="true"><drop-down allow-empty="true"><dynamic-options transition="getTaskList" min-length="2" server-search="true" depends-optional="true"><depends-on field="rootWorkEffortId"/></dynamic-options></drop-down></header-field><default-field><link url="editTask" text="${parentWorkEffortId}" link-type="anchor" condition="parentWorkEffortId"><parameter name="workEffortId" from="parentWorkEffortId"/></link></default-field></field><field name="milestoneWorkEffortId"><header-field title="Milestone" show-order-by="true"><drop-down allow-empty="true"><dynamic-options transition="getProjectMilestones" value-field="workEffortId" label-field="milestoneLabel"><depends-on field="rootWorkEffortId"/></dynamic-options></drop-down></header-field><default-field><link text="${milestoneWorkEffortId?:''}" url="milestoneSummary" link-type="anchor" condition="milestoneWorkEffortId"/></default-field></field><field name="purposeEnumId"><header-field title="Purpose" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="WorkEffortPurpose"/><set field="parentEnumId" value="WetTask"/><set field="allowMultiple" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration" also-hidden="false"/></default-field></field><field name="statusId"><header-field title="Status" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="WorkEffort"/><set field="allowMultiple" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.StatusItem" also-hidden="false"/></default-field></field><field name="resolutionEnumId"><header-field title="Resolution" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="WorkEffortResolution"/><set field="allowMultiple" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration" also-hidden="false"/></default-field></field><field name="partyId"><header-field title="Assigned To"><drop-down allow-multiple="true"><dynamic-options transition="getProjectParties" value-field="partyId" label-field="name" depends-optional="true" server-search="true" min-length="0" parameter-map="[addOptional:'false']"><depends-on field="rootWorkEffortId"/></dynamic-options></drop-down></header-field></field><field name="teamPartyId"><header-field title="Assigned To Team"><drop-down allow-empty="true"><dynamic-options transition="getProjectTeams" value-field="partyId" label-field="name"><depends-on field="rootWorkEffortId"/></dynamic-options></drop-down></header-field></field><field name="assigned"><default-field><section-iterate name="AssignedSection" list="weapdList" entry="weapd"><widgets><label text="${weapd.firstName?:''} ${weapd.lastName?:''} ${weapd.organizationName?:''}" type="div"/></widgets></section-iterate></default-field></field><field name="estimatedCompletionDate"><header-field title="Due Date" show-order-by="true"><date-period/></header-field><default-field><display format="yyyy-MM-dd"/></default-field></field><field name="lastUpdatedStamp"><header-field title="Last Updated"><date-period/></header-field><default-field><display/></default-field></field><field name="estimatedWorkTime" show-total="true" align="right"><header-field title="Est"><range-find/></header-field><default-field><display format="0.00"/></default-field></field><field name="remainingWorkTime" show-total="true" align="right"><header-field title="Rem"><range-find/></header-field><default-field><display format="0.00"/></default-field></field><field name="actualWorkTime" show-total="true" align="right"><header-field title="Actual"><range-find/></header-field><default-field><display format="0.00"/></default-field></field><field name="searchButton"><header-field title="Find Tasks"><submit/></header-field></field></form-list><label text="Full search used: ${queryString}" condition="queryString"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Task/TaskSummary/TaskCommentNested.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><parameter name="workEffortId"/><parameter name="currentCe"/><actions><filter-map-list list="childCeList" to-list="filteredCeList"><field-map field-name="parentCommEventId" from="currentCe.communicationEventId"/></filter-map-list></actions><widgets><container style="task-comment-child"><section-iterate name="CommentChildList" list="filteredCeList" entry="childCe"><actions><set field="uniqueExtension" from="uniqueExtension + '_' + childCe_index"/><entity-find-one entity-name="mantle.party.Person" value-field="fromPerson" cache="true"><field-map field-name="partyId" from="childCe.fromPartyId"/></entity-find-one><filter-map-list list="childCeList" to-list="childFilteredCeList"><field-map field-name="parentCommEventId" from="childCe.communicationEventId"/></filter-map-list></actions><widgets><label text="${childCe.subject}" type="strong"/><label text="from ${fromPerson ? fromPerson.firstName + ' ' + fromPerson?.lastName : 'Unknown'}" type="span"/><label text="at ${ec.l10n.format(childCe.entryDate, 'yyyy-MM-dd HH:mm')}" type="span"/><dynamic-dialog id="ReplyCommentContainer${uniqueExtension}" button-text="Reply" transition="TaskCommentReply"><parameter name="parentCommEventId" from="childCe.communicationEventId"/></dynamic-dialog><dynamic-dialog id="EditCommentContainer${uniqueExtension}" button-text="Edit" transition="TaskCommentUpdate"><parameter name="communicationEventId" from="childCe.communicationEventId"/></dynamic-dialog><label text="${childCe.body}" type="pre" encode="false"/><section name="ChildNestedComments"><condition><expression><![CDATA[childFilteredCeList]]></expression></condition><actions><set field="currentCe" from="childCe"/></actions><widgets><include-screen location="component://SimpleScreens/screen/SimpleScreens/Task/TaskSummary/TaskCommentNested.xml"/></widgets></section></widgets></section-iterate></container></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Task/TaskSummary/TaskCommentReply.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="workEffortId"/><parameter name="parentCommEventId"/><transition name="replyComment"><service-call name="mantle.party.CommunicationServices.reply#CommunicationEvent" in-map="true" out-map="context" multi="parameter"/><default-response url=".."/></transition><actions><entity-find-one entity-name="mantle.party.communication.CommunicationEvent" value-field="communicationEvent"><field-map field-name="communicationEventId" from="parentCommEventId"/></entity-find-one></actions><widgets><form-single name="ReplyCommentForm" transition="replyComment"><field name="workEffortId"><default-field><hidden/></default-field></field><field name="parentCommEventId"><default-field><hidden/></default-field></field><field name="subject"><default-field><text-line default-value="Re: ${communicationEvent.subject}"/></default-field></field><field name="body"><default-field title="Comment"><text-area rows="10"/></default-field></field><field name="submitButton"><default-field title="Reply"><submit/></default-field></field></form-single></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Task/TaskSummary/TaskCommentUpdate.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="workEffortId"/><parameter name="communicationEventId"/><transition name="updateComment"><service-call name="mantle.work.TaskServices.update#TaskComment" in-map="true" out-map="context" multi="parameter"/><default-response url=".."/></transition><actions><entity-find-one entity-name="mantle.party.communication.CommunicationEvent" value-field="communicationEvent"><field-map field-name="communicationEventId"/></entity-find-one></actions><widgets><form-single name="ReplyCommentForm" transition="updateComment"><field name="workEffortId"><default-field><hidden/></default-field></field><field name="communicationEventId"><default-field><hidden/></default-field></field><field name="subject"><default-field><text-line default-value="${communicationEvent.subject}"/></default-field></field><field name="body"><default-field title="Comment"><text-area rows="10" default-value="${communicationEvent.body}"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Task/TaskSummary.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Task Summary" default-menu-index="0"><parameter name="workEffortId" required="true"/><transition name="taskSummary"><default-response url="."/></transition><transition name="projectSummary"><default-response url="../../Project/ProjectSummary"/></transition><transition name="milestoneSummary"><default-response url="../../Project/MilestoneSummary"/></transition><transition name="editParty"><default-response url="../../Party/EditParty"/></transition><transition name="editRequest"><default-response url="../../Request/EditRequest"/></transition><transition name="updateTaskField"><actions><service-call name="update#mantle.work.effort.WorkEffort" in-map="context"/><script><![CDATA[ec.web.sendTextResponse(context.get(parameterName))]]></script></actions><default-response type="none"/></transition><transition name="updateTaskStatus"><actions><service-call name="update#mantle.work.effort.WorkEffort" in-map="context"/><entity-find-one entity-name="moqui.basic.StatusItem" value-field="newStatus"/><script><![CDATA[ec.web.sendTextResponse(newStatus.description)]]></script></actions><default-response type="none"/></transition><transition name="getTaskStatuses"><actions><entity-find-one entity-name="mantle.work.effort.WorkEffort" value-field="task"/><entity-find-one entity-name="mantle.work.effort.WorkEffort" value-field="project"><field-map field-name="workEffortId" from="task.rootWorkEffortId"/></entity-find-one><set field="statusFlowId" from="(task.statusFlowId ?: project?.statusFlowId) ?: 'Default'"/><entity-find-one entity-name="StatusItem" value-field="currentStatus"><field-map field-name="description" from="currentValue?.trim()"/><field-map field-name="statusTypeId" value="WorkEffort"/></entity-find-one><if condition="currentStatus == null"><entity-find entity-name="moqui.basic.LocalizedEntityField" list="currentStatusList"><econdition field-name="localized" from="currentValue?.trim()"/><econdition field-name="entityName" value="moqui.basic.StatusItem"/></entity-find><entity-find list="statusItemList" entity-name="moqui.basic.StatusItem"><econdition field-name="statusId" operator="in" from="currentStatusList.pkValue"/><econdition field-name="statusTypeId" value="WorkEffort"/></entity-find><if condition="statusItemList"><set field="currentStatus" from="statusItemList.first"/></if></if><entity-find entity-name="moqui.basic.StatusFlowTransitionToDetail" list="svctdList" cache="true"><econdition field-name="statusFlowId" from="statusFlowId"/><econdition field-name="statusId" from="currentStatus?.statusId"/></entity-find><set field="optionsMap" from="[:]"/><iterate list="svctdList" entry="svctd"><set field="optionsMap[svctd.toStatusId]" value="${svctd.transitionName} (${svctd.description})"/></iterate><script><![CDATA[ec.web.sendJsonResponse(optionsMap)]]></script></actions><default-response type="none"/></transition><transition name="updateTaskResolution"><actions><service-call name="update#mantle.work.effort.WorkEffort" in-map="context"/><entity-find-one entity-name="moqui.basic.Enumeration" value-field="newEnum"><field-map field-name="enumId" from="resolutionEnumId"/></entity-find-one><script><![CDATA[ec.web.sendTextResponse(newEnum.description)]]></script></actions><default-response type="none"/></transition><transition name="getTaskResolutions"><actions><entity-find entity-name="moqui.basic.Enumeration" list="enumList" cache="true"><econdition field-name="enumTypeId" value="WorkEffortResolution"/><order-by field-name="description"/></entity-find><set field="optionsMap" from="[:]"/><iterate list="enumList" entry="enumItem"><set field="optionsMap[enumItem.enumId]" value="${enumItem.description}"/></iterate><script><![CDATA[ec.web.sendJsonResponse(optionsMap)]]></script></actions><default-response type="none"/></transition><transition name="createTask"><service-call name="mantle.work.TaskServices.create#Task" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="getProjectParties"><service-call name="mantle.work.ProjectServices.get#ProjectParties" web-send-json-response="resultList" in-map="true" out-map="context" multi="parameter"/><default-response type="none"/></transition><transition name="getProjectMilestones"><service-call name="mantle.work.ProjectServices.get#ProjectMilestones" web-send-json-response="resultList" in-map="true" out-map="context" multi="parameter"/><default-response type="none"/></transition><transition-include name="getTaskList" location="component://SimpleScreens/template/work/WorkTransitions.xml"/><transition name="clockInTimeEntry"><service-call name="mantle.work.TimeServices.create#TimeEntryClockIn" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="addComment"><service-call name="mantle.work.TaskServices.add#TaskComment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteComment"><service-call name="mantle.work.TaskServices.delete#TaskComment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createContent"><service-call name="mantle.work.WorkEffortServices.create#WorkEffortContent" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateContent"><service-call name="mantle.work.WorkEffortServices.update#WorkEffortContent" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="downloadContent" read-only="true"><parameter name="workEffortContentId"/><actions><entity-find-one entity-name="mantle.work.effort.WorkEffortContent" value-field="workEffortContent"/><script><![CDATA[ec.web.sendResourceResponse(workEffortContent?.contentLocation)]]></script></actions><default-response type="none"/></transition><actions><entity-find-one entity-name="mantle.work.effort.WorkEffort" value-field="task"/><entity-find-related-one value-field="task" relationship-name="Root#mantle.work.effort.WorkEffort" to-value-field="project"/><entity-find-related-one value-field="task" relationship-name="Parent#mantle.work.effort.WorkEffort" to-value-field="parentTask"/><entity-find-related-one value-field="task" relationship-name="WorkEffortPurpose#moqui.basic.Enumeration" to-value-field="purposeEnum" cache="true"/><entity-find-related-one value-field="task" relationship-name="WorkEffortResolution#moqui.basic.Enumeration" to-value-field="resolutionEnum" cache="true"/><entity-find-related-one value-field="task" relationship-name="WorkEffort#moqui.basic.StatusItem" to-value-field="currentStatus" cache="true"/><entity-find entity-name="mantle.work.effort.WorkEffortAssoc" list="milestoneAssocList"><date-filter/><econdition field-name="toWorkEffortId" from="task?.workEffortId"/><econdition field-name="workEffortAssocTypeEnumId" value="WeatMilestone"/></entity-find><set field="milestoneAssoc" from="milestoneAssocList?.getAt(0)"/><entity-find-one entity-name="mantle.work.effort.WorkEffort" value-field="milestone"><field-map field-name="workEffortId" from="milestoneAssoc?.workEffortId"/></entity-find-one><entity-find entity-name="TimeEntry" list="timeEntryList"><econdition field-name="workEffortId"/><order-by field-name="fromDate"/><order-by field-name="lastUpdatedStamp"/></entity-find><entity-find entity-name="mantle.work.time.TimeEntry" list="openTimeEntryList"><econdition field-name="partyId" from="partyId ?: ec.user.userAccount?.partyId"/><econdition field-name="thruDate" operator="is-null"/><order-by field-name="-fromDate"/></entity-find><set field="openTimeEntry" from="openTimeEntryList ? openTimeEntryList[0] : null"/><entity-find entity-name="mantle.work.effort.WorkEffortCommEventDetail" list="commEventDetailList"><econdition field-name="workEffortId"/><order-by field-name="entryDate"/></entity-find><entity-find entity-name="moqui.entity.EntityAuditLog" list="statusHistoryList"><econdition field-name="changedEntityName" value="mantle.work.effort.WorkEffort"/><econdition field-name="changedFieldName" value="statusId"/><econdition field-name="pkPrimaryValue" from="workEffortId"/><order-by field-name="changedDate"/></entity-find><entity-find entity-name="mantle.work.effort.WorkEffortAndPartyDetail" list="weapdList"><date-filter/><econdition field-name="workEffortId"/><select-field field-name="partyId,firstName,lastName,organizationName,roleTypeId,statusId"/></entity-find><entity-find entity-name="mantle.work.effort.WorkEffortAndStatus" list="childTaskList"><econdition field-name="parentWorkEffortId" from="workEffortId"/><econdition field-name="workEffortTypeEnumId" value="WetTask"/><order-by field-name="statusSequenceNum,priority,workEffortName"/></entity-find><entity-find entity-name="mantle.work.effort.WorkEffortAssocAndTo" list="relatedToList"><econdition field-name="fromWorkEffortId" from="workEffortId"/><econdition field-name="workEffortTypeEnumId" value="WetTask"/></entity-find><entity-find entity-name="mantle.work.effort.WorkEffortAssocAndFrom" list="relatedFromList"><econdition field-name="toWorkEffortId" from="workEffortId"/><econdition field-name="workEffortTypeEnumId" value="WetTask"/></entity-find><entity-find entity-name="mantle.request.WorkEffortRequestDetail" list="werdList"><econdition field-name="workEffortId"/></entity-find><entity-find entity-name="mantle.work.effort.WikiPageAndWorkEffort" list="wpaweList"><econdition field-name="workEffortId"/></entity-find><entity-find entity-name="mantle.work.effort.WorkEffortContent" list="contentList"><econdition field-name="workEffortId"/><order-by field-name="-contentDate"/></entity-find></actions><widgets><container-row><row-col md="3"><container-box><box-header title="Task ${workEffortId}"/><box-toolbar><section name="ClockInSection" condition="openTimeEntry == null"><widgets><container-dialog id="ClockInDialog" button-text="Clock In" type="success" condition="openTimeEntry == null"><form-single name="ClockInForm" transition="clockInTimeEntry"><field name="workEffortId"><default-field><hidden/></default-field></field><field name="partyId" from="ec.user.userAccount.partyId"><default-field><hidden/></default-field></field><field name="comments"><default-field><text-area cols="100" rows="3"/></default-field></field><field name="fromDate"><default-field title="From" tooltip="Optional, defaults to now"><date-time minute-stepping="1"/></default-field></field><field name="submitButton"><default-field title="Clock In"><submit/></default-field></field></form-single></container-dialog></widgets><fail-widgets><link url="../EditTimeEntries" text="Clock Out" btn-type="success"/></fail-widgets></section></box-toolbar><box-body><container><label text="Project: " type="strong"/></container><link text="${project.workEffortId} - ${project.workEffortName}" url="projectSummary" link-type="anchor" condition="project != null"><parameter name="workEffortId" from="project.workEffortId"/><parameter name="rootWorkEffortId" from="project.workEffortId"/></link><section name="MilestoneSection" condition="milestone"><widgets><container><label text="Milestone: " type="strong"/></container><link text="${milestone.workEffortId} - ${milestone.workEffortName}" url="milestoneSummary" link-type="anchor"><parameter name="milestoneWorkEffortId" from="milestone.workEffortId"/></link></widgets></section><section name="ParentTaskSection" condition="parentTask"><widgets><container><label text="Parent Task: " type="strong"/></container><link text="${parentTask.workEffortId} - ${parentTask.workEffortName}" url="taskSummary" link-type="anchor"><parameter name="workEffortId" from="parentTask.workEffortId"/></link></widgets></section><container><label text="Priority: " type="strong"/><label text="${task.priority ?: ''}"/></container><container><label text="Purpose: " type="strong"/><label text="${purposeEnum.description}"/></container><container><label text="Status: " type="strong"/><editable id="TaskStatus" text="${currentStatus.description}" transition="updateTaskStatus" parameter-name="statusId" widget-type="select"><parameter name="workEffortId" from="task.workEffortId"/><editable-load transition="getTaskStatuses"/></editable></container><container><label text="Resolution: " type="strong"/><editable id="TaskResolution" text="${resolutionEnum?.description?:''}" transition="updateTaskResolution" parameter-name="resolutionEnumId" widget-type="select"><parameter name="workEffortId" from="task.workEffortId"/><editable-load transition="getTaskResolutions"/></editable></container><container><label text="Due Date: " type="strong"/><label text="${ec.l10n.format(task.estimatedCompletionDate, 'yyyy-MM-dd')}"/></container><container><label text="Estimated Hours: " type="strong"/><label text="${ec.l10n.format(task.estimatedWorkTime, '0.00')}"/></container><container><label text="Actual Hours: " type="strong"/><label text="${ec.l10n.format(task.actualWorkTime, '0.00')}"/></container><container><label text="Remaining Hours: " type="strong"/><label text="${ec.l10n.format(task.remainingWorkTime, '0.00')}"/></container><container><label text="Act/Est: " type="strong"/><label text="${ec.l10n.format((task.actualWorkTime / task.estimatedWorkTime) * 100, '0.00')}%" condition="task.estimatedWorkTime"/></container><container><label text="Act+Rem/Est: " type="strong"/><label text="${ec.l10n.format(((task.actualWorkTime + task.remainingWorkTime) / task.estimatedWorkTime) * 100, '0.00')}%" condition="task.estimatedWorkTime"/></container><container><label text="Last Updated: " type="strong"/><label text="${ec.l10n.format(task.lastUpdatedStamp, null)}"/></container></box-body></container-box><container-box><box-header title="Assignments"/><box-body><section-iterate name="TaskAssignList" list="weapdList" entry="weapd"><actions><entity-find-one entity-name="mantle.party.RoleType" value-field="roleType" cache="true"><field-map field-name="roleTypeId" from="weapd.roleTypeId"/></entity-find-one><entity-find-one entity-name="moqui.basic.StatusItem" value-field="statusItem" cache="true"><field-map field-name="statusId" from="weapd.statusId"/></entity-find-one></actions><widgets><container style="shaded-area"><container><link url="editParty" link-type="anchor" parameter-map="[partyId:weapd.partyId]" text="${weapd.firstName?:''} ${weapd.lastName?:''} ${weapd.organizationName?:''}"/></container><label text="${roleType?.description?:'N/A'} - ${statusItem?.description?:'N/A'}" type="div"/></container></widgets></section-iterate></box-body></container-box><container-box><box-header title="Time Entries"/><box-body><section-iterate name="TimeEntryList" list="timeEntryList" entry="timeEntry"><actions><entity-find-one entity-name="mantle.party.PersonAndUserAccount" value-field="paua"><field-map field-name="partyId" from="timeEntry.partyId"/></entity-find-one></actions><widgets><label text="• ${ec.l10n.format(timeEntry.hours, '0.00')}${timeEntry.hours != null ? 'h' : 'OPEN'} at ${ec.l10n.format(timeEntry.fromDate, '')} by ${paua.firstName} ${paua.lastName} ${paua.username ? '(' + paua.username + ')' :''}" type="div" style="${timeEntry.hours != null ? '' : 'text-strong'}"/></widgets></section-iterate></box-body></container-box></row-col><row-col md="6"><container><editable id="TaskName" text="${task.workEffortName?:''}" transition="updateTaskField" parameter-name="workEffortName" type="h4"/></container><editable id="TaskDescription" text="${task.description?:''}" transition="updateTaskField" type="pre" parameter-name="description"/><container-box><box-header title="Comments"/><box-toolbar><container-dialog id="AddCommentDialog" button-text="Add Comment"><form-single name="AddCommentForm" transition="addComment"><field name="workEffortId"><default-field><hidden/></default-field></field><field name="subject"><default-field><text-line/></default-field></field><field name="body"><default-field title="Comment"><text-area rows="10"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><section-iterate name="CommentList" list="commEventDetailList" entry="commEventDetail"><actions><set field="uniqueExtension" from="commEventDetail_index"/><entity-find-one entity-name="mantle.party.Person" value-field="fromPerson" cache="true"><field-map field-name="partyId" from="commEventDetail.fromPartyId"/></entity-find-one><entity-find entity-name="mantle.party.communication.CommunicationEvent" list="childCeList"><econdition field-name="rootCommEventId" from="commEventDetail.communicationEventId"/><order-by field-name="entryDate"/></entity-find></actions><widgets><container style="task-comment"><label text="${commEventDetail.subject}" type="strong"/><label text="from ${fromPerson ? fromPerson.firstName + ' ' + fromPerson?.lastName : 'Unknown'}" type="span"/><label text="at ${ec.l10n.format(commEventDetail.entryDate, 'yyyy-MM-dd HH:mm')}" type="span"/><dynamic-dialog id="ReplyCommentContainer${uniqueExtension}" button-text="Reply" transition="TaskCommentReply"><parameter name="parentCommEventId" from="commEventDetail.communicationEventId"/></dynamic-dialog><dynamic-dialog id="EditCommentContainer${uniqueExtension}" button-text="Edit" transition="TaskCommentUpdate"><parameter name="communicationEventId" from="commEventDetail.communicationEventId"/></dynamic-dialog><link text="Delete" url="deleteComment" parameter-map="[workEffortId:workEffortId,                                     communicationEventId:commEventDetail.communicationEventId]" confirmation="Delete comment ${commEventDetail.subject}?"/><label text="${commEventDetail.body}" type="pre" encode="false"/><section name="ChildNestedComments"><condition><expression><![CDATA[childCeList]]></expression></condition><actions><set field="currentCe" from="commEventDetail"/></actions><widgets><include-screen location="component://SimpleScreens/screen/SimpleScreens/Task/TaskSummary/TaskCommentNested.xml"/></widgets></section></container></widgets></section-iterate></box-body></container-box></row-col><row-col md="3"><container-box><box-header title="Status History"/><box-body><section-iterate name="StatusHistoryList" list="statusHistoryList" entry="statusHistory"><actions><entity-find-one entity-name="moqui.security.UserAccount" value-field="userAccount"><field-map field-name="userId" from="statusHistory?.changedByUserId"/></entity-find-one><entity-find-one entity-name="moqui.basic.StatusItem" value-field="oldStatusItem" cache="true"><field-map field-name="statusId" from="statusHistory?.oldValueText"/></entity-find-one><entity-find-one entity-name="moqui.basic.StatusItem" value-field="statusItem" cache="true"><field-map field-name="statusId" from="statusHistory?.newValueText"/></entity-find-one></actions><widgets><label text="${oldStatusItem ? oldStatusItem.description + ' to ' : ''}${statusItem?.description}${(userAccount?.username ? ' by ' + userAccount.username : '')} at ${ec.l10n.format(statusHistory.changedDate, 'yyyy-MM-dd HH:mm')}" type="div"/></widgets></section-iterate></box-body></container-box><container-box><box-header title="Child Tasks"/><box-toolbar><section name="NewChildTaskSection"><actions><set field="rootWorkEffortId" from="task.rootWorkEffortId"/><set field="milestoneWorkEffortId" from="milestone?.workEffortId"/><set field="parentWorkEffortId" from="workEffortId"/><entity-find entity-name="mantle.work.effort.WorkEffortAndParty" list="myProjectList"><econditions combine="or"><econdition field-name="visibilityEnumId" operator="in" value="WevGeneral,WevAllUsers"/><econditions><date-filter/><econdition field-name="partyId" from="ec.user.userAccount.partyId"/></econditions></econditions><econdition field-name="workEffortTypeEnumId" value="WetProject"/><order-by field-name="workEffortId"/></entity-find></actions><widgets><container-dialog id="NewChildTaskContainer" button-text="New Child Task"><form-single name="NewChildTaskForm" transition="createTask" extends="component://SimpleScreens/screen/SimpleScreens/Task/FindTask.xml#NewTaskForm"/></container-dialog></widgets></section></box-toolbar><box-body><section-iterate name="TaskChildList" list="childTaskList" entry="childTask"><actions><entity-find-one entity-name="moqui.basic.Enumeration" value-field="childPurpose" cache="true"><field-map field-name="enumId" from="childTask.purposeEnumId"/></entity-find-one><entity-find-one entity-name="moqui.basic.Enumeration" value-field="childResolution" cache="true"><field-map field-name="enumId" from="childTask.resolutionEnumId"/></entity-find-one></actions><widgets><container><link text="${childTask.workEffortId} - ${childTask.workEffortName}" url="taskSummary" link-type="anchor"><parameter name="workEffortId" from="childTask.workEffortId"/></link><label text="${childTask.statusDescription ?: ''} - ${childTask.priority ? 'P ' + childTask.priority + ' - ' : '' }${childResolution.description} - ${childPurpose.description}" type="div"/></container></widgets></section-iterate></box-body></container-box><container-box><box-header title="Related"/><box-body><section-iterate name="TaskRelatedToList" list="relatedToList" entry="relatedTo"><actions><entity-find-one entity-name="moqui.basic.Enumeration" value-field="assocType" cache="true"><field-map field-name="enumId" from="relatedTo.workEffortAssocTypeEnumId"/></entity-find-one></actions><widgets><container style="shaded-area"><label text="This ${assocType.description}" type="div"/><link text="${relatedTo.toWorkEffortId} - ${relatedTo.workEffortName}" url="taskSummary" link-type="anchor"><parameter name="workEffortId" from="relatedTo.toWorkEffortId"/></link></container></widgets></section-iterate><section-iterate name="TaskRelatedFromList" list="relatedFromList" entry="relatedFrom"><actions><entity-find-one entity-name="moqui.basic.Enumeration" value-field="assocType" cache="true"><field-map field-name="enumId" from="relatedFrom.workEffortAssocTypeEnumId"/></entity-find-one></actions><widgets><container style="shaded-area"><link text="${relatedFrom.fromWorkEffortId} - ${relatedFrom.workEffortName}" url="taskSummary" link-type="anchor"><parameter name="workEffortId" from="relatedFrom.fromWorkEffortId"/></link><label text="${assocType.description} This" type="div"/></container></widgets></section-iterate></box-body></container-box><container-box><box-header title="Requests"/><box-body><section-iterate name="TaskRequestList" list="werdList" entry="werd"><actions><entity-find-one entity-name="moqui.basic.Enumeration" value-field="requestType" cache="true"><field-map field-name="enumId" from="werd.requestTypeEnumId"/></entity-find-one><entity-find-one entity-name="moqui.basic.StatusItem" value-field="statusItem" cache="true"><field-map field-name="statusId" from="werd.statusId"/></entity-find-one></actions><widgets><container style=""><link text="${werd.requestId} - ${werd.requestName}" url="editRequest" link-type="anchor"><parameter name="requestId" from="werd.requestId"/></link><label text="${requestType.description} - ${statusItem.description}" type="div"/></container></widgets></section-iterate></box-body></container-box><container-box><box-header title="Wiki Pages"/><box-body><section-iterate name="TaskWikiPageList" list="wpaweList" entry="wpawe"><widgets><container><link text="${wpawe.wikiSpaceId}" url="/apps/${appRoot}/Wiki/wiki/${wpawe.wikiSpaceId}" link-type="anchor"/><link text="/${wpawe.pagePath}" url="/apps/${appRoot}/Wiki/wiki/${wpawe.wikiSpaceId}/${wpawe.pagePath?:''}" link-type="anchor"/></container></widgets></section-iterate></box-body></container-box><container-box><box-header title="Content"/><box-toolbar><container-dialog id="NewContentDialog" button-text="Add Content"><form-single name="NewContentForm" transition="createContent"><field name="workEffortId"><default-field><hidden/></default-field></field><field name="contentTypeEnumId"><default-field title="Content Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="WorkEffortContentType"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="contentFile"><default-field><file/></default-field></field><field name="description"><default-field><text-line size="60"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><section-iterate name="ContentIterateSection" list="contentList" entry="content"><actions><entity-find-one entity-name="mantle.party.PersonWithUserAccount" value-field="paua"><field-map field-name="userId" from="content.userId"/></entity-find-one><entity-find-one entity-name="moqui.basic.Enumeration" value-field="contentTypeEnum"><field-map field-name="enumId" from="content.contentTypeEnumId"/></entity-find-one></actions><widgets><container><container><label text="${contentTypeEnum?.description?:'No Type'}" type="strong"/></container><link url="downloadContent" condition="content.contentLocation" parameter-map="[workEffortContentId:content.workEffortContentId]" text="Download ${content.contentLocation.substring(content.contentLocation.lastIndexOf('/')+1)}"/><container-dialog id="UpdateContentContainer" button-text="Edit Content"><form-single name="UpdateContentForm" transition="updateContent" map="content"><field name="workEffortContentId"><default-field><hidden/></default-field></field><field name="workEffortId"><default-field><hidden/></default-field></field><field name="contentTypeEnumId"><default-field title="Content Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="WorkEffortContentType"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="contentFile"><default-field><file/></default-field></field><field name="description"><default-field><text-line size="60"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></container-dialog><container><label condition="paua" text="By ${ec.resource.expand('UsernameTemplate','',paua+[userId:content.userId])} at ${ec.l10n.format(content.contentDate, 'yyyy-MM-dd HH:mm')}"/></container><label text="${content.description ?: 'No Description'}" type="p"/></container></widgets></section-iterate></box-body></container-box></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Task/EditTask.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Task" default-menu-index="1"><parameter name="workEffortId" required="true"/><transition name="updateTask"><service-call name="mantle.work.TaskServices.update#Task" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="projectSummary"><default-response url="../../Project/ProjectSummary"/></transition><transition name="milestoneSummary"><default-response url="../../Project/MilestoneSummary"/></transition><transition name="taskSummary"><default-response url="../TaskSummary"/></transition><transition-include name="getUserProjectList" location="component://SimpleScreens/template/work/WorkTransitions.xml"/><transition-include name="getProjectMilestones" location="component://SimpleScreens/template/work/WorkTransitions.xml"/><transition-include name="getTaskList" location="component://SimpleScreens/template/work/WorkTransitions.xml"/><actions><entity-find-one entity-name="mantle.work.effort.WorkEffort" value-field="task"/><entity-find-one entity-name="mantle.work.effort.WorkEffort" value-field="project"><field-map field-name="workEffortId" from="task.rootWorkEffortId"/></entity-find-one><entity-find entity-name="mantle.work.effort.WorkEffortAssoc" list="milestoneAssocList"><date-filter/><econdition field-name="toWorkEffortId" from="task.workEffortId"/><econdition field-name="workEffortAssocTypeEnumId" value="WeatMilestone"/></entity-find><set field="milestoneAssoc" from="milestoneAssocList?.getAt(0)"/><set field="statusFlowId" from="(task.statusFlowId ?: project?.statusFlowId) ?: 'Default'"/></actions><widgets><form-single name="EditTask" transition="updateTask" map="task"><field name="workEffortId"><default-field title="Task ID"><display/></default-field></field><field name="rootWorkEffortId"><default-field title="Project"><drop-down allow-empty="true"><dynamic-options transition="getUserProjectList" server-search="true" min-length="0"/></drop-down><link text="Edit ${project.workEffortId}" url="projectSummary" link-type="anchor" condition="project"><parameter name="workEffortId" from="project.workEffortId"/></link></default-field></field><field name="milestoneWorkEffortId" from="milestoneAssoc?.workEffortId"><default-field title="Milestone"><drop-down allow-empty="true"><dynamic-options transition="getProjectMilestones" value-field="workEffortId" label-field="milestoneLabel"><depends-on field="rootWorkEffortId"/></dynamic-options></drop-down><link text="Edit ${milestoneAssoc.workEffortId}" url="milestoneSummary" link-type="anchor" condition="milestoneAssoc"><parameter name="milestoneWorkEffortId" from="milestoneAssoc?.workEffortId"/></link></default-field></field><field name="parentWorkEffortId"><default-field title="Parent Task"><drop-down allow-empty="true"><dynamic-options transition="getTaskList" min-length="2" server-search="true" depends-optional="true"><depends-on field="rootWorkEffortId"/></dynamic-options></drop-down><link text="Edit ${parentWorkEffortId}" url="taskSummary" link-type="anchor" condition="parentWorkEffortId"><parameter name="workEffortId" from="parentWorkEffortId"/></link></default-field></field><field name="workEffortName"><default-field title="Task Name"><text-line size="60"/></default-field></field><field name="priority"><default-field><drop-down no-current-selected-key="5"><option key="1"/><option key="2"/><option key="3"/><option key="4"/><option key="5"/><option key="6"/><option key="7"/><option key="8"/><option key="9"/></drop-down></default-field></field><field name="purposeEnumId"><default-field title="Purpose"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="WorkEffortPurpose"/><set field="parentEnumId" value="WetTask"/></widget-template-include></default-field></field><field name="statusId"><default-field title="Status"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusTransitionWithFlowDropDown"><set field="currentDescription" from="task?.'WorkEffort#moqui.basic.StatusItem'?.description"/><set field="statusId" from="task.statusId"/></widget-template-include></default-field></field><field name="resolutionEnumId"><default-field title="Resolution"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="WorkEffortResolution"/></widget-template-include></default-field></field><field name="estimatedCompletionDate"><default-field title="Due Date"><date-time type="date" format="yyyy-MM-dd"/></default-field></field><field name="estimatedWorkTime"><default-field title="Estimated Hours"><text-line size="5"/></default-field></field><field name="remainingWorkTime"><default-field title="Remaining Hours"><text-line size="5"/></default-field></field><field name="actualWorkTime"><default-field title="Actual Hours"><display format="0.00"/></default-field></field><field name="totalTimeAllowed"><conditional-field title="Hours Budget" condition="!task.parentWorkEffortId"><text-line size="5"/></conditional-field><default-field><ignored/></default-field></field><field name="description"><default-field title="Description"><text-area rows="20" cols="100"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field-layout><fields-not-referenced/><field-row><field-ref name="purposeEnumId"/><field-ref name="priority"/></field-row><field-row><field-ref name="statusId"/><field-ref name="estimatedCompletionDate"/></field-row><field-ref name="resolutionEnumId"/><field-row><field-ref name="estimatedWorkTime"/><field-ref name="remainingWorkTime"/></field-row><field-row><field-ref name="actualWorkTime"/><field-ref name="totalTimeAllowed"/></field-row><field-ref name="description"/><field-ref name="submitButton"/></field-layout></form-single></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Task/EditTimeEntries.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Time" default-menu-index="1"><parameter name="workEffortId" required="true"/><transition name="editUser"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition name="addTaskTime"><service-call name="mantle.work.TaskServices.add#TaskTime" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteTimeEntry"><service-call name="mantle.work.TimeServices.delete#TimeEntry" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="clockInTimeEntry"><service-call name="mantle.work.TimeServices.create#TimeEntryClockIn" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><subscreens><subscreens-item name="EditTimeEntry" location="component://SimpleScreens/screen/SimpleScreens/Party/PartyTimeEntries/EditTimeEntry.xml"/></subscreens><actions><entity-find-one entity-name="mantle.work.effort.WorkEffort" value-field="workEffort"/><entity-find entity-name="mantle.work.time.TimeEntry" list="timeEntryList"><econdition field-name="workEffortId"/><order-by field-name="fromDate"/><order-by field-name="lastUpdatedStamp"/></entity-find><entity-find entity-name="mantle.work.time.TimeEntry" list="openTimeEntryList"><econdition field-name="partyId" from="partyId ?: ec.user.userAccount?.partyId"/><econdition field-name="thruDate" operator="is-null"/><order-by field-name="-fromDate"/></entity-find><set field="openTimeEntry" from="openTimeEntryList ? openTimeEntryList[0] : null"/><service-call name="mantle.humanres.PositionServices.get#PartyEmployersAndPositionClasses" in-map="[partyId:partyId ?: ec.user.userAccount?.partyId]" out-map="context"/></actions><widgets><container-dialog id="ClockInDialog" button-text="Clock In" type="success" condition="openTimeEntry == null"><form-single name="ClockInForm" transition="clockInTimeEntry"><field name="workEffortId"><default-field><hidden/></default-field></field><field name="partyId" from="ec.user.userAccount.partyId"><default-field><hidden/></default-field></field><field name="rateTypeEnumId"><default-field title="Rate Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumGroupDropDown"><set field="enumGroupEnumId" value="EngRateCommonEntry"/><set field="noCurrentSelectedKey" value="RatpStandard"/></widget-template-include></default-field></field><field name="comments"><default-field><text-area cols="100" rows="3"/></default-field></field><field name="fromDate"><default-field title="From" tooltip="Optional, defaults to now"><date-time minute-stepping="1"/></default-field></field><field name="submitButton"><default-field title="Clock In"><submit/></default-field></field></form-single></container-dialog><form-single name="AddTaskTime" transition="addTaskTime" map="openTimeEntry"><field name="timeEntryId"><default-field><hidden/></default-field></field><field name="workEffortId"><conditional-field title="Task" condition="openTimeEntry != null && openTimeEntry.workEffortId != workEffort.workEffortId" container-style="text-strong text-warning"><radio><option key="${workEffort.workEffortId}" text="Current Task: ${workEffort.workEffortId}"/><option key="${openTimeEntry.workEffortId}" text="Open Time Entry Task: ${openTimeEntry.workEffortId}"/></radio></conditional-field><default-field><hidden/></default-field></field><field name="partyId"><default-field title="Worker"><drop-down no-current-selected-key="${ec.user.userAccount.partyId}" current="selected"><entity-options key="${partyId}" text="${firstName ? firstName + ' ' + lastName : (organizationName ?: pseudoId)} (${partyId})"><entity-find entity-name="WorkEffortAndPartyDetail"><date-filter/><econdition field-name="workEffortId"/><select-field field-name="firstName, lastName, organizationName, pseudoId, partyId"/></entity-find></entity-options></drop-down></default-field></field><field name="rateTypeEnumId"><default-field title="Rate Type"><drop-down no-current-selected-key="RatpStandard"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="RateType"/></entity-find></entity-options></drop-down></default-field></field><field name="workTypeEnumId"><default-field title="Work Type"><drop-down allow-empty="true"><list-options list="workTypeEnumerationList" key="${enumId}" text="${description}"/></drop-down></default-field></field><field name="emplPositionClassId"><default-field title="Position Class"><drop-down allow-empty="true"><list-options list="emplPositionClassList" key="${emplPositionClassId}" text="${title}"/></drop-down></default-field></field><field name="comments"><default-field><text-area cols="60" rows="3"/></default-field></field><field name="remainingWorkTime"><default-field title="Remaining Hours"><text-line size="5"/></default-field></field><field name="curRemainingWorkTime" from="workEffort.remainingWorkTime"><default-field title="Current Rem Hours"><display/></default-field></field><field name="pieceCount"><default-field><text-line size="6"/></default-field></field><field name="breakHours"><default-field><text-line size="5" default-value="0"/></default-field></field><field name="instructions"><conditional-field title="" condition="fromDate != null && thruDate == null"><display text="To clock out now leave Hours and Thru empty; specify Hours or Thru if your clock out time is in the past"/></conditional-field><default-field title=""><display text="Enter values for 2 of the 3 below, or just Hours or From and Thru will be set to now"/></default-field></field><field name="hours"><default-field><text-line size="5"/></default-field></field><field name="fromDate"><default-field title="From"><date-time minute-stepping="1"/></default-field></field><field name="thruDate"><default-field title="Thru"><date-time minute-stepping="1"/></default-field></field><field name="submitButton"><default-field title="Add Time"><submit text="${timeEntryId ? 'Clock Out' : 'Add Time'}"/></default-field></field><field-layout><field-ref name="workEffortId"/><field-row><field-ref name="partyId"/><field-ref name="rateTypeEnumId"/></field-row><field-row><field-ref name="workTypeEnumId"/><field-ref name="emplPositionClassId"/></field-row><field-ref name="comments"/><field-row><field-ref name="curRemainingWorkTime"/><field-ref name="breakHours"/></field-row><field-row><field-ref name="remainingWorkTime"/><field-ref name="pieceCount"/></field-row><field-ref name="instructions"/><field-ref name="hours"/><field-row><field-ref name="fromDate"/><field-ref name="thruDate"/></field-row><field-ref name="submitButton"/></field-layout></form-single><form-list name="TimeEntryList" list="timeEntryList" skip-form="true"><row-actions/><field name="partyId"><default-field title="User"><link url="editUser" entity-name="mantle.party.PartyDetail" text="PartyNameTemplate" link-type="anchor"/></default-field></field><field name="comments"><default-field><display also-hidden="false"/></default-field></field><field name="hours"><default-field><display format="0.00" also-hidden="false"/></default-field></field><field name="breakHours"><default-field title="Break"><display format="0.00" also-hidden="false"/></default-field></field><field name="timeRange"><default-field><display text="${ec.l10n.format(fromDate, '')} - ${ec.l10n.format(thruDate, '')}" also-hidden="false"/></default-field></field><field name="rateTypeEnumId"><default-field title="Rate Type"><display-entity entity-name="moqui.basic.Enumeration" key-field-name="enumId"/></default-field></field><field name="editButton" align="right"><default-field title=""><dynamic-dialog id="EditTimeEntryDialog" button-text="Edit" icon="fa fa-pencil" transition="EditTimeEntry" parameter-map="[partyId:partyId, timeEntryId:timeEntryId]"/></default-field></field><field name="deleteButton"><default-field title=""><link url="deleteTimeEntry" icon="fa fa-trash" confirmation="Are you sure?"/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Task/EditUsers.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Assignments" default-menu-index="3"><parameter name="workEffortId" required="true"/><transition name="editParty"><default-response url="//${appRoot}/Party/EditParty"/></transition><transition name="addAssignment"><service-call name="create#mantle.work.effort.WorkEffortParty" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateAssignment"><service-call name="update#mantle.work.effort.WorkEffortParty" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="getProjectParties"><service-call name="mantle.work.ProjectServices.get#ProjectParties" web-send-json-response="resultList" in-map="true" out-map="context" multi="parameter"/><default-response type="none"/></transition><actions><entity-find-one entity-name="mantle.work.effort.WorkEffort" value-field="task"/></actions><widgets><container><container-dialog id="AddUserAssignDialog" button-text="Add Person"><form-single name="AddUserAssignForm" transition="addAssignment"><field name="workEffortId"><default-field><hidden/></default-field></field><field name="partyId"><default-field title="Person"><drop-down><dynamic-options transition="getProjectParties" value-field="partyId" label-field="name" depends-optional="true" server-search="true" min-length="0" parameter-map="[addOptional:'false', rootWorkEffortId:task?.rootWorkEffortId, workEffortId:null]"><depends-on field="rootWorkEffortId"/></dynamic-options></drop-down></default-field></field><field name="roleTypeId"><default-field title="Role"><drop-down no-current-selected-key="Assignee"><entity-options key="${roleTypeId}" text="${description}"><entity-find entity-name="mantle.party.RoleGroupMemberAndType" cache="true"><econdition field-name="roleGroupEnumId" value="RgpTask"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="fromDate" from="ec.user.nowTimestamp"><default-field><date-time/></default-field></field><field name="thruDate"><default-field><date-time/></default-field></field><field name="expectationEnumId"><default-field title="Expectation"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="WorkEffortPartyExpectation"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="emplPositionClassId"><default-field title="Position Class"><drop-down allow-empty="true"><entity-options key="${emplPositionClassId}" text="${title}"><entity-find entity-name="EmplPositionClass"/></entity-options></drop-down></default-field></field><field name="statusId"><default-field title="Status"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="WorkEffortParty"/><set field="noCurrentSelectedKey" value="WeptAssigned"/></widget-template-include></default-field></field><field name="receiveNotifications"><default-field><drop-down no-current-selected-key="N"><option key="Y"/><option key="N"/></drop-down></default-field></field><field name="submitButton"><default-field title="Add Assignment"><submit/></default-field></field></form-single></container-dialog><container-dialog id="AddTeamAssignDialog" button-text="Add Team"><form-single name="AddTeamAssignForm" transition="addAssignment"><field name="workEffortId"><default-field><hidden/></default-field></field><field name="partyId"><default-field title="Team"><drop-down><entity-options key="${partyId}" text="${organizationName}"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" value="OrgTeam"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/></entity-find></entity-options></drop-down></default-field></field><field name="roleTypeId"><default-field><hidden default-value="OrgTeam"/></default-field></field><field name="fromDate" from="ec.user.nowTimestamp"><default-field><date-time/></default-field></field><field name="thruDate"><default-field><date-time/></default-field></field><field name="statusId"><default-field title="Status"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="WorkEffortParty"/></widget-template-include></default-field></field><field name="submitButton"><default-field title="Add Assignment"><submit/></default-field></field></form-single></container-dialog></container><form-list name="UpdateAssignForm" list="weapdList" transition="updateAssignment"><entity-find entity-name="mantle.work.effort.WorkEffortAndPartyDetail" list="weapdList"><search-form-inputs default-order-by="firstName,lastName,organizationName"/><econdition field-name="workEffortId"/></entity-find><row-actions><entity-find-one entity-name="moqui.basic.StatusItem" value-field="currentStatus"/><entity-find entity-name="moqui.security.UserAccount" list="uaList"><econdition field-name="partyId"/></entity-find><set field="usernames" from="uaList*.username.join(', ')"/></row-actions><field name="workEffortId"><default-field><hidden/></default-field></field><field name="partyId"><default-field><hidden/></default-field></field><field name="pseudoId"><header-field title="ID" show-order-by="case-insensitive"/><default-field><link url="editParty" text="${pseudoId}" link-type="anchor"/></default-field></field><field name="usernames"><default-field><link url="editParty" text="${usernames}" link-type="anchor" condition="usernames"/></default-field></field><field name="firstName"><header-field title="First##Name" show-order-by="case-insensitive"/><default-field><display also-hidden="false"/></default-field></field><field name="lastName"><header-field title="Last##Name" show-order-by="case-insensitive"/><default-field><display also-hidden="false"/></default-field></field><field name="organizationName"><header-field title="Organization" show-order-by="case-insensitive"/><default-field><display also-hidden="false"/></default-field></field><field name="roleTypeId"><header-field title="Role" show-order-by="true"/><default-field><display-entity entity-name="mantle.party.RoleType"/></default-field></field><field name="fromDate"><header-field show-order-by="true"/><default-field><display/></default-field></field><field name="thruDate"><header-field show-order-by="true"/><default-field><date-time/></default-field></field><field name="expectationEnumId"><header-field title="Expectation" show-order-by="true"/><conditional-field condition="partyTypeEnumId=='PtyPerson'"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="WorkEffortPartyExpectation"/><set field="allowEmpty" value="true"/></widget-template-include></conditional-field><default-field><ignored/></default-field></field><field name="emplPositionClassId"><header-field title="Position Class" show-order-by="true"/><conditional-field condition="partyTypeEnumId=='PtyPerson'"><drop-down allow-empty="true"><entity-options key="${emplPositionClassId}" text="${title}"><entity-find entity-name="EmplPositionClass"/></entity-options></drop-down></conditional-field><default-field><ignored/></default-field></field><field name="statusId"><header-field title="Status" show-order-by="true"/><default-field><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusTransitionDropDown"><set field="currentDescription" from="currentStatus?.description"/><set field="statusId"/></widget-template-include></default-field></field><field name="receiveNotifications"><default-field title="Notifications"><drop-down no-current-selected-key="N"><option key="Y"/><option key="N"/></drop-down></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><form-list-column><field-ref name="pseudoId"/><field-ref name="usernames"/><field-ref name="roleTypeId"/></form-list-column><form-list-column><field-ref name="firstName"/><field-ref name="lastName"/><field-ref name="organizationName"/></form-list-column><form-list-column><field-ref name="fromDate"/><field-ref name="thruDate"/></form-list-column><form-list-column><field-ref name="expectationEnumId"/><field-ref name="emplPositionClassId"/></form-list-column><form-list-column><field-ref name="statusId"/></form-list-column><form-list-column><field-ref name="receiveNotifications"/><field-ref name="submitButton"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Task/EditRelated.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Related" default-menu-index="4"><parameter name="workEffortId" required="true"/><transition name="addRelated"><service-call name="create#mantle.work.effort.WorkEffortAssoc" in-map="context + [workEffortId:fromWorkEffortId]" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteRelated"><service-call name="delete#mantle.work.effort.WorkEffortAssoc" in-map="context + [workEffortId:fromWorkEffortId]" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="taskSummary"><default-response url="../TaskSummary"/></transition><transition name="getProjectTasks"><actions><service-call name="mantle.work.ProjectServices.get#ProjectTasks" in-map="context" out-map="context"/><script><![CDATA[ec.web.sendJsonResponse(resultList)]]></script></actions><default-response type="none"/></transition><actions><set field="mainWorkEffortId" from="workEffortId"/><entity-find-one entity-name="mantle.work.effort.WorkEffort" value-field="task"/><entity-find entity-name="mantle.work.effort.WorkEffortAssocAndTo" list="relatedToList"><econdition field-name="fromWorkEffortId" from="workEffortId"/><econdition field-name="workEffortTypeEnumId" value="WetTask"/></entity-find><entity-find entity-name="mantle.work.effort.WorkEffortAssocAndFrom" list="relatedFromList"><econdition field-name="toWorkEffortId" from="workEffortId"/><econdition field-name="workEffortTypeEnumId" value="WetTask"/></entity-find></actions><widgets><container><container-dialog id="AddRelatedToDialog" button-text="Add Related To"><form-single name="AddRelatedToForm" transition="addRelated"><field name="workEffortId"><default-field><hidden/></default-field></field><field name="fromWorkEffortId" from="workEffortId"><default-field><hidden/></default-field></field><field name="workEffortAssocTypeEnumId"><default-field title="Type"><drop-down><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econditions combine="or"><econdition field-name="enumId" value="WeatRelatesTo"/><econdition field-name="parentEnumId" value="WeatRelatesTo"/></econditions><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="rootWorkEffortId"><default-field title="Project"><drop-down><entity-options key="${workEffortId}" text="${workEffortId}: ${workEffortName}"><entity-find entity-name="WorkEffortAndParty"><econditions combine="or"><econdition field-name="visibilityEnumId" operator="in" value="WevGeneral,WevAllUsers"/><econditions><date-filter/><econdition field-name="partyId" from="ec.user.userAccount.partyId"/></econditions></econditions><econdition field-name="workEffortTypeEnumId" value="WetProject"/><order-by field-name="workEffortId"/></entity-find></entity-options></drop-down></default-field></field><field name="toWorkEffortId"><default-field title="To Task"><drop-down><dynamic-options transition="getProjectTasks" value-field="workEffortId" label-field="taskLabel"><depends-on field="rootWorkEffortId"/></dynamic-options></drop-down></default-field></field><field name="submitButton"><default-field title="Add Related"><submit/></default-field></field></form-single></container-dialog><container-dialog id="AddRelatedFromDialog" button-text="Add Related From"><form-single name="AddRelatedFromForm" transition="addRelated"><field name="workEffortId"><default-field><hidden/></default-field></field><field name="toWorkEffortId" from="workEffortId"><default-field><hidden/></default-field></field><field name="rootWorkEffortId"><default-field title="Project"><drop-down><entity-options key="${workEffortId}" text="${workEffortId}: ${workEffortName}"><entity-find entity-name="WorkEffortAndParty"><econditions combine="or"><econdition field-name="visibilityEnumId" operator="in" value="WevGeneral,WevAllUsers"/><econditions><date-filter/><econdition field-name="partyId" from="ec.user.userAccount.partyId"/></econditions></econditions><econdition field-name="workEffortTypeEnumId" value="WetProject"/><order-by field-name="workEffortId"/></entity-find></entity-options></drop-down></default-field></field><field name="fromWorkEffortId"><default-field title="From Task"><drop-down><dynamic-options transition="getProjectTasks" value-field="workEffortId" label-field="taskLabel"><depends-on field="rootWorkEffortId"/></dynamic-options></drop-down></default-field></field><field name="workEffortAssocTypeEnumId"><default-field title="Type"><drop-down><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econditions combine="or"><econdition field-name="enumId" value="WeatRelatesTo"/><econdition field-name="parentEnumId" value="WeatRelatesTo"/></econditions><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Add Related"><submit/></default-field></field></form-single></container-dialog></container><label text="Related From ${workEffortId} - ${task.workEffortName}" type="h2"/><form-list name="DeleteRelatedToForm" list="relatedToList" transition="deleteRelated"><field name="workEffortId" from="mainWorkEffortId"><default-field><hidden/></default-field></field><field name="fromWorkEffortId"><default-field><hidden/></default-field></field><field name="workEffortAssocTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="toWorkEffortId"><default-field title="To ID"><display text=""/><link text="${toWorkEffortId}" url="taskSummary" link-type="anchor"><parameter name="workEffortId" from="toWorkEffortId"/></link></default-field></field><field name="workEffortName"><default-field title="To Name"><display/></default-field></field><field name="fromDate"><default-field title="At"><display/></default-field></field><field name="submitButton"><default-field title="Delete"><submit/></default-field></field></form-list><label text="Related To ${workEffortId} - ${task.workEffortName}" type="h2"/><form-list name="DeleteRelatedFromForm" list="relatedFromList" transition="deleteRelated"><field name="workEffortId" from="mainWorkEffortId"><default-field><hidden/></default-field></field><field name="toWorkEffortId"><default-field><hidden/></default-field></field><field name="fromWorkEffortId"><default-field title="From ID"><display text=""/><link text="${fromWorkEffortId}" url="taskSummary" link-type="anchor"><parameter name="workEffortId" from="fromWorkEffortId"/></link></default-field></field><field name="workEffortName"><default-field title="From Name"><display/></default-field></field><field name="workEffortAssocTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="fromDate"><default-field title="At"><display/></default-field></field><field name="submitButton"><default-field title="Delete"><submit/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Task/EditRequests.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Requests" default-menu-index="5"><parameter name="workEffortId" required="true"/><transition name="editRequest"><default-response url="../../Request/EditRequest"/></transition><transition name="addRwe"><service-call name="create#mantle.request.RequestWorkEffort" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteRwe"><service-call name="delete#mantle.request.RequestWorkEffort" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getRequestList" location="component://SimpleScreens/template/request/RequestTransitions.xml"/><actions><entity-find entity-name="mantle.request.WorkEffortRequestDetail" list="werdList"><econdition field-name="workEffortId"/></entity-find></actions><widgets><container-dialog id="AddRweDialog" button-text="Add Request"><form-single name="AddRweForm" transition="addRwe"><field name="workEffortId"><default-field><hidden/></default-field></field><field name="requestId"><default-field title="Request"><drop-down><dynamic-options transition="getRequestList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="submitButton"><default-field title="Add Request"><submit/></default-field></field></form-single></container-dialog><form-list name="DeleteRweForm" list="werdList" skip-form="true"><field name="workEffortId"><default-field><hidden/></default-field></field><field name="requestId"><default-field title="ID"><display text=""/><link text="${requestId}" url="editRequest" link-type="anchor"/></default-field></field><field name="requestName"><default-field title="Name"><display/></default-field></field><field name="requestTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration" also-hidden="false"/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem" also-hidden="false"/></default-field></field><field name="links"><default-field title=" "><link url="deleteRwe" text="" icon="fa fa-trash" confirmation="Remove request association from task?"/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Task/EditWikiPages.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Wiki Pages" default-menu-index="6"><parameter name="workEffortId" required="true"/><transition name="addWpwe"><service-call name="create#mantle.work.effort.WikiPageWorkEffort" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteWpwe"><service-call name="delete#mantle.work.effort.WikiPageWorkEffort" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="getSpacePages"><actions><service-call name="org.moqui.impl.WikiServices.get#UserSpaceWikiPageSimpleList" in-map="context" out-map="context"/><script><![CDATA[ec.web.sendJsonResponse(resultList)]]></script></actions><default-response type="none"/></transition><actions><entity-find entity-name="mantle.work.effort.WikiPageAndWorkEffort" list="wpaweList"><econdition field-name="workEffortId"/></entity-find><service-call name="org.moqui.impl.WikiServices.get#UserWikiSpaces" in-map="[userId:ec.user.userId]" out-map="context"/></actions><widgets><container-dialog id="AddWpweDialog" button-text="Add Wiki Page"><form-single name="AddWpweForm" transition="addWpwe"><field name="userId" from="ec.user.userId"><default-field><hidden/></default-field></field><field name="workEffortId"><default-field><hidden/></default-field></field><field name="wikiSpaceId"><default-field title="Space"><drop-down><list-options list="wikiSpaceAndUserList" key="${wikiSpaceId}" text="${wikiSpaceId}: ${description}"/></drop-down></default-field></field><field name="wikiPageId"><default-field title="Page"><drop-down combo-box="true"><dynamic-options transition="getSpacePages" value-field="wikiPageId" label-field="pageLabel"><depends-on field="userId"/><depends-on field="wikiSpaceId"/></dynamic-options></drop-down></default-field></field><field name="submitButton"><default-field title="Add Page"><submit/></default-field></field></form-single></container-dialog><form-list name="DeleteWpweForm" list="wpaweList" transition="deleteWpwe"><field name="workEffortId"><default-field><hidden/></default-field></field><field name="wikiPageId"><default-field><hidden/></default-field></field><field name="wikiSpaceId"><default-field title="Space"><display text=""/><link text="${wikiSpaceId}" url="//${appRoot}/Wiki/wiki/${wikiSpaceId}" link-type="anchor"/></default-field></field><field name="pagePath"><default-field title="Page"><display text=""/><link text="${pagePath}" url="//${appRoot}/Wiki/wiki/${wikiSpaceId}/${pagePath?:''}" link-type="anchor"/></default-field></field><field name="submitButton"><default-field title="Delete"><submit/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Task.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Tasks" default-menu-index="4" menu-image="/ssstatic/images/task-homework.png"><subscreens default-item="FindTask"/><actions><if condition="workEffortId"><entity-find-one entity-name="mantle.work.effort.WorkEffort" value-field="task"/><if condition="task == null"><return error="true" message="Task not found for ID ${workEffortId}"/></if></if></actions><widgets><label text="Task ${task.workEffortId} - ${task.workEffortName}" type="strong" condition="task != null"/><subscreens-panel id="task-panel" type="tab"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Wiki/EditWikiPage.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" allow-extra-path="true" default-menu-include="false"><parameter name="wikiSpaceId"/><transition name="updatePage"><service-call name="org.moqui.impl.WikiServices.update#WikiPage" in-map="true" out-map="context" multi="parameter"/><default-response url="../wiki/${wikiSpaceId}/${encodedPagePath}" parameter-map="[wikiSpaceId:null,pagePath:null,wikiPageId:null]"/><error-response url="." parameter-map="[pagePath:pagePath, parentPath:parentPath, pageName:pageName, wikiType:wikiType, isCreate:isCreate]"/></transition><transition-include name="getSpacePages" location="component://SimpleScreens/screen/SimpleScreens/Wiki/wiki.xml"/><actions><set field="extraPathNameList" from="sri.screenUrlInfo.extraPathNameList"/><if condition="!isCreate || isCreate == 'false'"><service-call name="org.moqui.impl.WikiServices.get#WikiPageInfo" in-map="context" out-map="context"/><set field="pageText" from="pageReference?.exists ? ec.resource.getLocationText(pageLocation, false) : ''"/></if><set field="currentPagePath" from="pagePath"/><set field="isRootPage" from="pageReference?.exists && !pagePath"/><set field="wikiType" from="wikiType ?: 'md'"/></actions><widgets><container><label text="${isCreate ? 'Create Page' : 'Edit Page: ' + pageName}" type="h3"/></container><form-single name="EditPageForm" transition="updatePage"><field name="isCreate"><default-field><hidden default-value="false"/></default-field></field><field name="wikiSpaceId"><default-field><hidden/></default-field></field><field name="pagePath"><default-field><hidden/></default-field></field><field name="parentPath"><conditional-field condition="!isRootPage"><drop-down><dynamic-options transition="getSpacePages" server-search="true" min-length="0" parameter-map="[wikiSpaceId:wikiSpaceId, wikiPageId:null, pagePath:null, currentPagePath:pagePath, valueUsePath:'true', includeRoot:'true']"/></drop-down></conditional-field></field><field name="pageName"><conditional-field condition="isRootPage"><hidden/></conditional-field><default-field tooltip="letters, digits, [.,'-_:()!? ] only"><text-line size="60"/></default-field></field><field name="wikiType"><default-field><display/></default-field></field><field name="sequenceNum" from="wikiPage?.sequenceNum ?: 50"><default-field><text-line size="8"/></default-field></field><field name="pageText"><default-field title=""><text-area cols="120" rows="35" editor-type="${wikiType}" editor-theme="${wikiSpace?.screenThemeId}"/></default-field></field><field name="submitButton"><conditional-field condition="isCreate" title="Create Page"><submit/></conditional-field><default-field title="Update Page"><submit/></default-field></field><field name="cancelButton"><default-field title=""><link text="Cancel" url="../wiki/${wikiSpaceId}/${pagePath?:parentPath?:''}" link-type="anchor-button" url-noparam="true"/></default-field></field><field-layout><field-row-big><field-ref name="parentPath"/><field-ref name="pageName"/><field-ref name="wikiType"/><field-ref name="sequenceNum"/><field-ref name="submitButton"/><field-ref name="cancelButton"/></field-row-big><field-ref name="pageText"/></field-layout></form-single></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Wiki/ViewWikiPage.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" allow-extra-path="true" default-menu-include="false"><parameter name="wikiSpaceId"/><parameter name="pagePath"/><parameter name="wikiPageId"/><parameter name="versionName"/><actions><set field="extraPathNameList" from="sri.screenUrlInfo.extraPathNameList"/><service-call name="org.moqui.impl.WikiServices.get#WikiPageInfo" in-map="context" out-map="context"/><set field="basePath" from="sri.getCurrentScreenUrl().getScreenOnlyPath()"/><set field="baseLinkPath" from="basePath + '/' + wikiSpaceId"/><set field="baseLinkUrl" from="sri.getCurrentScreenUrl().getScreenPathUrl() + '/' + wikiSpaceId"/></actions><widgets><container><section name="WikiPageInclude"><condition><expression><![CDATA[!wikiSpace?.decoratorScreenLocation]]></expression></condition><actions><script><![CDATA[sri.baseLinkUrl(baseLinkUrl)]]></script></actions><widgets><render-mode><text type="html,vuet,qvt" template="true" location="${pageLocation?:''}${versionName && currentVersionName != versionName ? '#' + versionName.take(12) : ''}"/></render-mode></widgets><fail-widgets><include-screen location="${wikiSpace.decoratorScreenLocation}"/></fail-widgets></section><section name="ResetBaseLink"><actions><script><![CDATA[sri.baseLinkUrl(null)]]></script></actions><widgets/></section></container></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Wiki/wiki/WikiCommentNested.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><parameter name="wikiPageId"/><parameter name="currentCe"/><transition name="wikiCommentReply"><default-response url="../WikiCommentReply"/></transition><actions><filter-map-list list="childCeList" to-list="filteredCeList"><field-map field-name="parentCommEventId" from="currentCe.communicationEventId"/></filter-map-list></actions><widgets><container style="task-comment-child"><section-iterate name="CommentChildList" list="filteredCeList" entry="childCe"><actions><set field="uniqueExtension" from="uniqueExtension + '_' + childCe_index"/><entity-find-one entity-name="mantle.party.Person" value-field="fromPerson" cache="true"><field-map field-name="partyId" from="childCe.fromPartyId"/></entity-find-one><filter-map-list list="childCeList" to-list="childFilteredCeList"><field-map field-name="parentCommEventId" from="childCe.communicationEventId"/></filter-map-list></actions><widgets><label text="${childCe.subject}" type="strong"/><label text="from ${fromPerson ? fromPerson.firstName + ' ' + fromPerson?.lastName : 'Unknown'}" type="span"/><label text="at ${childCe.entryDate}" type="span"/><dynamic-dialog id="ReplyCommentContainer${uniqueExtension}" button-text="Reply" transition="wikiCommentReply"><parameter name="parentCommEventId" from="childCe.communicationEventId"/></dynamic-dialog><label text="${childCe.body}" type="pre" encode="false"/><section name="ChildNestedComments"><condition><expression><![CDATA[childFilteredCeList]]></expression></condition><actions><set field="currentCe" from="childCe"/></actions><widgets><include-screen location="component://SimpleScreens/screen/SimpleScreens/Wiki/wiki/WikiCommentNested.xml"/></widgets></section></widgets></section-iterate></container></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Wiki/wiki/WikiCommentReply.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="wikiPageId"/><parameter name="parentCommEventId"/><transition name="replyComment"><service-call name="mantle.party.CommunicationServices.reply#CommunicationEvent" in-map="context" out-map="context" multi="parameter"/><default-response url=".."/></transition><actions><entity-find-one entity-name="mantle.party.communication.CommunicationEvent" value-field="communicationEvent"><field-map field-name="communicationEventId" from="parentCommEventId"/></entity-find-one></actions><widgets><form-single name="ReplyCommentForm" transition="replyComment"><field name="wikiPageId"><default-field><hidden/></default-field></field><field name="parentCommEventId"><default-field><hidden/></default-field></field><field name="subject"><default-field><text-line default-value="Re: ${communicationEvent.subject}"/></default-field></field><field name="body"><default-field title="Comment"><text-area rows="10"/></default-field></field><field name="submitButton"><default-field title="Reply"><submit/></default-field></field></form-single></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Wiki/wiki.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" allow-extra-path="true" default-menu-include="false"><parameter name="wikiSpaceId"/><parameter name="pagePath"/><parameter name="wikiPageId"/><parameter name="versionName"/><transition name="editPage"><default-response url="../EditWikiPage"/></transition><transition name="createPage"><default-response url="../EditWikiPage"/></transition><transition name="projectSummary"><default-response url="//${appRoot}/Project/ProjectSummary"/></transition><transition name="editTask"><default-response url="//${appRoot}/Task/TaskSummary"/></transition><transition name="editRequest"><default-response url="//${appRoot}/Request/EditRequest"/></transition><transition name="setPublishedVersion"><service-call name="org.moqui.impl.WikiServices.set#PublishedVersion" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="cloneWikiPage"><service-call name="org.moqui.impl.WikiServices.clone#WikiPage" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deletePage"><service-call name="org.moqui.impl.WikiServices.delete#WikiPage" in-map="true" out-map="context" multi="parameter"/><actions><set field="wikiPageId" from="null"/></actions><default-response url="."/></transition><transition name="uploadAttachment"><service-call name="org.moqui.impl.WikiServices.upload#WikiPageAttachment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteAttachment"><service-call name="org.moqui.impl.WikiServices.delete#WikiPageAttachment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="downloadAttachment" read-only="true"><actions><service-call name="org.moqui.impl.WikiServices.get#WikiPageAttachment" in-map="context" out-map="context"/><script><![CDATA[ec.web.sendResourceResponse(attachmentReference.location)]]></script></actions><default-response type="none"/></transition><transition name="wikiCommentReply"><default-response url="WikiCommentReply"/></transition><transition name="addComment"><service-call name="mantle.party.CommunicationServices.add#WikiPageComment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="addCategory"><service-call name="store#moqui.resource.wiki.WikiPageCategoryMember" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="removeCategory"><service-call name="delete#moqui.resource.wiki.WikiPageCategoryMember" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="getSpacePages"><parameter name="wikiSpaceId"/><parameter name="term"/><parameter name="currentPagePath"/><parameter name="valueUsePath"/><parameter name="includeRoot"/><actions><set field="pageIndex" from="pageIndex ?: 0"/><set field="pageSize" from="pageSize ?: 20"/><set field="term" from="term ?: ''"/><set field="valueUsePathBool" from="valueUsePath == 'true'"/><entity-find-one entity-name="moqui.resource.wiki.WikiPage" value-field="wikiPage"><field-map field-name="wikiPageId" from="term"/></entity-find-one><if condition="wikiPage == null"><entity-find entity-name="moqui.resource.wiki.WikiPage" list="byPathPageList"><econdition field-name="wikiSpaceId"/><econdition field-name="pagePath" from="term"/></entity-find><if condition="byPathPageList"><set field="wikiPage" from="byPathPageList[0]"/></if></if><if condition="wikiPage != null"><then><set field="wikiPageList" from="[wikiPage]"/></then><else><entity-find entity-name="moqui.resource.wiki.WikiPage" list="wikiPageList"><search-form-inputs default-order-by="pagePath"/><econdition field-name="wikiSpaceId"/><econdition field-name="pagePath" operator="like" value="%${term}%" ignore="!term"/><econdition field-name="pagePath" operator="not-like" value="${currentPagePath}%" ignore="!currentPagePath"/></entity-find></else></if><script><![CDATA[def outList = []
                if (wikiPage == null && wikiPageList && includeRoot == 'true') outList.add([value:wikiSpaceId, label:'Root Page'])
                for (wikiPage in wikiPageList) outList.add([value:(valueUsePathBool ? wikiPage.pagePath : wikiPage.wikiPageId), label:wikiPage.pagePath])
                ec.web.sendJsonResponse([options:outList, pageSize:pageSize, count:(wikiPageListCount?:wikiPageList.size())])
                // ec.logger.warn("term ${term} outList ${outList}")]]></script></actions><default-response type="none"/></transition><pre-actions><if condition="sri.screenUrlInfo.fullPathNameList && sri.screenUrlInfo.fullPathNameList[0] == 'menuData'"><return/></if><set field="extraPathNameList" from="sri.screenUrlInfo.extraPathNameList"/><service-call name="org.moqui.impl.WikiServices.get#WikiPageInfo" in-map="context" out-map="context"/><script><![CDATA[import org.moqui.impl.screen.ScreenRenderImpl
            import org.moqui.impl.screen.ScreenUrlInfo

            // ec.logger.warn("========== before redirect context=${context}")
            if (!pageReference?.exists) {
                ec.logger.info("Page at ${pageReference} does not exist, forwarding to create")
                ScreenRenderImpl sri = context.sri
                // NOTE: have to do a little more work here because of the extra path that messes up the relative screen loc
                ScreenUrlInfo.UrlInstance editWikiUrl = sri.buildUrl(sri.getRootScreenDef(),
                        sri.getScreenUrlInfo().getPreTransitionPathNameList(), "../EditWikiPage")
                editWikiUrl.addParameter("wikiSpaceId", wikiSpaceId)
                editWikiUrl.addParameter("parentPath", parentPath)
                editWikiUrl.addParameter("pageName", pageName)
                editWikiUrl.addParameter("isCreate", "true")
                sri.sendRedirectAndStopRender(editWikiUrl.getPathWithParams())
            }]]></script></pre-actions><actions><set field="basePath" from="sri.getCurrentScreenUrl().getScreenOnlyPath()"/><set field="baseLinkPath" from="basePath + '/' + wikiSpaceId"/><set field="baseLinkUrl" from="sri.getCurrentScreenUrl().getScreenPathUrl() + '/' + wikiSpaceId"/><set field="childPageList" from="pageReference.getChildren()"/><entity-find entity-name="mantle.party.communication.WikiPageCommEventDetail" list="commEventDetailList"><econdition field-name="wikiPageId"/><order-by field-name="entryDate"/></entity-find><entity-find entity-name="moqui.resource.wiki.WikiPageCategory" list="wikiPageCategories"><order-by field-name="categoryName"/></entity-find></actions><widgets><container-row><row-col md="3"><container-box><box-header title="Page Tree"/><box-body><link text="${wikiSpace?.description?:'Space Root'}" url="${basePath}/${wikiSpace.wikiSpaceId}" link-type="anchor" url-noparam="true"/><tree name="SpacePageTree" open-path="${pagePath}"><parameter name="basePath"/><parameter name="wikiSpaceId"/><tree-node name="WikiPageNode"><actions><set field="curFileName" from="nodeList_entry.pageName"/><set field="newIdPath" from="treeNodeId == '#' ? curFileName : treeNodeId + '/' + curFileName"/><set field="encodedPath" from="newIdPath.split('/').collect({urlEncodeIfNeeded(it)}).join('/')"/></actions><link text="${curFileName}" url="${basePath}/${wikiSpaceId}/${encodedPath}" url-noparam="true" id="${newIdPath}"/><tree-sub-node node-name="WikiPageNode" list="childPageList"><actions><service-call name="org.moqui.impl.WikiServices.get#WikiPageChildren" out-map="curPageInfo" in-map="[wikiSpaceId:wikiSpaceId, pagePath:treeNodeId]"/><set field="childPageList" from="curPageInfo.childPageInfoList"/></actions></tree-sub-node></tree-node><tree-sub-node node-name="WikiPageNode" list="topPageList"><actions><service-call name="org.moqui.impl.WikiServices.get#WikiPageChildren" out-map="rootPageInfo" in-map="[wikiSpaceId:wikiSpaceId]"/><set field="topPageList" from="rootPageInfo.childPageInfoList"/></actions></tree-sub-node></tree></box-body></container-box></row-col><row-col lg="7" md="6"><container id="wiki-breadcrumbs"><link text="${wikiSpace?.description?:'Space Root'}" url="${baseLinkPath}" link-type="anchor" url-noparam="true"/><section-iterate name="breadcrumbs" list="breadcrumbMapList" entry="breadcrumbMap"><widgets><label text="/"/><link text="${breadcrumbMap.pageName}" url="${baseLinkPath}/${breadcrumbMap.encodedPagePath}" link-type="anchor" url-noparam="true"/></widgets></section-iterate></container><container><label text="Seq: ${wikiPage?.sequenceNum ?: 50} ID: ${wikiPageId?:''} (${wikiType})${versionName ? ' Version ' + versionName.take(12) : ''}${publishedVersionName ? ' Published ' + publishedVersionName.take(12) : ''}"/><label text="(this version published)" condition="publishedVersionName && publishedVersionName == versionName" style="text-success"/><link text="Public Link" url="${ec.resource.expand(wikiSpace.publicPageUrl, null, null, false)}" url-type="plain" link-type="anchor" target-window="_blank" condition="wikiSpace?.publicPageUrl"/></container><container-box><box-header title="${pageName?:'[No Name]'}"/><box-toolbar><link url="setPublishedVersion" text="Publish Version ${versionName.take(12)}" condition="versionName && versionName != publishedVersionName" parameter-map="[wikiPageId:wikiPageId, publishedVersionName:versionName]"/><link url="editPage" text="Edit" link-type="anchor-button" icon="fa fa-pencil"><parameter name="wikiSpaceId"/><parameter name="pagePath"/></link><container-dialog id="AddPageDialog" button-text="Add Page"><form-single name="AddPageForm" transition="createPage"><field name="wikiSpaceId"><default-field><hidden/></default-field></field><field name="isCreate"><default-field><hidden default-value="true"/></default-field></field><field name="parentPath" from="pagePath"><default-field><display/></default-field></field><field name="wikiType"><default-field><drop-down><list-options list="ec.resource.getTemplateRendererExtensionSet()"/></drop-down></default-field></field><field name="submitButton"><default-field title="Add Page"><submit/></default-field></field></form-single></container-dialog><container-dialog id="ClonePageDialog" button-text="Copy" title="Copy Wiki Page"><form-single name="ClonePage" transition="cloneWikiPage"><field name="baseWikiSpaceId" from="wikiSpaceId"><default-field><hidden/></default-field></field><field name="pagePath"><default-field><display/></default-field></field><field name="wikiSpaceId"><default-field title="New Wiki Space"><drop-down><entity-options key="${wikiSpaceId}" text="${wikiSpaceId}: ${description}"><entity-find entity-name="moqui.resource.wiki.WikiSpace"><order-by field-name="wikiSpaceId"/></entity-find></entity-options></drop-down></default-field></field><field name="parentPath"><default-field title="New Parent Page"><drop-down><dynamic-options transition="getSpacePages" server-search="true" min-length="0" parameter-map="[wikiSpaceId:null, wikiPageId:null, pagePath:null, currentPagePath:pagePath, parentPath:null, valueUsePath:'true', includeRoot:'true']"><depends-on field="wikiSpaceId"/></dynamic-options></drop-down></default-field></field><field name="submitButton"><default-field title="Clone"><submit/></default-field></field></form-single></container-dialog><link url="deletePage" text="" icon="fa fa-trash" condition="pagePath && !childPageList" btn-type="danger" confirmation="Are you sure you want to delete this wiki page and all attachments? This cannot be undone." parameter-map="[wikiSpaceId:wikiSpaceId, pagePath:pagePath, deleteAttachments:'true', wikiPageId:null]"/><link url="../ViewWikiPage" text="View/Print" target-window="_blank"/></box-toolbar><box-body><container id="wiki-page-area"><section name="WikiPageInclude"><condition><expression><![CDATA[!wikiSpace?.decoratorScreenLocation]]></expression></condition><actions><script><![CDATA[sri.baseLinkUrl(baseLinkUrl)]]></script></actions><widgets><render-mode><text type="html,vuet,qvt" template="true" location="${pageLocation?:''}${versionName && currentVersionName != versionName ? '#' + versionName.take(12) : ''}"/></render-mode></widgets><fail-widgets><include-screen location="${wikiSpace.decoratorScreenLocation}"/></fail-widgets></section><section name="ResetBaseLink"><actions><script><![CDATA[sri.baseLinkUrl(null)]]></script></actions><widgets/></section></container></box-body></container-box><section name="WikiPageCommentSection" condition="wikiPageId"><widgets><container-box><box-header title="Comments"/><box-toolbar><container-dialog id="AddCommentDialog" button-text="Add Comment"><form-single name="AddCommentForm" transition="addComment"><field name="wikiPageId"><default-field><hidden/></default-field></field><field name="subject"><default-field><text-line/></default-field></field><field name="body"><default-field title="Comment"><text-area rows="10"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><section-iterate name="CommentList" list="commEventDetailList" entry="commEventDetail"><actions><set field="uniqueExtension" from="commEventDetail_index"/><entity-find-one entity-name="mantle.party.Person" value-field="fromPerson" cache="true"><field-map field-name="partyId" from="commEventDetail.fromPartyId"/></entity-find-one><entity-find entity-name="mantle.party.communication.CommunicationEvent" list="childCeList"><econdition field-name="rootCommEventId" from="commEventDetail.communicationEventId"/><order-by field-name="entryDate"/></entity-find></actions><widgets><container style="task-comment"><label text="${commEventDetail.subject}" type="strong"/><label text="from ${fromPerson ? fromPerson.firstName + ' ' + fromPerson?.lastName : 'Unknown'}" type="span"/><label text="at ${commEventDetail.entryDate}" type="span"/><dynamic-dialog id="ReplyCommentContainer${uniqueExtension}" button-text="Reply" transition="wikiCommentReply"><parameter name="parentCommEventId" from="commEventDetail.communicationEventId"/></dynamic-dialog><label text="${commEventDetail.body}" type="pre" encode="false"/><section name="ChildNestedComments"><condition><expression><![CDATA[childCeList]]></expression></condition><actions><set field="currentCe" from="commEventDetail"/></actions><widgets><include-screen location="component://SimpleScreens/screen/SimpleScreens/Wiki/wiki/WikiCommentNested.xml"/></widgets></section></container></widgets></section-iterate></box-body></container-box></widgets></section></row-col><row-col lg="2" md="3"><container-box><box-header title="Attachments"/><box-toolbar><container-dialog id="UploadAttachmentDialog" button-text="Upload"><form-single name="UploadAttachment" transition="uploadAttachment"><field name="wikiSpaceId"><default-field><hidden/></default-field></field><field name="pagePath"><default-field><hidden/></default-field></field><field name="attachmentFile"><default-field><file/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><section-iterate name="AttachmentList" list="attachmentList" entry="attachment"><widgets><link url="downloadAttachment" text="${attachment.filename}" link-type="anchor" parameter-map="[wikiSpaceId:wikiSpaceId, pagePath:pagePath, filename:attachment.filename]"/><link url="deleteAttachment" text="" icon="fa fa-trash" btn-type="danger" confirmation="Delete ${attachment.filename} permanently?" parameter-map="[wikiSpaceId:wikiSpaceId, pagePath:pagePath, filename:attachment.filename]"/><container><link text="Public Link" url="${ec.resource.expand(wikiSpace.publicAttachmentUrl, null, attachment, false)}" url-type="plain" link-type="anchor" target-window="_blank" condition="wikiSpace?.publicAttachmentUrl"/></container><container><label text="${attachment.contentType} - ${ec.l10n.format(new Timestamp(attachment.lastModified), 'yyyy-MM-dd HH:mm')}"/></container></widgets></section-iterate></box-body></container-box><section name="CategoriesSection" condition="wikiPageCategories"><actions><entity-find entity-name="moqui.resource.wiki.WikiPageCategoryMember" list="membershipList"><econdition field-name="wikiPageId"/></entity-find></actions><widgets><container-box><box-header title="Categories"/><box-toolbar><container-dialog id="AddCategoryDialog" button-text="Add"><form-single name="AddCategory" transition="addCategory"><field name="wikiPageId"><default-field><hidden/></default-field></field><field name="wikiPageCategoryId"><default-field title="Category"><drop-down><list-options list="wikiPageCategories" text="${categoryName}" key="${wikiPageCategoryId}"/></drop-down></default-field></field><field name="fromDate"><default-field><date-time/></default-field></field><field name="thruDate"><default-field><date-time/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="CategoriesForm" list="membershipList" transition="removeCategory" skip-header="true"><field name="wikiPageId"><default-field><hidden/></default-field></field><field name="wikiPageCategoryId"><default-field title=""><display-entity entity-name="moqui.resource.wiki.WikiPageCategory" text="${categoryName}"/></default-field></field><field name="fromThruDates"><default-field title=""><display text="${fromDate ? 'From ' + ec.l10n.format(fromDate, null) : ''} ${thruDate ? 'Thru ' + ec.l10n.format(thruDate, null) : ''}"/></default-field></field><field name="deleteButton" align="right"><default-field title=""><submit icon="fa fa-trash" confirmation="Really remove?"/></default-field></field><form-list-column><field-ref name="wikiPageCategoryId"/><field-ref name="fromThruDates"/></form-list-column><form-list-column><field-ref name="deleteButton"/></form-list-column></form-list></box-body></container-box></widgets></section><section name="PageRelatedSection" condition="wikiPageId"><actions><entity-find entity-name="mantle.request.WikiPageAndRequest" list="wparList"><econdition field-name="wikiPageId"/></entity-find><entity-find entity-name="mantle.work.effort.WikiPageAndWorkEffort" list="wpaweList"><econdition field-name="wikiPageId"/></entity-find><filter-map-list list="wpaweList" to-list="projectWpaweList"><field-map field-name="workEffortTypeEnumId" value="WetProject"/></filter-map-list><filter-map-list list="wpaweList" to-list="taskWpaweList"><field-map field-name="workEffortTypeEnumId" value="WetTask"/></filter-map-list><entity-find entity-name="mantle.request.WikiPageAndRequest" list="wparList"><econdition field-name="wikiPageId"/></entity-find><entity-find entity-name="moqui.resource.wiki.WikiPageHistory" list="wphList"><econdition field-name="wikiPageId"/><order-by field-name="-changeDateTime"/></entity-find></actions><widgets><section name="ProjectSection" condition="projectWpaweList"><widgets><container-box><box-header title="Page Projects"/><box-body><section-iterate name="ProjectItemSection" list="projectWpaweList" entry="projectWpawe"><widgets><link url="projectSummary" text="${projectWpawe.workEffortId} - ${projectWpawe.workEffortName}" link-type="anchor"><parameter name="rootWorkEffortId" from="projectWpawe.workEffortId"/></link></widgets></section-iterate></box-body></container-box></widgets></section><section name="TaskSection" condition="taskWpaweList"><widgets><container-box><box-header title="Page Tasks"/><box-body><section-iterate name="TaskItemSection" list="taskWpaweList" entry="taskWpawe"><actions><entity-find-one entity-name="moqui.basic.StatusItem" value-field="taskStatusItem" cache="true"><field-map field-name="statusId" from="taskWpawe.statusId"/></entity-find-one><entity-find-one entity-name="moqui.basic.Enumeration" value-field="taskPurposeEnum" cache="true"><field-map field-name="enumId" from="taskWpawe.purposeEnumId"/></entity-find-one></actions><widgets><link url="editTask" text="${taskWpawe.workEffortId} - ${taskWpawe.workEffortName}" link-type="anchor"><parameter name="workEffortId" from="taskWpawe.workEffortId"/></link><label text="P: ${taskPurposeEnum.description} - S: ${taskStatusItem.description} - P: ${taskWpawe.priority?:''}" type="p"/></widgets></section-iterate></box-body></container-box></widgets></section><section name="RequestSection" condition="wparList"><widgets><container-box><box-header title="Page Requests"/><box-body><section-iterate name="RequestItemSection" list="wparList" entry="wpar"><actions><entity-find-one entity-name="moqui.basic.StatusItem" value-field="requestStatusItem" cache="true"><field-map field-name="statusId" from="wpar.statusId"/></entity-find-one><entity-find-one entity-name="moqui.basic.Enumeration" value-field="requestTypeEnum" cache="true"><field-map field-name="enumId" from="wpar.requestTypeEnumId"/></entity-find-one></actions><widgets><link url="editRequest" text="${wpar.requestId} - ${wpar.requestName}" link-type="anchor"><parameter name="requestId" from="wpar.requestId"/></link><label text="T: ${requestTypeEnum.description} - S: ${requestStatusItem.description} - P: ${wpar.priority?:''}" type="p"/></widgets></section-iterate></box-body></container-box></widgets></section><container-box><box-header title="Page History"/><box-body><section-iterate name="HistoryIterateSection" list="wphList" entry="wph"><actions><entity-find-one entity-name="mantle.party.PersonAndUserAccount" value-field="paua"><field-map field-name="userId" from="wph.userId"/></entity-find-one><if condition="wph_has_next"><set field="nextWph" from="wphList[wph_index+1]"/></if></actions><widgets><container><section name="PageVersionSection" condition="wph.versionName"><widgets><container><link url="." text="Version ${wph.versionName.take(12)}" link-type="anchor"><parameter name="versionName" from="wph.versionName"/></link><label text=" published" condition="wph.versionName == publishedVersionName" style="text-success"/></container><container><link url="../WikiCompare" text="diff prev" link-type="anchor" condition="nextWph && nextWph.versionName"><parameter name="versionNameLhs" from="nextWph.versionName"/><parameter name="versionNameRhs" from="wph.versionName"/></link><link url="../WikiCompare" text="diff cur" link-type="anchor" condition="currentVersionName && wph.versionName != currentVersionName"><parameter name="versionNameLhs" from="wph.versionName"/><parameter name="versionNameRhs" from="currentVersionName"/></link></container></widgets></section><label text="By ${paua.firstName?:''} ${paua.lastName?:''} (${paua.username?:'N/A'})" type="div" condition="paua"/><label text="At ${ec.l10n.format(wph.changeDateTime, 'yyyy-MM-dd HH:mm')}" type="div"/></container></widgets></section-iterate></box-body></container-box></widgets></section></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Wiki/WikiBlogs.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Wiki Blog Posts" default-menu-include="false"><transition name="createBlog"><service-call name="org.moqui.impl.WikiServices.create#WikiBlog" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditWikiBlog"/></transition><transition-include name="getSpacePages" location="component://SimpleScreens/screen/SimpleScreens/Wiki/wiki.xml"/><widgets><container-dialog id="AddBlogPageDialog" button-text="Add Blog Post from Page"><form-single name="AddBlogPage" transition="createBlog"><field name="title"><default-field tooltip="letters, digits, [.,-_:()!? ] only"><text-line size="100"/></default-field></field><field name="publishDate" from="ec.user.nowTimestamp"><default-field><date-time/></default-field></field><field name="author"><default-field><text-line size="60"/></default-field></field><field name="summary"><default-field><text-area cols="100" rows="6" maxlength="4000"/></default-field></field><field name="smallImage"><default-field><file/></default-field></field><field name="wikiSpaceId"><default-field title="Wiki Space"><drop-down><entity-options key="${wikiSpaceId}" text="${wikiSpaceId}: ${description}"><entity-find entity-name="moqui.resource.wiki.WikiSpace"><order-by field-name="wikiSpaceId"/></entity-find></entity-options></drop-down></default-field></field><field name="wikiPageId"><default-field title="Wiki Page"><drop-down><dynamic-options transition="getSpacePages" server-search="true" min-length="0"><depends-on field="wikiSpaceId"/></dynamic-options></drop-down></default-field></field><field name="blogText"><default-field><ignored/></default-field></field><field name="submitButton"><default-field title="Create Post"><submit/></default-field></field></form-single></container-dialog><container-dialog id="AddBlogTextDialog" button-text="Add Blog Post with Text" width="980"><form-single name="AddBlogText" transition="createBlog" extends="AddBlogPage"><field name="wikiPageId"><default-field><ignored/></default-field></field><field name="blogText"><default-field><text-area cols="120" rows="35" editor-type="html"/></default-field></field></form-single><label text="This will create a Blog Post and a Wiki Page using the title for the Page Name"/></container-dialog><form-list name="WikiBlogList" list="blogsList" skip-form="true" header-dialog="true"><entity-find entity-name="moqui.resource.wiki.WikiBlogFindView" list="blogsList"><search-form-inputs default-order-by="-publishDate"/><select-field field-name="wikiBlogId,wikiPageId,wikiSpaceId,pagePath"/></entity-find><row-actions><entity-find-one entity-name="moqui.resource.wiki.WikiSpace" value-field="wikiSpace" cache="true"/><entity-find entity-name="moqui.resource.wiki.WikiBlogCategoryDetail" list="blogCategoryList"><econdition field-name="wikiBlogId"/></entity-find></row-actions><field name="publishDate"><header-field show-order-by="case-insensitive"><date-period/></header-field><default-field><display format="yyyy-MM-dd"/></default-field></field><field name="wikiPageCategoryId"><header-field title="Category"><drop-down allow-empty="true"><entity-options text="${categoryName}" key="${wikiPageCategoryId}"><entity-find entity-name="moqui.resource.wiki.WikiPageCategory"><order-by field-name="categoryName"/></entity-find></entity-options></drop-down></header-field></field><field name="categories"><default-field><section-iterate name="CategoryListSection" list="blogCategoryList" entry="blogCategory"><widgets><label text="${blogCategory.categoryName}" type="div"/></widgets></section-iterate></default-field></field><field name="title"><header-field show-order-by="case-insensitive"><text-find/></header-field><default-field><link url="../EditWikiBlog" text="${title}" link-type="anchor"/></default-field></field><field name="author"><header-field show-order-by="case-insensitive"><drop-down allow-empty="true"><entity-options key="${author}" text="${author}"><entity-find entity-name="moqui.resource.wiki.WikiBlog" distinct="true"><select-field field-name="author"/></entity-find></entity-options></drop-down></header-field><default-field><display/></default-field></field><field name="wikiSpaceId"><header-field title="Wiki Space"><drop-down allow-empty="true"><entity-options key="${wikiSpaceId}" text="${wikiSpaceId}: ${description}"><entity-find entity-name="moqui.resource.wiki.WikiSpace"><order-by field-name="wikiSpaceId"/></entity-find></entity-options></drop-down></header-field><default-field><display/></default-field></field><field name="viewPage"><default-field title=""><link url="../wiki/${wikiSpaceId}/${pagePath}" text="Wiki Page" link-type="anchor" condition="wikiSpaceId"/></default-field></field><field name="publicPage"><default-field title=""><link url="${ec.resource.expand(wikiSpace.publicBlogUrl, null, null, false)}" text="Public Link" url-type="plain" link-type="anchor" target-window="_blank" condition="wikiSpace?.publicBlogUrl"/></default-field></field><field name="findButton"><header-field title="Find"><submit/></header-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Wiki/WikiCompare.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" allow-extra-path="true" default-menu-include="false"><parameter name="wikiSpaceId" required="true"/><parameter name="pagePath"/><parameter name="versionNameLhs" required="true"/><parameter name="versionNameRhs" required="true"/><actions><service-call name="org.moqui.impl.WikiServices.get#WikiPageInfo" in-map="context" out-map="context"/><set field="pageTextLhs" from="pageReference?.getText(versionNameLhs) ?: ''"/><set field="pageTextRhs" from="pageReference?.getText(versionNameRhs) ?: ''"/><set field="wikiType" from="wikiType ?: 'md'"/></actions><widgets><container-box><box-header title="Compare ${pageName} versions ${versionNameLhs} and ${versionNameRhs}"/><box-toolbar><link url="../wiki" text="Back to View"/></box-toolbar><box-body><render-mode><text type="html,vuet,qvt"><![CDATA[<pre id="result" class="compare"></pre><textarea id="pageTextLhs" style="display: none;">${pageTextLhs?html}</textarea><textarea id="pageTextRhs" style="display: none;">${pageTextRhs?html}</textarea><script src="https://cdnjs.cloudflare.com/ajax/libs/jsdiff/3.2.0/diff.min.js" type="text/javascript"></script><script>
    var a = document.getElementById('pageTextLhs');
    var b = document.getElementById('pageTextRhs');
    var result = document.getElementById('result');
    // diffChars, diffWords, diffLines
	var diff = JsDiff['diffChars'](a.textContent, b.textContent);
	var fragment = document.createDocumentFragment();
	for (var i=0; i < diff.length; i++) {
		if (diff[i].added && diff[i + 1] && diff[i + 1].removed) {
			var swap = diff[i];
			diff[i] = diff[i + 1];
			diff[i + 1] = swap;
		}
		var node;
		if (diff[i].removed) {
			node = document.createElement('del');
			node.appendChild(document.createTextNode(diff[i].value));
		} else if (diff[i].added) {
			node = document.createElement('ins');
			node.appendChild(document.createTextNode(diff[i].value));
		} else {
			node = document.createTextNode(diff[i].value);
		}
		fragment.appendChild(node);
	}

	result.textContent = '';
	result.appendChild(fragment);
            </script>]]></text></render-mode></box-body></container-box></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Wiki/WikiSpaces.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Wiki Spaces" default-menu-include="false"><transition name="createSpace"><service-call name="org.moqui.impl.WikiServices.create#WikiSpace" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="editSpace"><default-response url="../EditWikiSpace"/></transition><pre-actions><set field="html_title" value="Find Wiki Space"/></pre-actions><widgets><container-dialog id="NewSpaceContainer" button-text="New Space"><form-single name="NewSpace" transition="createSpace"><field name="wikiSpaceId"><default-field><text-line size="8" maxlength="8"/></default-field></field><field name="description"><default-field><text-line size="40"/></default-field></field><field name="restrictView"><default-field><drop-down no-current-selected-key="N" current="selected"><option key="N"/><option key="Y"/></drop-down></default-field></field><field name="restrictUpdate"><default-field><drop-down no-current-selected-key="N" current="selected"><option key="N"/><option key="Y"/></drop-down></default-field></field><field name="allowAnyHtml"><default-field><drop-down no-current-selected-key="N" current="selected"><option key="N"/><option key="Y"/></drop-down></default-field></field><field name="wikiType"><default-field><drop-down no-current-selected-key="md"><list-options list="ec.resource.getTemplateRendererExtensionSet()"/></drop-down></default-field></field><field name="rootPageDirectory"><default-field><drop-down combo-box="true"><option key="dbresource://WikiSpace"/><option key="WikiSpace" text="runtime/WikiSpace"/><option key="content://main/WikiSpace"/></drop-down></default-field></field><field name="rootPageLocation"><default-field title="Root Page Override" tooltip="Select a root page directory unless you know what you're doing and really need this, should end in filename with extension based on wiki type like .md"><text-line size="60"/></default-field></field><field name="submitButton"><default-field title="Create Space"><submit/></default-field></field></form-single></container-dialog><form-list name="WikiSpaceList" list="spaceList" skip-form="true" header-dialog="true"><entity-find entity-name="moqui.resource.wiki.WikiSpace" list="spaceList"><search-form-inputs default-order-by="wikiSpaceId"/></entity-find><field name="viewSpaceLink"><default-field title=""><link text="View Pages" url="../wiki/${wikiSpaceId}"/></default-field></field><field name="blogPostsLink"><default-field title=""><link text="Blog Posts" url="../WikiBlogs?wikiSpaceId=${wikiSpaceId}"/></default-field></field><field name="wikiSpaceId"><header-field show-order-by="case-insensitive" title="Space ID"><text-find size="15" hide-options="true"/></header-field><default-field><link url="editSpace" text="${wikiSpaceId}" link-type="anchor"/></default-field></field><field name="description"><header-field show-order-by="case-insensitive"><text-find hide-options="true"/></header-field><default-field><link url="editSpace" text="${wikiSpaceId}: ${description}" link-type="anchor"/></default-field></field><field name="rootPageLocation"><header-field show-order-by="case-insensitive" title="Root Page Location"><text-find/></header-field><default-field><display also-hidden="false"/></default-field></field><field name="publicPageUrl"><header-field show-order-by="case-insensitive" title="Public Page"><text-find/></header-field><default-field><display also-hidden="false"/></default-field></field><field name="publicAttachmentUrl"><header-field show-order-by="case-insensitive" title="Public Attachment"><text-find/></header-field><default-field><display also-hidden="false"/></default-field></field><field name="publicBlogUrl"><header-field show-order-by="case-insensitive" title="Public Blog"><text-find/></header-field><default-field><display also-hidden="false"/></default-field></field><field name="restrictView"><default-field><display also-hidden="false"/></default-field></field><field name="restrictUpdate"><default-field><display also-hidden="false"/></default-field></field><field name="allowAnyHtml"><default-field title="Any HTML"><display also-hidden="false"/></default-field></field><field name="findButton"><header-field title="Find"><submit/></header-field></field><form-list-column><field-ref name="viewSpaceLink"/></form-list-column><form-list-column><field-ref name="blogPostsLink"/></form-list-column><form-list-column><field-ref name="wikiSpaceId"/></form-list-column><form-list-column><field-ref name="description"/><field-ref name="rootPageLocation"/></form-list-column><form-list-column><field-ref name="publicPageUrl"/><field-ref name="publicAttachmentUrl"/></form-list-column><form-list-column><field-ref name="publicBlogUrl"/></form-list-column><form-list-column><field-ref name="restrictView"/><field-ref name="restrictUpdate"/></form-list-column><form-list-column><field-ref name="allowAnyHtml"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Wiki/EditWikiBlog.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Edit Blog Post" default-menu-index="1"><parameter name="wikiBlogId" required="true"/><transition name="wiki"><default-response url="../wiki"/></transition><transition name="updateBlog"><service-call name="org.moqui.impl.WikiServices.update#WikiBlog" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="addCategory"><service-call name="create#moqui.resource.wiki.WikiBlogCategory" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="removeCategory"><service-call name="delete#moqui.resource.wiki.WikiBlogCategory" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getSpacePages" location="component://SimpleScreens/screen/SimpleScreens/Wiki/wiki.xml"/><transition name="downloadSmallImage" read-only="true"><actions><entity-find-one entity-name="moqui.resource.wiki.WikiBlog" value-field="wikiBlog"/><script><![CDATA[ec.web.sendResourceResponse(wikiBlog?.smallImageLocation)]]></script></actions><default-response type="none"/></transition><actions><entity-find-one entity-name="moqui.resource.wiki.WikiBlog" value-field="wikiBlog"/><entity-find-one entity-name="moqui.resource.wiki.WikiPage" value-field="wikiPage"><field-map field-name="wikiPageId" from="wikiBlog.wikiPageId"/></entity-find-one><set field="wikiSpaceId" from="wikiPage?.wikiSpaceId"/><entity-find-one entity-name="moqui.resource.wiki.WikiSpace" value-field="wikiSpace" cache="true"/><entity-find entity-name="moqui.resource.wiki.WikiPageCategory" list="wikiPageCategories"><order-by field-name="categoryName"/></entity-find></actions><widgets><container-row><row-col md="8"><link url="../WikiBlogs" text="Back to Find Blog Post"/><link url="wiki" text="View/Edit Wiki Page" condition="wikiPage" parameter-map="[wikiSpaceId:wikiPage.wikiSpaceId, wikiPageId:wikiPage.wikiPageId]"/><link url="${ec.resource.expand(wikiSpace.publicBlogUrl, null, null, false)}" text="Public Link" url-type="plain" link-type="anchor" target-window="_blank" condition="wikiSpace?.publicBlogUrl"/><form-single name="EditBlogForm" map="wikiBlog" transition="updateBlog"><field name="wikiBlogId"><default-field><hidden/></default-field></field><field name="title"><default-field tooltip="letters, digits, [.,-_:()!? ] only"><text-line size="100"/></default-field></field><field name="publishDate"><default-field><date-time/></default-field></field><field name="author"><default-field><text-line size="60"/></default-field></field><field name="summary"><default-field><text-area cols="100" rows="6" maxlength="4000"/></default-field></field><field name="metaKeywords"><default-field><text-line size="100"/></default-field></field><field name="metaDescription"><default-field><text-area cols="100" rows="2" maxlength="160"/></default-field></field><field name="smallImage"><default-field><file/></default-field></field><field name="wikiSpaceId"><default-field title="Wiki Space"><drop-down><entity-options key="${wikiSpaceId}" text="${wikiSpaceId}: ${description}"><entity-find entity-name="moqui.resource.wiki.WikiSpace"><order-by field-name="wikiSpaceId"/></entity-find></entity-options></drop-down></default-field></field><field name="wikiPageId"><default-field title="Wiki Page"><drop-down><dynamic-options transition="getSpacePages" server-search="true" min-length="0"><depends-on field="wikiSpaceId"/></dynamic-options></drop-down><link url="wiki" text="Current Page ${wikiPageId} at ${wikiPage.wikiSpaceId}/${wikiPage.pagePath}" condition="wikiPage" link-type="anchor"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></row-col><row-col md="4"><section name="ShowSmallImage" condition="wikiBlog.smallImageLocation"><widgets><image url="downloadSmallImage" url-type="transition" width="200" style="img-thumbnail" parameter-map="[wikiBlogId:wikiBlog.wikiBlogId]"/></widgets></section><section name="CategoriesSection" condition="wikiPageCategories"><actions><entity-find entity-name="moqui.resource.wiki.WikiBlogCategory" list="membershipList"><econdition field-name="wikiBlogId"/></entity-find></actions><widgets><container-box><box-header title="Categories"/><box-toolbar><container-dialog id="AddCategoryDialog" button-text="Add Category"><form-single name="AddCategory" transition="addCategory"><field name="wikiBlogId"><default-field><hidden/></default-field></field><field name="wikiPageCategoryId"><default-field title="Category"><drop-down><list-options list="wikiPageCategories" text="${categoryName}" key="${wikiPageCategoryId}"/></drop-down></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="CategoriesForm" list="membershipList" transition="removeCategory" skip-header="true"><field name="wikiBlogId"><default-field><hidden/></default-field></field><field name="wikiPageCategoryId"><default-field title=""><display-entity entity-name="moqui.resource.wiki.WikiPageCategory" text="${categoryName}"/></default-field></field><field name="submitButton" align="right"><default-field title=""><submit icon="fa fa-trash" confirmation="Really remove?"/></default-field></field></form-list></box-body></container-box></widgets></section></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Wiki/EditWikiSpace.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Wiki Space" default-menu-index="1"><parameter name="wikiSpaceId" required="true"/><transition name="updateSpace"><service-call name="update#moqui.resource.wiki.WikiSpace" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="indexPages"><service-call name="org.moqui.search.SearchServices.index#WikiSpacePages" in-map="context + [dataDocumentId:'MantleWikiPage']" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="cloneWikiSpace" begin-transaction="false"><service-call name="org.moqui.impl.WikiServices.clone#WikiSpace" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><entity-find-one entity-name="moqui.resource.wiki.WikiSpace" value-field="wikiSpace"/></actions><widgets><link text="View Space" url="../wiki/${wikiSpaceId}" link-type="anchor-button"/><link text="Index Space Pages" url="indexPages" link-type="hidden-form"/><container-dialog id="CloneSpaceDialog" button-text="Clone Space"><form-single name="CloneSpace" transition="cloneWikiSpace"><field name="baseWikiSpaceId" from="wikiSpaceId"><default-field title="Base Space ID"><display/></default-field></field><field name="wikiSpaceId"><default-field title="New Space ID"><text-line size="8" maxlength="8"/></default-field></field><field name="description" from="wikiSpace.description"><default-field><text-line size="40"/></default-field></field><field name="rootPageDirectory"><default-field><drop-down combo-box="true"><option key="dbresource://WikiSpace"/><option key="WikiSpace" text="runtime/WikiSpace"/><option key="content://main/WikiSpace"/></drop-down></default-field></field><field name="rootPageLocation"><default-field title="Root Page Override" tooltip="Select a root page directory unless you know what you're doing and really need this, should end in filename with extension based on wiki type like .md"><text-line size="60"/></default-field></field><field name="copyAttachments"><default-field><radio no-current-selected-key="true"><option key="true" text="Yes"/><option key="false" text="No"/></radio></default-field></field><field name="publishNew"><default-field><radio no-current-selected-key="true"><option key="true" text="Yes"/><option key="false" text="No"/></radio></default-field></field><field name="submitButton"><default-field title="Clone Space"><submit/></default-field></field></form-single></container-dialog><form-single name="EditSpace" map="wikiSpace" transition="updateSpace"><field name="wikiSpaceId"><default-field><hidden/></default-field></field><field name="description"><default-field><text-line size="60"/></default-field></field><field name="rootPageLocation"><default-field><display/></default-field></field><field name="publicPageUrl"><default-field><text-line size="80"/></default-field></field><field name="publicAttachmentUrl"><default-field><text-line size="80"/></default-field></field><field name="publicBlogUrl"><default-field><text-line size="80"/></default-field></field><field name="restrictView"><default-field><drop-down no-current-selected-key="N"><option key="N"/><option key="Y"/></drop-down></default-field></field><field name="restrictUpdate"><default-field><drop-down no-current-selected-key="N"><option key="N"/><option key="Y"/></drop-down></default-field></field><field name="allowAnyHtml"><default-field title="Allow Any HTML"><drop-down no-current-selected-key="N"><option key="N"/><option key="Y"/></drop-down></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Wiki.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Wiki/Content" default-menu-include="false" menu-image="/ssstatic/images/Wiki.png"><subscreens default-item="WikiSpaces"/><widgets><subscreens-active/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/SimpleReport/QuickViewReport.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Report Viewer" default-menu-include="false" menu-image="fa fa-database" menu-image-type="icon"><parameter name="dataDocumentId"/><transition-include name="DocumentExport.json" location="component://tools/screen/System/DataDocument/Edit/ViewDataDocument.xml"/><widgets><container-dialog id="SelectReportDialog" button-text="Select a Report"><form-list name="DataDocumentList" list="dataDocumentList" skip-form="true" skip-header="true"><entity-find entity-name="moqui.entity.document.DataDocumentAndUserGroup"><econdition field-name="userGroupId" operator="in" from="ec.user.getUserGroupIdSet()"/><select-field field-name="dataDocumentId"/><order-by field-name="documentName"/></entity-find><field name="documentName"><default-field><link url="." text="${documentName}" link-type="anchor"/></default-field></field></form-list></container-dialog><section-include name="ViewReportSection" location="component://SimpleScreens/screen/SimpleScreens/SimpleReport/ViewReport.xml"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/SimpleReport/FindReport.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="editReport"><default-response url="../EditReport"/></transition><transition name="createDataDocument"><service-call name="org.moqui.impl.EntityServices.create#DataDocument" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditReport"/></transition><actions><set field="entityInfoList" from="ec.entity.getAllEntitiesInfo('entityName', null, false, true)"/><if condition="excludeFilter"><set field="entityInfoList" from="entityInfoList.findAll({ !it.fullEntityName.matches(excludeFilter) })"/></if></actions><widgets><container-dialog id="CreateDialog" button-text="Create Report"><form-single name="CreateDataDocument" transition="createDataDocument"><field name="dataDocumentId"><default-field title="ID"><text-line size="30"/></default-field></field><field name="documentName"><default-field title="Name"><text-line size="60"/></default-field></field><field name="primaryEntityName"><default-field title="Primary Entity"><drop-down><list-options list="entityInfoList" key="${fullEntityName}" text="${org.moqui.util.StringUtilities.camelCaseToPretty(entityName)}"/></drop-down></default-field></field><field name="userGroupId"><default-field title="User Group"><drop-down><entity-options key="${userGroupId}" text="${description}"><entity-find entity-name="moqui.security.UserGroup"><econdition field-name="userGroupId" operator="in" from="ec.user.getUserGroupIdSet()"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="DataDocumentList" list="dataDocumentList" skip-form="true" header-dialog="true"><entity-find entity-name="moqui.entity.document.DataDocumentAndUserGroup"><search-form-inputs default-order-by="dataDocumentId"/><econdition field-name="userGroupId" operator="in" from="ec.user.getUserGroupIdSet()"/></entity-find><field name="dataDocumentId"><header-field title="ID" show-order-by="true"><text-find hide-options="true"/></header-field><default-field><link url="editReport" text="${dataDocumentId}" link-type="anchor"/></default-field></field><field name="documentName"><header-field title="Name" show-order-by="true"><text-find hide-options="true"/></header-field><default-field><link url="editReport" text="${documentName}" link-type="anchor"/></default-field></field><field name="primaryEntityName"><header-field title="Primary Entity" show-order-by="true"><drop-down allow-empty="true"><entity-options key="${primaryEntityName}" text="${org.moqui.util.StringUtilities.camelCaseToPretty(primaryEntityName.substring(primaryEntityName.lastIndexOf('.')+1))}"><entity-find entity-name="moqui.entity.document.DataDocument" distinct="true"><select-field field-name="primaryEntityName"/><order-by field-name="primaryEntityName"/></entity-find></entity-options></drop-down></header-field><default-field><display text="${org.moqui.util.StringUtilities.camelCaseToPretty(primaryEntityName.substring(primaryEntityName.lastIndexOf('.')+1))}"/></default-field></field><field name="findButton"><header-field><submit/></header-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/SimpleReport/EditReport/FieldList.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="dataDocumentId" required="true" from="dataDocumentId ?: dataDocumentId_0"/><transition name="createDataDocumentCondition"><service-call name="create#moqui.entity.document.DataDocumentCondition" in-map="true" out-map="context" multi="parameter"/><default-response url=".."/></transition><transition name="updateDataDocumentCondition"><service-call name="update#moqui.entity.document.DataDocumentCondition" in-map="true" out-map="context" multi="parameter"/><default-response url=".."/></transition><transition name="deleteDataDocumentCondition"><service-call name="delete#moqui.entity.document.DataDocumentCondition" in-map="true" out-map="context" multi="parameter"/><default-response url=".."/></transition><transition name="createFieldDynamic" read-only="true"><service-call name="org.moqui.impl.EntityServices.create#DataDocumentField" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createDataDocumentField"><service-call name="org.moqui.impl.EntityServices.create#DataDocumentField" in-map="true" out-map="context" multi="parameter"/><default-response url=".."/></transition><transition name="updateDataDocumentField"><service-call name="org.moqui.impl.EntityServices.update#DataDocumentField" in-map="true" out-map="context" multi="parameter"/><default-response url=".."/></transition><transition name="deleteDataDocumentField"><service-call name="delete#moqui.entity.document.DataDocumentField" in-map="true" out-map="context" multi="parameter"/><default-response url=".."/></transition><actions><set field="opOptions" from="['equals', 'not-equals', 'less', 'greater', 'less-equals', 'greater-equals', 'in', 'not-in',             'between', 'not-between', 'like', 'not-like', 'is-null', 'is-not-null']"/><set field="funcOptions" from="['min', 'max', 'sum', 'avg', 'count', 'count-distinct', 'upper', 'lower']"/><set field="knownFields" from="new HashSet()"/><entity-find entity-name="moqui.entity.document.DataDocumentField" list="ddFieldList"><econdition field-name="dataDocumentId"/><order-by field-name="sequenceNum,fieldPath"/></entity-find><set field="fieldAliasSet" from="new LinkedHashSet()"/><iterate list="ddFieldList" entry="ddf"><script><![CDATA[fieldAliasSet.add(ddf.fieldNameAlias ?: (ddf.fieldPath.contains(':') ? ddf.fieldPath.substring(ddf.fieldPath.lastIndexOf(':')+1) : ddf.fieldPath))]]></script></iterate></actions><widgets><container-box><box-header title="Conditions"/><box-toolbar><container-dialog id="AddConditionDialog" button-text="Add Condition"><form-single name="AddCondition" transition="createDataDocumentCondition" extends="component://tools/screen/System/DataDocument/Edit/DataDocFields/FieldList.xml#AddCondition"><field name="postQuery"><default-field><ignored/></default-field></field></form-single></container-dialog></box-toolbar><box-body-nopad><form-list name="ConditionList" list="conditionList" transition="updateDataDocumentCondition" extends="component://tools/screen/System/DataDocument/Edit/DataDocFields/FieldList.xml#ConditionList"><field name="postQuery"><default-field><ignored/></default-field></field></form-list></box-body-nopad></container-box><container-box><box-header title="Fields"/><box-body><label text="Each field must have a unique name, duplicates shown in red. Set an alias to resolve duplicates." type="p"/></box-body><box-body-nopad><form-list name="FieldList" list="ddFieldList" transition="updateDataDocumentField" multi="true" extends="component://tools/screen/System/DataDocument/Edit/DataDocFields/FieldList.xml#FieldList"><field name="sortable"><default-field><ignored/></default-field></field></form-list></box-body-nopad></container-box></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/SimpleReport/EditReport.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Edit Report" default-menu-index="2"><parameter name="dataDocumentId" required="true" from="dataDocumentId ?: dataDocumentId_0"/><transition name="updateDataDocument"><service-call name="org.moqui.impl.EntityServices.update#DataDocument" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createDataDocumentField"><service-call name="org.moqui.impl.EntityServices.create#DataDocumentField" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><entity-find entity-name="moqui.entity.document.DataDocumentUserGroup" list="ddugList"><econdition field-name="dataDocumentId"/><econdition field-name="userGroupId" operator="in" from="ec.user.getUserGroupIdSet()"/></entity-find><if condition="!ddugList"><return error="true" message="You are not in a group allowed to see Report ${dataDocumentId}"/></if><set field="userGroupId" from="ddugList[0].userGroupId"/><entity-find-one entity-name="moqui.entity.document.DataDocument" value-field="dataDocument"/><set field="entityInfoList" from="ec.entity.getAllEntitiesInfo('entityName', null, false, true)"/><if condition="excludeFilter"><set field="entityInfoList" from="entityInfoList.findAll({ !it.fullEntityName.matches(excludeFilter) })"/></if><set field="primaryEntityName" from="dataDocument.primaryEntityName"/><set field="funcOptions" from="['min', 'max', 'sum', 'avg', 'count', 'count-distinct', 'upper', 'lower']"/></actions><widgets><form-single name="EditDataDocument" transition="updateDataDocument" map="dataDocument"><field name="dataDocumentId"><default-field title="ID"><display/></default-field></field><field name="documentName"><default-field title="Name"><text-line size="30"/></default-field></field><field name="primaryEntityName"><default-field title="Primary Entity"><drop-down><list-options list="entityInfoList" key="${fullEntityName}" text="${org.moqui.util.StringUtilities.camelCaseToPretty(entityName)}"/></drop-down></default-field></field><field name="userGroupId"><conditional-field title="User Group" condition="ddugList.size() == 1"><drop-down><entity-options key="${userGroupId}" text="${description}"><entity-find entity-name="moqui.security.UserGroup"><econdition field-name="userGroupId" operator="in" from="ec.user.getUserGroupIdSet()"/></entity-find></entity-options></drop-down></conditional-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field-layout><field-row-big><field-ref name="dataDocumentId"/><field-ref name="documentName"/><field-ref name="primaryEntityName"/><field-ref name="userGroupId"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single><container-row><row-col md="4"><section-include name="FieldTreeSection" location="component://tools/screen/System/DataDocument/Edit/DataDocFields.xml"/></row-col><row-col md="8"><dynamic-container id="FieldListContainer" transition="FieldList"/></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/SimpleReport/ViewReport.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="View" default-menu-index="3"><parameter name="dataDocumentId" required="true"/><transition-include name="DocumentExport.json" location="component://tools/screen/System/DataDocument/Edit/ViewDataDocument.xml"/><widgets><section name="ViewReportSection" condition="dataDocumentId"><actions><entity-find entity-name="moqui.entity.document.DataDocumentUserGroup" list="ddugList"><econdition field-name="dataDocumentId"/><econdition field-name="userGroupId" operator="in" from="ec.user.getUserGroupIdSet()"/></entity-find><if condition="!ddugList"><return error="true" message=""/></if><set field="entityName" from="'DataDocument.' + dataDocumentId"/><set field="aenDef" from="ec.entity.getEntityDefinition(entityName)"/><if condition="aenDef == null"><message error="true"><![CDATA[Could not find Report ${dataDocumentId}]]></message><return/></if></actions><widgets><container-dialog id="ExportJsonDialog" button-text="Download JSON"><form-single name="ExportDocuments" transition="DocumentExport.json"><field name="dataDocumentId"><default-field><hidden/></default-field></field><field name="fromUpdateStamp"><default-field><date-time/></default-field></field><field name="thruUpdateStamp"><default-field><date-time/></default-field></field><field name="prettyPrint"><default-field title=""><check><option key="true" text="Pretty Print JSON?"/></check></default-field></field><field name="submitButton"><default-field title="Download"><submit/></default-field></field></form-single></container-dialog><section name="ReportCondView" condition="ddugList"><widgets><form-list name="DataViewList" list="entityValueList" skip-form="true" dynamic="true" header-dialog="true" show-csv-button="true" show-xlsx-button="true" show-page-size="true" saved-finds="true"><entity-find entity-name="${entityName}" list="entityValueList" cache="false" use-clone="true"><search-form-inputs/></entity-find><field name="dataDocumentId"><header-field><hidden/></header-field></field><auto-fields-entity entity-name="${entityName}" field-type="find-display"/><field name="findButton"><header-field title="Find"><submit/></header-field></field></form-list></widgets><fail-widgets><label text="You are not in a group allowed to see Report ${dataDocumentId}" type="h5"/></fail-widgets></section></widgets><fail-widgets><label text="Please select a report" type="h5"/></fail-widgets></section></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/SimpleReport.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Report Builder" default-menu-index="30" menu-image="fa fa-database" menu-image-type="icon"><subscreens default-item="FindReport"/><pre-actions><set field="excludeFilter" value="(moqui\\.).*"/></pre-actions><widgets><subscreens-panel id="SimpleReportPanel" type="tab"/></widgets></screen>
<!-- Screen Location component://MarbleERP/screen/marble.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Marble ERP" menu-image="fa fa-cogs" menu-image-type="icon" server-static="vuet,qvt"><always-actions><set field="appRoot" value="marble"/><set field="searchIndexName" value="mantle"/><set field="searchLinkSets" value="marble"/><set field="searchProductDocType" value="MantleProduct"/><set field="searchPartyDocType" value="MantleParty"/><set field="appUserGroupTypeEnumId" value="UgtMarbleErp"/><service-call name="mantle.party.PartyServices.setup#UserOrganizationInfo" out-map="context"/></always-actions><subscreens default-item="dashboard" always-use-full-path="true"><subscreens-item name="QuickSearch" location="component://SimpleScreens/screen/SimpleScreens/QuickSearch.xml" menu-index="2"/><subscreens-item name="Accounting" location="component://SimpleScreens/screen/SimpleScreens/Accounting.xml" menu-index="10"/><subscreens-item name="Asset" location="component://SimpleScreens/screen/SimpleScreens/Asset.xml" menu-index="10"/><subscreens-item name="Catalog" location="component://SimpleScreens/screen/SimpleScreens/Catalog.xml" menu-index="10"/><subscreens-item name="Customer" location="component://SimpleScreens/screen/SimpleScreens/Customer.xml" menu-index="10"/><subscreens-item name="Facility" location="component://SimpleScreens/screen/SimpleScreens/Facility.xml" menu-index="10"/><subscreens-item name="HumanRes" location="component://SimpleScreens/screen/SimpleScreens/HumanRes.xml" menu-index="10"/><subscreens-item name="Manufacturing" location="component://SimpleScreens/screen/SimpleScreens/Manufacturing.xml" menu-index="10"/><subscreens-item name="Order" location="component://SimpleScreens/screen/SimpleScreens/Order.xml" menu-index="10"/><subscreens-item name="Party" location="component://SimpleScreens/screen/SimpleScreens/Party.xml" menu-index="10"/><subscreens-item name="Project" location="component://SimpleScreens/screen/SimpleScreens/Project.xml" menu-index="10"/><subscreens-item name="ProductStore" location="component://SimpleScreens/screen/SimpleScreens/ProductStore.xml" menu-index="10"/><subscreens-item name="Gateway" location="component://SimpleScreens/screen/SimpleScreens/Gateway.xml" menu-include="false"/><subscreens-item name="Request" location="component://SimpleScreens/screen/SimpleScreens/Request.xml" menu-index="10"/><subscreens-item name="Return" location="component://SimpleScreens/screen/SimpleScreens/Return.xml" menu-index="10"/><subscreens-item name="Shipment" location="component://SimpleScreens/screen/SimpleScreens/Shipment.xml" menu-index="10"/><subscreens-item name="Shipping" location="component://SimpleScreens/screen/SimpleScreens/Shipping.xml" menu-index="10"/><subscreens-item name="Supplier" location="component://SimpleScreens/screen/SimpleScreens/Supplier.xml" menu-index="10"/><subscreens-item name="Survey" location="component://SimpleScreens/screen/SimpleScreens/Survey.xml" menu-index="10"/><subscreens-item name="Task" location="component://SimpleScreens/screen/SimpleScreens/Task.xml" menu-index="10"/><subscreens-item name="Wiki" location="component://SimpleScreens/screen/SimpleScreens/Wiki.xml" menu-index="10"/><subscreens-item name="QuickViewReport" menu-title="Custom Reports" menu-index="30" location="component://SimpleScreens/screen/SimpleScreens/SimpleReport/QuickViewReport.xml"/><subscreens-item name="SimpleReport" menu-title="Report Builder" menu-index="31" location="component://SimpleScreens/screen/SimpleScreens/SimpleReport.xml"/></subscreens><widgets><section name="OrgChooserSection" condition="hideNav != 'true'"><widgets><render-mode><text type="html"><![CDATA[<div id="active-org-menu" class="nav navbar-right dropdown"><a id="active-org-menu-link" href="#" class="dropdown-toggle btn btn-default btn-sm navbar-btn" data-toggle="dropdown" title="Organization"><i class="fa fa-globe"></i> ${(activeOrg.pseudoId)!}</a><ul class="dropdown-menu"><#if activeOrg?has_content><li><a href="${sri.buildUrl('/apps/setPrefGoLast').url}?preferenceKey=ACTIVE_ORGANIZATION&preferenceValue=">Clear Active Organization</a></li></#if><#if userOrgList?has_content><#list userOrgList as userOrg><li><a href="${sri.buildUrl('/apps/setPrefGoLast').url}?preferenceKey=ACTIVE_ORGANIZATION&preferenceValue=${userOrg.partyId}">${userOrg.pseudoId}: ${userOrg.organizationName}</a></li></#list></#if></ul></div><script>$("#navbar-buttons").append($("#active-org-menu")); $('#active-org-menu-link').tooltip({ placement:'bottom', trigger:'hover' });</script>]]></text></render-mode></widgets></section><subscreens-panel id="MarbleErpPanel" type="popup" title="Marble ERP"/></widgets></screen>
<!-- Screen Location component://HiveMind/screen/HiveMindRoot/dashboard/MyMilestones.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><transition name="projectSummary"><default-response url="../../Project/ProjectSummary"/></transition><transition name="milestoneSummary"><default-response url="../../Project/MilestoneSummary"/></transition><actions><entity-find entity-name="WorkEffortAndRootByParty" list="myMilestoneList" distinct="true"><date-filter/><econdition field-name="partyId" from="ec.user.userAccount.partyId"/><econdition field-name="rootWorkEffortTypeEnumId" value="WetProject"/><econdition field-name="rootStatusId" operator="not-in" value="WeClosed,WeCancelled"/><econdition field-name="workEffortTypeEnumId" value="WetMilestone"/><econdition field-name="statusId" operator="not-in" value="WeClosed,WeCancelled"/><select-field field-name="rootWorkEffortId,workEffortId,workEffortName,estimatedStartDate,statusId"/><order-by field-name="estimatedStartDate,workEffortId"/></entity-find></actions><widgets><form-list name="MyMilestones" list="myMilestoneList"><field name="rootWorkEffortId"><default-field title="Project"><link url="projectSummary" text="${rootWorkEffortId?:'--'}"><parameter name="workEffortId" from="rootWorkEffortId"/></link></default-field></field><field name="workEffortId"><default-field title="Milestone"><link url="milestoneSummary" text="${workEffortId}"><parameter name="milestoneWorkEffortId" from="workEffortId"/></link></default-field></field><field name="workEffortName"><default-field title="Name"><display/></default-field></field><field name="estimatedStartDate"><default-field title="Start"><display format="yyyy-MM-dd"/></default-field></field><field name="estimatedCompletionDate"><default-field title="Due"><display format="yyyy-MM-dd"/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="StatusItem" text="${description}"/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://HiveMind/screen/HiveMindRoot/dashboard/MyProjects.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><transition name="projectSummary"><default-response url="../../Project/ProjectSummary"/></transition><widgets><form-list name="MyProjectList" list="myProjectList"><entity-find entity-name="mantle.work.effort.WorkEffortAndParty" list="myProjectList" distinct="true"><econditions combine="or"><econdition field-name="visibilityEnumId" operator="in" value="WevGeneral,WevAllUsers"/><econditions><date-filter/><econdition field-name="partyId" from="ec.user.userAccount.partyId"/></econditions></econditions><econdition field-name="workEffortTypeEnumId" value="WetProject"/><select-field field-name="workEffortId,workEffortName,estimatedStartDate,statusId"/><order-by field-name="workEffortId"/></entity-find><field name="workEffortId"><default-field title="ID"><link url="projectSummary" text="${workEffortId}"/></default-field></field><field name="workEffortName"><default-field title="Name"><display/></default-field></field><field name="estimatedStartDate"><default-field title="Start"><display format="yyyy-MM-dd"/></default-field></field><field name="estimatedCompletionDate"><default-field title="Due"><display format="yyyy-MM-dd"/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="StatusItem" text="${description}"/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://HiveMind/screen/HiveMindRoot/dashboard/MyRequests.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><transition name="createRequest"><service-call name="mantle.request.RequestServices.create#Request" in-map="context" out-map="context" multi="parameter"/><default-response url=".."/></transition><transition name="findRequest"><default-response url="../../Request/FindRequest"/></transition><transition name="editRequest"><default-response url="../../Request/EditRequest"/></transition><transition name="projectSummary"><default-response url="../../Project/ProjectSummary"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><widgets><container id="dashboard-requests-section"><container-box><box-header title="My Open Requests"/><box-toolbar><link url="findRequest" text="Find Request"/><container-dialog id="NewRequestContainer" button-text="New Request"><form-single name="NewRequest" transition="createRequest" extends="component://SimpleScreens/screen/SimpleScreens/Request/FindRequest.xml#NewRequestForm"/></container-dialog></box-toolbar><box-body><form-list name="MyRequests" list="myRequestList"><entity-find entity-name="mantle.request.RequestAndParty" list="myRequestList" distinct="true"><date-filter/><econdition field-name="partyId" from="ec.user.userAccount.partyId"/><econdition field-name="statusId" operator="not-in" value="ReqCompleted,ReqCancelled"/><select-field field-name="requestName"/><order-by field-name="priority"/></entity-find><row-actions><entity-find entity-name="mantle.request.RequestParty" list="clientRpList"><date-filter/><econdition field-name="requestId"/><econdition field-name="roleTypeId" operator="in" value="Customer,CustomerBillTo"/></entity-find><set field="clientRp" from="clientRpList?.getAt(0)"/></row-actions><field name="priority"><default-field><display also-hidden="false"/></default-field></field><field name="requestId"><default-field title="Request"><link url="editRequest" text="RequestNameTemplate" link-type="anchor"/></default-field></field><field name="rootWorkEffortId"><default-field title="Project"><link url="projectSummary" text="${rootWorkEffortId}" link-type="anchor" condition="rootWorkEffortId"/></default-field></field><field name="clientPartyId" from="clientRp?.partyId"><default-field title="Client"><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameTemplate"/></default-field></field><field name="requestTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration" also-hidden="false"/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem" also-hidden="false"/></default-field></field><field name="requestResolutionEnumId"><default-field title="Resolution"><display-entity entity-name="moqui.basic.Enumeration" also-hidden="false"/></default-field></field></form-list></box-body></container-box></container></widgets></screen>
<!-- Screen Location component://HiveMind/screen/HiveMindRoot/dashboard/MyTasks.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><transition name="createTask"><service-call name="mantle.work.TaskServices.create#Task" in-map="context" out-map="context" multi="parameter"/><default-response url=".."/></transition><transition name="findTask"><default-response url="../../Task/FindTask"/></transition><transition name="editTask"><default-response url="../../Task/TaskSummary"/></transition><transition name="myProjects"><default-response url="../MyProjects"/></transition><transition name="myMilestones"><default-response url="../MyMilestones"/></transition><transition name="projectSummary"><default-response url="../../Project/ProjectSummary"/></transition><transition name="milestoneSummary"><default-response url="../../Project/MilestoneSummary"/></transition><transition name="getProjectParties"><service-call name="mantle.work.ProjectServices.get#ProjectParties" web-send-json-response="resultList" in-map="true" out-map="context" multi="parameter"/><default-response type="none"/></transition><transition name="getProjectMilestones"><service-call name="mantle.work.ProjectServices.get#ProjectMilestones" web-send-json-response="resultList" in-map="true" out-map="context" multi="parameter"/><default-response type="none"/></transition><transition-include name="getTaskList" location="component://SimpleScreens/template/work/WorkTransitions.xml"/><actions><entity-find entity-name="mantle.work.effort.WorkEffortAndParty" list="myProjectList"><econditions combine="or"><econdition field-name="visibilityEnumId" operator="in" value="WevGeneral,WevAllUsers"/><econditions><date-filter/><econdition field-name="partyId" from="ec.user.userAccount.partyId"/></econditions></econditions><econdition field-name="workEffortTypeEnumId" value="WetProject"/><order-by field-name="workEffortId"/></entity-find></actions><widgets><container id="dashboard-tasks-section"><container-box><box-header title="My Open Tasks"/><box-toolbar><dynamic-dialog id="MyProjectsContainer" button-text="My Projects" transition="myProjects"/><dynamic-dialog id="MyMilestonesContainer" button-text="My Milestones" transition="myMilestones"/><link url="findTask" text="Find Task"/><container-dialog id="NewTaskContainer" button-text="New Task"><form-single name="NewTaskForm" transition="createTask" extends="component://SimpleScreens/screen/SimpleScreens/Task/FindTask.xml#NewTaskForm"/></container-dialog></box-toolbar><box-body><form-list name="MyTasks" list="myTaskList"><entity-find entity-name="mantle.work.effort.PartyTaskSummary" list="myTaskList" distinct="true"><date-filter/><econdition field-name="partyId" from="ec.user.userAccount.partyId"/><econdition field-name="statusId" operator="not-in" value="WeClosed,WeCancelled"/><econdition field-name="purposeEnumId" operator="not-equals" value="WepPlaceholder"/><econdition field-name="partyStatusId" operator="in" value="WeptAssigned,WeptArrived"/><select-field field-name="workEffortName"/><order-by field-name="priority,milestoneEstimatedStartDate"/></entity-find><field name="priority"><default-field title="Pri"><display/></default-field></field><field name="workEffortId"><default-field title="Task"><link text="WorkEffortNameTemplate" url="editTask" link-type="anchor"/></default-field></field><field name="rootWorkEffortId"><default-field title="Project"><link url="projectSummary" text="${rootWorkEffortId}" link-type="anchor" condition="rootWorkEffortId"/></default-field></field><field name="milestoneWorkEffortId"><default-field title="Milestone"><link text="${milestoneWorkEffortId?:''}" url="milestoneSummary" link-type="anchor"/></default-field></field><field name="purposeEnumId"><default-field title="Purpose"><display-entity entity-name="moqui.basic.Enumeration" also-hidden="false"/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="estimatedCompletionDate"><default-field title="Due"><display format="yyyy-MM-dd"/></default-field></field><field name="estimatedWorkTime"><default-field title="Est"><display format="0.00"/></default-field></field><field name="remainingWorkTime"><default-field title="Rem"><display format="0.00"/></default-field></field><field name="actualWorkTime"><default-field title="Act"><display format="0.00"/></default-field></field></form-list></box-body></container-box></container></widgets></screen>
<!-- Screen Location component://HiveMind/screen/HiveMindRoot/dashboard/MyWikiSpaces.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><actions><service-call name="org.moqui.impl.WikiServices.get#UserWikiSpaces" in-map="[userId:ec.user.userId]" out-map="context"/></actions><widgets><container id="dashboard-wiki-section"><container-box><box-header title="Wiki Spaces"/><box-body><section-iterate name="WikiSpaces" list="wikiSpaceAndUserList" entry="wikiSpace"><widgets><container><link text="${wikiSpace.wikiSpaceId}: ${wikiSpace.description}" url="/apps/hm/wiki/${wikiSpace.wikiSpaceId}" link-type="anchor"/></container></widgets></section-iterate></box-body></container-box></container></widgets></screen>
<!-- Screen Location component://HiveMind/screen/HiveMindRoot/dashboard/QuickSearch.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><transition name="search"><default-response url="../../Search"/></transition><transition name="getSearchOptions"><actions><script><![CDATA[queryString = (term.split(' ') as List).collect({ it.matches(/\w*/) ? (it + '*') : it }).join(' ')]]></script><service-call name="org.moqui.search.SearchServices.search#DataDocuments" out-map="context" in-map="[queryString:queryString, indexName:'mantle', documentType:'MantleWikiPage,MantleProject,MantleTask,MantleRequest']"/><set field="outList" from="[]"/><iterate list="documentList" entry="document"><entity-find-one entity-name="moqui.entity.document.DataDocument" value-field="dataDocument" cache="true"><field-map field-name="dataDocumentId" from="document._type"/></entity-find-one><if condition="!dataDocument"><log message="DataDocument not found for document:\n${document}"/><continue/></if><entity-find entity-name="moqui.entity.document.DataDocumentLink" list="ddLinkList" cache="true"><econdition field-name="dataDocumentId" from="document._type"/><econdition field-name="linkSet" value="hm"/><econdition field-name="linkCondition" operator="is-null"/></entity-find><set field="dataDocumentLink" from="ddLinkList ? ddLinkList[0] : null"/><set field="linkUrl" from="ec.resource.expand(dataDocumentLink?.linkUrl, '', document)"/><if condition="dataDocumentLink?.urlType == 'transition' || dataDocumentLink?.urlType == 'screen'"><then><set field="linkUrlInstance" from="org.moqui.impl.screen.ScreenUrlInfo.getScreenUrlInfo(sri, null, null, linkUrl, 0).getInstance(sri, true)"/><set field="urlToOpen" from="linkUrlInstance.pathWithParams"/></then><else><set field="urlToOpen" from="ec.web.getWebappRootUrl(false, null) + ec.resource.expand(dataDocumentLink?.linkUrl, '', document)"/></else></if><set field="documentTitle" from="ec.resource.expand(dataDocument.documentTitle, '', document)"/><script><![CDATA[outList.add([value:document._id, urlToOpen:urlToOpen, label:"${dataDocument.documentName} - ${document._id}: ${documentTitle}".toString()])]]></script></iterate><script><![CDATA[ec.web.sendJsonResponse(outList)]]></script></actions><default-response type="none"/></transition><widgets><container id="dashboard-search-section"><container-box><box-header title="Quick Search"/><box-body><render-mode><text type="html,vuet"><![CDATA[<input type="text" id="SearchBox" class="form-control typeahead" style="width:100%;"><script>
        $("#SearchBox").typeahead({ minLength:2, highlight:true, hint:false }, { limit:20, display: function(item) { return item.label; },
            source: function(query, syncResults, asyncResults) {
                if (window.qsDelayTimeout) { clearTimeout(window.qsDelayTimeout); }
                window.qsDelayTimeout = setTimeout(function() { $.ajax({
                    url: "${sri.screenUrlInstance.url}/getSearchOptions", type: "POST", dataType: "json", data: { term:query, moquiSessionToken:"${ec.web.sessionToken}" },
                    success: function(data) { asyncResults($.map(data, function(item) { return { label:item.label, value:item.value, urlToOpen:item.urlToOpen } })); }
                }); }, 300);
            }
        });
        $("#SearchBox").focus();
    </script>]]></text></render-mode><render-mode><text type="html"><![CDATA[<script>$("#SearchBox").bind('typeahead:select', function(event, item) { if (item && item.urlToOpen) { window.open(item.urlToOpen, "_self"); } });</script>]]></text><text type="vuet"><![CDATA[<m-script>$("#SearchBox").bind('typeahead:select', function(event, item) { if (item && item.urlToOpen) { moqui.webrootVue.setUrl(item.urlToOpen); } });</m-script>]]></text><text type="qvt"><![CDATA[<m-drop-down options-url="${sri.screenUrlInstance.url}/getSearchOptions" server-search :server-min-length="2" on-select-go-to="urlToOpen"></m-drop-down>]]></text></render-mode><container><link url="search" text="Full Search" link-type="anchor"/></container></box-body></container-box></container></widgets></screen>
<!-- Screen Location component://HiveMind/screen/HiveMindRoot/dashboard.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Dashboard" default-menu-index="1" menu-image="fa fa-dashboard" menu-image-type="icon"><widgets><container-row><row-col md="2"><section name="DashboardLeft"><widgets><dynamic-container id="QuickSearchContainer" transition="QuickSearch"/><container style="text-center"><container><link url="../Project" link-type="anchor"><image url="/ssstatic/images/project-business120.png" url-type="screen" style="invertible" width="40"/></link><link text="Projects" url="../Project" link-type="anchor"/></container><container><link url="../Task" link-type="anchor"><image url="/ssstatic/images/task-homework.png" url-type="screen" style="invertible" width="40"/></link><link text="Tasks" url="../Task" link-type="anchor"/></container><container><link url="../Request" link-type="anchor"><image url="/hmstatic/images/request-inspiration.png" url-type="screen" style="invertible" width="40"/></link><link text="Requests" url="../Request" link-type="anchor"/></container><section name="QuickInfoSection"><actions><entity-find-count entity-name="mantle.request.Request" count-field="requestSubmittedCount"><econdition field-name="statusId" value="ReqSubmitted"/></entity-find-count><entity-find-count entity-name="mantle.request.Request" count-field="requestInProgressCount"><econdition field-name="statusId" operator="in" from="['ReqSubmitted', 'ReqReviewed', 'ReqInProgress']"/></entity-find-count></actions><widgets><link url="../Request" parameter-map="[statusId:'ReqSubmitted']" text="New##Requests" badge="${requestSubmittedCount}" btn-type="default"/><link url="../Request" parameter-map="[statusId:'ReqSubmitted,ReqReviewed,ReqInProgress', statusId_op:'in']" text="Open##Requests" badge="${requestInProgressCount}" btn-type="default"/></widgets></section></container><dynamic-container id="MyWikiSpacesContainer" transition="MyWikiSpaces"/></widgets></section></row-col><row-col md="10"><section name="DashboardCenter"><widgets><dynamic-container id="MyTasksContainer" transition="MyTasks"/><dynamic-container id="MyRequestsContainer" transition="MyRequests"/></widgets></section></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Search.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-index="2" menu-image="fa fa-search" menu-image-type="icon"><actions><set field="indexName" from="searchIndexName"/><set field="originalQueryString" from="queryString"/><if condition="queryString"><service-call name="mantle.GeneralServices.search#MantleFiltered" in-map="context" out-map="context"/></if></actions><widgets><link url="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-query-string-query.html#query-string-syntax" url-type="plain" link-type="anchor" target-window="_blank" text="Search String Reference"/><form-single name="SearchOptions" transition="." focus-field="queryString"><field name="documentType"><default-field title=""><drop-down no-current-selected-key=" "><option key=" " text="Any Type"/><entity-options key="${dataDocumentId}" text="${documentName}"><entity-find entity-name="moqui.entity.document.DataDocument" cache="true"><econdition field-name="indexName" from="searchIndexName"/><order-by field-name="documentName"/></entity-find></entity-options></drop-down></default-field></field><field name="queryString" from="originalQueryString"><default-field title="" tooltip="Matches whole words, use the asterisk (*) wildcard to match partial words; use field:term to search a specific field"><text-line size="60"/></default-field></field><field name="submitButton"><default-field title="Search"><submit/></default-field></field><field-layout><field-row-big><field-ref name="documentType"/><field-ref name="queryString"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single><section-iterate name="messageInfos" list="ec.message.messageInfos" entry="messageInfo"><widgets><container><label text="${messageInfo.message}" type="strong" style="text-${messageInfo.typeString}"/></container></widgets></section-iterate><form-list name="SearchResults" list="documentList"><row-actions><entity-find-one entity-name="moqui.entity.document.DataDocument" value-field="dataDocument" cache="true"><field-map field-name="dataDocumentId" from="_type"/></entity-find-one><set field="documentTitle" from="ec.resource.expand(dataDocument?.documentTitle, '')"/><entity-find entity-name="moqui.entity.document.DataDocumentLink" list="ddLinkList" cache="true"><econdition field-name="dataDocumentId" from="_type"/><econdition field-name="linkSet" operator="in" from="searchLinkSets"/></entity-find><set field="linksList" from="[]"/><iterate list="ddLinkList" entry="ddLink"><if condition="!ddLink.linkCondition || ec.resource.condition(ddLink.linkCondition, '')"><script><![CDATA[linksList.add(ddLink)]]></script></if></iterate></row-actions><field name="type"><default-field><display text="${dataDocument.documentName}"/></default-field></field><field name="id"><default-field><display text="${_id}"/></default-field></field><field name="documentTitle"><default-field title="Title"><display/></default-field></field><field name="link"><default-field><section-iterate name="LinksListSection" list="linksList" entry="ddLink"><widgets><link url="${ec.resource.expand(ddLink.linkUrl, null)}" text="${ec.resource.expand(ddLink.label, null)}" link-type="anchor" url-type="${ddLink.urlType?:'plain'}"/></widgets></section-iterate></default-field></field></form-list><label text="Full search string: ${queryString?:''}" type="p"/></widgets></screen>
<!-- Screen Location component://HiveMind/screen/HiveMindRoot/Project/FindProject.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="findProject"><default-response url="."/></transition><transition name="projectSummary"><default-response url="../ProjectSummary"/></transition><pre-actions><set field="html_title" value="Find Project"/></pre-actions><actions><entity-find entity-name="WorkEffortAndParty" list="projectList" distinct="true"><search-form-inputs default-order-by="workEffortId"/><econditions combine="or"><econdition field-name="visibilityEnumId" operator="in" value="WevGeneral,WevAllUsers"/><econditions><date-filter/><econdition field-name="partyId" from="ec.user.userAccount.partyId"/></econditions></econditions><econdition field-name="workEffortTypeEnumId" value="WetProject"/><select-field field-name="workEffortId,workEffortName,priority,statusId,estimatedCompletionDate,estimatedWorkTime,actualWorkTime"/><order-by field-name="workEffortId"/></entity-find></actions><widgets><container><container-dialog id="FindProjectDialog" button-text="Search Projects" width="700"><form-single name="FindProjects" transition="findProject"><field name="workEffortId"><default-field title="Project ID"><text-find/></default-field></field><field name="workEffortName"><default-field title="Name"><text-find/></default-field></field><field name="priority"><default-field><range-find/></default-field></field><field name="statusId"><default-field title="Status"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="WorkEffort"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="estimatedCompletionDate"><default-field title="Due Date"><date-period/></default-field></field><field name="estimatedWorkTime"><default-field title="Estimated Hours"><range-find/></default-field></field><field name="actualWorkTime"><default-field title="Actual Hours"><range-find/></default-field></field><field name="searchButton"><default-field title="Find Project"><submit/></default-field></field></form-single></container-dialog></container><form-list name="ListProjects" list="projectList"><field name="workEffortId"><header-field title="Project" show-order-by="case-insensitive"/><default-field><link url="projectSummary" text="${workEffortId}"/></default-field></field><field name="workEffortName"><header-field title="Name" show-order-by="case-insensitive"/><default-field><display also-hidden="false"/></default-field></field><field name="priority"><header-field show-order-by="true"/><default-field><display/></default-field></field><field name="statusId"><header-field title="Status" show-order-by="true"/><default-field><display-entity entity-name="moqui.basic.StatusItem" also-hidden="false"/></default-field></field><field name="estimatedCompletionDate"><header-field title="Due Date" show-order-by="true"/><default-field><display format="yyyy-MM-dd"/></default-field></field><field name="estimatedWorkTime"><default-field title="Estimated Hours"><display format="0.00"/></default-field></field><field name="actualWorkTime"><default-field title="Actual Hours"><display format="0.00"/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://HiveMind/screen/HiveMindRoot/Project/MilestoneSummary.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><parameter name="milestoneWorkEffortId" required="true"/><parameter name="milestoneWorkEffortId_0"/><transition name="projectSummary"><default-response url="../ProjectSummary"/></transition><transition name="editTask"><default-response url="../../Task/TaskSummary"/></transition><transition name="updateTask"><service-call name="mantle.work.TaskServices.update#Task" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><pre-actions><set field="milestoneWorkEffortId" from="milestoneWorkEffortId ?: milestoneWorkEffortId_0"/></pre-actions><actions><entity-find-one entity-name="mantle.work.effort.WorkEffort" value-field="milestoneWorkEffort"><field-map field-name="workEffortId" from="milestoneWorkEffortId"/></entity-find-one><entity-find entity-name="WorkEffortAssocAndTo" list="inactiveTaskList"><econdition field-name="fromWorkEffortId" from="milestoneWorkEffortId"/><econdition field-name="workEffortTypeEnumId" value="WetTask"/><econdition field-name="purposeEnumId" operator="not-equals" value="WepPlaceholder"/><econdition field-name="statusId" operator="in" value="WeInPlanning,WeApproved,WeOnHold"/><date-filter/><order-by field-name="priority"/><order-by field-name="estimatedCompletionDate"/></entity-find><entity-find entity-name="WorkEffortAssocAndTo" list="activeTaskList"><econdition field-name="fromWorkEffortId" from="milestoneWorkEffortId"/><econdition field-name="workEffortTypeEnumId" value="WetTask"/><econdition field-name="purposeEnumId" operator="not-equals" value="WepPlaceholder"/><econdition field-name="statusId" value="WeInProgress"/><date-filter/><order-by field-name="priority"/><order-by field-name="estimatedCompletionDate"/></entity-find><entity-find entity-name="WorkEffortAssocAndTo" list="doneTaskList"><econdition field-name="fromWorkEffortId" from="milestoneWorkEffortId"/><econdition field-name="workEffortTypeEnumId" value="WetTask"/><econdition field-name="purposeEnumId" operator="not-equals" value="WepPlaceholder"/><econdition field-name="statusId" operator="in" value="WeComplete,WeClosed"/><date-filter/><order-by field-name="priority"/><order-by field-name="estimatedCompletionDate"/></entity-find></actions><widgets><label text="Summary for Milestone "${milestoneWorkEffort.workEffortName}" - ${milestoneWorkEffortId}" type="h3"/><link text="Project Summary" url="projectSummary" link-type="anchor-button"><parameter name="rootWorkEffortId" from="milestoneWorkEffort.rootWorkEffortId"/></link><label text="Inactive Tasks" type="h4"/><form-list name="InactiveTaskList" list="inactiveTaskList" transition="updateTask" multi="true" extends="component://SimpleScreens/screen/SimpleScreens/Project/MilestoneSummary.xml#InactiveTaskList"/><label text="Active Tasks" type="h4"/><form-list name="ActiveTaskList" list="activeTaskList" transition="updateTask" extends="InactiveTaskList"/><label text="Completed Tasks" type="h4"/><form-list name="DoneTaskList" list="doneTaskList" transition="updateTask" extends="InactiveTaskList"/></widgets></screen>
<!-- Screen Location component://HiveMind/screen/HiveMindRoot/Project/ProjectSummary.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd"><parameter name="workEffortId" from="rootWorkEffortId ?: workEffortId" required="true"/><parameter name="rootWorkEffortId" from="rootWorkEffortId ?: workEffortId"/><transition name="editClient"><default-response url="//hmadmin/Client/EditClient"/></transition><transition name="editVendor"><default-response url="//hmadmin/Vendor/EditVendor"/></transition><transition name="editUser"><default-response url="//hmadmin/User/EditUser"/></transition><transition name="milestoneSummary"><default-response url="../MilestoneSummary"/></transition><transition name="taskSummary"><default-response url="../../Task/TaskSummary"/></transition><pre-actions><if condition="rootWorkEffortId"><set field="workEffortId" from="rootWorkEffortId"/></if><set field="rootWorkEffortId" from="workEffortId"/></pre-actions><actions><entity-find-one entity-name="mantle.work.effort.WorkEffort" value-field="workEffort"/><entity-find entity-name="mantle.work.effort.WorkEffortParty" list="clientWepList"><date-filter/><econdition field-name="workEffortId"/><econdition field-name="roleTypeId" operator="in" value="Customer,CustomerBillTo"/></entity-find><set field="clientWep" from="clientWepList?.getAt(0)"/><entity-find entity-name="mantle.work.effort.WorkEffortParty" list="vendorWepList"><date-filter/><econdition field-name="workEffortId"/><econdition field-name="roleTypeId" operator="in" value="Vendor,VendorBillFrom"/></entity-find><set field="vendorWep" from="vendorWepList?.getAt(0)"/><entity-find entity-name="WorkEffort" list="milestoneList"><econdition field-name="rootWorkEffortId"/><econdition field-name="workEffortTypeEnumId" value="WetMilestone"/><order-by field-name="estimatedStartDate"/></entity-find><entity-find entity-name="mantle.work.effort.WikiPageAndWorkEffort" list="wpaweList"><econdition field-name="workEffortId"/></entity-find><entity-find entity-name="mantle.work.effort.WorkEffortPartyAndPerson" list="wepapList"><econdition field-name="workEffortId" from="rootWorkEffortId"/></entity-find></actions><widgets><container-row><row-col md="6"><label text="${workEffort.workEffortId}: ${workEffort.workEffortName}" type="strong"/><tree name="TaskTree"><tree-node name="TaskNode"><actions/><link url="taskSummary" text="${nodeList_entry.workEffortId}: ${nodeList_entry.workEffortName} - ${nodeList_entry.statusDescription?:''}${nodeList_entry.priority ? ' - P ' + nodeList_entry.priority : ''}" id="${treeNodeId == '#' ? '' : treeNodeId + '/'}${nodeList_entry.workEffortId}"><parameter name="workEffortId" from="nodeList_entry.workEffortId"/></link><tree-sub-node node-name="TaskNode" list="childTasks"><actions><set field="taskId" from="treeNodeId.split('/').last()"/><entity-find entity-name="mantle.work.effort.WorkEffortAndStatus" list="childTasks"><econdition field-name="workEffortTypeEnumId" value="WetTask"/><econdition field-name="parentWorkEffortId" from="taskId"/><order-by field-name="statusSequenceNum,priority,workEffortName"/></entity-find></actions></tree-sub-node></tree-node><tree-sub-node node-name="TaskNode" list="topLevelTasks"><actions><entity-find entity-name="mantle.work.effort.WorkEffortAndStatus" list="topLevelTasks"><econdition field-name="workEffortTypeEnumId" value="WetTask"/><econdition field-name="rootWorkEffortId"/><econdition field-name="parentWorkEffortId" from="null"/><order-by field-name="statusSequenceNum,priority,workEffortName"/></entity-find></actions></tree-sub-node></tree></row-col><row-col md="6"><form-single name="ViewProject" map="workEffort"><field name="clientPartyId" from="clientWep?.partyId"><default-field title="Client"><display-entity entity-name="mantle.party.PartyDetail" key-field-name="partyId" text="${organizationName?:''} ${firstName?:''} ${lastName?:''}"/><link url="editClient" text="Edit Client" link-type="anchor"><parameter name="partyId" from="clientWep?.partyId"/></link></default-field></field><field name="vendorPartyId" from="vendorWep?.partyId"><default-field title="Vendor"><display-entity entity-name="mantle.party.PartyDetail" key-field-name="partyId" text="${organizationName?:''} ${firstName?:''} ${lastName?:''}"/><link url="editVendor" text="Edit Vendor" link-type="anchor"><parameter name="partyId" from="vendorWep?.partyId"/></link></default-field></field><field name="priority"><default-field><display/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="statusFlowId"><default-field title="Status Flow"><display-entity entity-name="moqui.basic.StatusFlow"/></default-field></field><field name="estimatedCompletionDate"><default-field title="Due Date"><display format="yyyy-MM-dd"/></default-field></field><field name="estimatedWorkTime"><default-field title="Estimated Hours"><display format="0.00"/></default-field></field><field name="actualWorkTime"><default-field title="Actual Hours"><display format="0.00"/></default-field></field><field name="description"><default-field title="Description"><display/></default-field></field><field-layout><fields-not-referenced/><field-row><field-ref name="clientPartyId"/><field-ref name="vendorPartyId"/></field-row><field-row><field-ref name="priority"/><field-ref name="estimatedCompletionDate"/></field-row><field-row><field-ref name="statusId"/><field-ref name="statusFlowId"/></field-row><field-row><field-ref name="estimatedWorkTime"/><field-ref name="actualWorkTime"/></field-row><field-ref name="description"/></field-layout></form-single><form-list name="MilestoneList" list="milestoneList" skip-form="true"><field name="rootWorkEffortId"><default-field><hidden/></default-field></field><field name="workEffortId"><default-field title="Milestone"><link url="milestoneSummary" text="${workEffortId}" link-type="anchor"><parameter name="milestoneWorkEffortId" from="workEffortId"/></link></default-field></field><field name="workEffortName"><default-field title="Name"><display/></default-field></field><field name="estimatedStartDate"><default-field title="Start Date"><display format="yyyy-MM-dd"/></default-field></field><field name="estimatedCompletionDate"><default-field title="End Date"><display format="yyyy-MM-dd"/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field></form-list><form-list name="ViewWpweForm" list="wpaweList" skip-form="true"><field name="workEffortId"><default-field><hidden/></default-field></field><field name="rootWorkEffortId" from="projectWorkEffortId"><default-field><hidden/></default-field></field><field name="wikiPageId"><default-field><hidden/></default-field></field><field name="wikiSpaceId"><default-field title="Wiki Space"><display text=""/><link text="${wikiSpaceId}" url="/apps/hm/wiki/${wikiSpaceId}"/></default-field></field><field name="pagePath"><default-field title="Page"><display text=""/><link text="${pagePath}" url="/apps/hm/wiki/${wikiSpaceId}/${pagePath?:''}"/></default-field></field></form-list><form-list name="ViewUserAssignForm" list="wepapList" skip-form="true"><field name="rootWorkEffortId"><default-field><hidden/></default-field></field><field name="workEffortId"><default-field><hidden/></default-field></field><field name="partyId"><default-field><hidden/></default-field></field><field name="username"><header-field show-order-by="case-insensitive"/><default-field><link url="editUser" text="${username?:'--'}" link-type="anchor"/></default-field></field><field name="firstName"><header-field title="First##Name" show-order-by="case-insensitive"/><default-field><display also-hidden="false"/></default-field></field><field name="lastName"><header-field title="Last##Name" show-order-by="case-insensitive"/><default-field><display also-hidden="false"/></default-field></field><field name="roleTypeId"><header-field title="Role" show-order-by="true"/><default-field><display-entity entity-name="mantle.party.RoleType"/></default-field></field><field name="fromDate"><header-field show-order-by="true"/><default-field><display format="yyyy-MM-dd"/></default-field></field><field name="thruDate"><header-field show-order-by="true"/><default-field><display format="yyyy-MM-dd"/></default-field></field><field name="expectationEnumId"><header-field title="Expectation" show-order-by="true"/><default-field><display-entity entity-name="moqui.basic.Enumeration" key-field-name="enumId"/></default-field></field><field name="emplPositionClassId"><header-field title="Position Class" show-order-by="true"/><default-field><display-entity entity-name="EmplPositionClass" text="${title}"/></default-field></field><field name="statusId"><header-field title="Status" show-order-by="true"/><default-field><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><form-list-column><field-ref name="username"/><field-ref name="roleTypeId"/></form-list-column><form-list-column><field-ref name="firstName"/><field-ref name="lastName"/></form-list-column><form-list-column><field-ref name="fromDate"/><field-ref name="thruDate"/></form-list-column><form-list-column><field-ref name="expectationEnumId"/><field-ref name="emplPositionClassId"/></form-list-column><form-list-column><field-ref name="statusId"/></form-list-column></form-list></row-col></container-row></widgets></screen>
<!-- Screen Location component://HiveMind/screen/HiveMindRoot/Project.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Projects" default-menu-index="3" menu-image="/ssstatic/images/project-business120.png"><subscreens default-item="FindProject"/><widgets><subscreens-active/></widgets></screen>
<!-- Screen Location component://HiveMind/screen/HiveMindRoot/Request/EditWikiPages.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Wiki Pages" default-menu-index="4"><parameter name="requestId" required="true"/><transition name="addWpr"><service-call name="create#mantle.request.WikiPageRequest" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteWpr"><service-call name="delete#mantle.request.WikiPageRequest" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="getSpacePages"><actions><service-call name="org.moqui.impl.WikiServices.get#UserSpaceWikiPageSimpleList" in-map="context" out-map="context"/><script><![CDATA[ec.web.sendJsonResponse(resultList)]]></script></actions><default-response type="none"/></transition><actions><entity-find entity-name="mantle.request.WikiPageAndRequest" list="wparList"><econdition field-name="requestId"/></entity-find><service-call name="org.moqui.impl.WikiServices.get#UserWikiSpaces" in-map="[userId:ec.user.userId]" out-map="context"/></actions><widgets><container-dialog id="AddWprDialog" button-text="Add Wiki Page"><form-single name="AddWprForm" transition="addWpr"><field name="userId" from="ec.user.userId"><default-field><hidden/></default-field></field><field name="requestId"><default-field><hidden/></default-field></field><field name="wikiSpaceId"><default-field title="Space"><drop-down><list-options list="wikiSpaceAndUserList" key="${wikiSpaceId}" text="${wikiSpaceId}: ${description}"/></drop-down></default-field></field><field name="wikiPageId"><default-field title="Page"><drop-down combo-box="true"><dynamic-options transition="getSpacePages" value-field="wikiPageId" label-field="pageLabel"><depends-on field="userId"/><depends-on field="wikiSpaceId"/></dynamic-options></drop-down></default-field></field><field name="submitButton"><default-field title="Add Page"><submit/></default-field></field></form-single></container-dialog><form-list name="DeleteWprForm" list="wparList" transition="deleteWpr"><field name="requestId"><default-field><hidden/></default-field></field><field name="wikiPageId"><default-field><hidden/></default-field></field><field name="wikiSpaceId"><default-field title="Space"><display text=""/><link text="${wikiSpaceId}" url="/apps/hm/wiki/${wikiSpaceId}" link-type="anchor"/></default-field></field><field name="pagePath"><default-field title="Page"><display text=""/><link text="${pagePath}" url="/apps/hm/wiki/${wikiSpaceId}/${pagePath?:''}" link-type="anchor"/></default-field></field><field name="submitButton"><default-field title="Delete"><submit/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://HiveMind/screen/HiveMindRoot/Request.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Requests" default-menu-index="5" menu-image="/hmstatic/images/request-inspiration.png"><subscreens default-item="FindRequest"><subscreens-item name="FindRequest" menu-include="false" location="component://SimpleScreens/screen/SimpleScreens/Request/FindRequest.xml"/><subscreens-item name="EditRequest" menu-index="1" location="component://SimpleScreens/screen/SimpleScreens/Request/EditRequest.xml"/><subscreens-item name="EditUsers" menu-index="2" location="component://SimpleScreens/screen/SimpleScreens/Request/EditUsers.xml"/><subscreens-item name="EditTasks" menu-index="3" location="component://SimpleScreens/screen/SimpleScreens/Request/EditTasks.xml"/></subscreens><widgets><subscreens-panel id="task-panel" type="tab"/></widgets></screen>
<!-- Screen Location component://HiveMind/screen/HiveMindRoot.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="HiveMind PM" menu-image="fa fa-check" menu-image-type="icon"><always-actions><set field="appRoot" value="hm"/><set field="searchIndexName" value="mantle"/><set field="searchLinkSets" value="hm"/><set field="searchTaskDocType" value="MantleTask"/><set field="searchPartyDocType" value="MantleParty"/></always-actions><subscreens default-item="dashboard" always-use-full-path="true"><subscreens-item name="Search" location="component://SimpleScreens/screen/SimpleScreens/Search.xml" menu-index="2"/><subscreens-item name="Task" menu-index="4" location="component://SimpleScreens/screen/SimpleScreens/Task.xml"/><subscreens-item name="wiki" location="component://SimpleScreens/screen/SimpleScreens/Wiki/wiki.xml" menu-include="false"/><subscreens-item name="EditWikiPage" location="component://SimpleScreens/screen/SimpleScreens/Wiki/EditWikiPage.xml" menu-include="false"/><subscreens-item name="ViewWikiPage" location="component://SimpleScreens/screen/SimpleScreens/Wiki/ViewWikiPage.xml" menu-include="false"/><subscreens-item name="WikiCompare" location="component://SimpleScreens/screen/SimpleScreens/Wiki/WikiCompare.xml" menu-include="false"/></subscreens><widgets><subscreens-panel id="HiveMindPanel" type="popup" title="HiveMind PM"/></widgets></screen>
<!-- Screen Location component://HiveMind/screen/HiveMindAdmin/dashboard.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Dashboard" default-menu-index="1" menu-image="fa fa-dashboard" menu-image-type="icon"><transition name="search"><default-response url="../Search"/></transition><transition name="Reports"><default-response url="../Accounting/Reports"/></transition><transition name="projectSummary"><default-response url="../Project/ProjectSummary"/></transition><transition name="editProject"><default-response url="../Project/EditProject"/></transition><transition name="findTask"><default-response url="//hm/Task/FindTask"/></transition><actions><entity-find entity-name="mantle.work.effort.WorkEffort" list="projectList"><econdition field-name="workEffortTypeEnumId" value="WetProject"/><econdition field-name="statusId" value="WeInProgress"/></entity-find></actions><widgets><container-row><row-col sm="2"><label text="Operate" type="h4"/><container><link url="../WikiSpace" link-type="anchor"><image url="/hmstatic/images/wiki-documents7.png" url-type="screen" style="invertible" width="40"/></link><link text="Wiki Spaces" url="../WikiSpace" link-type="anchor"/></container><container><link url="../Project" link-type="anchor"><image url="/ssstatic/images/project-business120.png" url-type="screen" style="invertible" width="40"/></link><link text="Projects" url="../Project" link-type="anchor"/></container><container><link url="../Accounting" link-type="anchor"><image url="/hmstatic/images/invoice-pay.png" url-type="screen" style="invertible" width="40"/></link><link text="Accounting" url="../Accounting" link-type="anchor"/></container><container><link url="Reports" link-type="anchor"><image url="/hmstatic/images/reports-dollar116.png" url-type="screen" style="invertible" width="40"/></link><link text="Reports" url="Reports" link-type="anchor"/></container><label text="Setup" type="h4"/><container><link url="../Party" link-type="anchor"><image url="/hmstatic/images/user-man27.png" url-type="screen" style="invertible" width="40"/></link><link text="Parties" url="../Party" link-type="anchor"/></container><container><link url="../Vendor" link-type="anchor"><image url="/hmstatic/images/vendor-person25.png" url-type="screen" style="invertible" width="40"/></link><link text="Vendors" url="../Vendor" link-type="anchor"/></container><container><link url="../Client" link-type="anchor"><image url="/hmstatic/images/client-businessmen26.png" url-type="screen" style="invertible" width="40"/></link><link text="Clients" url="../Client" link-type="anchor"/></container><container><link url="../Team" link-type="anchor"><image url="/hmstatic/images/team-businessmen18.png" url-type="screen" style="invertible" width="40"/></link><link text="Teams" url="../Team" link-type="anchor"/></container><container><link url="../EditRateAmounts" link-type="anchor"><image url="/hmstatic/images/rates-internet16.png" url-type="screen" style="invertible" width="40"/></link><link text="Rates" url="../EditRateAmounts" link-type="anchor"/></container><label text="&nbsp;" type="p" encode="false"/><container style="text-center"><link text="Report Builder" url="../SimpleReport" link-type="anchor"/></container></row-col><row-col sm="10"><form-single name="SearchOptions" transition="search" extends="component://SimpleScreens/screen/SimpleScreens/Search.xml#SearchOptions"><field name="queryString"><default-field tooltip=""><text-line size="40"/></default-field></field></form-single><section-include name="ActiveProjectSection" location="component://SimpleScreens/screen/SimpleScreens/Project/ProjectSummary.xml"/></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Vendor/FindVendor.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="findVendor"><default-response url="."/></transition><transition name="createVendor"><service-call name="mantle.party.PartyServices.create#Organization" in-map="context" out-map="context" multi="parameter"/><default-response url="../EditVendor"/><error-response url="."/></transition><transition name="editVendor"><default-response url="../EditVendor"/></transition><pre-actions><set field="html_title" value="Find Vendor"/></pre-actions><actions><entity-find entity-name="mantle.party.PartyDetailAndRole" list="vendorList" distinct="true"><search-form-inputs default-order-by="organizationName,firstName,lastName"/><econdition field-name="roleTypeId" operator="in" value="Vendor,VendorBillFrom,OrgInternal"/><select-field field-name="partyId,pseudoId,organizationName,firstName,lastName,disabled"/></entity-find></actions><widgets><container><container-dialog id="FindVendorDialog" button-text="Search Vendors" width="700"><form-single name="FindVendor" transition="findVendor"><field name="organizationName"><default-field title="Name"><text-find/></default-field></field><field name="searchButton"><default-field title="Find"><submit/></default-field></field></form-single></container-dialog><container-dialog id="AddVendorDialog" button-text="Add Vendor"><form-single name="CreateVendor" transition="createVendor"><field name="roleTypeId"><default-field><hidden default-value="Vendor"/></default-field></field><field name="organizationName"><default-field title="Name"><text-line/></default-field></field><field name="submitButton"><default-field title="Create Vendor"><submit/></default-field></field></form-single></container-dialog></container><form-list name="VendorList" list="vendorList"><row-actions><entity-find entity-name="mantle.party.PartyRoleAndType" list="roleList"><econdition field-name="partyId"/></entity-find><iterate list="roleList" entry="role"><script><![CDATA[if (roleStr) { roleStr += ", " }; if (role.description) { roleStr = (roleStr?:'') + role.description }]]></script></iterate></row-actions><field name="editVendorLink"><header-field title="Vendor/Org" show-order-by="true"/><default-field><link url="editVendor" text="PartyNameTemplate" link-type="anchor"/></default-field></field><field name="roleTypeId"><default-field title="Roles"><display text="${roleStr?:''}"/></default-field></field><field name="disabled"><header-field title="Disabled?" show-order-by="true"/><default-field><display text="${disabled?:'N'}"/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Vendor/EditVendor.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Vendor" default-menu-index="1"><parameter name="partyId" required="true"/><transition name="updateParty"><service-call name="mantle.party.PartyServices.update#PartyDetail" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="storeContactInfo"><service-call name="mantle.party.ContactServices.store#PartyContactInfo" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getGeoCountryStates" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition name="addPartyRole"><service-call name="create#mantle.party.PartyRole" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="initPartyAccountingConfiguration"><service-call name="mantle.ledger.LedgerServices.init#PartyAccountingConfiguration" in-map="[sourcePartyId:'DefaultSettings', organizationPartyId:partyId]" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="acctgPreference"><default-response url="../Accounting/AcctgPreference"/></transition><transition name="editUser"><default-response url="../../User/EditUser"/></transition><transition name="setVendorRep"><actions><entity-find entity-name="mantle.party.PartyRelationship" list="existingRepRelList"><date-filter/><econdition-object field="[relationshipTypeEnumId:'PrtRepresentative', toPartyId:partyId]"/></entity-find><iterate list="existingRepRelList" entry="existingRepRel"><set field="existingRepRel.thruDate" from="ec.user.nowTimestamp"/><entity-update value-field="existingRepRel"/></iterate><service-call name="create#mantle.party.PartyRelationship" in-map="[relationshipTypeEnumId:'PrtRepresentative', fromPartyId:repPartyId, fromRoleTypeId:'Manager',                         toPartyId:partyId, toRoleTypeId:'Vendor', fromDate:ec.user.nowTimestamp]"/></actions><default-response url="."/></transition><transition name="getPersonList"><actions><entity-find entity-name="mantle.party.PersonAndUserAccount" list="pauList" limit="20"><econditions combine="or"><econdition field-name="firstName" operator="like" value="%${term}%" ignore-case="true"/><econdition field-name="lastName" operator="like" value="%${term}%" ignore-case="true"/><econdition field-name="username" operator="like" value="%${term}%" ignore-case="true"/></econditions><order-by field-name="^lastName"/><order-by field-name="^firstName"/><order-by field-name="^username"/></entity-find><script><![CDATA[def outList = []
                for (def pau in pauList)
                    outList.add([value:pau.partyId, label:"${pau.firstName} ${pau.lastName} (${pau.username})".toString()])
                ec.web.sendJsonResponse(outList)]]></script></actions><default-response type="none"/></transition><actions><entity-find-one entity-name="mantle.party.PartyDetail" value-field="partyDetail"/><service-call name="mantle.party.ContactServices.get#PartyContactInfo" out-map="paymentContactInfo" in-map="[partyId:partyId, postalContactMechPurposeId:'PostalPayment',                     telecomContactMechPurposeId:'PhonePayment', emailContactMechPurposeId:'EmailPayment']"/><set field="paymentInfoFlat" from="flattenNestedMap(paymentContactInfo)"/><service-call name="mantle.party.ContactServices.get#PartyContactInfo" out-map="billingContactInfo" in-map="[partyId:partyId, postalContactMechPurposeId:'PostalBilling',                     telecomContactMechPurposeId:'PhoneBilling', emailContactMechPurposeId:'EmailBilling']"/><set field="billingInfoFlat" from="flattenNestedMap(billingContactInfo)"/><entity-find entity-name="mantle.party.PartyRole" list="partyRoleList"><econdition field-name="partyId"/><order-by field-name="roleTypeId"/></entity-find><entity-find-one entity-name="mantle.party.PartyRole" value-field="clientRoleType"><field-map field-name="partyId"/><field-map field-name="roleTypeId" value="Customer"/></entity-find-one><entity-find-one entity-name="mantle.party.PartyRole" value-field="internalRoleType"><field-map field-name="partyId"/><field-map field-name="roleTypeId" value="OrgInternal"/></entity-find-one><entity-find-one entity-name="mantle.ledger.config.PartyAcctgPreference" value-field="partyAcctgPreference"><field-map field-name="organizationPartyId" from="partyId"/></entity-find-one><entity-find entity-name="mantle.party.PartyRelationship" list="repRelationshipList"><econdition-object field="[relationshipTypeEnumId:'PrtRepresentative', toPartyId:partyId]"/><order-by field-name="-fromDate"/></entity-find><entity-find-one entity-name="mantle.party.Person" value-field="repPerson"><field-map field-name="partyId" from="repRelationshipList?.getAt(0)?.fromPartyId"/></entity-find-one></actions><widgets><container-panel id="VendorInfoContainer"><panel-left size="300"><label text="Payment Information" type="h2"/><label text="Where payments are sent (Accounts Receivable)" type="p"/><container-dialog id="PaymentInfoEdit" button-text="Edit Payment Info" width="800"><form-single name="PaymentInfo" transition="storeContactInfo" map="paymentInfoFlat" extends="component://SimpleScreens/template/party/PartyForms.xml#ContactInfo"/></container-dialog><section name="PaymentContactInfo"><actions><set field="contactInfo" from="paymentContactInfo"/></actions><widgets><render-mode><text type="html,vuet,qvt" location="component://SimpleScreens/template/party/ContactInfo.html.gstring"/></render-mode></widgets></section><form-single name="SetVendorRepForm" transition="setVendorRep"><field name="partyId"><default-field><hidden/></default-field></field><field name="currentRep"><default-field title="Current Rep"><link text="${repPerson ? repPerson.firstName + ' ' + repPerson.lastName : ''}" url="editUser" parameter-map="[partyId:repPerson?.partyId]" link-type="anchor"/></default-field></field><field name="repPartyId"><default-field title="New Rep User"><drop-down><dynamic-options transition="getPersonList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="submitButton"><default-field title="Set Vendor (AR) Representative"><submit/></default-field></field></form-single><label text="Billing Information" type="h2"/><label text="Where invoices are sent (Accounts Payable)" type="p"/><container-dialog id="BillingInfoEdit" button-text="Edit Billing Info" width="800"><form-single name="BillingInfo" transition="storeContactInfo" map="billingInfoFlat" extends="component://SimpleScreens/template/party/PartyForms.xml#ContactInfo"/></container-dialog><section name="BillingContactInfo"><actions><set field="contactInfo" from="billingContactInfo"/></actions><widgets><render-mode><text type="html,vuet,qvt" location="component://SimpleScreens/template/party/ContactInfo.html.gstring"/></render-mode></widgets></section></panel-left><panel-center><container-box><box-header title="Organization"/><box-body><form-single name="EditVendor" transition="updateParty" map="partyDetail"><field name="partyId"><default-field><hidden/></default-field></field><field name="organizationName"><default-field title="Name"><text-line size="60"/></default-field></field><field name="disabled"><default-field><drop-down no-current-selected-key="N" current="selected"><option key="N"/><option key="Y"/></drop-down></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></box-body></container-box><form-list name="RoleList" skip-form="true" list="partyRoleList"><field name="roleTypeId"><default-field title="Role"><display-entity entity-name="mantle.party.RoleType" text="${description}"/></default-field></field></form-list><section name="ClientSection"><condition><expression><![CDATA[!clientRoleType]]></expression></condition><widgets><link url="addPartyRole" url-type="transition" link-type="hidden-form" text="Make Customer" confirmation="Are you sure you want to make this party a Customer?"><parameter name="partyId"/><parameter name="roleTypeId" value="Customer"/></link></widgets></section><section name="InternalSection"><condition><expression><![CDATA[!internalRoleType]]></expression></condition><widgets><link url="addPartyRole" url-type="transition" link-type="hidden-form" text="Make Internal Org" confirmation="Are you sure you want to make this party an Internal Organization?"><parameter name="partyId"/><parameter name="roleTypeId" value="OrgInternal"/></link></widgets></section><section name="InitAcctgConfSection"><condition><expression><![CDATA[internalRoleType && !partyAcctgPreference]]></expression></condition><widgets><link url="initPartyAccountingConfiguration" url-type="transition" link-type="hidden-form" text="Init Accounting Configuration" confirmation="Are you sure you want to initialize Accounting Configuration with default settings?"><parameter name="partyId"/></link></widgets></section><section name="EditAcctgConfSection"><condition><expression><![CDATA[partyAcctgPreference]]></expression></condition><widgets><link url="acctgPreference" url-type="transition" link-type="anchor-button" text="Edit Accounting Configuration"><parameter name="partyId"/></link></widgets></section></panel-center></container-panel></widgets></screen>
<!-- Screen Location component://HiveMind/screen/HiveMindAdmin/Vendor/EditProjects.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Projects" default-menu-index="2"><parameter name="partyId" required="true"/><transition name="createProject"><service-call name="mantle.work.ProjectServices.create#Project" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateVendorProject"><service-call name="update#WorkEffortParty" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="editProject"><default-response url="../../Project/EditProject"/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><actions><entity-find entity-name="WorkEffortAndParty" list="weapList"><econdition field-name="partyId"/><econdition field-name="workEffortTypeEnumId" value="WetProject"/></entity-find></actions><widgets><container-dialog id="NewProjectContainer" button-text="New Project"><form-single name="NewProject" transition="createProject"><field name="partyId"><default-field><hidden/></default-field></field><field name="workEffortId"><default-field title="ID"><text-line size="8" maxlength="8"/></default-field></field><field name="workEffortName"><default-field title="Project Name"><text-line/></default-field></field><field name="vendorPartyId" from="partyId"><default-field><hidden/></default-field></field><field name="clientPartyId"><default-field title="Client"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="0" parameter-map="[roleTypeId:'Customer,CustomerBillTo,OrgInternal']"/></drop-down></default-field></field><field name="submitButton"><default-field title="Create Project"><submit/></default-field></field></form-single></container-dialog><form-list name="UpdateVendorProjectForm" list="weapList" transition="updateVendorProject"><field name="partyId"><default-field><hidden/></default-field></field><field name="workEffortId"><default-field title="Project"><link text="${workEffortId} - ${workEffortName}" url="editProject" link-type="anchor"/></default-field></field><field name="roleTypeId"><header-field title="Role" show-order-by="true"/><default-field><display-entity entity-name="RoleType" text="${description}"/></default-field></field><field name="fromDate"><header-field show-order-by="true"/><default-field><display/></default-field></field><field name="thruDate"><header-field show-order-by="true"/><default-field><date-time/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/Vendor/EditUsers.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Users" default-menu-index="3"><parameter name="partyId" required="true"/><transition name="addRelationship"><service-call name="create#mantle.party.PartyRelationship" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateRelationship"><service-call name="update#mantle.party.PartyRelationship" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="editUser"><default-response url="../../User/EditUser"/></transition><transition name="getPersonList"><actions><entity-find entity-name="mantle.party.PersonAndUserAccount" list="pauList" limit="20"><econditions combine="or"><econdition field-name="firstName" operator="like" value="%${term}%" ignore-case="true"/><econdition field-name="lastName" operator="like" value="%${term}%" ignore-case="true"/><econdition field-name="username" operator="like" value="%${term}%" ignore-case="true"/></econditions><order-by field-name="^lastName"/><order-by field-name="^firstName"/><order-by field-name="^username"/></entity-find><script><![CDATA[def outList = []
                for (def pau in pauList) outList.add([value:pau.partyId, label:"${pau.firstName} ${pau.lastName} (${pau.username})".toString()])
                ec.web.sendJsonResponse(outList)]]></script></actions><default-response type="none"/></transition><actions><set field="vendorPartyId" from="partyId"/><entity-find entity-name="mantle.party.PartyFromAndRelationship" list="pfarList"><econdition field-name="toPartyId" from="partyId"/></entity-find></actions><widgets><container-dialog id="AddUserRelationshipDialog" button-text="Add User Agent"><form-single name="AddUserRelationshipForm" transition="addRelationship"><field name="partyId"><default-field><hidden/></default-field></field><field name="toPartyId" from="partyId"><default-field><hidden/></default-field></field><field name="toRoleTypeId"><default-field><hidden default-value="Vendor"/></default-field></field><field name="relationshipTypeEnumId"><default-field><hidden default-value="PrtAgent"/></default-field></field><field name="fromPartyId"><default-field title="Person"><drop-down><dynamic-options transition="getPersonList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="fromRoleTypeId"><default-field title="Role"><drop-down><entity-options key="${roleTypeId}" text="${description}"><entity-find entity-name="mantle.party.RoleGroupMemberAndType" cache="true"><econdition field-name="roleGroupEnumId" value="RgpProjectVendor"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="fromDate" from="ec.user.nowTimestamp"><default-field><date-time/></default-field></field><field name="thruDate"><default-field><date-time/></default-field></field><field name="submitButton"><default-field title="Add Assignment"><submit/></default-field></field></form-single></container-dialog><form-list name="UpdateUserRelForm" list="pfarList" transition="updateRelationship"><field name="partyId" from="vendorPartyId"><default-field><hidden/></default-field></field><field name="partyRelationshipId"><default-field><hidden/></default-field></field><field name="firstName"><header-field title="First##Name" show-order-by="case-insensitive"/><default-field><link url="editUser" text="${firstName?:''}" link-type="anchor"><parameter name="partyId" from="fromPartyId"/></link></default-field></field><field name="lastName"><header-field title="Last##Name" show-order-by="case-insensitive"/><default-field><link url="editUser" text="${lastName?:''}" link-type="anchor"><parameter name="partyId" from="fromPartyId"/></link></default-field></field><field name="organizationName"><header-field title="Org Name" show-order-by="case-insensitive"/><default-field><display/></default-field></field><field name="fromRoleTypeId"><header-field title="Role" show-order-by="true"/><default-field><drop-down><entity-options key="${roleTypeId}" text="${description}"><entity-find entity-name="mantle.party.RoleGroupMemberAndType" cache="true"><econdition field-name="roleGroupEnumId" value="RgpProjectVendor"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="fromDate"><header-field show-order-by="true"/><default-field><display/></default-field></field><field name="thruDate"><header-field show-order-by="true"/><default-field><date-time/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://HiveMind/screen/HiveMindAdmin/Vendor.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Vendors" default-menu-index="2" menu-image="/hmstatic/images/vendor-person25.png"><subscreens default-item="FindVendor"><subscreens-item name="FindVendor" location="component://SimpleScreens/screen/SimpleScreens/Vendor/FindVendor.xml" menu-include="false"/><subscreens-item name="EditVendor" location="component://SimpleScreens/screen/SimpleScreens/Vendor/EditVendor.xml" menu-index="1" menu-title="Vendor"/><subscreens-item name="EditUsers" location="component://SimpleScreens/screen/SimpleScreens/Vendor/EditUsers.xml" menu-index="2" menu-title="Users"/></subscreens><widgets><subscreens-panel id="vendor-panel" type="tab"/></widgets></screen>
<!-- Screen Location component://HiveMind/screen/HiveMindAdmin/Client/FindClient.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="findClient"><default-response url="."/></transition><transition name="createClient"><service-call name="mantle.party.PartyServices.create#Organization" in-map="context" out-map="context" multi="parameter"/><default-response url="../EditClient"/><error-response url="."/></transition><transition name="editClient"><default-response url="../EditClient"/></transition><pre-actions><set field="html_title" value="Find Client"/></pre-actions><actions><entity-find entity-name="mantle.party.PartyDetailAndRole" list="clientList" distinct="true"><search-form-inputs default-order-by="organizationName,firstName,lastName"/><econdition field-name="roleTypeId" operator="in" value="Customer,CustomerBillTo"/><select-field field-name="partyId,pseudoId,organizationName,firstName,lastName,disabled"/></entity-find></actions><widgets><container><container-dialog id="AddClientDialog" button-text="Add Client"><form-single name="CreateClient" transition="createClient"><field name="roleTypeId"><default-field><hidden default-value="Customer"/></default-field></field><field name="organizationName"><default-field title="Name"><text-line/></default-field></field><field name="submitButton"><default-field title="Create Client"><submit/></default-field></field></form-single></container-dialog></container><form-list name="ClientList" list="clientList"><field name="organizationName"><header-field show-order-by="true" title="Name"><text-find hide-options="true"/></header-field><default-field><link url="editClient" text="PartyNameTemplate" link-type="anchor"/></default-field></field><field name="disabled"><header-field title="Disabled?" show-order-by="true"/><default-field><display text="${disabled?:'N'}"/></default-field></field><field name="searchButton"><header-field title="Find"><submit/></header-field><default-field><display text=""/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://HiveMind/screen/HiveMindAdmin/Client/EditClient.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Client" default-menu-index="1"><parameter name="partyId" required="true"/><transition name="updateParty"><service-call name="mantle.party.PartyServices.update#PartyDetail" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="storeContactInfo"><service-call name="mantle.party.ContactServices.store#PartyContactInfo" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getGeoCountryStates" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition name="addPartyRole"><service-call name="create#mantle.party.PartyRole" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="editUser"><default-response url="../../User/EditUser"/></transition><transition name="setClientRep"><actions><entity-find entity-name="mantle.party.PartyRelationship" list="existingRepRelList"><date-filter/><econdition-object field="[relationshipTypeEnumId:'PrtRepresentative', toPartyId:partyId]"/></entity-find><iterate list="existingRepRelList" entry="existingRepRel"><set field="existingRepRel.thruDate" from="ec.user.nowTimestamp"/><entity-update value-field="existingRepRel"/></iterate><service-call name="create#mantle.party.PartyRelationship" in-map="[relationshipTypeEnumId:'PrtRepresentative', fromPartyId:repPartyId, fromRoleTypeId:'ClientBilling',                         toPartyId:partyId, toRoleTypeId:'Customer', fromDate:ec.user.nowTimestamp]"/></actions><default-response url="."/></transition><transition name="getPersonList"><actions><entity-find entity-name="mantle.party.PersonAndUserAccount" list="pauList" limit="20"><econditions combine="or"><econdition field-name="firstName" operator="like" value="%${term}%" ignore-case="true"/><econdition field-name="lastName" operator="like" value="%${term}%" ignore-case="true"/><econdition field-name="username" operator="like" value="%${term}%" ignore-case="true"/></econditions><order-by field-name="^firstName"/><order-by field-name="^lastName"/><order-by field-name="^username"/></entity-find><script><![CDATA[def outList = []
                for (def pau in pauList)
                    outList.add([value:pau.partyId, label:"${pau.firstName} ${pau.lastName} (${pau.username})".toString()])
                ec.web.sendJsonResponse(outList)]]></script></actions><default-response type="none"/></transition><actions><entity-find-one entity-name="mantle.party.PartyDetail" value-field="partyDetail"/><service-call name="mantle.party.ContactServices.get#PartyContactInfo" out-map="paymentContactInfo" in-map="[partyId:partyId, postalContactMechPurposeId:'PostalPayment',                     telecomContactMechPurposeId:'PhonePayment', emailContactMechPurposeId:'EmailPayment']"/><set field="paymentInfoFlat" from="flattenNestedMap(paymentContactInfo)"/><service-call name="mantle.party.ContactServices.get#PartyContactInfo" out-map="billingContactInfo" in-map="[partyId:partyId, postalContactMechPurposeId:'PostalBilling',                     telecomContactMechPurposeId:'PhoneBilling', emailContactMechPurposeId:'EmailBilling']"/><set field="billingInfoFlat" from="flattenNestedMap(billingContactInfo)"/><entity-find entity-name="mantle.party.PartyRole" list="partyRoleList"><econdition field-name="partyId"/><order-by field-name="roleTypeId"/></entity-find><entity-find-one entity-name="mantle.party.PartyRole" value-field="vendorRoleType"><field-map field-name="partyId"/><field-map field-name="roleTypeId" value="Vendor"/></entity-find-one><entity-find-one entity-name="mantle.party.PartyRole" value-field="internalRoleType"><field-map field-name="partyId"/><field-map field-name="roleTypeId" value="OrgInternal"/></entity-find-one><entity-find entity-name="mantle.party.PartyRelationship" list="repRelationshipList"><econdition-object field="[relationshipTypeEnumId:'PrtRepresentative', toPartyId:partyId]"/><order-by field-name="-fromDate"/></entity-find><entity-find-one entity-name="mantle.party.Person" value-field="repPerson"><field-map field-name="partyId" from="repRelationshipList?.getAt(0)?.fromPartyId"/></entity-find-one></actions><widgets><container-panel id="ClientInfoContainer"><panel-left size="300"><label text="Billing Information" type="h2"/><label text="Where invoices are sent (Accounts Payable)" type="p"/><container-dialog id="BillingInfoEdit" button-text="Edit Billing Info" width="800"><form-single name="BillingInfo" transition="storeContactInfo" map="billingInfoFlat" extends="component://SimpleScreens/template/party/PartyForms.xml#ContactInfo"/></container-dialog><section name="BillingContactInfo"><actions><set field="contactInfo" from="billingContactInfo"/></actions><widgets><render-mode><text type="html" location="component://SimpleScreens/template/party/ContactInfo.html.gstring"/></render-mode></widgets></section><form-single name="SetClientRepForm" transition="setClientRep"><field name="partyId"><default-field><hidden/></default-field></field><field name="currentRep"><default-field title="Current Rep"><link text="${repPerson ? repPerson.firstName + ' ' + repPerson.lastName : ''}" url="editUser" parameter-map="[partyId:repPerson?.partyId]"/></default-field></field><field name="repPartyId"><default-field title="New Rep User"><drop-down><dynamic-options transition="getPersonList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="submitButton"><default-field title="Set Client (AP) Representative"><submit/></default-field></field></form-single><label text="Payment Information" type="h2"/><label text="Where payments are sent (Accounts Receivable)" type="p"/><container-dialog id="PaymentInfoEdit" button-text="Edit Payment Info" width="800"><form-single name="PaymentInfo" transition="storeContactInfo" map="paymentInfoFlat" extends="component://SimpleScreens/template/party/PartyForms.xml#ContactInfo"/></container-dialog><section name="PaymentContactInfo"><actions><set field="contactInfo" from="paymentContactInfo"/></actions><widgets><render-mode><text type="html" location="component://SimpleScreens/template/party/ContactInfo.html.gstring"/></render-mode></widgets></section></panel-left><panel-center><form-single name="EditParty" transition="updateParty" map="partyDetail"><field name="partyId"><default-field><hidden/></default-field></field><field name="organizationName"><default-field><text-line size="60"/></default-field></field><field name="disabled"><default-field><drop-down no-current-selected-key="N" current="selected"><option key="N"/><option key="Y"/></drop-down></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single><form-list name="RoleList" skip-form="true" list="partyRoleList"><field name="roleTypeId"><default-field title="Role"><display-entity entity-name="mantle.party.RoleType" text="${description}"/></default-field></field></form-list><section name="VendorSection"><condition><expression><![CDATA[!vendorRoleType]]></expression></condition><widgets><link url="addPartyRole" url-type="transition" link-type="hidden-form" text="Make Vendor" confirmation="Are you sure you want to make this party a Vendor?"><parameter name="partyId"/><parameter name="roleTypeId" value="Vendor"/></link></widgets></section><section name="InternalSection"><condition><expression><![CDATA[!internalRoleType]]></expression></condition><widgets><link url="addPartyRole" url-type="transition" link-type="hidden-form" text="Make Internal Org" confirmation="Are you sure you want to make this party an Internal Organization?"><parameter name="partyId"/><parameter name="roleTypeId" value="OrgInternal"/></link></widgets></section></panel-center></container-panel></widgets></screen>
<!-- Screen Location component://HiveMind/screen/HiveMindAdmin/Client/EditProjects.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Projects" default-menu-index="2"><parameter name="partyId" required="true"/><transition name="createProject"><service-call name="mantle.work.ProjectServices.create#Project" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateClientProject"><service-call name="update#WorkEffortParty" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="editProject"><default-response url="../../Project/EditProject"/></transition><actions><entity-find entity-name="WorkEffortAndParty" list="weapList"><econdition field-name="partyId"/><econdition field-name="workEffortTypeEnumId" value="WetProject"/></entity-find></actions><widgets><container-dialog id="NewProjectContainer" button-text="New Project"><form-single name="NewProject" transition="createProject"><field name="partyId"><default-field><hidden/></default-field></field><field name="workEffortId"><default-field title="ID"><text-line size="8" maxlength="8"/></default-field></field><field name="workEffortName"><default-field title="Project Name"><text-line/></default-field></field><field name="clientPartyId" from="partyId"><default-field><hidden/></default-field></field><field name="vendorPartyId"><default-field title="Vendor"><drop-down allow-empty="true"><entity-options key="${partyId}" text="${organizationName?:''} ${firstName?:''} ${lastName?:''}"><entity-find entity-name="mantle.party.PartyDetailAndRole"><econdition field-name="roleTypeId" operator="in" value="Vendor,VendorBillFrom,OrgInternal"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="organizationName"/><order-by field-name="firstName"/><order-by field-name="lastName"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Create Project"><submit/></default-field></field></form-single></container-dialog><form-list name="UpdateClientProjectForm" list="weapList" transition="updateClientProject"><field name="partyId"><default-field><hidden/></default-field></field><field name="workEffortId"><default-field title="Project"><link text="${workEffortId} - ${workEffortName}" url="editProject" link-type="anchor"/></default-field></field><field name="roleTypeId"><header-field title="Role" show-order-by="true"/><default-field><display-entity entity-name="RoleType" text="${description}"/></default-field></field><field name="fromDate"><header-field show-order-by="true"/><default-field><display/></default-field></field><field name="thruDate"><header-field show-order-by="true"/><default-field><date-time/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://HiveMind/screen/HiveMindAdmin/Client/EditUsers.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Users" default-menu-index="3"><parameter name="partyId" required="true"/><transition name="addRelationship"><service-call name="create#mantle.party.PartyRelationship" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateRelationship"><service-call name="update#mantle.party.PartyRelationship" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="editUser"><default-response url="../../User/EditUser"/></transition><transition name="getPersonList"><actions><entity-find entity-name="mantle.party.PersonAndUserAccount" list="pauList" limit="20"><econditions combine="or"><econdition field-name="firstName" operator="like" value="%${term}%" ignore-case="true"/><econdition field-name="lastName" operator="like" value="%${term}%" ignore-case="true"/><econdition field-name="username" operator="like" value="%${term}%" ignore-case="true"/></econditions><order-by field-name="^firstName"/><order-by field-name="^lastName"/><order-by field-name="^username"/></entity-find><script><![CDATA[def outList = []
                for (def pau in pauList)
                    outList.add([value:pau.partyId, label:"${pau.firstName} ${pau.lastName} (${pau.username?:'No username'})".toString()])
                ec.web.sendJsonResponse(outList)]]></script></actions><default-response type="none"/></transition><actions><set field="clientPartyId" from="partyId"/><entity-find entity-name="mantle.party.PartyFromAndRelationship" list="pfarList"><econdition field-name="toPartyId" from="partyId"/></entity-find></actions><widgets><container-dialog id="AddUserRelationshipDialog" button-text="Add User Agent"><form-single name="AddUserRelationshipForm" transition="addRelationship"><field name="partyId"><default-field><hidden/></default-field></field><field name="toPartyId" from="partyId"><default-field><hidden/></default-field></field><field name="toRoleTypeId"><default-field><hidden default-value="Customer"/></default-field></field><field name="relationshipTypeEnumId"><default-field><hidden default-value="PrtAgent"/></default-field></field><field name="fromPartyId"><default-field title="Person"><drop-down><dynamic-options transition="getPersonList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="fromRoleTypeId"><default-field title="Role"><drop-down><entity-options key="${roleTypeId}" text="${description}"><entity-find entity-name="mantle.party.RoleGroupMemberAndType" cache="true"><econdition field-name="roleGroupEnumId" value="RgpProjectClient"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="fromDate" from="ec.user.nowTimestamp"><default-field><date-time/></default-field></field><field name="thruDate"><default-field><date-time/></default-field></field><field name="submitButton"><default-field title="Add Assignment"><submit/></default-field></field></form-single></container-dialog><form-list name="UpdateUserRelForm" list="pfarList" transition="updateRelationship"><field name="partyId" from="clientPartyId"><default-field><hidden/></default-field></field><field name="partyRelationshipId"><default-field><hidden/></default-field></field><field name="firstName"><header-field title="First##Name" show-order-by="case-insensitive"/><default-field><link url="editUser" text="${firstName}" link-type="anchor"><parameter name="partyId" from="fromPartyId"/></link></default-field></field><field name="lastName"><header-field title="Last##Name" show-order-by="case-insensitive"/><default-field><link url="editUser" text="${lastName}" link-type="anchor"><parameter name="partyId" from="fromPartyId"/></link></default-field></field><field name="fromRoleTypeId"><header-field title="Role" show-order-by="true"/><default-field><drop-down><entity-options key="${roleTypeId}" text="${description}"><entity-find entity-name="mantle.party.RoleGroupMemberAndType" cache="true"><econdition field-name="roleGroupEnumId" value="RgpProjectClient"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="fromDate"><header-field show-order-by="true"/><default-field><display/></default-field></field><field name="thruDate"><header-field show-order-by="true"/><default-field><date-time/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://HiveMind/screen/HiveMindAdmin/Client.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Clients" default-menu-index="3" menu-image="/hmstatic/images/client-businessmen26.png"><subscreens default-item="FindClient"/><widgets><container-panel id="client-panel" dynamic="true"><panel-header spacing="0"><subscreens-menu id="client-menu" type="tab"/></panel-header><panel-center><subscreens-active/></panel-center></container-panel></widgets></screen>
<!-- Screen Location component://HiveMind/screen/HiveMindAdmin/Team/FindTeam.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="findTeam"><default-response url="."/></transition><transition name="createTeam"><service-call name="mantle.party.PartyServices.create#Organization" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="editTeam"><default-response url="../EditTeam"/></transition><pre-actions><set field="html_title" value="Find Team"/></pre-actions><actions><entity-find entity-name="mantle.party.PartyDetailAndRole" list="teamList"><search-form-inputs default-order-by="organizationName,firstName,lastName"/><econdition field-name="roleTypeId" value="OrgTeam"/></entity-find></actions><widgets><container><container-dialog id="AddTeamDialog" button-text="Add Team"><form-single name="CreateTeam" transition="createTeam"><field name="roleTypeId"><default-field><hidden default-value="OrgTeam"/></default-field></field><field name="organizationName"><default-field title="Name"><text-line/></default-field></field><field name="submitButton"><default-field title="Create Team"><submit/></default-field></field></form-single></container-dialog></container><form-list name="TeamList" list="teamList"><field name="organizationName"><header-field show-order-by="case-insensitive" title="Name"><text-find/></header-field><default-field><link url="editTeam" text="${organizationName}" link-type="anchor"/></default-field></field><field name="disabled"><header-field title="Disabled?" show-order-by="case-insensitive"/><default-field><display text="${disabled?:'N'}"/></default-field></field><field name="searchButton"><header-field title="Find"><submit/></header-field><default-field><display text=""/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://HiveMind/screen/HiveMindAdmin/Team/EditTeam.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Team" default-menu-index="1"><parameter name="partyId" required="true"/><transition name="updateTeam"><service-call name="mantle.party.PartyServices.update#PartyDetail" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><entity-find-one entity-name="mantle.party.PartyDetail" value-field="fieldValues"/></actions><widgets><form-single name="EditTeam" transition="updateTeam"><field name="partyId"><default-field><hidden/></default-field></field><field name="organizationName"><default-field><text-line size="60"/></default-field></field><field name="disabled"><default-field><drop-down no-current-selected-key="N" current="selected"><option key="N"/><option key="Y"/></drop-down></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></widgets></screen>
<!-- Screen Location component://HiveMind/screen/HiveMindAdmin/Team/EditUsers.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Users" default-menu-index="3"><parameter name="partyId" required="true"/><transition name="addRelationship"><service-call name="create#mantle.party.PartyRelationship" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateRelationship"><service-call name="update#mantle.party.PartyRelationship" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="editUser"><default-response url="../../User/EditUser"/></transition><transition name="getPersonList"><actions><entity-find entity-name="PersonAndUserAccount" list="pauList" limit="20"><econditions combine="or"><econdition field-name="firstName" operator="like" value="%${term}%" ignore-case="true"/><econdition field-name="lastName" operator="like" value="%${term}%" ignore-case="true"/><econdition field-name="username" operator="like" value="%${term}%" ignore-case="true"/></econditions><order-by field-name="^firstName"/><order-by field-name="^lastName"/><order-by field-name="^username"/></entity-find><script><![CDATA[def outList = []
                for (def pau in pauList)
                    outList.add([value:pau.partyId, label:"${pau.firstName} ${pau.lastName} (${pau.username?:'No username'})".toString()])
                ec.web.sendJsonResponse(outList)]]></script></actions><default-response type="none"/></transition><actions><set field="teamPartyId" from="partyId"/><entity-find entity-name="PartyFromAndRelationship" list="pfarList"><econdition field-name="toPartyId" from="partyId"/></entity-find></actions><widgets><container-dialog id="AddUserAssignDialog" button-text="Add User Assignment"><form-single name="AddUserRelationshipForm" transition="addRelationship"><field name="partyId"><default-field><hidden/></default-field></field><field name="toPartyId" from="partyId"><default-field><hidden/></default-field></field><field name="toRoleTypeId"><default-field><hidden default-value="OrgTeam"/></default-field></field><field name="relationshipTypeEnumId"><default-field><hidden default-value="PrtMember"/></default-field></field><field name="fromPartyId"><default-field title="Person"><drop-down><dynamic-options transition="getPersonList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="fromRoleTypeId"><default-field title="Role"><drop-down><entity-options key="${roleTypeId}" text="${description}"><entity-find entity-name="mantle.party.RoleGroupMemberAndType" cache="true"><econdition field-name="roleGroupEnumId" value="RgpTask"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="fromDate" from="ec.user.nowTimestamp"><default-field><date-time/></default-field></field><field name="thruDate"><default-field><date-time/></default-field></field><field name="submitButton"><default-field title="Add Assignment"><submit/></default-field></field></form-single></container-dialog><form-list name="UpdateUserRelForm" list="pfarList" transition="updateRelationship"><field name="partyId" from="teamPartyId"><default-field><hidden/></default-field></field><field name="partyRelationshipId"><default-field><hidden/></default-field></field><field name="firstName"><header-field title="First##Name" show-order-by="case-insensitive"/><default-field><link url="editUser" text="${firstName}" link-type="anchor"><parameter name="partyId" from="fromPartyId"/></link></default-field></field><field name="lastName"><header-field title="Last##Name" show-order-by="case-insensitive"/><default-field><link url="editUser" text="${lastName}" link-type="anchor"><parameter name="partyId" from="fromPartyId"/></link></default-field></field><field name="fromRoleTypeId"><header-field title="Role" show-order-by="true"/><default-field><drop-down><entity-options key="${roleTypeId}" text="${description}"><entity-find entity-name="mantle.party.RoleGroupMemberAndType" cache="true"><econdition field-name="roleGroupEnumId" value="RgpTask"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="fromDate"><header-field show-order-by="true"/><default-field><display/></default-field></field><field name="thruDate"><header-field show-order-by="true"/><default-field><date-time/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://HiveMind/screen/HiveMindAdmin/Team.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Teams" default-menu-index="5" menu-image="/hmstatic/images/team-businessmen18.png"><subscreens default-item="FindTeam"/><widgets><subscreens-panel id="task-panel" type="tab"/></widgets></screen>
<!-- Screen Location component://HiveMind/screen/HiveMindAdmin/Party.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Parties" default-menu-index="6" menu-image="/hmstatic/images/user-man27.png"><subscreens default-item="FindParty"><subscreens-item name="FindParty" location="component://SimpleScreens/screen/SimpleScreens/Party/FindParty.xml" menu-include="false"/><subscreens-item name="EditParty" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty.xml" menu-index="1"/><subscreens-item name="PartyCalendar" location="component://SimpleScreens/screen/SimpleScreens/Party/PartyCalendar.xml" menu-index="2"/><subscreens-item name="PartyEmails" location="component://SimpleScreens/screen/SimpleScreens/Party/PartyEmails.xml" menu-index="3"/><subscreens-item name="PartyMessages" location="component://SimpleScreens/screen/SimpleScreens/Party/PartyMessages.xml" menu-index="3"/><subscreens-item name="PartyRelated" location="component://SimpleScreens/screen/SimpleScreens/Party/PartyRelated.xml" menu-index="4"/><subscreens-item name="PartyTimeEntries" location="component://SimpleScreens/screen/SimpleScreens/Party/PartyTimeEntries.xml" menu-index="5"/><subscreens-item name="PartyAgreements" location="component://SimpleScreens/screen/SimpleScreens/Party/PartyAgreements.xml" menu-index="6"/><subscreens-item name="PartyProjects" location="component://SimpleScreens/screen/SimpleScreens/Party/PartyProjects.xml" menu-index="12"/><subscreens-item name="PartyTasks" location="component://SimpleScreens/screen/SimpleScreens/Party/PartyTasks.xml" menu-index="13"/><subscreens-item name="PartyRequests" location="component://SimpleScreens/screen/SimpleScreens/Party/PartyRequests.xml" menu-index="14"/><subscreens-item name="FinancialInfo" location="component://SimpleScreens/screen/SimpleScreens/Party/FinancialInfo.xml" menu-index="21"/><subscreens-item name="PaymentMethod" location="component://SimpleScreens/screen/SimpleScreens/Party/PaymentMethod.xml" menu-include="false"/></subscreens><widgets><subscreens-panel id="PartyPanel" type="tab"/></widgets></screen>
<!-- Screen Location component://HiveMind/screen/HiveMindAdmin/WikiSpace.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Wiki Space" default-menu-index="11" menu-image="/hmstatic/images/wiki-documents7.png"><subscreens default-item="WikiSpaces"><subscreens-item name="WikiSpaces" menu-include="false" location="component://SimpleScreens/screen/SimpleScreens/Wiki/WikiSpaces.xml"/><subscreens-item name="EditWikiSpace" menu-title="Wiki Space" menu-index="1" location="component://SimpleScreens/screen/SimpleScreens/Wiki/EditWikiSpace.xml"/><subscreens-item name="wiki" location="component://SimpleScreens/screen/SimpleScreens/Wiki/wiki.xml" menu-include="false"/><subscreens-item name="EditWikiPage" location="component://SimpleScreens/screen/SimpleScreens/Wiki/EditWikiPage.xml" menu-include="false"/><subscreens-item name="ViewWikiPage" location="component://SimpleScreens/screen/SimpleScreens/Wiki/ViewWikiPage.xml" menu-include="false"/><subscreens-item name="WikiCompare" location="component://SimpleScreens/screen/SimpleScreens/Wiki/WikiCompare.xml" menu-include="false"/></subscreens><widgets><subscreens-active id="task-panel"/></widgets></screen>
<!-- Screen Location component://HiveMind/screen/HiveMindAdmin.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" menu-image="fa fa-tasks" menu-image-type="icon"><always-actions><set field="appRoot" value="hmadmin"/><set field="taskRoot" value="hm"/><set field="searchIndexName" value="mantle"/><set field="searchLinkSets" value="hmadmin,hm"/><set field="searchTaskDocType" value="MantleTask"/><set field="searchPartyDocType" value="MantleParty"/></always-actions><subscreens default-item="dashboard" always-use-full-path="true"><subscreens-item name="Search" location="component://SimpleScreens/screen/SimpleScreens/Search.xml" menu-index="1"/><subscreens-item name="EditRateAmounts" menu-index="7" location="component://SimpleScreens/screen/SimpleScreens/HumanRes/EditRateAmounts.xml"/><subscreens-item name="Project" menu-index="12" location="component://SimpleScreens/screen/SimpleScreens/Project.xml"/><subscreens-item name="Accounting" menu-index="13" location="component://SimpleScreens/screen/SimpleScreens/Accounting.xml"/><subscreens-item name="QuickViewReport" menu-title="Custom Reports" menu-index="30" location="component://SimpleScreens/screen/SimpleScreens/SimpleReport/QuickViewReport.xml"/><subscreens-item name="SimpleReport" menu-title="Report Builder" menu-index="31" location="component://SimpleScreens/screen/SimpleScreens/SimpleReport.xml"/></subscreens><widgets><subscreens-panel id="HiveMindAdminPanel" type="popup" title="HiveMind Admin"/></widgets></screen>
<!-- Screen Location component://PopCommerce/screen/PopCommerceAdmin/dashboard.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Dashboard" default-menu-index="1" menu-image="fa fa-dashboard" menu-image-type="icon"><transition name="search"><default-response url="../Search"/></transition><transition name="quickLookup"><default-response url="../QuickLookup"/></transition><widgets><container-row><row-col md="6" style="text-center"><form-single name="SearchOptions" transition="search" extends="component://SimpleScreens/screen/SimpleScreens/Search.xml#SearchOptions"><field name="queryString"><default-field tooltip=""><text-line size="25"/></default-field></field><field-layout><field-row-big justify="center"><field-ref name="documentType"/><field-ref name="queryString"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single></row-col><row-col md="6" style="text-center"><form-single name="QuickLookupForm" transition="quickLookup" focus-field="" extends="component://SimpleScreens/screen/SimpleScreens/QuickLookup.xml#QuickLookupForm"><field-layout><field-row-big justify="center"><field-ref name="lookupId"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single></row-col></container-row><section name="QuickInfoSection"><actions><entity-find entity-name="mantle.party.PartyRole" list="orgPartyRoles"><econdition field-name="roleTypeId" value="OrgInternal"/></entity-find><set field="orgIntPartyIds" from="orgPartyRoles*.partyId"/><entity-find-count entity-name="mantle.order.OrderPart" count-field="orderPlacedCount"><econdition field-name="statusId" operator="in" from="['OrderPlaced', 'OrderProcessing']"/><econdition field-name="vendorPartyId" operator="in" from="orgIntPartyIds"/></entity-find-count><entity-find-count entity-name="mantle.order.OrderPart" count-field="orderApprovedCount"><econdition field-name="statusId" operator="in" from="['OrderApproved', 'OrderSent']"/><econdition field-name="vendorPartyId" operator="in" from="orgIntPartyIds"/></entity-find-count><entity-find-count entity-name="mantle.order.OrderPart" count-field="orderHeldCount"><econdition field-name="statusId" value="OrderHold"/><econdition field-name="vendorPartyId" operator="in" from="orgIntPartyIds"/></entity-find-count><entity-find-count entity-name="mantle.request.RequestAndParty" count-field="requestSubmittedCount"><econdition field-name="statusId" value="ReqSubmitted"/><econdition field-name="roleTypeId" value="Customer"/></entity-find-count><entity-find-count entity-name="mantle.request.RequestAndParty" count-field="requestInProgressCount"><econdition field-name="statusId" operator="in" from="['ReqReviewed', 'ReqInProgress']"/><econdition field-name="roleTypeId" value="Customer"/></entity-find-count></actions><widgets><container-row><row-col sm="0" md="1"><label text="&nbsp;" encode="false"/></row-col><row-col sm="5" md="4" style="text-center"><container style="row"><container style="col"><label text="Sales Orders" type="h4"/></container><container style="col q-my-auto"><link url="../Order" parameter-map="[orderType:'Sales', statusId:'OrderPlaced,OrderProcessing', statusId_op:'in']" text="Placed" badge="${orderPlacedCount}" btn-type="default"/></container><container style="col q-my-auto"><link url="../Order" parameter-map="[orderType:'Sales', statusId:'OrderApproved,OrderSent', statusId_op:'in']" text="Approved" badge="${orderApprovedCount}" btn-type="default"/></container><container style="col q-my-auto"><link url="../Order" parameter-map="[orderType:'Sales', statusId:'OrderHold']" text="Held" badge="${orderHeldCount}" btn-type="default"/></container></container></row-col><row-col sm="2"><label text="&nbsp;" encode="false"/></row-col><row-col sm="5" md="4" style="text-center"><container style="row"><container style="col"><label text="Requests" type="h4"/></container><container style="col q-my-auto"><link url="../Request" parameter-map="[statusId:'ReqSubmitted', roleTypeId:'Customer']" text="Submitted" badge="${requestSubmittedCount}" btn-type="default"/></container><container style="col q-my-auto"><link url="../Request" parameter-map="[statusId:'ReqReviewed,ReqInProgress', statusId_op:'in', roleTypeId:'Customer']" text="In Progress" badge="${requestInProgressCount}" btn-type="default"/></container></container></row-col><row-col sm="0" md="1"><label text="&nbsp;" encode="false"/></row-col></container-row></widgets></section><container-row><row-col sm="1"><label text="&nbsp;" encode="false"/></row-col><row-col sm="4" style="text-center"><label text="Operate" type="h4"/><container-row><row-col sm="6"><container><link url="../Supplier" link-type="anchor"><image url="/ssstatic/images/Supplier.png" url-type="screen" style="invertible" width="40"/></link><container><link text="Suppliers" url="../Supplier" link-type="anchor"/></container></container><container><link url="../Order" link-type="anchor" parameter-map="[orderType:'Purchase']"><image url="/ssstatic/images/Purchasing.png" url-type="screen" style="invertible" width="40"/></link><container><link text="Purchase Orders" url="../Order" link-type="anchor" parameter-map="[orderType:'Purchase']"/></container></container><container><link url="../Shipment" link-type="anchor" parameter-map="[parentShipmentType:'ShpTpIncoming']"><image url="/ssstatic/images/Receiving.png" url-type="screen" style="invertible" width="40"/></link><container><link text="Incoming Shipments" url="../Shipment" link-type="anchor" parameter-map="[parentShipmentType:'ShpTpIncoming']"/></container></container></row-col><row-col sm="6"><container><link url="../Customer" link-type="anchor"><image url="/ssstatic/images/Customer.png" url-type="screen" style="invertible" width="40"/></link><container><link text="Customers" url="../Customer" link-type="anchor"/></container></container><container><link url="../Request" link-type="anchor"><image url="/ssstatic/images/Request.png" url-type="screen" style="invertible" width="40"/></link><container><link text="Requests" url="../Request" link-type="anchor"/></container></container><container><link url="../Order" link-type="anchor" parameter-map="[orderType:'Sales']"><image url="/ssstatic/images/Sales.png" url-type="screen" style="invertible" width="40"/></link><container><link text="Sales Orders" url="../Order" link-type="anchor" parameter-map="[orderType:'Sales']"/></container></container></row-col></container-row><label text="&nbsp;" type="p" encode="false"/><container-row><row-col sm="6"><container><link url="../Asset/Asset/FindSummary" link-type="anchor" parameter-map="[assetTypeEnumId:'AstTpInventory']"><image url="/ssstatic/images/Inventory.png" url-type="screen" style="invertible" width="40"/></link><container><link text="Inventory Assets" url="../Asset/Asset/FindSummary" link-type="anchor" parameter-map="[assetTypeEnumId:'AstTpInventory']"/></container></container><container><link url="../Return" link-type="anchor"><image url="/ssstatic/images/Return.png" url-type="screen" style="invertible" width="40"/></link><container><link text="Returns" url="../Return" link-type="anchor"/></container></container></row-col><row-col sm="6"><container><link url="../Shipping" link-type="anchor"><image url="/ssstatic/images/Picking.png" url-type="screen" style="invertible" width="40"/></link><container><link text="Shipping" url="../Shipping" link-type="anchor"/></container></container><container><link url="../Shipment" link-type="anchor" parameter-map="[parentShipmentType:'ShpTpOutgoing']"><image url="/ssstatic/images/Shipping.png" url-type="screen" style="invertible" width="40"/></link><container><link text="Outgoing Shipments" url="../Shipment" link-type="anchor" parameter-map="[parentShipmentType:'ShpTpOutgoing']"/></container></container></row-col></container-row></row-col><row-col sm="2"><label text="&nbsp;" encode="false"/></row-col><row-col sm="4" style="text-center"><label text="Manage" type="h4"/><container-row><row-col sm="6"><container><link url="../Catalog" link-type="anchor"><image url="/ssstatic/images/Catalog.png" url-type="screen" style="invertible" width="40"/></link><container><link text="Catalog" url="../Catalog" link-type="anchor"/></container><container><link text="Products" url="../Catalog/Product" link-type="anchor"/></container><container><link text="Stores" url="../ProductStore" link-type="anchor"/></container></container></row-col><row-col sm="6"><container><link url="../Wiki" link-type="anchor"><image url="/ssstatic/images/Wiki.png" url-type="screen" style="invertible" width="40"/></link><container><link text="Wiki/Content" url="../Wiki/WikiSpaces" link-type="anchor"/></container><container><link text="Wiki Blogs" url="../Wiki/WikiBlogs" link-type="anchor"/></container><container><link text="Survey" url="../Survey" link-type="anchor"/></container></container></row-col></container-row><label text="&nbsp;" type="p" encode="false"/><container-row><row-col sm="6"><container><link url="../Manufacturing" link-type="anchor"><image url="/ssstatic/images/Asset.png" url-type="screen" style="invertible" width="40"/></link><container><link text="Manufacturing" url="../Manufacturing" link-type="anchor"/></container><container><link text="Assets" url="../Asset" link-type="anchor"/></container></container></row-col><row-col sm="6"><container><link url="../Party" link-type="anchor"><image url="/ssstatic/images/Parties.png" url-type="screen" style="invertible" width="40"/></link><container><link text="Parties" url="../Party" link-type="anchor"/></container></container></row-col></container-row><container-row><row-col sm="6"><container><link url="../Facility" link-type="anchor"><image url="/ssstatic/images/Facility.png" url-type="screen" style="invertible" width="40"/></link><container><link text="Facilities" url="../Facility" link-type="anchor"/></container></container></row-col><row-col sm="6"><container><link url="../Accounting" link-type="anchor"><image url="/ssstatic/images/Accounting.png" url-type="screen" style="invertible" width="40"/></link><container><link text="Accounting" url="../Accounting" link-type="anchor"/></container><container><link text="Reports" url="../Accounting/Reports" link-type="anchor"/></container></container></row-col></container-row><label text="&nbsp;" type="p" encode="false"/><container style="text-center"><link url="../QuickViewReport" text="Custom Reports" link-type="anchor"/><label text=" - "/><link url="../SimpleReport" text="Report Builder" link-type="anchor"/></container></row-col><row-col sm="1"><label text="&nbsp;" encode="false"/></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/SimpleScreens/QuickLookup.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-index="2" menu-image="fa fa-crosshairs" menu-image-type="icon"><transition name="assetDetail"><default-response url="//apps/${appRoot}/Asset/AssetDetail"/></transition><transition name="editFacility"><default-response url="//apps/${appRoot}/Facility/EditFacility"/></transition><transition name="orderDetail"><default-response url="//apps/${appRoot}/Order/OrderDetail"/></transition><transition name="editReturn"><default-response url="//apps/${appRoot}/Return/EditReturn"/></transition><transition name="shipmentDetail"><default-response url="//apps/${appRoot}/Shipment/ShipmentDetail"/></transition><transition name="picklistDetail"><default-response url="//apps/${appRoot}/Shipping/Picklist/PicklistDetail"/></transition><transition name="editRun"><default-response url="//apps/${appRoot}/Manufacturing/Run/EditRun"/></transition><transition name="projectSummary"><default-response url="//apps/${appRoot}/Project/ProjectSummary"/></transition><transition name="taskSummary"><default-response url="//apps/${appRoot}/Task/TaskSummary"/></transition><transition name="editParty"><default-response url="//apps/${appRoot}/Party/EditParty"/></transition><transition name="editSupplier"><default-response url="//apps/${appRoot}/Supplier/EditSupplier"/></transition><transition name="editCustomer"><default-response url="//apps/${appRoot}/Customer/EditCustomer"/></transition><transition name="editProduct"><default-response url="//apps/${appRoot}/Catalog/Product/EditProduct"/></transition><transition name="editPayment"><default-response url="//apps/${appRoot}/Accounting/Payment/EditPayment"/></transition><transition name="editInvoice"><default-response url="//apps/${appRoot}/Accounting/Invoice/EditInvoice"/></transition><transition name="editTransaction"><default-response url="//apps/${appRoot}/Accounting/Transaction/EditTransaction"/></transition><actions><service-call name="mantle.GeneralServices.lookup#ById" in-map="[lookupId:lookupId]" out-map="context"/></actions><widgets><label text="Lookup by ID for Asset, Facility, Invoice, Order, Return, Party, Badge, Payment, Product, Shipment, Work Effort (Picklist, Production Run), GL Transaction" type="p"/><form-single name="QuickLookupForm" transition="." focus-field="lookupId"><field name="lookupId"><default-field title=""><text-line size="20"/></default-field></field><field name="submitButton"><default-field title="Lookup by ID"><submit/></default-field></field><field-layout><field-row-big><field-ref name="lookupId"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single><label text="Results for ID '${lookupId}'" type="h4" condition="lookupId"/><section name="AssetSection" condition="asset != null"><actions><set field="aprod" from="asset.'mantle.product.Product'"/><set field="facLoc" from="asset.'mantle.facility.FacilityLocation'"/></actions><widgets><container-box><box-header title="Asset ${assetId}"/><box-toolbar><link url="assetDetail" text="Asset"/></box-toolbar><box-body><container-row><row-col md="1"><label text="Type" type="strong"/></row-col><row-col md="2"><label text="${asset.'AssetType#moqui.basic.Enumeration'?.description?:''}"/></row-col><row-col md="1"><label text="Facility" type="strong"/></row-col><row-col md="2"><link url="editFacility" text="${asset.'mantle.facility.Facility'?.facilityName?:''}" parameter-map="[facilityId:asset.facilityId]" link-type="anchor" condition="asset.facilityId"/></row-col><row-col md="1"><label text="ATP/QOH" type="strong"/></row-col><row-col md="2"><label text="${ec.l10n.format(asset.availableToPromiseTotal, null)}/${ec.l10n.format(asset.quantityOnHandTotal, null)} (${aprod.'Amount#moqui.basic.Uom'?.description?:'each'})"/></row-col><row-col md="2"><link url="editRun" text="WorkEffortNameTemplate" text-map="[workEffortId:asset.acquireWorkEffortId]" parameter-map="[workEffortId:asset.acquireWorkEffortId]" link-type="anchor" condition="asset.acquireWorkEffortId"/></row-col></container-row><container-row><row-col md="1"><label text="Product" type="strong"/></row-col><row-col md="2"><link url="editProduct" text="ProductNameTemplate" text-map="aprod" parameter-map="[productId:asset.productId]" link-type="anchor"/></row-col><row-col md="1"><label text="Location" type="strong"/></row-col><row-col md="2"><label text="FacilityLocationNameTemplate" text-map="facLoc?:[:]"/></row-col><row-col md="1"><label text="Received" type="strong"/></row-col><row-col md="2"><label text="${ec.l10n.format(asset.receivedDate, null)}"/></row-col><row-col md="1"><label text="From Shipment" type="strong"/></row-col><row-col md="2"><link url="shipmentDetail" text="${asset.acquireShipmentId}" parameter-map="[shipmentId:asset.acquireShipmentId]" link-type="anchor" condition="asset.acquireShipmentId"/></row-col></container-row></box-body></container-box></widgets></section><section name="FacilitySection" condition="facility != null"><actions><entity-find-one entity-name="mantle.party.PartyDetail" value-field="partyDetail"><field-map field-name="partyId" from="facility.ownerPartyId"/></entity-find-one></actions><widgets><container-box><box-header title="Facility: ${ec.resource.expand('FacilityNameTemplate','',facility)}"/><box-toolbar><link url="editFacility" text="Facility"/></box-toolbar><box-body><container-row><row-col md="1"><label text="Type" type="strong"/></row-col><row-col md="2"><label text="${facility.'FacilityType#moqui.basic.Enumeration'?.description?:''}"/></row-col><row-col md="1"><label text="Owner" type="strong"/></row-col><row-col md="2"><link url="editParty" text="PartyNameTemplate" text-map="partyDetail" parameter-map="[partyId:facility.ownerPartyId]" link-type="anchor" condition="partyDetail"/></row-col></container-row></box-body></container-box></widgets></section><section name="InvoiceSection" condition="invoice != null"><actions><entity-find-one entity-name="mantle.party.PartyDetail" value-field="fromParty"><field-map field-name="partyId" from="invoice.fromPartyId"/></entity-find-one><entity-find-one entity-name="mantle.party.PartyDetail" value-field="toParty"><field-map field-name="partyId" from="invoice.toPartyId"/></entity-find-one></actions><widgets><container-box><box-header title="Invoice ${invoiceId}"/><box-toolbar><link url="editInvoice" text="Invoice"/></box-toolbar><box-body><container-row><row-col md="1"><label text="Date" type="strong"/></row-col><row-col md="2"><label text="${ec.l10n.format(invoice.invoiceDate, null)}"/></row-col><row-col md="1"><label text="From" type="strong"/></row-col><row-col md="3"><link url="editParty" text="PartyNameTemplate" text-map="fromParty" parameter-map="[partyId:fromParty?.partyId]" link-type="anchor" condition="fromParty"/></row-col><row-col md="1"><label text="Description" type="strong"/></row-col><row-col md="4"><label text="${invoice.description?:''}"/></row-col></container-row><container-row><row-col md="1"><label text="Status" type="strong"/></row-col><row-col md="2"><label text="${invoice.'Invoice#moqui.basic.StatusItem'?.description?:''}"/></row-col><row-col md="1"><label text="To" type="strong"/></row-col><row-col md="3"><link url="editParty" text="PartyNameTemplate" text-map="toParty" parameter-map="[partyId:toParty?.partyId]" link-type="anchor" condition="toParty"/></row-col></container-row></box-body></container-box></widgets></section><section name="OrderSection" condition="orderHeader != null"><actions><set field="orderStatus" from="orderHeader.status"/><entity-find entity-name="mantle.order.OrderPart" list="orderPartList"><econdition field-name="orderId" from="orderHeader.orderId"/><order-by field-name="orderPartSeqId"/></entity-find><set field="firstPart" from="orderPartList ? orderPartList[0] : null"/><if condition="firstPart != null"><entity-find-one entity-name="mantle.party.PartyDetail" value-field="vendorParty"><field-map field-name="partyId" from="firstPart.vendorPartyId"/></entity-find-one><entity-find-one entity-name="mantle.party.PartyDetail" value-field="customerParty"><field-map field-name="partyId" from="firstPart.customerPartyId"/></entity-find-one></if></actions><widgets><container-box><box-header title="Order ${orderId}"/><box-toolbar><link url="orderDetail" text="Order"/></box-toolbar><box-body><container-row><row-col md="1"><label text="Status" type="strong"/></row-col><row-col md="2"><label text="${orderStatus?.description?:''}"/></row-col><row-col md="1"><label text="Vendor" type="strong"/></row-col><row-col md="3"><link url="editParty" text="PartyNameTemplate" text-map="vendorParty" parameter-map="[partyId:vendorParty?.partyId]" link-type="anchor" condition="vendorParty"/></row-col><row-col md="1"><label text="Customer" type="strong"/></row-col><row-col md="3"><link url="editParty" text="PartyNameTemplate" text-map="customerParty" parameter-map="[partyId:customerParty?.partyId]" link-type="anchor" condition="customerParty"/></row-col></container-row><container-row><row-col md="1"><label text="Total" type="strong"/></row-col><row-col md="2"><label text="${ec.l10n.formatCurrency(orderHeader.grandTotal, orderHeader.currencyUomId)}"/></row-col></container-row></box-body></container-box></widgets></section><section name="ReturnSection" condition="returnHeader != null"><actions><set field="returnStatus" from="returnHeader.status"/><entity-find-one entity-name="mantle.party.PartyDetail" value-field="vendorParty"><field-map field-name="partyId" from="returnHeader.vendorPartyId"/></entity-find-one><entity-find-one entity-name="mantle.party.PartyDetail" value-field="customerParty"><field-map field-name="partyId" from="returnHeader.customerPartyId"/></entity-find-one></actions><widgets><container-box><box-header title="Return ${returnId}"/><box-toolbar><link url="editReturn" text="Return"/></box-toolbar><box-body><container-row><row-col md="1"><label text="Status" type="strong"/></row-col><row-col md="2"><label text="${returnStatus?.description?:''}"/></row-col><row-col md="1"><label text="Vendor" type="strong"/></row-col><row-col md="3"><link url="editParty" text="PartyNameTemplate" text-map="vendorParty" parameter-map="[partyId:vendorParty?.partyId]" link-type="anchor" condition="vendorParty"/></row-col><row-col md="1"><label text="Customer" type="strong"/></row-col><row-col md="3"><link url="editParty" text="PartyNameTemplate" text-map="customerParty" parameter-map="[partyId:customerParty?.partyId]" link-type="anchor" condition="customerParty"/></row-col></container-row></box-body></container-box></widgets></section><section name="PartySection" condition="party != null"><actions><entity-find entity-name="mantle.party.PartyRole" list="roleList"><econdition field-name="partyId"/></entity-find><filter-map-list list="roleList" to-list="supplierRoleList"><field-map field-name="roleTypeId" value="Supplier"/></filter-map-list><filter-map-list list="roleList" to-list="customerRoleList"><field-map field-name="roleTypeId" value="Customer"/></filter-map-list><entity-find-one entity-name="moqui.basic.Enumeration" value-field="typeEnum"><field-map field-name="enumId" from="party.partyTypeEnumId"/></entity-find-one></actions><widgets><container-box><box-header title="Party: ${ec.resource.expand('PartyNameTemplate','',party)}"/><box-toolbar><link url="editParty" text="Party"/><link url="editSupplier" text="Supplier" condition="supplierRoleList"/><link url="editCustomer" text="Customer" condition="customerRoleList"/></box-toolbar><box-body><container-row><row-col md="1"><label text="Type" type="strong"/></row-col><row-col md="2"><label text="${typeEnum?.description?:''}"/></row-col><row-col md="1"><label text="Roles" type="strong"/></row-col><row-col md="8"><section-iterate name="RoleList" list="roleList" entry="role"><widgets><label text="${role.'mantle.party.RoleType'.description?:''}${role_has_next ? ', ' : ''}"/></widgets></section-iterate></row-col></container-row></box-body></container-box></widgets></section><section name="PaymentSection" condition="payment != null"><actions><entity-find-one entity-name="mantle.party.PartyDetail" value-field="fromParty"><field-map field-name="partyId" from="payment.fromPartyId"/></entity-find-one><entity-find-one entity-name="mantle.party.PartyDetail" value-field="toParty"><field-map field-name="partyId" from="payment.toPartyId"/></entity-find-one></actions><widgets><container-box><box-header title="Payment ${paymentId}"/><box-toolbar><link url="editPayment" text="Payment"/></box-toolbar><box-body><container-row><row-col md="1"><label text="Date" type="strong"/></row-col><row-col md="2"><label text="${ec.l10n.format(payment.effectiveDate, null)}"/></row-col><row-col md="1"><label text="From" type="strong"/></row-col><row-col md="3"><link url="editParty" text="PartyNameTemplate" text-map="fromParty" parameter-map="[partyId:fromParty?.partyId]" link-type="anchor" condition="fromParty"/></row-col><row-col md="1"><label text="Type" type="strong"/></row-col><row-col md="2"><label text="${payment.'PaymentType#moqui.basic.Enumeration'?.description?:''}"/></row-col><row-col md="1"><label text="Reference" type="strong"/></row-col><row-col md="1"><label text="${payment.paymentRefNum?:''}"/></row-col></container-row><container-row><row-col md="1"><label text="Status" type="strong"/></row-col><row-col md="2"><label text="${payment.'Payment#moqui.basic.StatusItem'?.description?:''}"/></row-col><row-col md="1"><label text="To" type="strong"/></row-col><row-col md="3"><link url="editParty" text="PartyNameTemplate" text-map="toParty" parameter-map="[partyId:toParty?.partyId]" link-type="anchor" condition="toParty"/></row-col><row-col md="1"><label text="Instrument" type="strong"/></row-col><row-col md="2"><label text="${payment.instrument?.description?:''}"/></row-col></container-row></box-body></container-box></widgets></section><section-iterate name="ProductSection" list="productList" entry="product"><actions><script><![CDATA[amountUom = product.'Amount#moqui.basic.Uom'
                pantMap = [:]
                pantMap.putAll((Map) product)
                if (amountUom != null) pantMap.putAll((Map) amountUom)]]></script></actions><widgets><container-box><box-header title="Product: ${ec.resource.expand('ProductNameTemplate','',product)}"/><box-toolbar><link url="editProduct" text="Product" parameter-map="[productId:product.productId]"/></box-toolbar><box-body><container-row><row-col md="1"><label text="Type" type="strong"/></row-col><row-col md="2"><label text="${product.'ProductType#moqui.basic.Enumeration'?.description?:''}"/></row-col><row-col md="1"><label text="Amount/UOM" type="strong"/></row-col><row-col md="2"><label text="ProductAmountNameTemplate" text-map="pantMap"/></row-col><row-col md="1"><label text="Description" type="strong"/></row-col><row-col md="5"><label text="${product.description?:''}"/></row-col></container-row></box-body></container-box></widgets></section-iterate><section name="ShipmentSection" condition="shipment != null"><actions><entity-find-one entity-name="mantle.party.PartyDetail" value-field="fromParty"><field-map field-name="partyId" from="shipment.fromPartyId"/></entity-find-one><entity-find-one entity-name="mantle.party.PartyDetail" value-field="toParty"><field-map field-name="partyId" from="shipment.toPartyId"/></entity-find-one><entity-find-one entity-name="mantle.shipment.ShipmentRouteSegment" value-field="srs"><field-map field-name="shipmentId"/></entity-find-one></actions><widgets><container-box><box-header title="Shipment ${shipmentId}"/><box-toolbar><link url="shipmentDetail" text="Shipment"/></box-toolbar><box-body><container-row><row-col md="1"><label text="Type" type="strong"/></row-col><row-col md="1"><label text="${shipment.'ShipmentType#moqui.basic.Enumeration'?.description?:''}"/></row-col><row-col md="1"><label text="Ready" type="strong"/></row-col><row-col md="1"><label text="${ec.l10n.format(shipment.estimatedReadyDate, null)}"/></row-col><row-col md="1"><label text="From" type="strong"/></row-col><row-col md="3"><link url="editParty" text="PartyNameTemplate" text-map="fromParty" parameter-map="[partyId:fromParty?.partyId]" link-type="anchor" condition="fromParty"/></row-col><row-col md="1"><label text="Origin" type="strong"/></row-col><row-col md="3"><link url="editFacility" text="${srs?.'Origin#mantle.facility.Facility'?.facilityName?:''}" parameter-map="[facilityId:srs.originFacilityId]" link-type="anchor" condition="srs.originFacilityId"/></row-col></container-row><container-row><row-col md="1"><label text="Status" type="strong"/></row-col><row-col md="1"><label text="${shipment.'Shipment#moqui.basic.StatusItem'?.description?:''}"/></row-col><row-col md="1"><label text="Arrival" type="strong"/></row-col><row-col md="1"><label text="${ec.l10n.format(shipment.estimatedArrivalDate, null)}"/></row-col><row-col md="1"><label text="To" type="strong"/></row-col><row-col md="3"><link url="editParty" text="PartyNameTemplate" text-map="toParty" parameter-map="[partyId:toParty?.partyId]" link-type="anchor" condition="toParty"/></row-col><row-col md="1"><label text="Destination" type="strong"/></row-col><row-col md="3"><link url="editFacility" text="${srs?.'Destination#mantle.facility.Facility'?.facilityName?:''}" parameter-map="[facilityId:srs.destinationFacilityId]" link-type="anchor" condition="srs.destinationFacilityId"/></row-col></container-row></box-body></container-box></widgets></section><section name="WorkEffortSection" condition="workEffort != null"><widgets><container-box><box-header title="Work Effort ${ec.resource.expand('WorkEffortNameTemplate','',workEffort)}"/><box-toolbar><link url="editRun" text="Production Run" condition="workEffort.purposeEnumId == 'WepProductionRun'"/><link url="picklistDetail" text="Picklist" condition="workEffort.purposeEnumId == 'WepShipmentShip'"/><link url="projectSummary" text="Picklist" condition="workEffort.workEffortTypeEnumId == 'WetProject'"/><link url="taskSummary" text="Picklist" condition="workEffort.workEffortTypeEnumId == 'WetTask'"/></box-toolbar><box-body><container-row><row-col lg="1"><label text="Type" type="strong"/></row-col><row-col lg="2"><label text="${workEffort.'WorkEffortType#moqui.basic.Enumeration'?.description?:''}"/></row-col><row-col lg="1"><label text="Status" type="strong"/></row-col><row-col lg="3"><label text="${workEffort.'WorkEffort#moqui.basic.StatusItem'?.description?:''}"/></row-col><row-col lg="1"><label text="Name" type="strong"/></row-col><row-col lg="4"><label text="${workEffort.workEffortName?:''}"/></row-col></container-row><container-row><row-col lg="1"><label text="Purpose" type="strong"/></row-col><row-col lg="2"><label text="${workEffort.'WorkEffortPurpose#moqui.basic.Enumeration'?.description?:''}"/></row-col><row-col lg="1"><label text="Facility" type="strong"/></row-col><row-col lg="3"><link url="editFacility" text="${workEffort?.'mantle.facility.Facility'?.facilityName?:''}" parameter-map="[facilityId:workEffort.facilityId]" link-type="anchor" condition="workEffort.facilityId"/></row-col><row-col lg="1"><label text="Schedule" type="strong"/></row-col><row-col lg="4"><label text="${ec.l10n.format(workEffort.estimatedStartDate, null)} ${workEffort.estimatedWorkDuration ? ec.l10n.format(workEffort.estimatedWorkDuration, null) + ' hours' : ''}"/></row-col></container-row></box-body></container-box></widgets></section><section name="AcctgTransSection" condition="acctgTrans != null"><actions><entity-find-one entity-name="moqui.basic.Enumeration" value-field="typeEnum"><field-map field-name="enumId" from="acctgTrans.acctgTransTypeEnumId"/></entity-find-one></actions><widgets><container-box><box-header title="GL Transaction ${acctgTransId}"/><box-toolbar><link url="editTransaction" text="GL Transaction"/></box-toolbar><box-body><container-row><row-col md="1"><label text="TX Type" type="strong"/></row-col><row-col md="3"><label text="${typeEnum?.description?:''}"/></row-col><row-col md="1"><label text="TX Date" type="strong"/></row-col><row-col md="3"><label text="${ec.l10n.format(acctgTrans.transactionDate, null)}"/></row-col><row-col md="1"><label text="Reverse Of" type="strong"/></row-col><row-col md="3"><link url="editTransaction" text="${acctgTrans.reverseOfAcctgTransId}" link-type="anchor" parameter-map="[acctgTransId:acctgTrans.reverseOfAcctgTransId]" condition="acctgTrans.reverseOfAcctgTransId"/></row-col></container-row><container-row><row-col md="1"><label text="Is Posted" type="strong"/></row-col><row-col md="3"><label text="${acctgTrans.isPosted}"/></row-col><row-col md="1"><label text="Posted Date" type="strong"/></row-col><row-col md="3"><label text="${ec.l10n.format(acctgTrans.postedDate, null)}"/></row-col><row-col md="1"><label text="Reversed By" type="strong"/></row-col><row-col md="3"><link url="editTransaction" text="${acctgTrans.reversedByAcctgTransId}" link-type="anchor" parameter-map="[acctgTransId:acctgTrans.reversedByAcctgTransId]" condition="acctgTrans.reversedByAcctgTransId"/></row-col></container-row><container-row><row-col md="1"><label text="Description" type="strong"/></row-col><row-col md="11"><label text="${acctgTrans.description?:''}" type="p"/></row-col></container-row></box-body></container-box></widgets></section></widgets></screen>
<!-- Screen Location component://PopCommerce/screen/PopCommerceAdmin/Request.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Requests" default-menu-index="5" menu-image="/ssstatic/images/Request.png"><subscreens default-item="FindRequest"><subscreens-item name="FindRequest" menu-include="false" location="component://SimpleScreens/screen/SimpleScreens/Request/FindRequest.xml"/><subscreens-item name="EditRequest" menu-index="1" location="component://SimpleScreens/screen/SimpleScreens/Request/EditRequest.xml"/><subscreens-item name="EditRequestItems" menu-index="2" location="component://SimpleScreens/screen/SimpleScreens/Request/EditRequestItems.xml"/></subscreens><widgets><subscreens-panel id="RequestPanel" type="tab"/></widgets></screen>
<!-- Screen Location component://PopCommerce/screen/PopCommerceAdmin/Supplier.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Suppliers" default-menu-index="11" menu-image="/ssstatic/images/Supplier.png"><subscreens default-item="FindSupplier"><subscreens-item name="FindSupplier" location="component://SimpleScreens/screen/SimpleScreens/Supplier/FindSupplier.xml" menu-include="false"/><subscreens-item name="EditSupplier" location="component://SimpleScreens/screen/SimpleScreens/Supplier/EditSupplier.xml" menu-index="1"/><subscreens-item name="FinancialInfo" location="component://SimpleScreens/screen/SimpleScreens/Party/FinancialInfo.xml" menu-index="11"/></subscreens><pre-actions><set field="roleTypeId" value="Supplier"/></pre-actions><actions><entity-find-one entity-name="mantle.party.PartyDetail" value-field="partyDetail"/></actions><widgets><label text="PartyNameTemplate" text-map="partyDetail" type="strong" condition="partyDetail"/><subscreens-panel id="supplier-panel" type="tab"/></widgets></screen>
<!-- Screen Location component://PopCommerce/screen/PopCommerceAdmin/Customer.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Customers" default-menu-index="12" menu-image="/ssstatic/images/Customer.png"><subscreens default-item="FindCustomer"><subscreens-item name="CustomerData" location="component://SimpleScreens/screen/SimpleScreens/Customer/CustomerData.xml" menu-include="false"/><subscreens-item name="FindCustomer" location="component://SimpleScreens/screen/SimpleScreens/Customer/FindCustomer.xml" menu-include="false"/><subscreens-item name="EditCustomer" location="component://SimpleScreens/screen/SimpleScreens/Customer/EditCustomer.xml" menu-index="1"/><subscreens-item name="FinancialInfo" location="component://SimpleScreens/screen/SimpleScreens/Party/FinancialInfo.xml" menu-index="11"/></subscreens><pre-actions><set field="roleTypeId" value="Customer"/></pre-actions><actions><entity-find-one entity-name="mantle.party.PartyDetail" value-field="partyDetail"/></actions><widgets><label text="PartyNameTemplate" text-map="partyDetail" type="strong" condition="partyDetail"/><subscreens-panel id="CustomerPanel" type="tab"/></widgets></screen>
<!-- Screen Location component://PopCommerce/screen/PopCommerceAdmin/Order.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Orders" default-menu-index="13" menu-image="/ssstatic/images/Sales.png"><subscreens default-item="FindOrder"><subscreens-item name="FindOrder" menu-include="false" location="component://SimpleScreens/screen/SimpleScreens/Order/FindOrder.xml"/><subscreens-item name="OrderDetail" menu-index="1" location="component://SimpleScreens/screen/SimpleScreens/Order/OrderDetail.xml"/><subscreens-item name="OrderItems" menu-index="2" location="component://SimpleScreens/screen/SimpleScreens/Order/OrderItems.xml"/><subscreens-item name="QuickItems" menu-index="3" location="component://SimpleScreens/screen/SimpleScreens/Order/QuickItems.xml"/><subscreens-item name="PrintOrder" menu-include="false" location="component://SimpleScreens/screen/SimpleScreens/Order/PrintOrder.xml"/><subscreens-item name="OrderIssuedInvoiced" menu-include="false" location="component://SimpleScreens/screen/SimpleScreens/Accounting/Reports/OrderIssuedInvoiced.xml"/><subscreens-item name="SalesAnalysis" menu-include="false" location="component://SimpleScreens/screen/SimpleScreens/Accounting/Reports/SalesAnalysis.xml"/><subscreens-item name="SalesSummary" menu-include="false" location="component://SimpleScreens/screen/SimpleScreens/Accounting/Reports/SalesSummary.xml"/></subscreens><widgets><label text="Order ${orderId}" type="strong" condition="orderId"/><subscreens-panel id="OrderPanel" type="tab"/></widgets></screen>
<!-- Screen Location component://PopCommerce/screen/PopCommerceAdmin/Shipping.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Shipping" default-menu-index="14" menu-image="/ssstatic/images/Picking.png"><subscreens default-item="dashboard"><subscreens-item name="dashboard" menu-index="1" location="component://SimpleScreens/screen/SimpleScreens/Shipping/dashboard.xml"/><subscreens-item name="Picklist" menu-index="3" location="component://SimpleScreens/screen/SimpleScreens/Shipping/Picklist.xml"/><subscreens-item name="PickLocationMoves" menu-index="4" location="component://SimpleScreens/screen/SimpleScreens/Shipping/PickLocationMoves.xml"/><subscreens-item name="PackShipment" menu-include="false" location="component://SimpleScreens/screen/SimpleScreens/Shipping/PackShipment.xml"/><subscreens-item name="ShipmentPack" menu-include="false" location="component://SimpleScreens/screen/SimpleScreens/Shipment/ShipmentPack.xml"/><subscreens-item name="ShipmentByPackage" menu-include="false" location="component://SimpleScreens/screen/SimpleScreens/Shipment/ShipmentByPackage.xml"/><subscreens-item name="ShipmentInsert" menu-include="false" location="component://SimpleScreens/screen/SimpleScreens/Shipment/ShipmentInsert.xml"/></subscreens><widgets><subscreens-panel id="ShippingPanel" type="popup"/></widgets></screen>
<!-- Screen Location component://PopCommerce/screen/PopCommerceAdmin/Shipment.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Shipments" default-menu-index="15" menu-image="/ssstatic/images/Shipping.png"><subscreens default-item="FindShipment"><subscreens-item name="FindShipment" menu-include="false" location="component://SimpleScreens/screen/SimpleScreens/Shipment/FindShipment.xml"/><subscreens-item name="PackageTracking" menu-include="false" location="component://SimpleScreens/screen/SimpleScreens/Shipment/PackageTracking.xml"/><subscreens-item name="ShipmentDetail" menu-index="1" location="component://SimpleScreens/screen/SimpleScreens/Shipment/ShipmentDetail.xml"/><subscreens-item name="ShipmentItems" menu-index="2" location="component://SimpleScreens/screen/SimpleScreens/Shipment/ShipmentItems.xml"/><subscreens-item name="ShipmentPackages" menu-index="3" location="component://SimpleScreens/screen/SimpleScreens/Shipment/ShipmentPackages.xml"/><subscreens-item name="ShipmentInsert" menu-include="false" location="component://SimpleScreens/screen/SimpleScreens/Shipment/ShipmentInsert.xml"/><subscreens-item name="ShipmentPack" menu-include="false" location="component://SimpleScreens/screen/SimpleScreens/Shipment/ShipmentPack.xml"/><subscreens-item name="ShipmentPick" menu-include="false" location="component://SimpleScreens/screen/SimpleScreens/Shipment/ShipmentPick.xml"/><subscreens-item name="ShipmentByPackage" menu-include="false" location="component://SimpleScreens/screen/SimpleScreens/Shipment/ShipmentByPackage.xml"/></subscreens><widgets><label text="Shipment ${shipmentId}" type="strong" condition="shipmentId"/><subscreens-panel id="ShipmentPanel"/></widgets></screen>
<!-- Screen Location component://PopCommerce/screen/PopCommerceAdmin/Return.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Returns" default-menu-index="16" menu-image="/ssstatic/images/Return.png"><subscreens default-item="FindReturn"><subscreens-item name="FindReturn" menu-include="false" location="component://SimpleScreens/screen/SimpleScreens/Return/FindReturn.xml"/><subscreens-item name="EditReturn" menu-index="1" location="component://SimpleScreens/screen/SimpleScreens/Return/EditReturn.xml"/><subscreens-item name="EditReturnItems" menu-index="2" location="component://SimpleScreens/screen/SimpleScreens/Return/EditReturnItems.xml"/><subscreens-item name="AddOrderItems" menu-index="3" location="component://SimpleScreens/screen/SimpleScreens/Return/AddOrderItems.xml"/></subscreens><widgets><widgets><subscreens-panel id="ReturnPanel" type="tab"/></widgets></widgets></screen>
<!-- Screen Location component://PopCommerce/screen/PopCommerceAdmin/Asset.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-index="17" default-menu-title="Assets" menu-image="/ssstatic/images/Asset.png"><subscreens default-item="dashboard"><subscreens-item name="dashboard" menu-title="Dashboard" menu-index="1" location="component://SimpleScreens/screen/SimpleScreens/Asset/dashboard.xml"/><subscreens-item name="Asset" menu-title="Assets" menu-index="2" location="component://SimpleScreens/screen/SimpleScreens/Asset/Asset.xml"/><subscreens-item name="PhysicalInventory" menu-title="Physical Inventory" menu-index="3" location="component://SimpleScreens/screen/SimpleScreens/Asset/PhysicalInventory.xml"/><subscreens-item name="EditLots" menu-title="Lots" menu-index="4" location="component://SimpleScreens/screen/SimpleScreens/Asset/EditLots.xml"/><subscreens-item name="Container" menu-title="Containers" menu-index="5" location="component://SimpleScreens/screen/SimpleScreens/Asset/Container.xml"/><subscreens-item name="AssetPool" menu-title="Pools" menu-index="6" location="component://SimpleScreens/screen/SimpleScreens/Asset/AssetPool.xml"/></subscreens><widgets><subscreens-panel id="AssetPanel" type="popup"/></widgets></screen>
<!-- Screen Location component://PopCommerce/screen/PopCommerceAdmin/Wiki.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Wiki/Content" default-menu-index="21" menu-image="/ssstatic/images/Wiki.png"><subscreens default-item="WikiSpaces"><subscreens-item name="WikiSpaces" menu-index="1" location="component://SimpleScreens/screen/SimpleScreens/Wiki/WikiSpaces.xml"/><subscreens-item name="WikiBlogs" menu-index="2" location="component://SimpleScreens/screen/SimpleScreens/Wiki/WikiBlogs.xml"/><subscreens-item name="EditWikiSpace" menu-include="false" location="component://SimpleScreens/screen/SimpleScreens/Wiki/EditWikiSpace.xml"/><subscreens-item name="EditWikiPage" menu-include="false" location="component://SimpleScreens/screen/SimpleScreens/Wiki/EditWikiPage.xml"/><subscreens-item name="ViewWikiPage" menu-include="false" location="component://SimpleScreens/screen/SimpleScreens/Wiki/ViewWikiPage.xml"/><subscreens-item name="EditWikiBlog" menu-include="false" location="component://SimpleScreens/screen/SimpleScreens/Wiki/EditWikiBlog.xml"/><subscreens-item name="wiki" menu-include="false" location="component://SimpleScreens/screen/SimpleScreens/Wiki/wiki.xml"/><subscreens-item name="WikiCompare" menu-include="false" location="component://SimpleScreens/screen/SimpleScreens/Wiki/WikiCompare.xml"/></subscreens><widgets><subscreens-panel id="WikiPanel" type="popup"/></widgets></screen>
<!-- Screen Location component://PopCommerce/screen/PopCommerceAdmin/Catalog.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Catalog" default-menu-index="22" menu-image="/ssstatic/images/Catalog.png"><subscreens default-item="dashboard"><subscreens-item name="dashboard" location="component://SimpleScreens/screen/SimpleScreens/Catalog/dashboard.xml"/><subscreens-item name="Category" location="component://SimpleScreens/screen/SimpleScreens/Catalog/Category.xml"/><subscreens-item name="Feature" location="component://SimpleScreens/screen/SimpleScreens/Catalog/Feature.xml"/><subscreens-item name="FeatureGroup" location="component://SimpleScreens/screen/SimpleScreens/Catalog/FeatureGroup.xml"/><subscreens-item name="Product" location="component://SimpleScreens/screen/SimpleScreens/Catalog/Product.xml"/><subscreens-item name="Search" location="component://SimpleScreens/screen/SimpleScreens/Catalog/Search.xml"/></subscreens><widgets><subscreens-panel id="CatalogPanel" type="popup"/></widgets></screen>
<!-- Screen Location component://PopCommerce/screen/PopCommerceAdmin/Facility.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Facilities" default-menu-index="23" menu-image="/ssstatic/images/Facility.png"><subscreens default-item="FindFacility"><subscreens-item name="FindFacility" menu-include="false" location="component://SimpleScreens/screen/SimpleScreens/Facility/FindFacility.xml"/><subscreens-item name="EditFacility" menu-index="1" location="component://SimpleScreens/screen/SimpleScreens/Facility/EditFacility.xml"/><subscreens-item name="EditFacilityLocations" menu-index="2" location="component://SimpleScreens/screen/SimpleScreens/Facility/EditFacilityLocations.xml"/><subscreens-item name="FacilityCalendar" menu-index="3" location="component://SimpleScreens/screen/SimpleScreens/Facility/FacilityCalendar.xml"/><subscreens-item name="EditFacilityProducts" menu-index="4" location="component://SimpleScreens/screen/SimpleScreens/Facility/EditFacilityProducts.xml"/><subscreens-item name="BoxTypes" menu-include="false" location="component://SimpleScreens/screen/SimpleScreens/Facility/BoxTypes.xml"/><subscreens-item name="PrintBoxTypes" menu-include="false" location="component://SimpleScreens/screen/SimpleScreens/Facility/PrintBoxTypes.xml"/><subscreens-item name="CarrierShipMethods" menu-include="false" location="component://SimpleScreens/screen/SimpleScreens/Facility/CarrierShipMethods.xml"/></subscreens><actions><entity-find-one entity-name="mantle.facility.Facility" value-field="facility"/></actions><widgets><label text="FacilityNameTemplate" text-map="facility" type="strong" condition="facility"/><subscreens-panel id="FacilityPanel" type="tab"/></widgets></screen>
<!-- Screen Location component://PopCommerce/screen/PopCommerceAdmin/Party.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Parties" default-menu-index="24" menu-image="/ssstatic/images/Parties.png"><subscreens default-item="FindParty"><subscreens-item name="FindParty" location="component://SimpleScreens/screen/SimpleScreens/Party/FindParty.xml" menu-include="false"/><subscreens-item name="EditParty" location="component://SimpleScreens/screen/SimpleScreens/Party/EditParty.xml" menu-index="1"/><subscreens-item name="PartyCalendar" location="component://SimpleScreens/screen/SimpleScreens/Party/PartyCalendar.xml" menu-index="2"/><subscreens-item name="PartyEmails" location="component://SimpleScreens/screen/SimpleScreens/Party/PartyEmails.xml" menu-index="3"/><subscreens-item name="PartyMessages" location="component://SimpleScreens/screen/SimpleScreens/Party/PartyMessages.xml" menu-index="3"/><subscreens-item name="PartyRelated" location="component://SimpleScreens/screen/SimpleScreens/Party/PartyRelated.xml" menu-index="4"/><subscreens-item name="PartyTimeEntries" location="component://SimpleScreens/screen/SimpleScreens/Party/PartyTimeEntries.xml" menu-index="5"/><subscreens-item name="PartyAgreements" location="component://SimpleScreens/screen/SimpleScreens/Party/PartyAgreements.xml" menu-index="6"/><subscreens-item name="FinancialInfo" location="component://SimpleScreens/screen/SimpleScreens/Party/FinancialInfo.xml" menu-index="11"/><subscreens-item name="PaymentMethod" location="component://SimpleScreens/screen/SimpleScreens/Party/PaymentMethod.xml" menu-include="false"/></subscreens><actions><entity-find-one entity-name="mantle.party.PartyDetail" value-field="partyDetail"/></actions><widgets><label text="PartyNameTemplate" text-map="partyDetail" type="strong" condition="partyDetail"/><subscreens-panel id="PartyPanel" type="tab"/></widgets></screen>
<!-- Screen Location component://PopCommerce/screen/PopCommerceAdmin/Accounting.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Accounting" default-menu-index="27" menu-image="/ssstatic/images/Accounting.png"><subscreens default-item="dashboard"><subscreens-item name="dashboard" menu-index="1" location="component://SimpleScreens/screen/SimpleScreens/Accounting/dashboard.xml"/><subscreens-item name="Invoice" menu-index="2" location="component://SimpleScreens/screen/SimpleScreens/Accounting/Invoice.xml"/><subscreens-item name="Payment" menu-index="3" location="component://SimpleScreens/screen/SimpleScreens/Accounting/Payment.xml"/><subscreens-item name="FinancialAccount" menu-index="4" menu-title="Financial Accounts" location="component://SimpleScreens/screen/SimpleScreens/Accounting/FinancialAccount.xml"/><subscreens-item name="Transaction" menu-index="5" location="component://SimpleScreens/screen/SimpleScreens/Accounting/Transaction.xml"/><subscreens-item name="FindJournal" menu-index="6" location="component://SimpleScreens/screen/SimpleScreens/Accounting/FindJournal.xml"/><subscreens-item name="TimePeriod" menu-index="7" location="component://SimpleScreens/screen/SimpleScreens/Accounting/TimePeriod.xml"/><subscreens-item name="GlAccount" menu-index="10" location="component://SimpleScreens/screen/SimpleScreens/Accounting/GlAccount.xml"/><subscreens-item name="Budget" menu-index="18" location="component://SimpleScreens/screen/SimpleScreens/Accounting/Budget.xml"/><subscreens-item name="Reports" menu-index="20" location="component://SimpleScreens/screen/SimpleScreens/Accounting/Reports.xml"/><subscreens-item name="OrgSettings" menu-include="false" location="component://SimpleScreens/screen/SimpleScreens/Accounting/OrgSettings.xml"/></subscreens><widgets><subscreens-panel id="accounting-panel" type="popup"/></widgets></screen>
<!-- Screen Location component://PopCommerce/screen/PopCommerceAdmin.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="POPC ERP" menu-image="fa fa-shopping-cart" menu-image-type="icon" server-static="vuet,qvt"><always-actions><set field="appRoot" value="PopcAdmin"/><set field="searchIndexName" value="mantle"/><set field="searchLinkSets" value="PopcAdmin"/><set field="searchProductDocType" value="MantleProduct"/><set field="searchPartyDocType" value="MantleParty"/><set field="appUserGroupTypeEnumId" value="UgtPopcAdmin"/><service-call name="mantle.party.PartyServices.setup#UserOrganizationInfo" out-map="context"/></always-actions><subscreens default-item="dashboard" always-use-full-path="true"><subscreens-item name="Search" location="component://SimpleScreens/screen/SimpleScreens/Search.xml" menu-index="2"/><subscreens-item name="QuickLookup" location="component://SimpleScreens/screen/SimpleScreens/QuickLookup.xml" menu-index="2"/><subscreens-item name="QuickSearch" location="component://SimpleScreens/screen/SimpleScreens/QuickSearch.xml" menu-index="3"/><subscreens-item name="Survey" location="component://SimpleScreens/screen/SimpleScreens/Survey.xml" menu-index="18"/><subscreens-item name="Manufacturing" location="component://SimpleScreens/screen/SimpleScreens/Manufacturing.xml" menu-index="19"/><subscreens-item name="ProductStore" location="component://SimpleScreens/screen/SimpleScreens/ProductStore.xml" menu-index="23"/><subscreens-item name="Gateway" location="component://SimpleScreens/screen/SimpleScreens/Gateway.xml" menu-index="24"/><subscreens-item name="QuickViewReport" menu-title="Custom Reports" menu-index="30" location="component://SimpleScreens/screen/SimpleScreens/SimpleReport/QuickViewReport.xml"/><subscreens-item name="SimpleReport" menu-title="Report Builder" menu-index="31" location="component://SimpleScreens/screen/SimpleScreens/SimpleReport.xml"/></subscreens><widgets><section name="OrgChooserSection" condition="hideNav != 'true'"><widgets><render-mode><text type="html"><![CDATA[<div id="active-org-menu" class="nav navbar-right dropdown"><a id="active-org-menu-link" href="#" class="dropdown-toggle btn btn-default btn-sm navbar-btn" data-toggle="dropdown" title="Organization"><i class="fa fa-globe"></i> ${(activeOrg.pseudoId)!}</a><ul class="dropdown-menu"><#if activeOrg?has_content><li><a href="${sri.buildUrl('/apps/setPrefGoLast').url}?preferenceKey=ACTIVE_ORGANIZATION&preferenceValue=">Clear Active Organization</a></li></#if><#if userOrgList?has_content><#list userOrgList as userOrg><li><a href="${sri.buildUrl('/apps/setPrefGoLast').url}?preferenceKey=ACTIVE_ORGANIZATION&preferenceValue=${userOrg.partyId}">${userOrg.pseudoId}: ${userOrg.organizationName}</a></li></#list></#if></ul></div><script>$("#navbar-buttons").append($("#active-org-menu")); $('#active-org-menu-link').tooltip({ placement:'bottom', trigger:'hover' });</script>]]></text></render-mode></widgets></section><subscreens-panel id="PopCommerceAdminPanel" type="popup" title="POPC ERP"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/BasicHandheld/Warehouse/dashboard.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Dashboard" default-menu-index="1"><transition-include name="getFacilityList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><transition-include name="setActiveFacility" location="component://SimpleScreens/screen/SimpleScreens/Asset/Asset/SelectAsset.xml"/><transition name="checkScanInput" read-only="true"><service-call name="mantle.facility.FacilityServices.get#ScannedIdGeneral" in-map="true" out-map="context" multi="parameter"/><conditional-response url="../Asset/MoveAsset"><condition><expression><![CDATA[assetId]]></expression></condition></conditional-response><default-response url="../Asset/SelectAsset"/></transition><actions><set field="facilityId" from="facilityId ?: ec.user.getPreference('FacilityActive') ?: ec.user.getPreference('FacilityGeneralDefault')"/></actions><widgets><container-row><row-col md="6"><container style="text-center"><form-single name="ActiveFacilityForm" transition="setActiveFacility"><field name="facilityId"><default-field title="Active Warehouse"><drop-down><dynamic-options transition="getFacilityList" server-search="true" min-length="0" parameter-map="[facilityTypeEnumId:'FcTpWarehouse']"/></drop-down></default-field></field><field name="submitButton"><default-field title="Set WH"><submit/></default-field></field><field-layout><field-row-big><field-ref name="facilityId"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single><form-single name="ScanAssetForm" transition="checkScanInput" focus-field="scanId"><field name="scanId"><default-field title="Scan Asset, Cont, Loc, or Prod"><text-line size="24"/></default-field></field><field name="submitButton"><default-field title="Move"><submit/></default-field></field><field-layout><field-row-big><field-ref name="scanId"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single></container></row-col><row-col md="6"><container style="text-center"><form-single name="PackShipmentForm" transition="../Shipping/PackShipment"><field name="shipmentId"><default-field title="Scan Shipment ID"><text-line size="20"/></default-field></field><field name="packButton"><default-field title="Pack Shipment"><submit/></default-field></field><field-layout><field-row-big><field-ref name="shipmentId"/><field-ref name="packButton"/></field-row-big></field-layout></form-single></container></row-col></container-row><container style="text-center"><container><link url="../Asset/SelectAsset" text="Select Move"/><link url="../Shipping/PickLocationMoves" text="Pick Moves Needed"/></container><container><link url="../Asset/ReceiveAsset" text="Receive Direct"/></container></container></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/BasicHandheld/Warehouse/Asset/SelectAsset.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" default-menu-title="Move Asset"><parameter name="facilityId"/><parameter name="locationSeqId"/><parameter name="containerId"/><parameter name="productId"/><parameter name="assetPoolId"/><parameter name="lotId"/><parameter name="quantity"/><parameter name="toScanLocation"/><transition name="moveAsset"><default-response url="../MoveAsset"/></transition><transition name="assetDetail"><default-response url="../MoveAsset"/></transition><transition name="setActiveFacility"><actions><script><![CDATA[ec.user.setPreference('FacilityActive', facilityId)]]></script></actions><default-response url="."/></transition><transition name="checkScanInput" read-only="true"><service-call name="mantle.facility.FacilityServices.get#ScannedIdGeneral" in-map="true" out-map="context" multi="parameter"/><conditional-response url="../MoveAsset"><condition><expression><![CDATA[assetId]]></expression></condition></conditional-response><default-response url="."/></transition><transition name="moveProduct"><service-call name="mantle.product.AssetServices.move#Product" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getFacilityList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><transition-include name="getAssetPoolList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition name="assetMove"><actions><entity-find-one entity-name="mantle.product.asset.Asset" value-field="asset"><field-map field-name="assetId" from="scanId"/></entity-find-one><set field="assetId" from="asset?.assetId"/><if condition="asset == null"><message error="true"><![CDATA[No asset found for ID ${scanId}]]></message></if></actions><conditional-response url="../MoveAsset" parameter-map="[assetId:assetId]"><condition><expression><![CDATA[assetId]]></expression></condition></conditional-response><default-response url="."/></transition><actions><set field="facilityId" from="facilityId ?: ec.user.getPreference('FacilityActive') ?: ec.user.getPreference('FacilityGeneralDefault')"/><if condition="containerId"><entity-find entity-name="mantle.product.asset.AssetSummaryView" list="contAssetList"><econdition field-name="containerId"/><econdition field-name="productId" ignore-if-empty="true"/><having-econditions><econdition field-name="quantityOnHandTotal" operator="greater" from="0.0"/></having-econditions><select-field field-name="productId,pseudoId,productName,quantityOnHandTotal"/></entity-find><if condition="!productId && contAssetList.size() == 1"><set field="productId" from="contAssetList[0].productId"/></if></if><if condition="facilityId && locationSeqId"><entity-find entity-name="mantle.product.asset.AssetSummaryView" list="locAssetList"><econdition field-name="facilityId"/><econdition field-name="locationSeqId"/><econdition field-name="productId" ignore-if-empty="true"/><having-econditions><econdition field-name="quantityOnHandTotal" operator="greater" from="0.0"/></having-econditions><select-field field-name="productId,pseudoId,productName,quantityOnHandTotal"/></entity-find><if condition="!productId && locAssetList.size() == 1"><set field="productId" from="locAssetList[0].productId"/></if></if><if condition="facilityId && productId"><entity-find entity-name="mantle.product.asset.AssetSummaryView" list="prodAssetList"><econdition field-name="facilityId"/><econdition field-name="productId"/><econdition field-name="locationSeqId" ignore-if-empty="true"/><having-econditions><econdition field-name="quantityOnHandTotal" operator="greater" from="0.0"/></having-econditions><select-field field-name="locationSeqId,containerId,quantityOnHandTotal"/></entity-find><if condition="!locationSeqId && prodAssetList.size() == 1"><set field="locationSeqId" from="prodAssetList[0].locationSeqId"/></if></if><if condition="facilityId"><entity-find-one entity-name="mantle.facility.Facility" value-field="facility"/></if><if condition="containerId"><entity-find-one entity-name="mantle.product.asset.Container" value-field="container"/></if><if condition="locationSeqId"><entity-find-one entity-name="mantle.facility.FacilityLocation" value-field="facilityLocation"/></if><if condition="productId"><entity-find-one entity-name="mantle.product.Product" value-field="product"/></if><if condition="productId && facilityId"><entity-find entity-name="mantle.facility.ProductFacilityLocationDetail" list="pickLocList" distinct="true"><econdition field-name="productId"/><econdition field-name="facilityId"/><econdition field-name="locationTypeEnumId" value="FltPick"/><select-field field-name="locationSeqId,description,areaId,aisleId,sectionId,levelId,positionId"/></entity-find><if condition="!pickLocList"><entity-find entity-name="mantle.product.asset.AssetLocationDetail" list="pickLocList" distinct="true"><econdition field-name="productId"/><econdition field-name="facilityId"/><econdition field-name="locationTypeEnumId" value="FltPick"/><select-field field-name="locationSeqId,description,areaId,aisleId,sectionId,levelId,positionId"/></entity-find></if></if><set field="canMove" from="product != null && facility != null"/><if condition="toScanLocation && facilityId"><service-call name="mantle.product.AssetServices.check#ScanLocation" out-map="toScanOut" in-map="[facilityId:facilityId, scanLocation:toScanLocation]"/><if condition="!toScanOut.locationSeqId && !toScanOut.containerId"><set field="createContainerId" from="toScanLocation"/><set field="toScanLocation" from="null"/></if></if></actions><widgets><section name="ScanInputAndFacility"><widgets><container-row style="text-center"><row-col sm="5"><form-single name="ScanAssetForm" transition="checkScanInput" focus-field="scanId"><field name="facilityId"><default-field><hidden/></default-field></field><field name="locationSeqId"><default-field><hidden/></default-field></field><field name="containerId"><default-field><hidden/></default-field></field><field name="productId"><default-field><hidden/></default-field></field><field name="scanId"><default-field title="Scan Asset, Cont, Loc, Prod"><text-line size="16"/></default-field></field><field name="submitButton"><default-field title="Go"><submit/></default-field></field><field-layout><field-row-big><field-ref name="scanId"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single></row-col><row-col sm="7"><form-single name="ActiveFacilityForm" transition="setActiveFacility"><field name="productId"><default-field><hidden/></default-field></field><field name="facilityId"><default-field title="Active Warehouse"><drop-down><dynamic-options transition="getFacilityList" server-search="true" min-length="0" parameter-map="[facilityTypeEnumId:'FcTpWarehouse']"/></drop-down></default-field></field><field name="submitButton"><default-field title="Set WH"><submit/></default-field></field><field-layout><field-row-big><field-ref name="facilityId"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single></row-col></container-row></widgets><fail-widgets><label text="Facility " type="strong" condition="facility"/><label text="${ec.resource.expand('FacilityNameTemplate', null, facility)}" type="span" condition="facility"/></fail-widgets></section><container-row><row-col sm="4"><label text="Location " type="strong" condition="facilityLocation"/><label text="${ec.resource.expand('FacilityLocationNameTemplate', null, facilityLocation)}" type="span" condition="facilityLocation"/><section-iterate name="LocAssetSummary" list="locAssetList" entry="locAsset"><widgets><label text="${ec.resource.expand('ProductNameTemplate', null, locAsset)} - Qty ${ec.l10n.format(locAsset.quantityOnHandTotal, null)}" type="div"/></widgets></section-iterate></row-col><row-col sm="4"><label text="Container " type="strong" condition="container"/><label text="${ec.resource.expand('ContainerNameTemplate', null, container)}" type="span" condition="container"/><section-iterate name="ContAssetSummary" list="contAssetList" entry="contAsset"><widgets><label text="${ec.resource.expand('ProductNameTemplate', null, contAsset)} - Qty ${ec.l10n.format(contAsset.quantityOnHandTotal, null)}" type="div"/></widgets></section-iterate></row-col><row-col sm="4"><label text="Product " type="strong" condition="product"/><label text="${ec.resource.expand('ProductNameTemplate', null, product)}" type="span" condition="product"/></row-col></container-row><container><label text="Pick Locations " type="strong" condition="pickLocList"/><section-iterate name="RecLocList" list="pickLocList" entry="recLoc"><widgets><label text="${locationSeqId?:''} ${description?:''} [${areaId?:' '}:${aisleId?:' '}:${sectionId?:' '}:${levelId?:' '}:${positionId?:' '}]" text-map="recLoc" type="span"/></widgets></section-iterate></container><link url="." text="Reset Selections" condition="containerId || locationSeqId || productId" parameter-map="[containerId:null, locationSeqId:null, productId:null]"/><link url="moveContainer" text="Move Container" condition="containerId"/><section name="MoveFormsSection" condition="canMove"><widgets><form-single name="ScanMoveAssetForm" transition="moveProduct" focus-field="scanLocation"><field name="facilityId"><default-field><hidden/></default-field></field><field name="locationSeqId"><default-field><hidden/></default-field></field><field name="containerId"><default-field><hidden/></default-field></field><field name="productId"><default-field><hidden/></default-field></field><field name="assetPoolId"><default-field title="From Pool"><drop-down allow-empty="true"><entity-options key="${assetPoolId}" text="${pseudoId}: ${description}"><entity-find entity-name="mantle.product.asset.AssetAndPool" distinct="true"><econdition field-name="facilityId"/><econdition field-name="productId"/><econditions combine="or"><econdition field-name="locationSeqId"/><econdition field-name="containerId"/></econditions><select-field field-name="assetPoolId,pseudoId,description"/></entity-find></entity-options></drop-down></default-field></field><field name="createContMessage"><conditional-field condition="createContainerId" title=""><label text="Scanned ID was not a known location or container, scan a location to create a container with the ID" style="text-warning"/></conditional-field></field><field name="toScanLocation"><default-field title="Scan To Location" tooltip="Can be Location ID or Container ID or Serial Number (Plate ID)"><text-line size="20"/></default-field></field><field name="createContainerId"><default-field title="Create Container ID"><text-line size="20"/></default-field></field><field name="toAssetPoolId"><default-field title="To Pool"><drop-down allow-empty="true"><dynamic-options transition="getAssetPoolList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="quantity"><default-field title="Quantity"><text-line size="20"/></default-field></field><field name="submitButton"><default-field title="Move Asset(s)"><submit/></default-field></field></form-single></widgets></section><section name="ContainerSection" condition="container != null"><widgets><section name="ContainerProductSection" condition="product != null"><widgets><form-list name="ContainerAssetList" list="contAssetList" skip-form="true"><entity-find entity-name="mantle.product.asset.Asset" list="contAssetList" limit="10"><econdition field-name="containerId"/><econdition field-name="productId"/><econdition field-name="quantityOnHandTotal" operator="greater" from="0.0"/><order-by field-name="-quantityOnHandTotal"/></entity-find><field name="assetId"><default-field title="Cont. Asset"><link url="assetDetail" text="${assetId}" link-type="anchor"/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="receivedDate"><default-field title="Received"><display format="yyyy-MM-dd"/></default-field></field><field name="quantityOnHandTotal"><default-field title="QOH"><display format="#,##0.###"/></default-field></field></form-list><label text="No product found in container" condition="!contAssetList"/></widgets><fail-widgets><section-iterate name="ContProdListSection" list="contAssetList" entry="contAsset"><widgets><link url="." text="${ec.resource.expand('ProductNameTemplate', null, contAsset)} (${ec.l10n.format(contAsset.quantityOnHandTotal, null)})"/></widgets></section-iterate></fail-widgets></section></widgets></section><section name="LocationSection" condition="facilityLocation != null"><widgets><section name="LocationProductSection" condition="product != null"><widgets><form-list name="LocationAssetList" list="locAssetList" skip-form="true"><entity-find entity-name="mantle.product.asset.Asset" list="locAssetList" limit="10"><econdition field-name="facilityId"/><econdition field-name="locationSeqId"/><econdition field-name="productId"/><econdition field-name="quantityOnHandTotal" operator="greater" from="0.0"/><order-by field-name="-quantityOnHandTotal"/></entity-find><field name="assetId"><default-field title="Loc. Asset"><link url="assetDetail" text="${assetId}" link-type="anchor"/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="receivedDate"><default-field title="Received"><display format="yyyy-MM-dd"/></default-field></field><field name="quantityOnHandTotal"><default-field title="QOH"><display format="#,##0.###"/></default-field></field></form-list><label text="No product found in location" condition="!locAssetList"/></widgets><fail-widgets><section-iterate name="LocProdListSection" list="locAssetList" entry="locAsset"><widgets><link url="." text="${ec.resource.expand('ProductNameTemplate', null, locAsset)} (${ec.l10n.format(locAsset.quantityOnHandTotal, null)})"/></widgets></section-iterate></fail-widgets></section></widgets></section><section name="ProductSection" condition="product != null"><widgets><section name="ProductOtherSection" condition="facilityLocation == null && container == null && facilityId"><widgets><label text="No locations or containers found for product" condition="!prodAssetList"/><section-iterate name="ProdOtherListSection" list="prodAssetList" entry="prodAsset"><actions><entity-find-one entity-name="mantle.product.asset.Container" value-field="curContainer"><field-map field-name="containerId" from="prodAsset.containerId"/></entity-find-one><entity-find-one entity-name="mantle.facility.FacilityLocation" value-field="curFacLoc" cache="true"><field-map field-name="facilityId"/><field-map field-name="locationSeqId" from="prodAsset.locationSeqId"/></entity-find-one></actions><widgets><link url="." text="Loc ${ec.resource.expand('FacilityLocationNameTemplate', null, curFacLoc)} - Cont ${curContainer ? ec.resource.expand('ContainerNameTemplate', null, curContainer) : 'N/A'}" parameter-map="[containerId:prodAsset.containerId, locationSeqId:prodAsset.locationSeqId]"/></widgets></section-iterate><form-list name="ProductNoLocAssetList" list="prodNoLocAssetList" skip-form="true"><entity-find entity-name="mantle.product.asset.Asset" list="prodNoLocAssetList" limit="10"><econdition field-name="facilityId"/><econdition field-name="locationSeqId" from="null"/><econdition field-name="productId"/><econdition field-name="quantityOnHandTotal" operator="greater" from="0.0"/><order-by field-name="-quantityOnHandTotal"/></entity-find><field name="assetId"><default-field title="No Loc Asset"><link url="assetDetail" text="${assetId}" link-type="anchor"/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="receivedDate"><default-field title="Received"><display format="yyyy-MM-dd"/></default-field></field><field name="quantityOnHandTotal"><default-field title="QOH"><display format="#,##0.###"/></default-field></field></form-list></widgets></section></widgets></section><section name="RecentAssetMoves"><actions><entity-find entity-name="moqui.entity.EntityAuditLog" list="recentMoveList" limit="10"><econdition field-name="changedEntityName" value="mantle.product.asset.Asset"/><econdition field-name="changedFieldName" operator="in" value="locationSeqId,containerId"/><econdition field-name="changedByUserId" from="ec.user.userId"/><econdition field-name="changedDate" operator="greater" from="ec.user.nowTimestamp - 5"/><order-by field-name="-changedDate"/></entity-find></actions><widgets><label text="Recent Asset Moves" type="h4"/><form-list name="RecentMoveForm" list="recentMoveList" skip-form="true"><row-actions><entity-find-one entity-name="mantle.product.asset.Asset" value-field="asset"><field-map field-name="assetId" from="pkPrimaryValue"/></entity-find-one><if condition="changedFieldName == 'locationSeqId'"><then><entity-find-one entity-name="mantle.facility.FacilityLocation" value-field="toFacLoc" cache="true"><field-map field-name="facilityId" from="asset.facilityId"/><field-map field-name="locationSeqId" from="newValueText"/></entity-find-one></then><else-if condition="changedFieldName == 'containerId'"><entity-find-one entity-name="mantle.product.asset.Container" value-field="toContainer"><field-map field-name="containerId" from="newValueText"/></entity-find-one></else-if></if></row-actions><field name="assetId" from="asset.assetId"><default-field title="Asset"><link url="assetDetail" text="AssetNameTemplate" text-map="asset" link-type="anchor" parameter-map="[assetId:asset.assetId]"/></default-field></field><field name="productId" from="asset.productId"><default-field title="Product"><link url="." text="ProductNameTemplate" entity-name="mantle.product.Product" link-type="anchor" parameter-map="[productId:asset.productId, facilityId:toFacLoc?.facilityId,                                 locationSeqId:toFacLoc?.locationSeqId, containerId:toContainer?.containerId]"/></default-field></field><field name="toLocation"><default-field><label text="FacilityLocationNameTemplate" text-map="toFacLoc?:[:]" condition="toFacLoc"/></default-field></field><field name="toContainer"><default-field><label text="ContainerNameTemplate" text-map="toContainer?:[:]" condition="toContainer"/></default-field></field><field name="changedDate"><default-field title="Date Moved"><display format="yyyy-MM-dd HH:mm"/></default-field></field><form-list-column><field-ref name="assetId"/><field-ref name="productId"/></form-list-column><form-list-column><field-ref name="toLocation"/><field-ref name="toContainer"/></form-list-column><form-list-column><field-ref name="changedDate"/></form-list-column></form-list></widgets></section><section name="RecentContainerMoves"><actions><entity-find entity-name="moqui.entity.EntityAuditLog" list="recentContainerMoveList" limit="10"><econdition field-name="changedEntityName" value="mantle.product.asset.Container"/><econdition field-name="changedFieldName" value="locationSeqId"/><econdition field-name="changedByUserId" from="ec.user.userId"/><econdition field-name="changedDate" operator="greater" from="ec.user.nowTimestamp - 5"/><order-by field-name="-changedDate"/></entity-find></actions><widgets><label text="Recent Container Moves" type="h4"/><form-list name="RecentContainerMoveForm" list="recentContainerMoveList" skip-form="true"><row-actions><entity-find-one entity-name="mantle.product.asset.Container" value-field="container"><field-map field-name="containerId" from="pkPrimaryValue"/></entity-find-one><entity-find-one entity-name="mantle.facility.FacilityLocation" value-field="fromFacLoc" cache="true"><field-map field-name="facilityId" from="container.facilityId"/><field-map field-name="locationSeqId" from="oldValueText"/></entity-find-one><entity-find-one entity-name="mantle.facility.FacilityLocation" value-field="toFacLoc" cache="true"><field-map field-name="facilityId" from="container.facilityId"/><field-map field-name="locationSeqId" from="newValueText"/></entity-find-one></row-actions><field name="container"><default-field><display text="${container.serialNumber ?: container.containerId}" parameter-map="[containerId:container.containerId]"/></default-field></field><field name="containerTypeEnumId" from="container.containerTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="fromLocation"><default-field><label text="FacilityLocationNameTemplate" text-map="fromFacLoc?:[:]" condition="fromFacLoc"/></default-field></field><field name="toLocation"><default-field><label text="FacilityLocationNameTemplate" text-map="toFacLoc?:[:]" condition="toFacLoc"/></default-field></field><field name="changedDate"><default-field title="Date Moved"><display format="yyyy-MM-dd HH:mm"/></default-field></field><form-list-column><field-ref name="container"/><field-ref name="containerTypeEnumId"/></form-list-column><form-list-column><field-ref name="fromLocation"/><field-ref name="toLocation"/></form-list-column><form-list-column><field-ref name="changedDate"/></form-list-column></form-list></widgets></section></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/BasicHandheld/Warehouse/Asset/ReceiveAsset.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" default-menu-title="Receive Direct"><parameter name="facilityId"/><parameter name="locationSeqId"/><parameter name="containerId"/><parameter name="productId"/><parameter name="lotId"/><transition name="setActiveFacility"><actions><script><![CDATA[ec.user.setPreference('FacilityActive', facilityId)]]></script></actions><default-response url="."/></transition><transition name="checkScanInput" read-only="true"><service-call name="mantle.facility.FacilityServices.get#ScannedIdGeneral" in-map="true" out-map="context" multi="parameter"/><conditional-response url="../MoveAsset"><condition><expression><![CDATA[assetId]]></expression></condition></conditional-response><default-response url="."/></transition><transition name="receiveAsset"><service-call name="mantle.product.AssetServices.receive#Asset" in-map="true" out-map="context" multi="parameter"/><default-response url="../MoveAsset"/><error-response url="."/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getLotList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getAssetPoolList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><transition-include name="getFacilityList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><transition-include name="getLocationList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><transition-include name="getContainerList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><actions><set field="facilityId" from="facilityId ?: ec.user.getPreference('FacilityActive') ?: ec.user.getPreference('FacilityGeneralDefault')"/><if condition="facilityId"><entity-find-one entity-name="mantle.facility.Facility" value-field="facility"/></if><if condition="containerId"><entity-find-one entity-name="mantle.product.asset.Container" value-field="container"/></if><if condition="locationSeqId"><entity-find-one entity-name="mantle.facility.FacilityLocation" value-field="facilityLocation"/></if><if condition="productId"><entity-find-one entity-name="mantle.product.Product" value-field="product"/></if></actions><widgets><container-row style="text-center"><row-col sm="5"><form-single name="ScanAssetForm" transition="checkScanInput" focus-field="scanId"><field name="facilityId"><default-field><hidden/></default-field></field><field name="locationSeqId"><default-field><hidden/></default-field></field><field name="containerId"><default-field><hidden/></default-field></field><field name="productId"><default-field><hidden/></default-field></field><field name="scanId"><default-field title="Scan Prod, Loc, Cont"><text-line size="16"/></default-field></field><field name="submitButton"><default-field title="Go"><submit/></default-field></field><field-layout><field-row-big><field-ref name="scanId"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single><link url="." text="Reset Selections" condition="containerId || locationSeqId || productId" parameter-map="[containerId:null, locationSeqId:null, productId:null]"/></row-col><row-col sm="7"><form-single name="ActiveFacilityForm" transition="setActiveFacility"><field name="productId"><default-field><hidden/></default-field></field><field name="facilityId"><default-field title="Active Warehouse"><drop-down><dynamic-options transition="getFacilityList" server-search="true" min-length="0" parameter-map="[facilityTypeEnumId:'FcTpWarehouse']"/></drop-down></default-field></field><field name="submitButton"><default-field title="Set WH"><submit/></default-field></field><field-layout><field-row-big><field-ref name="facilityId"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single></row-col></container-row><label text="NOTE: only receive inventory here if there is no Purchase Order and no Incoming Shipment for the inventory." type="p" style="text-warning"/><form-single name="ReceiveAssetForm" transition="receiveAsset"><field name="productId"><default-field title="Product*"><drop-down><dynamic-options transition="getProductList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="statusId"><default-field title="Status" tooltip="For inventory defaults to Available, otherwise defaults to In Storage"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="Asset"/><set field="allowEmpty" value="true"/><set field="noCurrentSelectedKey" value="AstAvailable"/></widget-template-include></default-field></field><field name="receivedDate" from="ec.user.nowTimestamp"><default-field title="Received Date"><date-time/></default-field></field><field name="mfgPartyId"><default-field title="Manufacturer"><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="0" parameter-map="[roleTypeId:'Supplier,Manufacturer']"/></drop-down></default-field></field><field name="lotId"><default-field title="Lot" tooltip="Select an existing Lot, for new enter Lot Number (and Dates) below"><drop-down allow-empty="true"><dynamic-options transition="getLotList" server-search="true" min-length="0"><depends-on field="mfgPartyId"/></dynamic-options></drop-down></default-field></field><field name="lotNumber"><default-field tooltip="For new lot enter Lot Number (and Dates), for existing select above"><text-line size="20"/></default-field></field><field name="manufacturedDate"><default-field title="Manufactured"><date-time type="date"/></default-field></field><field name="expectedEndOfLife"><default-field title="Expiration"><date-time type="date"/></default-field></field><field name="ownerPartyId"><default-field title="Owner"><label text="Asset Owner will default to Facility owner" condition="!ownerPartyId"/><drop-down allow-empty="true"><dynamic-options transition="searchPartyList" server-search="true" min-length="0" parameter-map="[roleTypeId:'Supplier,OrgInternal']"/></drop-down></default-field></field><field name="assetPoolId"><default-field title="Pool"><drop-down allow-empty="true"><dynamic-options transition="getAssetPoolList" server-search="true" min-length="0" depends-optional="true"><depends-on field="ownerPartyId"/></dynamic-options></drop-down></default-field></field><field name="acquireCost"><default-field><text-line size="8" format="#,##0.00"/></default-field></field><field name="quantity"><default-field title="Quantity*"><text-line size="8"/></default-field></field><field name="facilityId"><default-field title="Facility*"><drop-down><dynamic-options transition="getFacilityList" server-search="true" min-length="0"/></drop-down></default-field></field><field name="locationSeqId"><default-field title="Location"><drop-down allow-empty="true"><dynamic-options transition="getLocationList" server-search="true" min-length="0"><depends-on field="facilityId"/></dynamic-options></drop-down></default-field></field><field name="containerId"><default-field title="Container"><drop-down><dynamic-options transition="getContainerList" server-search="true" min-length="0"><depends-on field="facilityId"/><depends-on field="locationSeqId"/></dynamic-options></drop-down></default-field></field><field name="comments"><default-field title="Notes"><text-area cols="80" rows="3"/></default-field></field><field name="submitButton"><default-field title="Receive"><submit/></default-field></field><field-layout><field-ref name="productId"/><field-row><field-ref name="statusId"/><field-ref name="receivedDate"/></field-row><field-row><field-ref name="quantity"/></field-row><field-ref name="facilityId"/><field-ref name="locationSeqId"/><field-ref name="containerId"/><field-ref name="mfgPartyId"/><field-ref name="lotId"/><field-ref name="lotNumber"/><field-row><field-ref name="manufacturedDate"/><field-ref name="expectedEndOfLife"/></field-row><field-ref name="acquireCost"/><field-ref name="ownerPartyId"/><field-ref name="assetPoolId"/><field-ref name="comments"/><field-ref name="submitButton"/></field-layout></form-single></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/BasicHandheld/Warehouse/Asset.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-index="3" default-menu-title="Assets" menu-image="/ssstatic/images/Asset.png"><subscreens default-item="SelectAsset"><subscreens-item name="MoveAsset" menu-include="false" location="component://SimpleScreens/screen/SimpleScreens/Asset/Asset/MoveAsset.xml"/></subscreens><widgets><subscreens-panel id="AssetPanel" type="popup"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/BasicHandheld/Warehouse/Shipping/PickLocationMoves.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Pick Location Moves" default-menu-index="4"><transition name="editFacility"><default-response url="//${appRoot}/Facility/EditFacility"/></transition><transition name="assetDetail"><default-response url="//${appRoot}/Asset/AssetDetail"/></transition><transition name="moveAsset"><default-response url="//${appRoot}/Asset/MoveAsset"/></transition><transition name="selectAsset"><default-response url="//${appRoot}/Asset/SelectAsset"/></transition><transition name="editProduct"><default-response url="//${appRoot}/Catalog/Product/EditProduct"/></transition><transition-include name="setActiveFacility" location="component://SimpleScreens/screen/SimpleScreens/Asset/Asset/SelectAsset.xml"/><transition-include name="getFacilityList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><transition-include name="getProductList" location="component://SimpleScreens/template/product/ProductTransitions.xml"/><actions><set field="facilityId" from="facilityId ?: ec.user.getPreference('FacilityActive') ?: ec.user.getPreference('FacilityGeneralDefault')"/><if condition="facilityId"><entity-find-one entity-name="mantle.facility.Facility" value-field="facility"/></if></actions><widgets><section name="ScanInputAndFacility" condition="facility == null"><widgets><form-single name="ActiveFacilityForm" transition="setActiveFacility"><field name="facilityId"><default-field title="Active Warehouse"><drop-down><dynamic-options transition="getFacilityList" server-search="true" min-length="0" parameter-map="[facilityTypeEnumId:'FcTpWarehouse']"/></drop-down></default-field></field><field name="submitButton"><default-field title="Set WH"><submit/></default-field></field><field-layout><field-row-big><field-ref name="facilityId"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single></widgets><fail-widgets><label text="Facility " type="strong" condition="facility"/><label text="${ec.resource.expand('FacilityNameTemplate', null, facility)}" type="span" condition="facility"/></fail-widgets></section><form-list name="PickMoveList" list="pickMoveList" skip-form="true" paginate-always-show="false"><entity-find entity-name="mantle.product.issuance.AssetAndReservationSummary" list="pickMoveList"><search-form-inputs default-order-by="-quantity"/><econdition field-name="locationTypeEnumId" operator="not-equals" value="FltPick" or-null="true"/><having-econditions><econdition field-name="quantityOnHandTotal" operator="greater" from="0.0"/></having-econditions><select-field field-name="productId,facilityId,locationSeqId,description,areaId,aisleId,sectionId,levelId,positionId"/></entity-find><row-actions><entity-find entity-name="mantle.facility.ProductFacilityLocationDetail" list="pickLocList" distinct="true"><econdition field-name="productId"/><econdition field-name="facilityId"/><econdition field-name="locationTypeEnumId" value="FltPick"/><select-field field-name="locationSeqId,description,areaId,aisleId,sectionId,levelId,positionId"/></entity-find><if condition="!pickLocList"><entity-find entity-name="mantle.product.asset.AssetLocationDetail" list="pickLocList" distinct="true"><econdition field-name="productId"/><econdition field-name="facilityId"/><econdition field-name="locationTypeEnumId" value="FltPick"/><select-field field-name="locationSeqId,description,areaId,aisleId,sectionId,levelId,positionId"/></entity-find></if></row-actions><field name="productId"><header-field title="Product"/><default-field><link url="editProduct" entity-name="mantle.product.Product" text="ProductNameTemplate" link-type="anchor"/></default-field></field><field name="locationSeqId"><default-field title="Location"><display text="${locationSeqId?:''} ${description?:''} [${areaId?:' '}:${aisleId?:' '}:${sectionId?:' '}:${levelId?:' '}:${positionId?:' '}]"/></default-field></field><field name="locationTypeEnumId"><header-field title="Loc Type" show-order-by="true"/><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="containerId"><default-field title="Container"><display-entity entity-name="mantle.product.asset.Container" text="ContainerNameTemplate"/></default-field></field><field name="lotId"><default-field title="Lot"><display-entity entity-name="mantle.product.asset.LotAndMfgParty" text="LotNameTemplate"/></default-field></field><field name="quantity"><header-field title="Res Qty" show-order-by="true"/><default-field><display/></default-field></field><field name="recLocations"><default-field title="Pick Location(s)"><section-iterate name="RecLocList" list="pickLocList" entry="recLoc"><widgets><label text="${locationSeqId?:''} ${description?:''} [${areaId?:' '}:${aisleId?:' '}:${sectionId?:' '}:${levelId?:' '}:${positionId?:' '}]" text-map="recLoc" type="div"/></widgets></section-iterate></default-field></field><field name="moveLink"><default-field title="Move"><link url="selectAsset" text="Move" parameter-map="[quantity:quantity]"/><link url="moveAsset" text="Move Asset" condition="assetId" parameter-map="[quantity:quantity]"/></default-field></field><form-list-column><field-ref name="productId"/><field-ref name="locationSeqId"/><field-ref name="locationTypeEnumId"/></form-list-column><form-list-column><field-ref name="quantity"/></form-list-column><form-list-column><field-ref name="recLocations"/><field-ref name="moveLink"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/BasicHandheld/Warehouse/Shipping.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-index="5" default-menu-title="Shipping" menu-image="/ssstatic/images/Picking.png"><subscreens default-item="PickLocationMoves"><subscreens-item name="PackShipment" menu-index="2" location="component://SimpleScreens/screen/SimpleScreens/Shipping/PackShipment.xml"/><subscreens-item name="ShipmentPack" menu-include="false" location="component://SimpleScreens/screen/SimpleScreens/Shipment/ShipmentPack.xml"/><subscreens-item name="ShipmentByPackage" menu-include="false" location="component://SimpleScreens/screen/SimpleScreens/Shipment/ShipmentByPackage.xml"/><subscreens-item name="ShipmentInsert" menu-include="false" location="component://SimpleScreens/screen/SimpleScreens/Shipment/ShipmentInsert.xml"/></subscreens><widgets><subscreens-panel id="ShippingPanel" type="popup"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/BasicHandheld/Warehouse.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="HH Warehouse" default-menu-index="50" menu-image="fa fa-tags" menu-image-type="icon"><always-actions><set field="appRoot" value="hhwh"/><set field="searchIndexName" value="mantle"/><set field="searchProductDocType" value="MantleProduct"/><set field="searchPartyDocType" value="MantleParty"/><service-call name="mantle.party.PartyServices.setup#UserOrganizationInfo" out-map="context"/></always-actions><subscreens default-item="dashboard"/><widgets><subscreens-panel id="WarehousePanel" type="popup"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/MyAccount/User/Notifications.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Notifications" default-menu-index="1"><parameter name="showViewed" required="false"/><transition name="viewed"><service-call name="update#moqui.security.user.NotificationMessageUser" in-map="context + [userId:ec.user.userId, viewedDate:ec.user.nowTimestamp]" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="topicSubscriptions"><service-call name="store#moqui.security.user.NotificationTopicUser" in-map="context + [userId:ec.user.userId]" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><entity-find entity-name="moqui.security.user.NotificationMessageByUser" list="notificationList"><search-form-inputs default-order-by="-sentDate"/><econdition field-name="userId" from="ec.user.userId"/><econdition field-name="viewedDate" from="null" ignore="showViewed == 'true'"/></entity-find><entity-find entity-name="moqui.security.user.NotificationTopic" list="notificationTopicList"><econdition field-name="isPrivate" value="N" or-null="true"/><order-by field-name="description"/></entity-find></actions><widgets><container-dialog id="TopicUserDialog" button-text="Topic Subscriptions"><form-list name="NotificationTopicList" list="notificationTopicList" transition="topicSubscriptions" multi="true"><row-actions><entity-find-one entity-name="moqui.security.user.NotificationTopicUser" value-field="notTopicUser"><field-map field-name="topic"/><field-map field-name="userId" from="ec.user.userId"/></entity-find-one></row-actions><field name="topic"><default-field><hidden/></default-field></field><field name="description"><default-field><display/></default-field></field><field name="receiveNotifications" from="notTopicUser?.receiveNotifications ?: receiveNotifications ?: 'Y'"><default-field title="Receive"><radio><option key="Y"/><option key="N"/></radio></default-field></field><field name="emailNotifications" from="notTopicUser?.emailNotifications ?: emailNotifications ?: 'N'"><conditional-field condition="emailTemplateId"><radio><option key="Y"/><option key="N"/></radio></conditional-field><default-field title="Email"><display text=""/></default-field></field><field name="submitButton"><default-field><submit text="Update"/></default-field></field></form-list></container-dialog><form-list name="NotificationList" list="notificationList" transition="viewed" multi="true" header-dialog="true"><field name="_useRowSubmit"><default-field><hidden default-value="true"/></default-field></field><field name="_rowSubmit"><header-field title="Select"/><conditional-field condition="viewedDate"><display text=" "/></conditional-field><default-field title="Select"><check no-current-selected-key="true" no-wrapper="true"><option key="true" text=" "/></check></default-field></field><field name="titleText"><header-field title="Message" show-order-by="true"/><conditional-field condition="linkText"><link url="${linkText}" text="${titleText}" link-type="anchor" style="${typeString ? 'text-' + typeString : ''}"/></conditional-field><default-field><label text="${titleText}" style="${typeString ? 'text-' + typeString : ''}"/></default-field></field><field name="notificationMessageId"><default-field title="ID"><hidden/></default-field></field><field name="topic"><header-field show-order-by="true"><drop-down allow-empty="true"><list-options list="notificationTopicList" key="${topic}" text="${description}"/></drop-down></header-field><default-field><display-entity entity-name="moqui.security.user.NotificationTopic" also-hidden="false"/></default-field></field><field name="sentDate"><header-field title="Sent" show-order-by="true"><date-period allow-empty="true"/></header-field><default-field><display also-hidden="false"/></default-field></field><field name="userSentDate"><header-field title="Notified" show-order-by="true"><date-period allow-empty="true"/></header-field><default-field><display also-hidden="false"/></default-field></field><field name="viewedDate"><header-field title="Viewed" show-order-by="true"><date-period allow-empty="true"/><link url="." text="Show Viewed" link-type="anchor" condition="showViewed != 'true'" parameter-map="[showViewed:'true']"/><link url="." text="Hide Viewed" link-type="anchor" condition="showViewed == 'true'" parameter-map="[showViewed:'false']"/></header-field><default-field><display also-hidden="false"/></default-field></field><field name="submitButton"><header-field><submit text="Find"/></header-field><conditional-field condition="viewedDate"><display text=" "/></conditional-field><default-field><submit text="Mark Viewed"/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/MyAccount/User/Messages.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Messages" default-menu-index="2"><subscreens default-item="FindMessage"/><widgets><subscreens-active/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/MyAccount/User/Calendar/EventDetail.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd"><parameter name="workEffortId" required="true"/><transition name="updateEvent"><service-call name="update#mantle.work.effort.WorkEffort" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="cloneWorkEffort"><service-call name="mantle.work.WorkEffortServices.clone#WorkEffort" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createNote"><service-call name="create#mantle.work.effort.WorkEffortNote" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateNote"><service-call name="update#mantle.work.effort.WorkEffortNote" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="addAssetAssign"><service-call name="create#mantle.work.effort.WorkEffortAssetAssign" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateAssetAssign"><service-call name="update#mantle.work.effort.WorkEffortAssetAssign" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition name="addAssignment"><service-call name="create#mantle.work.effort.WorkEffortParty" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateAssignment"><service-call name="update#mantle.work.effort.WorkEffortParty" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><entity-find-one entity-name="mantle.work.effort.WorkEffort" value-field="workEffort"/><entity-find entity-name="moqui.entity.EntityAuditLog" list="statusHistoryList"><econdition field-name="changedEntityName" value="mantle.work.effort.WorkEffort"/><econdition field-name="changedFieldName" value="statusId"/><econdition field-name="pkPrimaryValue" from="workEffortId"/><order-by field-name="changedDate"/></entity-find><set field="statusId" from="workEffort?.statusId"/><set field="statusChangeTransition" value="updateEvent"/><entity-find entity-name="mantle.work.effort.WorkEffortAssetAndAssign" list="equipmentList"><date-filter/><econdition field-name="workEffortId"/><order-by field-name="assetName"/></entity-find><entity-find entity-name="mantle.work.effort.WorkEffortAndPartyDetail" list="weapdList"><date-filter/><econdition field-name="workEffortId"/><order-by field-name="firstName,lastName,organizationName"/></entity-find></actions><widgets><container-row><row-col lg="6"><container-box><box-header title="Event ${workEffortId}"/><box-toolbar><link url="cloneWorkEffort" text="Clone Event" parameter-map="[baseWorkEffortId:workEffortId,                         clearDates:true, copyAssetAssign:true]"/></box-toolbar><box-body><form-single name="UpdateEvent" transition="updateEvent" map="workEffort"><field name="workEffortId"><default-field><hidden/></default-field></field><field name="workEffortName"><default-field title="Name"><text-line size="40"/></default-field></field><field name="purposeEnumId"><default-field title="Purpose"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="WorkEffortPurpose"/><set field="noCurrentSelectedKey" value="WepMeeting"/></widget-template-include></default-field></field><field name="facilityId"><default-field title="Facility"><drop-down allow-empty="true"><entity-options key="${facilityId}" text="FacilityNameTemplate"><entity-find entity-name="mantle.facility.Facility" limit="200"><econdition field-name="facilityTypeEnumId" operator="in" value="FcTpBuilding,FcTpOffice,FcTpRoom,FcTpRetailStore,FcTpWarehouse"/><order-by field-name="facilityName"/></entity-find></entity-options></drop-down></default-field></field><field name="estimatedStartDate"><default-field title="Start Date"><date-time/></default-field></field><field name="estimatedWorkDuration"><default-field title="Est. Hours"><text-line size="8"/></default-field></field><field name="description"><default-field title="Description"><text-area rows="10" cols="60"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></box-body></container-box></row-col><row-col lg="6"><section-include name="StatusChangeAndHistorySection" location="component://SimpleScreens/template/basic/StatusWidgets.xml"/><section name="NotesSection"><actions><entity-find entity-name="mantle.work.effort.WorkEffortNote" list="noteList"><econdition field-name="workEffortId"/><order-by field-name="-noteDate"/></entity-find></actions><widgets><container-box><box-header title="Notes"/><box-toolbar><container-dialog id="NewNoteDialog" button-text="Add Note"><form-single name="NewNoteForm" transition="createNote"><field name="workEffortId"><default-field><hidden/></default-field></field><field name="noteText"><default-field title="Note"><text-area cols="60" rows="6"/></default-field></field><field name="submitButton"><default-field title="Add Note"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><section-iterate name="NoteIterateSection" list="noteList" entry="note"><actions><entity-find-one entity-name="mantle.party.PersonWithUserAccount" value-field="paua"><field-map field-name="userId" from="note.userId"/></entity-find-one></actions><widgets><container-row><row-col lg="4" md="4" sm="4"><label text="${ec.l10n.format(note.noteDate, 'yyyy-MM-dd HH:mm')}" type="strong" style="text-nowrap"/><label text="by ${ec.resource.expand('UsernameTemplate','',paua+[userId:note.userId])}" condition="paua" style="text-nowrap"/></row-col><row-col lg="6" md="6" sm="6"><label text="${note.noteText}"/></row-col><row-col lg="2" md="2" sm="2" style="text-right"><section name="UpdateNoteSection" condition="note.userId == ec.user.userId"><widgets><container-dialog id="UpdateNoteContainer" button-text="Edit"><form-single name="UpdateNoteForm" transition="updateNote" map="note"><field name="workEffortId"><default-field><hidden/></default-field></field><field name="noteDate"><default-field><hidden/></default-field></field><field name="noteText"><default-field title="Note"><text-area cols="60" rows="6"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></container-dialog></widgets></section></row-col></container-row></widgets></section-iterate></box-body></container-box></widgets></section><section name="PartiesSection"><widgets><container-box><box-header title="Parties Assigned"/><box-toolbar><container-dialog id="AddPartyAssignDialog" button-text="Add Party"><form-single name="AddPartyAssignForm" transition="addAssignment"><field name="workEffortId"><default-field><hidden/></default-field></field><field name="fromDate" from="ec.user.nowTimestamp"><default-field><hidden/></default-field></field><field name="partyId" from="''"><default-field title="Party"><drop-down><dynamic-options transition="searchPartyList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="roleTypeId"><default-field><hidden default-value="_NA_"/></default-field></field><field name="statusId" from="null"><default-field title="Status"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="WorkEffortParty"/><set field="noCurrentSelectedKey" value="WeptAssigned"/></widget-template-include></default-field></field><field name="submitButton"><default-field title="Add Assignment"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="UpdateAssignForm" list="weapdList" transition="updateAssignment"><row-actions><entity-find-one entity-name="moqui.basic.StatusItem" value-field="currentStatus"/></row-actions><field name="workEffortId"><default-field><hidden/></default-field></field><field name="partyId"><default-field><hidden/></default-field></field><field name="fromDate"><default-field><hidden/></default-field></field><field name="name"><header-field/><default-field><display text="PartyNameTemplate"/></default-field></field><field name="username"><default-field><display text="${username?:'--'}"/></default-field></field><field name="roleTypeId"><default-field><hidden/></default-field></field><field name="statusId"><default-field title="Status"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusTransitionDropDown"><set field="currentDescription" from="currentStatus?.description"/><set field="statusId"/><set field="style" value=" "/></widget-template-include></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field name="removeButton"><default-field title=""><link url="updateAssignment" text="X" parameter-map="[workEffortId:workEffortId, partyId:partyId,                                         roleTypeId:roleTypeId, fromDate:fromDate, thruDate:ec.user.nowTimestamp]"/></default-field></field></form-list></box-body></container-box></widgets></section></row-col></container-row><container-box><box-header title="Equipment"/><box-toolbar><container-dialog id="AddEquipment" button-text="Add"><form-single name="AddEquipment" transition="addAssetAssign"><field name="workEffortId"><default-field><hidden/></default-field></field><field name="assetId"><default-field title="Equipment"><drop-down><entity-options key="${assetId}" text="AssetNameTemplate"><entity-find entity-name="mantle.product.asset.Asset"><econdition field-name="facilityId" operator="in" from="currentFacilityIdList"/><econdition field-name="assetTypeEnumId" value="AstTpEquipment"/><order-by field-name="assetName"/></entity-find></entity-options></drop-down></default-field></field><field name="statusId" from="null"><default-field title="Status"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="WorkEffortAssetAssign"/><set field="noCurrentSelectedKey" value="WeaaAssigned"/></widget-template-include></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="EquipmentList" list="equipmentList" transition="updateAssetAssign"><field name="workEffortId"><default-field><hidden/></default-field></field><field name="assetId"><default-field><hidden/></default-field></field><field name="fromDate"><default-field><hidden/></default-field></field><field name="assetName"><default-field><display text="AssetNameTemplate"/></default-field></field><field name="statusId"><default-field title="Status"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusTransitionDropDown"><set field="currentDescription" from="equipmentList_entry?.'WorkEffortAssetAssign#moqui.basic.StatusItem'?.description"/><set field="statusId" from="invoice?.statusId"/></widget-template-include></default-field></field><field name="comments"><default-field><text-area cols="50" rows="2"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field name="removeButton"><default-field title=""><link url="updateAssetAssign" text="Remove" parameter-map="[workEffortId:workEffortId, assetId:assetId,                             fromDate:fromDate, thruDate:ec.user.nowTimestamp]"/></default-field></field></form-list></box-body></container-box></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/MyAccount/User/Calendar/MyCalendar.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd"><transition name="eventDetail"><default-response url="../EventDetail"/></transition><transition name="taskDetail"><default-response url="../../Task/TaskDetail"/></transition><transition name="createEvent"><service-call name="mantle.work.EventServices.create#Event" in-map="true" out-map="context" multi="parameter"/><default-response url="../EventDetail"/></transition><transition name="getCalendarEvents"><service-call name="mantle.work.EventServices.get#FullCalendarData" web-send-json-response="eventList" in-map="context + [urlGString:(sri.buildUrl('eventDetail').url + '?workEffortId=${workEffort.workEffortId}')]" out-map="context" multi="parameter"/><default-response type="none"/></transition><transition name="getCalendarTasks"><service-call name="mantle.work.TaskServices.get#FullCalendarData" web-send-json-response="eventList" in-map="context + [urlGString:(sri.buildUrl('taskDetail').url + '?workEffortId=${workEffort.workEffortId}')]" out-map="context" multi="parameter"/><default-response type="none"/></transition><actions/><widgets><container-dialog id="NewEventContainer" button-text="New Event"><form-single name="NewEventForm" transition="createEvent"><field name="workEffortName"><default-field title="Name"><text-line size="40"/></default-field></field><field name="purposeEnumId"><default-field title="Purpose"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="WorkEffortPurpose"/><set field="noCurrentSelectedKey" value="WepMeeting"/></widget-template-include></default-field></field><field name="facilityId"><default-field title="Facility"><drop-down allow-empty="true"><entity-options key="${facilityId}" text="FacilityNameTemplate"><entity-find entity-name="mantle.facility.Facility" limit="200"><econdition field-name="facilityTypeEnumId" operator="in" value="FcTpBuilding,FcTpOffice,FcTpRoom,FcTpRetailStore,FcTpWarehouse"/><order-by field-name="facilityName"/></entity-find></entity-options></drop-down></default-field></field><field name="estimatedStartDate"><default-field title="Start Date"><date-time/></default-field></field><field name="estimatedWorkDuration"><default-field title="Est. Hours"><text-line size="8"/></default-field></field><field name="description"><default-field title="Description"><text-area rows="10" cols="60"/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><container id="calendar"/><render-mode><text type="html,vuet,qvt"><![CDATA[<script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.1.0/fullcalendar.min.js" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.1.0/locale-all.js" type="text/javascript"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.1.0/fullcalendar.min.css" type="text/css"/><script>
    $('#calendar').fullCalendar({ timezone:false, defaultView:'agendaWeek', locale:'${ec.user.locale.toString()}',
        header: { left:'prev,next today', center:'title', right:'month,agendaWeek,agendaDay' },
        eventSources: [ { url:"${sri.buildUrl('getCalendarEvents').url}", type:'POST', data: { moquiSessionToken:'${ec.web.sessionToken}', partyId:'${partyId}' } },
            { url:"${sri.buildUrl('getCalendarTasks').url}", type:'POST', data:{ moquiSessionToken:'${ec.web.sessionToken}', partyId:'${partyId}' }, backgroundColor:'#5cb85c', borderColor:'#4cae4c' } ]
    });
                </script>]]></text></render-mode></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/MyAccount/User/Calendar.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Calendar" default-menu-index="3"><subscreens default-item="MyCalendar"/><widgets><subscreens-active/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/MyAccount/User/Task/MyTasks.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd"><transition name="createTask"><service-call name="mantle.work.TaskServices.create#SimpleTask" in-map="context + [assignToPartyId:ec.user.userAccount.partyId]" out-map="context" multi="parameter"/><default-response url="../TaskDetail"/></transition><transition name="taskDetail"><default-response url="../TaskDetail"/></transition><widgets><container-dialog id="NewTaskContainer" button-text="New Task"><form-single name="NewTaskForm" transition="createTask"><field name="workEffortName"><default-field title="Task Name"><text-line/></default-field></field><field name="priority"><default-field><drop-down current="selected" allow-empty="${allowEmpty ?: 'true'}"><option key="1"/><option key="2"/><option key="3"/><option key="4"/><option key="5"/><option key="6"/><option key="7"/><option key="8"/><option key="9"/></drop-down></default-field></field><field name="purposeEnumId"><default-field title="Purpose"><drop-down no-current-selected-key="WepTask" current="selected"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="WorkEffortPurpose"/><econdition field-name="parentEnumId" value="WetTask"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="estimatedCompletionDate"><default-field title="Due Date"><date-time type="date" format="yyyy-MM-dd"/></default-field></field><field name="estimatedWorkTime"><default-field title="Est. Hours"><text-line size="5"/></default-field></field><field name="description"><default-field title="Description"><text-area rows="10" cols="60"/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="MyTasks" list="myTaskList" skip-form="true" header-dialog="true" saved-finds="true"><entity-find entity-name="mantle.work.effort.WorkEffortAndParty" list="myTaskList"><search-form-inputs default-order-by="priority"/><date-filter/><econdition field-name="workEffortTypeEnumId" value="WetTask"/><econdition field-name="partyId"/><econdition field-name="statusId" operator="not-in" value="WeClosed,WeCancelled" ignore="statusId"/><econdition field-name="partyStatusId" operator="in" value="WeptAssigned,WeptArrived"/></entity-find><field name="workEffortId"><header-field title="ID" show-order-by="true"><text-line size="8"/></header-field><default-field><link text="${workEffortId}" url="taskDetail" link-type="anchor"/></default-field></field><field name="workEffortName"><header-field title="Name" show-order-by="true"><text-find size="20" hide-options="true"/></header-field><default-field><link text="${workEffortName}" url="taskDetail" link-type="anchor"/></default-field></field><field name="priority"><header-field show-order-by="true"/><default-field title="Priority"><display/></default-field></field><field name="purposeEnumId"><header-field title="Purpose" show-order-by="true"><drop-down allow-empty="true"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="WorkEffortPurpose"/><econdition field-name="parentEnumId" value="WetTask"/><order-by field-name="description"/></entity-find></entity-options></drop-down></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration" also-hidden="false"/></default-field></field><field name="statusId"><header-field title="Status" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#statusDropDown"><set field="statusTypeId" value="WorkEffort"/><set field="allowEmpty" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="estimatedCompletionDate"><header-field title="Due" show-order-by="true"><date-period/></header-field><default-field><display format="yyyy-MM-dd"/></default-field></field><field name="estimatedWorkTime"><default-field title="Est"><display format="0.00"/></default-field></field><field name="remainingWorkTime"><default-field title="Rem"><display format="0.00"/></default-field></field><field name="actualWorkTime"><default-field title="Act"><display format="0.00"/></default-field></field><field name="submitButton"><header-field title="Find"><submit/></header-field><default-field><display text=" "/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/MyAccount/User/Task/TaskDetail.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd"><parameter name="workEffortId" required="true"/><always-actions><entity-find entity-name="mantle.work.effort.WorkEffortParty" list="checkWepList"><date-filter/><econdition field-name="workEffortId"/><econdition field-name="partyId" from="ec.user.userAccount.partyId"/></entity-find><if condition="!checkWepList"><return error="true" message="You are not a party to task ${workEffortId}"/></if></always-actions><transition name="timeEntries"><default-response url="../../TimeEntries"/></transition><transition name="updateTask"><service-call name="update#mantle.work.effort.WorkEffort" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="cloneWorkEffort"><service-call name="mantle.work.WorkEffortServices.clone#WorkEffort" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createNote"><service-call name="create#mantle.work.effort.WorkEffortNote" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateNote"><service-call name="update#mantle.work.effort.WorkEffortNote" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition name="addAssignment"><service-call name="create#mantle.work.effort.WorkEffortParty" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateAssignment"><service-call name="update#mantle.work.effort.WorkEffortParty" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><entity-find-one entity-name="mantle.work.effort.WorkEffort" value-field="workEffort"/><entity-find entity-name="moqui.entity.EntityAuditLog" list="statusHistoryList"><econdition field-name="changedEntityName" value="mantle.work.effort.WorkEffort"/><econdition field-name="changedFieldName" value="statusId"/><econdition field-name="pkPrimaryValue" from="workEffortId"/><order-by field-name="changedDate"/></entity-find><set field="statusId" from="workEffort?.statusId"/><set field="statusChangeTransition" value="updateTask"/><entity-find entity-name="mantle.work.effort.WorkEffortAndPartyDetail" list="weapdList"><date-filter/><econdition field-name="workEffortId"/><order-by field-name="firstName,lastName,organizationName"/></entity-find></actions><widgets><container-row><row-col lg="6"><container-box><box-header title="Task ${workEffortId}"/><box-toolbar><link url="timeEntries" text="Task Time Entries" parameter-map="[workEffortId:workEffortId]"/><link url="cloneWorkEffort" text="Clone Task" parameter-map="[baseWorkEffortId:workEffortId,                         clearDates:true, copyAssetAssign:true]"/></box-toolbar><box-body><form-single name="UpdateEvent" transition="updateTask" map="workEffort"><field name="workEffortId"><default-field><hidden/></default-field></field><field name="workEffortName"><default-field title="Name"><text-line size="40"/></default-field></field><field name="priority"><default-field><drop-down current="selected" allow-empty="${allowEmpty ?: 'true'}"><option key="1"/><option key="2"/><option key="3"/><option key="4"/><option key="5"/><option key="6"/><option key="7"/><option key="8"/><option key="9"/></drop-down></default-field></field><field name="purposeEnumId"><default-field title="Purpose"><drop-down no-current-selected-key="WepTask" current="selected"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="WorkEffortPurpose"/><econdition field-name="parentEnumId" value="WetTask"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="resolutionEnumId"><default-field title="Resolution"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="WorkEffortResolution"/></widget-template-include></default-field></field><field name="estimatedCompletionDate"><default-field title="Due Date"><date-time type="date" format="yyyy-MM-dd"/></default-field></field><field name="estimatedWorkTime"><default-field title="Estimated Hours"><text-line size="5"/></default-field></field><field name="remainingWorkTime"><default-field title="Remaining Hours"><text-line size="5"/></default-field></field><field name="actualWorkTime"><default-field title="Actual Hours"><display format="#.00"/></default-field></field><field name="description"><default-field title="Description"><text-area rows="10" cols="60"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></box-body></container-box></row-col><row-col lg="6"><section-include name="StatusChangeAndHistorySection" location="component://SimpleScreens/template/basic/StatusWidgets.xml"/><section-include name="NotesSection" location="component://SimpleScreens/screen/MyAccount/User/Calendar/EventDetail.xml"/><section-include name="PartiesSection" location="component://SimpleScreens/screen/MyAccount/User/Calendar/EventDetail.xml"/></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/MyAccount/User/Task.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Task" default-menu-index="4"><subscreens default-item="MyTasks"/><widgets><subscreens-active/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/MyAccount/User/Request/MyRequests.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="findRequest"><default-response url="."/></transition><transition name="editRequest"><default-response url="../EditRequest"/></transition><transition name="createRequest"><service-call name="mantle.request.RequestServices.create#Request" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><widgets><container-dialog id="NewRequestContainer" button-text="New Request"><form-single name="NewRequestForm" transition="createRequest"><field name="filedByPartyId" from="partyId"><default-field><hidden/></default-field></field><field name="statusId" from="'ReqSubmitted'"><default-field><hidden/></default-field></field><field name="rootWorkEffortId"><default-field title="Project"><drop-down><entity-options key="${workEffortId}" text="WorkEffortNameTemplate"><entity-find entity-name="mantle.work.effort.WorkEffortAndParty"><econditions combine="or"><econditions><date-filter/><econdition field-name="partyId" from="ec.user.userAccount.partyId"/></econditions><econdition field-name="visibilityEnumId" value="WevGeneral"/></econditions><econdition field-name="workEffortTypeEnumId" value="WetProject"/><order-by field-name="workEffortId"/></entity-find></entity-options></drop-down></default-field></field><field name="productStoreId"><default-field title="Store"><drop-down allow-empty="true"><entity-options key="${productStoreId}" text="${productStoreId}: ${storeName}"><entity-find entity-name="mantle.product.store.ProductStore"><order-by field-name="storeName"/></entity-find></entity-options></drop-down></default-field></field><field name="priority"><default-field><drop-down no-current-selected-key="5"><option key="1"/><option key="2"/><option key="3"/><option key="4"/><option key="5"/><option key="6"/><option key="7"/><option key="8"/><option key="9"/></drop-down></default-field></field><field name="requestTypeEnumId"><default-field title="Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="RequestType"/><set field="noCurrentSelectedKey" value="RqtSupport"/></widget-template-include></default-field></field><field name="requestName"><default-field title="Request Name"><text-line size="60"/></default-field></field><field name="description"><default-field title="Description"><text-area rows="10"/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="ListRequests" list="requestList" skip-form="true" header-dialog="true" extends="component://SimpleScreens/screen/SimpleScreens/Request/FindRequest.xml#ListRequests"><entity-find entity-name="mantle.request.RequestAndParty" list="requestList" distinct="true"><search-form-inputs default-order-by="priority,requestDate" skip-fields="partyId"><default-parameters statusId="ReqDraft,ReqSubmitted,ReqReviewed,ReqInProgress" statusId_op="in"/></search-form-inputs><date-filter/><econdition field-name="partyId"/></entity-find><row-actions><entity-find entity-name="mantle.request.RequestParty" list="partyList"><date-filter/><econdition field-name="requestId"/></entity-find><set field="customerRp" from="partyList.find({ it.roleTypeId == 'Customer' })"/><set field="assigneeRp" from="partyList.find({ it.roleTypeId == 'Assignee' })"/></row-actions><field name="findPartyId"><header-field><ignored/></header-field></field><field name="facilityId"><header-field><ignored/></header-field><default-field><ignored/></default-field></field><form-list-column><field-ref name="priority"/></form-list-column><form-list-column><field-ref name="requestDate"/><field-ref name="responseRequiredDate"/></form-list-column><form-list-column><field-ref name="requestName"/><field-ref name="requestId"/></form-list-column><form-list-column><field-ref name="productStoreId"/><field-ref name="rootWorkEffortId"/></form-list-column><form-list-column><field-ref name="requestTypeEnumId"/></form-list-column><form-list-column><field-ref name="statusId"/><field-ref name="requestResolutionEnumId"/></form-list-column><form-list-column><field-ref name="customerPartyId"/><field-ref name="assignToPartyId"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/MyAccount/User/Request/EditRequest.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Request" default-menu-index="1"><parameter name="requestId" required="true"/><always-actions><entity-find entity-name="mantle.request.RequestParty" list="checkRpList"><date-filter/><econdition field-name="requestId"/><econdition field-name="partyId" from="ec.user.userAccount.partyId"/></entity-find><if condition="!checkRpList"><return error="true" message="You are not a party to request ${requestId}"/></if></always-actions><transition name="updateRequest"><service-call name="mantle.request.RequestServices.update#Request" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateStatus"><service-call name="mantle.request.RequestServices.update#Request" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="searchPartyList" location="component://SimpleScreens/template/party/PartyForms.xml"/><transition name="addComment"><service-call name="mantle.request.RequestServices.add#RequestComment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteComment"><service-call name="mantle.request.RequestServices.delete#RequestComment" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createContent"><service-call name="mantle.request.RequestServices.create#RequestContent" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateContent"><service-call name="mantle.request.RequestServices.update#RequestContent" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="downloadContent" read-only="true"><parameter name="requestContentId"/><actions><entity-find-one entity-name="mantle.request.RequestContent" value-field="requestContent"/><script><![CDATA[ec.web.sendResourceResponse(requestContent?.contentLocation)]]></script></actions><default-response type="none"/></transition><subscreens><subscreens-item name="RequestCommentNested" location="component://SimpleScreens/screen/SimpleScreens/Request/EditRequest/RequestCommentNested.xml"/><subscreens-item name="RequestCommentReply" location="component://SimpleScreens/screen/SimpleScreens/Request/EditRequest/RequestCommentReply.xml"/><subscreens-item name="RequestCommentUpdate" location="component://SimpleScreens/screen/SimpleScreens/Request/EditRequest/RequestCommentUpdate.xml"/></subscreens><actions><entity-find-one entity-name="mantle.request.Request" value-field="request"/><set field="statusId" from="request.statusId"/><set field="changedEntityName" value="mantle.request.Request"/><set field="pkPrimaryValue" from="requestId"/><entity-find entity-name="mantle.request.RequestParty" list="customerRpList"><date-filter/><econdition field-name="requestId"/><econdition field-name="roleTypeId" value="Customer"/></entity-find><set field="customerRp" from="customerRpList?.getAt(0)"/><entity-find entity-name="mantle.request.RequestParty" list="assignToRpList"><date-filter/><econdition field-name="requestId"/><econdition field-name="roleTypeId" value="Assignee"/></entity-find><set field="assignToRp" from="assignToRpList?.getAt(0)"/><entity-find entity-name="mantle.request.RequestNote" list="requestNoteList"><econdition field-name="requestId"/><order-by field-name="-noteDate"/></entity-find></actions><widgets><container-row><row-col md="7"><label text="Request #${requestId}" type="h4"/><form-single name="EditRequest" transition="updateRequest" map="request" extends="component://SimpleScreens/screen/SimpleScreens/Request/EditRequest.xml#EditRequest"><field name="facilityId"><default-field><ignored/></default-field></field><field name="assignToPartyId"><default-field><ignored/></default-field></field><field-layout><field-row><field-ref name="requestId"/><field-ref name="requestDate"/></field-row><field-row><field-ref name="filedByPartyId"/></field-row><field-row><field-ref name="displayCustomerId"/><field-ref name="displayAssigneeId"/></field-row><field-row><field-ref name="rootWorkEffortId"/><field-ref name="productStoreId"/></field-row><field-row><field-ref name="priority"/><field-ref name="responseRequiredDate"/></field-row><field-row><field-ref name="requestTypeEnumId"/><field-ref name="requestResolutionEnumId"/></field-row><fields-not-referenced/></field-layout></form-single><section-include name="CommentsSection" location="component://SimpleScreens/screen/SimpleScreens/Request/EditRequest.xml"/></row-col><row-col md="5"><section-include name="StatusChangeSection" location="component://SimpleScreens/template/basic/StatusWidgets.xml"/><section-include name="StatusHistorySection" location="component://SimpleScreens/template/basic/StatusWidgets.xml"/><container-box><box-header title="Parties"/><box-body-nopad><form-list name="UpdatePartyForm" list="rpapList" skip-form="true"><entity-find entity-name="mantle.request.RequestParty" list="rpapList"><date-filter/><econdition field-name="requestId"/><order-by field-name="roleTypeId"/></entity-find><field name="roleTypeId"><default-field title="Role"><display-entity entity-name="mantle.party.RoleType"/></default-field></field><field name="partyId"><default-field title="Name"><link url="editParty" text="PartyNameTemplate" entity-name="mantle.party.PartyDetail" link-type="anchor"/><display text=""/></default-field></field></form-list></box-body-nopad></container-box><section name="NotesSection"><widgets><container-box><box-header title="Notes"/><box-body><section-iterate name="NoteIterateSection" list="requestNoteList" entry="note"><actions><entity-find-one entity-name="mantle.party.PersonWithUserAccount" value-field="paua"><field-map field-name="userId" from="note.userId"/></entity-find-one></actions><widgets><label text="By ${paua?.firstName?:''} ${paua?.lastName?:''} (${paua?.username ?: note.userId}) at ${ec.l10n.format(note.noteDate, 'yyyy-MM-dd HH:mm')}" type="strong"/><label text="${note.noteText}" type="p"/></widgets></section-iterate></box-body></container-box></widgets></section><section-include name="ContentSection" location="component://SimpleScreens/screen/SimpleScreens/Request/EditRequest.xml"/></row-col></container-row></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/MyAccount/User/Request.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Request" default-menu-index="5" menu-image="/ssstatic/images/Request.png"><subscreens default-item="MyRequests"/><widgets><subscreens-active/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/MyAccount/User/TimeEntries.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Time" default-menu-index="5"><transition name="taskDetail"><default-response url="../Task/TaskDetail"/></transition><transition name="recordTimeEntry"><actions><entity-find-one entity-name="mantle.work.time.TimeEntry" value-field="timeEntry"/><if condition="timeEntry != null && timeEntry.partyId != ec.user.userAccount?.partyId"><return error="true" message="You may only update your own time entries, Time Entry ${timeEntryId} owned by different party"/></if><service-call name="mantle.work.TimeServices.store#TimeEntry" in-map="context"/></actions><default-response url="."/></transition><transition name="clockInTimeEntry"><service-call name="mantle.work.TimeServices.create#TimeEntryClockIn" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getFacilityList" location="component://SimpleScreens/template/facility/FacilityTransitions.xml"/><transition-include name="getTaskList" location="component://SimpleScreens/template/work/WorkTransitions.xml"/><subscreens><subscreens-item name="EditTimeEntry" location="component://SimpleScreens/screen/SimpleScreens/Party/PartyTimeEntries/EditTimeEntry.xml"/></subscreens><actions><entity-find entity-name="mantle.work.time.TimeEntry" list="timeEntryList"><search-form-inputs default-order-by="-fromDate"/><econdition field-name="partyId"/></entity-find><service-call name="mantle.humanres.PositionServices.get#PartyEmployersAndPositionClasses" in-map="[partyId:partyId]" out-map="context"/></actions><widgets><section-include name="ClockInOutSection" location="component://SimpleScreens/screen/SimpleScreens/Party/PartyTimeEntries.xml"/><dynamic-dialog id="AddTimeDialogDyn" button-text="Record Time" transition="EditTimeEntry" parameter-map="[partyId:partyId, timeEntryId:null]"/><form-list name="TimeEntryList" list="timeEntryList" transition="recordTimeEntry" header-dialog="true" saved-finds="true"><field name="timeEntryId"><default-field><hidden/></default-field></field><field name="editButton"><default-field title=""><dynamic-dialog id="EditTimeEntryDialog" button-text=" " icon="fa fa-pencil" transition="EditTimeEntry" parameter-map="[partyId:partyId, timeEntryId:timeEntryId]"/></default-field></field><field name="fromDate"><header-field show-order-by="true"><date-period allow-empty="true"/></header-field><default-field><display also-hidden="false"/></default-field></field><field name="thruDate"><header-field show-order-by="true"><date-period allow-empty="true"/></header-field><default-field><display also-hidden="false"/></default-field></field><field name="hours"><header-field show-order-by="true"/><default-field><display format="0.00" also-hidden="false"/></default-field></field><field name="breakHours"><header-field show-order-by="true"/><default-field title="Break"><display format="0.00" also-hidden="false"/></default-field></field><field name="pieceCount"><header-field show-order-by="true"/><default-field><display also-hidden="false"/></default-field></field><field name="clientPartyId"><header-field title="Employer"><drop-down allow-empty="true"><list-options list="employerPartyList" key="${partyId}" text="PartyNameTemplate"/></drop-down></header-field><default-field><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameTemplate"/></default-field></field><field name="workEffortId"><header-field title="Task" show-order-by="true"><drop-down allow-empty="true"><dynamic-options transition="getTaskList" min-length="0" server-search="true" parameter-map="[assignedPartyId:partyId]"/></drop-down></header-field><default-field><link url="taskDetail" entity-name="mantle.work.effort.WorkEffort" text="WorkEffortNameTemplate" link-type="anchor"/></default-field></field><field name="workTypeEnumId"><header-field title="Work Type"><drop-down allow-empty="true"><list-options list="workTypeEnumerationList" key="${enumId}" text="${description}"/></drop-down></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration" also-hidden="false"/></default-field></field><field name="emplPositionClassId"><header-field title="Position Class" show-order-by="true"><drop-down allow-empty="true"><list-options list="emplPositionClassList" key="${emplPositionClassId}" text="${title}"/></drop-down></header-field><default-field><display-entity entity-name="mantle.humanres.position.EmplPositionClass" text="${title}"/></default-field></field><field name="rateTypeEnumId"><header-field title="Rate Type" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumGroupDropDown"><set field="enumGroupEnumId" value="EngRateCommonEntry"/><set field="allowEmpty" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration" key-field-name="enumId" also-hidden="false"/></default-field></field><field name="comments"><default-field><text-area cols="50" rows="2"/></default-field></field><field name="findButton"><header-field title="Find"><submit/></header-field><default-field><submit text="Update"/></default-field></field><form-list-column><field-ref name="editButton"/></form-list-column><form-list-column><field-ref name="fromDate"/><field-ref name="thruDate"/></form-list-column><form-list-column><field-ref name="hours"/><field-ref name="breakHours"/><field-ref name="pieceCount"/></form-list-column><form-list-column><field-ref name="clientPartyId"/><field-ref name="workEffortId"/></form-list-column><form-list-column><field-ref name="workTypeEnumId"/><field-ref name="emplPositionClassId"/><field-ref name="rateTypeEnumId"/></form-list-column><form-list-column><field-ref name="comments"/></form-list-column><form-list-column><field-ref name="findButton"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/MyAccount/User/ContactInfo/UpdateContactInfo.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="postalContactMechId"/><parameter name="postalContactMechPurposeId"/><parameter name="telecomContactMechId"/><parameter name="telecomContactMechPurposeId"/><parameter name="emailContactMechId"/><parameter name="emailContactMechPurposeId"/><transition name="storeContactInfo"><service-call name="mantle.party.ContactServices.store#PartyContactInfo" in-map="true" out-map="context" multi="parameter"/><default-response url=".."/></transition><transition-include name="getGeoCountryStates" location="component://SimpleScreens/template/party/PartyForms.xml"/><actions><if condition="postalContactMechId || telecomContactMechId || emailContactMechId"><then><service-call name="mantle.party.ContactServices.get#PartyContactInfo" out-map="contactInfo" in-map="context"/><set field="contactInfoFlat" from="contactInfo + flattenNestedMap(contactInfo)"/></then><else><set field="contactInfoFlat" from="[postalContactMechPurposeId:postalContactMechPurposeId,                     telecomContactMechPurposeId:telecomContactMechPurposeId, emailContactMechPurposeId:emailContactMechPurposeId]"/></else></if></actions><widgets><form-single name="ShippingInfo" transition="storeContactInfo" map="contactInfoFlat" extends="component://SimpleScreens/template/party/PartyForms.xml#ContactInfo"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/MyAccount/User/ContactInfo.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Contact Info" default-menu-index="6"><transition name="updateContactInfo"><default-response url="UpdateContactInfo"/></transition><transition name="removeContactInfo"><service-call name="mantle.party.ContactServices.delete#PartyContactMech" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions/><widgets><section name="ContactInfoSection"><actions><service-call name="mantle.party.ContactServices.get#PartyContactInfoList" out-map="contactOut" in-map="[partyId:partyId, getAll:true]"/></actions><widgets><container-box><box-header title="Email Addresses"/><box-toolbar><dynamic-dialog id="AddEmailInfo" button-text="Add Email" transition="updateContactInfo" parameter-map="[partyId:partyId, createEmail:'true']"/></box-toolbar><box-body><container style="float-box" type="ul"><section-iterate name="EmailInfoSection" list="contactOut.emailAddressList" entry="contactInfo"><widgets><container type="li"><label text="${contactInfo.emailContactMechPurpose.description}" type="p"/><render-mode><text type="html,vuet,qvt" location="component://SimpleScreens/template/party/ContactInfo.html.gstring"/></render-mode><dynamic-dialog id="UpdateEmailInfo" button-text="Update" transition="updateContactInfo" parameter-map="[partyId:partyId, emailContactMechId:contactInfo.emailContactMechId,                                                             emailContactMechPurposeId:contactInfo.emailContactMechPurposeId]"/><link url="removeContactInfo" text="Remove" parameter-map="[partyId:partyId, contactMechId:contactInfo.emailContactMechId,                                                             contactMechPurposeId:contactInfo.emailContactMechPurposeId]"/></container></widgets></section-iterate></container></box-body></container-box><container-box><box-header title="Phone Numbers"/><box-toolbar><dynamic-dialog id="AddPhoneInfo" button-text="Add Phone" transition="updateContactInfo" parameter-map="[partyId:partyId, createTelecom:'true']"/></box-toolbar><box-body><container style="float-box" type="ul"><section-iterate name="PhoneInfoSection" list="contactOut.telecomNumberList" entry="contactInfo"><widgets><container type="li"><label text="${contactInfo.telecomContactMechPurpose.description}" type="p"/><render-mode><text type="html,vuet,qvt" location="component://SimpleScreens/template/party/ContactInfo.html.gstring"/></render-mode><dynamic-dialog id="UpdatePhoneInfo" button-text="Update" transition="updateContactInfo" parameter-map="[partyId:partyId, telecomContactMechId:contactInfo.telecomContactMechId,                                                             telecomContactMechPurposeId:contactInfo.telecomContactMechPurposeId]"/><link url="removeContactInfo" text="Remove" parameter-map="[partyId:partyId, contactMechId:contactInfo.telecomContactMechId,                                                             contactMechPurposeId:contactInfo.telecomContactMechPurposeId]"/></container></widgets></section-iterate></container></box-body></container-box><container-box><box-header title="Mailing Addresses"/><box-toolbar><dynamic-dialog id="AddAddressInfo" button-text="Add Address" transition="updateContactInfo" width="800" parameter-map="[partyId:partyId, createPostal:'true', createTelecom:'true']"/></box-toolbar><box-body><container style="float-box" type="ul"><section-iterate name="PostalInfoSection" list="contactOut.postalAddressList" entry="contactInfo"><widgets><container type="li"><label text="${contactInfo.postalContactMechPurpose.description}" type="p"/><render-mode><text type="html,vuet,qvt" location="component://SimpleScreens/template/party/ContactInfo.html.gstring"/></render-mode><dynamic-dialog id="UpdatePostalInfo" button-text="Update Address" transition="updateContactInfo" width="800" parameter-map="[partyId:partyId, postalContactMechId:contactInfo.postalContactMechId,                                                             postalContactMechPurposeId:contactInfo.postalContactMechPurposeId]"/><link url="removeContactInfo" text="Remove" parameter-map="[partyId:partyId, contactMechId:contactInfo.postalContactMechId,                                                             contactMechPurposeId:contactInfo.postalContactMechPurposeId]"/></container></widgets></section-iterate></container></box-body></container-box></widgets></section></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/MyAccount/User/ScheduledFinds/EditScheduledFind.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Edit Scheduled Find" default-menu-include="false" standalone="true"><parameter name="screenScheduledId" required="true"/><transition name="updateScreenScheduled"><parameter name="screenScheduledId"/><actions><entity-find-one entity-name="moqui.screen.ScreenScheduled" value-field="screenScheduled"/><if condition="screenScheduled == null"><return error="true" message="Scheduled Find not found with ID ${screenScheduledId}"/></if><if condition="screenScheduled.userId != ec.user.userId"><return error="true" message="Scheduled Find with ID ${screenScheduledId} belongs to a different user"/></if><if condition="cronSelected"><set field="cronExpression" from="cronSelected"/></if><script><![CDATA[if (cronExpression) {
                    try { org.moqui.impl.service.ScheduledJobRunner.getExecutionTime((String) cronExpression) } catch (Exception e) {
                        ec.message.addError("Invalid Cron expression '${cronExpression}': ${e.message}")
                        return
                    }
                }]]></script><service-call name="update#moqui.screen.ScreenScheduled" in-map="context" out-map="context"/></actions><default-response url=".."/></transition><actions><entity-find-one entity-name="moqui.screen.ScreenScheduled" value-field="screenScheduled"/><set field="cronDescription" from="org.moqui.impl.service.ScheduledJobRunner.getCronDescription(screenScheduled?.cronExpression, ec.user.getLocale(), true)"/></actions><widgets><label text="To disable set a Thru Date in the past or clear the Schedule and Cron Expression" type="p"/><form-single name="EditScreenScheduled" transition="updateScreenScheduled" map="screenScheduled"><field name="screenScheduledId"><default-field><hidden/></default-field></field><field name="screenPath"><default-field title="Screen"><display/></default-field></field><field name="formListFindId"><default-field title="Saved Find"><display-entity entity-name="moqui.screen.form.FormListFind"/></default-field></field><field name="renderMode"><default-field><drop-down><option key="xlsx" text="XLSX"/><option key="csv" text="CSV"/><option key="xsl-fo" text="PDF"/></drop-down></default-field></field><field name="noResultsAbort"><default-field title="No Results Skip"><radio no-current-selected-key="N"><option key="N" text="No"/><option key="Y" text="Yes"/></radio></default-field></field><field name="cronDescription"><default-field title="Schedule Description"><display/></default-field></field><field name="cronSelected" from="cronExpression"><default-field title="Schedule"><drop-down allow-empty="true"><option key="${cronExpression}" text="Current: ${cronDescription}"/><option key="0 0 6 ? * *" text="Daily at 6 AM"/><option key="0 0 6 ? * MON-FRI" text="Daily Monday to Friday at 6 AM"/><option key="0 0 6 ? * MON" text="Weekly on Monday at 6 AM"/><option key="0 0 6 1 * ?" text="Monthly on the 1st at 6 AM"/></drop-down></default-field></field><field name="cronExpression"><default-field tooltip="Ignored if Schedule selected, clear to set manually here"><text-line size="20"/></default-field></field><field name="fromDate"><default-field><date-time/></default-field></field><field name="thruDate"><default-field><date-time/></default-field></field><field name="emailTemplateId"><default-field title="Email Template"><drop-down><entity-options key="${emailTemplateId}" text="${description}"><entity-find entity-name="moqui.basic.email.EmailTemplate"><econdition field-name="emailTypeEnumId" value="EMT_SCREEN_RENDER"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="emailSubject"><default-field><text-line size="60"/></default-field></field><field name="submitButton"><default-field><submit text="Update"/></default-field></field></form-single></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/MyAccount/User/ScheduledFinds.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Scheduled Finds" default-menu-index="7"><actions><set field="userAccount" from="ec.user.userAccount"/></actions><widgets><label text="Your account has no Email Address (username ${userAccount.username}), set one on the Account screen" condition="!userAccount.emailAddress" style="text-danger" type="strong"/><label text="Email will be sent to ${userAccount.emailAddress} (username ${userAccount.username})" condition="userAccount.emailAddress" style="text-success" type="strong"/><form-list name="ScreenScheduledList" list="screenScheduledList" header-dialog="true"><entity-find entity-name="moqui.screen.ScreenScheduledAndFind" list="screenScheduledList"><search-form-inputs default-order-by="screenPath,description"/><econdition field-name="userId" from="ec.user.userId"/><select-field field-name="screenPath,formListFindId"/></entity-find><row-actions><set field="cronDescription" from="org.moqui.impl.service.ScheduledJobRunner.getCronDescription(cronExpression, ec.user.getLocale(), true)"/></row-actions><field name="screenScheduledId"><default-field><hidden/></default-field></field><field name="screenLink"><default-field title=""><link text="View" url="${screenPath}" parameter-map="[formListFindId:formListFindId]"/></default-field></field><field name="screenPath"><header-field title="Screen"><text-find hide-options="true"/></header-field><default-field><display/></default-field></field><field name="description"><header-field title="Saved Find"><text-find hide-options="true"/></header-field><default-field><display/></default-field></field><field name="renderMode"><default-field><display text="${renderMode == 'xsl-fo' ? 'PDF' : renderMode.toUpperCase()}"/></default-field></field><field name="noResultsAbort"><default-field title="No Results Skip"><display text="${noResultsAbort == 'Y' ? 'Yes' : 'No'}"/></default-field></field><field name="cronExpression"><default-field><display text="[${cronExpression}] ${cronDescription}"/></default-field></field><field name="fromDate"><default-field red-when="after-now"><display/></default-field></field><field name="thruDate"><default-field red-when="before-now"><display/></default-field></field><field name="emailTemplateId"><default-field title="Email Template"><display-entity entity-name="moqui.basic.email.EmailTemplate" text="${description}"/></default-field></field><field name="emailSubject"><header-field><text-find hide-options="true"/></header-field><default-field><display/></default-field></field><field name="submitButton"><header-field><submit text="Find"/></header-field><default-field><dynamic-dialog button-text="Update" id="UpdateScheduledFind" transition="EditScheduledFind"/></default-field></field><form-list-column><field-ref name="screenLink"/></form-list-column><form-list-column><field-ref name="screenPath"/><field-ref name="description"/></form-list-column><form-list-column><field-ref name="renderMode"/><field-ref name="noResultsAbort"/></form-list-column><form-list-column><field-ref name="cronExpression"/></form-list-column><form-list-column><field-ref name="fromDate"/><field-ref name="thruDate"/></form-list-column><form-list-column><field-ref name="emailTemplateId"/><field-ref name="emailSubject"/></form-list-column><form-list-column><field-ref name="submitButton"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://tools/screen/System/Security/UserAccount/UserAccountDetail/VerifyEmail.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="userId" required="true"/><parameter name="factorId" required="true"/><transition name="verifyUserAuthcFactor"><service-call name="org.moqui.impl.UserServices.validate#UserAuthcFactorCode" in-map="true" out-map="context" multi="parameter"/><actions><if condition="!verified"><message type="danger"><![CDATA[Authentication code is not valid]]></message></if></actions><default-response url=".."/></transition><transition name="sendAuthcCodeEmail"><service-call name="org.moqui.impl.UserServices.send#AuthcCodeEmail" in-map="[factorId:factorId]" out-map="context" multi="parameter"/><default-response url=".."/></transition><actions><entity-find-one entity-name="moqui.security.UserAuthcFactor" value-field="userAuthcFactor"/></actions><widgets><label text="Follow the Steps Below to Verify" type="h5"/><container type="ol"><container type="li"><label text="Click on the button below to send a new code."/></container><container type="li"><label text="Check your email account for the message with the code. Don't forget to check spam, archive, trash, etc."/></container><container type="li"><label text="Come back to this dialog and input the code into the box below."/></container></container><form-single name="VerifyUserAuthcFactor" transition="verifyUserAuthcFactor"><field name="userId" from="userId"><default-field><hidden/></default-field></field><field name="code" from="null"><default-field title="Single Use Code"><text-line size="10"/></default-field></field><field name="submit"><default-field><submit/></default-field></field><field-layout><field-row-big><field-ref name="code"/><field-ref name="submit"/></field-row-big></field-layout></form-single><link url="sendAuthcCodeEmail" text="Send new code to ${userAuthcFactor?.factorOption}"/></widgets></screen>
<!-- Screen Location component://tools/screen/System/Security/UserAccount/UserAccountDetail/VerifySms.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="userId" required="true"/><parameter name="factorId" required="true"/><transition name="verifyUserAuthcFactor"><service-call name="org.moqui.impl.UserServices.validate#UserAuthcFactorCode" in-map="true" out-map="context" multi="parameter"/><actions><if condition="!verified"><message type="danger"><![CDATA[Authentication code is not valid]]></message></if></actions><default-response url=".."/></transition><transition name="sendAuthcCodeSms"><service-call name="org.moqui.impl.UserServices.send#AuthcCodeSms" in-map="[factorId:factorId]" out-map="context" multi="parameter"/><default-response url=".."/></transition><actions><entity-find-one entity-name="moqui.security.UserAuthcFactor" value-field="userAuthcFactor"/></actions><widgets><label text="Follow the Steps Below to Verify" type="h5"/><container type="ol"><container type="li"><label text="Click on the button below to send a new code."/></container><container type="li"><label text="Check your phone (SMS capable) for the message with the code."/></container><container type="li"><label text="Come back to this dialog and input the code into the box below."/></container></container><form-single name="VerifyUserAuthcFactor" transition="verifyUserAuthcFactor"><field name="userId" from="userId"><default-field><hidden/></default-field></field><field name="code" from="null"><default-field title="Single Use Code"><text-line size="10"/></default-field></field><field name="submit"><default-field><submit/></default-field></field><field-layout><field-row-big><field-ref name="code"/><field-ref name="submit"/></field-row-big></field-layout></form-single><link url="sendAuthcCodeSms" text="Send new code to ${userAuthcFactor?.factorOption}"/></widgets></screen>
<!-- Screen Location component://tools/screen/System/Security/UserAccount/UserAccountDetail/VerifyTotp.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="factorId"/><parameter name="userId" required="true"/><transition name="verifyUserAuthcFactor"><service-call name="org.moqui.impl.UserServices.validate#UserAuthcFactorCode" in-map="context" out-map="context" multi="parameter"/><actions><if condition="!verified"><message type="danger"><![CDATA[Authentication code is not valid]]></message></if></actions><default-response url=".."/></transition><actions><service-call name="org.moqui.impl.UserServices.setup#UserAuthcFactorTotp" in-map="[userId:userId, factorId:factorId]" out-map="context"/></actions><widgets><label text="Follow the Steps below to Complete Verification" type="h5" condition="needsValidation == 'Y'"/><label text="View the Authenticator App Information" type="h5" condition="needsValidation == 'N'"/><container type="ol"><container type="li"><label text="Open Authenticator App on device such as Google Authenticator, Authy, or Lastpass Authenticator"/></container><container type="li"><label text="Choose Either of the Options Below"/></container><container type="ul"><container type="li"><label text="Scan this QR Code"/></container><text><![CDATA[<img src="${dataUri}"/>]]></text><container type="li"><label text="Enter the Data Below Manually"/></container><container type="ul"><container type="li"><label text="Label: ${qrLabel}"/></container><container type="li"><label text="Issuer: ${qrIssuer}"/></container><container type="li"><label text="Secret: ${qrSecret}"/></container></container></container><container type="li"><label text="Verify by Entering the Generated Code into the Text Box below" condition="needsValidation == 'Y'"/><label text="You're Already Verified that's It!" condition="needsValidation == 'N'"/></container><form-single name="VerifyUserAuthcFactor" transition="verifyUserAuthcFactor"><field name="userId" from="userId"><conditional-field condition="needsValidation == 'Y'"><hidden/></conditional-field></field><field name="factorTypeEnumId"><conditional-field condition="needsValidation == 'Y'"><hidden default-value="UafTotp"/></conditional-field></field><field name="code"><conditional-field condition="needsValidation == 'Y'"><text-line size="30"/></conditional-field></field><field name="submit"><conditional-field condition="needsValidation == 'Y'"><submit/></conditional-field></field></form-single></container></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/MyAccount/User/Account.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Account" default-menu-index="9"><always-actions><set field="partyId" from="ec.user.userAccount?.partyId"/><set field="userId" from="ec.user.userId"/></always-actions><transition name="updateUser"><service-call name="mantle.party.PartyServices.update#Account" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="changePassword"><service-call name="org.moqui.impl.UserServices.update#Password" in-map="true" out-map="context" multi="parameter"/><default-response url="."/><error-response url="."/></transition><transition name="createUserAuthcFactorTotp"><service-call name="org.moqui.impl.UserServices.create#UserAuthcFactorTotp" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="verifyUserAuthcFactorTotp"><service-call name="org.moqui.impl.UserServices.verify#UserAuthcFactorTotp" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createUserAuthcFactorSingleUse"><service-call name="org.moqui.impl.UserServices.create#SingleUseAuthcCodes" in-map="true" out-map="context" multi="parameter"/><actions><script><![CDATA[ec.web.sessionAttributes.put("singleUseCodes", singleUseCodes)]]></script></actions><default-response url="."/></transition><transition name="createUserAuthcFactorEmail"><service-call name="org.moqui.impl.UserServices.create#UserAuthcFactorEmail" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createUserAuthcFactorSms"><service-call name="org.moqui.impl.UserServices.create#UserAuthcFactorSms" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="factorSubmit"><service-call name="org.moqui.impl.UserServices.invalidate#UserAuthcFactorEntry" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="sendOtp"><service-call name="org.moqui.impl.UserServices.send#ExternalAuthcCode" in-map="[factorId:factorId]" out-map="context" multi="parameter"/><default-response url="."/></transition><subscreens><subscreens-item name="VerifyEmail" location="component://tools/screen/System/Security/UserAccount/UserAccountDetail/VerifyEmail.xml"/><subscreens-item name="VerifySms" location="component://tools/screen/System/Security/UserAccount/UserAccountDetail/VerifySms.xml"/><subscreens-item name="VerifyTotp" location="component://tools/screen/System/Security/UserAccount/UserAccountDetail/VerifyTotp.xml"/></subscreens><actions><entity-find-one entity-name="mantle.party.PersonAndUserAccount" value-field="personAndUserAccount"/><if condition="personAndUserAccount == null"><set field="personAndUserAccount" from="ec.user.userAccount"/></if><set field="singleUseCodes" from="ec.web.sessionAttributes.remove('singleUseCodes')"/><service-call name="org.moqui.impl.UserServices.get#UserAuthcFactorInfo" out-map="context"><field-map field-name="userId"/><field-map field-name="getFactorsIfNotRequired" from="false"/></service-call><if condition="partyId && !personAndUserAccount?.emailAddress"><service-call name="mantle.party.ContactServices.get#PrimaryEmailAddress" in-map="[partyId:partyId]" out-map="primaryEmail"/></if><set field="localeStringList" from="[]"/><iterate list="Locale.getAvailableLocales()" entry="lcl"><script><![CDATA[if (lcl.toString()) localeStringList.add([locale:lcl.toString(), name:lcl.getDisplayName(ec.user.locale)])]]></script></iterate><order-map-list list="localeStringList"><order-by field-name="name"/></order-map-list><set field="sendSmsLoc" from="ec.service.getServiceDefinition('org.moqui.SmsServices.send#SmsMessage')?.serviceNode?.fileLocation"/><set field="isSmsActive" from="sendSmsLoc && !sendSmsLoc.contains('classpath')"/></actions><widgets><container-panel id="UserInfoContainer"><panel-center><container-dialog id="change-password" button-text="Change Password"><form-single name="ChangePasswordForm" transition="changePassword"><field name="oldPassword"><default-field><password size="20"/></default-field></field><field name="newPassword"><default-field><password size="20"/></default-field></field><field name="newPasswordVerify"><default-field><password size="20"/></default-field></field><field name="code"><conditional-field condition="secondFactorRequired" title="Auth Code"><text-line size="10"/></conditional-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single><section name="SecondFactorSection" condition="secondFactorRequired"><widgets><label text="An authentication code is required to change your password" type="p"/><container><label text="You have these options setup on your account:"/><label text="${factorTypeDescriptions.join(', ')}" type="strong"/></container><section-iterate name="SecondFactorSendSection" list="sendableFactors" entry="userAuthcFactor"><widgets><form-single name="SecondFactorSendForm" transition="sendOtp"><field name="factorId" from="userAuthcFactor.factorId"><default-field><hidden/></default-field></field><field name="submitBtn"><default-field><submit type="info" text="Send code to ${userAuthcFactor.factorOption}"/></default-field></field></form-single></widgets></section-iterate></widgets></section></container-dialog><form-single name="EditUser" transition="updateUser" map="personAndUserAccount"><field name="userId"><default-field><hidden/></default-field></field><field name="username"><default-field><display/></default-field></field><field name="firstName"><default-field><text-line size="15"/></default-field></field><field name="middleName"><default-field><text-line size="15"/></default-field></field><field name="lastName"><default-field><text-line size="15"/></default-field></field><field name="emailAddress" from="emailAddress ?: primaryEmail?.emailAddress"><default-field><text-line/></default-field></field><field name="locale"><default-field><drop-down allow-empty="true"><list-options list="localeStringList" key="${locale}" text="${name}"/></drop-down></default-field></field><field name="timeZone"><default-field><drop-down allow-empty="true"><list-options list="new TreeSet(TimeZone.getAvailableIDs().collect())"/></drop-down></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single><section name="SingleUseCodesDisplay" condition="singleUseCodes"><actions><set field="singleUseCodes1" from="[]"/><set field="singleUseCodes2" from="[]"/><set field="singleUseCodes3" from="[]"/><script><![CDATA[for (int i = 0; i < singleUseCodes.size(); i++) {
                            if (i%3 == 0) { singleUseCodes1.add(singleUseCodes[i]) }
                            else if (i%3 == 1) { singleUseCodes2.add(singleUseCodes[i]) }
                            else if (i%3 == 2) { singleUseCodes3.add(singleUseCodes[i]) }
                        }]]></script></actions><widgets><container-box><box-header><label text="Single Use Codes" style="text-danger" type="h5"/></box-header><box-body><label text="Write down these codes. They will only appear once." style="text-danger"/><container-row><row-col lg="4"><container type="ul"><section-iterate name="SingleUseCodes1" list="singleUseCodes1" entry="code1"><widgets><container type="li"><label text="${code1}" style="text-danger"/></container></widgets></section-iterate></container></row-col><row-col lg="4"><container type="ul"><section-iterate name="SingleUseCodes2" list="singleUseCodes2" entry="code2"><widgets><container type="li"><label text="${code2}" style="text-danger"/></container></widgets></section-iterate></container></row-col><row-col lg="4"><container type="ul"><section-iterate name="SingleUseCodes3" list="singleUseCodes3" entry="code3"><widgets><container type="li"><label text="${code3}" style="text-danger"/></container></widgets></section-iterate></container></row-col></container-row></box-body></container-box></widgets></section><container-box><box-header title="Authentication Methods"/><box-toolbar><container-dialog id="CreateTotpDialog" button-text="Add Authenticator App"><form-single name="CreateUserAuthcFactorTotp" transition="createUserAuthcFactorTotp"><field name="userId"><default-field><hidden/></default-field></field><field name="thruDate" from="ec.user.nowTimestamp + 365"><default-field><date-time/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog><container-dialog id="AddSingleUseDialog" button-text="Add Single Use Codes"><form-single name="CreateUserAuthcFactorSingleUse" transition="createUserAuthcFactorSingleUse"><field name="userId"><default-field><hidden/></default-field></field><field name="fromDate" from="ec.user.nowTimestamp + 365"><default-field><date-time/></default-field></field><field name="numberOfCodes"><default-field title="Number of Codes"><text-line size="5" default-value="1"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog><container-dialog id="AddEmailFactor" button-text="Add Email Factor"><form-single name="CreateUserAuthcFactorEmail" transition="createUserAuthcFactorEmail"><field name="userId"><default-field><hidden/></default-field></field><field name="thruDate" from="ec.user.nowTimestamp + 365"><default-field><date-time/></default-field></field><field name="factorOption" from="ec.user.userAccount.emailAddress"><default-field title="Email"><text-line size="40"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog><container-dialog id="AddSmsFactor" button-text="Add SMS Factor" condition="isSmsActive"><form-single name="CreateUserAuthcFactorSms" transition="createUserAuthcFactorSms"><field name="userId"><default-field><hidden/></default-field></field><field name="thruDate" from="ec.user.nowTimestamp + 365"><default-field><date-time/></default-field></field><field name="factorOption"><default-field title="Phone (for SMS)"><text-line size="15"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body-nopad><form-list name="UserAuthcFactorList" list="userAuthcFactorList" transition="factorSubmit"><entity-find entity-name="moqui.security.UserAuthcFactor" list="userAuthcFactorList"><date-filter/><econdition field-name="userId"/><select-field field-name="factorTypeEnumId,factorOption"/></entity-find><field name="userId" from="userId"><default-field><hidden/></default-field></field><field name="factorId"><default-field title="ID"><display/></default-field></field><field name="fromFactorId"><default-field title="From ID"><display/></default-field></field><field name="factorTypeEnumId"><default-field title="Factor Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="fromDate"><default-field><display/></default-field></field><field name="thruDate"><default-field><display/></default-field></field><field name="action"><conditional-field condition="needsValidation == 'Y' && factorTypeEnumId == 'UafTotp'"><dynamic-dialog id="VerifyTotpDialog" button-text="Verify" transition="VerifyTotp" parameter-map="[userId:userId, factorId:factorId, verify:true]"/></conditional-field><conditional-field condition="needsValidation == 'Y' && factorTypeEnumId == 'UafEmail'"><dynamic-dialog id="VerifyEmailDialog" button-text="Verify" transition="VerifyEmail" parameter-map="[userId:userId, factorId:factorId]"/></conditional-field><conditional-field condition="needsValidation == 'Y' && factorTypeEnumId == 'UafSms'"><dynamic-dialog id="VerifySmsDialog" button-text="Verify" transition="VerifySms" parameter-map="[userId:userId, factorId:factorId]"/></conditional-field><conditional-field condition="needsValidation == 'N' && factorTypeEnumId in ['UafEmail', 'UafSms']"><label text="${factorOption}"/></conditional-field></field><field name="needsValidation"><default-field><display/></default-field></field><field name="delete"><default-field title=" "><submit text=" " icon="fa fa-trash"/></default-field></field></form-list></box-body-nopad></container-box></panel-center></container-panel></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/MyAccount/User.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="User" default-menu-index="1"><subscreens default-item="Notifications"/><widgets><subscreens-panel id="user-panel" type="tab"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/MyAccount/Expense/FindExpenseInvoice.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="findInvoice"><default-response url="."/></transition><transition name="editInvoice"><default-response url="../EditExpenseInvoice"/></transition><transition name="createInvoice"><service-call name="mantle.account.InvoiceServices.create#ProjectExpenseInvoice" in-map="context" out-map="context" multi="parameter"/><default-response url="../EditExpenseInvoice"/></transition><transition name="createProjectInvoiceItems"><service-call name="mantle.account.InvoiceServices.create#ProjectInvoiceItems" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><entity-find entity-name="mantle.work.effort.WorkEffortAndParty" list="myProjectList"><date-filter/><econdition field-name="partyId"/><econdition field-name="workEffortTypeEnumId" value="WetProject"/></entity-find><entity-find entity-name="mantle.account.invoice.Invoice" list="invoiceList"><econdition field-name="invoiceTypeEnumId" value="InvoiceSales"/><econdition field-name="fromPartyId" from="partyId"/><order-by field-name="-invoiceDate"/></entity-find><filter-map-list list="invoiceList" to-list="openInvoiceList"><field-map field-name="statusId" value="InvoiceIncoming"/></filter-map-list></actions><widgets><section name="HasProjectsSection" condition="myProjectList"><widgets><container-dialog id="CreateInvoiceDialog" button-text="Create Expense Invoice"><form-single name="CreateInvoice" transition="createInvoice"><field name="fromPartyId" from="partyId"><default-field><hidden/></default-field></field><field name="workEffortId"><default-field title="Project"><drop-down><list-options list="myProjectList" key="${workEffortId}" text="WorkEffortNameTemplate"/></drop-down></default-field></field><field name="invoiceDate"><default-field><date-time/></default-field></field><field name="description"><default-field><text-line size="60"/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><container-dialog id="WorkerInvoiceDialog" button-text="Invoice Time" width="700"><form-single name="WorkerInvoice" transition="createProjectInvoiceItems"><field name="workerPartyId" from="partyId"><default-field><hidden/></default-field></field><field name="ratePurposeEnumId"><default-field><hidden default-value="RaprVendor"/></default-field></field><field name="workEffortId"><default-field title="Project"><drop-down><list-options list="myProjectList" key="${workEffortId}" text="WorkEffortNameTemplate"/></drop-down></default-field></field><field name="thruDate"><default-field><date-time type="date-time"/></default-field></field><field name="invoiceId"><default-field title="Existing Invoice"><drop-down allow-empty="true"><list-options list="openInvoiceList" key="${invoiceId}" text="${invoiceId} - ${invoiceDate}"/></drop-down></default-field></field><field name="submitButton"><default-field title="Invoice Time"><submit/></default-field></field></form-single></container-dialog></widgets></section><form-list name="InvoiceList" list="invoiceList" skip-form="true"><row-actions><service-call name="mantle.account.InvoiceServices.get#InvoiceTotal" in-map="[invoiceId:invoiceId]" out-map="context"/></row-actions><field name="editInvoiceLink"><header-field show-order-by="case-insensitive" title="Edit"/><default-field><link url="editInvoice" text="Edit ${invoiceId}"/></default-field></field><field name="toPartyId"><default-field title="To"><display-entity entity-name="mantle.party.PartyDetail" also-hidden="false" key-field-name="partyId" text="PartyNameTemplate"/></default-field></field><field name="description"><default-field><display/></default-field></field><field name="invoiceDate"><header-field show-order-by="true"/><default-field><display also-hidden="false"/></default-field></field><field name="invoiceTotal"><default-field title="Total"><display currency-unit-field="currencyUomId"/></default-field></field><field name="currencyUomId"><default-field title="Currency"><display-entity entity-name="moqui.basic.Uom" key-field-name="uomId" text="${description}" also-hidden="true"/></default-field></field><field name="statusId"><header-field show-order-by="true"/><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem" also-hidden="false"/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/MyAccount/Expense/EditExpenseInvoice.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Expense Invoice" default-menu-index="1"><parameter name="invoiceId" required="true"/><transition name="updateInvoice"><service-call name="update#mantle.account.invoice.Invoice" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createProjectInvoiceItems"><service-call name="mantle.account.InvoiceServices.create#ProjectInvoiceItems" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><pre-actions><set field="partyId" from="ec.user.userAccount.partyId"/><entity-find-one entity-name="mantle.account.invoice.Invoice" value-field="invoice"/><if condition="invoice.fromPartyId != partyId"><script><![CDATA[throw new IllegalArgumentException("You may not view or edit Invoice #${invoiceId}")]]></script></if></pre-actions><actions><service-call name="mantle.account.InvoiceServices.get#InvoiceTotal" in-map="[invoiceId:invoiceId]" out-map="context"/><entity-find entity-name="mantle.work.effort.WorkEffortAndParty" list="myProjectList"><date-filter/><econdition field-name="partyId"/><econdition field-name="workEffortTypeEnumId" value="WetProject"/></entity-find></actions><widgets><section name="SubmitInvoiceSection" condition="invoice.statusId == 'InvoiceIncoming' && invoiceTotal"><widgets><link url="updateInvoice" text="Submit Invoice" parameter-map="[invoiceId:invoiceId, statusId:'InvoiceReceived']"/></widgets></section><section name="CancelInvoiceSection" condition="invoice.statusId == 'InvoiceIncoming'"><widgets><link url="updateInvoice" text="Cancel Invoice" parameter-map="[invoiceId:invoiceId, statusId:'InvoiceCancelled']"/><container-dialog id="WorkerInvoiceDialog" button-text="Invoice Time" width="700"><form-single name="WorkerInvoice" transition="createProjectInvoiceItems"><field name="workerPartyId" from="partyId"><default-field><hidden/></default-field></field><field name="ratePurposeEnumId"><default-field><hidden default-value="RaprVendor"/></default-field></field><field name="invoiceId"><default-field><hidden/></default-field></field><field name="workEffortId"><default-field title="Project"><drop-down><list-options list="myProjectList" key="${workEffortId}" text="WorkEffortNameTemplate"/></drop-down></default-field></field><field name="thruDate"><default-field><date-time type="date-time"/></default-field></field><field name="submitButton"><default-field title="Invoice Time"><submit/></default-field></field></form-single></container-dialog></widgets></section><form-single name="EditInvoice" transition="updateInvoice" map="invoice"><field name="rootWorkEffortId"><default-field title="Project"><display-entity entity-name="mantle.work.effort.WorkEffort" key-field-name="workEffortId" text="WorkEffortNameTemplate"/></default-field></field><field name="invoiceId"><default-field><display/></default-field></field><field name="fromPartyId"><default-field title="From"><display-entity entity-name="mantle.party.PartyDetail" also-hidden="false" key-field-name="partyId" text="PartyNameTemplate"/></default-field></field><field name="toPartyId"><default-field title="To"><display-entity entity-name="mantle.party.PartyDetail" also-hidden="false" key-field-name="partyId" text="PartyNameTemplate"/></default-field></field><field name="invoiceDate"><default-field><display also-hidden="false"/></default-field></field><field name="invoiceTotal"><default-field><display currency-unit-field="currencyUomId"/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem" also-hidden="false"/></default-field></field><field name="description"><conditional-field condition="invoice.statusId == 'InvoiceIncoming'"><text-line size="60"/></conditional-field><default-field><display/></default-field></field><field name="submitButton"><conditional-field condition="invoice.statusId == 'InvoiceIncoming'" title="Update Invoice"><submit/></conditional-field><default-field><ignored/></default-field></field></form-single></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/MyAccount/Expense/EditExpenseInvoiceItems.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Items" default-menu-index="2"><parameter name="invoiceId" required="true"/><parameter name="invoiceId_0"/><transition name="createInvoiceItem"><service-call name="create#mantle.account.invoice.InvoiceItem" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateInvoiceItem"><service-call name="update#mantle.account.invoice.InvoiceItem" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteInvoiceItem"><service-call name="delete#mantle.account.invoice.InvoiceItem" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><pre-actions><set field="partyId" from="ec.user.userAccount.partyId"/><set field="invoiceId" from="invoiceId ?: invoiceId_0"/><entity-find-one entity-name="mantle.account.invoice.Invoice" value-field="invoice"/><if condition="invoice.fromPartyId != partyId"><script><![CDATA[throw new IllegalArgumentException("You may not view or edit Invoice #${invoiceId}")]]></script></if></pre-actions><actions><service-call name="mantle.account.InvoiceServices.get#InvoiceTotal" in-map="[invoiceId:invoiceId]" out-map="context"/><entity-find entity-name="mantle.account.invoice.InvoiceItem" list="invoiceItemList"><econdition field-name="invoiceId"/></entity-find></actions><widgets><section name="AddItemSection" condition="invoice.statusId == 'InvoiceIncoming'"><widgets><container-dialog id="AddInvoiceItemDialog" button-text="Add Invoice Item" width="700"><form-single name="CreateInvoiceItem" transition="createInvoiceItem"><field name="invoiceId"><default-field><hidden/></default-field></field><field name="itemTypeEnumId"><default-field title="Type"><drop-down no-current-selected-key="ItemExpense"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="parentEnumId" value="ItemExpense"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="description"><default-field><text-line size="50"/></default-field></field><field name="itemDate"><default-field title="Date"><date-time/></default-field></field><field name="quantity"><default-field><text-line size="4"/></default-field></field><field name="amount"><default-field><text-line size="8"/></default-field></field><field name="submitButton"><default-field title="Create Invoice Item"><submit/></default-field></field></form-single></container-dialog></widgets></section><label text="Invoice Total: ${ec.l10n.formatCurrency(invoiceTotal, invoice.currencyUomId)}"/><form-list name="EditInvoiceItems" list="invoiceItemList" transition="updateInvoiceItem" multi="true"><field name="rootWorkEffortId"><default-field><hidden/></default-field></field><field name="invoiceId"><default-field><hidden/></default-field></field><field name="invoiceItemSeqId"><default-field title="Item"><display/></default-field></field><field name="itemTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration" text="${description}" key-field-name="enumId"/></default-field></field><field name="itemDate"><conditional-field condition="invoice.statusId == 'InvoiceIncoming'"><date-time/></conditional-field><default-field title="Date"><display/></default-field></field><field name="description"><conditional-field condition="invoice.statusId == 'InvoiceIncoming'"><text-line size="35"/></conditional-field><default-field><display/></default-field></field><field name="quantity"><conditional-field condition="invoice.statusId == 'InvoiceIncoming'"><text-line size="4"/></conditional-field><default-field><display/></default-field></field><field name="amount"><conditional-field condition="invoice.statusId == 'InvoiceIncoming'"><text-line size="8"/></conditional-field><default-field><display currency-unit-field="invoice.currencyUomId"/></default-field></field><field name="total" from="((quantity?:0.0) * (amount?:0.0))"><default-field><display currency-unit-field="invoice.currencyUomId"/></default-field></field><field name="delete"><conditional-field condition="invoice.statusId == 'InvoiceIncoming'"><link url="deleteInvoiceItem" text="Delete Item" parameter-map="[invoiceId:invoiceId, invoiceItemSeqId:invoiceItemSeqId]"/></conditional-field><default-field><ignored/></default-field></field><field name="submitButton"><conditional-field condition="invoice.statusId == 'InvoiceIncoming'" title="Update"><submit/></conditional-field><default-field><ignored/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/MyAccount/Expense.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Expenses" default-menu-index="5"><subscreens default-item="FindExpenseInvoice"/><widgets><subscreens-panel id="expenses-panel" type="tab"/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/MyAccount.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="My Account" default-menu-index="99" menu-image="fa fa-user" menu-image-type="icon"><subscreens default-item="User"/><pre-actions><set field="partyId" from="ec.user.userAccount.partyId"/></pre-actions><widgets><subscreens-panel id="my-account-panel" type="popup"/></widgets></screen>
<!-- Screen Location component://WorkManagement/screen/wm/Project.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Projects" default-menu-index="10" render-modes="vue,qvue" server-static="vue,qvue"><widgets><render-mode><text type="vue,qvue" location="component://WorkManagement/screen/wm/Project/Project.qvue"/></render-mode></widgets></screen>
<!-- Screen Location component://WorkManagement/screen/wm/Task.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Tasks" default-menu-index="10" render-modes="vue,qvue" server-static="vue,qvue"><widgets><render-mode><text type="vue,qvue" location="component://WorkManagement/screen/wm/Task/Task.qvue"/></render-mode></widgets></screen>
<!-- Screen Location component://WorkManagement/screen/wiki/WikiSpaces.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Wiki Spaces" default-menu-index="10" render-modes="vue,qvue" server-static="vue,qvue"><widgets><render-mode><text type="vue,qvue" location="component://WorkManagement/screen/wiki/Wiki/WikiSpaces.qvue"/></render-mode></widgets></screen>
<!-- Screen Location component://WorkManagement/screen/wiki/WikiBlogs.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Wiki Blog Posts" default-menu-index="10" render-modes="vue,qvue" server-static="vue,qvue"><widgets><render-mode><text type="vue,qvue" location="component://WorkManagement/screen/wiki/WikiBlogs/WikiBlogs.qvue"/></render-mode></widgets></screen>
<!-- Screen Location component://WorkManagement/screen/wiki/WikiDetail.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Wiki Detail" default-menu-index="10" render-modes="vue,qvue" server-static="vue,qvue"><widgets><render-mode><text type="vue,qvue" location="component://WorkManagement/screen/wiki/Wiki/WikiDetail.qvue"/></render-mode></widgets></screen>
<!-- Screen Location component://WorkManagement/screen/wm.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" menu-image="fa fa-flash" menu-image-type="icon"><subscreens default-item="Task"><subscreens-item name="WikiOld" menu-title="Wiki Old" location="component://SimpleScreens/screen/SimpleScreens/Wiki.xml" menu-index="99"/><subscreens-item name="WikiSpaces" menu-title="Wiki" location="component://WorkManagement/screen/wiki/WikiSpaces.xml" menu-index="100"/><subscreens-item name="WikiDetail" menu-title="Wiki Detail" location="component://WorkManagement/screen/wiki/WikiDetail.xml" menu-index="101" menu-include="false"/><subscreens-item name="WikiBlogs" menu-title="Wiki Blog Posts" location="component://WorkManagement/screen/wiki/WikiBlogs.xml" menu-index="101" menu-include="false"/></subscreens><widgets><subscreens-panel id="work-panel" type="popup"/><render-mode><text type="html,vuet,qvt,qvue"><![CDATA[<script>
        $(function() {
            let existing_ckeditor = document.getElementById("id_ckeditor");
            let ckeditor_url = "${sri.buildUrl('Scripts/ckeditor.js').url}";
            let current_page_url = window.location.href;
            if (current_page_url.includes("/wm/WikiDetail?wikiSpaceId=") || current_page_url.includes("/wm/WikiBlogs?wikiSpaceId=") || current_page_url.includes("wm/Task") || current_page_url.includes("/wm/Project")) {
                if (!existing_ckeditor) {
                    (function(d, script) {
                        script = d.createElement('script');
                        script.type = 'text/javascript';
                        script.async = true;
                        script.id = "id_ckeditor";
                        script.onload = function(){
                            // remote script has loaded
                        };
                        script.src = ckeditor_url;
                        d.getElementsByTagName('head')[0].appendChild(script);
                    }(document));
                }
            }
            else {
                if (existing_ckeditor) {
                    document.head.removeChild(existing_ckeditor);
                }
            }
        });
        </script><script src="https://cdnjs.cloudflare.com/ajax/libs/showdown/2.1.0/showdown.min.js" integrity="sha512-LhccdVNGe2QMEfI3x4DVV3ckMRe36TfydKss6mJpdHjNFiV07dFpS2xzeZedptKZrwxfICJpez09iNioiSZ3hA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/turndown/7.1.1/turndown.min.js" integrity="sha512-7f2yNDjY95XObwgNriZ38R/29bcPSuGWkM3NotiI6JeKe/GdBXkjzuYAVnM+yQEtwLbvDYn20fZy8QJ79aSEew==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jsdiff/3.2.0/diff.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>]]></text></render-mode></widgets></screen>
<!-- Screen Location component://ai/screen/App.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" include-child-content="true" require-authentication="false" menu-image="fa fa-flash" menu-image-type="icon"><widgets><label text="Hello World!" style="font-size: 24px; font-weight: bold; color: #00f; margin: 20px;"/></widgets></screen>
<!-- Screen Location component://example/screen/ExampleApp/Example/EditExampleItemList.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="exampleId"/><transition name="updateExampleItem"><service-call name="update#moqui.example.ExampleItem" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditExampleItems"><parameter name="exampleId" from="exampleId_0"/></default-response></transition><transition name="deleteExampleItem"><service-call name="delete#moqui.example.ExampleItem" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditExampleItems"/></transition><actions><entity-find entity-name="moqui.example.ExampleItem" list="exampleItemList"><search-form-inputs default-order-by="exampleItemSeqId"/><econdition field-name="exampleId" from="exampleId"/></entity-find><entity-find entity-name="moqui.basic.UomAndType" list="allUomAndTypeList"><econdition field-name="uomTypeEnumId" operator="not-equals" value="UT_CURRENCY_MEASURE"/><order-by field-name="typeDescription"/><order-by field-name="description"/></entity-find></actions><widgets><form-list name="ListExampleItems" transition="updateExampleItem" list="exampleItemList" multi="true"><auto-fields-service service-name="update#moqui.example.ExampleItem"/><field name="exampleId"><header-field><hidden/></header-field><default-field><hidden/></default-field></field><field name="exampleItemSeqId"><default-field title="Item"><display/></default-field></field><field name="description"><header-field show-order-by="true"><text-find hide-options="true" size="15"/></header-field><default-field><text-line size="15"/></default-field></field><field name="amount"><header-field show-order-by="true"/><default-field><text-line size="5"/></default-field></field><field name="amountUomId"><header-field><drop-down allow-empty="true"><list-options list="allUomAndTypeList" key="${uomId}" text="${typeDescription} - ${ec.resource.expand('UomNameTemplate','')}"/></drop-down></header-field><default-field title="UOM"><drop-down allow-empty="true"><list-options list="allUomAndTypeList" key="${uomId}" text="${typeDescription} - ${ec.resource.expand('UomNameTemplate','')}"/></drop-down></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field name="deleteLink"><header-field title="Find"><submit/></header-field><default-field title=""><link url="deleteExampleItem" text="Delete" confirmation="Really Delete?"/></default-field></field><form-list-column><field-ref name="exampleItemSeqId"/></form-list-column><form-list-column><field-ref name="description"/></form-list-column><form-list-column><field-ref name="amount"/></form-list-column><form-list-column><field-ref name="amountUomId"/></form-list-column><form-list-column><field-ref name="deleteLink"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://example/screen/ExampleApp/Example/FindExample.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="findExample"><default-response url="."/></transition><transition name="editExample"><default-response url="../EditExample"/></transition><transition name="createExample"><service-call name="moqui.example.ExampleServices.createExample" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditExample"/></transition><transition name="getExampleTypeEnumList"><actions><log level="warn" message="In getExampleTypeEnumList transition statusId=${statusId}"/><entity-find entity-name="moqui.basic.Enumeration" list="exampleTypeEnumList"><econdition field-name="enumTypeId" value="ExampleType"/><order-by field-name="description"/></entity-find><script><![CDATA[ec.web.sendJsonResponse(exampleTypeEnumList)]]></script></actions><default-response type="none"/></transition><pre-actions><set field="html_title" value="Find Example"/><set field="html_description" value="A page for finding Examples"/><set field="html_keywords" value="moqui,find,example,status,edit,new"/></pre-actions><actions><entity-find entity-name="moqui.example.Example" list="exampleList"><search-form-inputs default-order-by="^exampleName"/></entity-find><entity-find entity-name="ExampleStatusItem" list="exampleStatusItemList"/></actions><widgets><container-box><box-header><label text="Find Examples" type="h5"/></box-header><box-toolbar><container-dialog id="CreateExampleDialog" button-text="Create Example"><form-single name="CreateExample" transition="createExample" focus-field="exampleName"><field name="statusId"><default-field title="Status" tooltip="The status of the example"><drop-down allow-empty="false"><list-options list="exampleStatusItemList" text="${description}"/></drop-down></default-field></field><field name="exampleTypeEnumId"><default-field title="Type" tooltip="Type of example"><drop-down allow-empty="false"><dynamic-options transition="getExampleTypeEnumList" value-field="enumId" label-field="description"><depends-on field="statusId"/></dynamic-options></drop-down></default-field></field><field name="exampleName"><default-field tooltip="The name of the example"><text-line/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="ListExamples" list="exampleList" skip-form="true" header-dialog="true" select-columns="true" show-csv-button="true" show-text-button="true" show-pdf-button="true"><field name="exampleId" print-width="10" print-width-type="characters"><header-field><text-find hide-options="true"/></header-field><default-field><link url="editExample" text="${exampleId}" link-type="anchor"/></default-field></field><field name="exampleName" print-width="40"><header-field title="Name" show-order-by="case-insensitive"><text-find/></header-field><default-field><link url="editExample" text="${exampleName}" link-type="anchor"/></default-field></field><field name="exampleTypeEnumId" print-width="30"><header-field title="Type"><auto-widget-entity entity-name="moqui.example.Example" field-type="edit"/></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="statusId" print-width="30"><header-field title="Status"><drop-down allow-empty="true"><list-options list="exampleStatusItemList" text="${description}"/></drop-down></header-field><default-field><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="exampleDate" print-width="16" print-width-type="characters"><header-field title="Date" show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="description" print-width="0"><header-field show-order-by="case-insensitive"><text-find/></header-field><default-field><display/></default-field></field><field name="findButton"><header-field title=""><submit text="Find"/></header-field><default-field><ignored/></default-field></field></form-list></box-body></container-box></widgets></screen>
<!-- Screen Location component://example/screen/ExampleApp/Example/EditExample.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Example" default-menu-index="1"><parameter name="exampleId" required="true"/><transition name="updateExample"><service-call name="moqui.example.ExampleServices.updateExample" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="edit"><path-parameter name="exampleId"/><default-response url="."><parameter name="exampleId" from="exampleId"/></default-response></transition><transition name="features"><path-parameter name="exampleId"/><default-response url="../EditExampleFeatureAppls"><parameter name="exampleId" from="exampleId"/><parameter name="test" value="foo"/></default-response></transition><actions><entity-find-one entity-name="moqui.example.Example" value-field="example"/><log message="EditExample exampleId [${exampleId}] example [${example}]"/></actions><widgets><section name="ExampleMenu" condition="example"><widgets><label text="Test/Example Links:"/><link url="edit" text="Edit" link-type="anchor"/><link url="features" text="Features" link-type="anchor"/><link url="/apps/example/Example/EditExample/features/${exampleId}" text="Features - Path Parameter" link-type="anchor"/></widgets></section><form-single name="UpdateExample" transition="updateExample" map="example"><auto-fields-service service-name="moqui.example.ExampleServices.create#Example"/><field name="exampleId"><default-field><display/></default-field></field><field name="exampleTypeEnumId"><default-field title="Type" tooltip="This is the type of example"><auto-widget-entity entity-name="Example" field-type="edit"/></default-field></field><field name="statusId"><default-field title="Status" tooltip="This is the status of the example"><drop-down allow-empty="false" current-description="${example?.'Example#moqui.basic.StatusItem'?.description}"><entity-options key="${toStatusId}" text="StatusTransitionNameTemplate"><entity-find entity-name="moqui.basic.StatusFlowTransitionToDetail"><econdition field-name="statusId" from="example.statusId"/></entity-find></entity-options></drop-down></default-field></field><field name="exampleName"><default-field tooltip="The name of the example"><text-line/></default-field></field><field name="description"><default-field tooltip="The description of the example"><text-line/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field-layout><field-ref name="exampleId"/><fields-not-referenced/><field-row><field-ref name="exampleSize"/><field-ref name="exampleDate"/></field-row><field-row><field-ref name="testDate"/><field-ref name="testTime"/></field-row><field-accordion active="1"><field-group title="Special Fields"><field-ref name="auditedField"/><field-ref name="encryptedField"/></field-group><field-group title="Validated Fields"><field-ref name="exampleEmail"/><field-ref name="exampleUrl"/></field-group></field-accordion><field-ref name="submitButton"/></field-layout></form-single></widgets></screen>
<!-- Screen Location component://example/screen/ExampleApp/Example/EditExampleItems.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Items" default-menu-index="2"><parameter name="exampleId" required="true"/><transition name="createExampleItem"><service-call name="moqui.example.ExampleServices.create#ExampleItem" web-send-json-response="true" in-map="true" out-map="context" multi="parameter"/><default-response type="none"/></transition><transition name="editExampleItemList"><default-response url="../EditExampleItemList"/></transition><actions><entity-find entity-name="moqui.basic.UomAndType" list="allUomAndTypeList"><econdition field-name="uomTypeEnumId" operator="not-equals" value="UT_CURRENCY_MEASURE"/><order-by field-name="typeDescription"/><order-by field-name="description"/></entity-find></actions><widgets><container-dialog id="AddItemDialog" button-text="Add Item"><form-single name="AddExampleItem" transition="createExampleItem" background-submit="true" background-reload-id="EditExampleItemListContainer" background-message="Example item added"><auto-fields-service service-name="create#moqui.example.ExampleItem"/><field name="exampleId"><default-field><hidden/></default-field></field><field name="exampleItemSeqId"><default-field><ignored/></default-field></field><field name="amountUomId"><default-field title="UOM"><drop-down allow-empty="true"><list-options list="allUomAndTypeList" key="${uomId}" text="${typeDescription} - ${ec.resource.expand('UomNameTemplate','')}"/></drop-down></default-field></field><field name="submitButton"><default-field title="Add"><submit confirmation="Really Add?"/></default-field></field></form-single></container-dialog><dynamic-container id="EditExampleItemListContainer" transition="editExampleItemList"/></widgets></screen>
<!-- Screen Location component://example/screen/ExampleApp/Example/EditExampleFeatureAppls.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Features" default-menu-index="3"><parameter name="exampleId" required="true"/><transition name="editExampleFeature"><default-response url="../../Feature/EditExampleFeature"/></transition><transition name="createExampleFeatureAppl"><service-call name="moqui.example.ExampleServices.create#ExampleFeatureAppl" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateExampleFeatureAppl"><service-call name="update#moqui.example.ExampleFeatureAppl" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteExampleFeatureAppl"><service-call name="delete#moqui.example.ExampleFeatureAppl" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><entity-find entity-name="moqui.example.ExampleFeatureAppl" list="exampleFeatureApplList"><econdition field-name="exampleId" from="exampleId"/><order-by field-name="sequenceNum"/></entity-find><entity-find entity-name="moqui.basic.Enumeration" list="exampleFeatureApplEnumList"><econdition field-name="enumTypeId" value="ExampleFeatureAppl"/><order-by field-name="description"/></entity-find><entity-find entity-name="ExampleFeature" list="allExampleFeatureList"><order-by field-name="description"/></entity-find></actions><widgets><form-list name="ListExampleFeatureAppls" transition="updateExampleFeatureAppl" list="exampleFeatureApplList" paginate="true"><auto-fields-service service-name="update#moqui.example.ExampleFeatureAppl"/><field name="exampleId"><default-field><hidden/></default-field></field><field name="exampleFeatureId"><default-field title="Feature"><display-entity entity-name="ExampleFeature" text="${description}"/><link url="editExampleFeature" text="${exampleFeatureId}"/></default-field></field><field name="fromDate"><default-field><display/></default-field></field><field name="exampleFeatureApplEnumId"><default-field title="Type"><drop-down allow-empty="false"><list-options list="exampleFeatureApplEnumList" text="${description}"/></drop-down></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field name="deleteLink"><default-field title="Delete"><link url="deleteExampleFeatureAppl" text="Delete"/></default-field></field></form-list><form-single name="AddExampleFeatureAppl" transition="createExampleFeatureAppl"><auto-fields-service service-name="create#moqui.example.ExampleFeatureAppl"/><field name="exampleId"><default-field><hidden/></default-field></field><field name="exampleFeatureId"><default-field title="Feature"><drop-down allow-empty="false" combo-box="true"><list-options list="allExampleFeatureList" text="${description} [${exampleFeatureId}]"/></drop-down></default-field></field><field name="exampleFeatureApplEnumId"><default-field title="Type"><drop-down allow-empty="false"><list-options list="exampleFeatureApplEnumList" text="${description}"/></drop-down></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></widgets></screen>
<!-- Screen Location component://example/screen/ExampleApp/Example/EditExampleContent.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Content" default-menu-index="4"><parameter name="exampleId" required="true"/><transition name="createExampleContent"><service-call name="create#moqui.example.ExampleContent" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateExampleContent"><service-call name="update#moqui.example.ExampleContent" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteExampleContent"><service-call name="delete#moqui.example.ExampleContent" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="uploadExampleContent"><actions><script><![CDATA[import org.moqui.resource.ResourceReference
            org.moqui.context.ExecutionContext ec = context.ec

            org.apache.commons.fileupload.FileItem contentFile = context.contentFile
            String fileName = contentFile.getName()
            ec.logger.info("Uploading file [${fileName}] for Example [${exampleId}] in repository [${repositoryName}] with purpose [${purposeEnumId}] and locale [${locale}]")

            // String contentLocation = "content://${repositoryName}/moqui/example/${exampleId}/${fileName}"
            String contentLocation = "dbresource://moqui/example/${exampleId}/${fileName}"
            ResourceReference newRr = ec.resource.getLocationReference(contentLocation)
            InputStream fileStream = contentFile.getInputStream()
            newRr.putStream(fileStream)
            fileStream.close()

            ec.service.sync().name("create", "ExampleContent").parameters([exampleId: exampleId,
                    contentLocation: contentLocation, purposeEnumId: purposeEnumId, locale: locale]).call()]]></script></actions><default-response url="."/></transition><transition name="downloadContent" read-only="true"><actions><entity-find-one entity-name="ExampleContent" value-field="exampleContent"/><script><![CDATA[ec.web.sendResourceResponse(exampleContent.contentLocation)]]></script></actions><default-response type="none"/></transition><actions><entity-find entity-name="ExampleContent" list="exampleContentList"><econdition field-name="exampleId" from="exampleId"/><order-by field-name="contentLocation"/></entity-find></actions><widgets><container><container-dialog id="AddContentDialog" button-text="Add Content"><form-single name="AddExampleContent" transition="createExampleContent"><auto-fields-service service-name="create#moqui.example.ExampleContent"/><field name="exampleId"><default-field><hidden/></default-field></field><field name="contentLocation"><default-field><text-line size="60"/></default-field></field><field name="purposeEnumId"><default-field title="Purpose"><drop-down><entity-options><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="ExampleContentPurpose"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="locale"><default-field><text-line size="6"/></default-field></field><field name="submitButton"><default-field title="Add"><submit confirmation="Really Add?"/></default-field></field></form-single></container-dialog><container-dialog id="UploadContentDialog" button-text="Upload Content"><form-single name="UploadExampleContent" transition="uploadExampleContent"><field name="exampleId"><default-field><hidden/></default-field></field><field name="contentFile"><default-field><file/></default-field></field><field name="purposeEnumId"><default-field title="Purpose"><drop-down><entity-options><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="ExampleContentPurpose"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="locale"><default-field><text-line size="6"/></default-field></field><field name="submitButton"><default-field title="Add"><submit confirmation="Really Add?"/></default-field></field></form-single></container-dialog></container><form-list name="ListExampleContent" transition="updateExampleContent" list="exampleContentList"><field name="download"><default-field><link url="downloadContent" text="Download" parameter-map="[exampleId:exampleId, contentLocation:contentLocation]"/></default-field></field><field name="exampleId"><default-field><hidden/></default-field></field><field name="contentLocation"><default-field title="Location"><display/></default-field></field><field name="purposeEnumId"><default-field title="Purpose"><drop-down><entity-options><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="ExampleContentPurpose"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="locale"><default-field><text-line size="6"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field name="deleteLink"><default-field title=" "><link url="deleteExampleContent" text="Delete" confirmation="Really Delete?"/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://example/screen/ExampleApp/Example/DynamicExampleItems.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Dynamic Items" default-menu-index="9" render-modes="js,vuet" server-static="js,vuet"><parameter name="exampleId"/><transition name="getExampleItemList" read-only="true"><parameter name="exampleId"/><actions><entity-find entity-name="moqui.example.ExampleItem" list="exampleItemList"><econdition field-name="exampleId"/></entity-find><script><![CDATA[ec.web.sendJsonResponse(exampleItemList)]]></script></actions><default-response type="none"/></transition><transition name="getAmountUomList" read-only="true"><parameter name="term"/><parameter name="pageIndex"/><actions><set field="pageIndex" from="pageIndex ?: 0"/><set field="pageSize" from="pageSize ?: 20"/><set field="term" from="term ?: ''"/><entity-find-one entity-name="moqui.basic.UomAndType" value-field="uomAndType"><field-map field-name="uomId" from="term"/></entity-find-one><if condition="uomAndType != null"><then><set field="uomList" from="[uomAndType]"/></then><else><entity-find entity-name="moqui.basic.UomAndType" list="uomList"><search-form-inputs default-order-by="typeDescription,description"/><econditions combine="or"><econdition field-name="description" operator="like" value="%${term}%" ignore-case="true"/><econdition field-name="abbreviation" operator="like" value="%${term}%" ignore-case="true"/></econditions><econdition field-name="uomTypeEnumId" operator="not-equals" value="UT_CURRENCY_MEASURE"/></entity-find></else></if><script><![CDATA[def outList = []
                for (uom in uomList) outList.add([value:uom.uomId, label:"${uom.typeDescription} - ${ec.resource.expand('UomNameTemplate','',uom)}".toString()])
                ec.web.sendJsonResponse([options:outList, pageSize:pageSize, count:(uomListCount?:uomList.size())])]]></script></actions><default-response type="none"/></transition><widgets><render-mode><text type="js" location="component://example/screen/ExampleApp/Example/DynamicExampleItems/ExampleItems.js"/><text type="vuet" location="component://example/screen/ExampleApp/Example/DynamicExampleItems/ExampleItems.vuet"/></render-mode></widgets></screen>
<!-- Screen Location component://example/screen/ExampleApp/Example/DynamicExampleItemsVue.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Dynamic Items Vue" default-menu-index="10" render-modes="vue,qvue" server-static="vue,qvue"><parameter name="exampleId"/><transition-include name="getExampleItemList" location="component://example/screen/ExampleApp/Example/DynamicExampleItems.xml"/><transition-include name="getAmountUomList" location="component://example/screen/ExampleApp/Example/DynamicExampleItems.xml"/><widgets><render-mode><text type="vue,qvue"><![CDATA[<template><div><p>NOTE: this is an example of a client rendered screen using Vue JS component from a .vue file</p><form @submit.prevent="addItem()"><fieldset class="form-horizontal"><div class="form-group"><label class="control-label col-sm-2" for="addDescription">Description</label><div class="col-sm-10"><input type="text" v-model="addDescription" name="addDescription" id="addDescription" size="40" class="form-control"></div></div><div class="form-group"><label class="control-label col-sm-2" for="addAmount">Amount</label><div class="col-sm-10"><input type="text" v-model="addAmount" name="addAmount" id="addAmount" size="10" class="form-control"></div></div><div class="form-group"><label class="control-label col-sm-2" for="addAmountUomId">UOM</label><div class="col-sm-10"><drop-down v-model="addAmountUomId" name="addAmountUomId" id="addAmountUomId" :server-search="true" :server-min-length="0"
                              options-url="/apps/example/Example/DynamicExampleItems/getAmountUomList"></drop-down></div></div><div class="form-group"><label class="control-label col-sm-2">&nbsp;</label><div class="col-sm-10"><button type="submit" class="btn btn-primary btn-sm">Add Item</button></div></div></fieldset></form><p>Add item with description {{addDescription}}, amount {{addAmount}}, UOM {{addAmountUomId}} </p><table class="table table-striped table-hover table-condensed"><thead><tr><th>Item</th><th>Description</th><th>Amount</th><th>UOM</th></tr></thead><tbody><tr v-for="(exampleItem, exampleItemIndex) in exampleItemList"><td>{{exampleItem.exampleItemSeqId}}</td><td>{{exampleItem.description}}</td><td>{{exampleItem.amount}}</td><td>{{exampleItem.amountUomId}}</td></tr></tbody></table></div></template><script>
module.exports = {
    data: function () { return {
        exampleId: null,
        exampleItemList: [],
        addDescription: null, addAmount: null, addAmountUomId: null
    } },
    methods: {
        addItem: function () {
            // TODO: ajax call to add item
            // TODO: ajax call to get fresh item list (for exampleItemSeqId and generally in case server changes any data we sent it, there is other data, etc)
            // NOTE: best ajax call would be submit data and get new list in response, single ajax call instead of two
            this.exampleItemList.push({ description:this.addDescription, amount:this.addAmount, amountUomId:this.addAmountUomId });
        }
    },
    watch: {
        addColumnDate:function () {console.log(this.addColumnDate);}
    },
    mounted: function () {
        this.exampleId = this.$root.currentParameters.exampleId;
        if (this.exampleId && this.exampleId.length) {
            var vm = this;
            $.ajax({ type:"GET", url:"/apps/example/Example/DynamicExampleItems/getExampleItemList",
                     data:{ exampleId:this.exampleId }, dataType:"json", headers:{ Accept:'application/json' },
                     error:moqui.handleAjaxError,
                     success: function(responseObj, status, jqXHR) { vm.exampleItemList = responseObj; }});
        }
    }
}
</script>]]></text></render-mode></widgets></screen>
<!-- Screen Location component://example/screen/ExampleApp/Example.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Example" default-menu-index="1"><macro-template type="vuet" location="component://example/template/screen-macro/ExampleScreenMacros.vuet.ftl"/><subscreens default-item="FindExample"/><widgets><subscreens-panel id="example-panel" type="tab"/></widgets></screen>
<!-- Screen Location component://example/screen/ExampleApp/Feature/FindExampleFeature.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="newExampleFeature"><default-response url="../EditExampleFeature"/></transition><transition name="findExampleFeature"><default-response url="."/></transition><transition name="editExampleFeature"><default-response url="../EditExampleFeature"/></transition><actions><entity-find entity-name="moqui.example.ExampleFeature" list="exampleFeatureList"><search-form-inputs default-order-by="description"/></entity-find></actions><widgets><container id="button-bar"><link url="newExampleFeature" text="New Feature" link-type="anchor-button"/></container><form-list name="ListExampleFeatures" list="exampleFeatureList"><field name="exampleFeatureId"><header-field show-order-by="true"><text-find size="10" hide-options="true"/></header-field><default-field><link url="editExampleFeature" text="${exampleFeatureId}"/></default-field></field><field name="description"><header-field show-order-by="true"><text-find hide-options="true"/></header-field><default-field><display/></default-field></field><field name="searchButton"><header-field title="Find"><submit/></header-field><default-field><display text=""/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://example/screen/ExampleApp/Feature/EditExampleFeature.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Feature" default-menu-index="1"><parameter name="exampleFeatureId"/><transition name="createExampleFeature"><service-call name="moqui.example.ExampleServices.create#ExampleFeature" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateExampleFeature"><service-call name="update#moqui.example.ExampleFeature" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><entity-find-one entity-name="moqui.example.ExampleFeature" value-field="fieldValues"/><entity-find entity-name="moqui.basic.Enumeration" list="featureSourceEnumList"><econdition field-name="enumTypeId" value="ExampleFeatureSource"/><order-by field-name="sequenceNum"/></entity-find></actions><widgets><section name="create"><condition><compare field="fieldValues" operator="empty"/></condition><widgets><form-single name="CreateExampleFeature" transition="createExampleFeature"><auto-fields-service service-name="moqui.example.ExampleServices.create#ExampleFeature"/><field name="exampleFeatureId"><conditional-field condition="exampleFeatureId"><display text="Not Found: [${exampleFeatureId}]" also-hidden="false"/></conditional-field></field><field name="featureSourceEnumId"><default-field title="Feature Source"><drop-down><list-options list="featureSourceEnumList" key="${enumId}" text="${description}"/></drop-down></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></widgets></section><section name="update"><condition><compare field="fieldValues" operator="not-empty"/></condition><widgets><form-single name="UpdateExampleFeature" extends="CreateExampleFeature" transition="updateExampleFeature"><field name="exampleFeatureId"><conditional-field condition="exampleFeatureId"><display/></conditional-field><default-field><display/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></widgets></section></widgets></screen>
<!-- Screen Location component://example/screen/ExampleApp/Feature/EditExampleFeatureExampleAppls.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Examples" default-menu-index="2"><parameter name="exampleFeatureId" required="true"/><transition name="editExample"><default-response url="../../Example/EditExample"/></transition><transition name="createExampleFeatureAppl"><service-call name="moqui.example.ExampleServices.create#ExampleFeatureAppl" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateExampleFeatureAppl"><service-call name="update#moqui.example.ExampleFeatureAppl" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteExampleFeatureAppl"><service-call name="delete#moqui.example.ExampleFeatureAppl" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="getExampleList"><actions><entity-find entity-name="Example" list="exampleList" limit="20"><econditions combine="or"><econdition field-name="exampleId" operator="like" value="%${term}%"/><econdition field-name="exampleName" operator="like" value="%${term}%" ignore-case="true"/></econditions><order-by field-name="^exampleName"/></entity-find><script><![CDATA[def outList = []
                for (def example in exampleList)
                    outList.add([value:example.exampleId, label:"${example.exampleName} [${example.exampleId}]".toString()])
                ec.web.sendJsonResponse(outList)]]></script></actions><default-response type="none"/></transition><actions><entity-find entity-name="moqui.example.ExampleFeatureAppl" list="exampleFeatureApplList"><econdition field-name="exampleFeatureId"/><order-by field-name="sequenceNum"/></entity-find><entity-find entity-name="moqui.basic.Enumeration" list="exampleFeatureApplEnumList"><econdition field-name="enumTypeId" value="ExampleFeatureAppl"/><order-by field-name="description"/></entity-find></actions><widgets><form-list name="ListExampleFeatureAppls" transition="updateExampleFeatureAppl" list="exampleFeatureApplList"><auto-fields-service service-name="update#ExampleFeatureAppl"/><field name="exampleId"><default-field title="Example"><display-entity entity-name="Example" text="${exampleName}"/><link url="editExample" text="${exampleId}"/></default-field></field><field name="exampleFeatureId"><default-field><hidden/></default-field></field><field name="fromDate"><default-field><display/></default-field></field><field name="exampleFeatureApplEnumId"><default-field title="Type"><drop-down allow-empty="false"><list-options list="exampleFeatureApplEnumList" text="${description}"/></drop-down></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field name="deleteLink"><default-field title=" "><link url="deleteExampleFeatureAppl" text="Delete"/></default-field></field></form-list><form-single name="AddExampleFeatureAppl" transition="createExampleFeatureAppl"><auto-fields-service service-name="create#ExampleFeatureAppl"/><field name="exampleId"><default-field title="Example" tooltip="test tooltip!"><drop-down><dynamic-options transition="getPersonList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="exampleFeatureId"><default-field><hidden/></default-field></field><field name="exampleFeatureApplEnumId"><default-field title="Type"><drop-down allow-empty="false"><list-options list="exampleFeatureApplEnumList" text="${description}"/></drop-down></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></widgets></screen>
<!-- Screen Location component://example/screen/ExampleApp/Feature.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Feature" default-menu-index="2"><subscreens default-item="FindExampleFeature"/><widgets><subscreens-panel id="feature-panel" type="tab" dynamic="false"/></widgets></screen>
<!-- Screen Location component://example/screen/ExampleApp/Survey/FindSurvey.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="createFormResponse"><service-call name="org.moqui.impl.ScreenServices.create#FormResponse" in-map="[formLocation:formLocation, formId:formId, responseMap:ec.web.parameters]" out-map="context" multi="parameter"/><default-response url="../EditSurvey"/></transition><transition name="editSurvey"><default-response url="../EditSurvey"/></transition><actions><set field="userId" from="ec.user.userId"/><entity-find entity-name="moqui.screen.form.FormResponse" list="responseList"><search-form-inputs default-order-by="-responseDate"/><econdition field-name="userId"/></entity-find></actions><widgets><container-dialog id="NewSurvey1Dialog" button-text="New Survey 1"><form-single name="NewSurvey1Form" transition="createFormResponse" extends="DbForm#ExampleSurvey1"><field name="formLocation"><default-field><hidden default-value="DbForm#ExampleSurvey1"/></default-field></field><field name="formId"><default-field><hidden default-value="ExampleSurvey1"/></default-field></field></form-single></container-dialog><container-dialog id="NewSurvey2Dialog" button-text="New Survey 2"><form-single name="NewSurvey2Form" transition="createFormResponse" extends="DbForm#ExampleSurvey2"><field name="formLocation"><default-field><hidden default-value="DbForm#ExampleSurvey2"/></default-field></field><field name="formId"><default-field><hidden default-value="ExampleSurvey2"/></default-field></field></form-single></container-dialog><form-list name="ResponseListForm" list="responseList"><field name="formResponseId"><default-field><link url="editSurvey" text="Edit ${formResponseId}" link-type="anchor"/></default-field></field><field name="formLocation"><header-field title="Form" show-order-by="case-insensitive"><text-find hide-options="true"/></header-field><default-field><display also-hidden="false"/></default-field></field><field name="responseDate"><header-field title="Date" show-order-by="true"><date-period/></header-field><default-field title=""><display/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://example/screen/ExampleApp/Survey/EditSurvey.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-index="1"><parameter name="formResponseId" required="true"/><transition name="updateFormResponse"><service-call name="org.moqui.impl.ScreenServices.update#FormResponse" in-map="[formResponseId:formResponseId, responseMap:ec.web.parameters]" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><set field="userId" from="ec.user.userId"/><service-call name="org.moqui.impl.ScreenServices.get#FormResponse" in-map="context" out-map="context"/></actions><widgets><form-single name="UpdateSurveyForm" transition="updateFormResponse" map="responseMap" extends="${formLocation}" dynamic="true"><field name="formResponseId"><default-field><hidden/></default-field></field></form-single></widgets></screen>
<!-- Screen Location component://example/screen/ExampleApp/Survey.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Survey" default-menu-index="3"><subscreens default-item="FindSurvey"/><widgets><subscreens-active/></widgets></screen>
<!-- Screen Location component://example/screen/ExampleApp.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" include-child-content="true" require-authentication="false" menu-image="fa fa-flash" menu-image-type="icon"><transition name="ExampleEntity" method="get" read-only="true"><path-parameter name="exampleId"/><actions><entity-find-one entity-name="moqui.example.Example" value-field="example"/><script><![CDATA[ec.web.sendJsonResponse(example)]]></script></actions><default-response type="none"/></transition><transition name="ExampleEntity" method="post"><service-call name="moqui.example.ExampleServices.createExample" in-map="ec.web.parameters" web-send-json-response="true" out-map="context" multi="parameter"/><default-response type="none"/></transition><transition name="ExampleEntity" method="put"><path-parameter name="exampleId"/><service-call name="moqui.example.ExampleServices.updateExample" in-map="ec.web.parameters" web-send-json-response="true" out-map="context" multi="parameter"/><default-response type="none"/></transition><transition name="ExampleEntity" method="delete"><path-parameter name="exampleId"/><service-call name="delete#moqui.example.Example" in-map="ec.web.parameters" web-send-json-response="true" out-map="context" multi="parameter"/><default-response type="none"/></transition><transition name="LoadAllData"><actions><script><![CDATA[import org.moqui.entity.EntityDataLoader
            import org.moqui.context.ExecutionContext
            import org.moqui.impl.context.ArtifactExecutionInfoImpl
            ExecutionContext ec = context.ec

            ec.artifactExecution.disableAuthz()
            ArtifactExecutionInfoImpl aei = new ArtifactExecutionInfoImpl("loadData", "AT_OTHER", "AUTHZA_ALL")
            ec.getArtifactExecution().push(aei, false)
            ec.getArtifactExecution().setAnonymousAuthorizedAll()
            boolean loggedInAnonymous = ec.getUser().loginAnonymousIfNoUser()

            // TODO: reject requests until this is done?
            // at least make sure there are no Enumeration records
            if (ec.getEntity().find("moqui.basic.Enumeration").useCache(false).count()) {
                String errMsg = "Not loading data, found Enumeration records so database isn't empty"
                ec.logger.info(errMsg)
                ec.message.addMessage(errMsg)
                return
            }

            // load all the data
            EntityDataLoader edl = ec.getEntity().makeDataLoader()

            startTime = System.currentTimeMillis()
            records = edl.load()
            totalSeconds = (System.currentTimeMillis() - startTime) / 1000

            ec.artifactExecution.pop(aei)
            if (loggedInAnonymous) ec.getUser().logoutAnonymousOnly()
            ec.artifactExecution.enableAuthz()

            ec.cache.clearAllCaches()]]></script><log level="info" message="Loaded [${records}] records in ${totalSeconds} seconds."/></actions><default-response url="."/></transition><transition name="localCamelExample"><service-call name="moqui.example.ExampleServices.localCamelExample" web-send-json-response="true" in-map="true" out-map="context" multi="parameter"/><default-response type="none"/></transition><subscreens default-item="Example"><subscreens-item name="ExamplePolicies" menu-index="4" menu-title="Policies"/><subscreens-item name="ExampleTerms" menu-index="5" menu-title="Terms"/><subscreens-item name="ExampleWiki" menu-index="6" menu-title="Wiki"/><subscreens-item name="ExampleMarkdown" menu-index="7" menu-title="Markdown"/></subscreens><widgets><subscreens-panel id="example-app" type="popup"/></widgets></screen>
<!-- Screen Location component://tools/screen/System/dashboard.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-index="1" menu-image="fa fa-dashboard" menu-image-type="icon"><transition name="threadList"><default-response url="../ThreadList"/></transition><transition name="reInitElasticFacade"><actions><script><![CDATA[ec.elastic.init()]]></script></actions><default-response url="."/></transition><actions><set field="smap" from="ec.factory.getStatusMap(true)"/><set field="loadPercent" from="(smap.Utilization.LoadPercent as BigDecimal).setScale(1, BigDecimal.ROUND_HALF_UP)"/><set field="heapPercent" from="(smap.Utilization.HeapPercent as BigDecimal).setScale(1, BigDecimal.ROUND_HALF_UP)"/><set field="diskPercent" from="(smap.Utilization.DiskPercent as BigDecimal).setScale(1, BigDecimal.ROUND_HALF_UP)"/><set field="componentInfoList" from="orderMapList(ec.factory.getComponentInfoList(), ['^name'])"/><set field="runtimeVersionMap" from="ec.factory.versionMap"/><set field="workerPool" from="ec.factory.workerPool"/><set field="jobWorkerPool" from="ec.service.jobWorkerPool"/><set field="esClientList" from="ec.elastic.getClientList()"/><set field="esServerInfoList" from="[]"/><iterate list="esClientList" entry="esClient"><script><![CDATA[try {
                    esServerInfo = esClient.getServerInfo()
                    if (esServerInfo) {
                        esServerInfo.clientClusterName = esClient.getClusterName()
                        esServerInfo.clusterLocation = esClient.getClusterLocation()
                        esServerInfoList.add(esServerInfo)
                    }
                } catch (Throwable t) {
                    ec.logger.error("Error getting info for Elastic Client", t)
                    esServerInfoList.add([clientClusterName:esClient.getClusterName(),
                        clusterLocation:esClient.getClusterLocation(), name:t.toString(), cluster_name:'ERROR'])
                }]]></script></iterate></actions><widgets><container-row><row-col md="6"><container-box id="ServerAdmin"><box-header title="Server Admin"/><box-body><link url="../Cache" text="Cache Mgmt"/><link url="../Instance" text="Instance Mgmt"/><link url="../Print/Printer" text="Printers"/><link url="../Print/PrintJob" text="Print Jobs"/><link url="../HazelcastInfo" text="Hazelcast"/><link url="../ServiceJob/Jobs" text="Service Jobs"/><link url="../ServiceJob/JobRuns" text="Job Runs"/></box-body></container-box><container-box id="Security"><box-header title="Security"/><box-body><link url="../Security/UserAccount" text="Users"/><link url="../Security/UserGroup" text="User Groups"/><link url="../Security/ArtifactGroup" text="Artifact Groups"/><link url="../Security/ActiveUsers" text="Active Users"/></box-body></container-box><container-box id="Usage"><box-header title="Usage"/><box-body><link url="../ArtifactHitSummary" text="Artifact Hit Summary"/><link url="../ArtifactHitBins" text="Artifact Hit Bins"/><link url="../AuditLog" text="Audit Log"/><link url="../Visit" text="Visits"/><link url="../LogViewer" text="Log Viewer"/></box-body></container-box></row-col><row-col md="6"><container-box id="DataDocumentsFeeds"><box-header title="Data Documents and Feeds"/><box-body><link url="../DataDocument/Search" text="Search"/><link url="../DataDocument/Export" text="Export"/><link url="../DataDocument/Index" text="Feed Index"/><link url="../DataDocument/Edit" text="Edit and Report Builder"/></box-body></container-box><container-box id="DataAdmin"><box-header title="Data Admin"/><box-body><link url="../Localization/Messages" text="L10n: Messages"/><link url="../Localization/EntityFields" text="L10n: Entity Fields"/><link url="../Resource" text="Resource Finder"/></box-body></container-box><container-box id="IntegrationAdmin"><box-header title="Integration Admin"/><box-body><link url="../SystemMessage/Message" text="System Messages"/><link url="../SystemMessage/Remote" text="Message Remotes"/><link url="../SystemMessage/Type" text="Message Types"/><link url="../EntitySync" text="Entity Data Sync"/></box-body></container-box></row-col></container-row><container-box id="SystemInformation"><box-header title="System Information"/><box-toolbar><container-dialog id="RequestHeaders" button-text="Request Details"><label text="${ec.web.getRequestDetails()}" type="pre"/></container-dialog><link url="reInitElasticFacade" text="Re-Init Elastic" confirmation="Try again to initialize configured Elastic Search Clients?"/><link url="threadList" text="Thread List"/></box-toolbar><box-body><container-row><row-col sm="4"><label text="Uptime: ${ec.l10n.format(smap.JavaRuntime.UptimeHours, '#,##0.00')} hours" type="strong"/></row-col><row-col sm="4"><label text="Locale: ${Locale.getDefault()}" type="strong"/></row-col><row-col sm="4"><label text="Time: ${ec.l10n.format(ec.user.nowTimestamp, null, null, TimeZone.getDefault())} ${TimeZone.getDefault().getID()} GMT${ec.l10n.format(TimeZone.getDefault().getRawOffset()/(1000*60*60), '+00.0;-00.0')} DST ${TimeZone.getDefault().getDSTSavings()/(1000*60*60)}" type="strong"/></row-col></container-row><container-row><row-col md="4"><container-row><row-col xs="5"><label text="Heap Memory" type="strong"/></row-col><row-col xs="7"><label text="Heap: ${ec.l10n.format(heapPercent, '00.0')}%" style="${heapPercent < 70 ? 'text-success' : (heapPercent < 90 ? 'text-warn' : 'text-danger' )}"/></row-col></container-row><container-row><row-col xs="1"/><row-col xs="4"><label text="Used" type="strong"/></row-col><row-col xs="7"><label text="${ec.l10n.format(smap.Heap.Used, '#,##0.00')} MiB"/></row-col></container-row><container-row><row-col xs="1"/><row-col xs="4"><label text="Committed" type="strong"/></row-col><row-col xs="7"><label text="${ec.l10n.format(smap.Heap.Committed, '#,##0.00')} MiB"/></row-col></container-row><container-row><row-col xs="1"/><row-col xs="4"><label text="Max" type="strong"/></row-col><row-col xs="7"><label text="${ec.l10n.format(smap.Heap.Max, '#,##0.00')} MiB"/></row-col></container-row><label text="Non-Heap Memory" type="strong"/><container-row><row-col xs="1"/><row-col xs="4"><label text="Used" type="strong"/></row-col><row-col xs="7"><label text="${ec.l10n.format(smap.NonHeap.Used, '#,##0.00')} MiB"/></row-col></container-row><container-row><row-col xs="1"/><row-col xs="4"><label text="Committed" type="strong"/></row-col><row-col xs="7"><label text="${ec.l10n.format(smap.NonHeap.Committed, '#,##0.00')} MiB"/></row-col></container-row><container-row><row-col xs="5"><label text="Disk (runtime)" type="strong"/></row-col><row-col xs="7"><label text="Disk: ${ec.l10n.format(diskPercent, '00.0')}%" style="${diskPercent < 70 ? 'text-success' : (diskPercent < 90 ? 'text-warn' : 'text-danger' )}"/></row-col></container-row><container-row><row-col xs="1"/><row-col xs="4"><label text="Usable" type="strong"/></row-col><row-col xs="7"><label text="${ec.l10n.format(smap.Disk.Usable, '#,##0.00')} MiB"/></row-col></container-row><container-row><row-col xs="1"/><row-col xs="4"><label text="Total" type="strong"/></row-col><row-col xs="7"><label text="${ec.l10n.format(smap.Disk.Total, '#,##0.00')} MiB"/></row-col></container-row></row-col><row-col md="4"><container-row><row-col xs="5"><label text="System" type="strong"/></row-col><row-col xs="7"><label text="Load: ${ec.l10n.format(loadPercent, '00.0')}%" style="${loadPercent < 70 ? 'text-success' : (loadPercent < 90 ? 'text-warn' : 'text-danger' )}"/></row-col></container-row><container-row><row-col xs="1"/><row-col xs="4"><label text="Load" type="strong"/></row-col><row-col xs="7"><label text="${ec.l10n.format(smap.System.Load, '#,##0.00')} (avg last minute)"/></row-col></container-row><container-row><row-col xs="1"/><row-col xs="4"><label text="CPU" type="strong"/></row-col><row-col xs="7"><label text="${smap.System.CPU} (${smap.System.Processors} threads)"/></row-col></container-row><container-row><row-col xs="1"/><row-col xs="4"><label text="OS" type="strong"/></row-col><row-col xs="7"><label text="${smap.System.OsName} ${smap.System.OsVersion}"/></row-col></container-row><label text="Java Runtime" type="strong"/><container-row><row-col xs="1"/><row-col xs="4"><label text="Version" type="strong"/></row-col><row-col xs="7"><label text="${smap.JavaRuntime.SpecVersion} (${smap.JavaRuntime.VmVendor} ${smap.JavaRuntime.VmVersion})"/></row-col></container-row><container-row><row-col xs="1"/><row-col xs="4"><label text="Start" type="strong"/></row-col><row-col xs="7"><label text="${smap.JavaRuntime.Start}"/></row-col></container-row><container-row><row-col xs="1"/><row-col xs="4"><label text="Uptime" type="strong"/></row-col><row-col xs="7"><label text="${ec.l10n.format(smap.JavaRuntime.UptimeHours, '#,##0.00')} hours"/></row-col></container-row><label text="Moqui Framework" type="strong"/><container-row><row-col xs="1"/><row-col xs="4"><label text="Version" type="strong"/></row-col><row-col xs="7"><label text="${ec.factory.moquiVersion}"/></row-col></container-row></row-col><row-col md="4"><label text="Web Server" type="strong"/><container-row><row-col xs="1"/><row-col xs="4"><label text="Local IP" type="strong"/></row-col><row-col xs="7"><label text="${smap.Web.LocalAddr}:${smap.Web.LocalPort}"/></row-col></container-row><container-row><row-col xs="1"/><row-col xs="4"><label text="Local Name" type="strong"/></row-col><row-col xs="7"><label text="${smap.Web.LocalName}"/></row-col></container-row><container-row><row-col xs="1"/><row-col xs="4"><label text="Requested" type="strong"/></row-col><row-col xs="7"><label text="${smap.Web.ServerName}:${smap.Web.ServerPort}"/></row-col></container-row><label text="Java Statistics" type="strong"/><container-row><row-col xs="1"/><row-col xs="4"><label text="GC" type="strong"/></row-col><row-col xs="7"><label text="${smap.JavaStats.GcCount}, ${ec.l10n.format(smap.JavaStats.GcTimeSeconds, '#,##0.00')}s total"/></row-col></container-row><container-row><row-col xs="1"/><row-col xs="4"><label text="Compile Time" type="strong"/></row-col><row-col xs="7"><label text="${ec.l10n.format(smap.JavaStats.CompileTimeSeconds, '#,##0.00')}s total"/></row-col></container-row><container-row><row-col xs="1"/><row-col xs="4"><label text="Loaded Classes" type="strong"/></row-col><row-col xs="7"><label text="${smap.JavaStats.ClassesLoaded} (${smap.JavaStats.ClassesTotalLoaded} tot, ${smap.JavaStats.ClassesUnloaded} unl)"/></row-col></container-row><container-row><row-col xs="1"/><row-col xs="4"><label text="Threads" type="strong"/></row-col><row-col xs="7"><label text="${smap.JavaStats.ThreadCount} (${smap.JavaStats.PeakThreadCount} peak)"/></row-col></container-row><label text="Worker Pool" type="strong"/><container-row><row-col xs="1"/><row-col xs="4"><label text="Threads" type="strong"/></row-col><row-col xs="7"><label text="Active: ${workerPool.getActiveCount()} Cur: ${workerPool.getPoolSize()} Max: ${workerPool.getMaximumPoolSize()}" style="${workerPool.getActiveCount() == workerPool.getMaximumPoolSize() ? 'text-warning' : ''}"/></row-col></container-row><container-row><row-col xs="1"/><row-col xs="4"><label text="Queue" type="strong"/></row-col><row-col xs="7"><label text="Cur: ${workerPool.queue.size()} Rem: ${workerPool.queue.remainingCapacity()}" style="${workerPool.queue.remainingCapacity() == 0 ? 'text-danger' : (workerPool.queue.size() > workerPool.queue.remainingCapacity() ? 'text-warning' : '')}"/></row-col></container-row><label text="Service Job Pool" type="strong"/><container-row><row-col xs="1"/><row-col xs="4"><label text="Threads" type="strong"/></row-col><row-col xs="7"><label text="Active: ${jobWorkerPool.getActiveCount()} Cur: ${jobWorkerPool.getPoolSize()} Max: ${jobWorkerPool.getMaximumPoolSize()}" style="${jobWorkerPool.getActiveCount() == jobWorkerPool.getMaximumPoolSize() ? 'text-warning' : ''}"/></row-col></container-row><container-row><row-col xs="1"/><row-col xs="4"><label text="Queue" type="strong"/></row-col><row-col xs="7"><label text="Cur: ${jobWorkerPool.queue.size()} Rem: ${jobWorkerPool.queue.remainingCapacity()}" style="${jobWorkerPool.queue.remainingCapacity() == 0 ? 'text-danger' : (jobWorkerPool.queue.size() > jobWorkerPool.queue.remainingCapacity() ? 'text-warning' : '')}"/></row-col></container-row></row-col></container-row></box-body><box-body-nopad><form-list name="DatasourceList" list="smap.DataSources" skip-form="true"><field name="group"><default-field title="Entity Group"><display/></default-field></field><field name="uniqueName"><default-field><display/></default-field></field><field name="database"><default-field><display/></default-field></field><field name="detail"><default-field><display/></default-field></field></form-list><form-list name="EsServerInfoList" list="esServerInfoList" skip-form="true"><field name="clientClusterName"><default-field title="Elastic Facade Cluster"><display/></default-field></field><field name="clusterLocation"><default-field title="Location"><display/></default-field></field><field name="esVersion" from="version?.number"><default-field title="ES Version"><display/></default-field></field><field name="name"><default-field title="ES Name"><display/></default-field></field><field name="cluster_name"><default-field title="ES Cluster"><display/></default-field></field><field name="esFlavor" from="version?.build_flavor"><default-field title="ES Flavor"><display/></default-field></field><field name="esMinWireCompat" from="version?.minimum_wire_compatibility_version"><default-field title="Wire Compat"><display/></default-field></field><field name="esMinIndexCompat" from="version?.minimum_index_compatibility_version"><default-field title="Index Compat"><display/></default-field></field></form-list><label text="Framework: ${runtimeVersionMap.framework.toString()}" condition="runtimeVersionMap?.framework" type="div"/><label text="Runtime: ${runtimeVersionMap.runtime.toString()}" condition="runtimeVersionMap?.runtime" type="div"/><form-list name="ComponentInfoList" list="componentInfoList" skip-form="true"><field name="name"><default-field title="Component Name"><display/></default-field></field><field name="version"><default-field><display/></default-field></field><field name="location"><default-field><display/></default-field></field><field name="versionMap"><default-field title="Version Detail"><display/></default-field></field><field name="dependsOnNames"><default-field><display/></default-field></field><form-list-column><field-ref name="name"/><field-ref name="version"/></form-list-column><form-list-column><field-ref name="location"/><field-ref name="versionMap"/></form-list-column><form-list-column><field-ref name="dependsOnNames"/></form-list-column></form-list></box-body-nopad></container-box></widgets></screen>
<!-- Screen Location component://tools/screen/System/ArtifactHitSummary.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Artifact Summary" default-menu-index="2"><transition name="ArtifactHitSummaryStats.csv"><default-response url="."><parameter name="renderMode" value="csv"/><parameter name="pageNoLimit" value="true"/><parameter name="lastStandalone" value="true"/><parameter name="saveFilename" value="ArtifactHitSummaryStats.csv"/></default-response></transition><transition name="ArtifactHitSummaryStats.xml"><default-response url="."><parameter name="renderMode" value="xml"/><parameter name="pageNoLimit" value="true"/><parameter name="lastStandalone" value="true"/><parameter name="saveFilename" value="ArtifactHitSummaryStats.xml"/></default-response></transition><transition name="ArtifactHitSummaryStats.pdf"><default-response url="${ec.web.getWebappRootUrl(false, null)}/fop/apps/system/ArtifactHitSummary" url-type="plain"><parameter name="pageNoLimit" value="true"/><parameter name="layoutMaster" value="tabloid-landscape"/><parameter name="filename" value="ArtifactHitSummaryStats.pdf"/></default-response></transition><widgets><container><link url="ArtifactHitSummaryStats.xml" text="Get as XML"/></container><form-list name="ArtifactHitSummaryList" list="artifactHitReportList" skip-form="true" show-csv-button="true" show-xlsx-button="true" show-text-button="true" show-pdf-button="true" header-dialog="true" saved-finds="true" select-columns="true"><entity-find entity-name="moqui.server.ArtifactHitReport" list="artifactHitReportList" limit="50" use-clone="true"><search-form-inputs default-order-by="artifactType,artifactName" require-parameters="true"/><select-field field-name="totalSquaredTime"/></entity-find><row-actions><set field="averageTime" from="hitCount ? totalTimeMillis/hitCount : null"/><set field="stdDev" from="totalSquaredTime && hitCount > 1 ? Math.sqrt((totalSquaredTime - ((totalTimeMillis*totalTimeMillis) / hitCount)).abs() / (hitCount - 1)) : null"/></row-actions><field name="artifactType" print-width="20"><header-field show-order-by="true"><drop-down allow-empty="true"><option key="AT_XML_SCREEN"/><option key="AT_XML_SCREEN_CONTENT"/><option key="AT_XML_SCREEN_TRANS"/><option key="AT_SERVICE"/><option key="AT_ENTITY"/></drop-down></header-field><default-field><display/></default-field></field><field name="artifactSubType" print-width="20"><header-field show-order-by="true"><drop-down allow-empty="true"><option key="one"/><option key="list"/><option key="iterator"/><option key="count"/><option key="create"/><option key="update"/><option key="delete"/><option key="refresh"/><option key="entity-auto"/><option key="entity-implicit"/><option key="inline"/><option key="script"/><option key="java"/></drop-down></header-field><default-field><display/></default-field></field><field name="artifactName" print-width="60"><header-field show-order-by="true"><text-find hide-options="true" size="80"/></header-field><default-field><display/></default-field></field><field name="lastHitDateTime" print-width="13" print-width-type="characters"><header-field title="Last Hit" show-order-by="true"/><default-field><display text-format="yyyyMMdd HHmm"/></default-field></field><field name="hitCount" print-width="9" print-width-type="characters" align="right"><header-field title="Hits" show-order-by="true"/><default-field><display format="#,##0" text-format="0"/></default-field></field><field name="totalTimeMillis" print-width="8" print-width-type="characters" align="right"><header-field title="Total" show-order-by="true"/><default-field><display format="#,##0.000" text-format="0"/></default-field></field><field name="minTimeMillis" print-width="8" print-width-type="characters" align="right"><header-field title="Min" show-order-by="true"/><default-field><display format="#,##0.000" text-format="0.00"/></default-field></field><field name="maxTimeMillis" print-width="8" print-width-type="characters" align="right"><header-field title="Max" show-order-by="true"/><default-field><display format="#,##0.000" text-format="0.00"/></default-field></field><field name="averageTime" print-width="8" print-width-type="characters" align="right"><default-field title="Avg"><display format="#,##0.000" text-format="0.00"/></default-field></field><field name="stdDev" print-width="8" print-width-type="characters" align="right"><default-field title="Std Dev"><display format="#,##0.000" text-format="0.00"/></default-field></field><field name="slowHitCount" print-width="5" print-width-type="characters" align="right"><header-field title="Slow Hits" show-order-by="true"/><default-field><display format="#,##0" text-format="0"/></default-field></field><field name="find" print-width="0"><header-field title="Find"><submit/></header-field><default-field><display text=" "/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://tools/screen/System/ArtifactHitBins.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Artifact Bins" default-menu-index="3"><transition name="ArtifactHitBinStats.csv"><default-response url="."><parameter name="renderMode" value="csv"/><parameter name="pageNoLimit" value="true"/><parameter name="lastStandalone" value="true"/></default-response></transition><transition name="ArtifactHitBinStats.xml"><default-response url="."><parameter name="renderMode" value="xml"/><parameter name="pageNoLimit" value="true"/><parameter name="lastStandalone" value="true"/></default-response></transition><transition name="ArtifactHitBinStats.pdf"><default-response url="${ec.web.getWebappRootUrl(false, null)}/fop/apps/system/ArtifactHitBins" url-type="plain"><parameter name="renderMode" value="xsl-fo"/><parameter name="pageNoLimit" value="true"/></default-response></transition><widgets><container><link url="ArtifactHitBinStats.csv" text="Get as CSV"/><link url="ArtifactHitBinStats.xml" text="Get as XML" target-window="_blank"/><link url="ArtifactHitBinStats.pdf" text="Get as PDF" target-window="_blank"/></container><form-list name="ArtifactHitBins" list="artifactHitBinList" skip-form="true" header-dialog="true" saved-finds="true"><entity-find entity-name="moqui.server.ArtifactHitBin" list="artifactHitBinList" limit="50" use-clone="true"><search-form-inputs default-order-by="-binStartDateTime" require-parameters="true"/></entity-find><row-actions><set field="averageTime" from="hitCount ? totalTimeMillis/hitCount : null"/><set field="stdDev" from="totalSquaredTime && hitCount > 1 ? Math.sqrt((totalSquaredTime - ((totalTimeMillis*totalTimeMillis) / hitCount)).abs() / (hitCount - 1)) : null"/></row-actions><field name="artifactType"><header-field show-order-by="true"><drop-down allow-empty="true"><option key="AT_XML_SCREEN"/><option key="AT_XML_SCREEN_CONTENT"/><option key="AT_XML_SCREEN_TRANS"/><option key="AT_SERVICE"/><option key="AT_ENTITY"/></drop-down></header-field><default-field><display/></default-field></field><field name="artifactSubType"><header-field show-order-by="true"><drop-down allow-empty="true"><option key="one"/><option key="list"/><option key="iterator"/><option key="count"/><option key="create"/><option key="update"/><option key="delete"/><option key="refresh"/><option key="entity-auto"/><option key="entity-implicit"/><option key="inline"/><option key="script"/><option key="java"/></drop-down></header-field><default-field><display text="${artifactSubType}"/></default-field></field><field name="artifactName"><header-field show-order-by="true"><text-find hide-options="true" size="80"/></header-field><default-field><display text="${artifactName}"/></default-field></field><field name="binStartDateTime"><header-field title="Bin Start" show-order-by="true"><date-period allow-empty="true"/></header-field><default-field><display/></default-field></field><field name="totalTimeMillis"><header-field title="Total" show-order-by="true"/><default-field><display/></default-field></field><field name="minTimeMillis"><header-field title="Min" show-order-by="true"/><default-field><display/></default-field></field><field name="maxTimeMillis"><header-field title="Max" show-order-by="true"/><default-field><display/></default-field></field><field name="averageTime"><default-field title="Avg"><display/></default-field></field><field name="stdDev"><default-field title="Std Dev"><display/></default-field></field><field name="hitCount"><header-field title="Hits" show-order-by="true"/><default-field><display/></default-field></field><field name="slowHitCount"><header-field title="Slow Hits" show-order-by="true"/><default-field><display/></default-field></field><field name="find"><header-field title="Find"><submit/></header-field><default-field><display text=" "/></default-field></field><form-list-column><field-ref name="artifactType"/><field-ref name="artifactSubType"/></form-list-column><form-list-column><field-ref name="artifactName"/><field-ref name="binStartDateTime"/></form-list-column><form-list-column><field-ref name="totalTimeMillis"/></form-list-column><form-list-column><field-ref name="minTimeMillis"/><field-ref name="maxTimeMillis"/></form-list-column><form-list-column><field-ref name="averageTime"/><field-ref name="stdDev"/></form-list-column><form-list-column><field-ref name="hitCount"/><field-ref name="slowHitCount"/></form-list-column><form-list-column><field-ref name="find"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://tools/screen/System/AuditLog.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Audit Log" default-menu-index="4"><widgets><form-list name="EntityAuditLogList" list="entityAuditLogList" header-dialog="true"><entity-find entity-name="moqui.entity.EntityAuditLog" list="entityAuditLogList" limit="50" use-clone="true"><search-form-inputs default-order-by="-changedDate" require-parameters="true"/></entity-find><field name="changedDate"><header-field title="Date" show-order-by="true"><date-period time="true"/></header-field><default-field><display also-hidden="false"/></default-field></field><field name="changedEntityName"><header-field title="Entity" show-order-by="true"><text-find size="80" default-operator="equals"/></header-field><default-field><display also-hidden="false"/></default-field></field><field name="changedFieldName"><header-field title="Field" show-order-by="true"><text-find size="30" default-operator="equals"/></header-field><default-field><display also-hidden="false"/></default-field></field><field name="pkPrimaryValue"><header-field title="PK 1" show-order-by="true"><text-find size="30" default-operator="equals"/></header-field><default-field><display also-hidden="false"/></default-field></field><field name="pkSecondaryValue"><header-field title="PK 2"><text-find size="30" default-operator="equals"/></header-field><default-field><display also-hidden="false"/></default-field></field><field name="oldValueText"><header-field title="Old" show-order-by="true"><text-find size="60" default-operator="begins"/></header-field><default-field><display also-hidden="false"/></default-field></field><field name="newValueText"><header-field title="New" show-order-by="true"><text-find size="60" default-operator="begins"/></header-field><default-field><display also-hidden="false"/></default-field></field><field name="changedByUserId"><header-field title="User" show-order-by="true"><text-find size="20" default-operator="begins"/></header-field><default-field><display also-hidden="false"/></default-field></field><field name="changedInVisitId"><header-field title="Visit" show-order-by="true"><text-find size="20" default-operator="begins"/></header-field><default-field><display also-hidden="false"/></default-field></field><field name="find"><header-field title="Find"><submit/></header-field><default-field><display text=" "/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://tools/screen/System/Cache/CacheElements.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd"><parameter name="cacheName" required="true"/><transition name="clearCacheElement"><actions><script><![CDATA[ec.logger.info("Clearing cache entry with key ${key} from cache ${cacheName}")
                javax.cache.Cache theCache = ec.cache.getCache(cacheName)
                Iterator iter = theCache.iterator()
                while (iter.hasNext()) {
                    javax.cache.Cache.Entry entry = iter.next()
                    if (key == (entry.key as String)) {
                        cacheValue = theCache.getAndRemove(entry.key)
                        ec.message.addMessage(ec.resource.expand('Cleared ${key} from cache [${cacheName}] had value [${cacheValue}]',''))
                        return
                    }
                }
                ec.message.addError(ec.resource.expand('No entry with key [${key}] in cache [${cacheName}]',''))]]></script></actions><default-response url="."/></transition><actions><if condition="!ec.cache.cacheExists(cacheName)"><return error="true" message="Cache with name ${cacheName} not found"/></if><set field="pageSize" from="pageSize ?: 40"/><set field="cacheElementList" from="ec.cache.makeElementInfoList(cacheName, orderByField?:'+key')"/><script><![CDATA[paginateList("cacheElementList", null, context)]]></script></actions><widgets><label text="Elements for Cache [${cacheName}]" type="h3"/><label text="${totalSize > displayLimit ? totalSize + ' elements, displaying first ' + displayLimit : ''}" display-if-empty="false"/><form-list name="CacheElements" list="cacheElementList" skip-form="true"><field name="key"><header-field show-order-by="true"/><default-field><display also-hidden="false"/></default-field></field><field name="value"><default-field><display text="${value != null && value.length() > 200 ? value.substring(0, 200) : value}" also-hidden="false"/></default-field></field><field name="hitCount"><header-field title="Hits" show-order-by="true"/><default-field><display also-hidden="false"/></default-field></field><field name="creationTime"><header-field title="Created" show-order-by="true"/><default-field><display also-hidden="false"/></default-field></field><field name="lastUpdateTime"><header-field title="Last Update" show-order-by="true"/><default-field><display also-hidden="false"/></default-field></field><field name="lastAccessTime"><header-field title="Last Access" show-order-by="true"/><default-field><display also-hidden="false"/></default-field></field><field name="clear"><default-field><link text="Clear" url="clearCacheElement" link-type="hidden-form-link"><parameter name="key"/></link></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://tools/screen/System/Cache/CacheList.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd"><transition name="clearCache"><actions><script><![CDATA[ec.cache.getCache(cacheName).clear()]]></script></actions><default-response url="."/></transition><transition name="clearArtifactCaches"><actions><script><![CDATA[['entity.definition', 'entity.location', 'entity.data.feed.info', 'service.location',
            'kie.component.releaseId', 'kie.session.component', 'screen.location', 'screen.location.perm', 'screen.url',
            'screen.template.mode', 'screen.template.location', 'screen.find.path',
            'resource.xml-actions.location', 'resource.groovy.location',
            'resource.ftl.location', 'resource.gstring.location',
            'resource.wiki.location', 'resource.markdown.location', 'resource.text.location', 'resource.text.location',
            'resource.reference.location', 'l10n.message'].each {
                cacheName -> if (ec.cache.cacheExists(cacheName)) ec.cache.getCache(cacheName).clear()
            }

            ec.ecfi.warmCache()]]></script></actions><default-response url="."/></transition><transition name="clearAllCaches"><actions><script><![CDATA[ec.cache.clearAllCaches()]]></script></actions><default-response url="."/></transition><transition name="cacheElements"><default-response url="../CacheElements"/></transition><transition name="runGc"><actions><script><![CDATA[System.gc()]]></script></actions><default-response url="."/></transition><actions><set field="cacheList" from="ec.cache.getAllCachesInfo(orderByField?:'+name', filterRegexp)"/><set field="pageSize" from="pageSize ?: '40'"/><script><![CDATA[paginateList("cacheList", null, context)]]></script><set field="memoryMXBean" from="java.lang.management.ManagementFactory.getMemoryMXBean()"/><set field="heapMemoryUsage" from="memoryMXBean.getHeapMemoryUsage()"/><set field="nonHeapMemoryUsage" from="memoryMXBean.getNonHeapMemoryUsage()"/></actions><widgets><container-row><row-col lg="6" md="6"><label text="Heap Used: ${ec.l10n.format(heapMemoryUsage.getUsed()/(1024*1024), '#,##0.00')} MiB, Committed: ${ec.l10n.format(heapMemoryUsage.getCommitted()/(1024*1024), '#,##0.00')} MiB, Max: ${ec.l10n.format(heapMemoryUsage.getMax()/(1024*1024), '#,##0.00')} MiB"/></row-col><row-col lg="6" md="6"><label text="Non-Heap Used: ${ec.l10n.format(nonHeapMemoryUsage.getUsed()/(1024*1024), '#,##0.00')} MiB, Committed: ${ec.l10n.format(nonHeapMemoryUsage.getCommitted()/(1024*1024), '#,##0.00')} MiB"/></row-col></container-row><container-row><row-col lg="6" md="6"><link text="Clear All" url="clearAllCaches"/><link text="Clear All Artifact" url="clearArtifactCaches"/><link text="Run GC" url="runGc" btn-type="warning" confirmation="Run Java garbage collection? This may take some time and pause other running threads."/></row-col><row-col lg="6" md="6"><form-single name="FilterForm" transition="."><field name="filterRegexp"><default-field><text-line size="30"/></default-field></field><field name="submitButton"><default-field title="Filter"><submit/></default-field></field><field-layout><field-row-big><field-ref name="filterRegexp"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single></row-col></container-row><form-list name="CacheList" list="cacheList" skip-form="true"><field name="name"><header-field show-order-by="true"/><default-field><link text="${name}" url="cacheElements" link-type="anchor"><parameter name="cacheName" from="name"/></link></default-field></field><field name="size"><header-field show-order-by="true"/><default-field><display/></default-field></field><field name="putCount"><header-field title="Puts" show-order-by="true"/><default-field><display/></default-field></field><field name="hitCount"><header-field title="Hits" show-order-by="true"/><default-field><display/></default-field></field><field name="missCountTotal"><header-field title="Misses" show-order-by="true"/><default-field><display/></default-field></field><field name="removeCount"><header-field title="Removes" show-order-by="true"/><default-field><display/></default-field></field><field name="expireCount"><header-field title="Expires" show-order-by="true"/><default-field><display/></default-field></field><field name="evictionCount"><header-field title="Evicts" show-order-by="true"/><default-field><display/></default-field></field><field name="expireTimeIdle"><default-field title="Exp Idle"><display/></default-field></field><field name="expireTimeLive"><default-field title="Exp Live"><display/></default-field></field><field name="maxElements"><default-field title="Max (Evct)"><display text="${maxElements} (${evictionStrategy})"/></default-field></field><field name="clear"><default-field><link text="Clear" url="clearCache" link-type="hidden-form-link"><parameter name="cacheName" from="name"/></link></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://tools/screen/System/Cache.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Cache" default-menu-index="5"><subscreens default-item="CacheList"/><widgets><subscreens-active/></widgets></screen>
<!-- Screen Location component://tools/screen/System/DataDocument/ViewDocument.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="_index" required="true"/><parameter name="_id" required="true"/><actions><script><![CDATA[import groovy.json.JsonOutput
        import org.moqui.context.ExecutionContext

        ExecutionContext ec = context.ec
        def elasticClient = ec.factory.elastic.getDefault()
        sourceMap = elasticClient.get((String) _index, (String) _id)?._source
        documentString = JsonOutput.prettyPrint(elasticClient.objectToJson(sourceMap))
        flattenedDocumentMap = flattenNestedMap(sourceMap)]]></script></actions><widgets><label text="Flattened Map" type="h4"/><label text="${flattenedDocumentMap}" encode="true"/><label text="Document JSON" type="h4"/><label text="${documentString}" encode="true" type="pre" style="pre-plain"/><label text="Document Map" type="h4"/><section-iterate name="SourceMapSection" list="sourceMap.keySet()" entry="smKey"><widgets><label text="${smKey}: ${sourceMap.get(smKey)} (${sourceMap.get(smKey)?.class?.name})" type="div"/></widgets></section-iterate></widgets></screen>
<!-- Screen Location component://tools/screen/System/DataDocument/Search.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Search" default-menu-index="1"><transition name="viewDocument"><default-response url="../ViewDocument"/></transition><actions><if condition="queryString"><service-call name="org.moqui.search.SearchServices.search#DataDocuments" out-map="context" in-map="context + [flattenDocument:false]"/></if></actions><widgets><link url="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-query-string-query.html#query-string-syntax" url-type="plain" link-type="anchor" target-window="_blank" text="Search String Reference"/><form-single name="SearchOptions" transition="."><field name="indexName"><default-field title=""><drop-down><entity-options key="${indexName}" text="${indexName}"><entity-find entity-name="moqui.entity.document.DataDocument" distinct="true"><select-field field-name="indexName"/><order-by field-name="indexName"/></entity-find></entity-options></drop-down></default-field></field><field name="queryString"><default-field title=""><text-line size="100"/></default-field></field><field name="submitButton"><default-field title="Search"><submit/></default-field></field><field-layout><field-row-big><field-ref name="indexName"/><field-ref name="queryString"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single><form-list name="SearchResults" list="documentList" paginate="true" paginate-always-show="true"><row-actions><entity-find-one entity-name="DataDocument" value-field="dataDocument" cache="true"><field-map field-name="dataDocumentId" from="_type"/></entity-find-one><set field="documentTitle" from="ec.resource.expand(dataDocument?.documentTitle, '')"/><entity-find entity-name="moqui.entity.document.DataDocumentLink" list="ddLinkList" cache="true"><econdition field-name="dataDocumentId" from="_type"/></entity-find><set field="linksList" from="[]"/><iterate list="ddLinkList" entry="ddLink"><if condition="!ddLink.linkCondition || ec.resource.condition(ddLink.linkCondition, '')"><script><![CDATA[linksList.add(ddLink)]]></script></if></iterate></row-actions><field name="type"><default-field><display text="${dataDocument.documentName} [${_type}]"/></default-field></field><field name="id"><default-field><display text="${_id}"/></default-field></field><field name="documentTitle"><default-field title="Title"><display/></default-field></field><field name="link"><default-field><section-iterate name="LinksListSection" list="linksList" entry="ddLink"><widgets><link url="${ec.resource.expand(ddLink.linkUrl, null)}" text="${ec.resource.expand(ddLink.label, null)}" link-type="anchor" url-type="${ddLink.urlType?:'plain'}"/></widgets></section-iterate></default-field></field><field name="viewDocument"><default-field><dynamic-dialog id="ViewDocument" button-text="View Document" transition="viewDocument" width="800"><parameter name="_index"/><parameter name="_id"/></dynamic-dialog></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://tools/screen/System/DataDocument/Index.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Index" default-menu-index="2"><transition name="indexFeedDocuments"><actions><script><![CDATA[jobRunId = ec.service.job("IndexDataFeedDocuments").parameter("dataFeedId", dataFeedId).parameter("dataDocumentId", dataDocumentId)
                    .parameter("fromUpdateStamp", fromUpdateStamp).parameter("thruUpdateStamp", thruUpdateStamp).parameter("batchSize", batchSize).run()]]></script><message><![CDATA[Started Index DataFeed Documents Job (Job ID ${jobRunId})]]></message></actions><default-response url="."/></transition><widgets><form-single name="IndexOptions" transition="indexFeedDocuments"><field name="dataFeedId"><default-field title="Data Feed"><drop-down><entity-options key="${dataFeedId}" text="${feedName} [${dataFeedId}]"><entity-find entity-name="moqui.entity.feed.DataFeed"><order-by field-name="feedName"/></entity-find></entity-options></drop-down></default-field></field><field name="dataDocumentId"><default-field title="Data Document"><drop-down allow-empty="true"><entity-options key="${dataDocumentId}" text="${documentName} [${dataDocumentId}]"><entity-find entity-name="moqui.entity.document.DataDocument"><order-by field-name="documentName"/></entity-find></entity-options></drop-down></default-field></field><field name="fromUpdateStamp"><default-field><date-time type="timestamp"/></default-field></field><field name="thruUpdateStamp"><default-field><date-time type="timestamp"/></default-field></field><field name="batchSize"><default-field><text-line size="5" default-value="1000"/></default-field></field><field name="submitButton"><default-field title="Index Feed Documents"><submit/></default-field></field></form-single></widgets></screen>
<!-- Screen Location component://tools/screen/System/DataDocument/Export.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Export" default-menu-index="3"><transition name="DocumentExport.json" read-only="true"><actions><script><![CDATA[import org.moqui.context.ExecutionContext
            import org.moqui.impl.entity.EntityDataDocument

            import java.sql.Timestamp

            ExecutionContext ec = context.ec
            EntityDataDocument edd = ec.entity.getEntityDataDocument()

            if (!context.dataDocumentIds) {
                ec.message.addError(ec.l10n.localize("No Data Documents specified, not exporting anything."))
                return
            }

            List<String> dataDocumentIdList
            if (dataDocumentIds instanceof String) {
                dataDocumentIdList = [dataDocumentIds]
            } else {
                dataDocumentIdList = dataDocumentIds
            }
            boolean prettyPrint = context.prettyPrint as Boolean
            fromUpdateStamp = fromUpdateStamp ? fromUpdateStamp as Timestamp : null
            thruUpdateStamp = thruUpdateStamp ? thruUpdateStamp as Timestamp : null

            noResponse = false
            if (context.output == "file") {
                edd.writeDocumentsToFile((String) path, dataDocumentIdList, null,
                        fromUpdateStamp, thruUpdateStamp, prettyPrint)
            } else if (context.output == "dir") {
                edd.writeDocumentsToDirectory((String) path, dataDocumentIdList, null,
                        fromUpdateStamp, thruUpdateStamp, prettyPrint)
            } else {
                def response = ec.web.response
                response.setContentType("application/json")
                response.setCharacterEncoding("UTF-8")
                response.setHeader("Cache-Control", "no-cache, must-revalidate, private")
                response.getWriter().write("[\n")
                edd.writeDocumentsToWriter(response.getWriter(), dataDocumentIdList, null,
                        fromUpdateStamp, thruUpdateStamp, prettyPrint)
                response.getWriter().write("]\n")
                noResponse = true
            }]]></script></actions><conditional-response url="."><condition><expression><![CDATA[!noResponse]]></expression></condition></conditional-response><default-response type="none"/></transition><widgets><form-single name="ExportDocuments" transition="DocumentExport.json"><field name="dataDocumentIds"><default-field><drop-down allow-multiple="true" size="10"><entity-options key="${dataDocumentId}" text="${dataDocumentId} - ${documentName}"><entity-find entity-name="moqui.entity.document.DataDocument"><order-by field-name="dataDocumentId"/></entity-find></entity-options></drop-down></default-field></field><field name="fromUpdateStamp"><default-field><date-time/></default-field></field><field name="thruUpdateStamp"><default-field><date-time/></default-field></field><field name="prettyPrint"><default-field title=""><check><option key="true" text="Pretty Print JSON?"/></check></default-field></field><field name="path"><default-field><text-line size="80"/></default-field></field><field name="output"><default-field><radio no-current-selected-key="file"><option key="file" text="Single File"/><option key="dir" text="Directory (one file per document)"/><option key="browser" text="Out to Browser"/></radio></default-field></field><field name="submitButton"><default-field title="Export"><submit/></default-field></field></form-single></widgets></screen>
<!-- Screen Location component://tools/screen/System/DataDocument/Edit/FindDataDocument.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="editDataDocument"><default-response url="../EditDataDocument"/></transition><transition name="createDataDocument"><service-call name="org.moqui.impl.EntityServices.create#DataDocument" in-map="true" out-map="context" multi="parameter"/><default-response url="../EditDataDocument"/></transition><actions><set field="entityInfoList" from="ec.entity.getAllEntitiesInfo('entityName', null, false, true)"/><if condition="excludeFilter"><set field="entityInfoList" from="entityInfoList.findAll({ !it.fullEntityName.matches(excludeFilter) })"/></if></actions><widgets><container-dialog id="CreateDialog" button-text="Create Data Document"><form-single name="CreateDataDocument" transition="createDataDocument"><field name="dataDocumentId"><default-field title="ID"><text-line size="30"/></default-field></field><field name="documentName"><default-field title="Name"><text-line size="60"/></default-field></field><field name="primaryEntityName"><default-field title="Primary Entity"><drop-down><list-options list="entityInfoList" key="${fullEntityName}" text="${org.moqui.util.StringUtilities.camelCaseToPretty(entityName)}"/></drop-down></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="DataDocumentList" list="dataDocumentList" skip-form="true" header-dialog="true"><entity-find entity-name="moqui.entity.document.DataDocument"><search-form-inputs default-order-by="dataDocumentId"/></entity-find><field name="dataDocumentId"><header-field title="ID" show-order-by="true"><text-find hide-options="true"/></header-field><default-field><link url="editDataDocument" text="${dataDocumentId}" link-type="anchor"/></default-field></field><field name="documentName"><header-field title="Name" show-order-by="true"><text-find hide-options="true"/></header-field><default-field><link url="editDataDocument" text="${documentName}" link-type="anchor"/></default-field></field><field name="primaryEntityName"><header-field title="Primary Entity" show-order-by="true"><drop-down allow-empty="true"><entity-options key="${primaryEntityName}" text="${org.moqui.util.StringUtilities.camelCaseToPretty(primaryEntityName.substring(primaryEntityName.lastIndexOf('.')+1))}"><entity-find entity-name="moqui.entity.document.DataDocument" distinct="true"><select-field field-name="primaryEntityName"/><order-by field-name="primaryEntityName"/></entity-find></entity-options></drop-down></header-field><default-field><display text="${org.moqui.util.StringUtilities.camelCaseToPretty(primaryEntityName.substring(primaryEntityName.lastIndexOf('.')+1))}"/></default-field></field><field name="findButton"><header-field><submit/></header-field></field></form-list></widgets></screen>
<!-- Screen Location component://tools/screen/System/DataDocument/Edit/EditDataDocument.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Data Document" default-menu-index="1"><parameter name="dataDocumentId" required="true"/><transition name="updateDataDocument"><service-call name="update#moqui.entity.document.DataDocument" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="cloneDataDocument"><service-call name="org.moqui.impl.EntityServices.clone#DataDocument" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createDataDocumentUserGroup"><service-call name="create#moqui.entity.document.DataDocumentUserGroup" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteDataDocumentUserGroup"><service-call name="delete#moqui.entity.document.DataDocumentUserGroup" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createDataFeedDocument"><service-call name="create#moqui.entity.feed.DataFeedDocument" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteDataFeedDocument"><service-call name="delete#moqui.entity.feed.DataFeedDocument" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createDataDocumentLink"><service-call name="create#moqui.entity.document.DataDocumentLink" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateDataDocumentLink"><service-call name="update#moqui.entity.document.DataDocumentLink" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteDataDocumentLink"><service-call name="delete#moqui.entity.document.DataDocumentLink" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><entity-find-one entity-name="moqui.entity.document.DataDocument" value-field="dataDocument"/><set field="entityInfoList" from="ec.entity.getAllEntitiesInfo('entityName', null, false, true)"/><if condition="excludeFilter"><set field="entityInfoList" from="entityInfoList.findAll({ !it.fullEntityName.matches(excludeFilter) })"/></if></actions><widgets><container-row><row-col lg="5"><container-dialog id="CloneDialog" button-text="Clone"><form-single name="CloneDataDocument" transition="cloneDataDocument"><field name="dataDocumentId"><default-field><hidden/></default-field></field><field name="newDataDocumentId"><default-field title="New ID"><text-line size="30"/></default-field></field><field name="newIndexName"><default-field title="New Index"><text-line size="30"/></default-field></field><field name="copyConditions"><default-field><drop-down><option key="false"/><option key="true"/></drop-down></default-field></field><field name="copyLinks"><default-field><drop-down><option key="false"/><option key="true"/></drop-down></default-field></field><field name="submitButton"><default-field title="Clone"><submit/></default-field></field></form-single></container-dialog><form-single name="EditDataDocument" transition="updateDataDocument" map="dataDocument"><field name="dataDocumentId"><default-field title="ID"><display/></default-field></field><field name="documentName"><default-field title="Name"><text-line size="40"/></default-field></field><field name="primaryEntityName"><default-field title="Primary Entity"><drop-down><list-options list="entityInfoList" key="${fullEntityName}" text="${org.moqui.util.StringUtilities.camelCaseToPretty(entityName)}"/></drop-down></default-field></field><field name="documentTitle"><default-field title="Title"><text-line/></default-field></field><field name="indexName"><default-field><text-line size="30"/></default-field></field><field name="manualDataServiceName"><default-field title="Manual Data Service"><text-line/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></row-col><row-col lg="7"><container-box><box-header title="User Groups"/><box-toolbar><container-dialog id="AddGroupDialog" button-text="Add Group"><form-single name="AddUserGroup" transition="createDataDocumentUserGroup"><field name="dataDocumentId"><default-field><hidden/></default-field></field><field name="userGroupId"><default-field title="Group"><drop-down><entity-options key="${userGroupId}" text="UserGroupNameTemplate"><entity-find entity-name="moqui.security.UserGroup"><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body-nopad><form-list name="UserGroupList" list="ddugList" skip-form="true" skip-header="true"><entity-find entity-name="moqui.entity.document.DataDocumentUserGroup"><econdition field-name="dataDocumentId"/><order-by field-name="userGroupId"/></entity-find><field name="dataDocumentId"><default-field><hidden/></default-field></field><field name="userGroupId"><default-field title="Group"><display-entity entity-name="moqui.security.UserGroup"/></default-field></field><field name="deleteButton"><default-field title=""><link url="deleteDataDocumentUserGroup" text=" " icon="fa fa-trash" confirmation="Really remove?"/></default-field></field></form-list></box-body-nopad></container-box><container-box><box-header title="Data Feeds"/><box-toolbar><container-dialog id="AddFeedDialog" button-text="Add Feed"><form-single name="AddDataFeed" transition="createDataFeedDocument"><field name="dataDocumentId"><default-field><hidden/></default-field></field><field name="dataFeedId"><default-field title="Feed"><drop-down><entity-options key="${dataFeedId}" text="${dataFeedId}: ${feedName?:''}"><entity-find entity-name="moqui.entity.feed.DataFeed"><order-by field-name="feedName"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body-nopad><form-list name="DataFeedList" list="dfdList" skip-form="true" skip-header="true"><entity-find entity-name="moqui.entity.feed.DataFeedDocument"><econdition field-name="dataDocumentId"/><order-by field-name="dataFeedId"/></entity-find><field name="dataDocumentId"><default-field><hidden/></default-field></field><field name="dataFeedId"><default-field title="Feed"><display-entity entity-name="moqui.entity.feed.DataFeed" text="${dataFeedId}: ${feedName?:''}"/></default-field></field><field name="deleteButton"><default-field title=""><link url="deleteDataFeedDocument" text=" " icon="fa fa-trash" confirmation="Really remove?"/></default-field></field></form-list></box-body-nopad></container-box></row-col></container-row><container-box><box-header title="Links"/><box-toolbar><container-dialog id="AddLinkDialog" button-text="Add Link"><form-single name="AddLink" transition="createDataDocumentLink"><field name="dataDocumentId"><default-field><hidden/></default-field></field><field name="label"><default-field><text-line size="60"/></default-field></field><field name="linkUrl"><default-field title="URL"><text-line/></default-field></field><field name="urlType"><default-field title="Type"><drop-down><option key="plain"/><option key="screen"/></drop-down></default-field></field><field name="linkCondition"><default-field title="Condition"><text-line/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body-nopad><form-list name="LinkList" list="conditionList" transition="updateDataDocumentLink"><entity-find entity-name="moqui.entity.document.DataDocumentLink"><econdition field-name="dataDocumentId"/><order-by field-name="fieldNameAlias"/></entity-find><field name="dataDocumentId"><default-field><hidden/></default-field></field><field name="linkSeqId"><default-field><hidden/></default-field></field><field name="label"><default-field><text-line/></default-field></field><field name="linkUrl"><default-field title="URL"><text-line/></default-field></field><field name="urlType"><default-field title="Type"><drop-down><option key="plain"/><option key="screen"/></drop-down></default-field></field><field name="linkCondition"><default-field title="Condition"><text-line/></default-field></field><field name="submitButton"><default-field title="Upd"><submit/></default-field></field><field name="deleteButton"><default-field title=""><link url="deleteDataDocumentLink" text=" " icon="fa fa-trash" confirmation="Really remove?"/></default-field></field></form-list></box-body-nopad></container-box></widgets></screen>
<!-- Screen Location component://tools/screen/System/DataDocument/Edit/DataDocFields/FieldList.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="dataDocumentId" required="true" from="dataDocumentId ?: dataDocumentId_0"/><transition name="createDataDocumentCondition"><service-call name="create#moqui.entity.document.DataDocumentCondition" in-map="true" out-map="context" multi="parameter"/><default-response url=".."/></transition><transition name="updateDataDocumentCondition"><service-call name="update#moqui.entity.document.DataDocumentCondition" in-map="true" out-map="context" multi="parameter"/><default-response url=".."/></transition><transition name="deleteDataDocumentCondition"><service-call name="delete#moqui.entity.document.DataDocumentCondition" in-map="true" out-map="context" multi="parameter"/><default-response url=".."/></transition><transition name="createFieldDynamic" read-only="true"><service-call name="org.moqui.impl.EntityServices.create#DataDocumentField" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createDataDocumentField"><service-call name="org.moqui.impl.EntityServices.create#DataDocumentField" in-map="true" out-map="context" multi="parameter"/><default-response url=".."/></transition><transition name="updateDataDocumentField"><service-call name="org.moqui.impl.EntityServices.update#DataDocumentField" in-map="true" out-map="context" multi="parameter"/><default-response url=".."/></transition><transition name="deleteDataDocumentField"><service-call name="delete#moqui.entity.document.DataDocumentField" in-map="true" out-map="context" multi="parameter"/><default-response url=".."/></transition><actions><set field="opOptions" from="['equals', 'not-equals', 'less', 'greater', 'less-equals', 'greater-equals', 'in', 'not-in',             'between', 'not-between', 'like', 'not-like', 'is-null', 'is-not-null']"/><set field="funcOptions" from="['min', 'max', 'sum', 'avg', 'count', 'count-distinct', 'upper', 'lower']"/><set field="knownFields" from="new HashSet()"/><entity-find entity-name="moqui.entity.document.DataDocumentField" list="ddFieldList"><econdition field-name="dataDocumentId"/><order-by field-name="sequenceNum,fieldPath"/></entity-find><set field="fieldAliasSet" from="new LinkedHashSet()"/><iterate list="ddFieldList" entry="ddf"><script><![CDATA[fieldAliasSet.add(ddf.fieldNameAlias ?: (ddf.fieldPath.contains(':') ? ddf.fieldPath.substring(ddf.fieldPath.lastIndexOf(':')+1) : ddf.fieldPath))]]></script></iterate></actions><widgets><container-box><box-header title="Conditions"/><box-toolbar><container-dialog id="AddConditionDialog" button-text="Add Condition"><form-single name="AddCondition" transition="createDataDocumentCondition"><field name="dataDocumentId"><default-field><hidden/></default-field></field><field name="fieldNameAlias"><default-field title="Field"><drop-down><list-options list="fieldAliasSet" key="${entry}" text="${org.moqui.util.StringUtilities.camelCaseToPretty(entry)}"/></drop-down></default-field></field><field name="operator"><default-field title="Operator"><drop-down><list-options list="opOptions"/></drop-down></default-field></field><field name="fieldValue"><default-field title="Value"><text-line size="40"/></default-field></field><field name="toFieldNameAlias"><default-field title="To Field"><drop-down allow-empty="true"><list-options list="fieldAliasSet" key="${entry}" text="${org.moqui.util.StringUtilities.camelCaseToPretty(entry)}"/></drop-down></default-field></field><field name="postQuery"><default-field title="PQ"><drop-down><option key="N"/><option key="Y"/></drop-down></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body-nopad><form-list name="ConditionList" list="conditionList" transition="updateDataDocumentCondition"><entity-find entity-name="moqui.entity.document.DataDocumentCondition"><econdition field-name="dataDocumentId"/><order-by field-name="fieldNameAlias"/></entity-find><field name="dataDocumentId"><default-field><hidden/></default-field></field><field name="conditionSeqId"><default-field><hidden/></default-field></field><field name="fieldNameAlias"><default-field title="Field" container-style="${fieldAliasSet.contains(fieldNameAlias) ? 'text-success' : 'text-danger'}"><display text="${org.moqui.util.StringUtilities.camelCaseToPretty(fieldNameAlias)}"/></default-field></field><field name="operator"><default-field title="Operator"><drop-down><list-options list="opOptions"/></drop-down></default-field></field><field name="fieldValue"><default-field title="Value"><text-line size="20"/></default-field></field><field name="toFieldNameAlias"><default-field title="To Field" container-style="${fieldAliasSet.contains(toFieldNameAlias) ? 'text-success' : 'text-danger'}"><display text="${org.moqui.util.StringUtilities.camelCaseToPretty(toFieldNameAlias)}"/></default-field></field><field name="postQuery"><default-field title="PQ"><drop-down><option key="N"/><option key="Y"/></drop-down></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field name="deleteButton"><default-field title=""><link url="deleteDataDocumentCondition" text=" " icon="fa fa-trash" confirmation="Really remove?"><parameter name="dataDocumentId"/><parameter name="conditionSeqId"/><parameter name="fieldNameAlias"/></link></default-field></field></form-list></box-body-nopad></container-box><container-box><box-header title="Fields"/><box-toolbar><container-dialog id="AddFieldDialog" button-text="Add Field Manual"><form-single name="AddField" transition="createDataDocumentField"><field name="dataDocumentId"><default-field><hidden/></default-field></field><field name="fieldPath"><default-field><text-line/></default-field></field><field name="fieldNameAlias"><default-field title="Alias"><text-line size="20"/></default-field></field><field name="sortable"><default-field title="Sortable"><drop-down allow-empty="true"><option key="N"/><option key="Y"/></drop-down></default-field></field><field name="functionName"><default-field title="Function"><drop-down allow-empty="true"><list-options list="funcOptions"/></drop-down></default-field></field><field name="sequenceNum"><default-field title="Sequence"><text-line size="2"/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><label text="Each field must have a unique name, duplicates shown in red. Set an alias to resolve duplicates." type="p"/></box-body><box-body-nopad><form-list name="FieldList" list="ddFieldList" transition="updateDataDocumentField" multi="true"><row-actions><set field="curField" from="fieldNameAlias ?: (fieldPath.contains(':') ? fieldPath.substring(fieldPath.lastIndexOf(':')+1) : fieldPath)"/><set field="isDup" from="knownFields.contains(curField)"/><script><![CDATA[knownFields.add(curField)]]></script></row-actions><field name="dataDocumentId"><default-field><hidden/></default-field></field><field name="fieldSeqId"><default-field><hidden/></default-field></field><field name="sequenceNum"><default-field title="Seq"><text-line size="2"/></default-field></field><field name="fieldPath"><default-field><display text=" "/><link url="." text="${fieldPath.split(':').collect({ it.contains('.') ? it : org.moqui.util.StringUtilities.camelCaseToPretty(it) }).join(' : ')}" link-type="anchor" parameter-map="[fieldPath:fieldPath]" style="${isDup ? 'text-danger' : ''}"/></default-field></field><field name="fieldNameAlias" from="org.moqui.util.StringUtilities.camelCaseToPretty(fieldNameAlias)"><default-field title="Alias"><text-line size="20"/></default-field></field><field name="sortable"><default-field title="Sortable"><drop-down allow-empty="true"><option key="N"/><option key="Y"/></drop-down></default-field></field><field name="defaultDisplay"><default-field title="Display"><drop-down allow-empty="true"><option key="Y"/><option key="N"/></drop-down></default-field></field><field name="functionName"><default-field title="Function"><drop-down allow-empty="true"><list-options list="funcOptions"/></drop-down></default-field></field><field name="submitButton"><default-field title="Update All"><submit/></default-field></field><field name="deleteButton"><default-field title=""><link url="deleteDataDocumentField" text=" " icon="fa fa-trash" confirmation="Really remove?"><parameter name="dataDocumentId"/><parameter name="fieldSeqId"/><parameter name="fieldPath"/></link></default-field></field></form-list></box-body-nopad></container-box></widgets></screen>
<!-- Screen Location component://tools/screen/System/DataDocument/Edit/DataDocFields.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Fields" default-menu-index="2"><parameter name="dataDocumentId" required="true" from="dataDocumentId ?: dataDocumentId_0"/><transition name="createDataDocumentField"><service-call name="org.moqui.impl.EntityServices.create#DataDocumentField" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><entity-find-one entity-name="moqui.entity.document.DataDocument" value-field="dataDocument"/><set field="primaryEntityName" from="dataDocument.primaryEntityName"/><set field="funcOptions" from="['min', 'max', 'sum', 'avg', 'count', 'count-distinct', 'upper', 'lower']"/></actions><widgets><container-row><row-col md="4"><section name="FieldTreeSection"><widgets><label text="Add Fields (from ${org.moqui.util.StringUtilities.camelCaseToPretty(primaryEntityName.substring(primaryEntityName.lastIndexOf('.')+1))})" type="h5"/><tree name="FieldTree" open-path="${fieldPath?:''}"><parameter name="dataDocumentId"/><tree-node name="FieldNode"><actions><set field="fieldPath" from="(treeNodeId == '#' ? '' : treeNodeId + ':') + nodeList_entry"/></actions><link url="FieldList/createFieldDynamic" text="+ ${org.moqui.util.StringUtilities.camelCaseToPretty(nodeList_entry)}" id="${fieldPath}" dynamic-load-id="FieldListContainer"><parameter name="fieldPath" from="fieldPath"/></link></tree-node><tree-node name="RelationshipNode"><actions><set field="curPath" from="(treeNodeId == '#' ? '' : treeNodeId + ':') + nodeList_entry"/></actions><label text="${nodeList_entry.contains('.') ? nodeList_entry : org.moqui.util.StringUtilities.camelCaseToPretty(nodeList_entry)}" id="${curPath}"/><tree-sub-node node-name="FieldNode" list="childFields"><actions><set field="curPath" from="(treeNodeId == '#' ? '' : treeNodeId)"/><entity-find-one entity-name="moqui.entity.document.DataDocument" value-field="dataDocument" cache="true"/><set field="curEd" from="ec.entity.getEntityDefinition(dataDocument.primaryEntityName)"/><iterate list="curPath.split(':')" entry="relName"><if condition="curEd == null"><break/></if><set field="curEd" from="curEd.getRelationshipInfo(relName)?.relatedEd"/></iterate><set field="childFields" from="curEd?.getAllFieldNames()"/></actions></tree-sub-node><tree-sub-node node-name="RelationshipNode" list="childRelationships"><actions><set field="childRelationships" from="[]"/><set field="curPath" from="(treeNodeId == '#' ? '' : treeNodeId)"/><set field="curPathSplit" from="curPath.split(':') as List"/><if condition="curPathSplit.size() > 10"><return/></if><entity-find-one entity-name="moqui.entity.document.DataDocument" value-field="dataDocument" cache="true"/><set field="curEd" from="ec.entity.getEntityDefinition(dataDocument.primaryEntityName)"/><iterate list="curPathSplit" entry="relName"><if condition="curEd == null || !relName"><break/></if><set field="curEd" from="curEd.getRelationshipInfo(relName)?.relatedEd"/></iterate><iterate list="curEd?.getRelationshipsInfo(false)" entry="relInfo"><if condition="relInfo.isAutoReverse"><continue/></if><script><![CDATA[childRelationships.add(relInfo.shortAlias ?: relInfo.relationshipName)]]></script></iterate></actions></tree-sub-node></tree-node><tree-sub-node node-name="FieldNode" list="topLevelFields"><actions><entity-find-one entity-name="moqui.entity.document.DataDocument" value-field="dataDocument" cache="true"/><set field="primaryEd" from="ec.entity.getEntityDefinition(dataDocument.primaryEntityName)"/><set field="topLevelFields" from="primaryEd.getAllFieldNames()"/></actions></tree-sub-node><tree-sub-node node-name="RelationshipNode" list="topLevelRelationships"><actions><entity-find-one entity-name="moqui.entity.document.DataDocument" value-field="dataDocument" cache="true"/><set field="primaryEd" from="ec.entity.getEntityDefinition(dataDocument.primaryEntityName)"/><set field="topLevelRelationships" from="[]"/><iterate list="primaryEd.getRelationshipsInfo(false)" entry="relInfo"><if condition="relInfo.isAutoReverse"><continue/></if><script><![CDATA[topLevelRelationships.add(relInfo.shortAlias ?: relInfo.relationshipName)]]></script></iterate></actions></tree-sub-node></tree></widgets></section></row-col><row-col md="8"><dynamic-container id="FieldListContainer" transition="FieldList"/></row-col></container-row></widgets></screen>
<!-- Screen Location component://tools/screen/System/DataDocument/Edit/ViewDataDocument.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="View" default-menu-index="3"><parameter name="dataDocumentId" required="true"/><transition name="DocumentExport.json" read-only="true"><actions><script><![CDATA[import org.moqui.context.ExecutionContext
            import org.moqui.impl.entity.EntityDataDocument
            import java.sql.Timestamp

            ExecutionContext ec = context.ec
            EntityDataDocument edd = ec.entity.getEntityDataDocument()

            boolean prettyPrint = context.prettyPrint as Boolean
            fromUpdateStamp = fromUpdateStamp ? fromUpdateStamp as Timestamp : null
            thruUpdateStamp = thruUpdateStamp ? thruUpdateStamp as Timestamp : null

            String filename = (String) dataDocumentId + ".json"
            def response = ec.web.response
            response.setContentType("application/json")
            response.setCharacterEncoding("UTF-8")
            response.setHeader("Content-Disposition", "attachment; filename=\"${filename}\"; filename*=utf-8''${encodeAsciiFilename(filename)}")
            response.setHeader("Cache-Control", "no-cache, must-revalidate, private")
            response.getWriter().write("[\n")
            edd.writeDocumentsToWriter(response.getWriter(), [(String) dataDocumentId], null, fromUpdateStamp, thruUpdateStamp, prettyPrint)
            response.getWriter().write("]\n")]]></script></actions><default-response type="none"/></transition><actions><set field="entityName" from="'DataDocument.' + dataDocumentId"/><set field="aenDef" from="ec.entity.getEntityDefinition(entityName)"/><if condition="aenDef == null"><message error="true"><![CDATA[Could not find Data Document ${dataDocumentId}]]></message><return/></if></actions><widgets><container-dialog id="ExportJsonDialog" button-text="Download JSON"><form-single name="ExportDocuments" transition="DocumentExport.json"><field name="dataDocumentId"><default-field><hidden/></default-field></field><field name="fromUpdateStamp"><default-field><date-time/></default-field></field><field name="thruUpdateStamp"><default-field><date-time/></default-field></field><field name="prettyPrint"><default-field title=""><check><option key="true" text="Pretty Print JSON?"/></check></default-field></field><field name="submitButton"><default-field title="Download"><submit/></default-field></field></form-single></container-dialog><form-list name="DataViewList" list="entityValueList" skip-form="true" dynamic="true" header-dialog="true" show-csv-button="true" show-xlsx-button="true" show-page-size="true" saved-finds="true"><entity-find entity-name="${entityName}" list="entityValueList" cache="false" use-clone="true"><search-form-inputs/></entity-find><field name="dataDocumentId"><header-field><hidden/></header-field></field><auto-fields-entity entity-name="${entityName}" field-type="find-display"/><field name="findButton"><header-field title="Find"><submit/></header-field></field></form-list></widgets></screen>
<!-- Screen Location component://tools/screen/System/DataDocument/Edit.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Edit" default-menu-index="6"><subscreens default-item="FindDataDocument"/><widgets><subscreens-panel id="DataDocEditPanel" type="tab"/></widgets></screen>
<!-- Screen Location component://tools/screen/System/DataDocument.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Data Document" default-menu-index="6"><subscreens default-item="Search"/><widgets><subscreens-panel id="DataDocumentPanel" type="popup"/></widgets></screen>
<!-- Screen Location component://tools/screen/System/EntitySync/EntitySyncList.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="entitySyncDetail"><default-response url="../EntitySyncDetail"/></transition><transition name="createEntitySync"><service-call name="create#moqui.entity.sync.EntitySync" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><entity-find entity-name="moqui.entity.sync.EntitySync" list="entitySyncList"><search-form-inputs default-order-by="description"/></entity-find></actions><widgets><container-dialog id="CreateEntitySyncDialog" button-text="Create Entity Sync"><form-single name="CreateEntitySync" transition="createEntitySync"><field name="description"><default-field><text-line size="60"/></default-field></field><field name="forPull"><default-field tooltip="Y for pull from remote, N for push to remote"><drop-down><option key="N"/><option key="Y"/></drop-down></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="EntitySyncList" list="entitySyncList" skip-form="true"><field name="entitySyncId"><header-field title="ID" show-order-by="true"><text-find size="6" hide-options="true"/></header-field><default-field><link text="${entitySyncId}" url="entitySyncDetail" link-type="anchor"/></default-field></field><field name="description"><header-field show-order-by="true"><text-find size="20" hide-options="true"/></header-field><default-field><display/></default-field></field><field name="statusId"><header-field title="Status"><drop-down allow-empty="true"><entity-options key="${statusId}" text="${description}"><entity-find entity-name="moqui.basic.StatusItem"><econdition field-name="statusTypeId" value="EntitySync"/><order-by field-name="description"/></entity-find></entity-options></drop-down></header-field><default-field><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="lastStartDate"><header-field show-order-by="true"><date-period allow-empty="true"/></header-field><default-field><display/></default-field></field><field name="lastSuccessfulSyncTime"><header-field show-order-by="true"><date-period allow-empty="true"/></header-field><default-field><display/></default-field></field><field name="targetServerUrl"><header-field show-order-by="true"><text-find size="20" hide-options="true"/></header-field><default-field><display/></default-field></field><field name="forPull"><header-field><drop-down allow-empty="true"><option key="N"/><option key="Y"/></drop-down></header-field><default-field><display/></default-field></field><field name="find"><header-field title="Find"><submit/></header-field><default-field><display text=" "/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://tools/screen/System/EntitySync/EntitySyncDetail.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-index="1"><parameter name="entitySyncId" required="true"/><transition name="updateEntitySync"><service-call name="update#moqui.entity.sync.EntitySync" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="resetNotStarted"><service-call name="update#moqui.entity.sync.EntitySync" in-map="[entitySyncId:entitySyncId, statusId:'EsNotStarted']" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="artifactGroupDetail"><default-response url="../../Security/ArtifactGroup/ArtifactGroupDetail"/></transition><transition name="createEntitySyncArtifact"><service-call name="create#moqui.entity.sync.EntitySyncArtifact" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateEntitySyncArtifact"><service-call name="update#moqui.entity.sync.EntitySyncArtifact" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteEntitySyncArtifact"><service-call name="delete#moqui.entity.sync.EntitySyncArtifact" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><entity-find-one entity-name="moqui.entity.sync.EntitySync" value-field="entitySync"/><entity-find entity-name="moqui.entity.sync.EntitySyncArtifact" list="artifactList"><econdition field-name="entitySyncId"/><order-by field-name="artifactGroupId"/></entity-find><service-call name="org.moqui.impl.EntitySyncServices.get#EntitySyncIncludeList" out-map="context" in-map="context"/></actions><widgets><container-row><row-col lg="5"><link url="resetNotStarted" text="Reset From Running (do ONLY if Last Start is old or verified not running)" condition="entitySync.statusId == 'EsRunning'"/><form-single name="EntitySyncForm" map="entitySync" transition="updateEntitySync"><field name="entitySyncId"><default-field><display/></default-field></field><field name="description"><default-field><text-line size="50"/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem"/><label text="If not really running, ie running and recovery failed, will try again in 24 hours" condition="entitySync.statusId == 'EsRunning'" type="p"/></default-field></field><field name="lastStartDate"><default-field title="Last Start"><display/></default-field></field><field name="lastSuccessfulSyncTime"><default-field title="Last Successful Time"><display/></default-field></field><field name="syncSplitMillis"><default-field title="Sync Split" tooltip="Time period in milliseconds for each query across included entities"><text-line size="8"/></default-field></field><field name="recordThreshold"><default-field title="Records" tooltip="Keep querying splits until at least this many records are sent"><text-line size="8"/></default-field></field><field name="delayBufferMillis"><default-field title="Delay Buffer" tooltip="Don't send records newer than this many milliseconds old"><text-line size="8"/></default-field></field><field name="targetServerUrl"><default-field><text-line size="50"/></default-field></field><field name="targetUsername"><default-field title="Username"><text-line size="30"/></default-field></field><field name="targetPassword"><default-field title="Password"><text-line size="20"/></default-field></field><field name="targetPath"><default-field><text-line size="50"/></default-field></field><field name="forPull"><default-field tooltip="Y for pull from remote, N for push to remote"><drop-down><option key="N"/><option key="Y"/></drop-down></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></row-col><row-col lg="7"><container-box><box-header title="Artifact Groups (includes entities only)"/><box-toolbar><container-dialog id="AddAuthzDialog" button-text="Add Artifact Group"><form-single name="CreateEntitySyncArtifact" transition="createEntitySyncArtifact"><field name="entitySyncId"><default-field><hidden/></default-field></field><field name="artifactGroupId"><default-field title="Artifact Group"><drop-down><entity-options key="${artifactGroupId}" text="${description} [${artifactGroupId}]"><entity-find entity-name="moqui.security.ArtifactGroup"><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="applEnumId"><default-field title="Appl Type"><drop-down><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="EntitySyncArtifactAppl"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="dependents"><default-field><drop-down><option key="N"/><option key="Y"/></drop-down></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="EntitySyncArtifactList" list="artifactList" transition="updateEntitySyncArtifact"><field name="entitySyncId"><default-field><hidden/></default-field></field><field name="artifactGroupId"><default-field title="Artifact Group"><display-entity entity-name="moqui.security.ArtifactGroup" text="${description ?: ''} - "/><link url="artifactGroupDetail" text="${artifactGroupId}" link-type="anchor"/></default-field></field><field name="applEnumId"><default-field title="Appl Type"><drop-down><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="EntitySyncArtifactAppl"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="dependents"><default-field><drop-down><option key="N"/><option key="Y"/></drop-down></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field name="deleteLink"><default-field title=""><link url="deleteEntitySyncArtifact" text="X" confirmation="Really Delete?" parameter-map="[entitySyncId:entitySyncId, artifactGroupId:artifactGroupId]"/></default-field></field></form-list></box-body></container-box><label text="Entities to Include" type="h5"/><form-list name="EntityIncludeList" list="entityIncludeList" skip-form="true"><field name="entityName"><default-field><display/></default-field></field><field name="includeFilterList"><default-field><display/></default-field></field><field name="dependents"><default-field><display/></default-field></field></form-list></row-col></container-row></widgets></screen>
<!-- Screen Location component://tools/screen/System/EntitySync/EntitySyncHistory.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="History" default-menu-index="2"><parameter name="entitySyncId" required="true"/><transition name="resetNotStarted"><service-call name="update#moqui.entity.sync.EntitySync" in-map="[entitySyncId:entitySyncId, statusId:'EsNotStarted']" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><entity-find-one entity-name="moqui.entity.sync.EntitySync" value-field="entitySync"/><entity-find entity-name="moqui.entity.sync.EntitySyncHistory" list="historyList"><search-form-inputs default-order-by="-startDate"/><econdition field-name="entitySyncId"/></entity-find></actions><widgets><form-list name="HistoryList" list="historyList" skip-form="true"><field name="entitySyncId"><header-field><hidden/></header-field></field><field name="startDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="finishDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="statusId"><header-field title="Status"><drop-down allow-empty="true"><entity-options key="${statusId}" text="${description}"><entity-find entity-name="moqui.basic.StatusItem"><econdition field-name="statusTypeId" value="EntitySync"/><order-by field-name="description"/></entity-find></entity-options></drop-down></header-field><default-field><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="exclusiveFromTime"><header-field show-order-by="true"><date-period/></header-field><default-field><display format="yyyy-MM-dd HH:mm:ss.SSS"/></default-field></field><field name="inclusiveThruTime"><header-field show-order-by="true"><date-period/></header-field><default-field><display format="yyyy-MM-dd HH:mm:ss.SSS"/></default-field></field><field name="recordsStored"><header-field show-order-by="true"><range-find size="4"/></header-field><default-field><display/></default-field></field><field name="runningTimeMillis"><header-field show-order-by="true"/><default-field><display/></default-field></field><field name="errorMessage"><header-field><submit text="Find"/></header-field><default-field><display/></default-field></field><form-list-column><field-ref name="startDate"/><field-ref name="finishDate"/></form-list-column><form-list-column><field-ref name="statusId"/></form-list-column><form-list-column><field-ref name="exclusiveFromTime"/><field-ref name="inclusiveThruTime"/></form-list-column><form-list-column><field-ref name="recordsStored"/><field-ref name="runningTimeMillis"/></form-list-column><form-list-column><field-ref name="errorMessage"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://tools/screen/System/EntitySync.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-index="7"><subscreens default-item="EntitySyncList"/><widgets><subscreens-panel id="EntitySyncPanel" type="tab"/></widgets></screen>
<!-- Screen Location component://tools/screen/System/Localization/Messages.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Messages" default-menu-index="1"><transition name="createLocalizedMessage"><service-call name="create#moqui.basic.LocalizedMessage" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateLocalizedMessage"><service-call name="update#moqui.basic.LocalizedMessage" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteLocalizedMessage"><service-call name="delete#moqui.basic.LocalizedMessage" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><entity-find entity-name="moqui.basic.LocalizedMessage" list="localizedMessageList" use-clone="true"><search-form-inputs default-order-by="^original,locale"/></entity-find></actions><widgets><container><container-dialog id="CreateMessageDialog" button-text="New Message"><form-single name="CreateLocalizedMessage" transition="createLocalizedMessage"><field name="original"><default-field><text-line size="80" maxlength="255"/></default-field></field><field name="locale"><default-field><text-line size="5"/></default-field></field><field name="localized"><default-field><text-area rows="5" cols="80"/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog></container><form-list name="UpdateLocalizedMessages" list="localizedMessageList" transition="updateLocalizedMessage" multi="true"><field name="original"><header-field show-order-by="case-insensitive"><text-find hide-options="true" size="15"/></header-field><default-field><display/></default-field></field><field name="locale"><header-field show-order-by="true"><text-find hide-options="true" size="5"/></header-field><default-field><display/></default-field></field><field name="localized"><header-field show-order-by="case-insensitive"><text-find hide-options="true" size="30"/></header-field><default-field><text-area rows="2" cols="60"/></default-field></field><field name="_useRowSubmit"><default-field><hidden default-value="true"/></default-field></field><field name="_rowSubmit"><default-field title="Update"><check><option key="true" text=" "/></check></default-field></field><field name="delete"><header-field title="Find"><submit/></header-field><default-field><link text="Delete" url="deleteLocalizedMessage"><parameter name="original"/><parameter name="locale"/></link></default-field></field><field name="update"><default-field title="Update"><submit/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://tools/screen/System/Localization/EntityFields.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Entity Fields" default-menu-index="2"><transition name="createLocalizedEntityField"><service-call name="create#moqui.basic.LocalizedEntityField" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateLocalizedEntityField"><service-call name="update#moqui.basic.LocalizedEntityField" multi="true" in-map="true" out-map="context"/><default-response url="."/></transition><transition name="deleteLocalizedEntityField"><service-call name="delete#moqui.basic.LocalizedEntityField" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><entity-find entity-name="moqui.basic.LocalizedEntityField" list="localizedEntityFieldList" use-clone="true"><search-form-inputs default-order-by="entityName,fieldName,locale"/></entity-find></actions><widgets><container><container-dialog id="CreateEntityFieldDialog" button-text="New Field L10n"><form-single name="CreateLocalizedEntityField" transition="createLocalizedEntityField"><field name="entityName"><default-field><text-line size="80"/></default-field></field><field name="fieldName"><default-field><text-line size="30"/></default-field></field><field name="pkValue"><default-field><text-line size="20"/></default-field></field><field name="locale"><default-field><text-line size="5"/></default-field></field><field name="localized"><default-field><text-area rows="5" cols="80"/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog></container><form-list name="UpdateLocalizedEntityFields" list="localizedEntityFieldList" transition="updateLocalizedEntityField" multi="true"><field name="entityName"><header-field show-order-by="true"><text-find hide-options="true" size="12"/></header-field><default-field><display/></default-field></field><field name="fieldName"><header-field show-order-by="true"><text-find hide-options="true" size="12"/></header-field><default-field><display/></default-field></field><field name="pkValue"><header-field show-order-by="true"><text-find hide-options="true" size="12"/></header-field><default-field><display/></default-field></field><field name="locale"><header-field show-order-by="true"><text-find hide-options="true" size="4"/></header-field><default-field><display/></default-field></field><field name="localized"><default-field><text-area rows="2" cols="35"/></default-field></field><field name="update"><default-field title="Update"><submit/></default-field></field><field name="delete"><header-field title="Find"><submit/></header-field><default-field><link text="Delete" url="deleteLocalizedEntityField"><parameter name="entityName"/><parameter name="fieldName"/><parameter name="locale"/></link></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://tools/screen/System/Localization.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Localization" default-menu-index="8"><subscreens default-item="Messages"/><widgets><subscreens-panel id="localization-panel" type="popup"/></widgets></screen>
<!-- Screen Location component://tools/screen/System/Print/PrintJob/PrintJobList.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="printJobDetail"><default-response url="../PrintJobDetail"/></transition><transition name="downloadDocument" read-only="true"><parameter name="printJobId"/><actions><entity-find-one entity-name="moqui.basic.print.PrintJob" value-field="printJob"/><script><![CDATA[import org.apache.commons.io.IOUtils

                byte[] bytes = printJob.getBytes("document")
                if (bytes.length > 0) {
                    fileExtension = null
                    if (printJob.contentType) {
                        ec.web.response.setContentType(printJob.contentType)
                        // TODO: need a more comprehensive way to determine extension based on contentType
                        if (printJob.contentType == "application/pdf") fileExtension = "pdf"
                    }
                    if (fileExtension) {
                        fileName = "${printJob.jobName ?: 'document'}.${fileExtension}".toString()
                        contentDisposition = "attachment; filename=\"${fileName}\"; filename*=utf-8''${encodeAsciiFilename(fileName)}"
                    } else {
                        contentDisposition = "attachment"
                    }

                    ec.web.response.setHeader("Content-Disposition", contentDisposition)
                    IOUtils.write(bytes, ec.web.response.outputStream)
                } else {
                    ec.message.addError(ec.resource.expand('No document found in PrintJob [${printJobId}]',''))
                }]]></script></actions><default-response type="none"/><error-response url="."/></transition><actions><entity-find entity-name="moqui.basic.print.PrintJob" list="printJobList"><search-form-inputs default-order-by="-createdDate"/></entity-find></actions><widgets><form-list name="PrintJobList" list="printJobList" skip-form="true"><field name="printJobId"><header-field title="ID" show-order-by="true"><text-find size="10" hide-options="true"/></header-field><default-field><display/><link text="View/Update" url="printJobDetail" link-type="anchor-button"/></default-field></field><field name="statusId"><header-field title="Status"><drop-down allow-empty="true"><entity-options key="${statusId}" text="${description}"><entity-find entity-name="moqui.basic.StatusItem"><econdition field-name="statusTypeId" value="EntitySync"/><order-by field-name="description"/></entity-find></entity-options></drop-down></header-field><default-field><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="createdDate"><header-field show-order-by="true"><date-period allow-empty="true"/></header-field><default-field><display/></default-field></field><field name="networkPrinterId"><header-field title="Printer"><drop-down allow-empty="true"><entity-options key="${networkPrinterId}" text="${description ?: printerName} (${serverHost})"><entity-find entity-name="moqui.basic.print.NetworkPrinter"><order-by field-name="description,printerName"/></entity-find></entity-options></drop-down></header-field><default-field><display-entity entity-name="moqui.basic.print.NetworkPrinter" text="${serverHost} - ${description ?: printerName}"/></default-field></field><field name="username"><header-field show-order-by="true"><text-find size="15" hide-options="true"/></header-field><default-field><display/></default-field></field><field name="jobId"><header-field show-order-by="true"><text-line size="5"/></header-field><default-field><display/></default-field></field><field name="jobName"><header-field show-order-by="true"><text-find size="15" hide-options="true"/></header-field><default-field><display/></default-field></field><field name="copies"><header-field show-order-by="true"><text-line size="5"/></header-field><default-field><display/></default-field></field><field name="duplex"><header-field show-order-by="true"><drop-down allow-empty="true"><option key="N"/><option key="Y"/></drop-down></header-field><default-field><display/></default-field></field><field name="pageRanges"><header-field show-order-by="true"><text-find size="5" hide-options="true"/></header-field><default-field><display/></default-field></field><field name="contentType"><header-field show-order-by="true"><text-find size="15" hide-options="true"/></header-field><default-field><display/></default-field></field><field name="find"><header-field title="Find"><submit/></header-field><conditional-field condition="document != null"><link url="downloadDocument" text="Download"/></conditional-field><default-field><display text=" "/></default-field></field><form-list-column><field-ref name="printJobId"/></form-list-column><form-list-column><field-ref name="statusId"/><field-ref name="createdDate"/></form-list-column><form-list-column><field-ref name="networkPrinterId"/><field-ref name="username"/></form-list-column><form-list-column><field-ref name="jobId"/><field-ref name="jobName"/></form-list-column><form-list-column><field-ref name="copies"/><field-ref name="duplex"/></form-list-column><form-list-column><field-ref name="pageRanges"/><field-ref name="contentType"/></form-list-column><form-list-column><field-ref name="find"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://tools/screen/System/Print/PrintJob/PrintJobDetail.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-index="1"><parameter name="printJobId" required="true"/><transition name="updatePrintJob"><service-call name="update#moqui.basic.print.PrintJob" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="downloadDocument" location="component://tools/screen/System/Print/PrintJob/PrintJobList.xml"/><transition name="sendPrintJob"><service-call name="org.moqui.impl.PrintServices.send#PrintJob" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="holdPrintJob"><service-call name="org.moqui.impl.PrintServices.hold#PrintJob" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="releasePrintJob"><service-call name="org.moqui.impl.PrintServices.release#PrintJob" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="cancelPrintJob"><service-call name="org.moqui.impl.PrintServices.cancel#PrintJob" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><service-call name="org.moqui.impl.PrintServices.get#PrintJobDetailsFromServer" in-map="[printJobId:printJobId]" out-map="serverDetails" ignore-error="true"/><entity-find-one entity-name="moqui.basic.print.PrintJob" value-field="printJob"/></actions><widgets><container><link url="downloadDocument" text="Download Document" condition="printJob.document != null"/><link url="sendPrintJob" text="Send Now" condition="printJob.statusId in ['PtjNotSent', 'PtjSendFailed']"/><link url="holdPrintJob" text="Hold" condition="printJob.statusId == 'PtjPending'"/><link url="releasePrintJob" text="Release" condition="printJob.statusId == 'PtjPendingHeld'"/><link url="cancelPrintJob" text="Cancel" condition="printJob.statusId in ['PtjPending', 'PtjPendingHeld']"/></container><label text="NOTE: This gets the latest data from the print server, if the status was updated on the print server the latest will be shown here and saved." type="p"/><container-row><row-col lg="7"><label text="Local Details" type="h4"/><form-single name="PrintJobForm" map="printJob" transition="updatePrintJob"><field name="printJobId"><default-field title="ID"><display/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="createdDate"><default-field><display/></default-field></field><field name="networkPrinterId"><default-field title="Printer"><display-entity entity-name="moqui.basic.print.NetworkPrinter" text="${serverHost} - ${printerName}"/></default-field></field><field name="username"><default-field><display/></default-field></field><field name="jobId"><default-field><display/></default-field></field><field name="jobName"><default-field><display/></default-field></field><field name="copies"><default-field><display/></default-field></field><field name="duplex"><default-field><display/></default-field></field><field name="pageRanges"><default-field><display/></default-field></field><field name="contentType"><default-field><display/></default-field></field></form-single></row-col><row-col lg="5"><label text="Print Server Details" type="h4"/><form-single name="ServerDetailsForm" map="serverDetails"><field name="createTime"><default-field><display/></default-field></field><field name="completeTime"><default-field><display/></default-field></field><field name="printerUrl"><default-field><display/></default-field></field><field name="jobUrl"><default-field><display/></default-field></field><field name="pagesPrinted"><default-field><display/></default-field></field><field name="size"><default-field><display/></default-field></field></form-single></row-col></container-row></widgets></screen>
<!-- Screen Location component://tools/screen/System/Print/PrintJob.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Print Jobs" default-menu-index="1"><subscreens default-item="PrintJobList"/><widgets><subscreens-active/></widgets></screen>
<!-- Screen Location component://tools/screen/System/Print/Printer/PrinterList.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="getServerPrinters"><service-call name="org.moqui.impl.PrintServices.get#ServerPrinters" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createNetworkPrinter"><service-call name="create#moqui.basic.print.NetworkPrinter" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateNetworkPrinter"><service-call name="update#moqui.basic.print.NetworkPrinter" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteNetworkPrinter"><service-call name="delete#moqui.basic.print.NetworkPrinter" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="printJobList"><default-response url="../../PrintJob/PrintJobList"/></transition><actions><entity-find entity-name="moqui.basic.print.NetworkPrinter" list="networkPrinterList"><search-form-inputs default-order-by="serverHost,printerName"/></entity-find></actions><widgets><container-dialog id="GetDialog" button-text="Get Server Printers"><form-single name="GetForm" transition="getServerPrinters"><field name="serverHost"><default-field><text-line size="40"/></default-field></field><field name="serverPort"><default-field><text-line size="5" default-value="631"/></default-field></field><field name="submitButton"><default-field title="Get Printers"><submit/></default-field></field></form-single></container-dialog><container-dialog id="CreateDialog" button-text="Create Printer"><form-single name="CreateForm" transition="createNetworkPrinter"><field name="serverHost"><default-field><text-line size="40"/></default-field></field><field name="serverPort"><default-field><text-line size="5" default-value="631"/></default-field></field><field name="printerName"><default-field tooltip="Must match name on server exactly"><text-line size="40"/></default-field></field><field name="description"><default-field><text-line size="40"/></default-field></field><field name="location"><default-field><text-line size="40"/></default-field></field><field name="submitButton"><default-field title="Create Printer"><submit/></default-field></field></form-single></container-dialog><form-list name="PrintJobList" list="networkPrinterList" transition="updateNetworkPrinter"><field name="jobs"><default-field><link url="printJobList" text="Jobs" parameter-map="[networkPrinterId:networkPrinterId]"/></default-field></field><field name="networkPrinterId"><header-field title="ID" show-order-by="true"><text-find size="8" hide-options="true"/></header-field><default-field><display/></default-field></field><field name="serverHost"><header-field show-order-by="true"><text-find size="10" hide-options="true"/></header-field><default-field><display/></default-field></field><field name="serverPort"><header-field show-order-by="true"><text-line size="3"/></header-field><default-field><display/></default-field></field><field name="printerName"><header-field show-order-by="true"><text-find size="15" hide-options="true"/></header-field><default-field><display/></default-field></field><field name="description"><header-field show-order-by="true"><text-find size="15" hide-options="true"/></header-field><default-field><text-line size="30"/></default-field></field><field name="location"><header-field show-order-by="true"><text-find size="15" hide-options="true"/></header-field><default-field><text-line size="20"/></default-field></field><field name="update"><default-field title="Update"><submit/></default-field></field><field name="find"><header-field title="Find"><submit/></header-field><default-field><link url="deleteNetworkPrinter" text="Delete"/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://tools/screen/System/Print/Printer.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Printers" default-menu-index="2"><subscreens default-item="PrinterList"/><widgets><subscreens-active/></widgets></screen>
<!-- Screen Location component://tools/screen/System/Print.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-index="9"><subscreens default-item="Printer"/><widgets><subscreens-panel id="PrintPanel" type="popup"/></widgets></screen>
<!-- Screen Location component://tools/screen/System/Resource/ElFinder.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="elFinder"><parameter name="resourceRoot"/><always-actions><set field="mantleContentRoot" from="ec.user.getPreference('mantle.content.root') ?: 'dbresource://mantle/content'"/><set field="mantleContentLargeRoot" from="ec.user.getPreference('mantle.content.large.root') ?: 'dbresource://mantle/content'"/><set field="resourceRoot" from="resourceRoot ?: mantleContentRoot"/></always-actions><transition name="command" read-only="true"><actions><service-call name="org.moqui.impl.ElFinderServices.run#Command" out-map="context" in-map="context + [otherParameters:ec.web.parameters]"/><if condition="fileLocation"><script><![CDATA[ec.web.sendResourceResponse(fileLocation, fileInline ?: false)]]></script><else><script><![CDATA[ec.web.sendJsonResponse(responseMap)]]></script></else></if></actions><default-response type="none"/></transition><actions><set field="rootOptions" from="[mantleContentRoot, 'dbresource://', 'component://webroot', 'file:runtime']"/><if condition="mantleContentLargeRoot != mantleContentRoot"><script><![CDATA[rootOptions.add(mantleContentLargeRoot)]]></script></if></actions><widgets><form-single name="SelectRoot" transition="."><field name="resourceRoot"><default-field title=""><drop-down><list-options list="rootOptions"/></drop-down></default-field></field><field name="submitButton"><default-field title="Select Root"><submit/></default-field></field><field-layout><field-row-big><field-ref name="resourceRoot"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single><render-mode><text type="html,vuet,qvt"><![CDATA[<div id="elfinder"></div><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.13.2/themes/smoothness/jquery-ui.min.css" type="text/css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.13.2/themes/smoothness/theme.min.css" type="text/css"/><script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.13.2/jquery-ui.min.js" type="text/javascript"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/elfinder/2.1.62/css/elfinder.min.css" type="text/css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/elfinder/2.1.62/css/theme.min.css" type="text/css"/><script src="https://cdnjs.cloudflare.com/ajax/libs/elfinder/2.1.62/js/elfinder.min.js" type="text/javascript"></script><script>
    $('#elfinder').elfinder({ url:'${sri.buildUrl('command').url}', customData:{ moquiSessionToken:'${ec.web.sessionToken}', resourceRoot:'${resourceRoot}' },
        lang:'en', defaultView:'list', requestType:'post', rememberLastDir:false, height:700,
        commands : [ 'open', 'reload', 'home', 'up', 'back', 'forward', 'getfile', 'quicklook',
            'download', 'rm', 'rename', 'mkdir', 'mkfile', 'upload', 'edit', 'info', 'view', 'help',
            'sort'],
        uiOptions : {
            // toolbar configuration (NOTE: 'quicklook' doesn't seem to work)
            toolbar : [
                ['back', 'forward'],
                ['reload', 'home', 'up'],
                ['mkdir', 'mkfile', 'upload'],
                ['open', 'download'],
                ['info'],
                ['rm', 'rename', 'edit'],
                ['view', 'help']
            ],
            navbar : { minWidth : 150, maxWidth : 800 }
        }
    });
            </script>]]></text></render-mode></widgets></screen>
<!-- Screen Location component://tools/screen/System/Resource.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Resource Finder" default-menu-index="10"><subscreens default-item="ElFinder"/><widgets><subscreens-active/></widgets></screen>
<!-- Screen Location component://tools/screen/System/Security/UserAccount/UserAccountList.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="userAccountDetail"><default-response url="../UserAccountDetail"/></transition><transition name="createUserAccount"><service-call name="org.moqui.impl.UserServices.create#UserAccount" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><widgets><container-dialog id="CreateUserAccountDialog" button-text="Create User Account"><form-single name="CreateUserAccount" transition="createUserAccount"><field name="partyId"><default-field><hidden/></default-field></field><field name="username"><default-field><text-line size="20"/></default-field></field><field name="emailAddress"><default-field title="Email"><text-line size="60"/></default-field></field><field name="userFullName"><default-field title="Full Name"><text-line size="40"/></default-field></field><field name="newPassword"><default-field title="Password"><password size="15"/></default-field></field><field name="newPasswordVerify"><default-field title="Password Verify"><password size="15"/></default-field></field><field name="requirePasswordChange"><default-field><drop-down><option key="Y"/><option key="N"/></drop-down></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="UserAccountList" list="userAccountList" skip-form="true" header-dialog="true" saved-finds="true" select-columns="true" show-xlsx-button="true" show-csv-button="true" show-page-size="true"><entity-find entity-name="moqui.security.UserAccountAndGroup" list="userAccountList" distinct="true"><search-form-inputs default-order-by="username"/><econdition field-name="emailNotifications" value="Y" ignore="!topic"/><select-field field-name="userId"/></entity-find><field name="userGroupId"><header-field title="User Group"><drop-down allow-multiple="true" show-not="true"><entity-options key="${userGroupId}" text="${description}"><entity-find entity-name="moqui.security.UserGroup"><econdition field-name="userGroupId" operator="not-equals" value="ALL_USERS"/><order-by field-name="description"/></entity-find></entity-options></drop-down></header-field></field><field name="loginFromDate"><header-field title="Login Date"><date-period/></header-field></field><field name="topic"><header-field title="Topic Email"><drop-down allow-multiple="true"><entity-options key="${topic}" text="${description}"><entity-find entity-name="moqui.security.user.NotificationTopic"><order-by field-name="description"/></entity-find></entity-options></drop-down></header-field></field><field name="userId"><header-field title="ID" show-order-by="true"><text-find size="20" default-operator="begins"/></header-field><default-field><link text="${userId}" url="userAccountDetail" link-type="anchor"/></default-field></field><field name="username"><header-field show-order-by="true"><text-find size="25" default-operator="begins"/></header-field><default-field><link text="${username}" url="userAccountDetail" link-type="anchor"/></default-field></field><field name="emailAddress"><header-field show-order-by="true"><text-find size="25" default-operator="begins"/></header-field><default-field><display/></default-field></field><field name="userFullName"><header-field show-order-by="true"><text-find size="25" default-operator="begins"/></header-field><default-field><display/></default-field></field><field name="passwordSetDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="requirePasswordChange"><header-field title="Req PW Change" show-order-by="true"><drop-down allow-empty="true"><option key="Y"/><option key="N"/></drop-down></header-field><default-field><display/></default-field></field><field name="successiveFailedLogins"><header-field title="Failed Logins" show-order-by="true"/><default-field><display/></default-field></field><field name="disabled"><header-field show-order-by="true"><drop-down allow-empty="true"><option key="Y"/><option key="N"/></drop-down></header-field><default-field><display text="${disabled ?: 'N'} ${disabledDateTime ?: ''}"/></default-field></field><field name="locale"><header-field show-order-by="true"><text-find size="6" default-operator="begins"/></header-field><default-field><display/></default-field></field><field name="timeZone"><header-field show-order-by="true"><text-find size="8" default-operator="begins"/></header-field><default-field><display/></default-field></field><field name="find"><header-field title="Find"><submit/></header-field><default-field><display text=" "/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://tools/screen/System/Security/UserAccount/UserAccountDetail.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-index="1"><parameter name="userId" required="true" from="userId ?: userId_0"/><transition name="updateUserAccount"><service-call name="org.moqui.impl.UserServices.update#UserAccount" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updatePassword"><service-call name="org.moqui.impl.UserServices.update#Password" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="enableUserAccount"><service-call name="org.moqui.impl.UserServices.enable#UserAccount" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="disableUserAccount"><service-call name="org.moqui.impl.UserServices.disable#UserAccount" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="resetPassword"><service-call name="org.moqui.impl.UserServices.reset#Password" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="loginAs"><parameter name="loginAsUsername"/><actions><if condition="ec.user.hasPermission('ADMIN_LOGIN_AS')"><then><script><![CDATA[ec.user.internalLoginUser(loginAsUsername)]]></script></then><else><return error="true" message="You are not permitted to login as another user"/></else></if></actions><default-response url="/"/><error-response url="."/></transition><transition name="visitList"><default-response url="../../../Visit/VisitList"/></transition><transition name="visitDetail"><default-response url="../../../Visit/VisitDetail"/></transition><transition name="userGroupDetail"><default-response url="../../UserGroup/UserGroupDetail"/></transition><transition name="createUserGroupMember"><service-call name="create#moqui.security.UserGroupMember" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateUserGroupMember"><service-call name="update#moqui.security.UserGroupMember" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createUserAuthcFactorTotp"><service-call name="org.moqui.impl.UserServices.create#UserAuthcFactorTotp" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="verifyUserAuthcFactorTotp"><service-call name="org.moqui.impl.UserServices.verify#UserAuthcFactorTotp" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createUserAuthcFactorSingleUse"><service-call name="org.moqui.impl.UserServices.create#SingleUseAuthcCodes" in-map="true" out-map="context" multi="parameter"/><actions><script><![CDATA[ec.web.sessionAttributes.put("singleUseCodes", singleUseCodes)]]></script></actions><default-response url="."/></transition><transition name="createUserAuthcFactorEmail"><service-call name="org.moqui.impl.UserServices.create#UserAuthcFactorEmail" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createUserAuthcFactorSms"><service-call name="org.moqui.impl.UserServices.create#UserAuthcFactorSms" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="factorSubmit"><service-call name="org.moqui.impl.UserServices.invalidate#UserAuthcFactorEntry" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createUserPreference"><service-call name="create#moqui.security.UserPreference" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateUserPreference"><service-call name="update#moqui.security.UserPreference" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteUserPreference"><service-call name="delete#moqui.security.UserPreference" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="topicSubscriptions"><service-call name="store#moqui.security.user.NotificationTopicUser" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="releaseTarpitNow"><service-call name="update#moqui.security.ArtifactTarpitLock" in-map="[artifactTarpitLockId:artifactTarpitLockId, releaseDateTime:ec.user.nowTimestamp]" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><entity-find-one entity-name="moqui.security.UserAccount" value-field="userAccount"/><set field="singleUseCodes" from="ec.web.sessionAttributes.remove('singleUseCodes')"/><set field="localeStringList" from="[]"/><iterate list="Locale.getAvailableLocales()" entry="lcl"><script><![CDATA[localeStringList.add([locale:lcl.toString(), name:lcl.getDisplayName(ec.user.locale)])]]></script></iterate><order-map-list list="localeStringList"><order-by field-name="name"/></order-map-list><entity-find entity-name="moqui.security.UserGroupMember" list="ugmList"><econdition field-name="userId"/><order-by field-name="userGroupId"/></entity-find><entity-find entity-name="moqui.security.UserPreference" list="upList"><econdition field-name="userId"/><order-by field-name="preferenceKey"/></entity-find><entity-find entity-name="moqui.security.user.NotificationTopic" list="notificationTopicList"><order-by field-name="description"/></entity-find><entity-find entity-name="moqui.security.UserLoginHistory" list="historyList" limit="20"><search-form-inputs default-order-by="-fromDate"/><econdition field-name="userId"/></entity-find><entity-find entity-name="moqui.security.ArtifactTarpitLock" list="artifactTarpitLockList" limit="20"><econdition field-name="userId"/><order-by field-name="-releaseDateTime"/></entity-find><entity-find-count entity-name="moqui.security.ArtifactTarpitLock" count-field="allTarpitLocksCount"><econdition field-name="userId"/></entity-find-count><set field="sendSmsLoc" from="ec.service.getServiceDefinition('org.moqui.SmsServices.send#SmsMessage')?.serviceNode?.fileLocation"/><set field="isSmsActive" from="sendSmsLoc && !sendSmsLoc.contains('classpath')"/></actions><widgets><container-row><row-col lg="5"><link url="visitList" text="Visits" parameter-map="[userId:userId]"/><container-dialog id="UpdatePassword" button-text="Change Password"><form-single name="UpdatePasswordForm" transition="updatePassword"><field name="userId"><default-field><hidden/></default-field></field><field name="oldPassword"><default-field><hidden default-value="ignored"/></default-field></field><field name="newPassword"><default-field><password size="20"/></default-field></field><field name="newPasswordVerify"><default-field><password size="20"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></container-dialog><link url="enableUserAccount" text="Enable Account" parameter-map="[userId:userId]" condition="userAccount.disabled == 'Y'"/><link url="disableUserAccount" text="Disable Account" parameter-map="[userId:userId]" condition="userAccount.disabled != 'Y'"/><link url="resetPassword" text="Reset Password" parameter-map="[userId:userAccount.userId]" condition="userAccount.emailAddress" confirmation="Generate reset password and send by email to ${userAccount.emailAddress}?"/><link url="loginAs" text="Login As" confirmation="Login as ${userAccount.username}?" condition="ec.user.hasPermission('ADMIN_LOGIN_AS') && ec.user.username != userAccount.username" parameter-map="[loginAsUsername:userAccount.username]"/><container-dialog id="AuditLogDialog" button-text="Audit Log" width="960"><form-list name="AuditLogList" list="auditLogList" skip-form="true"><entity-find entity-name="moqui.entity.EntityAuditLog" list="auditLogList"><econdition field-name="changedEntityName" value="moqui.security.UserAccount"/><econdition field-name="pkPrimaryValue" from="userId"/><select-field field-name="changedEntityName"/><order-by field-name="-changedDate,pkSecondaryValue"/></entity-find><field name="changedDate"><default-field title="Date"><display/></default-field></field><field name="changedByUserId"><default-field title="User"><display-entity text="${userFullName?:''} [${username?:userId?:''}]" entity-name="moqui.security.UserAccount" key-field-name="userId"/></default-field></field><field name="pkSecondaryValue"><default-field title="Item"><display/></default-field></field><field name="changedFieldName"><default-field title="Field"><display text="${org.moqui.util.StringUtilities.camelCaseToPretty(changedFieldName)}"/></default-field></field><field name="oldValueText"><default-field title="From"><display text="${ec.entity.formatFieldString(changedEntityName, changedFieldName, oldValueText)}"/></default-field></field><field name="newValueText"><default-field title="To"><display text="${ec.entity.formatFieldString(changedEntityName, changedFieldName, newValueText)}"/></default-field></field></form-list></container-dialog><container-dialog id="TopicUserDialog" button-text="Topic Subscriptions"><form-list name="NotificationTopicList" list="notificationTopicList" transition="topicSubscriptions" multi="true"><row-actions><entity-find-one entity-name="moqui.security.user.NotificationTopicUser" value-field="notTopicUser"><field-map field-name="topic"/><field-map field-name="userId"/></entity-find-one></row-actions><field name="userId"><default-field><hidden/></default-field></field><field name="topic"><default-field><hidden/></default-field></field><field name="description"><default-field title="Topic"><display/></default-field></field><field name="receiveNotifications" from="notTopicUser?.receiveNotifications ?: receiveNotifications ?: 'N'"><default-field title="Receive"><radio><option key="Y"/><option key="N"/></radio></default-field></field><field name="allNotifications" from="notTopicUser?.allNotifications ?: allNotifications ?: 'N'"><default-field title="All"><radio><option key="Y"/><option key="N"/></radio></default-field></field><field name="emailNotifications" from="notTopicUser?.emailNotifications ?: emailNotifications ?: 'N'"><conditional-field condition="emailTemplateId" title="Email"><radio><option key="Y"/><option key="N"/></radio></conditional-field><default-field title="Email"><display text=""/></default-field></field><field name="submitButton"><default-field><submit text="Update"/></default-field></field></form-list></container-dialog><form-single name="UserAccountForm" map="userAccount" transition="updateUserAccount"><field name="userId"><default-field><display/></default-field></field><field name="username"><default-field><text-line size="20"/></default-field></field><field name="emailAddress"><default-field title="Email"><text-line size="50"/></default-field></field><field name="userFullName"><default-field title="Full Name"><text-line size="40"/></default-field></field><field name="passwordSetDate"><default-field><display/></default-field></field><field name="requirePasswordChange"><default-field><drop-down allow-empty="true"><option key="Y"/><option key="N"/></drop-down></default-field></field><field name="successiveFailedLogins"><default-field title="Failed Logins"><display/></default-field></field><field name="disabled"><default-field tooltip="Set along with Disabled Date after failed login attempts, auto enabled after configured time if Disabled Date set"><display text="${disabled ?: 'N'}"/></default-field></field><field name="disabledDateTime"><default-field title="Disabled Date"><display/></default-field></field><field name="terminateDate"><default-field tooltip="After this date user may not login and will not receive notifications" red-when="before-now"><date-time/></default-field></field><field name="ipAllowed"><default-field title="IPs Allowed" tooltip="Comma separated IP4 patterns, each may use '*' for wildcard or '-' separated min/max numbers"><text-line size="80"/></default-field></field><field name="locale"><default-field><drop-down allow-empty="true"><list-options list="localeStringList" key="${locale}" text="${locale} - ${name}"/></drop-down></default-field></field><field name="timeZone"><default-field><drop-down allow-empty="true"><list-options list="new TreeSet(TimeZone.getAvailableIDs().collect())"/></drop-down></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></row-col><row-col lg="7"><container-box><box-header title="Groups"/><box-toolbar><container-dialog id="AddGroupMemberDialog" button-text="Add Group"><form-single name="CreateUserGroupMember" transition="createUserGroupMember"><field name="userId"><default-field><hidden/></default-field></field><field name="userGroupId"><default-field title="Group"><drop-down><entity-options key="${userGroupId}" text="UserGroupNameTemplate"><entity-find entity-name="moqui.security.UserGroup"><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="fromDate" from="ec.user.nowTimestamp"><default-field><date-time/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body-nopad><form-list name="UserGroupList" list="ugmList" transition="updateUserGroupMember"><field name="userId"><default-field><hidden/></default-field></field><field name="userGroupId"><default-field title="Group"><display-entity entity-name="moqui.security.UserGroup"/><link url="userGroupDetail" text="${userGroupId}" link-type="anchor"/></default-field></field><field name="fromDate"><header-field show-order-by="true"/><default-field><display/></default-field></field><field name="thruDate"><header-field show-order-by="true"/><default-field><date-time/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-list></box-body-nopad></container-box><container-box><box-header title="Preferences"/><box-toolbar><container-dialog id="AddPreferenceDialog" button-text="Add Existing Preference"><form-single name="CreateUserPreference" transition="createUserPreference"><field name="userId"><default-field><hidden/></default-field></field><field name="preferenceKey"><default-field><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="UserPreferenceKey"/></widget-template-include></default-field></field><field name="preferenceValue"><default-field><text-line size="60"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog><container-dialog id="AddCustomPreferenceDialog" button-text="Add Ad-hoc Preference"><form-single name="CreateCustomUserPreference" transition="createUserPreference"><field name="userId"><default-field><hidden/></default-field></field><field name="preferenceKey"><default-field><text-line size="30"/></default-field></field><field name="preferenceValue"><default-field><text-line size="60"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body-nopad><form-list name="UserPreferenceList" list="upList" transition="updateUserPreference"><row-actions><entity-find-one entity-name="moqui.basic.Enumeration" value-field="keyEnum"><field-map field-name="enumId" from="preferenceKey"/></entity-find-one></row-actions><field name="userId"><default-field><hidden/></default-field></field><field name="preferenceKey"><default-field title="Key"><display text="${keyEnum ? keyEnum.description + ' ' : ''}(${preferenceKey})"/></default-field></field><field name="preferenceValue"><default-field title="Value"><text-line size="30"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field name="deleteButton"><default-field title=""><link url="deleteUserPreference" text=" " icon="fa fa-trash" confirmation="Really remove?"/></default-field></field></form-list></box-body-nopad></container-box><section name="SingleUseCodesDisplay" condition="singleUseCodes"><actions><set field="singleUseCodes1" from="[]"/><set field="singleUseCodes2" from="[]"/><set field="singleUseCodes3" from="[]"/><script><![CDATA[for (int i = 0; i < singleUseCodes.size(); i++) {
                            if (i%3 == 0) { singleUseCodes1.add(singleUseCodes[i]) }
                            else if (i%3 == 1) { singleUseCodes2.add(singleUseCodes[i]) }
                            else if (i%3 == 2) { singleUseCodes3.add(singleUseCodes[i]) }
                        }]]></script></actions><widgets><container-box><box-header><label text="Single Use Codes" style="text-danger" type="h5"/></box-header><box-body><label text="Write down these codes. They will only appear once." style="text-danger"/><container-row><row-col lg="4"><container type="ul"><section-iterate name="SingleUseCodes1" list="singleUseCodes1" entry="code1"><widgets><container type="li"><label text="${code1}" style="text-danger"/></container></widgets></section-iterate></container></row-col><row-col lg="4"><container type="ul"><section-iterate name="SingleUseCodes2" list="singleUseCodes2" entry="code2"><widgets><container type="li"><label text="${code2}" style="text-danger"/></container></widgets></section-iterate></container></row-col><row-col lg="4"><container type="ul"><section-iterate name="SingleUseCodes3" list="singleUseCodes3" entry="code3"><widgets><container type="li"><label text="${code3}" style="text-danger"/></container></widgets></section-iterate></container></row-col></container-row></box-body></container-box></widgets></section><container-box><box-header title="Authentication Methods"/><box-toolbar><container-dialog id="CreateTotpDialog" button-text="Add Authenticator App"><form-single name="CreateUserAuthcFactorTotp" transition="createUserAuthcFactorTotp"><field name="userId"><default-field><hidden/></default-field></field><field name="thruDate" from="ec.user.nowTimestamp + 365"><default-field><date-time/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog><container-dialog id="AddSingleUseDialog" button-text="Add Single Use Codes"><form-single name="CreateUserAuthcFactorSingleUse" transition="createUserAuthcFactorSingleUse"><field name="userId"><default-field><hidden/></default-field></field><field name="fromDate" from="ec.user.nowTimestamp + 365"><default-field><date-time/></default-field></field><field name="numberOfCodes"><default-field title="Number of Codes"><text-line size="5" default-value="1"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog><container-dialog id="AddEmailFactor" button-text="Add Email Factor"><form-single name="CreateUserAuthcFactorEmail" transition="createUserAuthcFactorEmail"><field name="userId"><default-field><hidden/></default-field></field><field name="thruDate" from="ec.user.nowTimestamp + 365"><default-field><date-time/></default-field></field><field name="factorOption" from="userAccount.emailAddress"><default-field title="Email"><text-line size="40"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog><container-dialog id="AddSmsFactor" button-text="Add SMS Factor" condition="isSmsActive"><form-single name="CreateUserAuthcFactorSms" transition="createUserAuthcFactorSms"><field name="userId"><default-field><hidden/></default-field></field><field name="thruDate" from="ec.user.nowTimestamp + 365"><default-field><date-time/></default-field></field><field name="factorOption"><default-field title="Phone (for SMS)"><text-line size="15"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body-nopad><form-list name="UserAuthcFactorList" list="userAuthcFactorList" transition="factorSubmit"><entity-find entity-name="moqui.security.UserAuthcFactor" list="userAuthcFactorList"><date-filter/><econdition field-name="userId"/><select-field field-name="factorTypeEnumId,factorOption"/></entity-find><field name="userId" from="userId"><default-field><hidden/></default-field></field><field name="factorId"><header-field title="ID" show-order-by="true"/><default-field><display/></default-field></field><field name="fromFactorId"><header-field title="From ID"/><default-field><display/></default-field></field><field name="factorTypeEnumId"><header-field title="Factor Type"/><default-field><display-entity entity-name="moqui.basic.Enumeration" text="${description}"/></default-field></field><field name="fromDate"><default-field><display/></default-field></field><field name="thruDate"><default-field><display/></default-field></field><field name="action"><conditional-field condition="needsValidation == 'Y' && factorTypeEnumId == 'UafTotp'"><dynamic-dialog id="VerifyTotpDialog" button-text="Verify" transition="VerifyTotp" parameter-map="[userId:userId, factorId:factorId, verify:true]"/></conditional-field><conditional-field condition="needsValidation == 'N' && factorTypeEnumId == 'UafTotp'"><dynamic-dialog id="ViewTotpDialog" button-text="View" transition="VerifyTotp" parameter-map="[userId:userId, factorId:factorId, verify:true]"/></conditional-field><conditional-field condition="needsValidation == 'Y' && factorTypeEnumId == 'UafEmail'"><dynamic-dialog id="VerifyEmailDialog" button-text="Verify" transition="VerifyEmail" parameter-map="[userId:userId, factorId:factorId]"/></conditional-field><conditional-field condition="needsValidation == 'Y' && factorTypeEnumId == 'UafSms'"><dynamic-dialog id="VerifySmsDialog" button-text="Verify" transition="VerifySms" parameter-map="[userId:userId, factorId:factorId]"/></conditional-field><conditional-field condition="needsValidation == 'N' && factorTypeEnumId in ['UafEmail', 'UafSms']"><label text="${factorOption}"/></conditional-field></field><field name="needsValidation"><conditional-field condition="factorTypeEnumId != 'UafSingleUse'"><label text="${needsValidation}"/></conditional-field></field><field name="delete"><default-field title=" "><submit text=" " icon="fa fa-trash"/></default-field></field></form-list></box-body-nopad></container-box><label text="Login History" type="h5"/><form-list name="HistoryList" list="historyList" skip-form="true"><field name="fromDate"><header-field title="Date" show-order-by="true"/><default-field><display/></default-field></field><field name="successfulLogin"><default-field title="Successful"><display/></default-field></field><field name="visitId"><default-field title="Visit"><link url="visitDetail" text="${visitId}" link-type="anchor" condition="visitId"/></default-field></field></form-list></row-col></container-row><label text="Tarpit Locks (Velocity Limits Reached)" type="h5"/><label text="Showing ${artifactTarpitLockList?.size() ?: ''} most recent, user has a history of ${allTarpitLocksCount} locks"/><form-list name="ArtifactTarpitLockList" list="artifactTarpitLockList"><field name="artifactTypeEnumId"><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="artifactName"><default-field><display/></default-field></field><field name="releaseDateTime"><default-field><display/></default-field></field><field name="releaseNow"><default-field><link url="releaseTarpitNow" text="Release Now" parameter-map="[artifactTarpitLockId:artifactTarpitLockId]" condition="releaseDateTime > ec.user.nowTimestamp"/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://tools/screen/System/Security/UserAccount.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Users" default-menu-index="1"><subscreens default-item="UserAccountList"/><widgets><subscreens-active/></widgets></screen>
<!-- Screen Location component://tools/screen/System/Security/UserGroup/UserGroupList.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="userGroupDetail"><default-response url="../UserGroupDetail"/></transition><transition name="createUserGroup"><service-call name="create#moqui.security.UserGroup" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><entity-find entity-name="moqui.security.UserGroup" list="userGroupList"><search-form-inputs default-order-by="username"/></entity-find></actions><widgets><container-dialog id="CreateUserGroupDialog" button-text="Create User Group"><form-single name="CreateUserGroup" transition="createUserGroup"><field name="userGroupId"><default-field><text-line size="20"/></default-field></field><field name="description"><default-field><text-line size="60"/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="UserGroupList" list="userGroupList" skip-form="true"><field name="userGroupId"><header-field title="Group ID" show-order-by="true"><text-find size="10" hide-options="true"/></header-field><default-field><link text="${userGroupId}" url="userGroupDetail" link-type="anchor"/></default-field></field><field name="groupTypeEnumId"><header-field title="Group Type" show-order-by="true"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="UserGroupType"/><set field="allowEmpty" value="true"/></widget-template-include></header-field><default-field><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="description"><header-field show-order-by="true"><text-find size="20" hide-options="true"/></header-field><default-field><display/></default-field></field><field name="find"><header-field title="Find"><submit/></header-field><default-field><display text=" "/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://tools/screen/System/Security/UserGroup/UserGroupDetail.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-index="1"><parameter name="userGroupId" required="true"/><transition name="updateUserGroup"><service-call name="update#moqui.security.UserGroup" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createUserPermission"><service-call name="create#moqui.security.UserPermission" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createUserGroupPermission"><service-call name="create#moqui.security.UserGroupPermission" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateUserGroupPermission"><service-call name="update#moqui.security.UserGroupPermission" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteUserGroupPermission"><service-call name="delete#moqui.security.UserGroupPermission" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createUserGroupPreference"><service-call name="create#moqui.security.UserGroupPreference" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateUserGroupPreference"><service-call name="update#moqui.security.UserGroupPreference" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteUserGroupPreference"><service-call name="delete#moqui.security.UserGroupPreference" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="artifactGroupDetail"><default-response url="../../ArtifactGroup/ArtifactGroupDetail"/></transition><transition name="createArtifactAuthz"><service-call name="create#moqui.security.ArtifactAuthz" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateArtifactAuthz"><service-call name="update#moqui.security.ArtifactAuthz" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteArtifactAuthz"><service-call name="delete#moqui.security.ArtifactAuthz" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createArtifactTarpit"><service-call name="create#moqui.security.ArtifactTarpit" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateArtifactTarpit"><service-call name="update#moqui.security.ArtifactTarpit" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteArtifactTarpit"><service-call name="delete#moqui.security.ArtifactTarpit" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><entity-find-one entity-name="moqui.security.UserGroup" value-field="userGroup"/><entity-find entity-name="moqui.security.UserGroupPermission" list="ugPermList"><econdition field-name="userGroupId"/><order-by field-name="userPermissionId"/></entity-find><entity-find entity-name="moqui.security.UserGroupPreference" list="ugPrefList"><econdition field-name="userGroupId"/><order-by field-name="preferenceKey"/></entity-find><entity-find entity-name="moqui.security.ArtifactAuthz" list="authzList"><econdition field-name="userGroupId"/><order-by field-name="artifactGroupId,authzTypeEnumId"/></entity-find><entity-find entity-name="moqui.security.ArtifactTarpit" list="tarpitList"><econdition field-name="userGroupId"/><order-by field-name="artifactGroupId"/></entity-find></actions><widgets><container-row><row-col lg="6"><form-single name="UserGroupForm" map="userGroup" transition="updateUserGroup"><field name="userGroupId"><default-field><display/></default-field></field><field name="description"><default-field><text-line size="40"/></default-field></field><field name="groupTypeEnumId"><default-field title="Group Type"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="UserGroupType"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="ipAllowed"><default-field title="IPs Allowed" tooltip="Comma separated IP4 patterns, each may use '*' for wildcard or '-' separated min/max numbers"><text-line size="80"/></default-field></field><field name="requireAuthcFactor"><default-field title="Require Authc Factor"><radio no-current-selected-key="N"><option key="Y"/><option key="N"/></radio></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single><container-box><box-header title="Permissions"/><box-toolbar><container-dialog id="AddAdHocPermissionDialog" button-text="Apply Ad-hoc Permission"><form-single name="CreateAdHocUserGroupPermission" transition="createUserGroupPermission"><field name="userGroupId"><default-field><hidden/></default-field></field><field name="userPermissionId"><default-field title="Permission"><text-line size="30"/></default-field></field><field name="fromDate" from="ec.user.nowTimestamp"><default-field><date-time/></default-field></field><field name="thruDate"><default-field><date-time/></default-field></field><field name="submitButton"><default-field title="Apply"><submit/></default-field></field></form-single></container-dialog><container-dialog id="AddExistingPermissionDialog" button-text="Apply Existing Permission"><form-single name="CreateExistingUserGroupPermission" transition="createUserGroupPermission"><field name="userGroupId"><default-field><hidden/></default-field></field><field name="userPermissionId"><default-field title="Permission"><drop-down><entity-options key="${userPermissionId}" text="${userPermissionId} - ${description}"><entity-find entity-name="moqui.security.UserPermission"><order-by field-name="userPermissionId"/></entity-find></entity-options></drop-down></default-field></field><field name="fromDate" from="ec.user.nowTimestamp"><default-field><date-time/></default-field></field><field name="thruDate"><default-field><date-time/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog><container-dialog id="AddUserPermissionDialog" button-text="New Permission"><form-single name="CreateUserPermission" transition="createUserPermission"><field name="userGroupId"><default-field><hidden/></default-field></field><field name="userPermissionId"><default-field title="Permission ID"><text-line size="30"/></default-field></field><field name="description"><default-field><text-line size="60"/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="UserGroupPermissionList" list="ugPermList" transition="updateUserGroupPermission"><row-actions><entity-find-one entity-name="moqui.security.UserPermission" value-field="userPermission"/></row-actions><field name="userGroupId"><default-field><hidden/></default-field></field><field name="userPermissionId"><default-field title="Permission ID"><display text="${userPermissionId} - ${userPermission?.description ?: '(ad-hoc)'}"/></default-field></field><field name="fromDate"><default-field><display/></default-field></field><field name="thruDate"><default-field><date-time/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field name="deleteButton"><default-field title=""><link url="deleteUserGroupPermission" text=" " icon="fa fa-trash" confirmation="Really remove?"/></default-field></field></form-list></box-body></container-box></row-col><row-col lg="6"><container-box><box-header title="Preferences"/><box-toolbar><container-dialog id="AddPreferenceDialog" button-text="Add Existing Preference"><form-single name="CreateUserPreference" transition="createUserGroupPreference"><field name="userGroupId"><default-field><hidden/></default-field></field><field name="preferenceKey"><default-field><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="UserPreferenceKey"/></widget-template-include></default-field></field><field name="preferenceValue"><default-field><text-line size="60"/></default-field></field><field name="groupPriority"><default-field><text-line size="5"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog><container-dialog id="AddCustomPreferenceDialog" button-text="Add Ad-hoc Preference"><form-single name="CreateCustomUserGroupPreference" transition="createUserGroupPreference"><field name="userGroupId"><default-field><hidden/></default-field></field><field name="preferenceKey"><default-field><text-line size="30"/></default-field></field><field name="preferenceValue"><default-field><text-line size="60"/></default-field></field><field name="groupPriority"><default-field><text-line size="5"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="UserGroupPreferenceList" list="ugPrefList" transition="updateUserGroupPreference"><row-actions><entity-find-one entity-name="moqui.basic.Enumeration" value-field="keyEnum"><field-map field-name="enumId" from="preferenceKey"/></entity-find-one></row-actions><field name="userGroupId"><default-field><hidden/></default-field></field><field name="preferenceKey"><default-field title="Key"><display text="${keyEnum ? keyEnum.description + ' ' : ''}(${preferenceKey})"/></default-field></field><field name="preferenceValue"><default-field title="Value"><text-line size="30"/></default-field></field><field name="groupPriority"><default-field><text-line size="5"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field name="deleteButton"><default-field title=""><link url="deleteUserGroupPreference" text=" " icon="fa fa-trash" confirmation="Really remove?"/></default-field></field></form-list></box-body></container-box></row-col></container-row><container-box><box-header title="Authorizations"/><box-toolbar><container-dialog id="AddAuthzDialog" button-text="Add Authorization"><form-single name="CreateArtifactAuthz" transition="createArtifactAuthz" extends="component://tools/screen/System/Security/ArtifactGroup/ArtifactGroupDetail.xml#CreateArtifactAuthz"><field name="userGroupId"><default-field><hidden/></default-field></field><field name="artifactGroupId"><default-field title="Artifact Group"><drop-down><entity-options key="${artifactGroupId}" text="${description} [${artifactGroupId}]"><entity-find entity-name="moqui.security.ArtifactGroup"><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="ArtifactAuthzList" list="authzList" transition="updateArtifactAuthz" extends="component://tools/screen/System/Security/ArtifactGroup/ArtifactGroupDetail.xml#ArtifactAuthzList"><field name="userGroupId"><default-field><hidden/></default-field></field><field name="artifactGroupId"><default-field title="Artifact Group"><display-entity entity-name="moqui.security.ArtifactGroup" text="${description ?: ''} - "/><link url="artifactGroupDetail" text="${artifactGroupId}" link-type="anchor"/></default-field></field></form-list></box-body></container-box><container-box><box-header title="Tarpits (Use Velocity Limits)"/><box-toolbar><container-dialog id="AddTarpitDialog" button-text="Add Tarpit"><form-single name="CreateArtifactTarpit" transition="createArtifactTarpit" extends="component://tools/screen/System/Security/ArtifactGroup/ArtifactGroupDetail.xml#CreateArtifactTarpit"><field name="userGroupId"><default-field><hidden/></default-field></field><field name="artifactGroupId"><default-field title="Artifact Group"><drop-down><entity-options key="${artifactGroupId}" text="${description} [${artifactGroupId}]"><entity-find entity-name="moqui.security.ArtifactGroup"><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="ArtifactTarpitList" list="tarpitList" transition="updateArtifactTarpit" extends="component://tools/screen/System/Security/ArtifactGroup/ArtifactGroupDetail.xml#ArtifactTarpitList"><field name="userGroupId"><default-field><hidden/></default-field></field><field name="artifactGroupId"><default-field title="Artifact Group"><display-entity entity-name="moqui.security.ArtifactGroup" text="${description ?: ''} - "/><link url="artifactGroupDetail" text="${artifactGroupId}" link-type="anchor"/></default-field></field></form-list></box-body></container-box></widgets></screen>
<!-- Screen Location component://tools/screen/System/Security/UserGroup/GroupUsers.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-index="2"><parameter name="userGroupId" required="true"/><transition name="userAccountDetail"><default-response url="../../UserAccount/UserAccountDetail"/></transition><transition name="createUserGroupMember"><service-call name="create#moqui.security.UserGroupMember" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateUserGroupMember"><service-call name="update#moqui.security.UserGroupMember" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="getUserList"><actions><entity-find entity-name="moqui.security.UserAccount" list="userList" limit="20"><econditions combine="or"><econdition field-name="userId" operator="like" value="%${term}%" ignore-case="true"/><econdition field-name="username" operator="like" value="%${term}%" ignore-case="true"/><econdition field-name="userFullName" operator="like" value="%${term}%" ignore-case="true"/></econditions><order-by field-name="username"/></entity-find><script><![CDATA[def outList = []
                for (def user in userList)
                    outList.add([value:user.userId, label:"${user.username?:''} ${user.userFullName?:''} [${user.userId}]".toString()])
                ec.web.sendJsonResponse(outList)]]></script></actions><default-response type="none"/></transition><actions><entity-find entity-name="moqui.security.UserGroupMember" list="ugmList"><search-form-inputs default-order-by="userId"/><econdition field-name="userGroupId"/></entity-find></actions><widgets><container-dialog id="AddGroupMemberDialog" button-text="Add User"><form-single name="CreateUserGroupMember" transition="createUserGroupMember"><field name="userGroupId"><default-field><hidden/></default-field></field><field name="userId"><default-field title="User"><drop-down><dynamic-options transition="getUserList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="fromDate" from="ec.user.nowTimestamp"><default-field><date-time/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog><form-list name="UserGroupList" list="ugmList" transition="updateUserGroupMember"><field name="userGroupId"><default-field><hidden/></default-field></field><field name="userId"><header-field title="User Account" show-order-by="true"/><default-field><display-entity entity-name="moqui.security.UserAccount" text="${username} - ${userFullName}"/><link url="userAccountDetail" text="${userId}" link-type="anchor"/></default-field></field><field name="fromDate"><header-field show-order-by="true"/><default-field><display/></default-field></field><field name="thruDate"><header-field show-order-by="true"/><default-field><date-time/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://tools/screen/System/Security/UserGroup.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="User Groups" default-menu-index="2"><subscreens default-item="UserGroupList"/><widgets><subscreens-panel id="UserGroupPanel" type="tab"/></widgets></screen>
<!-- Screen Location component://tools/screen/System/Security/ArtifactGroup/ArtifactGroupList.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="artifactGroupDetail"><default-response url="../ArtifactGroupDetail"/></transition><transition name="createArtifactGroup"><service-call name="create#moqui.security.ArtifactGroup" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><entity-find entity-name="moqui.security.ArtifactGroup" list="artifactGroupList"><search-form-inputs default-order-by="description"/></entity-find></actions><widgets><container-dialog id="CreateArtifactGroupDialog" button-text="Create Artifact Group"><form-single name="CreateArtifactGroup" transition="createArtifactGroup"><field name="artifactGroupId"><default-field><text-line size="20"/></default-field></field><field name="description"><default-field><text-line size="60"/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="ArtifactGroupList" list="artifactGroupList" skip-form="true"><field name="artifactGroupId"><header-field title="Group ID" show-order-by="true"><text-find size="10" hide-options="true"/></header-field><default-field><link text="${artifactGroupId}" url="artifactGroupDetail" link-type="anchor"/></default-field></field><field name="description"><header-field show-order-by="true"><text-find size="20" hide-options="true"/></header-field><default-field><display/></default-field></field><field name="find"><header-field title="Find"><submit/></header-field><default-field><display text=" "/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://tools/screen/System/Security/ArtifactGroup/ArtifactGroupDetail.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-index="1"><parameter name="artifactGroupId" required="true"/><transition name="updateArtifactGroup"><service-call name="update#moqui.security.ArtifactGroup" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createArtifactGroupMember"><service-call name="create#moqui.security.ArtifactGroupMember" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateArtifactGroupMember"><service-call name="update#moqui.security.ArtifactGroupMember" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteArtifactGroupMember"><service-call name="delete#moqui.security.ArtifactGroupMember" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="userGroupDetail"><default-response url="../../UserGroup/UserGroupDetail"/></transition><transition name="createArtifactAuthz"><service-call name="create#moqui.security.ArtifactAuthz" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateArtifactAuthz"><service-call name="update#moqui.security.ArtifactAuthz" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteArtifactAuthz"><service-call name="delete#moqui.security.ArtifactAuthz" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createArtifactTarpit"><service-call name="create#moqui.security.ArtifactTarpit" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateArtifactTarpit"><service-call name="update#moqui.security.ArtifactTarpit" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteArtifactTarpit"><service-call name="delete#moqui.security.ArtifactTarpit" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><entity-find-one entity-name="moqui.security.ArtifactGroup" value-field="artifactGroup"/><entity-find entity-name="moqui.security.ArtifactGroupMember" list="memberList"><econdition field-name="artifactGroupId"/><order-by field-name="preferenceKey"/></entity-find><entity-find entity-name="moqui.security.ArtifactAuthz" list="authzList"><econdition field-name="artifactGroupId"/><order-by field-name="userGroupId,authzTypeEnumId"/></entity-find><entity-find entity-name="moqui.security.ArtifactTarpit" list="tarpitList"><econdition field-name="artifactGroupId"/><order-by field-name="userGroupId"/></entity-find></actions><widgets><form-single name="ArtifactGroupForm" map="artifactGroup" transition="updateArtifactGroup"><field name="artifactGroupId"><default-field><display/></default-field></field><field name="description"><default-field><text-line size="40"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single><container-box><box-header title="Artifact Members"/><box-toolbar><container-dialog id="AddMemberDialog" button-text="Add Any Artifact/Pattern"><form-single name="CreateArtifactGroupMember" transition="createArtifactGroupMember"><field name="artifactGroupId"><default-field><hidden/></default-field></field><field name="artifactTypeEnumId"><default-field title="Artifact Type"><drop-down><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="ArtifactType"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="artifactName"><default-field><text-line size="60"/></default-field></field><field name="nameIsPattern"><default-field><drop-down><option key="N"/><option key="Y"/></drop-down></default-field></field><field name="inheritAuthz"><default-field><drop-down><option key="N"/><option key="Y"/></drop-down></default-field></field><field name="filterMap"><default-field title="Filter Map" tooltip="Groovy expression that evaluates to a Map"><text-line size="60"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="ArtifactGroupMemberList" list="memberList" transition="updateArtifactGroupMember"><field name="artifactGroupId"><default-field><hidden/></default-field></field><field name="artifactTypeEnumId"><default-field title="Artifact Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="artifactName"><default-field><display/></default-field></field><field name="nameIsPattern"><default-field><drop-down><option key="N"/><option key="Y"/></drop-down></default-field></field><field name="inheritAuthz"><default-field><drop-down><option key="N"/><option key="Y"/></drop-down></default-field></field><field name="filterMap"><default-field title="Filter Map" tooltip="Groovy expression that evaluates to a Map"><text-line size="30"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field name="deleteLink"><default-field title=""><link url="deleteArtifactGroupMember" text=" " icon="fa fa-trash" confirmation="Really Delete?" parameter-map="[artifactGroupId:artifactGroupId, artifactName:artifactName, artifactTypeEnumId:artifactTypeEnumId]"/></default-field></field></form-list></box-body></container-box><container-box><box-header title="Authorizations"/><box-toolbar><container-dialog id="AddAuthzDialog" button-text="Add Authorization"><form-single name="CreateArtifactAuthz" transition="createArtifactAuthz"><field name="artifactGroupId"><default-field><hidden/></default-field></field><field name="userGroupId"><default-field title="User Group"><drop-down><entity-options key="${userGroupId}" text="UserGroupNameTemplate"><entity-find entity-name="moqui.security.UserGroup"><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="authzTypeEnumId"><default-field title="Authz Type"><drop-down><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="AuthzType"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="authzActionEnumId"><default-field title="Action"><drop-down><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="AuthzAction"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="authzServiceName"><default-field><text-line size="60"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="ArtifactAuthzList" list="authzList" transition="updateArtifactAuthz"><row-actions><entity-find entity-name="moqui.security.ArtifactAuthzFilterAndSet" list="entityFilterSetList"><econdition field-name="artifactAuthzId"/></entity-find></row-actions><field name="artifactAuthzId"><default-field title="ID"><display/></default-field></field><field name="artifactGroupId"><default-field><hidden/></default-field></field><field name="userGroupId"><default-field title="User Group"><display-entity entity-name="moqui.security.UserGroup" text="${description ?: ''} - "/><link url="userGroupDetail" text="${userGroupId}" link-type="anchor"/></default-field></field><field name="authzTypeEnumId"><default-field title="Authz Type"><drop-down><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="AuthzType"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="authzActionEnumId"><default-field title="Action"><drop-down><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="AuthzAction"/><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="authzServiceName"><default-field><text-line size="30"/></default-field></field><field name="entityFilterSets"><default-field><section-iterate name="EntityFilterSetSection" list="entityFilterSetList" entry="entityFilterSet"><widgets><label text="${entityFilterSet.description}"/><label text="Authz Cond: ${entityFilterSet.authzApplyCond}" condition="entityFilterSet.authzApplyCond" type="div"/><label text="Filter Cond: ${entityFilterSet.applyCond}" condition="entityFilterSet.applyCond" type="div"/></widgets></section-iterate></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field name="deleteLink"><default-field title=""><link url="deleteArtifactAuthz" text=" " icon="fa fa-trash" confirmation="Really Delete?" parameter-map="[artifactAuthzId:artifactAuthzId]"/></default-field></field></form-list></box-body></container-box><container-box><box-header title="Tarpits (Use Velocity Limits)"/><box-toolbar><container-dialog id="AddTarpitDialog" button-text="Add Tarpit"><form-single name="CreateArtifactTarpit" transition="createArtifactTarpit"><field name="artifactGroupId"><default-field><hidden/></default-field></field><field name="userGroupId"><default-field title="User Group"><drop-down><entity-options key="${userGroupId}" text="UserGroupNameTemplate"><entity-find entity-name="moqui.security.UserGroup"><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="maxHitsCount"><default-field><text-line size="8"/></default-field></field><field name="maxHitsDuration"><default-field tooltip="In seconds"><text-line size="8"/></default-field></field><field name="tarpitDuration"><default-field tooltip="In seconds"><text-line size="8"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="ArtifactTarpitList" list="tarpitList" transition="updateArtifactTarpit"><field name="artifactGroupId"><default-field><hidden/></default-field></field><field name="userGroupId"><default-field title="User Group"><display-entity entity-name="moqui.security.UserGroup" text="${description ?: ''} - "/><link url="userGroupDetail" text="${userGroupId}" link-type="anchor"/></default-field></field><field name="maxHitsCount"><default-field><text-line size="8"/></default-field></field><field name="maxHitsDuration"><default-field tooltip="In seconds"><text-line size="8"/></default-field></field><field name="tarpitDuration"><default-field tooltip="In seconds"><text-line size="8"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field name="deleteLink"><default-field title=""><link url="deleteArtifactTarpit" text=" " icon="fa fa-trash" confirmation="Really Delete?" parameter-map="[artifactGroupId:artifactGroupId, userGroupId:userGroupId]"/></default-field></field></form-list></box-body></container-box></widgets></screen>
<!-- Screen Location component://tools/screen/System/Security/ArtifactGroup.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Artifact Groups" default-menu-index="3"><subscreens default-item="ArtifactGroupList"/><widgets><subscreens-active/></widgets></screen>
<!-- Screen Location component://tools/screen/System/Security/ActiveUsers.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Active Users" default-menu-index="5"><transition name="userAccountDetail"><default-response url="//system/Security/UserAccountDetail"/></transition><actions><entity-find entity-name="moqui.server.VisitUserSummary" list="visitUserList"><search-form-inputs default-order-by="-visitCount"><default-parameters fromDate_poffset="-1" fromDate_period="30d"/></search-form-inputs><select-field field-name="userId,visitCount,fromDateMin,fromDateMax"/></entity-find></actions><widgets><form-list name="VisitUserList" list="visitUserList" skip-form="true" header-dialog="true" show-page-size="true" show-csv-button="true" show-xlsx-button="true" saved-finds="true"><field name="fromDate"><header-field show-order-by="true"><date-period/></header-field></field><field name="fromDateMin"><default-field><display/></default-field></field><field name="fromDateMax"><default-field><display/></default-field></field><field name="userId"><header-field show-order-by="true"><text-find size="20" default-operator="begins"/></header-field><default-field><display/><link url="userAccountDetail" text="UsernameTemplate" link-type="anchor" entity-name="moqui.security.UserAccount"/></default-field></field><field name="visitCount"><header-field show-order-by="true"><range-find size="6"/></header-field><default-field><display/></default-field></field><field name="find"><header-field><submit text="Find"/></header-field><default-field><display text=" "/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://tools/screen/System/Security.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-index="12"><subscreens default-item="UserAccount"/><widgets><subscreens-panel id="SecurityPanel" type="popup"/></widgets></screen>
<!-- Screen Location component://tools/screen/System/ServiceJob/Jobs/ServiceJobList.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="serviceJobDetail"><default-response url="../ServiceJobDetail"/></transition><actions><set field="jobRunner" from="ec.service.getJobRunner()"/><entity-find-count entity-name="moqui.service.message.SystemMessage" count-field="outgoingCount"><econdition field-name="statusId" value="SmsgProduced"/><econdition field-name="isOutgoing" value="Y"/></entity-find-count><entity-find-count entity-name="moqui.service.message.SystemMessage" count-field="incomingCount"><econdition field-name="statusId" value="SmsgReceived"/><econdition field-name="isOutgoing" value="N"/></entity-find-count><entity-find-count entity-name="moqui.service.message.SystemMessage" count-field="errorCount"><econdition field-name="statusId" value="SmsgError"/></entity-find-count></actions><widgets><section name="JobRunnerInfo" condition="jobRunner"><widgets><label text="Last job runner execute: <strong>${new Timestamp(jobRunner.getLastExecuteTime())}</strong>, runner executes: ${jobRunner.getExecuteCount()}, total jobs run: ${jobRunner.getTotalJobsRun()}, last active: ${jobRunner.getLastJobsActive()}, last paused: ${jobRunner.getLastJobsPaused()}" encode="false"/></widgets><fail-widgets><label text="No Service Job Runner active (generally because scheduled-job-check-time is set to 0)"/></fail-widgets></section><form-list name="ServiceJobList" list="serviceJobList" skip-form="true" show-page-size="true"><entity-find entity-name="moqui.service.job.ServiceJob" list="serviceJobList"><search-form-inputs default-order-by="^jobName"/></entity-find><field name="jobName"><header-field show-order-by="case-insensitive"><text-find hide-options="true" size="20"/></header-field><default-field><link text="${jobName}" url="serviceJobDetail" link-type="anchor"/></default-field></field><field name="description"><header-field show-order-by="true"><text-find hide-options="true" size="30"/></header-field><default-field><display/></default-field></field><field name="topic"><header-field show-order-by="true"><text-find hide-options="true" size="15"/></header-field><default-field><display/></default-field></field><field name="cronExpression"><header-field show-order-by="true"><text-find hide-options="true" size="15"/></header-field><default-field><display/></default-field></field><field name="paused"><header-field><drop-down allow-empty="true"><option key="Y"/><option key="N"/></drop-down></header-field><default-field><display/></default-field></field><field name="priority"><header-field show-order-by="true"/><default-field><display/></default-field></field><field name="findButton"><header-field title="Find"><submit/></header-field><default-field><display text=" "/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://tools/screen/System/ServiceJob/Jobs/ServiceJobDetail.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Job Detail" default-menu-index="1"><parameter name="jobName" required="true"/><transition name="jobRunList"><default-response url="../../JobRuns/JobRunList"/></transition><transition name="jobRunDetail"><default-response url="../../JobRuns/JobRunDetail"/></transition><transition name="updateJob"><service-call name="update#moqui.service.job.ServiceJob" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createJobParameter"><service-call name="create#moqui.service.job.ServiceJobParameter" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateJobParameter"><service-call name="update#moqui.service.job.ServiceJobParameter" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteJobParameter"><service-call name="delete#moqui.service.job.ServiceJobParameter" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="userAccountDetail"><default-response url="../../Security/UserAccount/UserAccountDetail"/></transition><transition name="createJobUser"><service-call name="create#moqui.service.job.ServiceJobUser" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateJobUser"><service-call name="update#moqui.service.job.ServiceJobUser" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteJobUser"><service-call name="delete#moqui.service.job.ServiceJobUser" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition-include name="getUserList" location="component://tools/screen/System/Security/UserGroup/GroupUsers.xml"/><transition name="runJob"><actions><script><![CDATA[ec.service.job(jobName).run()]]></script></actions><default-response url="."/></transition><actions><entity-find-one entity-name="moqui.service.job.ServiceJob" value-field="serviceJob"/><entity-find-one entity-name="moqui.service.job.ServiceJobRunLock" value-field="runLock"/><entity-find entity-name="moqui.service.job.ServiceJobParameter" list="jobParameterList"><econdition field-name="jobName"/><order-by field-name="parameterName"/></entity-find><entity-find entity-name="moqui.service.job.ServiceJobUserDetail" list="userDetailList"><econdition field-name="jobName"/><order-by field-name="username"/></entity-find></actions><widgets><container-row><row-col md="6"><container-box><box-header title="Job Run Info"/><box-toolbar><link url="runJob" text="Run Job" confirmation="Run job now with current parameters?"/><link url="jobRunList" text="Job Runs" parameter-map="[jobName:jobName]"/></box-toolbar><box-body><container-row><row-col md="2"><label text="Last Run" type="strong"/></row-col><row-col md="4"><label text="${ec.l10n.format(runLock?.lastRunTime, '')}"/></row-col></container-row><section name="ActiveJobSection" condition="runLock?.jobRunId"><widgets><container-row><row-col md="2"><label text="Active Job" type="strong"/></row-col><row-col md="4"><link url="jobRunDetail" text="${runLock.jobRunId}" link-type="anchor" parameter-map="[jobRunId:runLock.jobRunId]"/></row-col></container-row></widgets><fail-widgets/></section></box-body></container-box><container-box><box-header title="Job Settings"/><box-body><form-single name="ServiceJobForm" map="serviceJob" transition="updateJob"><field name="jobName"><default-field><display/></default-field></field><auto-fields-entity entity-name="moqui.service.job.ServiceJob" field-type="edit" include="nonpk"/><field name="description"><default-field><text-line size="60"/></default-field></field><field name="serviceName"><default-field><text-line size="60"/></default-field></field><field name="expireLockTime"><default-field title="Expire Lock Minutes" tooltip="After this time job run locks are ignored, defaults to 1440 minutes (24 hours)"><text-line size="4"/></default-field></field><field name="minRetryTime"><default-field title="Min Retry Minutes" tooltip="Min time to retry after error, defaults to 5 minutes"><text-line size="4"/></default-field></field><field name="priority"><default-field tooltip="Lower numbers run first (ascending sort)"><text-line size="4"/></default-field></field><field name="submitButton"><default-field title="Update Job"><submit/></default-field></field><field-layout><field-ref name="jobName"/><field-ref name="description"/><field-ref name="serviceName"/><fields-not-referenced/></field-layout></form-single></box-body></container-box></row-col><row-col md="6"><container-box><box-header title="Parameters"/><box-toolbar><container-dialog id="AddParameterDialog" button-text="Add Parameter"><form-single name="CreateJobParameter" transition="createJobParameter"><field name="jobName"><default-field><hidden/></default-field></field><field name="parameterName"><default-field title="Name"><text-line size="30"/></default-field></field><field name="parameterValue"><default-field title="Value"><text-line size="60"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="UpdateJobParameter" transition="updateJobParameter" list="jobParameterList"><field name="jobName"><default-field><hidden/></default-field></field><field name="parameterName"><default-field title="Name"><display/></default-field></field><field name="parameterValue"><default-field title="Value"><text-line size="40"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field name="deleteLink"><default-field title=""><link url="deleteJobParameter" text="X" confirmation="Delete parameter?" parameter-map="[jobName:jobName, parameterName:parameterName]"/></default-field></field></form-list></box-body></container-box><container-box><box-header title="Users"/><box-toolbar><container-dialog id="AddUserDialog" button-text="Add User"><form-single name="CreateJobUser" transition="createJobUser"><field name="jobName"><default-field><hidden/></default-field></field><field name="userId"><default-field title="User"><drop-down><dynamic-options transition="getUserList" server-search="true" min-length="2"/></drop-down></default-field></field><field name="receiveNotifications"><default-field><drop-down><option key="Y"/><option key="N"/></drop-down></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><form-list name="UpdateJobUser" transition="updateJobUser" list="userDetailList"><field name="jobName"><default-field><hidden/></default-field></field><field name="userId"><default-field title="User Account"><display-entity entity-name="moqui.security.UserAccount" text="${username} - ${userFullName}"/><link url="userAccountDetail" text="${userId}" link-type="anchor"/></default-field></field><field name="receiveNotifications"><default-field><drop-down><option key="Y"/><option key="N"/></drop-down></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field name="deleteLink"><default-field title=""><link url="deleteJobUser" text="X" confirmation="Remove user?" parameter-map="[jobName:jobName, userId:userId]"/></default-field></field></form-list></box-body></container-box></row-col></container-row></widgets></screen>
<!-- Screen Location component://tools/screen/System/ServiceJob/Jobs.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Jobs" default-menu-index="1"><subscreens default-item="ServiceJobList"/><widgets><subscreens-panel id="JobsPanel" type="tab"/></widgets></screen>
<!-- Screen Location component://tools/screen/System/ServiceJob/JobRuns/JobRunList.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="jobRunDetail"><default-response url="../JobRunDetail"/></transition><transition name="serviceJobDetail"><default-response url="../../Jobs/ServiceJobDetail"/></transition><transition name="userAccountDetail"><default-response url="../../../Security/UserAccount/UserAccountDetail"/></transition><actions/><widgets><form-list name="JobRunList" list="jobRunList" skip-form="true" header-dialog="true"><entity-find entity-name="moqui.service.job.ServiceJobRun" list="jobRunList" use-clone="true"><search-form-inputs default-order-by="-startTime"><default-parameters startTime_poffset="-1" startTime_period="30d"/></search-form-inputs></entity-find><field name="jobRunId"><header-field show-order-by="true"><text-find size="10" hide-options="true"/></header-field><default-field><link url="jobRunDetail" text="${jobRunId}" link-type="anchor"/></default-field></field><field name="jobName"><header-field show-order-by="case-insensitive"><drop-down allow-empty="true"><entity-options key="${jobName}" text="${jobName}"><entity-find entity-name="moqui.service.job.ServiceJob" limit="200"><order-by field-name="jobName"/></entity-find></entity-options></drop-down></header-field><default-field><link url="serviceJobDetail" text="${jobName}" link-type="anchor"/></default-field></field><field name="userId"><header-field title="User"><text-find size="10" hide-options="true"/></header-field><default-field><display-entity entity-name="moqui.security.UserAccount" text="${username} - ${userFullName}"/><link url="userAccountDetail" text="${userId}" link-type="anchor" condition="userId"/></default-field></field><field name="hasError"><header-field><drop-down allow-empty="true"><option key="Y"/><option key="N"/></drop-down></header-field><default-field><display/></default-field></field><field name="startTime"><header-field show-order-by="true"><date-period allow-empty="true"/></header-field><default-field><display/></default-field></field><field name="endTime"><header-field show-order-by="true"><date-period allow-empty="true"/></header-field><default-field><display/></default-field></field><field name="findButton"><header-field title="Find"><submit/></header-field><default-field><display text=" "/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://tools/screen/System/ServiceJob/JobRuns/JobRunDetail.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Job Run Detail" default-menu-index="1"><parameter name="jobRunId" required="true"/><transition name="serviceJobDetail"><default-response url="../../Jobs/ServiceJobDetail"/></transition><transition name="userAccountDetail"><default-response url="../../../Security/UserAccount/UserAccountDetail"/></transition><transition name="logViewer"><default-response url="../../../LogViewer"/></transition><actions><entity-find-one entity-name="moqui.service.job.ServiceJobRun" value-field="serviceJobRun"/><set field="queryString" value="thread_name:${serviceJobRun.runThread}"/></actions><widgets><link url="logViewer" text="View Log" parameter-map="[queryString:('thread_name:' + serviceJobRun?.runThread),                 tsPeriod_from:ec.l10n.format(serviceJobRun?.startTime, 'yyyy-MM-dd HH:mm:ss.SSS'),                 tsPeriod_thru:ec.l10n.format(serviceJobRun?.endTime, 'yyyy-MM-dd HH:mm:ss.SSS')]"/><form-single name="ServiceJobRunDetail" map="serviceJobRun"><auto-fields-entity entity-name="moqui.service.job.ServiceJobRun" field-type="display"/><field name="jobName"><default-field><link url="serviceJobDetail" text="${jobName}" link-type="anchor"/></default-field></field><field name="userId"><default-field title="User"><display-entity entity-name="moqui.security.UserAccount" text="${username} - ${userFullName}"/><link url="userAccountDetail" text="${userId}" link-type="anchor" condition="userId"/></default-field></field><field-layout><field-ref name="jobRunId"/><field-ref name="jobName"/><field-ref name="userId"/><fields-not-referenced/></field-layout></form-single></widgets></screen>
<!-- Screen Location component://tools/screen/System/ServiceJob/JobRuns.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Job Runs" default-menu-index="2"><subscreens default-item="JobRunList"/><widgets><subscreens-panel id="JobRunsPanel" type="popup"/></widgets></screen>
<!-- Screen Location component://tools/screen/System/ServiceJob.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Service Jobs" default-menu-index="12"><subscreens default-item="Jobs"/><widgets><subscreens-panel id="ServiceJobPanel" type="popup"/></widgets></screen>
<!-- Screen Location component://tools/screen/System/SystemMessage/Message/SystemMessageDetail/EditMessageText.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" standalone="true"><parameter name="systemMessageId" required="true"/><transition name="updateMessage"><service-call name="update#moqui.service.message.SystemMessage" in-map="true" out-map="context" multi="parameter"/><default-response url=".."/></transition><actions><entity-find-one entity-name="moqui.service.message.SystemMessage" value-field="systemMessage"/></actions><widgets><form-single name="SystemMessageForm" map="systemMessage" transition="updateMessage"><field name="systemMessageId"><default-field title="ID"><display/></default-field></field><field name="messageText"><default-field><text-area cols="100" rows="30"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></widgets></screen>
<!-- Screen Location component://tools/screen/System/SystemMessage/Message/SystemMessageDetail.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd"><parameter name="systemMessageId" required="true"/><transition name="remoteDetail"><default-response url="../../Remote/MessageRemoteDetail"/></transition><transition name="typeDetail"><default-response url="../../Type/MessageTypeDetail"/></transition><transition name="sendMessage"><service-call name="org.moqui.impl.SystemMessageServices.send#ProducedSystemMessage" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="consumeMessage"><service-call name="org.moqui.impl.SystemMessageServices.consume#ReceivedSystemMessage" async="true" in-map="true" out-map="context"/><actions><message><![CDATA[Consume started in background]]></message></actions><default-response url="."/></transition><transition name="queueAckMessage"><service-call name="org.moqui.impl.SystemMessageServices.queue#AckSystemMessage" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateMessage"><service-call name="update#moqui.service.message.SystemMessage" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="resetError"><service-call name="org.moqui.impl.SystemMessageServices.reset#SystemMessageInError" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="cancelMessage"><service-call name="org.moqui.impl.SystemMessageServices.cancel#SystemMessage" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="downloadMessageText" read-only="true"><actions><entity-find-one entity-name="moqui.service.message.SystemMessage" value-field="systemMessage"/><script><![CDATA[ec.web.sendTextResponse(systemMessage.messageText, "text/plain", "SystemMessage${systemMessageId}.txt")]]></script></actions><default-response type="none"/></transition><actions><entity-find-one entity-name="moqui.service.message.SystemMessage" value-field="systemMessage"/><entity-find entity-name="moqui.service.message.SystemMessageError" list="errorList"><econdition field-name="systemMessageId"/><order-by field-name="-errorDate"/></entity-find><entity-find entity-name="moqui.service.message.SystemMessage" list="ackOfMessageList"><econdition field-name="ackMessageId" from="systemMessageId"/></entity-find><entity-find entity-name="moqui.service.message.SystemMessage" list="childMessageList"><econdition field-name="parentMessageId" from="systemMessageId"/></entity-find></actions><widgets><dynamic-dialog id="EmtDialog" button-text="Edit Message Text" transition="EditMessageText" width="900"/><link url="downloadMessageText" text="Download Message Text"/><link url="sendMessage" text="Send Message" parameter-map="[systemMessageId:systemMessageId]" condition="systemMessage.isOutgoing == 'Y' && (systemMessage.statusId == 'SmsgProduced' || systemMessage.statusId == 'SmsgError')"/><link url="updateMessage" text="Reset to Produced" parameter-map="[systemMessageId:systemMessageId, statusId:'SmsgProduced']" condition="systemMessage.statusId == 'SmsgSending'" confirmation="Are you sure? If message is actually sending may result in double send."/><link url="consumeMessage" text="Consume Message" parameter-map="[systemMessageId:systemMessageId]" condition="systemMessage.isOutgoing == 'N' && (systemMessage.statusId == 'SmsgReceived' || systemMessage.statusId == 'SmsgError')"/><link url="queueAckMessage" text="Send Ack Message" parameter-map="[systemMessageId:systemMessageId]" condition="systemMessage.isOutgoing == 'N' && (systemMessage.statusId in ['SmsgConsumed', 'SmsgRejected', 'SmsgError'])"/><link url="cancelMessage" text="Cancel Message" parameter-map="[systemMessageId:systemMessageId]" condition="systemMessage.statusId in ['SmsgProduced', 'SmsgReceived', 'SmsgError', 'SmsgRejected']"/><section name="ResetErrorSection" condition="systemMessage.statusId == 'SmsgError'"><widgets><link url="resetError" text="Reset from Error" parameter-map="[systemMessageId:systemMessageId]"/></widgets></section><container-row><row-col lg="5"><form-single name="SystemMessageForm" map="systemMessage"><field name="systemMessageId"><default-field title="ID"><display/></default-field></field><auto-fields-entity entity-name="moqui.service.message.SystemMessage" field-type="display" include="nonpk"/><field name="messageText"><default-field><ignored/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="systemMessageTypeId"><default-field title="Type"><link url="typeDetail" entity-name="moqui.service.message.SystemMessageType" text="${description?:''} [${systemMessageTypeId}]" link-type="anchor" parameter-map="[systemMessageTypeId:systemMessage.systemMessageTypeId]"/></default-field></field><field name="parentMessageId"><default-field title="Parent Message"><link url="." text="${systemMessage.parentMessageId}" link-type="anchor" parameter-map="[systemMessageId:systemMessage.parentMessageId]" condition="systemMessage.parentMessageId"/></default-field></field><field name="ackMessageId"><default-field title="Ack Message"><link url="." text="${systemMessage.ackMessageId}" link-type="anchor" parameter-map="[systemMessageId:systemMessage.ackMessageId]" condition="systemMessage.ackMessageId"/></default-field></field><field name="systemMessageRemoteId"><default-field title="Remote"><link url="remoteDetail" text="${description?:''} [${systemMessageRemoteId}]" link-type="anchor" entity-name="moqui.service.message.SystemMessageRemote" parameter-map="[systemMessageRemoteId:systemMessage.systemMessageRemoteId]" condition="systemMessage.systemMessageRemoteId"/></default-field></field></form-single></row-col><row-col lg="7"><section name="AckOfSection" condition="ackOfMessageList"><widgets><form-list name="AckOfForm" list="ackOfMessageList" skip-form="true"><field name="systemMessageId"><default-field title="Ack of Message"><link url="." text="${systemMessageId}"/></default-field></field><field name="systemMessageTypeId"><default-field title="Type"><link url="typeDetail" entity-name="moqui.service.message.SystemMessageType" text="${description?:''} [${systemMessageTypeId}]" link-type="anchor" parameter-map="[systemMessageTypeId:systemMessage.systemMessageTypeId]"/></default-field></field></form-list></widgets></section><section name="ChildrenSection" condition="childMessageList"><widgets><form-list name="ChildrenForm" list="childMessageList" skip-form="true"><field name="systemMessageId"><default-field title="Child Message"><link url="." text="${systemMessageId}"/></default-field></field><field name="systemMessageTypeId"><default-field title="Type"><link url="typeDetail" entity-name="moqui.service.message.SystemMessageType" text="${description?:''} [${systemMessageTypeId}]" link-type="anchor" parameter-map="[systemMessageTypeId:systemMessage.systemMessageTypeId]"/></default-field></field></form-list></widgets></section><section name="StatusHistorySection"><actions><entity-find entity-name="moqui.entity.EntityAuditLog" list="reverseList"><econdition field-name="changedEntityName" value="moqui.service.message.SystemMessage"/><econdition field-name="changedFieldName" value="statusId"/><econdition field-name="pkPrimaryValue" from="systemMessageId"/><order-by field-name="-changedDate"/></entity-find></actions><widgets><container-box><box-header title="Status History"/><box-body><section-iterate name="StatusHistoryTable" list="reverseList" entry="statusHistory"><actions><entity-find-one entity-name="moqui.security.UserAccount" value-field="userAccount"><field-map field-name="userId" from="statusHistory.changedByUserId"/></entity-find-one><entity-find-one entity-name="moqui.basic.StatusItem" value-field="statusItem" cache="true"><field-map field-name="statusId" from="statusHistory.newValueText"/></entity-find-one></actions><widgets><container-row><row-col lg="7" md="7" sm="7"><label text="${ec.l10n.format(statusHistory.changedDate, '')}" type="strong" style="text-nowrap"/><label text="by ${userAccount?.username ?: statusHistory.changedByUserId ?: 'Unknown'}" style="text-nowrap"/></row-col><row-col lg="5" md="5" sm="5"><label text="${statusItem?statusItem.description:''}" type="p"/></row-col></container-row></widgets></section-iterate></box-body></container-box></widgets></section><form-list name="ErrorListForm" list="errorList" skip-form="true"><field name="errorDate"><default-field><display/></default-field></field><field name="errorText"><default-field><display/></default-field></field></form-list></row-col></container-row></widgets></screen>
<!-- Screen Location component://tools/screen/System/SystemMessage/Message/SystemMessageList.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><parameter name="isOutgoing"/><parameter name="statusId"/><transition name="messageDetail"><default-response url="../SystemMessageDetail"/></transition><transition name="sendAllMessages"><service-call name="org.moqui.impl.SystemMessageServices.send#AllProducedSystemMessages" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="consumeAllMessages"><service-call name="org.moqui.impl.SystemMessageServices.consume#AllReceivedSystemMessages" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="sendMessage"><service-call name="org.moqui.impl.SystemMessageServices.send#ProducedSystemMessage" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="consumeMessage"><service-call name="org.moqui.impl.SystemMessageServices.consume#ReceivedSystemMessage" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="newIncomingMessage"><service-call name="org.moqui.impl.SystemMessageServices.receive#IncomingSystemMessage" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><entity-find-count entity-name="moqui.service.message.SystemMessage" count-field="outgoingCount"><econdition field-name="statusId" value="SmsgProduced"/><econdition field-name="isOutgoing" value="Y"/></entity-find-count><entity-find-count entity-name="moqui.service.message.SystemMessage" count-field="incomingCount"><econdition field-name="statusId" value="SmsgReceived"/><econdition field-name="isOutgoing" value="N"/></entity-find-count><entity-find-count entity-name="moqui.service.message.SystemMessage" count-field="errorCount"><econdition field-name="statusId" value="SmsgError"/></entity-find-count></actions><widgets><container-dialog id="SendDialog" button-text="Send Produced Messages"><form-single name="SendForm" transition="sendAllMessages"><field name="retryMinutes"><default-field><text-line size="5" default-value="60"/></default-field></field><field name="retryLimit"><default-field><text-line size="5" default-value="24"/></default-field></field><field name="submitButton"><default-field title="Send All"><submit/></default-field></field></form-single></container-dialog><container-dialog id="ConsumeDialog" button-text="Consume Received Messages"><form-single name="ConsumeForm" transition="consumeAllMessages"><field name="retryMinutes"><default-field><text-line size="5" default-value="10"/></default-field></field><field name="retryLimit"><default-field><text-line size="5" default-value="3"/></default-field></field><field name="submitButton"><default-field title="Consume All"><submit/></default-field></field></form-single></container-dialog><container-dialog id="NewIncomingMessageDialog" button-text="New Incoming Message" width="800"><form-single name="NewIncomingMessageForm" transition="newIncomingMessage"><field name="systemMessageTypeId"><default-field title="Message Type"><drop-down><entity-options key="${systemMessageTypeId}" text="${description}"><entity-find entity-name="moqui.service.message.SystemMessageType"><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="systemMessageRemoteId"><default-field title="Remote"><drop-down allow-empty="true"><entity-options key="${systemMessageRemoteId}" text="${description}"><entity-find entity-name="moqui.service.message.SystemMessageRemote"><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="messageText"><default-field><text-area rows="30" cols="90"/></default-field></field><field name="submitButton"><default-field title="Receive and Consume"><submit/></default-field></field></form-single></container-dialog><container-row><row-col lg="2"><link url="." text="Outgoing Produced Queue" parameter-map="[statusId:'SmsgProduced', isOutgoing:'Y']" link-type="anchor"/></row-col><row-col lg="1"><label text="${ec.l10n.format(outgoingCount, null)}" type="strong"/></row-col><row-col lg="2"><link url="." text="Incoming Received Queue" parameter-map="[statusId:'SmsgReceived', isOutgoing:'N']" link-type="anchor"/></row-col><row-col lg="1"><label text="${ec.l10n.format(incomingCount, null)}" type="strong"/></row-col><row-col lg="2"><link url="." text="Error Queue" parameter-map="[statusId:'SmsgError', isOutgoing:'']" link-type="anchor"/></row-col><row-col lg="1"><label text="${ec.l10n.format(errorCount, null)}" type="strong"/></row-col></container-row><form-list name="SystemMessageList" list="smList" skip-form="true" header-dialog="true" select-columns="true" saved-finds="true"><entity-find entity-name="moqui.service.message.SystemMessage" list="smList" use-clone="true"><search-form-inputs default-order-by="initDate"><default-parameters statusId="SmsgProduced,SmsgReceived,SmsgError" statusId_op="in" initDate_poffset="-1" initDate_period="30d"/></search-form-inputs></entity-find><auto-fields-entity entity-name="moqui.service.message.SystemMessage" field-type="find-display" auto-columns="false"/><field name="systemMessageId"><header-field title="ID" show-order-by="true"><text-find hide-options="true" size="8"/></header-field><default-field><link text="${systemMessageId}" url="messageDetail" link-type="anchor"/></default-field></field><field name="remoteMessageId"><header-field title="Remote ID" show-order-by="true"><text-find hide-options="true" size="8"/></header-field><default-field><display/></default-field></field><field name="statusId"><header-field title="Status"><drop-down allow-multiple="true"><entity-options key="${statusId}" text="${description}"><entity-find entity-name="moqui.basic.StatusItem"><econdition field-name="statusTypeId" value="SystemMessage"/><order-by field-name="description"/></entity-find></entity-options></drop-down></header-field><default-field><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="isOutgoing"><header-field><drop-down allow-empty="true"><option key="Y"/><option key="N"/></drop-down></header-field><default-field><display/></default-field></field><field name="systemMessageTypeId"><header-field title="Type"><drop-down allow-empty="true"><entity-options key="${systemMessageTypeId}" text="${description?:''} [${systemMessageTypeId}]"><entity-find entity-name="moqui.service.message.SystemMessageType"><order-by field-name="description,systemMessageTypeId"/></entity-find></entity-options></drop-down></header-field><default-field><display-entity entity-name="moqui.service.message.SystemMessageType" text="${systemMessageTypeId}: ${description?:''}"/></default-field></field><field name="systemMessageRemoteId"><header-field title="Remote"><drop-down allow-empty="true"><entity-options key="${systemMessageRemoteId}" text="${description?:''} [${systemMessageRemoteId}]"><entity-find entity-name="moqui.service.message.SystemMessageRemote"><order-by field-name="description,systemMessageRemoteId"/></entity-find></entity-options></drop-down></header-field><default-field><display-entity entity-name="moqui.service.message.SystemMessageRemote" text="${systemMessageRemoteId}: ${description?:''}"/></default-field></field><field name="initDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="processedDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="lastAttemptDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="failCount"><header-field show-order-by="true"><range-find size="3"/></header-field><default-field><display/></default-field></field><field name="senderId"><header-field show-order-by="true"><text-find hide-options="true" size="8"/></header-field><default-field><display/></default-field></field><field name="receiverId"><header-field show-order-by="true"><text-find hide-options="true" size="8"/></header-field><default-field><display/></default-field></field><field name="messageId"><header-field show-order-by="true"><text-find hide-options="true" size="8"/></header-field><default-field><display/></default-field></field><field name="messageDate"><header-field show-order-by="true"><date-period allow-empty="true"/></header-field><default-field><display/></default-field></field><field name="docType"><header-field show-order-by="true"><text-find hide-options="true" size="5"/></header-field><default-field><display/></default-field></field><field name="docSubType"><header-field show-order-by="true"><text-find hide-options="true" size="5"/></header-field><default-field><display/></default-field></field><field name="docVersion"><header-field show-order-by="true"><text-find hide-options="true" size="5"/></header-field><default-field><display/></default-field></field><field name="find"><header-field title="Find"><submit/></header-field><conditional-field condition="isOutgoing == 'Y' && (statusId == 'SmsgProduced' || statusId == 'SmsgError')"><link url="sendMessage" text="Send" parameter-map="[systemMessageId:systemMessageId, isOutgoing:isOutgoing, statusId:statusId]"/></conditional-field><conditional-field condition="isOutgoing == 'N' && (statusId == 'SmsgReceived' || statusId == 'SmsgError')"><link url="consumeMessage" text="Consume" parameter-map="[systemMessageId:systemMessageId, isOutgoing:isOutgoing, statusId:statusId]"/></conditional-field></field><form-list-column><field-ref name="systemMessageId"/><field-ref name="remoteMessageId"/></form-list-column><form-list-column><field-ref name="statusId"/><field-ref name="isOutgoing"/></form-list-column><form-list-column><field-ref name="systemMessageTypeId"/><field-ref name="systemMessageRemoteId"/></form-list-column><form-list-column><field-ref name="initDate"/><field-ref name="processedDate"/></form-list-column><form-list-column><field-ref name="lastAttemptDate"/><field-ref name="failCount"/></form-list-column><form-list-column><field-ref name="senderId"/><field-ref name="receiverId"/></form-list-column><form-list-column><field-ref name="messageId"/><field-ref name="messageDate"/></form-list-column><form-list-column><field-ref name="docType"/><field-ref name="docSubType"/><field-ref name="docVersion"/></form-list-column><form-list-column><field-ref name="find"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://tools/screen/System/SystemMessage/Message.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Messages"><subscreens default-item="SystemMessageList"/><widgets><subscreens-active/></widgets></screen>
<!-- Screen Location component://tools/screen/System/SystemMessage/Remote/MessageRemoteDetail.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd"><parameter name="systemMessageRemoteId" required="true"/><transition name="updateMessageRemote"><service-call name="update#moqui.service.message.SystemMessageRemote" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createMessageRemoteEnumMap"><service-call name="create#moqui.service.message.SystemMessageEnumMap" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateMessageRemoteEnumMap"><service-call name="update#moqui.service.message.SystemMessageEnumMap" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteMessageRemoteEnumMap"><service-call name="delete#moqui.service.message.SystemMessageEnumMap" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="systemMessageList"><default-response url="../../Message/SystemMessageList"/></transition><actions><entity-find-one entity-name="moqui.service.message.SystemMessageRemote" value-field="systemMessageRemote"/><entity-find entity-name="moqui.service.message.SystemMessageEnumMap" list="systemMessageEnumMapList"><econdition field-name="systemMessageRemoteId"/></entity-find></actions><widgets><container-row><row-col md="6"><link url="systemMessageList" text="Messages" parameter-map="[systemMessageRemoteId:systemMessageRemoteId]"/><form-single name="SystemMessageRemoteForm" map="systemMessageRemote" transition="updateMessageRemote"><field name="systemMessageRemoteId"><default-field title="Message Remote ID"><display/></default-field></field><auto-fields-entity entity-name="moqui.service.message.SystemMessageRemote" field-type="edit" include="nonpk"/><field name="description"><default-field><text-line size="40"/></default-field></field><field name="sendUrl"><default-field><text-line size="100"/></default-field></field><field name="sendServiceName"><default-field><text-line size="100"/></default-field></field><field name="messageAuthEnumId"><default-field title="Message Auth"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="SystemMessageAuthType"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="sendAuthEnumId"><default-field title="Message Send Auth"><widget-template-include location="component://webroot/template/screen/BasicWidgetTemplates.xml#enumDropDown"><set field="enumTypeId" value="SystemMessageAuthType"/><set field="allowEmpty" value="true"/></widget-template-include></default-field></field><field name="systemMessageTypeId"><default-field title="Message Type"><drop-down allow-empty="true"><entity-options key="${systemMessageTypeId}" text="${description}"><entity-find entity-name="moqui.service.message.SystemMessageType"><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="segmentTerminator"><default-field><text-line size="1" maxlength="1"/></default-field></field><field name="elementSeparator"><default-field><text-line size="1" maxlength="1"/></default-field></field><field name="componentDelimiter"><default-field><text-line size="1" maxlength="1"/></default-field></field><field name="escapeCharacter"><default-field><text-line size="1" maxlength="1"/></default-field></field><field name="publicKey"><default-field><text-area cols="100" maxlength="4000"/></default-field></field><field name="privateKey"><default-field><text-area cols="100" maxlength="4000"/></default-field></field><field name="remotePublicKey"><default-field><text-area cols="100" maxlength="4000"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></row-col><row-col md="6"><container-box><box-header title="Remote Enum Map"/><box-toolbar><container-dialog id="createMessageRemoteEnumMap" button-text="Create Enum Map"><form-single name="CreateMessageRemoteEnumMap" transition="createMessageRemoteEnumMap"><field name="systemMessageRemoteId"><default-field><hidden/></default-field></field><field name="enumId"><default-field><drop-down><entity-options key="${enumId}" text="${typeDescription} - ${description}"><entity-find entity-name="moqui.basic.EnumerationAndType"><order-by field-name="typeDescription,sequenceNum,description"/></entity-find></entity-options></drop-down></default-field></field><field name="mappedValue"><default-field><text-line size="30"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body-nopad><form-list name="SystemMessageEnumMapList" list="systemMessageEnumMapList" transition="updateMessageRemoteEnumMap"><row-actions><entity-find-one entity-name="moqui.basic.Enumeration" value-field="keyEnum"><field-map field-name="enumId"/></entity-find-one></row-actions><field name="systemMessageRemoteId"><default-field><hidden/></default-field></field><field name="enumId"><default-field title="Enum Id"><display text="${keyEnum ? keyEnum.description + ' ' : ''}(${enumId})"/></default-field></field><field name="mappedValue"><default-field title="Value"><text-line/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field name="lastUpdatedStamp"><default-field><hidden/></default-field></field><field name="deleteButton"><default-field title=""><link url="deleteMessageRemoteEnumMap" text=" " icon="fa fa-trash" confirmation="Really remove?"/></default-field></field></form-list></box-body-nopad></container-box></row-col></container-row></widgets></screen>
<!-- Screen Location component://tools/screen/System/SystemMessage/Remote/MessageRemoteList.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="remoteDetail"><default-response url="../MessageRemoteDetail"/></transition><transition name="createMessageRemote"><service-call name="create#moqui.service.message.SystemMessageRemote" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><entity-find entity-name="moqui.service.message.SystemMessageRemote" list="smrList"><search-form-inputs default-order-by="description,systemMessageRemoteId"/></entity-find></actions><widgets><container-dialog id="CreateRemoteDialog" button-text="Create Message Remote" width="800"><form-single name="CreateMessageRemoteForm" transition="createMessageRemote"><field name="systemMessageRemoteId"><default-field title="SM Remote ID"><text-line/></default-field></field><field name="description"><default-field><text-line size="40"/></default-field></field><field name="sendUrl"><default-field><text-line size="80"/></default-field></field><field name="sendServiceName"><default-field><text-line size="80"/></default-field></field><field name="username"><default-field><text-line size="30"/></default-field></field><field name="password"><default-field><text-line size="30"/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="SystemMessageRemoteList" list="smrList" skip-form="true"><field name="systemMessageRemoteId"><default-field title="Remote ID"><link text="${systemMessageRemoteId}" url="remoteDetail"/></default-field></field><field name="description"><header-field show-order-by="true"><text-find hide-options="true"/></header-field><default-field><display/></default-field></field><field name="sendUrl"><header-field show-order-by="true"><text-find hide-options="true"/></header-field><default-field><display/></default-field></field><field name="username"><header-field show-order-by="true"><text-find hide-options="true"/></header-field><default-field><display/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://tools/screen/System/SystemMessage/Remote.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Remotes"><subscreens default-item="MessageRemoteList"/><widgets><subscreens-active/></widgets></screen>
<!-- Screen Location component://tools/screen/System/SystemMessage/Type/MessageTypeDetail.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd"><parameter name="systemMessageTypeId" required="true"/><transition name="updateMessageType"><service-call name="update#moqui.service.message.SystemMessageType" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><entity-find-one entity-name="moqui.service.message.SystemMessageType" value-field="systemMessageType"/></actions><widgets><form-single name="SystemMessageTypeForm" map="systemMessageType" transition="updateMessageType"><field name="systemMessageTypeId"><default-field title="Type ID"><display/></default-field></field><field name="description"><default-field><text-line size="40"/></default-field></field><field name="produceServiceName"><default-field><text-line size="80"/></default-field></field><field name="sendServiceName"><default-field><text-line size="80"/></default-field></field><field name="receiveServiceName"><default-field><text-line size="80"/></default-field></field><field name="consumeServiceName"><default-field><text-line size="80"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></widgets></screen>
<!-- Screen Location component://tools/screen/System/SystemMessage/Type/MessageTypeList.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><transition name="typeDetail"><default-response url="../MessageTypeDetail"/></transition><transition name="createMessageType"><service-call name="create#moqui.service.message.SystemMessageType" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><entity-find entity-name="moqui.service.message.SystemMessageType" list="smtList"><search-form-inputs default-order-by="description,systemMessageTypeId"/></entity-find></actions><widgets><container-dialog id="CreateTypeDialog" button-text="Create Message Type" width="800"><form-single name="CreateMessageTypeForm" transition="createMessageType"><field name="description"><default-field><text-line size="40"/></default-field></field><field name="sendServiceName"><default-field><text-line size="80"/></default-field></field><field name="consumeServiceName"><default-field><text-line size="80"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></container-dialog><form-list name="SystemMessageTypeList" list="smtList" skip-form="true"><field name="systemMessageTypeId"><default-field title="Type ID"><link text="${systemMessageTypeId}" url="typeDetail"/></default-field></field><field name="description"><header-field show-order-by="true"><text-find hide-options="true"/></header-field><default-field><display/></default-field></field><field name="sendServiceName"><header-field show-order-by="true"><text-find hide-options="true"/></header-field><default-field><display/></default-field></field><field name="consumeServiceName"><header-field show-order-by="true"><text-find hide-options="true"/></header-field><default-field><display/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://tools/screen/System/SystemMessage/Type.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Types"><subscreens default-item="MessageTypeList"/><widgets><subscreens-active/></widgets></screen>
<!-- Screen Location component://tools/screen/System/SystemMessage.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Sys-Sys Messages" default-menu-index="13"><subscreens default-item="Message"/><widgets><subscreens-panel id="SysSysMessagesPanel" type="popup"/></widgets></screen>
<!-- Screen Location component://tools/screen/System/Visit/VisitDetail.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><parameter name="visitId" required="true"/><transition name="userAccountDetail"><default-response url="//system/Security/UserAccountDetail"/></transition><transition name="getVisitClientIpData"><service-call name="org.moqui.impl.ServerServices.get#VisitClientIpData" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><entity-find-one entity-name="moqui.server.Visit" value-field="visit"/><if condition="visit == null"><return error="true" message="Visit not found with ID ${visitId}"/></if><entity-find-one entity-name="moqui.security.UserAccount" value-field="userAccount"><field-map field-name="userId" from="visit.userId"/></entity-find-one><entity-find entity-name="moqui.server.ArtifactHit" list="artifactHitList" use-clone="true"><search-form-inputs default-order-by="startDateTime"/><econdition field-name="visitId"/></entity-find></actions><widgets><container-box><box-header title="Visit #${visitId}"/><box-toolbar><section name="ClientIpLinkSection" condition="visit != null && !visit.clientIpIspName"><widgets><link url="getVisitClientIpData" text="Get Client IP Data"/></widgets></section></box-toolbar><box-body><container-row><row-col md="4"><container-row><row-col xs="4" style="text-right"><label text="Visitor ID" type="strong"/></row-col><row-col xs="8"><label text="${visit.visitorId}"/></row-col></container-row><container-row><row-col xs="4" style="text-right"><label text="Session ID" type="strong"/></row-col><row-col xs="8"><label text="${visit.sessionId}"/></row-col></container-row><container-row><row-col xs="4" style="text-right"><label text="Webapp" type="strong"/></row-col><row-col xs="8"><label text="${visit.webappName}"/></row-col></container-row><container-row><row-col xs="4" style="text-right"><label text="From Date" type="strong"/></row-col><row-col xs="8"><label text="${ec.l10n.format(visit.fromDate, '')}"/></row-col></container-row><container-row><row-col xs="4" style="text-right"><label text="Thru Date" type="strong"/></row-col><row-col xs="8"><label text="${ec.l10n.format(visit.thruDate, '')}"/></row-col></container-row></row-col><row-col md="3"><container-row><row-col xs="4" style="text-right"><label text="User" type="strong"/></row-col><row-col xs="8"><link url="userAccountDetail" text="UsernameTemplate" text-map="userAccount" link-type="anchor" parameter-map="[userId:visit.userId]" condition="visit.userId"/></row-col></container-row><container-row><row-col xs="4" style="text-right"><label text="User Created" type="strong"/></row-col><row-col xs="8"><label text="${visit.userCreated ?: 'N'}"/></row-col></container-row><container-row><row-col xs="4" style="text-right"><label text="Locale" type="strong"/></row-col><row-col xs="8"><label text="${visit.initialLocale}"/></row-col></container-row><container-row><row-col xs="4" style="text-right"><label text="Client User" type="strong"/></row-col><row-col xs="8"><label text="${visit.clientUser ?: 'Unknown'}"/></row-col></container-row><container-row><row-col xs="4" style="text-right"><label text="Client Host" type="strong"/></row-col><row-col xs="8"><label text="${visit.clientHostName}"/></row-col></container-row><container-row><row-col xs="4" style="text-right"><label text="Client IP" type="strong"/></row-col><row-col xs="8"><label text="${visit.clientIpAddress}"/></row-col></container-row></row-col><row-col md="5"><container-row><row-col xs="4" style="text-right"><label text="Server Host" type="strong"/></row-col><row-col xs="8"><label text="${visit.serverHostName}"/></row-col></container-row><container-row><row-col xs="4" style="text-right"><label text="Server IP" type="strong"/></row-col><row-col xs="8"><label text="${visit.serverIpAddress}"/></row-col></container-row><container-row><row-col xs="4" style="text-right"><label text="Initial Request" type="strong"/></row-col><row-col xs="8"><label text="${visit.initialRequest}"/></row-col></container-row><container-row><row-col xs="4" style="text-right"><label text="Referrer" type="strong"/></row-col><row-col xs="8"><label text="${visit.initialReferrer ?: 'None'}"/></row-col></container-row><container-row><row-col xs="4" style="text-right"><label text="User Agent" type="strong"/></row-col><row-col xs="8"><label text="${visit.initialUserAgent ?: ''}"/></row-col></container-row></row-col></container-row></box-body></container-box><section name="ClientIpSection" condition="visit.clientIpIspName"><widgets><container-box><box-header title="Client IP ${visit.clientIpAddress} Data"/><box-body><container-row><row-col md="6"><label text="ISP: ${visit.clientIpIspName}" type="div" condition="visit.clientIpIspName"/><label text="Latitude: ${visit.clientIpLatitude}" type="div" condition="visit.clientIpLatitude"/><label text="Longitude: ${visit.clientIpLongitude}" type="div" condition="visit.clientIpLongitude"/><label text="Time Zone: ${visit.clientIpTimeZone}" type="div" condition="visit.clientIpTimeZone"/><label text="Metro Code: ${visit.clientIpMetroCode}" type="div" condition="visit.clientIpMetroCode"/></row-col><row-col md="6"><label text="Postal Code: ${visit.clientIpPostalCode}" type="div" condition="visit.clientIpPostalCode"/><label text="City: ${visit.clientIpCity}" type="div" condition="visit.clientIpCity"/><label text="Region Code: ${visit.clientIpRegionCode}" type="div" condition="visit.clientIpRegionCode"/><label text="Region Name: ${visit.clientIpRegionName}" type="div" condition="visit.clientIpRegionName"/><label text="State/Province: ${visit.clientIpStateProvGeoId}" type="div" condition="visit.clientIpStateProvGeoId"/><label text="Country: ${visit.clientIpCountryGeoId}" type="div" condition="visit.clientIpCountryGeoId"/></row-col></container-row></box-body></container-box></widgets></section><form-list name="VisitArtifactHitList" list="artifactHitList" skip-form="true" header-dialog="true" select-columns="true"><field name="visitId"><header-field><hidden/></header-field></field><field name="startDateTime"><header-field show-order-by="true"><date-period time="true"/></header-field><default-field><display/></default-field></field><field name="userId"><default-field><display/></default-field></field><field name="artifactType"><header-field show-order-by="true"><drop-down allow-multiple="true"><option key="AT_XML_SCREEN"/><option key="AT_XML_SCREEN_CONTENT"/><option key="AT_XML_SCREEN_TRANS"/><option key="AT_SERVICE"/><option key="AT_ENTITY"/></drop-down></header-field><default-field title="Type"><display text="${artifactType?.replace('-',' - ')}"/></default-field></field><field name="artifactSubType"><default-field title="Sub Type"><display/></default-field></field><field name="artifactName"><header-field show-order-by="true"><text-find/></header-field><default-field><display/></default-field></field><field name="parameterString"><header-field><text-find/></header-field><default-field><display text="${parameterString?.replace(',',' , ') ?: 'N/A'}"/></default-field></field><field name="runningTimeMillis"><header-field title="Time" show-order-by="true"/><default-field><display text="${ec.l10n.format(runningTimeMillis, '0.00')}ms"/></default-field></field><field name="isSlowHit"><header-field title="Slow" show-order-by="true"><drop-down allow-empty="true"><option key="Y"/><option key="N"/></drop-down></header-field><default-field><display/></default-field></field><field name="outputSize"><default-field title="Size"><display text="${outputSize ?: 'Unknown'}"/></default-field></field><field name="wasError"><header-field title="Error" show-order-by="true"><drop-down allow-empty="true"><option key="Y"/><option key="N"/></drop-down></header-field><default-field><display/></default-field></field><field name="errorMessage"><header-field><text-find/></header-field><default-field title="Message"><display/></default-field></field><field name="requestUrl"><header-field show-order-by="true"/><default-field><display/></default-field></field><field name="referrerUrl"><default-field><display text="${referrerUrl ?: 'N/A'}"/></default-field></field><field name="serverIpAddress"><default-field><display/></default-field></field><field name="serverHostName"><default-field><display/></default-field></field><field name="findButton"><header-field title="Find"><submit/></header-field></field><form-list-column><field-ref name="startDateTime"/><field-ref name="userId"/></form-list-column><form-list-column><field-ref name="artifactType"/><field-ref name="artifactSubType"/></form-list-column><form-list-column><field-ref name="runningTimeMillis"/><field-ref name="isSlowHit"/><field-ref name="outputSize"/></form-list-column><form-list-column><field-ref name="artifactName"/><field-ref name="parameterString"/><field-ref name="requestUrl"/><field-ref name="referrerUrl"/></form-list-column><form-list-column><field-ref name="wasError"/><field-ref name="errorMessage"/></form-list-column><form-list-column><field-ref name="serverIpAddress"/><field-ref name="serverHostName"/></form-list-column><form-list-column><field-ref name="findButton"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://tools/screen/System/Visit/VisitList.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd"><transition name="visitDetail"><default-response url="../VisitDetail"/></transition><transition name="userAccountDetail"><default-response url="//system/Security/UserAccountDetail"/></transition><actions><entity-find entity-name="moqui.server.Visit" list="visitList" use-clone="true"><search-form-inputs default-order-by="-fromDate"/></entity-find></actions><widgets><form-list name="VisitList" list="visitList" skip-form="true" header-dialog="true" saved-finds="true" show-csv-button="true" show-xlsx-button="true" select-columns="true" show-page-size="true"><row-actions><entity-find-count entity-name="moqui.server.ArtifactHit" count-field="hitCount"><econdition field-name="visitId"/></entity-find-count></row-actions><field name="fromDate"><header-field show-order-by="true"><date-period/></header-field><default-field><display/></default-field></field><field name="visitId"><header-field show-order-by="true"><text-find size="20" default-operator="begins"/></header-field><default-field><link text="${visitId}" url="visitDetail" link-type="anchor"><parameter name="visitId"/></link></default-field></field><field name="visitorId"><header-field show-order-by="true"><text-find size="20" default-operator="begins"/></header-field><default-field><display/></default-field></field><field name="sessionId"><header-field show-order-by="true"><text-find size="20" default-operator="begins"/></header-field><default-field><display/></default-field></field><field name="userId"><header-field show-order-by="true"><text-find size="20" default-operator="begins"/></header-field><default-field><display-entity entity-name="moqui.security.UserAccount" text="UsernameTemplate"/><link url="userAccountDetail" text="${userId}" link-type="anchor" condition="userId"/></default-field></field><field name="serverIpAddress"><header-field title="Server IP"><text-find size="20" default-operator="begins"/></header-field><default-field><display/></default-field></field><field name="clientIpAddress"><header-field title="Client IP" show-order-by="true"><text-find size="20" default-operator="begins"/></header-field><default-field><display/></default-field></field><field name="clientIpCountryGeoId"><header-field title="Client Country" show-order-by="true"><text-find size="5" default-operator="begins"/></header-field><default-field><display-entity entity-name="moqui.basic.Geo" text="${geoId} - ${geoName}"/></default-field></field><field name="initialRequest"><header-field show-order-by="true"><text-find size="60" default-operator="begins"/></header-field><default-field><display/></default-field></field><field name="hitCount"><default-field><display/></default-field></field><field name="findButton"><header-field><submit text="Find"/></header-field></field><form-list-column><field-ref name="visitId"/><field-ref name="fromDate"/></form-list-column><form-list-column><field-ref name="visitorId"/><field-ref name="sessionId"/><field-ref name="userId"/></form-list-column><form-list-column><field-ref name="clientIpAddress"/><field-ref name="clientIpCountryGeoId"/></form-list-column><form-list-column><field-ref name="serverIpAddress"/><field-ref name="initialRequest"/></form-list-column><form-list-column><field-ref name="hitCount"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://tools/screen/System/Visit.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Visits" default-menu-index="14"><subscreens default-item="VisitList"/><widgets><subscreens-active/></widgets></screen>
<!-- Screen Location component://tools/screen/System/Instance/InstanceList.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Application Instances" default-menu-include="false"><transition name="instanceDetail"><default-response url="../InstanceDetail"/></transition><transition name="createAppInstance"><service-call name="org.moqui.impl.InstanceServices.create#AppInstance" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="provisionAppInstance"><service-call name="org.moqui.impl.InstanceServices.provision#AppInstance" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="checkAppInstanceAndDatabase"><service-call name="org.moqui.impl.InstanceServices.check#AppInstanceAndDatabase" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="checkAppDatabase"><service-call name="org.moqui.impl.InstanceServices.check#AppDatabase" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createAppDatabase"><service-call name="org.moqui.impl.InstanceServices.create#AppDatabase" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="initAppInstance"><service-call name="org.moqui.impl.InstanceServices.init#AppInstance" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="startAppInstance"><service-call name="org.moqui.impl.InstanceServices.start#AppInstance" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="stopAppInstance"><service-call name="org.moqui.impl.InstanceServices.stop#AppInstance" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="removeAppInstance"><service-call name="org.moqui.impl.InstanceServices.remove#AppInstance" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="checkAppInstance"><service-call name="org.moqui.impl.InstanceServices.check#AppInstance" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><set field="checkAllBool" from="true"/><entity-find entity-name="moqui.server.instance.AppInstance" list="instanceList"><search-form-inputs default-order-by="instanceName"/></entity-find></actions><widgets><container-dialog id="CreateInstanceDialog" button-text="Create App Instance"><form-single name="CreateInstance" transition="createAppInstance"><field name="instanceName"><default-field tooltip="Defaults to Host Name with dots (.) replaced by underscore (_)"><text-line size="50"/></default-field></field><field name="hostName"><default-field tooltip="Hostname for access to the instance, generally a virtual host name"><text-line size="50"/></default-field></field><field name="instanceImageId"><default-field title="Image"><drop-down><entity-options key="${instanceImageId}" text="${imageName} - ${hostTypeDescription} - ${imageTypeDescription}"><entity-find entity-name="moqui.server.instance.InstanceImageDetail"><order-by field-name="imageName"/></entity-find></entity-options></drop-down></default-field></field><field name="instanceHostId"><default-field title="Instance Host"><drop-down allow-empty="true"><entity-options key="${instanceHostId}" text="${typeDescription} ${hostAddress}"><entity-find entity-name="moqui.server.instance.InstanceHostDetail"><order-by field-name="typeDescription"/></entity-find></entity-options></drop-down></default-field></field><field name="databaseHostId"><default-field title="Database Host"><drop-down allow-empty="true"><entity-options key="${databaseHostId}" text="${typeDescription} ${hostAddress}"><entity-find entity-name="moqui.server.instance.DatabaseHostDetail"><order-by field-name="typeDescription"/></entity-find></entity-options></drop-down></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><form-list name="InstanceList" list="instanceList" skip-form="true"><row-actions><if condition="checkAllBool"><then><service-call name="org.moqui.impl.InstanceServices.check#AppInstanceAndDatabase" in-map="[appInstanceId:appInstanceId]" out-map="context"/><if condition="ec.message.hasError()"><set field="checkErrors" from="ec.message.getErrorsString()"/><script><![CDATA[ec.message.clearErrors()]]></script></if><set field="gotMoquiStatus" from="false"/><if condition="moquiStatusMap"><set field="gotMoquiStatus" from="true"/><set field="loadPercent" from="(moquiStatusMap?.Utilization?.LoadPercent as BigDecimal).setScale(0, BigDecimal.ROUND_HALF_UP)"/><set field="heapPercent" from="(moquiStatusMap?.Utilization?.HeapPercent as BigDecimal).setScale(0, BigDecimal.ROUND_HALF_UP)"/><set field="diskPercent" from="(moquiStatusMap?.Utilization?.DiskPercent as BigDecimal).setScale(0, BigDecimal.ROUND_HALF_UP)"/></if></then></if></row-actions><field name="appInstanceId"><default-field title="Instance ID"><link url="instanceDetail" text="${appInstanceId}" link-type="anchor"/></default-field></field><field name="instanceName"><default-field><display/></default-field></field><field name="hostName"><default-field><link url="http://${hostName}" url-type="plain" text="${hostName}" link-type="anchor"/></default-field></field><field name="instanceImageId"><default-field title="Image"><display-entity entity-name="moqui.server.instance.InstanceImageDetail" text="${imageName} - ${hostTypeDescription} - ${imageTypeDescription}"/></default-field></field><field name="instanceHostId"><default-field title="Instance Host"><display-entity entity-name="moqui.server.instance.InstanceHostDetail" text="${typeDescription} ${hostAddress}"/></default-field></field><field name="databaseHostId"><default-field title="Database Host"><display-entity entity-name="moqui.server.instance.DatabaseHostDetail" text="${typeDescription} ${hostAddress}"/></default-field></field><field name="status"><default-field title="Status"><label text="" style="fa fa-database ${databaseExists ? 'text-success' : 'text-danger'}" type="i" condition="checkAllBool" tooltip="Database Exists"/><label text="" style="fa fa-user ${dbUserExists ? 'text-success' : 'text-danger'}" type="i" condition="checkAllBool" tooltip="DB User Exists"/><label text="" style="fa fa-server ${instanceExists ? 'text-success' : 'text-danger'}" type="i" condition="checkAllBool" tooltip="Instance Exists"/><label text="" style="fa fa-cog ${instanceRunning ? 'text-success' : 'text-danger'}" type="i" condition="checkAllBool" tooltip="Instance Running"/><label text="" style="fa fa-heartbeat ${gotMoquiStatus ? 'text-success' : 'text-danger'}" type="i" condition="checkAllBool" tooltip="Moqui Server Running"/><label text="L:${ec.l10n.format(loadPercent, '00')}%" style="${loadPercent < 70 ? 'text-success' : (loadPercent > 90 ? 'text-warn' : 'text-danger' )}" type="strong" condition="loadPercent"/><label text="H:${ec.l10n.format(heapPercent, '00')}%" style="${heapPercent < 70 ? 'text-success' : (heapPercent > 90 ? 'text-warn' : 'text-danger' )}" type="strong" condition="heapPercent"/><label text="D:${ec.l10n.format(diskPercent, '00')}%" style="${diskPercent < 70 ? 'text-success' : (diskPercent > 90 ? 'text-warn' : 'text-danger' )}" type="strong" condition="diskPercent"/><label text="${checkErrors?:''}" type="div" style="text-danger"/></default-field></field><field name="provisionLink"><default-field title=""><link url="provisionAppInstance" text="Provision" parameter-map="[appInstanceId:appInstanceId]" condition="!checkAllBool || (!instanceExists && !databaseExists)"/></default-field></field><field name="databaseLinks"><default-field title="Database"><link url="createAppDatabase" text="Create DB" parameter-map="[appInstanceId:appInstanceId]" condition="!checkAllBool || !databaseExists"/></default-field></field><field name="instanceLinks"><default-field title="Instance"><link url="initAppInstance" text="Init" parameter-map="[appInstanceId:appInstanceId]" condition="!checkAllBool || !instanceExists"/><link url="startAppInstance" text="Start" parameter-map="[appInstanceId:appInstanceId]" condition="!checkAllBool || (instanceExists && !instanceRunning)"/><link url="stopAppInstance" text="Stop" parameter-map="[appInstanceId:appInstanceId]" condition="!checkAllBool || instanceRunning"/><link url="removeAppInstance" text="Remove" parameter-map="[appInstanceId:appInstanceId]" condition="!checkAllBool || instanceExists" confirmation="Remove instance for ${appInstanceId}?"/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://tools/screen/System/Instance/InstanceDetail.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Instance Detail"><parameter name="appInstanceId" required="true"/><transition name="updateAppInstance"><service-call name="update#moqui.server.instance.AppInstance" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createAppInstanceEnv"><service-call name="create#moqui.server.instance.AppInstanceEnv" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateAppInstanceEnv"><service-call name="update#moqui.server.instance.AppInstanceEnv" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteAppInstanceEnv"><service-call name="delete#moqui.server.instance.AppInstanceEnv" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createAppInstanceLink"><service-call name="create#moqui.server.instance.AppInstanceLink" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateAppInstanceLink"><service-call name="update#moqui.server.instance.AppInstanceLink" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteAppInstanceLink"><service-call name="delete#moqui.server.instance.AppInstanceLink" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createAppInstanceVol"><service-call name="create#moqui.server.instance.AppInstanceVolume" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updateAppInstanceVol"><service-call name="update#moqui.server.instance.AppInstanceVolume" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="deleteAppInstanceVol"><service-call name="delete#moqui.server.instance.AppInstanceVolume" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="provisionAppInstance"><service-call name="org.moqui.impl.InstanceServices.provision#AppInstance" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createAppDatabase"><service-call name="org.moqui.impl.InstanceServices.create#AppDatabase" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="initAppInstance"><service-call name="org.moqui.impl.InstanceServices.init#AppInstance" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="startAppInstance"><service-call name="org.moqui.impl.InstanceServices.start#AppInstance" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="stopAppInstance"><service-call name="org.moqui.impl.InstanceServices.stop#AppInstance" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="removeAppInstance"><service-call name="org.moqui.impl.InstanceServices.remove#AppInstance" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><entity-find-one entity-name="moqui.server.instance.AppInstance" value-field="appInstance"/><set field="envList" from="appInstance.envs"/><set field="linkList" from="appInstance.links"/><set field="volumeList" from="appInstance.vols"/><service-call name="org.moqui.impl.InstanceServices.check#AppInstance" in-map="[appInstanceId:appInstanceId]" out-map="context"/><service-call name="org.moqui.impl.InstanceServices.check#AppDatabase" in-map="[appInstanceId:appInstanceId]" out-map="context"/><service-call name="org.moqui.impl.InstanceServices.check#MoquiServer" in-map="[appInstanceId:appInstanceId]" out-map="context"/><set field="gotMoquiStatus" from="false"/><if condition="moquiStatusMap"><set field="gotMoquiStatus" from="true"/><set field="loadPercent" from="(moquiStatusMap?.Utilization?.LoadPercent as BigDecimal).setScale(0, BigDecimal.ROUND_HALF_UP)"/><set field="heapPercent" from="(moquiStatusMap?.Utilization?.HeapPercent as BigDecimal).setScale(0, BigDecimal.ROUND_HALF_UP)"/><set field="diskPercent" from="(moquiStatusMap?.Utilization?.DiskPercent as BigDecimal).setScale(0, BigDecimal.ROUND_HALF_UP)"/></if></actions><widgets><container-row><row-col md="7"><container-box><box-header title="App Instance ${appInstance.appInstanceId}"/><box-toolbar><link url="provisionAppInstance" text="Provision App" parameter-map="[appInstanceId:appInstanceId]" condition="!instanceExists && !databaseExists"/><link url="createAppDatabase" text="Create DB" parameter-map="[appInstanceId:appInstanceId]" condition="!userExists && !databaseExists"/><link url="initAppInstance" text="Init Instance" parameter-map="[appInstanceId:appInstanceId]" condition="!instanceExists"/><link url="startAppInstance" text="Start Instance" parameter-map="[appInstanceId:appInstanceId]" condition="instanceExists && !instanceRunning"/><link url="stopAppInstance" text="Stop Instance" parameter-map="[appInstanceId:appInstanceId]" condition="instanceRunning"/><link url="removeAppInstance" text="Remove Instance" parameter-map="[appInstanceId:appInstanceId]" condition="instanceExists" confirmation="Remove instance for ${appInstanceId}?"/></box-toolbar><box-body><container><label text="" style="fa fa-database ${databaseExists ? 'text-success' : 'text-danger'}" type="i" condition="true" tooltip="Database Exists"/><label text="Database ${databaseExists ? 'Exists' : 'Does Not Exist'}" style="${databaseExists ? 'text-success' : 'text-danger'}" type="strong"/><label text="" style="fa fa-user ${dbUserExists ? 'text-success' : 'text-danger'}" type="i" condition="true" tooltip="DB User Exists"/><label text="DB User ${dbUserExists ? 'Exists' : 'Does Not Exist'}" style="${dbUserExists ? 'text-success' : 'text-danger'}" type="strong"/><label text="" style="fa fa-server ${instanceExists ? 'text-success' : 'text-danger'}" type="i" condition="true" tooltip="Instance Exists"/><label text="Instance ${instanceExists ? 'Exists' : 'Does Not Exist'}" style="${instanceExists ? 'text-success' : 'text-danger'}" type="strong"/><label text="" style="fa fa-cog ${instanceRunning ? 'text-success' : 'text-danger'}" type="i" condition="true" tooltip="Instance Running"/><label text="Instance ${instanceRunning ? '' : 'Not'} Running" style="${instanceRunning ? 'text-success' : 'text-danger'}" type="strong"/></container><container><label text="" style="fa fa-heartbeat ${gotMoquiStatus ? 'text-success' : 'text-danger'}" type="i" condition="true" tooltip="Moqui Server Running"/><label text="Moqui Server ${gotMoquiStatus ? '' : 'Not'} Running" style="${gotMoquiStatus ? 'text-success' : 'text-danger'}" type="strong"/><label text="Load: ${ec.l10n.format(loadPercent, '00')}%" style="${loadPercent < 70 ? 'text-success' : (loadPercent < 90 ? 'text-warn' : 'text-danger' )}" type="strong" condition="loadPercent"/><label text="Heap: ${ec.l10n.format(heapPercent, '00')}%" style="${heapPercent < 70 ? 'text-success' : (heapPercent < 90 ? 'text-warn' : 'text-danger' )}" type="strong" condition="heapPercent"/><label text="Disk: ${ec.l10n.format(diskPercent, '00')}%" style="${diskPercent < 70 ? 'text-success' : (diskPercent < 90 ? 'text-warn' : 'text-danger' )}" type="strong" condition="diskPercent"/></container><container-dialog id="InstanceDetail" button-text="Instance Detail" width="900"><label text="${groovy.json.JsonOutput.prettyPrint(groovy.json.JsonOutput.toJson(inspectMap))}" type="pre" style="pre-plain"/></container-dialog><container-dialog id="MoquiServerDetail" button-text="Moqui Server Detail"><label text="${groovy.json.JsonOutput.prettyPrint(groovy.json.JsonOutput.toJson(moquiStatusMap))}" type="pre" style="pre-plain"/></container-dialog><container-dialog id="InstanceLog" button-text="Instance Log" width="900"><label text="${instanceLog}" type="pre" style="pre-plain"/></container-dialog><link url="http://${appInstance.hostName}" url-type="plain" text="http://${appInstance.hostName}" link-type="anchor-button" target-window="_blank"/><form-single name="UpdateInstance" transition="updateAppInstance" map="appInstance"><field name="appInstanceId"><default-field><hidden/></default-field></field><field name="instanceName"><default-field><text-line size="50"/></default-field></field><field name="instanceUuid"><default-field title="Instance UUID"><display/></default-field></field><field name="hostName"><default-field tooltip="Hostname for access to the instance, generally a virtual host name"><text-line size="50"/></default-field></field><field name="instanceImageId"><default-field title="Image"><drop-down><entity-options key="${instanceImageId}" text="${imageName} - ${hostTypeDescription} - ${imageTypeDescription}"><entity-find entity-name="moqui.server.instance.InstanceImageDetail"><order-by field-name="imageName"/></entity-find></entity-options></drop-down></default-field></field><field name="instanceHostId"><default-field title="Instance Host"><drop-down allow-empty="true"><entity-options key="${instanceHostId}" text="${typeDescription} ${hostAddress}"><entity-find entity-name="moqui.server.instance.InstanceHostDetail"><order-by field-name="typeDescription"/></entity-find></entity-options></drop-down></default-field></field><field name="databaseHostId"><default-field title="Database Host"><drop-down allow-empty="true"><entity-options key="${databaseHostId}" text="${typeDescription} ${hostAddress}"><entity-find entity-name="moqui.server.instance.DatabaseHostDetail"><order-by field-name="typeDescription"/></entity-find></entity-options></drop-down></default-field></field><field name="initCommand"><default-field title="Init Command (Parameter)"><text-line size="50"/></default-field></field><field name="networkMode"><default-field><text-line size="30"/></default-field></field><field name="jsonConfig"><default-field title="JSON Config"><text-area cols="50" rows="5"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></box-body></container-box></row-col><row-col md="5"><container-box><box-header title="Environment Variables"/><box-toolbar><container-dialog id="AddEnvDialog" button-text="Add Env Var"><form-single name="AddEnv" transition="createAppInstanceEnv"><field name="appInstanceId"><default-field><hidden/></default-field></field><field name="envName"><default-field title="Name"><text-line size="30"/></default-field></field><field name="envValue"><default-field title="Value"><text-line size="30"/></default-field></field><field name="submitButton"><default-field title="Add Env"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><label text="After updating environment variables the instance must be removed and re-initialized for them to take effect"/></box-body><box-body-nopad><form-list name="EnvList" list="envList" transition="updateAppInstanceEnv"><field name="appInstanceId"><default-field><hidden/></default-field></field><field name="envName"><default-field title="Name"><display/></default-field></field><field name="envValue"><default-field title="Value"><text-line size="30"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field name="deleteLink"><default-field title=""><link url="deleteAppInstanceEnv" text="X" parameter-map="[appInstanceId:appInstanceId, envName:envName]" confirmation="Really delete env ${envName}?"/></default-field></field></form-list></box-body-nopad></container-box><container-box><box-header title="Volumes"/><box-toolbar><container-dialog id="AddVolDialog" button-text="Add Volume"><form-single name="AddVol" transition="createAppInstanceVol"><field name="appInstanceId"><default-field><hidden/></default-field></field><field name="mountPoint"><default-field title="Mountpoint"><text-line size="30"/></default-field></field><field name="volumeName"><default-field title="Name"><text-line size="30"/></default-field></field><field name="submitButton"><default-field title="Add Volume"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><label text="After updating volumes the instance must be removed and re-initialized for them to take effect, note that these operations may result in loss of data"/></box-body><box-body-nopad><form-list name="VolList" list="volumeList" transition="updateAppInstanceVol"><field name="appInstanceId"><default-field><hidden/></default-field></field><field name="mountPoint"><default-field title="Mountpoint"><display/></default-field></field><field name="volumeName"><default-field title="Volume Name"><text-line size="30"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field name="deleteLink"><default-field title=""><link url="deleteAppInstanceVol" text="X" parameter-map="[appInstanceId:appInstanceId, mountPoint:mountPoint]" confirmation="Really delete volume ${volumeName}?"/></default-field></field></form-list></box-body-nopad></container-box><container-box><box-header title="Instance (Container) Links"/><box-toolbar><container-dialog id="AddLinkDialog" button-text="Add Link"><form-single name="AddLink" transition="createAppInstanceLink"><field name="appInstanceId"><default-field><hidden/></default-field></field><field name="instanceName"><default-field><text-line size="25"/></default-field></field><field name="aliasName"><default-field><text-line size="25"/></default-field></field><field name="submitButton"><default-field title="Add Link"><submit/></default-field></field></form-single></container-dialog></box-toolbar><box-body><label text="After updating links the instance must be removed and re-initialized for them to take effect"/></box-body><box-body-nopad><form-list name="LinkList" list="linkList" transition="updateAppInstanceLink"><field name="appInstanceId"><default-field><hidden/></default-field></field><field name="instanceName"><default-field><display/></default-field></field><field name="aliasName"><default-field><text-line size="25"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field name="deleteLink"><default-field title=""><link url="deleteAppInstanceLink" text="X" parameter-map="[appInstanceId:appInstanceId, instanceName:instanceName]" confirmation="Really delete link for ${instanceName}?"/></default-field></field></form-list></box-body-nopad></container-box></row-col></container-row></widgets></screen>
<!-- Screen Location component://tools/screen/System/Instance.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Instances" default-menu-index="15"><subscreens default-item="InstanceList"/><widgets><subscreens-panel id="InstancePanel" type="tab"/></widgets></screen>
<!-- Screen Location component://tools/screen/System/LogViewer.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Log Viewer" default-menu-index="20"><transition name="userAccountDetail"><default-response url="//apps/system/Security/UserAccount/UserAccountDetail"/></transition><actions><set field="indexName" from="indexName ?: 'moqui_logs'"/><set field="pageIndex" from="(pageIndex?:'0') as int"/><set field="pageSize" from="(pageSize?:'100') as int"/><if condition="!tsPeriod_period && !tsPeriod_from && !tsPeriod_thru"><set field="tsPeriod_period" from="tsPeriod_period ?: '7d'"/><set field="tsPeriod_poffset" from="tsPeriod_poffset ?: '-1'"/></if><set field="tsList" from="ec.user.getPeriodRange('tsPeriod', context)"/><script><![CDATA[/* useful docs for query API: https://www.elastic.co/guide/reference/api/search/uri-request/ */

            import org.moqui.context.ExecutionContext
            ExecutionContext ec = context.ec

            def elasticClient = ec.factory.elastic.getClient("logger") ?: ec.factory.elastic.getClient("default")
            if (elasticClient == null) {
                ec.message.addError("Could not find ElasticClient for cluster name logger or default")
                return
            }

            int fromOffset = pageIndex * pageSize
            int sizeLimit = pageSize

            // build query string
            if (tsList != null && (tsList.get(0) != null || tsList.get(1) != null)) {
                actualQuery = '@timestamp:[' + (tsList.get(0) != null ? tsList.get(0).time : '*') + ' TO ' + (tsList.get(1) != null ? tsList.get(1).time : '*') + ']'
                if (queryString) actualQuery = actualQuery + ' AND (' + queryString + ')'
            } else {
                actualQuery = queryString ?: '*'
            }

            // query string: https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-query-string-query.html
            // had time_zone but shouldn't matter using epoch_millis format and causes issues sometimes: time_zone:TimeZone.default.getID()
            Map queryMap = [query_string:[query:actualQuery, lenient:true]]
            Map searchMap = [query:queryMap, from:fromOffset, size:sizeLimit, track_total_hits:true, sort:[['@timestamp':'desc']]]

            // validate the query
            // TODO: consider pulling error message from ElasticSearch, but they are pretty ugly
            Map validateRespMap = elasticClient.validateQuery((String) indexName, queryMap, true)
            if (validateRespMap != null) {
                ec.message.addMessage("Invalid search: ${queryString}", "danger")
                List explanations = (List) validateRespMap.explanations
                if (explanations) for (Map explanation in explanations) ec.message.addMessage(explanation.error, "danger")
                return
            }

            // get the search hits
            Map resultMap = elasticClient.search((String) indexName, searchMap)
            Map hitsMap = (Map) resultMap.hits

            List<Map> hitsList = (List<Map>) hitsMap.hits
            documentList = []
            for (Map hit in hitsList) {
                Map document = (Map) hit._source
                document._id = hit._id
                documentList.add(document)
            }

            // get the total search count
            documentListCount = hitsMap.total.value

            // calculate the pagination values
            documentListPageIndex = pageIndex
            documentListPageSize = pageSize
            documentListPageMaxIndex = ((BigDecimal) documentListCount - 1).divide(documentListPageSize, 0, BigDecimal.ROUND_DOWN) as int
            documentListPageRangeLow = documentListPageIndex * documentListPageSize + 1
            documentListPageRangeHigh = (documentListPageIndex * documentListPageSize) + documentListPageSize
            if (documentListPageRangeHigh > documentListCount) documentListPageRangeHigh = documentListCount

            // show in reverse order, but still higher pages going back in time
            documentList = documentList.reverse()]]></script></actions><widgets><link url="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-query-string-query.html#query-string-syntax" url-type="plain" link-type="anchor" target-window="_blank" text="Query String Reference"/><form-single name="SearchOptions" transition="."><field name="indexName"><default-field title=""><text-line size="12" default-value="moqui_logs"/></default-field></field><field name="queryString"><default-field title=""><text-line size="60"/></default-field></field><field name="tsPeriod"><default-field title=""><date-period time="true"/></default-field></field><field name="submitButton"><default-field title="Search"><submit/></default-field></field><field-layout><field-row-big><field-ref name="indexName"/><field-ref name="queryString"/><field-ref name="tsPeriod"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single><label text="Date Range: ${ec.l10n.format(tsList.get(0), 'yyyy-MM-dd HH:mm:ss.SSS') ?: '*'} to ${ec.l10n.format(tsList.get(1), 'yyyy-MM-dd HH:mm:ss.SSS') ?: '*'}" type="p"/><label text="Full query: ${actualQuery}" type="p"/><section-iterate name="messageInfos" list="ec.message.messageInfos" entry="messageInfo"><widgets><container><label text="${messageInfo.message}" type="strong" style="text-${messageInfo.typeString}"/></container></widgets></section-iterate><form-list name="LogMessageDocuments" list="documentList" paginate="true" paginate-always-show="true" skip-form="true" show-page-size="true"><row-actions><set field="levelStyle" from="'ERROR'.equals(level) ? 'text-danger' : ('WARN'.equals(level) ? 'text-warning' : ('INFO'.equals(level) ? 'text-success' : ''))"/></row-actions><field name="@timestamp"><default-field container-style="text-nowrap ${levelStyle}"><display text="${ec.l10n.format(new Timestamp(context.get('@timestamp')), 'yyyy-MM-dd HH:mm:ss.SSS')}" encode="false"/></default-field></field><field name="thread_name"><default-field title="thread_name" container-style="text-nowrap ${levelStyle}"><display text="${thread_name}(${thread_id}:${thread_priority})"/></default-field></field><field name="level"><default-field title="level" container-style="${levelStyle}"><display/></default-field></field><field name="source_host"><default-field title="source_host" container-style="text-nowrap ${levelStyle}"><display/></default-field></field><field name="user_id"><default-field title="user_id"><link url="userAccountDetail" text="${user_id}" link-type="anchor" parameter-map="[userId:user_id]" condition="user_id"/></default-field></field><field name="visitor_id"><default-field title="visitor_id" container-style="${levelStyle}"><display/></default-field></field><field name="logger_name"><default-field title="logger_name" container-style="${levelStyle}"><display/></default-field></field><field name="message"><conditional-field condition="message != null && message.length() > 300"><display text="${message.substring(0, 300)} "/><container-dialog id="ViewMessage" button-text="All" width="800"><label text="${message}"/></container-dialog></conditional-field><default-field title="message"><display/></default-field></field><field name="thrownView"><conditional-field condition="thrown"><container-dialog id="ViewThrown" button-text="Thrown" width="960"><label text="${groovy.json.JsonOutput.prettyPrint(groovy.json.JsonOutput.toJson(thrown))}" type="pre"/></container-dialog></conditional-field><default-field title=""><display/></default-field></field><form-list-column><field-ref name="@timestamp"/><field-ref name="thread_name"/></form-list-column><form-list-column><field-ref name="level"/><field-ref name="source_host"/></form-list-column><form-list-column><field-ref name="user_id"/><field-ref name="visitor_id"/></form-list-column><form-list-column><field-ref name="logger_name"/><field-ref name="message"/></form-list-column><form-list-column><field-ref name="thrownView"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://tools/screen/System/ThreadList.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-index="99" default-menu-title="Thread List"><transition name="interruptThread"><parameter name="threadName"/><actions><script><![CDATA[boolean found = false
            for (Thread thread in Thread.getAllStackTraces().keySet()) {
                if (thread.name == threadName) {
                    found = true
                    try {
                        thread.interrupt()
                        ec.message.addMessage("Interrupted thread ${threadName}", "success")
                    } catch (Throwable t) {
                        ec.logger.log(300, "Error interrupting thread ${thread.id}:${thread.name}", t)
                        ec.message.addMessage("Error interrupting thread ${thread.id}:${thread.name}: ${t.toString()}", "danger")
                    }
                }
            }
            if (!found) ec.message.addMessage("Could not find thread with name ${threadName}", "warning")]]></script></actions><default-response url="."/></transition><transition name="setWorkerPoolSize"><actions><script><![CDATA[ec.factory.workerPool.setCorePoolSize(coreSize as int); ec.factory.workerPool.setMaximumPoolSize(maxSize as int)]]></script></actions><default-response url="."/></transition><transition name="scheduledReInit"><actions><script><![CDATA[ec.factory.scheduledReInit()]]></script></actions><default-response url="."/></transition><actions><set field="workerPool" from="ec.factory.workerPool"/><set field="scheduledExecutor" from="ec.factory.scheduledExecutor"/><set field="scheduledRunnableList" from="ec.factory.scheduledRunnableList"/><set field="jobRunner" from="ec.service.getJobRunner()"/><set field="orderByField" from="orderByField ?: 'threadName'"/><set field="threadMXBean" from="java.lang.management.ManagementFactory.getThreadMXBean()"/><set field="deadlockedList" from="threadMXBean.findDeadlockedThreads()"/><set field="threadInfoList" from="threadMXBean.dumpAllThreads(false, false)"/><script><![CDATA[threadMapList = []
        for (java.lang.management.ThreadInfo thread in threadInfoList) {
            threadMapList.add([threadName:thread.threadName, threadId:thread.threadId, threadState:thread.threadState.name(),
                    cpuTime:threadMXBean.getThreadCpuTime(thread.threadId), userTime:threadMXBean.getThreadUserTime(thread.threadId),
                    lockName:thread.lockName, lockOwnerName:thread.lockOwnerName, lockOwnerId:thread.lockOwnerId,
                    blockedTime:thread.blockedTime, waitedTime:thread.waitedTime,
                    stackList:Arrays.asList(thread.getStackTrace()).collect({ it.toString() })])
        }
        orderMapList(threadMapList, [orderByField])]]></script></actions><widgets><label text="Threads: ${threadMXBean.getThreadCount()}, Peak: ${threadMXBean.getPeakThreadCount()}"/><label text="Deadlocked Threads: ${deadlockedList}" style="text-danger" condition="deadlockedList"/><container><label text="Worker Pool" type="strong"/><label text="Threads" type="strong"/><label text="Active: ${workerPool.getActiveCount()} Cur: ${workerPool.getPoolSize()} Max: ${workerPool.getMaximumPoolSize()}" style="${workerPool.getActiveCount() == workerPool.getMaximumPoolSize() ? 'text-warning' : ''}"/><label text="Queue" type="strong"/><label text="Cur: ${workerPool.queue.size()} Rem: ${workerPool.queue.remainingCapacity()}" style="workerPool.queue.remainingCapacity() == 0 ? 'text-danger' : (workerPool.queue.size() > workerPool.queue.remainingCapacity() ? 'text-warning' : '')"/><container-dialog id="SetWorkerPoolDialog" button-text="Set Pool Size"><label text="NOTE: Max Size must be greater than or equal to Core Size" type="p"/><form-single name="SetWorkerPoolForm" transition="setWorkerPoolSize"><field name="coreSize" from="workerPool.getCorePoolSize()"><default-field><text-line size="5"/></default-field></field><field name="maxSize" from="workerPool.getMaximumPoolSize()"><default-field><text-line size="5"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></container-dialog></container><container><label text="Scheduled Executor" type="strong"/><label text="Active: ${scheduledExecutor.getActiveCount()} Cur: ${scheduledExecutor.getPoolSize()} Max: ${scheduledExecutor.getMaximumPoolSize()}" style="${scheduledExecutor.getActiveCount() == scheduledExecutor.getMaximumPoolSize() ? 'text-warning' : ''}"/><label text="Queue (scheduled runnables):" type="strong"/><label text="${scheduledExecutor.queue.size()}" style="${scheduledExecutor.queue.size() < scheduledRunnableList.size() ? 'text-danger' : ''}"/><container-dialog id="ScheduledQueueDialog" button-text="Scheduled Queue"><section-iterate name="ScheduledQueueList" list="scheduledExecutor.queue" entry="scheduledRunnable"><widgets><container><label text="${scheduledRunnable.toString()} Done? ${scheduledRunnable.isDone()} Cancelled? ${scheduledRunnable.isCancelled()}"/></container></widgets></section-iterate></container-dialog><container-dialog id="ScheduledRunnableDialog" button-text="Initial Runnables"><section-iterate name="ScheduledRunnableList" list="scheduledRunnableList" entry="scheduledRunnable"><widgets><container><label text="${scheduledRunnable.command.class.name} Period ${scheduledRunnable.period}s"/></container></widgets></section-iterate><link url="scheduledReInit" text="Re-Queue Initial" confirmation="Re-queue initial runnables? Do this only if there are issues with scheduled runnables."/></container-dialog></container><section name="JobRunnerInfo" condition="jobRunner"><widgets><label text="Last job runner execute: <strong>${new Timestamp(jobRunner.getLastExecuteTime())}</strong>, runner executes: ${jobRunner.getExecuteCount()}, total jobs run: ${jobRunner.getTotalJobsRun()}, last active: ${jobRunner.getLastJobsActive()}, last paused: ${jobRunner.getLastJobsPaused()}" encode="false"/></widgets><fail-widgets><label text="No Service Job Runner active (generally because scheduled-job-check-time is set to 0)"/></fail-widgets></section><form-list name="ThreadList" list="threadMapList" skip-form="true" select-columns="true"><field name="threadName"><header-field title="Name" show-order-by="case-insensitive"/><default-field><display/></default-field></field><field name="threadId"><header-field title="ID" show-order-by="true"/><default-field><display/></default-field></field><field name="threadState"><header-field title="State" show-order-by="true"/><default-field><display/></default-field></field><field name="cpuTime"><header-field title="CPU Time" show-order-by="true"/><default-field><display text="${ec.l10n.format(cpuTime/1E9, '#,##0.000')}s"/></default-field></field><field name="userTime"><header-field show-order-by="true"/><default-field><display text="${ec.l10n.format(cpuTime/1E9, '#,##0.000')}s"/></default-field></field><field name="lockName"><header-field title="Lock" show-order-by="true"/><default-field><display/></default-field></field><field name="lockOwnerName"><header-field title="Lock Owner" show-order-by="true"/><default-field><display/></default-field></field><field name="lockOwnerId"><header-field title="Lock Owner ID" show-order-by="true"/><default-field><display/></default-field></field><field name="blockedTime"><header-field title="Blocked Total" show-order-by="true"/><default-field><display/></default-field></field><field name="waitedTime"><header-field title="Waited Total" show-order-by="true"/><default-field><display/></default-field></field><field name="stack"><default-field title=""><container-dialog id="StackListDialog" button-text="Stack" type="default" width="960"><label text="${stackList.join('\n')}" type="pre"/></container-dialog></default-field></field><field name="interrupt"><default-field title=""><link url="interruptThread" text="Interrupt" confirmation="Really interrupt thread ${threadName}?" btn-type="danger"/></default-field></field><form-list-column><field-ref name="threadName"/></form-list-column><form-list-column><field-ref name="threadId"/></form-list-column><form-list-column><field-ref name="threadState"/></form-list-column><form-list-column><field-ref name="cpuTime"/></form-list-column><form-list-column><field-ref name="userTime"/></form-list-column><form-list-column><field-ref name="stack"/></form-list-column><form-list-column><field-ref name="interrupt"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://tools/screen/System.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="System" menu-image="fa fa-cog" menu-image-type="icon"><subscreens default-item="dashboard"/><widgets><subscreens-panel id="system-panel" type="popup"/></widgets></screen>
<!-- Screen Location component://tools/screen/Tools/dashboard.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-index="1" menu-image="fa fa-dashboard" menu-image-type="icon"><transition name="reloadEcfi" begin-transaction="false"><actions><script><![CDATA[ec.factory.triggerDynamicReInit()]]></script><message><![CDATA[ExecutionContextFactory dynamic re-initialize triggered]]></message></actions><default-response url="."/></transition><widgets><container-row><row-col lg="6" md="6"><container-box><box-header title="General Tools"/><box-body><link url="../AutoScreen" text="Auto Screens"/><link url="../ArtifactStats" text="Artifact Stats"/><link url="../GroovyShell" text="Groovy Shell" condition="ec.user.hasPermission('GROOVY_SHELL_WEB')"/><link url="../Service/ServiceLoadRunner" text="Service LoadRunner" condition="ec.user.hasPermission('SERVICE_LOAD_RUNNER')"/><link url="../Service" text="Services"/></box-body></container-box><section name="RestApiSection"><actions><set field="restUrl" from="sri.buildUrl('/rest').url"/><set field="rootResources" from="ec.service.restApi.getFreshRootResources()"/><set field="masterEntityNameList" from="ec.entity.getAllEntityNamesWithMaster()"/></actions><widgets><container-box><box-header title="REST API: Swagger UI"/><box-body><section-iterate name="RootResourcesSection" list="rootResources" entry="resource"><widgets><section name="RootResourceChildren" condition="resource.childMethods > 100"><widgets><container-dialog id="RootResourceSwaggerDialog" button-text="${resource.displayName ?: resource.name} (${resource.childMethods})"><section-iterate name="RootResourceSwaggerSection" list="resource.resourceMap.values()" entry="childResource"><widgets><container><link url="/toolstatic/lib/swagger-ui/index.html?url=${restUrl}/service.swagger/${resource.name}/${childResource.name}" text="${childResource.displayName ?: childResource.description ?: childResource.name} (${childResource.childMethods})" url-type="plain" link-type="anchor" target-window="_blank"/></container></widgets></section-iterate></container-dialog></widgets><fail-widgets><link url="/toolstatic/lib/swagger-ui/index.html?url=${restUrl}/service.swagger/${resource.name}" url-type="plain" target-window="_blank" text="${resource.displayName ?: resource.name} (${resource.childMethods})" tooltip="${resource.description ?: ''}"/></fail-widgets></section></widgets></section-iterate><container-dialog id="EntitySwagger" button-text="Entity Master API"><section-iterate name="EntitySwaggerSection" list="masterEntityNameList" entry="masterEntityName"><widgets><container><link url="/toolstatic/lib/swagger-ui/index.html?url=${restUrl}/master.swagger/${masterEntityName}" url-type="plain" text="${masterEntityName}" link-type="anchor" target-window="_blank"/></container></widgets></section-iterate></container-dialog><label text="The larger APIs take a few seconds to load. Runs in same session (already authenticated)." type="p"/></box-body></container-box></widgets></section></row-col><row-col lg="6" md="6"><container-box><box-header title="Entity Tools"/><box-body><container><link url="../Entity/DataImport" text="Data Import"/><link url="../Entity/DataExport" text="Data Export"/><link url="../Entity/DataSnapshot" text="Data Snapshots"/><link url="../Entity/SqlScriptRunner" text="SQL Script Runner" condition="ec.user.hasPermission('SQL_RUNNER_WEB')"/><link url="../Entity/SqlRunner" text="SQL Runner" condition="ec.user.hasPermission('SQL_RUNNER_WEB')"/></container><container><link url="../Entity/DataEdit" text="Entities"/><link url="../DataView" text="Data Views"/><link url="../Entity/SpeedTest" text="Speed Test"/><link url="../Entity/TableStats" text="Table Stats"/><link url="../Entity/QueryStats" text="Query Stats"/></container></box-body></container-box><container-box><box-header title="Generated Diagrams"/><box-body><container><link url="../StatusFlows" text="Status Flows"/></container></box-body></container-box></row-col></container-row></widgets></screen>
<!-- Screen Location component://tools/screen/Tools/AutoScreen/MainEntityList.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Auto Screen Entity List" default-menu-index="1"><transition name="find"><default-response url="../AutoFind"/></transition><actions><set field="allEntityList" from="ec.entity.getAllEntitiesInfo(orderByField?:'fullEntityName', null, false, false)"/><set field="masterEntityList" from="ec.entity.getAllEntitiesInfo(orderByField?:'fullEntityName', null, true, true)"/></actions><widgets><form-single name="SelectEntity" transition="find"><field name="aen"><default-field title="All Entities"><drop-down allow-empty="true"><list-options list="allEntityList" key="${fullEntityName}" text="${entityName} - ${context.package}"/></drop-down></default-field></field><field name="submitButton"><default-field title="Select"><submit/></default-field></field><field-layout><field-row-big><field-ref name="aen"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single><form-list name="EntityList" list="masterEntityList"><field name="package"><header-field show-order-by="true"/><default-field><display also-hidden="false"/></default-field></field><field name="aen"><header-field title="Master Entity" show-order-by="true"/><default-field><link url="find" text="${ec.entity.getEntityDefinition(entityName).getPrettyName(null, null)}" link-type="anchor"><parameter name="aen" from="fullEntityName"/></link></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://tools/screen/Tools/AutoScreen/AutoFind.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Find" default-menu-index="2"><parameter name="aen" required="true"/><transition name="list"><default-response url="../MainEntityList"/></transition><transition name="find"><default-response url="."/></transition><transition name="entityDetail"><default-response url="../../Entity/DataEdit/EntityDetail"/></transition><transition name="create"><actions><service-call name="create#${aen}" in-map="true"/></actions><default-response url="."/></transition><transition name="deleteRecord"><actions><service-call name="delete#${aen}" in-map="context"/></actions><default-response url="."/></transition><transition name="getFormXml" read-only="true"><actions><script><![CDATA[import org.moqui.util.MNode

            StringBuilder xmlBuilder = new StringBuilder()
            xmlBuilder.append('<?xml version="1.0" encoding="UTF-8"?>\n')
            MNode screenNode = new MNode("screen", ["xmlns:xsi": "http://www.w3.org/2001/XMLSchema-instance", "xsi:noNamespaceSchemaLocation": "http://moqui.org/xsd/xml-screen-3.xsd"])
            MNode actionsNode = screenNode.append("actions", null)
            actionsNode.append("entity-find", ["entity-name":aen, list:"entityValueList"]).append("search-form-inputs", null)
            MNode widgetsNode = screenNode.append("widgets", null)
            widgetsNode.append(sri.getActiveScreenDef().getForm("FindEntityValue").getAutoCleanedNode())
            widgetsNode.append(sri.getActiveScreenDef().getForm("CreateEntityValue").getAutoCleanedNode())
            widgetsNode.append(sri.getActiveScreenDef().getForm("ListEntityValue").getAutoCleanedNode())
            screenNode.addToSb(xmlBuilder, 0)
            ec.web.sendTextResponse(xmlBuilder.toString(), "text/xml", "Find${ec.entity.getEntityDefinition(aen).entityName}.xml")]]></script></actions><default-response type="none"/></transition><actions><set field="aenDef" from="ec.entity.getEntityDefinition(aen)"/><if condition="aenDef == null"><message error="true"><![CDATA[Could not find entity with name: ${aen}]]></message><return/></if><set field="recordCount" from="ec.entity.find(aen).count()"/></actions><widgets><container><link url="list" text="Entity List" link-type="hidden-form"/><container-dialog id="FindValueDialog" button-text="Find Options" width="800"><form-single name="FindEntityValue" transition="find" dynamic="true"><auto-fields-entity entity-name="${aen}" field-type="find"/><field name="aen"><default-field><hidden/></default-field></field><field name="submitButton"><default-field title="Find"><submit/></default-field></field></form-single></container-dialog><link url="entityDetail" parameter-map="[selectedEntity:aen]" text="Entity Detail"/><container-dialog id="CreateValueDialog" button-text="New Value"><form-single name="CreateEntityValue" transition="create" dynamic="true"><auto-fields-entity entity-name="${aen}" field-type="edit"/><field name="aen"><default-field><hidden/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog><label text="Find ${aenDef.getPrettyName(null, null)}" type="strong"/></container><form-list name="ListEntityValue" list="entityValueList" list-entry="entityValue" header-dialog="true" skip-form="true" dynamic="true" show-csv-button="true" show-xlsx-button="true" show-page-size="true"><entity-find entity-name="${aen}" list="entityValueList" offset="0" limit="50" cache="false" use-clone="true"><search-form-inputs require-parameters="${recordCount > 1000000 ? 'true' : 'false'}"/></entity-find><field name="aen"><header-field><hidden/></header-field><default-field><hidden/></default-field></field><field name="find"><header-field title="Find"><submit/></header-field></field><field name="edit"><conditional-field title="" condition="entityValue != null"><link url="../AutoEdit/AutoEditMaster" text="" icon="fa fa-pencil" parameter-map="entityValue.getPrimaryKeys()"/></conditional-field><default-field title=""><display text=" "/></default-field></field><field name="delete"><conditional-field title="" condition="entityValue != null"><link url="deleteRecord" text="" icon="fa fa-trash" confirmation="Are you sure?" parameter-map="entityValue.getPrimaryKeys()"/></conditional-field><default-field title=""><display text=" "/></default-field></field><auto-fields-entity entity-name="${aen}" field-type="find-display"/><field name="lastUpdatedStamp"><default-field title="Last Updated"><display format="yyyy-MM-dd HH:mm:ss"/></default-field></field><columns><column><field-ref name="edit"/><field-ref name="delete"/></column><column><field-ref name="lastUpdatedStamp"/></column></columns></form-list><link url="getFormXml" text="Get Forms XML" link-type="anchor"/></widgets></screen>
<!-- Screen Location component://tools/screen/Tools/AutoScreen/AutoEdit/AutoEditDetail.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Edit Detail" default-menu-index="3"><parameter name="aen" required="true"/><parameter name="den" required="true"/><transition name="list"><default-response url="../../MainEntityList"/></transition><transition name="find"><default-response url="../../AutoFind"/></transition><transition name="create"><actions><service-call name="create#${den}" in-map="true"/></actions><default-response url="." parameter-map="ec.entity.getEntityDefinition(aen).getPrimaryKeys(context)"/></transition><transition name="update"><actions><service-call name="update#${den}" in-map="true"/></actions><default-response url="." parameter-map="ec.entity.getEntityDefinition(aen).getPrimaryKeys(context)"/></transition><transition name="deleteRecord"><actions><service-call name="delete#${den}" in-map="context"/></actions><default-response url="." parameter-map="ec.entity.getEntityDefinition(aen).getPrimaryKeys(context)"/></transition><transition name="getFormXml" read-only="true"><actions><script><![CDATA[import org.moqui.util.MNode

            StringBuilder xmlBuilder = new StringBuilder()
            xmlBuilder.append('<?xml version="1.0" encoding="UTF-8"?>\n')

            MNode screenNode = new MNode("screen", ["xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance", "xsi:noNamespaceSchemaLocation":"http://moqui.org/xsd/xml-screen-3.xsd"])
            MNode createTransNode = screenNode.append("transition", [name:"create"])
            createTransNode.append("service-call", [name:"create#${den}".toString()])
            createTransNode.append("default-response", [url:"."])
            MNode updateTransNode = screenNode.append("transition", [name:"update"])
            updateTransNode.append("service-call", [name:"update#${den}".toString()])
            updateTransNode.append("default-response", [url:"."])

            MNode actionsNode = screenNode.append("actions", null)
            actionsNode.append("entity-find", ["entity-name":den, list:"entityValueList"]).append("search-form-inputs", null)

            MNode widgetsNode = screenNode.append("widgets", null)
            widgetsNode.append(sri.getActiveScreenDef().getForm("CreateEntityValue").getAutoCleanedNode())
            widgetsNode.append(sri.getActiveScreenDef().getForm("ListEntityValue").getAutoCleanedNode())
            screenNode.addToSb(xmlBuilder, 0)

            ec.web.sendTextResponse(xmlBuilder.toString(), "text/xml", "${ec.entity.getEntityDefinition(aen).entityName}${ec.entity.getEntityDefinition(den).entityName}s.xml")]]></script></actions><default-response type="none"/></transition><actions><entity-find entity-name="${den}" list="entityValueList" offset="0" limit="50" cache="false"><search-form-inputs/></entity-find></actions><widgets><container><link url="list" text="Entity List" link-type="hidden-form"/><link url="find" text="Find ${ec.entity.getEntityDefinition(aen).getPrettyName(null, null)}" link-type="hidden-form"/><container-dialog id="CreateValueDialog" button-text="New ${ec.entity.getEntityDefinition(den).getPrettyName(null, aen)}"><form-single name="CreateEntityValue" transition="create" dynamic="true"><auto-fields-entity entity-name="${den}" field-type="edit"/><field name="aen"><default-field><hidden/></default-field></field><field name="den"><default-field><hidden/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog></container><form-list name="ListEntityValue" list="entityValueList" list-entry="entityValue" header-dialog="true" skip-form="true" dynamic="true"><field name="aen"><header-field><hidden/></header-field><default-field><hidden/></default-field></field><field name="den"><header-field><hidden/></header-field><default-field><hidden/></default-field></field><field name="find"><header-field title="Find"><submit/></header-field></field><field name="edit"><conditional-field title="" condition="entityValue != null"><link url="../AutoEditMaster" text="" icon="fa fa-pencil" parameter-map="entityValue.getPrimaryKeys() + [aen:den, den:null]"/></conditional-field><default-field title=""><display text=" "/></default-field></field><field name="delete"><conditional-field title="" condition="entityValue != null"><link url="deleteRecord" text="" icon="fa fa-trash" confirmation="Are you sure?" parameter-map="entityValue.getPrimaryKeys()"/></conditional-field><default-field title=""><display text=" "/></default-field></field><auto-fields-entity entity-name="${den}" field-type="find-display"/><field name="lastUpdatedStamp"><default-field title="Last Updated"><display format="yyyy-MM-dd HH:mm:ss"/></default-field></field><columns><column><field-ref name="edit"/><field-ref name="delete"/></column><column><field-ref name="lastUpdatedStamp"/></column></columns></form-list><link url="getFormXml" text="Get Forms XML" link-type="anchor"/></widgets></screen>
<!-- Screen Location component://tools/screen/Tools/AutoScreen/AutoEdit/AutoEditMaster.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Edit Master" default-menu-index="3"><parameter name="aen" required="true"/><parameter name="den"/><transition name="list"><default-response url="../../MainEntityList"/></transition><transition name="find"><default-response url="../../AutoFind"/></transition><transition name="edit"><default-response url="."/></transition><transition name="update"><actions><service-call name="update#${aen}" in-map="true"/></actions><default-response url="." parameter-map="ec.entity.getEntityDefinition(aen).getPrimaryKeys(context)"/></transition><transition name="export" read-only="true"><actions><entity-find-one entity-name="${aen}" value-field="entityValue"/><script><![CDATA[import org.moqui.context.ExecutionContext
                import org.moqui.entity.EntityDataWriter

                Map pkMap = entityValue.getPrimaryKeys()
                if (!filename) filename = (aen.contains(".") ? aen.substring(aen.lastIndexOf(".") + 1) : aen) + "_" +
                        pkMap.values().join("_") + "." + (fileType == 'JSON' ? 'json' : 'xml')

                ExecutionContext ec = context.ec
                EntityDataWriter edw = ec.entity.makeDataWriter().dependentLevels((dependentLevels ?: '2') as int)
                        .fileType(fileType == 'JSON' ? EntityDataWriter.JSON : EntityDataWriter.XML)
                        .entityName(aen).filterMap(pkMap)
                if (masterName) edw.master(masterName)
                noResponse = false
                if (context.output == "file") {
                    edw.file(filename)
                } else if (context.output == "browser") {
                    // stream to ec.web.response
                    def response = ec.web.response
                    response.setContentType(fileType == 'JSON' ? 'application/json' : 'text/xml')
                    response.setCharacterEncoding("UTF-8")
                    response.setHeader("Content-Disposition", "attachment; filename=\"${filename}\";")
                    response.setHeader("Cache-Control", "no-cache, must-revalidate, private")
                    edw.writer(response.getWriter())
                    noResponse = true
                }]]></script></actions><conditional-response url="." parameter-map="ec.entity.getEntityDefinition(aen).getPrimaryKeys(context)"><condition><expression><![CDATA[!noResponse]]></expression></condition></conditional-response><default-response type="none"/></transition><transition name="getFormXml" read-only="true"><actions><script><![CDATA[import org.moqui.util.MNode

            StringBuilder xmlBuilder = new StringBuilder()
            xmlBuilder.append('<?xml version="1.0" encoding="UTF-8"?>\n')

            MNode screenNode = new MNode("screen", ["xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance", "xsi:noNamespaceSchemaLocation":"http://moqui.org/xsd/xml-screen-3.xsd"])
            MNode updateTransNode = screenNode.append("transition", [name:"update"])
            updateTransNode.append("service-call", [name:"update#${aen}".toString()])
            updateTransNode.append("default-response", [url:"."])

            MNode actionsNode = screenNode.append("actions", null)
            actionsNode.append("entity-find-one", ["entity-name":aen, "value-field":"fieldValues"])
            MNode widgetsNode = screenNode.append("widgets", null)
            widgetsNode.append(sri.getActiveScreenDef().getForm("UpdateMasterEntityValue").getAutoCleanedNode())
            screenNode.addToSb(xmlBuilder, 0)

            ec.web.sendTextResponse(xmlBuilder.toString(), "text/xml", "Edit${ec.entity.getEntityDefinition(aen).entityName}.xml")]]></script></actions><default-response type="none"/></transition><actions><entity-find-one entity-name="${aen}" value-field="fieldValues"/><set field="entityDefinition" from="ec.entity.getEntityDefinition(aen)"/><set field="masterNames" from="new TreeSet(entityDefinition.getMasterDefinitionMap().keySet())"/></actions><widgets><link url="list" text="Entity List" link-type="hidden-form"/><link url="find" text="Find ${ec.entity.getEntityDefinition(aen).getPrettyName(null, null)}" link-type="hidden-form"/><container-dialog id="ExportMasterEntityDialog" button-text="Export"><form-single name="ExportMasterEntity" transition="export" dynamic="true"><auto-fields-entity entity-name="${aen}" include="pk" field-type="hidden"/><field name="aen"><default-field><hidden/></default-field></field><field name="filename"><default-field><text-line size="60"/></default-field></field><field name="dependentLevels"><default-field><text-line size="2" default-value="2"/></default-field></field><field name="masterName"><default-field><drop-down allow-empty="true"><list-options list="masterNames"/></drop-down></default-field></field><field name="fileType"><default-field><radio no-current-selected-key="XML"><option key="XML"/><option key="JSON"/></radio></default-field></field><field name="output"><default-field><radio no-current-selected-key="browser"><option key="file" text="Single File"/><option key="browser" text="Out to Browser"/></radio></default-field></field><field name="submitButton"><default-field title="Export"><submit/></default-field></field></form-single></container-dialog><form-single name="UpdateMasterEntityValue" transition="update" dynamic="true"><auto-fields-entity entity-name="${aen}" include="pk" field-type="display"/><auto-fields-entity entity-name="${aen}" include="nonpk" field-type="edit"/><field name="aen"><default-field><hidden/></default-field></field><field name="lastUpdatedStamp"><default-field title="Last Updated"><display format="yyyy-MM-dd HH:mm:ss.SSS z" also-hidden="false"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single><link url="getFormXml" text="Get Form XML" link-type="anchor"/></widgets></screen>
<!-- Screen Location component://tools/screen/Tools/AutoScreen/AutoEdit.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Edit" default-menu-index="3"><parameter name="aen" required="true"/><actions><set field="aenDef" from="ec.entity.getEntityDefinition(aen)"/><if condition="aenDef == null"><message error="true"><![CDATA[Could not find entity with name: ${aen}]]></message><return/></if><set field="masterPrimaryKeyMap" from="aenDef.getPrimaryKeys(context)"/><set field="relationshipInfoList" from="aenDef.getRelationshipsInfo(true)"/></actions><widgets><render-mode><text type="html" location="component://tools/template/AutoScreenMenu.ftl"/><text type="vuet" location="component://tools/template/AutoScreenMenu.vuet.ftl"/><text type="qvt" location="component://tools/template/AutoScreenMenu.qvt.ftl"/></render-mode></widgets></screen>
<!-- Screen Location component://tools/screen/Tools/AutoScreen.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Auto Screen" default-menu-index="2"><subscreens default-item="MainEntityList"/><widgets><subscreens-active/></widgets></screen>
<!-- Screen Location component://tools/screen/Tools/ArtifactStats.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-index="3"><transition name="serviceReference"><default-response url="//tools/ServiceReference"/></transition><actions><set field="levels" from="levels ? levels as int : 2"/><set field="entityInfoList" from="ec.entity.getAllEntityInfo(levels, false)"/><set field="entityCount" from="0"/><set field="viewEntityCount" from="0"/><iterate list="entityInfoList" entry="entityInfo"><set field="entityCount" from="entityCount + entityInfo.entities"/><set field="viewEntityCount" from="viewEntityCount + entityInfo.viewEntities"/></iterate><set field="serviceInfoList" from="ec.service.getAllServiceInfo(levels)"/><set field="allRootScreenLocations" from="ec.screen.getAllRootScreenLocations()"/></actions><widgets><label text="Entity Stats" type="h3"/><label text="Entities: ${entityCount as int}, View Entities: ${viewEntityCount as int}, EECA rules: ${ec.entity.getEecaRuleCount()}" type="p"/><form-list name="EntityInfoList" list="entityInfoList" skip-form="true"><field name="name"><default-field><display/></default-field></field><field name="entities"><default-field><display/></default-field></field><field name="viewEntities"><default-field><display/></default-field></field></form-list><label text="Service Stats" type="h3"/><label text="Services: ${ec.service.getKnownServiceNames().size()}, SECA rules: ${ec.service.getSecaRuleCount()}" type="p"/><form-list name="ServiceInfoList" list="serviceInfoList" skip-form="true"><field name="name"><default-field><link url="serviceReference" text="${name}" parameter-map="[serviceName:name]" link-type="anchor"/></default-field></field><field name="services"><default-field><display/></default-field></field></form-list><label text="Screen Stats" type="h3"/><section-iterate name="ScreensByRoot" list="allRootScreenLocations" entry="rootLocation"><actions><set field="screenInfoList" from="ec.screen.getScreenInfoList(rootLocation, levels)"/></actions><widgets><label text="Root Screen: ${rootLocation}" type="h4"/><form-list name="ScreenInfoList" list="screenInfoList" list-entry="screenInfo" skip-form="true"><field name="name" from="screenInfo.getIndentedName()"><default-field><display/></default-field></field><field name="title"><default-field><label text="${'- ' * screenInfo.level}* ${screenInfo.ssi?.menuTitle?:'Root'}"/></default-field></field><field name="subscreens" from="screenInfo.allSubscreens"><default-field><display/></default-field></field><field name="subscreensNonPlaceholder" from="screenInfo.allSubscreensNonPlaceholder"><default-field><display/></default-field></field><field name="transitions" from="screenInfo.transitions + screenInfo.allSubscreensTransitions"><default-field><display/></default-field></field><field name="transitionsWithActions" from="screenInfo.transitionsWithActions + screenInfo.allSubscreensTransitionsWithActions"><default-field><display/></default-field></field><field name="sections" from="screenInfo.sections + screenInfo.allSubscreensSections"><default-field><display/></default-field></field><field name="forms" from="screenInfo.forms + screenInfo.allSubscreensForms"><default-field><display/></default-field></field><field name="trees" from="screenInfo.trees + screenInfo.allSubscreensTrees"><default-field><display/></default-field></field></form-list></widgets></section-iterate></widgets></screen>
<!-- Screen Location component://tools/screen/Tools/GroovyShell.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-index="3"><actions><if condition="!ec.user.hasPermission('GROOVY_SHELL_WEB')"><return error="true" message="User does not have permission to use Groovy Shell"/></if><if condition="!sri.getScreenUrlInfo().isPermitted(ec, null, org.moqui.context.ArtifactExecutionInfo.AUTHZA_ALL)"><return error="true" message="User must be authorized for all actions on this screen"/></if></actions><widgets><text type="html,vuet,qvt"><![CDATA[<div class="text-danger">Be careful here, you can break many things. <a href="https://groovy-lang.org/groovysh.html" target="_blank">A groovysh reference is available here.</a></div><div id="terminal" style="height:100%;"></div><script src="https://cdnjs.cloudflare.com/ajax/libs/xterm/3.14.5/xterm.min.js" integrity="sha512-2PRgAav8Os8vLcOAh1gSaDoNLe1fAyq8/G3QSdyjFFD+OqNjLeHE/8q4+S4MEZgPsuo+itHopj+hJvqS8XUQ8A==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/xterm/3.14.5/xterm.min.css" integrity="sha512-iLYuqv+v/P4u9erpk+KM83Ioe/l7SEmr7wB6g+Kg1qmEit8EShDKnKtLHlv2QXUp7GGJhmqDI+1PhJYLTsfb8w==" crossorigin="anonymous" referrerpolicy="no-referrer"/><script>
                // geometry calc code from xterm fit add on, which does not work with old/odd addon system in pre-4 (but xterm 4+ not available on cdnjs)
                function proposeTerminalGeometry(term) {
                  var parentEl = term.element.parentElement;
                  if (!parentEl) { return null; }
                  // console.warn(parentEl);
                  var parentElementStyle = window.getComputedStyle(parentEl);
                  var parentElementHeight = parseInt(parentElementStyle.getPropertyValue('height'));
                  // console.warn("parentElementHeight " + parentElementHeight);
                  var parentElementWidth = Math.max(0, parseInt(parentElementStyle.getPropertyValue('width')));
                  var elementStyle = window.getComputedStyle(term.element);
                  var elementPadding = {
                    top: parseInt(elementStyle.getPropertyValue('padding-top')),
                    bottom: parseInt(elementStyle.getPropertyValue('padding-bottom')),
                    right: parseInt(elementStyle.getPropertyValue('padding-right')),
                    left: parseInt(elementStyle.getPropertyValue('padding-left'))
                  };
                  var elementPaddingVer = elementPadding.top + elementPadding.bottom;
                  var elementPaddingHor = elementPadding.right + elementPadding.left;
                  var availableHeight = parentElementHeight - elementPaddingVer;
                  var availableWidth = parentElementWidth - elementPaddingHor - term._core.viewport.scrollBarWidth;
                  var geometry = {
                    cols: Math.floor(availableWidth / term._core._renderCoordinator.dimensions.actualCellWidth),
                    rows: Math.floor(availableHeight / term._core._renderCoordinator.dimensions.actualCellHeight)
                  };
                  return geometry;
                }

                var groovyshTerminal = new Terminal({
                    cols: ${cols!"100"}, rows: ${rows!"40"}, fontSize: ${fontSize!"12"},
                    cursorBlink: true, cursorStyle: "bar", // null | 'block' | 'underline' | 'bar'
                    scrollback: 1000, tabStopWidth: 4, convertEol: true, screenKeys: true
                });
                groovyshTerminal.open(document.getElementById('terminal'));
                groovyshTerminal.write('Connecting...\n');

                var groovyshGeometry = proposeTerminalGeometry(groovyshTerminal);
                if (groovyshGeometry && (groovyshTerminal.rows !== groovyshGeometry.rows || groovyshTerminal.cols !== groovyshGeometry.cols)) {
                    groovyshTerminal._core._renderCoordinator.clear();
                    groovyshTerminal.resize(groovyshGeometry.cols, groovyshGeometry.rows);
                }

                if (window.groovyshWsClient && window.groovyshWsClient.webSocket) {
                    window.groovyshWsClient.webSocket.close(1000);
                    window.groovyshWsClient = null;
                }
                window.groovyshWsClient = new moqui.BasicWebSocketClient(
                    (location.protocol === 'https:' ? 'wss' : 'ws') + "://${ec.web.getHostName(true)}${ec.web.servletContext.contextPath}/groovysh",
                    function(data) {
                        // console.info("received groovysh ws data: " + data);
                        groovyshTerminal.write(data);
                    }
                );
                groovyshTerminal.on("data", function (data) {
                    // console.info("sending groovysh ws data: " + data);
                    groovyshWsClient.webSocket.send(data);
                });

                if (!window.groovyshOnUrlCloseWs) window.groovyshOnUrlCloseWs = function(url) {
                    if (window.groovyshWsClient && window.groovyshWsClient.webSocket) {
                        window.groovyshWsClient.webSocket.close(1000);
                        window.groovyshWsClient = null;
                    }
                }
                if (moqui && moqui.webrootVue) {
                    moqui.webrootVue.addUrlListener(window.groovyshOnUrlCloseWs);
                }
            </script>]]></text></widgets></screen>
<!-- Screen Location component://tools/screen/Tools/StatusFlows.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Status Flows" default-menu-index="3"><actions><if condition="statusTypeId || statusFlowId"><entity-find entity-name="moqui.basic.StatusFlowTransitionFromAndTo" list="transitionList"><econdition field-name="fromStatusTypeId" from="statusTypeId" ignore-if-empty="true"/><econdition field-name="statusFlowId" ignore-if-empty="true"/><order-by field-name="transitionSequence,fromSequenceNum"/></entity-find><set field="statusIdSet" from="new HashSet(transitionList*.statusId + transitionList*.toStatusId)"/><entity-find entity-name="moqui.basic.StatusItem" list="statusItemList"><econdition field-name="statusId" operator="in" from="statusIdSet"/><order-by field-name="sequenceNum"/></entity-find><order-map-list list="statusItemList"><order-by field-name="sequenceNum"/></order-map-list><script><![CDATA[def mermaidBuilder = new StringBuilder("stateDiagram-v2\n")
                for (statusItem in statusItemList) {
                    mermaidBuilder.append("    ${statusItem.statusId}: ${statusItem.description}")
                    if (statusItem.sequenceNum) mermaidBuilder.append(" (").append(statusItem.sequenceNum).append(")")
                    mermaidBuilder.append("\n")
                }
                for (transition in transitionList) {
                    mermaidBuilder.append("    ${transition.statusId} --> ${transition.toStatusId}: ${transition.transitionName}")
                    if (transition.transitionSequence) mermaidBuilder.append(" (").append(transition.transitionSequence).append(")")
                    mermaidBuilder.append("\n")
                }
                mermaidText = mermaidBuilder.toString()]]></script></if></actions><widgets><label text="View a status flow transition diagram by selecting a Type, Flow, or both" type="p"/><form-single name="SelectStatusFlow" transition="."><field name="statusTypeId"><default-field title="Type"><drop-down allow-empty="true"><entity-options key="${statusTypeId}" text="${statusTypeId}: ${description}"><entity-find entity-name="moqui.basic.StatusType"><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="statusFlowId"><default-field title="Flow"><drop-down allow-empty="true" no-current-selected-key="Default"><entity-options key="${statusFlowId}" text="${statusFlowId}: ${description}"><entity-find entity-name="moqui.basic.StatusFlow"><order-by field-name="description"/></entity-find></entity-options></drop-down></default-field></field><field name="submitBtn"><default-field><submit text="View"/></default-field></field></form-single><section name="MermaidDisplay" condition="mermaidText"><widgets><label text="Found ${statusItemList.size()} statuses, ${transitionList.size()} transitions" type="p" condition="statusItemList != null"/><container-dialog id="MermaidText" button-text="Mermaid JS Text"><label text="${mermaidText}" type="pre"/></container-dialog><render-mode><text type="qvt"><![CDATA[<m-mermaid height="800px">${mermaidText}</m-mermaid>]]></text><text type="html,vuet"><![CDATA[<p><strong>Only supported in the 'qvt' render mode, go to the same URL under /qapps (instead of /apps or /vapps)</strong></p>]]></text></render-mode></widgets></section><container-row><row-col md="6"><form-list name="StatusItemList" list="statusItemList" skip-form="true"><field name="sequenceNum"><default-field title="Seq"><display/></default-field></field><field name="description"><default-field title="Status"><display/></default-field></field><field name="statusId"><default-field title="ID"><display/></default-field></field><field name="statusCode"><default-field title="Code"><display/></default-field></field></form-list></row-col><row-col md="6"><form-list name="TransitionList" list="transitionList" skip-form="true"><field name="transitionSequence"><default-field title="Trans Seq"><display/></default-field></field><field name="fromSequenceNum"><default-field title="From Seq"><display/></default-field></field><field name="fromDescription"><default-field title="From"><display/></default-field></field><field name="transitionName"><default-field title="When"><display/></default-field></field><field name="toDescription"><default-field title="To"><display/></default-field></field></form-list></row-col></container-row></widgets></screen>
<!-- Screen Location component://tools/screen/Tools/DataView/FindDbView.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Data View Entity List" default-menu-index="1"><transition name="edit"><default-response url="../EditDbView"/></transition><transition name="view"><default-response url="../ViewDbView"/></transition><transition name="create"><service-call name="org.moqui.impl.EntityServices.create#DbViewEntity" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><entity-find entity-name="moqui.entity.view.DbViewEntity" list="dbViewEntityList"><search-form-inputs/><econdition field-name="isDataView" value="Y"/></entity-find></actions><widgets><form-single name="CreateDbViewEntity" transition="create"><field name="dbViewEntityName"><default-field title="View Entity Name"><text-line size="20"/></default-field></field><field name="packageName"><default-field title="Package"><text-line size="20"/></default-field></field><field name="cache"><default-field><hidden default-value="N"/></default-field></field><field name="isDataView"><default-field><hidden default-value="Y"/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field><field-layout><field-row-big><field-ref name="dbViewEntityName"/><field-ref name="packageName"/><field-ref name="cache"/><field-ref name="isDataView"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single><form-list name="ListDbViewEntities" list="dbViewEntityList"><field name="dbViewEntityName"><header-field title="Entity" show-order-by="true"/><default-field><display also-hidden="false"/></default-field></field><field name="packageName"><header-field title="Package" show-order-by="true"/><default-field><display also-hidden="false"/></default-field></field><field name="edit"><default-field><link url="edit" text="Edit"/></default-field></field><field name="view"><default-field><link url="view" text="View"/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://tools/screen/Tools/DataView/ViewDbView.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Data View Results" default-menu-index="1"><parameter name="dbViewEntityName" required="true"/><transition name="edit"><default-response url="../EditDbView"/></transition><transition name="filter"><default-response url="."/></transition><transition name="DbView.csv"><default-response url="."><parameter name="renderMode" value="csv"/><parameter name="pageNoLimit" value="true"/><parameter name="lastStandalone" value="true"/></default-response></transition><actions><entity-find-one entity-name="moqui.entity.view.DbViewEntityMember" value-field="masterMember"><field-map field-name="dbViewEntityName"/><field-map field-name="entityAlias" value="MASTER"/></entity-find-one><set field="masterDef" from="ec.entity.getEntityDefinition(masterMember.entityName)"/><if condition="masterDef == null"><message error="true"><![CDATA[Could not find master entity with name: ${masterMember.entityName}]]></message><return/></if><entity-find-one entity-name="moqui.entity.view.DbViewEntity" value-field="fieldValues"/><entity-find entity-name="${dbViewEntityName}" list="dbViewList" use-clone="true"><search-form-inputs/></entity-find></actions><widgets><container><link url="edit" text="Edit ${dbViewEntityName}"/><link url="DbView.csv" text="Get as CSV"/></container><label text="Data View for: ${dbViewEntityName}" type="h2"/><container-dialog id="FilterViewDialog" button-text="Filter ${ec.entity.getEntityDefinition(dbViewEntityName).getPrettyName(null, null)}"><form-single name="FilterDbView" transition="filter" dynamic="true"><auto-fields-entity entity-name="${dbViewEntityName}" field-type="find"/><field name="dbViewEntityName"><default-field><hidden/></default-field></field><field name="submitButton"><default-field title="Find"><submit/></default-field></field></form-single></container-dialog><form-list name="ViewList" list="dbViewList" dynamic="true"><auto-fields-entity entity-name="${dbViewEntityName}" field-type="display"/></form-list></widgets></screen>
<!-- Screen Location component://tools/screen/Tools/DataView/EditDbView.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Edit Data View Entity" default-menu-index="1"><parameter name="dbViewEntityName" required="true" from="dbViewEntityName ?: dbViewEntityName_0"/><parameter name="dbViewEntityName_0"/><transition name="view"><default-response url="../ViewDbView"/></transition><transition name="DbView.csv"><default-response url="../ViewDbView/DbView.csv"/></transition><transition name="update"><service-call name="update#moqui.entity.view.DbViewEntity" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="setMasterEntity"><service-call name="store#moqui.entity.view.DbViewEntityMember" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="setMasterFields"><actions><set field="dbViewEntityName" from="dbViewEntityName_0"/><entity-find-one entity-name="moqui.entity.view.DbViewEntity" value-field="dbViewEntity"/><entity-find-one entity-name="moqui.entity.view.DbViewEntityMember" value-field="masterDbViewEntityMember"><field-map field-name="dbViewEntityName" from="dbViewEntityName"/><field-map field-name="entityAlias" value="MASTER"/></entity-find-one><set field="masterEntityName" from="masterDbViewEntityMember.entityName"/><entity-delete-related value-field="dbViewEntity" relationship-name="moqui.entity.view.DbViewEntityAlias"/><entity-delete-related value-field="dbViewEntity" relationship-name="moqui.entity.view.DbViewEntityKeyMap"/><entity-delete-by-condition entity-name="moqui.entity.view.DbViewEntityMember"><econdition field-name="dbViewEntityName" from="dbViewEntityName"/><econdition field-name="entityAlias" operator="not-equals" value="MASTER"/></entity-delete-by-condition><script><![CDATA[import org.moqui.impl.entity.EntityDefinition
                import org.moqui.impl.entity.EntityJavaUtil
                // make sure reverse-one many relationships exist
                ec.entity.createAllAutoReverseManyRelationships()

                EntityDefinition masterEd = ec.entity.getEntityDefinition(masterEntityName)

                Map members = [:]
                int memberIndex = 1
                Map aliasIndexes = [:]
                int parameterIndex = 0
                while (ec.web.parameters.get("dbViewEntityName_" + parameterIndex)) {
                    String field = ec.web.parameters.get("field_" + parameterIndex)
                    String functionName = ec.web.parameters.get("functionName_" + parameterIndex)
                    // ec.logger.log(ec.logger.WARN_INT, "Field field_${parameterIndex}, value: ${field}", null)
                    parameterIndex++

                    if (!field) continue

                    String entityName
                    String fieldName

                    String relationshipName = field.substring(0, field.lastIndexOf('.'))
                    EntityJavaUtil.RelationshipInfo relInfo = masterEd.getRelationshipInfo(relationshipName)
                    if (relInfo != null) {
                        entityName = relInfo.relatedEntityName
                        fieldName = field.substring(field.lastIndexOf('.') + 1)
                    } else if (relationshipName == masterEntityName) {
                        entityName = masterEntityName
                        fieldName = field.substring(field.lastIndexOf('.') + 1)
                    } else {
                        ec.message.addError(ec.resource.expand('No relationship definition found for name ${relationshipName}',''))
                        continue
                    }

                    // ec.logger.log(ec.logger.WARN_INT, "relationshipName: ${relationshipName}, entityName: ${entityName}, fieldName: ${fieldName}", null)
                    def memberValue = (relationshipName == masterDbViewEntityMember.entityName) ?
                            masterDbViewEntityMember : members.get(entityName)
                    if (!memberValue) {
                        memberValue = ec.entity.makeValue("moqui.entity.view.DbViewEntityMember")
                        memberValue.dbViewEntityName = dbViewEntityName
                        memberValue.entityName = entityName
                        memberValue.entityAlias = "MEMBER${memberIndex}"
                        memberValue.joinFromAlias = "MASTER"
                        memberValue.joinOptional = "Y"
                        memberIndex++
                        memberValue.create()
                        members.put(entityName, memberValue)

                        // added a member, add KeyMap(s)
                        Map relExpKeyMap = relInfo.keyMap
                        for (Map.Entry keyMapEntry in relExpKeyMap) {
                            def keyMapValue = ec.entity.makeValue("moqui.entity.view.DbViewEntityKeyMap")
                            keyMapValue.dbViewEntityName = dbViewEntityName
                            keyMapValue.joinFromAlias = memberValue.joinFromAlias
                            keyMapValue.entityAlias = memberValue.entityAlias
                            keyMapValue.fieldName = keyMapEntry.getKey()
                            keyMapValue.relatedFieldName = keyMapEntry.getValue()
                            keyMapValue.create()
                        }
                    }

                    int fieldAliasIndex = aliasIndexes.get(fieldName) ?: 0
                    fieldAliasIndex++
                    aliasIndexes.put(fieldName, fieldAliasIndex)

                    def aliasValue = ec.entity.makeValue("moqui.entity.view.DbViewEntityAlias")
                    aliasValue.dbViewEntityName = dbViewEntityName
                    aliasValue.fieldAlias = fieldName + (fieldAliasIndex > 1 ? fieldAliasIndex : '')
                    aliasValue.entityAlias = memberValue.entityAlias
                    aliasValue.fieldName = fieldName
                    if (functionName) aliasValue.functionName = functionName
                    aliasValue.create()
                }

                // clear the entity definition cache for dbViewEntityName
                ec.entity.clearEntityDefinitionFromCache(dbViewEntityName)]]></script></actions><default-response url="."/></transition><widgets><container><link url="view" text="View ${dbViewEntityName}"/><link url="DbView.csv" text="Get as CSV"/></container><section name="Update"><actions><entity-find-one entity-name="moqui.entity.view.DbViewEntity" value-field="fieldValues"/></actions><widgets><form-single name="UpdateDbViewEntity" transition="update"><field name="dbViewEntityName"><default-field title="View Name"><display/></default-field></field><field name="packageName"><default-field title="Package"><text-line/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field><field-layout><field-row-big><field-ref name="dbViewEntityName"/><field-ref name="packageName"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single></widgets></section><section name="Master"><actions><entity-find-one entity-name="moqui.entity.view.DbViewEntityMember" value-field="fieldValues"><field-map field-name="dbViewEntityName"/><field-map field-name="entityAlias" value="MASTER"/></entity-find-one><set field="masterEntityList" from="ec.entity.getAllEntitiesInfo('entityName', null, false, true)"/><set field="masterFieldList" from="ec.entity.getAllEntityRelatedFields(fieldValues?.entityName, orderByField?:'+entityName', dbViewEntityName)"/></actions><widgets><form-single name="SetMasterEntity" transition="setMasterEntity"><field name="dbViewEntityName"><default-field><hidden/></default-field></field><field name="entityAlias"><default-field><hidden default-value="MASTER"/></default-field></field><field name="entityName"><default-field><drop-down combo-box="true" allow-empty="true"><list-options list="masterEntityList" key="${fullEntityName}" text="${entityName} - ${context.package}"/></drop-down></default-field></field><field name="submitButton"><default-field title="Set Master"><submit/></default-field></field><field-layout><field-row-big><field-ref name="dbViewEntityName"/><field-ref name="entityAlias"/><field-ref name="entityName"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single><form-list name="SetMasterFields" list="masterFieldList" transition="setMasterFields" multi="true"><field name="dbViewEntityName"><default-field><hidden/></default-field></field><field name="field"><default-field><check all-checked="${inDbView?'true':'false'}"><option key="${title ? title+'#' : ''}${entityName}.${fieldName}" text=" "/></check></default-field></field><field name="fieldName"><header-field show-order-by="true"/><default-field><display also-hidden="false"/></default-field></field><field name="relatedEntityName"><header-field show-order-by="true"/><default-field><display text="${entityName}${title ? ' (' + title + ')' : ''}" also-hidden="false"/></default-field></field><field name="type"><default-field><display also-hidden="false"/></default-field></field><field name="cardinality"><default-field><display also-hidden="false"/></default-field></field><field name="functionName"><default-field><drop-down allow-empty="true" current="selected"><option key="min"/><option key="max"/><option key="sum"/><option key="avg"/><option key="count"/><option key="count-distinct"/><option key="upper"/><option key="lower"/></drop-down></default-field></field><field name="submitButton"><default-field title="Select Fields"><submit/></default-field></field></form-list></widgets></section></widgets></screen>
<!-- Screen Location component://tools/screen/Tools/DataView.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Data View" default-menu-index="4"><subscreens default-item="FindDbView"/><widgets><subscreens-active/></widgets></screen>
<!-- Screen Location component://tools/screen/Tools/Entity/DataEdit/EntityDetail.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Detail"><parameter name="selectedEntity" required="true"/><parameter name="refresh" required="false"/><transition name="list"><default-response url="../EntityList"/></transition><transition name="find"><default-response url="../EntityDataFind"/></transition><transition name="autoFind"><default-response url="../../../AutoScreen/AutoFind"/></transition><transition name="checkTable"><actions><script><![CDATA[ec.entity.entityDbMeta.forceCheckTableRuntime(ec.entity.getEntityDefinition(selectedEntity))]]></script></actions><default-response url="."/></transition><actions><set field="entityDefinition" from="ec.entity.getEntityDefinition(selectedEntity)"/><set field="entityInfo" from="entityDefinition.entityInfo"/><set field="entityNode" from="entityDefinition.getEntityNode()"/><set field="fieldInfos" from="entityInfo.allFieldInfoArray"/><set field="relationshipInfoList" from="entityDefinition.getRelationshipsInfo(false)"/><set field="dependents" from="entityDefinition.getDependentsTree()"/><script><![CDATA[eecas = ec.entity.eecaRulesByEntityName.get(entityDefinition.fullEntityName)
            secas = []
            for (verb in org.moqui.impl.service.runner.EntityAutoServiceRunner.verbSet) {
                serviceName = verb + entityDefinition.fullEntityName
                rules = ec.service.secaRulesByServiceName.get(serviceName)
                if (rules) secas.addAll(rules)
            }]]></script><set field="entityDescription" from="entityNode.first('description')?.text"/></actions><widgets><container><link url="list" text="Entity List"/><link url="find" text="Entity Find"/><link url="autoFind" text="Auto Screen Find" parameter-map="[aen:selectedEntity]"/><link url="checkTable" text="Check/Update Table" tooltip="Check and update DB table from entity definition"/></container><container><label text="Entity Detail for ${entityDefinition.getPrettyName(null, null)} (${entityDefinition.fullEntityName})" type="h3"/></container><container-row><row-col md="3"><label text="View Entity? ${entityDefinition.isViewEntity}" type="strong"/></row-col><row-col md="3"><label text="Short Alias: ${entityInfo.shortAlias ?: 'N/A'}" type="strong"/></row-col><row-col md="3"><label text="Table Name: ${entityInfo.fullTableName ?: 'N/A'}" type="strong"/></row-col><row-col md="3"><label text="Entity Group: ${entityNode.attribute('group-name') ?: '(default)'}" type="strong"/></row-col></container-row><container-row><row-col md="3"><label text="Needs Encrypt? ${entityInfo.needsEncrypt}" type="strong"/></row-col><row-col md="3"><label text="Create Only? ${entityInfo.createOnly}" type="strong"/></row-col></container-row><container-row><row-col md="3"><label text="Needs Audit Log? ${entityInfo.needsAuditLog}" type="strong"/></row-col><row-col md="3"><label text="Entity Audit Default: ${entityNode.attribute('enable-audit-log') ?: 'false'}" type="strong"/></row-col></container-row><label text="${entityDescription}" condition="entityDescription"/><form-list name="FieldList" list="fieldInfos" list-entry="fieldInfo"><field name="fieldName" from="fieldInfo.name"><default-field><display/></default-field></field><field name="type" from="fieldInfo.type"><default-field><display/></default-field></field><field name="column" from="entityDefinition.getColumnName(fieldInfo.name)"><default-field><display/></default-field></field><field name="isPk" from="fieldInfo.isPk"><default-field title="Is PK"><display/></default-field></field><field name="audit" from="fieldInfo.enableAuditLog"><default-field><display/></default-field></field><field name="encrypt" from="fieldInfo.encrypt"><default-field><display/></default-field></field><field name="localize" from="fieldInfo.enableLocalization"><default-field><display/></default-field></field><field name="default" from="fieldInfo.defaultStr"><default-field><display/></default-field></field><field name="description" from="fieldInfo.fieldNode.first('description')?.text ?: ''"><default-field><display/></default-field></field></form-list><form-list name="RelatedEntities" list="relationshipInfoList" list-entry="relInfo"><field name="prettyName"><default-field><display/></default-field></field><field name="shortAlias"><default-field><display/></default-field></field><field name="title"><default-field><display/></default-field></field><field name="relatedEntityName"><default-field><display/></default-field></field><field name="type"><default-field><display/></default-field></field><field name="keyMap"><default-field><display/></default-field></field><field name="link"><default-field title=""><link text="Detail" url="." link-type="anchor"><parameter name="selectedEntity" from="relInfo.relatedEntityName"/></link><link text="Find" url="find" link-type="anchor"><parameter name="enumTypeId" from="(relInfo.relatedEntityName == 'moqui.basic.Enumeration')? relInfo.title : ''"/><parameter name="statusTypeId" from="(relInfo.relatedEntityName == 'moqui.basic.StatusItem')? relInfo.title : ''"/><parameter name="selectedEntity" from="relInfo.relatedEntityName"/></link></default-field></field></form-list><label text="EECAs and related AutoService SECAs" type="h4" condition="eecas || secas"/><section-iterate name="Eecas" list="eecas" entry="eeca"><widgets><container type="pre" style="line-numbers"><label text="${eeca.eecaNode.toString()}" type="code" style="language-markup" encode="true"/></container></widgets></section-iterate><section-iterate name="Secas" list="secas" entry="seca"><widgets><container type="pre" style="line-numbers"><label text="${seca.toString()}" type="code" style="language-markup" encode="true"/></container></widgets></section-iterate><render-mode><text type="html,vuet,qvt"><![CDATA[<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.20.0/themes/prism-twilight.min.css" type="text/css"/><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.20.0/prism.min.js" type="text/javascript"></script>]]></text></render-mode><label text="Dependents" type="h4"/><label text="${dependents.toString()}" type="pre" encode="true"/><label text="All Descendants:" type="h5"/><section-iterate name="DescendantList" list="dependents.allDescendants" entry="descendantName"><widgets><container><link url="." text="${descendantName}" parameter-map="[selectedEntity:descendantName]" link-type="anchor"/></container></widgets></section-iterate></widgets></screen>
<!-- Screen Location component://tools/screen/Tools/Entity/DataEdit/EntityList.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Entity List" default-menu-index="1"><transition name="find"><default-response url="../EntityDataFind"/></transition><transition name="detail"><default-response url="../EntityDetail"/></transition><transition name="autoScreen"><default-response url="../../../AutoScreen/AutoFind"/></transition><transition name="checkTables"><actions><script><![CDATA[ec.entity.entityDbMeta.forceCheckExistingTables()]]></script></actions><default-response url="."/></transition><transition name="getLiquibaseInitXml" read-only="true"><actions><script><![CDATA[def lbRootNode = ec.entity.getEntityDbMeta().liquibaseInitChangelog(filterRegexp)
            ec.web.sendTextResponse(lbRootNode.toString(), "text/xml", "LiquibaseInit-${new java.sql.Date(System.currentTimeMillis()).toString()}.xml")]]></script></actions><default-response type="none"/></transition><transition name="dropForeignKeys" begin-transaction="false"><actions><script><![CDATA[ec.entity.entityDbMeta.forceCheckExistingTables()]]></script><set field="dropped" from="ec.entity.getEntityDbMeta().dropAllForeignKeys()"/><message><![CDATA[Dropped ${dropped} foreign keys]]></message></actions><default-response url="."/></transition><transition name="createForeignKeys" begin-transaction="false"><actions><set field="created" from="ec.entity.getEntityDbMeta().createForeignKeysForExistingTables()"/><message><![CDATA[Created ${created} foreign keys]]></message></actions><default-response url="."/></transition><transition name="createIndexes" begin-transaction="false"><actions><set field="created" from="ec.entity.getEntityDbMeta().createIndexesForExistingTables()"/><message><![CDATA[Created ${created} indexes]]></message></actions><default-response url="."/></transition><actions><set field="pageSize" from="pageSize ?: 60"/><set field="masterEntitiesOnly" from="viewOption == 'master'"/><set field="excludeViewEntities" from="viewOption == 'exclude-views'"/><set field="entityList" from="ec.entity.getAllEntitiesInfo(orderByField?:'fullEntityName', filterRegexp, masterEntitiesOnly, excludeViewEntities)"/><script><![CDATA[paginateList("entityList", null, context)]]></script></actions><widgets><link url="checkTables" text="Check/Update All Tables" confirmation="Check and update all tables? NOTE: this will only create missing tables and columns if runtime-add-missing is true"/><link url="dropForeignKeys" text="Drop FKs" confirmation="Really drop all known foreign keys?"/><link url="createForeignKeys" text="Create FKs" confirmation="Really create all missing foreign keys?"/><link url="createIndexes" text="Create Indexes" confirmation="Really create all missing indexes? WARNING: on large tables adding an index can take a long time!"/><container-dialog id="LiquibaseInitDialog" button-text="Liquibase Init XML"><form-single name="LiquibaseInit" transition="getLiquibaseInitXml"><field name="filterRegexp"><default-field><text-line size="40"/></default-field></field><field name="submitButton"><default-field title="Download"><submit/></default-field></field></form-single></container-dialog><form-single name="FilterForm" transition="."><field name="filterRegexp"><default-field><text-line size="30"/></default-field></field><field name="viewOption"><default-field title="View Option"><drop-down><option key="all" text="All Entities"/><option key="master" text="Master Entities"/><option key="exclude-views" text="Exclude View Entities"/></drop-down></default-field></field><field name="submitButton"><default-field title="Filter"><submit/></default-field></field><field-layout><field-row-big><field-ref name="filterRegexp"/><field-ref name="viewOption"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single><form-list name="EntityList" list="entityList"><field name="package"><header-field show-order-by="true"/><default-field><display also-hidden="false"/></default-field></field><field name="entityName"><header-field show-order-by="true"/><default-field><display also-hidden="false"/></default-field></field><field name="isView"><header-field title="View##DataBase" show-order-by="true"/><default-field><display also-hidden="false"/></default-field></field><field name="find"><default-field><link url="find" text="Find" link-type="anchor" parameter-map="[selectedEntity:fullEntityName]"/></default-field></field><field name="autoScreen"><default-field><link url="autoScreen" text="Auto Screen" link-type="anchor" parameter-map="[aen:fullEntityName]"/></default-field></field><field name="detail"><default-field><link url="detail" text="Detail" link-type="anchor" parameter-map="[selectedEntity:fullEntityName]"/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://tools/screen/Tools/Entity/DataEdit/EntityDataFind.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Find" default-menu-index="2"><parameter name="selectedEntity" required="true"/><transition name="list"><default-response url="../EntityList"/></transition><transition name="find"><default-response url="."/></transition><transition name="create"><actions><service-call name="create#${selectedEntity}" in-map="true"/></actions><default-response url="."/></transition><transition name="listSubmit"><actions><if condition="delete"><service-call name="delete#${selectedEntity}" in-map="true"/></if></actions><conditional-response url="."><condition><expression><![CDATA[delete]]></expression></condition></conditional-response><default-response url="../EntityDataEdit" parameter-map="ec.entity.getEntityDefinition(selectedEntity).getPrimaryKeys(context)"/></transition><actions><set field="entityDefinition" from="ec.entity.getEntityDefinition(selectedEntity)"/><entity-find entity-name="${selectedEntity}" list="entityValueList" offset="0" limit="50" use-clone="true"><search-form-inputs/></entity-find></actions><widgets><container><link url="list" text="Entity List"/><container-dialog id="FindValueDialog" button-text="Find Options"><form-single name="FindEntityValue" transition="find" dynamic="true"><auto-fields-entity entity-name="${selectedEntity}" field-type="find"/><field name="selectedEntity"><default-field title="Entity Name"><hidden/></default-field></field><field name="submitButton"><default-field title="Find"><submit/></default-field></field></form-single></container-dialog><link url="../EntityDetail" parameter-map="[selectedEntity:selectedEntity]" text="Entity Detail"/><container-dialog id="CreateValueDialog" button-text="New Value"><form-single name="CreateEntityValue" transition="create" dynamic="true"><auto-fields-entity entity-name="${selectedEntity}" field-type="edit"/><field name="selectedEntity"><default-field title="Entity Name"><hidden/></default-field></field><field name="submitButton"><default-field title="Create"><submit/></default-field></field></form-single></container-dialog></container><container><label text="Find ${entityDefinition.getPrettyName(null, null)} (${selectedEntity})" type="h3"/></container><form-list name="ListEntityValue" list="entityValueList" transition="listSubmit" header-dialog="true" dynamic="true" show-csv-button="true" show-xlsx-button="true" show-page-size="true"><hidden-parameters><parameter name="selectedEntity"/></hidden-parameters><field name="find"><header-field title="Find"><submit/></header-field></field><field name="edit"><default-field title="Edit"><submit/></default-field></field><field name="delete"><default-field title="Delete"><submit/></default-field></field><auto-fields-entity entity-name="${selectedEntity}" field-type="find-display"/><columns><column><field-ref name="edit"/><field-ref name="delete"/></column></columns></form-list></widgets></screen>
<!-- Screen Location component://tools/screen/Tools/Entity/DataEdit/EntityDataEdit.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Edit" default-menu-index="3"><parameter name="selectedEntity" required="true"/><transition name="list"><default-response url="../EntityList"/></transition><transition name="find"><default-response url="../EntityDataFind"/></transition><transition name="edit"><default-response url="."/></transition><transition name="update"><actions><service-call name="update#${selectedEntity}" in-map="true"/></actions><default-response url="." parameter-map="ec.entity.getEntityDefinition(selectedEntity).getPrimaryKeys(context)"/></transition><actions><set field="entityDefinition" from="ec.entity.getEntityDefinition(selectedEntity)"/><set field="dependentLevels" from="(dependentLevels ?: '0') as int"/><entity-find-one entity-name="${selectedEntity}" value-field="entityValue"/><set field="relationshipInfoList" from="ec.entity.getEntityDefinition(selectedEntity).getRelationshipsInfo(false)"/><script><![CDATA[if (entityValue) {
                Map plainMap = entityValue.getPlainValueMap(dependentLevels)
                jb = new groovy.json.JsonBuilder()
                jb.call(plainMap)
                plainJsonStr = jb.toPrettyString()
            }]]></script></actions><widgets><container><link url="list" text="Entity List"/><link url="find" text="Find"/></container><container><label text="Edit '${selectedEntity}' Entity Value" type="h3"/></container><form-single name="UpdateEntityValue" map="entityValue" transition="update" dynamic="true"><auto-fields-entity entity-name="${selectedEntity}" include="pk" field-type="display"/><auto-fields-entity entity-name="${selectedEntity}" include="nonpk" field-type="edit"/><field name="selectedEntity" from="selectedEntity"><default-field title="Entity Name"><hidden/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single><form-list name="RelatedEntities" list="relationshipInfoList" list-entry="relInfo"><row-actions><set field="targetParameterMap" from="relInfo.getTargetParameterMap(entityValue)"/></row-actions><field name="title"><default-field><display/></default-field></field><field name="relatedEntityName"><default-field><display/></default-field></field><field name="type"><default-field><display/></default-field></field><field name="targetParameterMap"><default-field title="ID Map"><display/></default-field></field><field name="link"><conditional-field condition="relInfo.type == 'many' && targetParameterMap"><link text="Find" url="find" parameter-map="targetParameterMap"><parameter name="selectedEntity" from="relInfo.relatedEntityName"/></link></conditional-field><conditional-field condition="targetParameterMap"><link text="Edit" url="edit" parameter-map="targetParameterMap"><parameter name="selectedEntity" from="relInfo.relatedEntityName"/></link></conditional-field><default-field><display text=" "/></default-field></field></form-list><label text="JSON with Dependents" type="h5"/><form-single name="LevelsForm" transition="." dynamic="true"><auto-fields-entity entity-name="${selectedEntity}" field-type="hidden" include="pk"/><field name="selectedEntity"><default-field title="Entity Name"><hidden/></default-field></field><field name="dependentLevels"><default-field><text-line size="5"/></default-field></field><field name="submitButton"><default-field title="Submit"><submit/></default-field></field><field-layout><field-row-big><field-ref name="dependentLevels"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single><label text="${plainJsonStr}" type="pre" encode="true" style="pre-plain"/></widgets></screen>
<!-- Screen Location component://tools/screen/Tools/Entity/DataEdit.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Entities"><subscreens default-item="EntityList"/><widgets><subscreens-active/></widgets></screen>
<!-- Screen Location component://tools/screen/Tools/Entity/DataExport.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Export"><transition name="EntityExport" begin-transaction="false" read-only="true"><actions><script><![CDATA[import org.moqui.entity.EntityDataWriter
                import org.moqui.context.ExecutionContext
                ExecutionContext ec = context.ec
                EntityDataWriter edw = ec.entity.makeDataWriter()

                // handle entityNames
                if (!context.entityNames) {
                    ec.message.addError(ec.l10n.localize("No entity names specified, not exporting anything."))
                    return
                }

                if (entityNames instanceof String && entityNames.contains(",")) {
                    if (entityNames.startsWith("[")) entityNames = entityNames.substring(1)
                    if (entityNames.endsWith("]")) entityNames = entityNames.substring(0, entityNames.length() - 1)
                    entityNames = entityNames.split(",") as List
                }

                if (entityNames instanceof List) {
                    for (String entityName in entityNames) {
                        def entDef = ec.entity.getEntityDefinition(entityName)
                        if (entDef == null) ec.message.addError(ec.resource.expand('Could not find entity with name ${entityName}',''))
                    }
                    edw.entityNames(entityNames)
                } else {
                    def entDef = ec.entity.getEntityDefinition(entityNames)
                    if (entDef == null) ec.message.addError(ec.resource.expand('Could not find entity with name ${entityNames}',''))
                    edw.entityName(entityNames as String)
                }

                if (ec.message.hasError()) return

                if (dependentLevels) edw.dependentLevels(dependentLevels as int)
                if (masterName) edw.master(masterName)
                if (fromDate) edw.fromDate(ec.l10n.parseTimestamp(fromDate, null))
                if (thruDate) edw.thruDate(ec.l10n.parseTimestamp(thruDate, null))
                if (filterMap) edw.filterMap((Map) ec.resource.expression(filterMap, null))
                if (orderBy) edw.orderBy([(String) orderBy])
                edw.fileType((String) fileType)
                if(fileType == 'CSV') edw.tableColumnNames(useTableColumnNames == 'Yes' ? true : false)

                noResponse = false
                if (context.output == "file") {
                    edw.file(path)
                } else if (context.output == "dir") {
                    edw.directory(path)
                } else if (context.output == "browser") {
                    // stream to ec.web.response
                    def response = ec.web.response
                    response.setCharacterEncoding("UTF-8")
                    response.setHeader("Cache-Control", "no-cache, must-revalidate, private")

                    if (fileType == 'CSV' && entityNames instanceof List && entityNames.size() > 1) {
                        // if trying to export more than one entity as CSV, send a .zip file instead
                        response.setContentType('application/zip')
                        response.setHeader("Content-Disposition", "attachment; filename=\"EntityExport_${ec.l10n.format(ec.user.nowTimestamp, 'yyyyMMdd_HHmm')}.zip\";")
                        edw.zipDirectory('', response.getOutputStream())

                    } else {
                        if (fileType == 'JSON') response.setContentType('application/json')
                        else if (fileType == 'CSV') response.setContentType('text/csv')
                        else response.setContentType('text/xml')

                        response.setHeader("Content-Disposition", "attachment; filename=\"EntityExport_${ec.l10n.format(ec.user.nowTimestamp, 'yyyyMMdd_HHmm')}.${fileType == 'JSON' ? 'json' : fileType == 'CSV' ? 'csv' : 'xml'}\";")
                        edw.writer(response.getWriter())
                    }
                    noResponse = true
                }]]></script></actions><conditional-response url="."><condition><expression><![CDATA[!noResponse]]></expression></condition></conditional-response><default-response type="none"/></transition><widgets><form-single name="ExportData" transition="EntityExport"><field name="entityNames"><default-field><drop-down allow-multiple="true" size="80"><list-options list="ec.entity.getAllEntitiesInfo('fullEntityName', null, false, true)" key="${fullEntityName}"/></drop-down></default-field></field><field name="dependentLevels"><default-field><text-line size="2" default-value="0"/></default-field></field><field name="masterName"><default-field tooltip="Use master definition for each entity that has one with this name; try 'default'"><text-line size="15"/></default-field></field><field name="fromDate"><default-field><date-time/></default-field></field><field name="thruDate"><default-field><date-time/></default-field></field><field name="filterMap"><default-field><text-line size="80" default-value="[:]"/></default-field></field><field name="orderBy"><default-field><text-line size="80"/></default-field></field><field name="fileType"><default-field><radio no-current-selected-key="XML"><option key="XML"/><option key="JSON"/><option key="CSV"/></radio></default-field></field><field name="useTableColumnNames"><default-field title="Use Table Column Names (CSV Only)"><radio no-current-selected-key="No"><option key="No"/><option key="Yes"/></radio></default-field></field><field name="output"><default-field><radio no-current-selected-key="browser"><option key="file" text="Single File"/><option key="dir" text="Directory (one file per entity)"/><option key="browser" text="Out to Browser"/></radio></default-field></field><field name="path"><default-field><text-line size="80"/></default-field></field><field name="submitButton"><default-field title="Export"><submit/></default-field></field></form-single></widgets></screen>
<!-- Screen Location component://tools/screen/Tools/Entity/DataImport.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Import"><transition name="load"><actions><script><![CDATA[org.moqui.entity.EntityDataLoader edl = ec.entity.makeDataLoader()
            String source = ""
            if (types || components) {
                if (types) edl.dataTypes(new HashSet(Arrays.asList(types.split(","))))
                if (components) edl.componentNameList(Arrays.asList(components.split(",")))
                source = "Types: ${types?:'N/A'}, Components: ${components?:'N/A'}"
            } else if (location) {
                edl.location(location)
                source = location
            } else if (csvText) {
                edl.csvText(csvText)
                source = "CSV Text Box"
            } else if (jsonText) {
                edl.jsonText(jsonText)
                source = "JSON Text Box"
            } else if (xmlText) {
                edl.xmlText(xmlText)
                source = "XML Text Box"
            } else {
                ec.message.addMessage(ec.l10n.localize("No parameters specified, not loading data"))
                return
            }
            if (timeout) edl.transactionTimeout(timeout as Integer)
            if (dummyFks) edl.dummyFks(true)
            if (useTryInsert) edl.useTryInsert(true)
            if (hideNoActionFiles) edl.messageNoActionFiles(false)

            if (checkOnly) {
                // do nothing, checkOnly handled in screen actions before render
            } else if (onlyCreate) {
                edl.onlyCreate(true)
                List<String> messages = new LinkedList<>()
                long recordsLoaded = edl.load(messages)
                ec.message.addMessage("Loaded ${recordsLoaded} records from [${source}]")
                ec.web.session.setAttribute("DataImport.messages", messages)
            } else {
                List<String> messages = new LinkedList<>()
                long recordsLoaded = edl.load(messages)
                ec.message.addMessage("Loaded ${recordsLoaded} records from [${source}]")
                ec.web.session.setAttribute("DataImport.messages", messages)
            }]]></script></actions><conditional-response url="." save-parameters="true"><condition><expression><![CDATA[checkOnly]]></expression></condition><parameter name="runCheck" value="true"/></conditional-response><default-response url="."/></transition><transition name="storeSelected"><actions><script><![CDATA[import org.moqui.context.ExecutionContext
                ExecutionContext ec = context.ec

                int fieldsUpdated = 0
                List rowOpList = rowOps?.split(',')
                for (String rowOp in rowOpList) {
                    byte[] rowOpBytes = Base64.getUrlDecoder().decode((String) rowOp)
                    String rowOpJson = new String(rowOpBytes, 'UTF-8')
                    Map rowOpMap = org.moqui.impl.context.ContextJavaUtil.jacksonMapper.readValue((String) rowOpJson, Map.class)
                    if (!rowOpMap.pk) { ec.message.addMessage("No PK in row: ${rowOpJson}"); continue }

                    def ed = ec.entityFacade.getEntityDefinition(rowOpMap.entity)
                    if (ed == null) { ec.message.addMessage("Entity ${rowOpMap.entity} not found for row: ${rowOpJson}"); continue }

                    if (rowOpMap.field) {
                        Map valueMap = rowOpMap.pk + [(rowOpMap.field):rowOpMap.value]
                        org.moqui.impl.service.runner.EntityAutoServiceRunner.storeEntity(ec, ed, valueMap, null, null)
                        fieldsUpdated++
                    } else if (rowOpMap.createValues) {
                        Map valueMap = rowOpMap.createValues + rowOpMap.pk
                        Map results = new HashMap()
                        org.moqui.impl.service.runner.EntityAutoServiceRunner.createEntity(ec, ed, valueMap, results, null)
                        if (results.size() > 0) ec.message.addMessage("Create entity ${rowOpMap.entity} PK ${rowOpMap.pk} was not complete, filled in values: ${results}", "warning")
                        fieldsUpdated += (valueMap.size() - rowOpMap.pk.size())
                    } else {
                        // TODO: support create (at least for fields with complete PK)
                        ec.message.addMessage("Row has no field or create values, not updating: ${rowOpJson}")
                    }
                }

                ec.message.addMessage("Updated ${fieldsUpdated} fields")]]></script></actions><default-response url="." save-parameters="true"><parameter name="rowOps" from="null"/></default-response></transition><actions><set field="pageSize" from="pageSize ?: '100'"/><script><![CDATA[messages = ec.web.session.getAttribute('DataImport.messages')
            if (messages) ec.web.session.removeAttribute('DataImport.messages')]]></script></actions><widgets><form-single name="ImportData" transition="load"><field name="timeout"><default-field title="Timeout Seconds"><text-line size="5" default-value="60"/></default-field></field><field name="dummyFks"><default-field title=""><check><option key="true" text="Dummy FKs?"/></check></default-field></field><field name="useTryInsert"><default-field title=""><check><option key="true" text="Use Try Insert?"/></check></default-field></field><field name="hideNoActionFiles"><default-field title=""><check><option key="true" text="Hide No Action Files?"/></check></default-field></field><field name="types"><default-field tooltip="Comma Separated (from entity-facade-xml.@type)"><text-line size="60"/></default-field></field><field name="components"><default-field tooltip="Component Names, Comma Separated"><text-line size="60"/></default-field></field><field name="location"><default-field><text-line size="80"/></default-field></field><field name="xmlText"><default-field title="Text"><text-area rows="5" cols="120" default-value="<entity-facade-xml></entity-facade-xml>"/></default-field></field><field name="jsonText"><default-field title="Text"><text-area rows="5" cols="120" default-value=""/></default-field></field><field name="csvText"><default-field title="Text"><text-area rows="5" cols="120" default-value=""/></default-field></field><field name="checkOnly"><default-field title="Check Data"><submit/></default-field></field><field name="onlyCreate"><default-field title="Import Data - Create Only"><submit confirmation="Are you sure you want to load data, only creating missing records?"/></default-field></field><field name="importButton"><default-field title="Import Data - Create or Update"><submit confirmation="Are you sure you want to load data, creating new and updating existing records? If in doubt, cancel this and double check."/></default-field></field><field-layout><field-ref name="timeout"/><field-row-big><field-ref name="dummyFks"/><field-ref name="useTryInsert"/><field-ref name="hideNoActionFiles"/></field-row-big><field-accordion><field-group title="By Data Types"><field-ref name="types"/><field-ref name="components"/></field-group><field-group title="Resource Location"><field-ref name="location"/></field-group><field-group title="XML Text"><field-ref name="xmlText"/></field-group><field-group title="JSON Text"><field-ref name="jsonText"/></field-group><field-group title="CSV Text"><field-ref name="csvText"/></field-group></field-accordion><field-col-row><field-col md="4"><field-ref name="checkOnly"/></field-col><field-col md="4"><field-ref name="onlyCreate"/></field-col><field-col md="4"><field-ref name="importButton"/></field-col></field-col-row></field-layout></form-single><section-iterate name="MessageList" list="messages" entry="message"><widgets><label text="${(message_index+1).toString().padLeft(3,'0')}: ${message}" type="div"/></widgets></section-iterate><section name="CheckDiffSection" condition="runCheck == 'true'"><actions><script><![CDATA[org.moqui.entity.EntityDataLoader edl = ec.entity.makeDataLoader()
                String source = ""
                if (types || components) {
                    if (types) edl.dataTypes(new HashSet(Arrays.asList(types.split(","))))
                    if (components) edl.componentNameList(Arrays.asList(components.split(",")))
                    source = "Types: ${types?:'N/A'}, Components: ${components?:'N/A'}"
                } else if (location) {
                    edl.location(location)
                    source = location
                } else if (csvText) {
                    edl.csvText(csvText)
                    source = "CSV Text Box"
                } else if (jsonText) {
                    edl.jsonText(jsonText)
                    source = "JSON Text Box"
                } else if (xmlText) {
                    edl.xmlText(xmlText)
                    source = "XML Text Box"
                } else {
                    ec.message.addMessage(ec.l10n.localize("No parameters specified, not loading data"))
                    return
                }
                if (hideNoActionFiles) edl.messageNoActionFiles(false)

                messageList = new LinkedList<String>()
                diffInfoList = new LinkedList<Map<String, Object>>()
                fieldsChecked = edl.checkInfo(diffInfoList, messages)

                orderMapList(diffInfoList, ['entity', 'pk', 'field'])
                paginateList("diffInfoList", null, ec.context)]]></script></actions><widgets><section-iterate name="MessageList" list="messages" entry="message"><widgets><label text="${(message_index+1).toString().padLeft(3,'0')}: ${message}" type="div"/></widgets></section-iterate><form-list name="CheckDiffInfoList" list="diffInfoList" skip-form="true" show-page-size="true"><row-actions><if condition="notFound"><then><set field="rowOpMap" from="[entity:entity, pk:pk, createValues:createValues]"/></then><else><set field="rowOpMap" from="[entity:entity, pk:pk, field:field, value:value]"/></else></if><set field="rowOpJson" from="org.moqui.impl.context.ContextJavaUtil.jacksonMapper.writeValueAsString(rowOpMap)"/><set field="rowOp" from="Base64.getUrlEncoder().encodeToString(((String) rowOpJson).getBytes())"/></row-actions><row-selection id-field="rowOp" list-mode="true" parameter="rowOps"><action><form-single name="CheckDiffStoreSelected" transition="storeSelected" pass-through-parameters="true"><field name="submitBtn"><default-field title="Update Fields to Check/File Value and Create Missing Records"><submit/></default-field></field><field-layout><field-row-big><field-ref name="submitBtn"/></field-row-big></field-layout></form-single></action></row-selection><field name="entity"><default-field><display style="text-strong"/></default-field></field><field name="pk"><default-field title="Primary Key"><display style="${pkComplete ? '' : 'text-danger'}"/></default-field></field><field name="field"><default-field><display style="text-strong"/></default-field></field><field name="value"><default-field title="Check/File Value"><display/></default-field></field><field name="dbValue"><default-field><display/></default-field></field><field name="notFound"><default-field><display/></default-field></field><field name="pkComplete"><default-field><display style="${pkComplete ? '' : 'text-danger'}"/></default-field></field><field name="location"><default-field><display text="${location.contains('/component/') ? location.substring(location.indexOf('/component/') + 11) : location}"/></default-field></field><columns><column><field-ref name="entity"/><field-ref name="pk"/></column><column><field-ref name="notFound"/><field-ref name="pkComplete"/></column><column><field-ref name="field"/></column><column><field-ref name="value"/><field-ref name="dbValue"/></column><column><field-ref name="location"/></column></columns></form-list></widgets></section></widgets></screen>
<!-- Screen Location component://tools/screen/Tools/Entity/QueryStats.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Query Stats"><transition name="clearQueryStats"><actions><script><![CDATA[ec.entity.clearQueryStats()]]></script></actions><default-response url="."/></transition><actions><set field="queryStatsList" from="ec.entity.getQueryStatsList(orderByField?:'-totalTime', entityFilter, sqlFilter)"/><set field="pageSize" from="pageSize ?: '40'"/><script><![CDATA[paginateList("queryStatsList", null, context)]]></script></actions><widgets><link url="clearQueryStats" text="Clear Stats"/><label text="Statistics for queries run since server start. All times are in microseconds."/><form-single name="FilterForm" transition="."><field name="entityFilter"><default-field><text-line size="30"/></default-field></field><field name="sqlFilter"><default-field title="SQL Filter"><text-line size="30"/></default-field></field><field name="submitButton"><default-field title="Filter"><submit/></default-field></field><field-layout><field-row-big><field-ref name="entityFilter"/><field-ref name="sqlFilter"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single><form-list name="QueryStatsList" list="queryStatsList" skip-form="true"><row-actions><set field="artifactInfoList" from="[]"/><iterate list="artifactCounts" entry="count" key="artifact"><script><![CDATA[artifactInfoList.add([artifact:artifact, count:count])]]></script></iterate><order-map-list list="artifactInfoList"><order-by field-name="-count"/></order-map-list></row-actions><field name="entityName"><header-field show-order-by="true"/><default-field><display/></default-field></field><field name="sql"><header-field title="SQL" show-order-by="true"/><conditional-field condition="sql != null && sql.length() > 500"><display text="${sql.substring(0, 500)} "/><container-dialog id="ViewSql" button-text="All" width="800"><label text="${sql}"/></container-dialog></conditional-field><default-field><display/></default-field></field><field name="artifactCounts"><default-field><section-iterate name="ArtifactCounts" list="artifactInfoList" entry="artifactInfo"><widgets><label text="${artifactInfo.artifact} - ${artifactInfo.count}" type="div"/></widgets></section-iterate></default-field></field><field name="hitCount"><header-field title="Hits" show-order-by="true"/><default-field><display/></default-field></field><field name="errorCount"><header-field title="Errors" show-order-by="true"/><default-field><display/></default-field></field><field name="minTime"><header-field title="Min" show-order-by="true"/><default-field><display format="#,##0.0"/></default-field></field><field name="maxTime"><header-field title="Max" show-order-by="true"/><default-field><display format="#,##0.0"/></default-field></field><field name="totalTime"><header-field title="Total" show-order-by="true"/><default-field><display format="#,##0.0"/></default-field></field><field name="average"><header-field title="Avg" show-order-by="true"/><default-field><display format="#,##0.0"/></default-field></field><field name="stdDev"><header-field title="Std Dev" show-order-by="true"/><default-field><display format="#,##0.0"/></default-field></field><form-list-column><field-ref name="entityName"/><field-ref name="sql"/><field-ref name="artifactCounts"/></form-list-column><form-list-column><field-ref name="hitCount"/><field-ref name="errorCount"/></form-list-column><form-list-column><field-ref name="minTime"/><field-ref name="maxTime"/><field-ref name="average"/></form-list-column><form-list-column><field-ref name="totalTime"/><field-ref name="stdDev"/></form-list-column></form-list></widgets></screen>
<!-- Screen Location component://tools/screen/Tools/Entity/DataSnapshot.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Snapshots"><transition name="exportSnapshot" begin-transaction="false"><actions><script><![CDATA[if (!entitiesToInclude) entitiesToInclude = null
                if (entitiesToInclude != null && !(entitiesToInclude instanceof List)) entitiesToInclude = [entitiesToInclude]
                if (!entitiesToSkip) entitiesToSkip = null
                if (entitiesToSkip != null && !(entitiesToSkip instanceof List)) entitiesToSkip = [entitiesToSkip]
                if ("CSV".equals(fileType)) filePerEntity = true
                jobRunId = ec.service.job("ExportEntityDataSnapshot")
                    .parameters([fromDate:fromDate, thruDate:thruDate, baseFilename:baseFilename, fileType:fileType,
                                 filePerEntity:filePerEntity, isoDateTime:isoDateTime, tableColumnNames:tableColumnNames,
                                 entitiesToSkip:entitiesToSkip, entitiesToInclude:entitiesToInclude]).run()]]></script><message><![CDATA[Started Export Entity Data Snapshot ${baseFilename} (Job ID ${jobRunId})]]></message></actions><default-response url="."/></transition><transition name="downloadSnapshot" begin-transaction="false" read-only="true"><actions><script><![CDATA[ec.web.sendResourceResponse("db/snapshot/" + filename)]]></script></actions><default-response type="none"/></transition><transition name="deleteSnapshot" begin-transaction="false"><actions><script><![CDATA[ec.resource.getLocationReference("db/snapshot/" + filename).delete()]]></script></actions><default-response url="."/></transition><transition name="importSnapshot" begin-transaction="false"><actions><script><![CDATA[jobRunId = ec.service.job("ImportEntityDataSnapshot").parameters(context).run()]]></script><message><![CDATA[Started Import Entity Data Snapshot ${filename} (Job ID ${jobRunId})]]></message></actions><default-response url="."/></transition><transition name="uploadSnapshot" begin-transaction="false"><actions><script><![CDATA[String filename = snapshotFile.getName()
            if (!filename.endsWith(".zip")) { ec.message.addError("File ${filename} is not a zip file, should be a zip containing one or more xml data files"); return; }
            File targetFile = new File((String) ec.factory.getRuntimePath() + '/db/snapshot/' + filename)
            if (!targetFile.parentFile.exists()) targetFile.parentFile.mkdirs()
            if (targetFile.exists()) { ec.message.addError("File ${filename} already exists"); return }
            InputStream fileStream = snapshotFile.getInputStream()
            try { targetFile.append(fileStream) } finally { fileStream.close() }]]></script></actions><default-response url="."/></transition><transition name="dropForeignKeys" begin-transaction="false"><actions><script><![CDATA[ec.entity.entityDbMeta.forceCheckExistingTables()]]></script><set field="dropped" from="ec.entity.getEntityDbMeta().dropAllForeignKeys()"/><message><![CDATA[Dropped ${dropped} foreign keys]]></message></actions><default-response url="."/></transition><transition name="createForeignKeys" begin-transaction="false"><actions><set field="created" from="ec.entity.getEntityDbMeta().createForeignKeysForExistingTables()"/><message><![CDATA[Created ${created} foreign keys]]></message></actions><default-response url="."/></transition><actions><script><![CDATA[File snapshotDir = new File((String) ec.factory.getRuntimePath() + '/db/snapshot')
            snapshotFiles = snapshotDir.exists() ? snapshotDir.listFiles() : null
            snapshotList = []
            if (snapshotFiles) for (File sfile in snapshotFiles)
                if (!sfile.isDirectory() && sfile.getName().endsWith(".zip") && sfile.length() > 0) snapshotList.add(sfile)]]></script></actions><widgets><container-dialog id="ExportDialog" button-text="Export Snapshot"><form-single name="ExportData" transition="exportSnapshot"><field name="entitiesToInclude"><default-field tooltip="Defaults to include all if none selected and one or more skip entities specified"><drop-down allow-multiple="true" size="80"><list-options list="ec.entity.getAllEntitiesInfo('fullEntityName', null, false, true)" key="${fullEntityName}"/></drop-down></default-field></field><field name="entitiesToSkip"><default-field><drop-down allow-multiple="true" size="80"><list-options list="ec.entity.getAllEntitiesInfo('fullEntityName', null, false, true)" key="${fullEntityName}"/></drop-down></default-field></field><field name="fromDate"><default-field><date-time minute-stepping="1"/></default-field></field><field name="thruDate"><default-field><date-time minute-stepping="1"/></default-field></field><field name="baseFilename"><default-field><text-line size="40" default-value="MoquiSnapshot-${ec.l10n.format(ec.user.nowTimestamp, 'yyyyMMdd-HHmm')}"/></default-field></field><field name="fileType"><default-field><radio no-current-selected-key="XML"><option key="XML"/><option key="JSON"/><option key="CSV"/></radio></default-field></field><field name="filePerEntity"><default-field><radio no-current-selected-key="false"><option key="true"/><option key="false"/></radio></default-field></field><field name="isoDateTime"><default-field title="ISO Date Time" tooltip="CSV ONLY"><radio no-current-selected-key="false"><option key="true"/><option key="false"/></radio></default-field></field><field name="tableColumnNames"><default-field tooltip="CSV ONLY, use table and column names instead of entity and field names"><radio no-current-selected-key="false"><option key="true"/><option key="false"/></radio></default-field></field><field name="submitButton"><default-field title="Export Snapshot"><submit/></default-field></field></form-single></container-dialog><container-dialog id="UploadDialog" button-text="Upload Snapshot"><form-single name="UploadSnapshot" transition="uploadSnapshot"><field name="snapshotFile"><default-field><file size="50"/></default-field></field><field name="submitButton"><default-field title="Upload Snapshot"><submit/></default-field></field></form-single></container-dialog><link url="dropForeignKeys" text="Drop FKs" confirmation="Really drop all known foreign keys?"/><link url="createForeignKeys" text="Create FKs" confirmation="Really create all missing foreign keys?"/><label text="Current Snapshot Files" type="h4"/><section-iterate name="SnapshotListSection" list="snapshotList" entry="sfile"><widgets><container-row><row-col sm="4"><label text="${sfile.name}"/></row-col><row-col sm="2"><label text="${ec.l10n.format(new java.sql.Timestamp(sfile.lastModified()), null)}"/></row-col><row-col sm="2"><label text="${ec.l10n.format((sfile.length())/(1024*1024), '#,##0.00')} MiB"/></row-col><row-col sm="1"><link url="downloadSnapshot" text="Download" parameter-map="[filename:sfile.name]"/></row-col><row-col sm="1"><link url="deleteSnapshot" text="Delete" parameter-map="[filename:sfile.name]" confirmation="Really delete ${sfile.name}?"/></row-col><row-col sm="1"><container-dialog id="ImportDialog" button-text="Import"><form-single name="ImportForm" transition="importSnapshot"><field name="zipFilename" from="sfile.name"><default-field><display/></default-field></field><field name="dummyFks"><default-field><radio no-current-selected-key="false"><option key="true"/><option key="false"/></radio></default-field></field><field name="useTryInsert"><default-field><radio no-current-selected-key="false"><option key="true"/><option key="false"/></radio></default-field></field><field name="disableEntityEca"><default-field><radio no-current-selected-key="true"><option key="true"/><option key="false"/></radio></default-field></field><field name="disableAuditLog"><default-field><radio no-current-selected-key="true"><option key="true"/><option key="false"/></radio></default-field></field><field name="disableFkCreate"><default-field><radio no-current-selected-key="true"><option key="true"/><option key="false"/></radio></default-field></field><field name="disableDataFeed"><default-field><radio no-current-selected-key="true"><option key="true"/><option key="false"/></radio></default-field></field><field name="transactionTimeout"><default-field><text-line size="6" default-value="3600"/></default-field></field><field name="submitButton"><default-field title="Import Snapshot"><submit/></default-field></field></form-single></container-dialog></row-col></container-row></widgets></section-iterate></widgets></screen>
<!-- Screen Location component://tools/screen/Tools/Entity/SpeedTest.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Speed Test" begin-transaction="true"><transition name="speedTest"><default-response url="."/></transition><actions><script><![CDATA[import groovy.transform.CompileStatic
            import javax.cache.Cache
            import org.moqui.context.ExecutionContext
            import org.moqui.impl.entity.EntityFacadeImpl
            import org.moqui.entity.EntityValue
            import org.moqui.entity.EntityCondition
            import org.moqui.entity.EntityConditionFactory
            import org.moqui.screen.ScreenTest
            import org.moqui.util.RestClient

            import java.text.DecimalFormat
            import java.sql.Timestamp
            import org.slf4j.Logger
            import org.slf4j.LoggerFactory

            Logger logger = LoggerFactory.getLogger("SpeedTest")

            beginTime = System.nanoTime()

            baseCalls = baseCalls ?: '1000'
            baseCallsNum = ec.l10n.parseNumber(baseCalls, '') as int

            performanceList = runTests(baseCallsNum, context.ec, logger)

            @CompileStatic
            List runTests(int baseCallsNum, ExecutionContext ec, Logger logger) {
                boolean generalCacheTests = true
                boolean findCacheTests = true
                boolean findTests = true
                boolean directCrudTests = true
                boolean serviceCrudTests = true
                boolean directNoSqlCrudTests = true
                boolean serviceCallTests = true
                boolean screenRenderTests = true
                boolean restApiTests = true

                EntityFacadeImpl ef = (EntityFacadeImpl) ec.entity
                Timestamp nowTs = new Timestamp(System.currentTimeMillis())

                // NOTE: long sleep times (like 1000ms) do help the numbers, but still somewhat inconsistent
                long sleepTime = 10

                List performanceList = []

                // direct cache writes and reads with EC
                int calls = baseCallsNum * 2
                BigDecimal milliseconds = 0
                Cache testDistCache = ec.cache.getDistributedCache("test.cache.dist")
                testDistCache.clear()
                Cache testLocalCache = ec.cache.getLocalCache("test.cache.local")
                testLocalCache.clear()
                EntityValue testEnumValue =
                        ef.find("moqui.basic.Enumeration").condition("enumId", "_NA_").useCache(true).one()
                // to measure the cache time and not the condition creation time, create those in advance
                long startTime = System.nanoTime()
                EntityConditionFactory ecf = ef.conditionFactory

                if (generalCacheTests) {
                    List<EntityCondition> conditionList = new ArrayList(calls)

                    for (int i = 0; i < calls; i++)
                        conditionList.add(ecf.makeCondition("enumId", EntityCondition.EQUALS, "_NA_" + i))
                    milliseconds = ((System.nanoTime() - startTime) / 1E6)
                    performanceList.add([operation     : "create EntityCondition (${conditionList.size()})", entity: "",
                                         calls         : calls, milliseconds: milliseconds, msPerCall: (milliseconds / calls),
                                         callsPerSecond: ((calls / milliseconds) * 1000)])

                    startTime = System.nanoTime()
                    int distCalls = (calls / 10).intValue() ?: 1
                    for (int i = 0; i < distCalls; i++) testDistCache.put(conditionList[i], testEnumValue)
                    milliseconds = ((System.nanoTime() - startTime) / 1E6)
                    performanceList.add([operation     : "direct cache writes - dist", entity: "moqui.basic.Enumeration",
                                         calls         : distCalls, milliseconds: milliseconds, msPerCall: (milliseconds / distCalls),
                                         callsPerSecond: ((distCalls / milliseconds) * 1000)])

                    startTime = System.nanoTime()
                    for (int i = 0; i < distCalls; i++) testDistCache.get(conditionList[i])
                    milliseconds = ((System.nanoTime() - startTime) / 1E6)
                    performanceList.add([operation     : "direct cache reads - dist", entity: "moqui.basic.Enumeration",
                                         calls         : distCalls, milliseconds: milliseconds, msPerCall: (milliseconds / distCalls),
                                         callsPerSecond: ((distCalls / milliseconds) * 1000)])

                    startTime = System.nanoTime()
                    for (int i = 0; i < calls; i++) testLocalCache.put(conditionList[i], testEnumValue)
                    milliseconds = ((System.nanoTime() - startTime) / 1E6)
                    performanceList.add([operation     : "direct cache writes - local  (${testLocalCache.size()})", entity: "moqui.basic.Enumeration",
                                         calls         : calls, milliseconds: milliseconds, msPerCall: (milliseconds / calls),
                                         callsPerSecond: ((calls / milliseconds) * 1000)])

                    startTime = System.nanoTime()
                    for (int i = 0; i < calls; i++) {
                        EntityCondition cond = conditionList[i]
                        testLocalCache.get(cond)
                        testLocalCache.get(cond)
                        testLocalCache.get(cond)
                        testLocalCache.get(cond)
                        testLocalCache.get(cond)
                    }
                    milliseconds = ((System.nanoTime() - startTime) / 1E6)
                    calls = calls * 5
                    performanceList.add([operation     : "direct cache reads - local", entity: "moqui.basic.Enumeration",
                                         calls         : calls, milliseconds: milliseconds, msPerCall: (milliseconds / calls),
                                         callsPerSecond: ((calls / milliseconds) * 1000)])

                    // sleep to hopefully let GC do its thing, make times more consistent
                    sleep(sleepTime)
                }

                if (findCacheTests) {
                    // one PK cache
                    // get it in the cache first
                    ef.find("moqui.basic.Enumeration").condition("enumId", "_NA_").useCache(true).one()
                    calls = baseCallsNum
                    startTime = System.nanoTime()
                    for (int i = 0; i < calls; i++) ef.find("moqui.basic.Enumeration").condition("enumId", "_NA_").useCache(true).one()
                    milliseconds = ((System.nanoTime() - startTime) / 1E6)
                    performanceList.add([operation     : "one PK cache", entity: "moqui.basic.Enumeration",
                                         calls         : calls, milliseconds: milliseconds, msPerCall: (milliseconds / calls),
                                         callsPerSecond: ((calls / milliseconds) * 1000)])

                    // one PK cache fast find
                    startTime = System.nanoTime()
                    for (int i = 0; i < calls; i++) ef.fastFindOne("moqui.basic.Enumeration", true, false, "_NA_")
                    milliseconds = ((System.nanoTime() - startTime) / 1E6)
                    performanceList.add([operation     : "one PK cache fast", entity: "moqui.basic.Enumeration",
                                         calls         : calls, milliseconds: milliseconds, msPerCall: (milliseconds / calls),
                                         callsPerSecond: ((calls / milliseconds) * 1000)])

                    // list cache
                    // get it in the cache first
                    ef.find("moqui.basic.Enumeration").condition("enumTypeId", "EntitySyncArtifactAppl").useCache(true).list()
                    calls = baseCallsNum
                    startTime = System.nanoTime()
                    for (int i = 0; i < calls; i++)
                        ef.find("moqui.basic.Enumeration").condition("enumTypeId", "EntitySyncArtifactAppl").useCache(true).list()
                    milliseconds = ((System.nanoTime() - startTime) / 1E6)
                    performanceList.add([operation     : "list cache by type", entity: "moqui.basic.Enumeration",
                                         calls         : calls, milliseconds: milliseconds, msPerCall: (milliseconds / calls),
                                         callsPerSecond: ((calls / milliseconds) * 1000)])
                }

                if (findTests) {
                    // one PK
                    calls = baseCallsNum
                    startTime = System.nanoTime()
                    for (int i = 0; i < calls; i++) ef.find("moqui.basic.Enumeration").condition("enumId", "_NA_").useCache(false).one()
                    milliseconds = ((System.nanoTime() - startTime) / 1E6)
                    performanceList.add([operation     : "one PK", entity: "moqui.basic.Enumeration",
                                         calls         : calls, milliseconds: milliseconds, msPerCall: (milliseconds / calls),
                                         callsPerSecond: ((calls / milliseconds) * 1000)])

                    // one PK fast find
                    startTime = System.nanoTime()
                    for (int i = 0; i < calls; i++) ef.fastFindOne("moqui.basic.Enumeration", false, false, "_NA_")
                    milliseconds = ((System.nanoTime() - startTime) / 1E6)
                    performanceList.add([operation     : "one PK fast", entity: "moqui.basic.Enumeration",
                                         calls         : calls, milliseconds: milliseconds, msPerCall: (milliseconds / calls),
                                         callsPerSecond: ((calls / milliseconds) * 1000)])

                    // list
                    calls = baseCallsNum
                    startTime = System.nanoTime()
                    for (int i = 0; i < calls; i++)
                        ef.find("moqui.basic.Enumeration").condition("enumTypeId", "EntitySyncArtifactAppl").useCache(false).list()
                    milliseconds = ((System.nanoTime() - startTime) / 1E6)
                    performanceList.add([operation     : "list by type", entity: "moqui.basic.Enumeration",
                                         calls         : calls, milliseconds: milliseconds, msPerCall: (milliseconds / calls),
                                         callsPerSecond: ((calls / milliseconds) * 1000)])
                }

                // ========== direct CrUD tests ==========
                if (directCrudTests) {
                    calls = baseCallsNum

                    // sleep to hopefully let GC do its thing, make times more consistent
                    sleep(sleepTime)

                    // create with sequenced ID test
                    startTime = System.nanoTime()
                    ArrayList<EntityValue> createTestList = new ArrayList<EntityValue>(calls * 2)
                    for (int i = 0; i < calls; i++) {
                        createTestList.add(ef.makeValue("moqui.test.TestEntity")
                                .setFields([testMedium       : "Medium " + i,
                                            testLong         : "Long " + i, testIndicator: "Y", testDateTime: nowTs, testNumberInteger: i,
                                            testNumberDecimal: (i + 0.5)] as Map<String, Object>, true, null, null).setSequencedIdPrimary().create())
                    }
                    milliseconds = ((System.nanoTime() - startTime) / 1E6)
                    performanceList.add([operation     : "direct create with sequenced ID", entity: "moqui.test.TestEntity",
                                         calls         : calls, milliseconds: milliseconds,
                                         msPerCall     : (milliseconds / calls),
                                         callsPerSecond: ((calls / milliseconds) * 1000)])

                    // create with preset ID test
                    startTime = System.nanoTime()
                    for (int i = 0; i < calls; i++) {
                        createTestList.add(ef.makeValue("moqui.test.TestEntity")
                                .setFields([testId           : ("id" + i),
                                            testMedium       : "Medium " + i, testLong: "Long " + i, testIndicator: "Y", testDateTime: nowTs,
                                            testNumberInteger: i, testNumberDecimal: (i + 0.5)] as Map<String, Object>, true, null, null).create())
                    }
                    milliseconds = ((System.nanoTime() - startTime) / 1E6)
                    performanceList.add([operation     : "direct create with preset ID", entity: "moqui.test.TestEntity",
                                         calls         : calls, milliseconds: milliseconds, msPerCall: (milliseconds / calls),
                                         callsPerSecond: ((calls / milliseconds) * 1000)])

                    // sleep to hopefully let GC do its thing, make times more consistent
                    sleep(sleepTime)

                    // update test
                    calls = createTestList.size()
                    startTime = System.nanoTime()
                    for (int i = 0; i < calls; i++) {
                        EntityValue ev = (EntityValue) createTestList.get(i)
                        ev.testMedium = (ev.testMedium as String) + " - Updated"
                        ev.update()
                    }
                    milliseconds = ((System.nanoTime() - startTime) / 1E6)
                    performanceList.add([operation     : "direct update", entity: "moqui.test.TestEntity",
                                         calls         : calls, milliseconds: milliseconds, msPerCall: (milliseconds / calls),
                                         callsPerSecond: ((calls / milliseconds) * 1000)])

                    // delete
                    calls = createTestList.size()
                    startTime = System.nanoTime()
                    for (int i = 0; i < calls; i++) {
                        EntityValue ev = (EntityValue) createTestList.get(i)
                        ev.delete()
                    }
                    milliseconds = ((System.nanoTime() - startTime) / 1E6)
                    performanceList.add([operation     : "direct delete", entity: "moqui.test.TestEntity",
                                         calls         : calls, milliseconds: milliseconds, msPerCall: (milliseconds / calls),
                                         callsPerSecond: ((calls / milliseconds) * 1000)])
                }

                // ========== service CrUD tests ==========
                if (serviceCrudTests) {
                    calls = baseCallsNum

                    // sleep to hopefully let GC do its thing, make times more consistent
                    sleep(sleepTime)

                    // create with sequenced ID test
                    startTime = System.nanoTime()
                    ArrayList<String> createTestIdList = new ArrayList<String>(calls)
                    for (int i = 0; i < calls; i++) {
                        createTestIdList.add(ec.service.sync().name("create", "moqui.test.TestEntity").parameters([
                                testMedium       : "Medium " + i, testLong: "Long " + i, testIndicator: "Y", testDateTime: nowTs,
                                testNumberInteger: i, testNumberDecimal: (i + 0.5)]).call().testId as String)
                    }
                    milliseconds = ((System.nanoTime() - startTime) / 1E6)
                    performanceList.add([operation     : "service create with sequenced ID", entity: "moqui.test.TestEntity",
                                         calls         : calls, milliseconds: milliseconds, msPerCall: (milliseconds / calls),
                                         callsPerSecond: ((calls / milliseconds) * 1000)])

                    // update test
                    calls = createTestIdList.size()
                    startTime = System.nanoTime()
                    for (int i = 0; i < calls; i++) {
                        String id = (String) createTestIdList.get(i)
                        ec.service.sync().name("update", "moqui.test.TestEntity").parameters([testId: id, testMedium: "Updated Text"]).call()
                    }
                    milliseconds = ((System.nanoTime() - startTime) / 1E6)
                    performanceList.add([operation     : "service update", entity: "moqui.test.TestEntity",
                                         calls         : calls, milliseconds: milliseconds, msPerCall: (milliseconds / calls),
                                         callsPerSecond: ((calls / milliseconds) * 1000)])

                    // delete
                    calls = createTestIdList.size()
                    startTime = System.nanoTime()
                    for (int i = 0; i < calls; i++) {
                        String id = (String) createTestIdList.get(i)
                        ec.service.sync().name("delete", "moqui.test.TestEntity").parameter("testId", id).call()
                    }
                    milliseconds = ((System.nanoTime() - startTime) / 1E6)
                    performanceList.add([operation     : "service delete", entity: "moqui.test.TestEntity", calls: calls, milliseconds: milliseconds,
                                         msPerCall     : (milliseconds / calls),
                                         callsPerSecond: ((calls / milliseconds) * 1000)])
                }

                // ========== NoSQL direct CrUD tests ==========
                if (directNoSqlCrudTests) {
                    calls = baseCallsNum

                    // sleep to hopefully let GC do its thing, make times more consistent
                    sleep(sleepTime)

                    // create with sequenced ID test
                    startTime = System.nanoTime()
                    ArrayList<EntityValue> createNoSqlTestList = new ArrayList<EntityValue>(calls * 2)
                    for (int i = 0; i < calls; i++) {
                        EntityValue ev = ef.makeValue("moqui.test.TestNoSqlEntity")
                                .setFields([testMedium       : "Medium " + i,
                                            testLong         : "Long " + i, testIndicator: "Y", testDateTime: nowTs, testNumberInteger: i,
                                            testNumberDecimal: (i + 0.5)] as Map<String, Object>, true, null, null).setSequencedIdPrimary().create()
                        createNoSqlTestList.add(ev)
                        // logger.warn("===== created TestNoSqlEntity value ${ev}")
                    }
                    milliseconds = ((System.nanoTime() - startTime) / 1E6)
                    performanceList.add([operation     : "direct create with sequenced ID", entity: "moqui.test.TestNoSqlEntity",
                                         calls         : calls, milliseconds: milliseconds, msPerCall: (milliseconds / calls),
                                         callsPerSecond: ((calls / milliseconds) * 1000)])

                    // create with preset ID test
                    startTime = System.nanoTime()
                    for (int i = 0; i < calls; i++) {
                        createNoSqlTestList.add(ef.makeValue("moqui.test.TestNoSqlEntity")
                                .setFields([testId           : ("id" + i),
                                            testMedium       : "Medium " + i, testLong: "Long " + i, testIndicator: "Y", testDateTime: nowTs,
                                            testNumberInteger: i, testNumberDecimal: (i + 0.5)] as Map<String, Object>, true, null, null).create())
                    }
                    milliseconds = ((System.nanoTime() - startTime) / 1E6)
                    performanceList.add([operation     : "direct create with preset ID", entity: "moqui.test.TestNoSqlEntity",
                                         calls         : calls, milliseconds: milliseconds, msPerCall: (milliseconds / calls),
                                         callsPerSecond: ((calls / milliseconds) * 1000)])

                    // sleep to hopefully let GC do its thing, make times more consistent
                    sleep(sleepTime)

                    // update test
                    calls = createNoSqlTestList.size()
                    startTime = System.nanoTime()
                    for (int i = 0; i < calls; i++) {
                        EntityValue ev = (EntityValue) createNoSqlTestList.get(i)
                        ev.testMedium = (ev.testMedium as String) + " - Updated"
                        ev.update()
                    }
                    milliseconds = ((System.nanoTime() - startTime) / 1E6)
                    performanceList.add([operation     : "direct update", entity: "moqui.test.TestNoSqlEntity",
                                         calls         : calls, milliseconds: milliseconds, msPerCall: (milliseconds / calls),
                                         callsPerSecond: ((calls / milliseconds) * 1000)])

                    // delete
                    calls = createNoSqlTestList.size()
                    startTime = System.nanoTime()
                    for (int i = 0; i < calls; i++) {
                        EntityValue ev = (EntityValue) createNoSqlTestList.get(i)
                        ev.delete()
                    }
                    milliseconds = ((System.nanoTime() - startTime) / 1E6)
                    performanceList.add([operation     : "direct delete", entity: "moqui.test.TestNoSqlEntity",
                                         calls         : calls, milliseconds: milliseconds, msPerCall: (milliseconds / calls),
                                         callsPerSecond: ((calls / milliseconds) * 1000)])
                }

                // ========== Service Call tests ==========
                if (serviceCallTests) {
                    calls = baseCallsNum

                    Map dataMap = [textIn1:"foo", numberIn:12.34, timestampIn:ec.user.nowTimestamp]
                    startTime = System.nanoTime()
                    for (int i = 0; i < calls; i++)
                        ec.service.sync().name("org.moqui.impl.BasicServices.echo#Data").parameters(dataMap).call()
                    milliseconds = ((System.nanoTime() - startTime) / 1E6)
                    performanceList.add([operation     : "Call BasicServices.echo#Data Service", entity: "",
                                         calls         : calls, milliseconds: milliseconds, msPerCall: (milliseconds / calls),
                                         callsPerSecond: ((calls / milliseconds) * 1000)])
                }

                // ========== Screen Render tests ==========
                if (screenRenderTests) {
                    boolean tarpitAlreadyDisabled = ec.artifactExecution.disableTarpit()

                    calls = (baseCallsNum / 100).intValue() ?: 1
                    ScreenTest screenTest = ec.screen.makeTest().baseScreenPath("apps/system")

                    // Render Dashboard (simple screen, mostly screen overhead)
                    startTime = System.nanoTime()
                    for (int i = 0; i < calls; i++) screenTest.render("dashboard", null, null)
                    milliseconds = ((System.nanoTime() - startTime) / 1E6)
                    performanceList.add([operation     : "Render System Dashboard Screen", entity: "",
                                         calls         : calls, milliseconds: milliseconds, msPerCall: (milliseconds / calls),
                                         callsPerSecond: ((calls / milliseconds) * 1000)])

                    // Render ArtifactHitSummary
                    startTime = System.nanoTime()
                    for (int i = 0; i < calls; i++) screenTest.render("ArtifactHitSummary?artifactType=AT_XML_SCREEN", null, null)
                    milliseconds = ((System.nanoTime() - startTime) / 1E6)
                    performanceList.add([operation     : "Render System ArtifactHitSummary Screen", entity: "",
                                         calls         : calls, milliseconds: milliseconds, msPerCall: (milliseconds / calls),
                                         callsPerSecond: ((calls / milliseconds) * 1000)])

                    logger.info("Rendered ${screenTest.renderCount} screens (${screenTest.errorCount} errors) in ${ec.l10n.format(milliseconds/1000, "0.000")}s, output ${ec.l10n.format(screenTest.renderTotalChars/1000, "#,##0")}k chars")

                    // Get webroot-layout.css
                    calls = (baseCallsNum / 10).intValue() ?: 1
                    ScreenTest screenTestRoot = ec.screen.makeTest()
                    startTime = System.nanoTime()
                    for (int i = 0; i < calls; i++) screenTestRoot.render("css/webroot-layout.css", null, null)
                    milliseconds = ((System.nanoTime() - startTime) / 1E6)
                    performanceList.add([operation     : "Get webroot-layout.css", entity: "",
                                         calls         : calls, milliseconds: milliseconds, msPerCall: (milliseconds / calls),
                                         callsPerSecond: ((calls / milliseconds) * 1000)])

                    logger.info("Rendered ${screenTestRoot.renderCount} screens (${screenTestRoot.errorCount} errors) in ${ec.l10n.format(milliseconds/1000, "0.000")}s, output ${ec.l10n.format(screenTestRoot.renderTotalChars/1000, "#,##0")}k chars")

                    if (!tarpitAlreadyDisabled) ec.artifactExecution.enableTarpit()
                }

                // ========== Service REST API tests ==========
                if (restApiTests) {
                    boolean tarpitAlreadyDisabled = ec.artifactExecution.disableTarpit()
                    calls = (baseCallsNum / 100).intValue() ?: 1
                    String apiKey = ec.user.getLoginKey()
                    String enumUri = ec.web.getWebappRootUrl(true, null) + "/rest/s1/moqui/basic/enums/EsaaAlways"

                    // Render Dashboard (simple screen, mostly screen overhead)
                    startTime = System.nanoTime()
                    boolean gotError = false
                    try {
                        for (int i = 0; i < calls; i++) {
                            RestClient rc = ec.service.rest().method(RestClient.GET).uri(enumUri).addHeader("api_key", apiKey)
                            RestClient.RestResponse response = rc.call()
                            // logger.warn("REST response: ${response.text()}")
                        }
                    } catch (Exception e) {
                        logger.warn("REST API error, ignoring as web server may not be running: ${e.toString()}")
                        gotError = true
                    }
                    milliseconds = ((System.nanoTime() - startTime) / 1E6)
                    performanceList.add([operation     : "REST Client API get /basic/enums" + (gotError ? " GOT ERROR" : ""), entity: "",
                                         calls         : calls, milliseconds: milliseconds, msPerCall: (milliseconds / calls),
                                         callsPerSecond: ((calls / milliseconds) * 1000)])

                    if (!tarpitAlreadyDisabled) ec.artifactExecution.enableTarpit()
                }

                return performanceList
            }]]></script></actions><widgets><form-single name="SelectBaseCalls" transition="speedTest"><field name="baseCalls"><default-field><text-line size="10"/></default-field></field><field name="submitButton"><default-field title="Run"><submit/></default-field></field><field-layout><field-row-big><field-ref name="baseCalls"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single><form-list name="PerformanceResults" list="performanceList"><field name="operation"><default-field><display/></default-field></field><field name="entity"><default-field><display/></default-field></field><field name="calls"><default-field><display/></default-field></field><field name="milliseconds"><default-field><display format="0.000"/></default-field></field><field name="msPerCall"><default-field><display format="0.000000"/></default-field></field><field name="callsPerSecond"><default-field><display format="#,##0.00"/></default-field></field></form-list><label text="Total Time ${ec.l10n.format((System.nanoTime() - beginTime)/1E9, '0.00')}s" type="strong"/></widgets></screen>
<!-- Screen Location component://tools/screen/Tools/Entity/SqlRunner.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="SQL Runner" begin-transaction="false"><actions><if condition="!ec.user.hasPermission('SQL_RUNNER_WEB')"><return error="true" message="User does not have permission to use the SQL Runner"/></if><if condition="!sri.getScreenUrlInfo().isPermitted(ec, null, org.moqui.context.ArtifactExecutionInfo.AUTHZA_ALL)"><return error="true" message="User must be authorized for all actions on this screen"/></if><script><![CDATA[import java.sql.Connection
            import java.sql.ResultSet
            import java.sql.SQLWarning
            import org.moqui.context.ExecutionContext

            ExecutionContext ec = context.ec

            def rs = null
            outerColumnsList = new ArrayList<ArrayList<String>>()
            outerRecordsList = new ArrayList<ArrayList<ArrayList>>()

            int limitInt = (limit?:"500") as int

            // make sure SQL comes in secure parameter (body, etc no URL)
            sql = ec.web.secureRequestParameters.get("sql")
            if (sql && groupName) {
                messageList = []
                Connection con = ec.entity.getConnection(groupName)
                try {
                    stmt = con.createStatement()

                    for(int i=0; i< 100; i++) {
                        // try get 100 ResultSets, avoid infinite loop
                        boolean isResultSet = i == 0 ? stmt.execute(sql as String) : stmt.getMoreResults()
                        // ec.logger.info("$isResultSet")

                        SQLWarning w = stmt.getWarnings()
                        for (int j = 0; j < 100 && w != null; j++) {
                            ec.logger.warn(w.getMessage() as String)
                            w = w.getNextWarning()
                        }

                        stmt.clearWarnings()

                        if (isResultSet) {
                            columns = new ArrayList<String>()
                            records = new ArrayList<ArrayList>()
                            outerColumnsList.add(columns)
                            outerRecordsList.add(records)
                            rs = stmt.getResultSet()
                            if (rs != null) {
                                rsmd = rs.getMetaData()
                                columnCount = rsmd.getColumnCount()
                                for (i = 1; i <= columnCount; i++) columns.add(rsmd.getColumnName(i))

                                limitReached = false
                                while (rs.next()) {
                                    if (limitInt > 0 && records.size() >= limitInt) {
                                        limitReached = true
                                        break
                                    }
                                    record = new ArrayList<Object>(columnCount)
                                    for (i = 1; i <= columnCount; i++) record.add(rs.getObject(i))
                                    records.add(record)
                                }
                                rs.close()

                                if (limitReached) {
                                    messageList.add(ec.resource.expand('Only showing first ${limit} rows.',''))
                                } else {
                                    messageList.add(ec.resource.expand('Showing all ${records.size()} results.',''))
                                }
                            }
                        } else if ((rowsAffected = stmt.getUpdateCount()) != -1){
                            messageList.add(ec.resource.expand('Query altered ${rowsAffected} rows.',''))
                        } else {
                            break
                        }
                    }
                } catch (Exception e) {
                    messageList.add(e.toString())
                    ec.logger.log(200, "Error running SQL query in SqlRunner", e)
                } finally {
                    if (stmt != null) { try { stmt.close() } catch (Exception e) { /* Ignore */ } }
                    if (con != null) { try { con.close() } catch (Exception e) { /* Ignore */ } }
                }
            }]]></script></actions><widgets><section-iterate name="Messages" list="messageList" entry="message"><widgets><label text="${message}" type="p" style="text-info"/></widgets></section-iterate><form-single name="SqlOptions" transition="." body-parameters="sql"><field name="groupName"><default-field><drop-down no-current-selected-key="transactional"><list-options list="ec.entity.getDatasourceGroupNames()"/></drop-down></default-field></field><field name="sql"><default-field title="SQL Statement"><text-area cols="120" rows="8"/></default-field></field><field name="limit"><default-field><text-line size="5" default-value="500"/></default-field></field><field name="submitButton"><default-field title="Run SQL"><submit/></default-field></field></form-single><label text="Query Results" type="h4"/><render-mode><text type="html,vuet,qvt"><![CDATA[<#if outerColumnsList?has_content><#list outerColumnsList as columns><#assign records = outerRecordsList[columns?index] /><div style="margin-bottom: 2em;"><h3>Result Set ${columns?index + 1}</h3><#if columns?has_content><table class="table table-striped table-hover"><tr class="header-row"><#list columns as column><td style="padding-right: 1em;">${column}</td></#list></tr><#if records?has_content><#list records as record><tr><#list record as curField><td style="padding-right: 1em;">${ec.l10n.format(curField, '')!"&nbsp;"}</td></#list></tr></#list></#if></table></#if></div></#list></#if>]]></text></render-mode></widgets></screen>
<!-- Screen Location component://tools/screen/Tools/Entity/SqlScriptRunner.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="SQL Script Runner" begin-transaction="false"><actions><if condition="!ec.user.hasPermission('SQL_RUNNER_WEB')"><return error="true" message="User does not have permission to use the SQL Runner"/></if><if condition="!sri.getScreenUrlInfo().isPermitted(ec, null, org.moqui.context.ArtifactExecutionInfo.AUTHZA_ALL)"><return error="true" message="User must be authorized for all actions on this screen"/></if><script><![CDATA[import java.sql.Connection
            import java.sql.ResultSet
            import java.sql.SQLWarning
            import org.moqui.context.ExecutionContext

            ExecutionContext ec = context.ec

            def rs = null
            int limitInt = 1

            // make sure SQL comes in secure parameter (body, etc no URL)
            String sqlScript = ec.web.secureRequestParameters.get("sql")
            if (sqlScript && groupName) {
                sqlList = sqlScript.split(';')
                messageList = []
                Connection con = ec.entity.getConnection(groupName)
                try {
                    for (sql in sqlList) {
                        try {
                            stmt = con.createStatement()

                            boolean isResultSet = stmt.execute(sql as String)

                            SQLWarning w = stmt.getWarnings()
                            for (int j = 0; j < 100 && w != null; j++) {
                                ec.logger.warn(w.getMessage() as String)
                                w = w.getNextWarning()
                            }
                            stmt.clearWarnings()

                            if (isResultSet) {
                                rs = stmt.getResultSet()
                                try {
                                    // do stuff with result set (like displaying it see SqlRunner.xml)
                                } finally {
                                    rs.close()
                                }
                            } else if ((rowsAffected = stmt.getUpdateCount()) != -1){
                                messageList.add(ec.resource.expand('Query altered ${rowsAffected} rows.',''))
                            }

                        } catch (Exception e) {
                            messageList.add(e.toString())
                            ec.logger.log(200, "Error running SQL query in SqlRunner", e)
                        } finally {
                            if (stmt != null) { try { stmt.close() } catch (Exception e) { /* Ignore */ } }
                        }
                    }
                } finally {
                    if (con != null) { try { con.close() } catch (Exception e) { /* Ignore */ } }
                }

            }]]></script></actions><widgets><form-single name="SqlOptions" transition="." body-parameters="sql"><field name="groupName"><default-field><drop-down no-current-selected-key="transactional"><list-options list="ec.entity.getDatasourceGroupNames()"/></drop-down></default-field></field><field name="sql"><default-field title="SQL Script" tooltip="Semicolon separated sql statements"><text-area cols="120" rows="40"/></default-field></field><field name="submitButton"><default-field title="Run SQL"><submit/></default-field></field></form-single><section-iterate name="Messages" list="messageList" entry="message"><widgets><label text="${message}" type="p" style="text-info"/></widgets></section-iterate></widgets></screen>
<!-- Screen Location component://tools/screen/Tools/Entity/TableStats.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Table Stats"><transition name="entityDetail"><default-response url="../DataEdit/EntityDetail"/></transition><actions><set field="orderByField" from="orderByField ?: ('empty' == viewOption ? 'tableName' : '-rowCount')"/><set field="entityListOrig" from="ec.entity.getAllEntitiesInfo(orderByField, filterRegexp, false, true)"/><set field="entityInfoList" from="[]"/><iterate list="entityListOrig" entry="entityInfo"><script><![CDATA[long rowCount = ec.entity.find(entityInfo.fullEntityName).count()
                entityInfo.put("rowCount", rowCount)
                if ('empty' == viewOption) {
                    if (rowCount == 0) entityInfoList.add(entityInfo)
                } else if ('non-empty' == viewOption) {
                    if (rowCount > 0) entityInfoList.add(entityInfo)
                } else {
                    entityInfoList.add(entityInfo)
                }]]></script></iterate><if condition="orderByField && orderByField.contains('rowCount')"><script><![CDATA[orderMapList(entityInfoList, [orderByField])]]></script></if></actions><widgets><form-single name="FilterForm" transition="."><field name="filterRegexp"><default-field><text-line/></default-field></field><field name="viewOption"><default-field title="View Option"><radio><option key="all" text="All Entities"/><option key="empty" text="Empty Tables"/><option key="non-empty" text="Non-Empty Tables"/></radio></default-field></field><field name="submitButton"><default-field title="View"><submit/></default-field></field><field-layout><field-row-big><field-ref name="filterRegexp"/><field-ref name="viewOption"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single><form-list name="EntityInfoList" list="entityInfoList" skip-form="true"><field name="fullEntityName"><header-field show-order-by="true"/><default-field><link text="${fullEntityName}" link-type="anchor" url="entityDetail" parameter-map="[selectedEntity:fullEntityName]"/></default-field></field><field name="tableName"><header-field show-order-by="true"/><default-field><display/></default-field></field><field name="rowCount"><header-field show-order-by="true"/><default-field><display/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://tools/screen/Tools/Entity.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Entity" default-menu-index="5"><subscreens default-item="DataEdit"/><widgets><subscreens-panel id="entity-panel" type="popup"/></widgets></screen>
<!-- Screen Location component://tools/screen/Tools/Service/ServiceDetail.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false"><parameter name="serviceName" required="true"/><transition name="serviceReference"><default-response url="../ServiceReference"/></transition><transition name="serviceRun"><default-response url="../ServiceRun"/></transition><actions><set field="sd" from="ec.service.getServiceDefinition(serviceName)"/><set field="serviceNode" from="sd.serviceNode"/><set field="inParameterNodes" from="serviceNode.first('in-parameters')?.children('parameter')"/><set field="outParameterNodes" from="serviceNode.first('out-parameters')?.children('parameter')"/><set field="secas" from="ec.service.secaRulesByServiceName.get(sd.serviceNameNoHash)"/></actions><widgets><container-box><box-header><label type="h5" text="${sd.serviceName}"/></box-header><box-toolbar><link url="serviceReference" text="Service List"/><link url="serviceRun" text="Run Service"/></box-toolbar><box-body><label type="strong" text="${serviceNode.first('description')?.text ?: ''}" display-if-empty="false"/><label type="p" text="Authenticate: ${sd.authenticate}"/><label type="p" text="Service Type: ${sd.serviceType}${sd.location ? ', Location: ' + sd.location : ''}${sd.method ? ', Method: ' + sd.method : ''}"/><label type="p" text="Tx Ignore: ${sd.txIgnore}, Force New: ${sd.txForceNew}, Use Tx Cache: ${sd.txUseCache}, Timeout: ${sd.txTimeout}"/></box-body></container-box><container-box><box-header><label type="h5" text="In Parameters"/></box-header><box-body-nopad><form-list name="InParameters" list="inParameterNodes" list-entry="parameterNode" skip-form="true"><row-actions><script><![CDATA[ec.context.putAll(parameterNode.attributes)]]></script></row-actions><field name="name" from="context.name"><default-field><display/></default-field></field><field name="type"><default-field><display text="${type?:'String'}"/></default-field></field><field name="required"><default-field><display text="${required?:'false'}"/></default-field></field><field name="default"><default-field><display text="${parameterNode.attribute('default') ?: ''} - ${parameterNode.attribute('default-value') ?: ''}"/></default-field></field><field name="format"><default-field><display/></default-field></field><field name="description"><default-field><display text="${parameterNode.first('description')?.text ?: ''}"/></default-field></field><field name="entityField"><default-field><display text="${parameterNode.attribute('entity-name') ?: ''}${parameterNode.attribute('field-name') ? '.' + parameterNode.attribute('field-name') : ''}"/></default-field></field></form-list></box-body-nopad></container-box><container-box><box-header><label type="h5" text="Out Parameters"/></box-header><box-body-nopad><form-list name="OutParameters" list="outParameterNodes" list-entry="parameterNode" skip-form="true"><row-actions><script><![CDATA[ec.context.putAll(parameterNode.attributes)]]></script></row-actions><field name="name" from="context.name"><default-field><display/></default-field></field><field name="type"><default-field><display text="${type?:'String'}"/></default-field></field><field name="required"><default-field><display/></default-field></field><field name="default"><default-field><display text="${parameterNode.attribute('default') ?: ''} - ${parameterNode.attribute('default-value') ?: ''}"/></default-field></field><field name="format"><default-field><display/></default-field></field><field name="description"><default-field><display text="${parameterNode.first('description')?.text ?: ''}"/></default-field></field><field name="entityField"><default-field><display text="${parameterNode.attribute('entity-name') ?: ''}${parameterNode.attribute('field-name') ? '.' + parameterNode.attribute('field-name') : ''}"/></default-field></field></form-list></box-body-nopad></container-box><section name="XmlActionDisplaySection" condition="sd.xmlAction"><widgets><label text="XML Actions" type="h3"/><container type="pre" style="line-numbers"><label text="${serviceNode.first('actions')?.toString()}" type="code" style="language-markup" encode="true"/></container><label text="Generated Groovy" type="h3"/><container type="pre" style="line-numbers"><label text="${sd.xmlAction.groovyString}" type="code" style="language-groovy" encode="true"/></container></widgets></section><section name="LocationDisplaySection" condition="sd.serviceNode.attribute('location') && sd.serviceNode.attribute('type')!='java'"><widgets><label text="Script" type="h3"/><container type="pre" style="line-numbers"><label text="${ec.resource.getLocationText(sd.serviceNode.attribute('location'), false)}" type="code" style="language-groovy" encode="true"/></container></widgets></section><label text="SECA Rules" type="h3" condition="secas"/><section-iterate name="Secas" list="secas" entry="seca"><widgets><container type="pre" style="line-numbers"><label text="${seca.toString()}" type="code" style="language-markup" encode="true"/></container></widgets></section-iterate><render-mode><text type="html,vuet,qvt"><![CDATA[<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.20.0/themes/prism-twilight.min.css" type="text/css"/><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.20.0/prism.min.js" type="text/javascript"></script>]]></text></render-mode></widgets></screen>
<!-- Screen Location component://tools/screen/Tools/Service/ServiceReference.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Service Reference" default-menu-index="1"><transition name="serviceDetail"><default-response url="../ServiceDetail"/></transition><transition name="serviceRun"><default-response url="../ServiceRun"/></transition><actions><set field="pageSize" from="pageSize ?: 40"/><set field="knownServiceNames" from="ec.service.knownServiceNames"/><set field="filteredServiceNames" from="new ArrayList(knownServiceNames)"/><script><![CDATA[if (serviceName) {
            Iterator theIterator = filteredServiceNames.iterator()
            while (theIterator.hasNext()) {
                String curSn = (String) theIterator.next()
                if (!curSn.toUpperCase().contains(serviceName.toUpperCase())) theIterator.remove()
            }
        }
        paginateList("filteredServiceNames", null, context)]]></script></actions><widgets><container-row><row-col md="6"><form-single name="SelectService" transition="serviceRun"><field name="serviceName"><default-field title="Service Name"><drop-down allow-empty="true" current="selected"><list-options list="knownServiceNames" key="${entry}"/></drop-down></default-field></field><field name="submitButton"><default-field title="Run Service"><submit/></default-field></field><field-layout><field-row-big><field-ref name="serviceName"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single></row-col><row-col md="6"><form-single name="SelectServiceInput" transition="serviceRun"><field name="serviceName"><default-field title="Service Name (path.verb#noun)"><text-line size="80"/></default-field></field><field name="submitButton"><default-field title="Run Service"><submit/></default-field></field><field-layout><field-row-big><field-ref name="serviceName"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single></row-col></container-row><form-list name="ServiceList" list="filteredServiceNames" list-entry="serviceName" skip-form="true"><field name="serviceName"><header-field><text-line size="30"/></header-field><default-field><display/></default-field></field><field name="detail"><default-field title=""><link url="serviceDetail" text="Service Detail" link-type="anchor"/></default-field></field><field name="run"><header-field title="Find"><submit/></header-field><default-field><link url="serviceRun" text="Run Service" link-type="anchor"/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://tools/screen/Tools/Service/ServiceRun.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Service Run" default-menu-index="2"><parameter name="serviceName"/><transition name="run" begin-transaction="false"><actions><script><![CDATA[org.moqui.context.ExecutionContext ec = context.ec
                serviceResults = ec.service.sync().name(serviceName).parameters(context).call()
                if (serviceResults) {
                    StringBuilder sb = new StringBuilder("Service Run Results:\n")
                    for (def resultEntry in serviceResults) sb.append("==> ${resultEntry.key}: ${resultEntry.value?.toString()}\n")
                    ec.logger.info(sb.toString())

                    // save the results to display on the screen in the next request (after the transition redirect)
                    ec.webImpl?.saveParametersToSession(serviceResults)
                }]]></script></actions><default-response url="." save-parameters="true"><parameter name="doingRun" value="Y"/></default-response></transition><actions/><widgets><form-single name="SelectServiceInput" transition="."><field name="serviceName"><default-field title="Service Name (path.verb#noun)"><text-line size="80"/></default-field></field><field name="submitButton"><default-field title="Select Service"><submit/></default-field></field><field-layout><field-row-big><field-ref name="serviceName"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single><section name="ServiceResultsSection" condition="serviceName && doingRun == 'Y'"><widgets><label text="Results for Service: ${serviceName}" type="h3"/><form-single name="ServiceResults" dynamic="true"><auto-fields-service service-name="${serviceName}" field-type="display" include="out"/><field name="serviceName"><default-field><hidden/></default-field></field></form-single></widgets></section><section name="ServiceParametersSection" condition="serviceName"><widgets><label text="Run Service: ${serviceName}" type="h3"/><form-single name="ServiceParameters" transition="run" dynamic="true"><field name="serviceName"><default-field><hidden/></default-field></field><auto-fields-service service-name="${serviceName}" include="in" field-type="edit"/><field name="submitButton"><default-field title="Run Service"><submit/></default-field></field></form-single></widgets></section></widgets></screen>
<!-- Screen Location component://tools/screen/Tools/Service/ServiceLoadRunner.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Service Load Runner" default-menu-index="3" render-modes="vue,qvue" server-static="vue,qvue"><transition name="getServerStatusMap"><actions><script><![CDATA[ec.web.sendJsonResponse(ec.factory.getStatusMap(true))]]></script></actions><default-response type="none"/></transition><transition name="getRunnerInfo" method="get" read-only="true"><actions><script><![CDATA[import org.moqui.context.ExecutionContext
            ExecutionContext ec = context.ec

            def loadRunner = ec.service.getLoadRunner()
            def serviceInfos = loadRunner.serviceInfos
            def serviceInfoList = []
            for (int i = 0; i < serviceInfos.size(); i++) {
                def serviceInfo = serviceInfos.get(i)
                def runsPerSecAvg = serviceInfo.totalTime ? serviceInfo.runCount / (serviceInfo.totalTime/1000) : 0
                def timeSinceBegin = serviceInfo.lastRunTime - serviceInfo.beginTime
                def runsPerSecTime = timeSinceBegin ? serviceInfo.runCount / (timeSinceBegin/1000) : 0

                def timeBinList = serviceInfo.timeBinList?.collect({
                    def findCountTotal = it.artifactTypeStats.entityFindOneCount + it.artifactTypeStats.entityFindListCount
                            + it.artifactTypeStats.entityFindIteratorCount + it.artifactTypeStats.entityFindCountCount
                    def findTimeTotal = it.artifactTypeStats.entityFindOneTime + it.artifactTypeStats.entityFindListTime
                            + it.artifactTypeStats.entityFindIteratorTime + it.artifactTypeStats.entityFindCountTime
                    def cudCountTotal = it.artifactTypeStats.entityCreateCount + it.artifactTypeStats.entityUpdateCount
                            + it.artifactTypeStats.entityDeleteCount
                    def cudTimeTotal = it.artifactTypeStats.entityCreateTime + it.artifactTypeStats.entityUpdateTime
                            + it.artifactTypeStats.entityDeleteTime
                    return [ runCount:it.runCount, totalTime:it.totalTime,
                            timeAverage:(it.runCount ? it.totalTime / it.runCount : 0),
                            runsPerSecAvg:(it.totalTime ? it.runCount / (it.totalTime/1000) : 0),
                            entityFindsPerSec:(findTimeTotal ? findCountTotal / (findTimeTotal/1000000000) : 0),
                            entityWritePerSec:(cudTimeTotal ? cudCountTotal / (cudTimeTotal/1000000000) : 0) ]
                })
                // remove the last time bin, is current and data can be weird until done
                if (timeBinList) timeBinList.removeLast()

                serviceInfoList.add([serviceName:serviceInfo.serviceName, parametersExpr:serviceInfo.parametersExpr,
                        targetThreads:serviceInfo.targetThreads, currentThreads:serviceInfo.currentThreads.get(),
                        runDelayMs:serviceInfo.runDelayMs, rampDelayMs:serviceInfo.rampDelayMs,
                        timeBinLength:serviceInfo.timeBinLength, timeBinsKeep:serviceInfo.timeBinsKeep,
                        runCount:serviceInfo.runCount, errorCount:serviceInfo.errorCount,
                        lastResult:serviceInfo.lastResult, beginTime:serviceInfo.beginTime,
                        lastRunTime:serviceInfo.lastRunTime, lastRunTimeStr:(new Timestamp(serviceInfo.lastRunTime).toString()),
                        totalTime:serviceInfo.totalTime, totalSquaredTime:serviceInfo.totalSquaredTime,
                        minTime:serviceInfo.minTime, maxTime:serviceInfo.maxTime,
                        timeAverage:(serviceInfo.runCount ? serviceInfo.totalTime / serviceInfo.runCount : 0),
                        timeStdDev:(serviceInfo.totalSquaredTime && serviceInfo.runCount > 1 ?
                            Math.sqrt((serviceInfo.totalSquaredTime - ((serviceInfo.totalTime*serviceInfo.totalTime) / serviceInfo.runCount)).abs() / (serviceInfo.runCount - 1)) : null),
                        runsPerSecAvg:runsPerSecAvg, runsPerSecTime:runsPerSecTime,
                        busyPercent:(runsPerSecAvg ? 100*runsPerSecTime/runsPerSecAvg : 0),
                        typeStats:objectToMap(serviceInfo.artifactTypeStats), timeBinList:timeBinList
                ])
            }

            def executorInfo = [execIndex:loadRunner.execIndex.get(), totalThreads:loadRunner.scheduledExecutor?.getQueue()?.size(),
                    activeThreads:loadRunner.scheduledExecutor?.getActiveCount(),
                    executorExists:loadRunner.scheduledExecutor as boolean,
                    running:loadRunner.scheduledExecutor && !loadRunner.scheduledExecutor.shutdown
                            && !loadRunner.scheduledExecutor.terminated && !loadRunner.scheduledExecutor.terminating,
                    shutdown:loadRunner.scheduledExecutor?.shutdown, terminated:loadRunner.scheduledExecutor?.terminated,
                    terminating:loadRunner.scheduledExecutor?.terminating]

            Map<String, Object> runnerInfo = [executorInfo:executorInfo, serviceInfos:serviceInfoList] as Map<String, Object>
            ec.web.sendJsonResponse(runnerInfo)]]></script></actions><default-response type="none"/></transition><transition name="setServiceInfo" method="post"><actions><script><![CDATA[ec.service.getLoadRunner().setServiceInfo(serviceName, parametersExpr, targetThreads as int,
                (runDelayMs as Integer) ?: 100, (runDelayVaryMs as Integer) ?: 5, (rampDelayMs as Integer) ?: 505,
                (timeBinLength as Integer) ?: 2000, (timeBinsKeep as Integer) ?: 20)]]></script></actions><default-response url="."/></transition><transition name="begin" method="post"><actions><script><![CDATA[ec.service.getLoadRunner().begin()]]></script></actions><default-response url="."/></transition><transition name="stopNow" method="post"><actions><script><![CDATA[ec.service.getLoadRunner().stopNow()]]></script></actions><default-response url="."/></transition><transition name="stopWait" method="post"><actions><script><![CDATA[ec.service.getLoadRunner().stopWait()]]></script></actions><default-response url="."/></transition><actions><if condition="!ec.user.hasPermission('SERVICE_LOAD_RUNNER')"><return error="true" message="User does not have permission to use Service LoadRunner"/></if><if condition="!sri.getScreenUrlInfo().isPermitted(ec, null, org.moqui.context.ArtifactExecutionInfo.AUTHZA_ALL)"><return error="true" message="User must be authorized for all actions on this screen"/></if></actions><widgets><render-mode><text type="qvue"><![CDATA[<template><div><q-btn dense outline no-caps color="info" type="button" label="Populate Test 1: Lookup By ID"
                       @click.prevent="setLocal('mantle.GeneralServices.lookup#ById', '[lookupId:\'100000\']', '100', '100', '10', '255', '1000', '60')"></q-btn><p><strong>All delay, run, etc times are in milliseconds (ms), rates in runs per second</strong></p><q-form @submit.prevent="setServiceInfo" autocapitalize="off" autocomplete="off"><m-text-line dense outlined v-model="newServiceInfo.serviceName" name="serviceName"
                                 stack-label label="Service Name" type="text" size="100"></m-text-line><m-text-line dense outlined v-model="newServiceInfo.parametersExpr" name="parametersExpr"
                                 stack-label label="Parameters Expression" type="text" size="100"></m-text-line><div class="row"><div class="q-px-xs col-md-2 col-sm-4"><m-text-line dense outlined v-model="newServiceInfo.targetThreads" name="targetThreads"
                                     stack-label label="Threads" type="text" size="10"></m-text-line></div><div class="q-px-xs col-md-2 col-sm-4"><m-text-line dense outlined v-model="newServiceInfo.runDelayMs" name="runDelayMs"
                                     stack-label label="Run Delay" type="text" size="10"></m-text-line><!-- due to scheduling approach this can only be done with a random wait time, increasing the
                            number of threads needed, better to hide this with a small minimal setting for some variation
                    </div><div class="q-px-xs col-md-2 col-sm-4"><m-text-line dense outlined v-model="newServiceInfo.runDelayVaryMs" name="runDelayVaryMs"
                                     stack-label label="Run Delay Vary Max" type="text" size="10"></m-text-line>
                    --></div><div class="q-px-xs col-md-2 col-sm-4"><m-text-line dense outlined v-model="newServiceInfo.rampDelayMs" name="rampDelayMs"
                                     stack-label label="Ramp Delay" type="text" size="10"></m-text-line></div><div class="q-px-xs col-md-2 col-sm-4"><m-text-line dense outlined v-model="newServiceInfo.timeBinLength" name="timeBinLength"
                                     stack-label label="Bin Length" type="text" size="10"></m-text-line></div><div class="q-px-xs col-md-2 col-sm-4"><m-text-line dense outlined v-model="newServiceInfo.timeBinsKeep" name="timeBinsKeep"
                                     stack-label label="Bins Keep" type="text" size="10"></m-text-line></div></div><q-btn dense outline no-caps color="primary" type="submit" name="submitBtn" label="Set Service Info"></q-btn></q-form><q-btn dense outline no-caps color="positive" type="button" label="Begin" @click.prevent="callBegin"
                        :disabled="executorInfo.executorExists"></q-btn><!-- this is best avoided, observed Bitronix blow up with heavy load: <q-btn dense outline no-caps color="negative" type="button" label="Stop Now" @click.prevent="callStopNow"></q-btn> --><q-btn dense outline no-caps color="negative" type="button" label="Stop Wait" @click.prevent="callStopWait"
                        :disabled="!executorInfo.running"></q-btn><div class="row"><div class="q-px-xs col-md-2 col-sm-4"><strong>Exec Index</strong> {{executorInfo.execIndex}}</div><div class="q-px-xs col-md-2 col-sm-4"><strong>Total Threads</strong> {{executorInfo.totalThreads}}</div><div class="q-px-xs col-md-2 col-sm-4"><strong>Active Threads</strong> {{executorInfo.activeThreads}}</div><div class="q-px-xs col-md-2 col-sm-4"><strong>Running</strong> {{executorInfo.running}}</div><div v-if="serverStatus.System" class="q-px-xs col-md-2 col-sm-4"><strong>CPU Load</strong> {{serverStatus.System.Load}} (avg last minute)</div><div v-if="serverStatus.System" class="q-px-xs col-md-2 col-sm-4"><strong>{{serverStatus.System.CPU}}</strong> {{serverStatus.System.Processors}} threads</div><div v-if="serverStatus.Heap" class="q-px-xs col-md-2 col-sm-4"><strong>Heap RAM</strong> {{serverStatus.Heap.Used}}/{{serverStatus.Heap.Committed}}/{{serverStatus.Heap.Max}}</div><div v-if="serverStatus.JavaStats" class="q-px-xs col-md-2 col-sm-4"><strong>Java GC</strong> {{serverStatus.JavaStats.GcCount}} GCs {{serverStatus.JavaStats.GcTimeSeconds}}s</div></div><div class="table q-table" id="service_table"><div class="thead"><div class="tr"><div class="th">Service &amp; Parameters</div><div class="th">Began</div><div class="th">Target</div><div class="th">Current</div><div class="th">Run Delay</div><div class="th">Ramp Delay</div><div class="th">Bin Length</div><div class="th">Bins Keep</div><div class="th">Run Count</div><div class="th">Error Count</div><div class="th">Time Average</div><div class="th">Std Dev</div><div class="th">Min</div><div class="th">Max</div><div class="th">Runs/Sec Avg</div><div class="th">Runs/Sec Time</div><div class="th">Busy Pct</div><div class="th">Last Run</div></div></div><div class="tbody"><div v-for="serviceInfo in serviceInfos" class="tr"><div class="td"><div>{{serviceInfo.serviceName}}</div><div>{{serviceInfo.parametersExpr}}</div></div><div class="td text-center">{{moqui.format(serviceInfo.beginTime, null, 'time')}} - {{(Date.now() - serviceInfo.beginTime)/1000}}s</div><div class="td text-center">{{serviceInfo.targetThreads}}</div><div class="td text-center">{{serviceInfo.currentThreads}}</div><div class="td text-center">{{serviceInfo.runDelayMs}}</div><div class="td text-center">{{serviceInfo.rampDelayMs}}</div><div class="td text-center">{{serviceInfo.timeBinLength}}</div><div class="td text-center">{{serviceInfo.timeBinsKeep}}</div><div class="td text-center">{{serviceInfo.runCount}}</div><div class="td text-center">{{serviceInfo.errorCount}}</div><div class="td text-center">{{moqui.format(serviceInfo.timeAverage, null, "bigdecimal")}}</div><div class="td text-center">{{moqui.format(serviceInfo.timeStdDev, null, "bigdecimal")}}</div><div class="td text-center">{{serviceInfo.minTime}}</div><div class="td text-center">{{serviceInfo.maxTime}}</div><div class="td text-center">{{moqui.format(serviceInfo.runsPerSecAvg, null, "bigdecimal")}}</div><div class="td text-center">{{moqui.format(serviceInfo.runsPerSecTime, null, "bigdecimal")}}</div><div class="td text-center">{{moqui.format(serviceInfo.busyPercent, null, "bigdecimal")}}</div><div class="td text-center">{{serviceInfo.lastRunTimeStr}}</div></div></div></div><div class="row"><div class="q-px-xs col-xl-3 col-md-6"><p><strong>Average Run Time</strong></p><m-chart height="500px" :config="timeAvgChartConfig"></m-chart></div><div class="q-px-xs col-xl-3 col-md-6"><p><strong>Runs per Second</strong></p><m-chart height="500px" :config="runsPerSecAvgChartConfig"></m-chart></div><div class="q-px-xs col-xl-3 col-md-6"><p><strong>Entity Finds per Second</strong></p><m-chart height="500px" :config="findsPerSecAvgChartConfig"></m-chart></div><div class="q-px-xs col-xl-3 col-md-6"><p><strong>Entity Writes per Second</strong></p><m-chart height="500px" :config="writesPerSecAvgChartConfig"></m-chart></div></div><div class="table q-table" id="service_detail_table"><div class="thead"><div class="tr"><div class="th">Service &amp; Parameters</div><div class="th"></div><div class="th">Entity One</div><div class="th">Entity List</div><div class="th">Entity Iterator</div><div class="th">Entity Count</div><div class="th">Entity Create</div><div class="th">Entity Update</div><div class="th">Entity Delete</div><div class="th">Service View</div><div class="th">Service Other</div></div></div><div class="tbody"><div v-for="serviceInfo in serviceInfos" class="tr"><template v-if="serviceInfo.typeStats"><div class="td"><div>{{serviceInfo.serviceName}}</div><div>{{serviceInfo.parametersExpr}}</div></div><div class="td"><div><strong>Runs</strong></div><div><strong>Average Time µs</strong></div><div><strong>Runs/Second</strong></div></div><div class="td text-center"><div>{{serviceInfo.typeStats.entityFindOneCount}}</div><div>{{safeDivide(serviceInfo.typeStats.entityFindOneTime / 1000, serviceInfo.typeStats.entityFindOneCount)}}</div><div>{{safeDivide(serviceInfo.typeStats.entityFindOneCount, serviceInfo.typeStats.entityFindOneTime / 1000000000)}}</div></div><div class="td text-center"><div>{{serviceInfo.typeStats.entityFindListCount}}</div><div>{{safeDivide(serviceInfo.typeStats.entityFindListTime / 1000, serviceInfo.typeStats.entityFindListCount)}}</div><div>{{safeDivide(serviceInfo.typeStats.entityFindListCount, serviceInfo.typeStats.entityFindListTime / 1000000000)}}</div></div><div class="td text-center"><div>{{serviceInfo.typeStats.entityFindIteratorCount}}</div><div>{{safeDivide(serviceInfo.typeStats.entityFindIteratorTime / 1000, serviceInfo.typeStats.entityFindIteratorCount)}}</div><div>{{safeDivide(serviceInfo.typeStats.entityFindIteratorCount, serviceInfo.typeStats.entityFindIteratorTime / 1000000000)}}</div></div><div class="td text-center"><div>{{serviceInfo.typeStats.entityFindCountCount}}</div><div>{{safeDivide(serviceInfo.typeStats.entityFindCountTime / 1000, serviceInfo.typeStats.entityFindCountCount)}}</div><div>{{safeDivide(serviceInfo.typeStats.entityFindCountCount, serviceInfo.typeStats.entityFindCountTime / 1000000000)}}</div></div><div class="td text-center"><div>{{serviceInfo.typeStats.entityCreateCount}}</div><div>{{safeDivide(serviceInfo.typeStats.entityCreateTime / 1000, serviceInfo.typeStats.entityCreateCount)}}</div><div>{{safeDivide(serviceInfo.typeStats.entityCreateCount, serviceInfo.typeStats.entityCreateTime / 1000000000)}}</div></div><div class="td text-center"><div>{{serviceInfo.typeStats.entityUpdateCount}}</div><div>{{safeDivide(serviceInfo.typeStats.entityUpdateTime / 1000, serviceInfo.typeStats.entityUpdateCount)}}</div><div>{{safeDivide(serviceInfo.typeStats.entityUpdateCount, serviceInfo.typeStats.entityUpdateTime / 1000000000)}}</div></div><div class="td text-center"><div>{{serviceInfo.typeStats.entityDeleteCount}}</div><div>{{safeDivide(serviceInfo.typeStats.entityDeleteTime / 1000, serviceInfo.typeStats.entityDeleteCount)}}</div><div>{{safeDivide(serviceInfo.typeStats.entityDeleteCount, serviceInfo.typeStats.entityDeleteTime / 1000000000)}}</div></div><div class="td text-center"><div>{{serviceInfo.typeStats.serviceViewCount}}</div><div>{{safeDivide(serviceInfo.typeStats.serviceViewTime / 1000, serviceInfo.typeStats.serviceViewCount)}}</div><div>{{safeDivide(serviceInfo.typeStats.serviceViewCount, serviceInfo.typeStats.serviceViewTime / 1000000000)}}</div></div><div class="td text-center"><div>{{serviceInfo.typeStats.serviceOtherCount}}</div><div>{{safeDivide(serviceInfo.typeStats.serviceOtherTime / 1000, serviceInfo.typeStats.serviceOtherCount)}}</div><div>{{safeDivide(serviceInfo.typeStats.serviceOtherCount, serviceInfo.typeStats.serviceOtherTime / 1000000000)}}</div></div></template></div></div></div><div v-for="serviceInfo in serviceInfos"><!-- <pre>{{JSON.stringify(serviceInfo.timeBinList, null, 2)}}</pre> --><pre>{{JSON.stringify(serviceInfo.lastResult, null, 2)}}</pre></div></div></template><script>
                module.exports = {
                    data: function() { return {
                        // NOTE: regardless of defaults elsewhere these are the ones that show on the screen
                        newServiceInfo:{ serviceName:"", parametersExpr:"", targetThreads:"10",
                            runDelayMs:"100", runDelayVaryMs:"5", rampDelayMs:"505", timeBinLength:"2000", timeBinsKeep:"20" },
                        serverStatus:{}, executorInfo:{running:false}, serviceInfos:[],
                        getInfoInterval:null, serverStatusInterval:null,
                        timeAvgChartConfig:{type:'line', data:{ labels:[], datasets:[] }},
                        runsPerSecAvgChartConfig:{type:'line', data:{ labels:[], datasets:[] }},
                        findsPerSecAvgChartConfig:{type:'line', data:{ labels:[], datasets:[] }},
                        writesPerSecAvgChartConfig:{type:'line', data:{ labels:[], datasets:[] }}
                    } },
                    methods: {
                        setLocal: function(serviceName, parametersExpr, targetThreads, runDelayMs, runDelayVaryMs,
                                rampDelayMs, timeBinLength, timeBinsKeep) {
                            if (serviceName) this.newServiceInfo.serviceName = serviceName;
                            if (parametersExpr) this.newServiceInfo.parametersExpr = parametersExpr;
                            if (targetThreads) this.newServiceInfo.targetThreads = targetThreads;
                            if (runDelayMs) this.newServiceInfo.runDelayMs = runDelayMs;
                            if (runDelayVaryMs) this.newServiceInfo.runDelayVaryMs = runDelayVaryMs;
                            if (rampDelayMs) this.newServiceInfo.rampDelayMs = rampDelayMs;
                            if (timeBinLength) this.newServiceInfo.timeBinLength = timeBinLength;
                            if (timeBinsKeep) this.newServiceInfo.timeBinsKeep = timeBinsKeep;
                        },
                        setServiceInfo: function() {
                            var vm = this;
                            $.ajax({ type:"POST", url:"/apps/tools/Service/ServiceLoadRunner/setServiceInfo",
                                data:this.newServiceInfo, dataType:"json",
                                headers:{ Accept:'application/json', 'X-CSRF-Token':this.$root.moquiSessionToken },
                                error:moqui.handleAjaxError,
                                success: function(responseObj, status, jqXHR) {
                                    vm.getRunnerInfo();
                                }
                            });
                        },
                        getRunnerInfo: function() {
                            var vm = this;
                            $.ajax({ type:"GET", url:"/apps/tools/Service/ServiceLoadRunner/getRunnerInfo",
                                dataType:"json", headers:{ Accept:'application/json' },
                                error:moqui.handleAjaxError,
                                success: function(responseObj, status, jqXHR) {
                                    // update display objects
                                    vm.executorInfo = responseObj.executorInfo
                                    vm.serviceInfos = responseObj.serviceInfos;
                                    // update charts
                                    vm.updateChartData();
                                    // if no local serviceName or parametersExpr set from server data to populate form
                                    if (vm.serviceInfos && vm.serviceInfos.length) {
                                        var serviceInfo = vm.serviceInfos[0];
                                        if (!vm.newServiceInfo.serviceName || !vm.newServiceInfo.serviceName.length)
                                            vm.newServiceInfo.serviceName = serviceInfo.serviceName || ""
                                        if (!vm.newServiceInfo.parametersExpr || !vm.newServiceInfo.parametersExpr.length)
                                            vm.newServiceInfo.parametersExpr = serviceInfo.parametersExpr || ""
                                    }
                                }
                            });
                            // TODO timeout after last nav and clear the interval?
                        },
                        getServerStatusMap: function() {
                            var vm = this;
                            $.ajax({ type:"GET", url:"/apps/tools/Service/ServiceLoadRunner/getServerStatusMap",
                                dataType:"json", headers:{ Accept:'application/json' },
                                error:moqui.handleAjaxError,
                                success: function(responseObj, status, jqXHR) {
                                    vm.serverStatus = responseObj;
                                }
                            });
                            // TODO timeout after last nav and clear the interval?
                        },
                        callBegin: function() {
                            $.ajax({ type:"POST", url:"/apps/tools/Service/ServiceLoadRunner/begin",
                                dataType:"json", headers:{ Accept:'application/json', 'X-CSRF-Token':this.$root.moquiSessionToken },
                                error:moqui.handleAjaxError, success: function(responseObj, status, jqXHR) { }});
                        },
                        callStopNow: function() {
                            $.ajax({ type:"POST", url:"/apps/tools/Service/ServiceLoadRunner/stopNow",
                                dataType:"json", headers:{ Accept:'application/json', 'X-CSRF-Token':this.$root.moquiSessionToken },
                                error:moqui.handleAjaxError, success: function(responseObj, status, jqXHR) { }});
                        },
                        callStopWait: function() {
                            $.ajax({ type:"POST", url:"/apps/tools/Service/ServiceLoadRunner/stopWait",
                                dataType:"json", headers:{ Accept:'application/json', 'X-CSRF-Token':this.$root.moquiSessionToken },
                                error:moqui.handleAjaxError, success: function(responseObj, status, jqXHR) { }});
                        },
                        safeDivide: function(over, under, nostring) {
                            if (!under) return 0;
                            if (nostring) return over / under;
                            else return moqui.format(over / under, null, "bigdecimal");
                        },
                        populateChartData: function(fieldName, serviceName, timeBinList, datasetsArray) {
                            // NOTE: change moving average lengths here; consider making these user settable
                            var ma1Length = 7, ma2Length = 20;

                            var dataArray = [], ma1DataArray = [], ma2DataArray = [];
                            var ma1Cur = 0, ma2Cur = 0;
                            for (var tbi = 0; timeBinList && tbi < timeBinList.length; tbi++) {
                                var timeBin = timeBinList[tbi];
                                dataArray.push(timeBin[fieldName]);
                                // for rolling moving average always add current
                                ma1Cur += timeBin[fieldName];
                                ma2Cur += timeBin[fieldName];
                                // for rolling moving average if more than ma periods subtract off the next one to drop
                                if (tbi >= ma1Length) ma1Cur -= timeBinList[tbi - ma1Length][fieldName];
                                if (tbi >= ma2Length) ma2Cur -= timeBinList[tbi - ma2Length][fieldName];
                                ma1DataArray.push(ma1Cur / (tbi < ma1Length ? tbi+1 : ma1Length));
                                ma2DataArray.push(ma2Cur / (tbi < ma2Length ? tbi+1 : ma2Length));
                            }
                            datasetsArray.push({
                                backgroundColor:'rgba(49, 112, 143, 0.9)', borderColor:'rgba(49, 112, 143, 0.9)',
                                label:serviceName, type:'line', fill:false, data:dataArray
                            });
                            datasetsArray.push({
                                backgroundColor:'rgba(100, 112, 70, 0.9)', borderColor:'rgba(100, 112, 70, 0.9)',
                                label:serviceName + ' MA' + ma1Length, type:'line', fill:false, data:ma1DataArray
                            });
                            datasetsArray.push({
                                backgroundColor:'rgba(100, 60, 143, 0.9)', borderColor:'rgba(100, 60, 143, 0.9)',
                                label:serviceName + ' MA' + ma2Length, type:'line', fill:false, data:ma2DataArray
                            });
                        },
                        updateChartData: function() {
                            if (!this.serviceInfos || !this.serviceInfos.length) return;

                            var labelArray = [];
                            this.serviceInfos[0].timeBinList.forEach(function (it) {
                                labelArray.push(moqui.format(it.beginTime, null, 'time')); });

                            var timeDatasetsArray = [];
                            var rpsDatasetsArray = [];
                            var efpsDatasetsArray = [];
                            var ewpsDatasetsArray = [];
                            var vm = this;
                            this.serviceInfos.forEach(function (it) {
                                vm.populateChartData("timeAverage", it.serviceName, it.timeBinList, timeDatasetsArray);
                                vm.populateChartData("runsPerSecAvg", it.serviceName, it.timeBinList, rpsDatasetsArray);
                                vm.populateChartData("entityFindsPerSec", it.serviceName, it.timeBinList, efpsDatasetsArray);
                                vm.populateChartData("entityWritePerSec", it.serviceName, it.timeBinList, ewpsDatasetsArray);
                            })
                            this.timeAvgChartConfig = {
                                type:'line', data:{ labels:labelArray, datasets:timeDatasetsArray },
                                options:{ legend:{display:false}, scales:{ xAxes:[{display:true}] },
                                    maintainAspectRatio:false, animation:false }
                            };
                            this.runsPerSecAvgChartConfig = {
                                type:'line', data:{ labels:labelArray, datasets:rpsDatasetsArray },
                                options:{ legend:{display:false}, scales:{ xAxes:[{display:true}] },
                                    maintainAspectRatio:false, animation:false }
                            };
                            this.findsPerSecAvgChartConfig = {
                                type:'line', data:{ labels:labelArray, datasets:efpsDatasetsArray },
                                options:{ legend:{display:false}, scales:{ xAxes:[{display:true}] },
                                    maintainAspectRatio:false, animation:false }
                            };
                            this.writesPerSecAvgChartConfig = {
                                type:'line', data:{ labels:labelArray, datasets:ewpsDatasetsArray },
                                options:{ legend:{display:false}, scales:{ xAxes:[{display:true}] },
                                    maintainAspectRatio:false, animation:false }
                            };
                        }
                    },
                    mounted: function() {
                        // get info right away
                        this.getRunnerInfo();
                        // kick off the runner info poller
                        this.getInfoInterval = setInterval(this.getRunnerInfo, 2*1000)
                        // start the server status poller
                        this.serverStatusInterval = setInterval(this.getServerStatusMap, 2*1000)
                    },
                    beforeDestroy: function() {
                        if (this.getInfoInterval) {
                            clearInterval(this.getInfoInterval);
                            this.getInfoInterval = null;
                        }
                        if (this.serverStatusInterval) {
                            clearInterval(this.serverStatusInterval);
                            this.serverStatusInterval = null;
                        }
                    }
                }
            </script>]]></text><text type="html,vuet"><![CDATA[<p><strong>Only supported in the 'qvt' render mode, go to the same URL under /qapps (instead of /apps or /vapps)</strong></p>]]></text></render-mode></widgets></screen>
<!-- Screen Location component://tools/screen/Tools/Service.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Service" default-menu-index="6"><subscreens default-item="ServiceReference"/><widgets><subscreens-panel id="service-panel" type="popup"/></widgets></screen>
<!-- Screen Location component://tools/screen/Tools.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" include-child-content="true" menu-image="fa fa-wrench" menu-image-type="icon"><subscreens default-item="dashboard"/><widgets><subscreens-panel id="tools-app" type="popup"/></widgets></screen>
<!-- Screen Location component://webroot/screen/webroot/apps.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="false" screen-theme-type-enum-id="STT_INTERNAL" default-menu-title="Applications"><transition name="ScreenTree"><default-response url="../ScreenTree"/></transition><transition name="setPreference"><parameter name="preferenceKey"/><parameter name="preferenceValue"/><actions><script><![CDATA[ec.user.setPreference(preferenceKey, preferenceValue)]]></script></actions><default-response type="none"/></transition><transition name="setPrefGoLast" read-only="true"><parameter name="preferenceKey"/><parameter name="preferenceValue"/><actions><script><![CDATA[ec.user.setPreference(preferenceKey, preferenceValue)]]></script></actions><default-response type="screen-last"/></transition><transition name="getPreferences" read-only="true"><parameter name="keyRegexp"/><actions><script><![CDATA[ec.web.sendJsonResponse(ec.user.getPreferences(keyRegexp))]]></script></actions><default-response type="none"/></transition><transition name="qzSign" read-only="true"><parameter name="message"/><actions><script><![CDATA[ec.web.sendQzSignedResponse(message)]]></script></actions><default-response type="none"/></transition><subscreens default-item="AppList"/><pre-actions><script><![CDATA[// jQuery, Bootstrap, Twitter TypeAhead, Form Validation (jquery-validate), Date/Time (Moment, bootstrap-datetimepicker),
        //      Drop-down (Select2, Selectivity), Notify/Growl (Bootstrap Notify), Inline Editable, Sortable Hierarchical List
        // Moqui Library (3rd party lib workarounds, NotificationClient, etc)
        html_scripts.add('/js/CombinedBase.min.js')

        // Form AJAX (jquery-form)
        html_scripts.add('/libs/jquery.form/jquery.form.min.js')
        // Tree (JSTree)
        html_scripts.add('/libs/jstree/jstree.min.js')

        // jquery-validate locale specific scripts
        Map validateScriptsOut = ec.service.sync().name("webroot.LocaleServices.get#ValidateLocaleScripts").call()
        if (validateScriptsOut.messagesLocation) html_scripts.add(validateScriptsOut.messagesLocation)
        if (validateScriptsOut.methodsLocation) html_scripts.add(validateScriptsOut.methodsLocation)]]></script></pre-actions><widgets><render-mode><text type="html"><![CDATA[<script>var notificationClient = new moqui.NotificationClient((location.protocol === 'https:' ? 'wss' : 'ws') + "://${ec.web.getHostName(true)}${ec.web.servletContext.contextPath}/notws");</script>]]></text></render-mode><section name="TopNavSection" condition="hideNav != 'true'"><widgets><container id="top"><render-mode><text type="html" location="component://webroot/screen/includes/navbar.html.ftl"/></render-mode><subscreens-menu type="popup" id="header-menu" title="Application"/></container></widgets></section><container id="content"><container style="inner"><container style="container-fluid"><section name="MessagesSection"><widgets><section-iterate name="headerMessageInfos" list="ec.message.messageInfos" entry="messageInfo"><widgets><render-mode><text type="html"><![CDATA[<div class="alert alert-${messageInfo.typeString} fade in" role="alert"><button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>]]></text></render-mode><label text="${messageInfo.message}" type="h4"/><render-mode><text type="html"><![CDATA[</div>]]></text></render-mode></widgets></section-iterate><section-iterate name="headerErrors" list="ec.message.errors" entry="errorMessage"><widgets><render-mode><text type="html"><![CDATA[<div class="alert alert-danger fade in" role="alert"><button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>]]></text></render-mode><label text="${errorMessage}" type="h4"/><render-mode><text type="html"><![CDATA[</div>]]></text></render-mode></widgets></section-iterate><section-iterate name="headerValidationErrors" list="ec.message.validationErrors" entry="validationError"><widgets><render-mode><text type="html"><![CDATA[<div class="alert alert-danger fade in" role="alert"><button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>]]></text></render-mode><label text="${validationError.message} (for field ${validationError.fieldPretty})" type="h4"/><render-mode><text type="html"><![CDATA[</div>]]></text></render-mode></widgets></section-iterate><section-iterate name="headerSavedMessages" list="ec.web?.savedMessages" entry="messageInfo"><widgets><render-mode><text type="html"><![CDATA[<div class="alert alert-${messageInfo.typeString} fade in" role="alert"><button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>]]></text></render-mode><label text="${messageInfo.message}" type="h4"/><render-mode><text type="html"><![CDATA[</div>]]></text></render-mode></widgets></section-iterate><section-iterate name="headerSavedErrors" list="ec.web?.savedErrors" entry="errorMessage"><widgets><render-mode><text type="html"><![CDATA[<div class="alert alert-danger fade in" role="alert"><button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>]]></text></render-mode><label text="${errorMessage}" type="h4"/><render-mode><text type="html"><![CDATA[</div>]]></text></render-mode></widgets></section-iterate><section-iterate name="headerSavedValidationErrors" list="ec.web?.savedValidationErrors" entry="validationError"><widgets><render-mode><text type="html"><![CDATA[<div class="alert alert-danger fade in" role="alert"><button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>]]></text></render-mode><label text="${validationError.message} (for field ${validationError.fieldPretty})" type="h4"/><render-mode><text type="html"><![CDATA[</div>]]></text></render-mode></widgets></section-iterate></widgets></section><subscreens-active/></container></container></container><section name="BottomNavSection" condition="hideNav != 'true'"><widgets><container id="footer" style="bg-dark"><render-mode><text type="html"><![CDATA[<#assign footerItemList = sri.getThemeValues("STRT_FOOTER_ITEM")><div id="apps-footer-content"><#list footerItemList! as footerItem><#assign footerItemTemplate = footerItem?interpret><@footerItemTemplate/></#list></div>]]></text></render-mode></container></widgets></section></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy-com/c/Article.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Article" require-authentication="anonymous-view"><parameter name="wikiBlogId" required="true"/><always-actions><set field="blogArticleExists" from="false"/><entity-find entity-name="moqui.resource.wiki.WikiBlogFindView" list="blogList"><econdition field-name="wikiBlogId"/><econdition field-name="wikiPageCategoryId" value="Newsletter"/><econdition field-name="publishedVersionName" operator="is-not-null"/></entity-find><set field="blog" from="blogList.getFirst()"/><if condition="blog"><set field="blogArticleExists" from="true"/></if></always-actions><transition name="signup"><service-call name="coarchy.CoarchyServices.signup#Newsletter" in-map="[emailAddress:emailAddress]" out-map="context" multi="parameter"/><default-response save-parameters="true"/></transition><pre-actions><set field="blog.publishDate" from="blog?.publishDate?ec.l10n.format(blog.publishDate, 'MMM dd, yyyy'):null"/><set field="baseLinkUrl" from="!'production'.equals(System.getProperty('instance_purpose')) ? 'http://localhost:8080' : 'https://coarchy.com'"/><set field="imageUrl" from="baseLinkUrl+'/content/downloadSmallImage?wikiBlogId='+blog.wikiBlogId"/><entity-find-one entity-name="moqui.resource.wiki.WikiSpace" value-field="wikiSpace"><field-map field-name="wikiSpaceId" from="blog.wikiSpaceId"/></entity-find-one><set field="rootPageRef" from="ec.resource.getLocationReference(wikiSpace.rootPageLocation)"/><set field="pageReference" from="rootPageRef.findChildFile(blog.pagePath)"/><set field="pageText" from="pageReference.getText(blog.publishedVersionName)"/><set field="html_keywords" from="blog?.metaKeywords?:html_keywords"/><set field="html_description" from="blog?.metaDescription?:html_description"/><set field="html_title" from="blog?.title?:'Coarchy Blog'"/><set field="html_image" from="imageUrl"/><set field="html_url" from="baseLinkUrl+'/Article?wikiBlogId='+blog.wikiBlogId"/><set field="html_type" value="article"/><set field="html_site_name" value="Coarchy"/></pre-actions><widgets><render-mode><text type="html"><![CDATA[<div class="row"><div class="col-lg-6 offset-lg-3 col-md-8 offset-md-2 col-sm-10 offset-sm-1 col-xs-12 offset-xs-0"><div class="column justify-center"><div class="col-4"><q-card flat bordered style="width: 100%;" class="col-4 q-ma-xs bg-grey-1" data-aos="fade-in" data-aos-easing="ease-in-out-cubic"><div v-if="${blogArticleExists?string('true','false')}"><q-card-section><h1 class="text-h2">${blog.title!}</h1></q-card-section><q-card-section><div class="text-h6">${blog.summary!}</div></q-card-section><q-card-section><div class="q-pa-md row justify-center"><q-img src="${imageUrl!}" :ratio="16/9"/></div><div class="text-subtitle2">By ${blog.author!}</div><div class="text-subtitle2">Published ${blog.publishDate!}</div></q-card-section><q-card-section><div class="text-body1">${pageText!}</div></q-card-section></div><div v-else><q-card-section><div class="text-h2">No Article Found</div></q-card-section></div><q-separator class="q-mt-md" inset></q-separator><div class="flex flex-center justify-center items-center text-h4 q-mt-md">Sign up for our Newsletter</div><div class="flex flex-center justify-center items-center text-h6 q-mt-xs">Learn about requirements and get product updates</div><div class="flex flex-center justify-center items-center q-mt-lg q-mb-md"><c-newsletter-signup></c-newsletter-signup></div></q-card></div></div></div></div>]]></text></render-mode></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy-com/c/ChangePassword.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" require-authentication="anonymous-all" history="false"><transition name="changePassword"><service-call name="coarchy.CoarchyServices.change#UserPassword" in-map="context" out-map="context" multi="parameter"/><default-response url="/settings"/><error-response url="." save-parameters="true"/></transition><transition name="completeSignup"><service-call name="coarchy.CoarchyServices.complete#UserSignup" in-map="context" out-map="context" multi="parameter"/><default-response url="/settings"/><error-response url="." save-parameters="true"/></transition><pre-actions><script><![CDATA[// if user already logged in redirect to application
        if (ec.user.userId) sri.sendRedirectAndStopRender('/settings')]]></script></pre-actions><widgets><render-mode><text type="html"><![CDATA[<div class="row"><div class="col-md-4 offset-md-4 col-xs-12 offset-xs-0"><div class="column justify-center" style="height: 150px"><div class="col-4"><q-card flat bordered style="width: 100%;" class="col-4 bg-grey-1"><q-card-section><div class="text-h2">Change Password</div></q-card-section><q-card-section><c-change-password></c-change-password></q-card-section></q-card></div></div></div></div>]]></text></render-mode></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy-com/c/Services.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="false" allow-extra-path="true" default-menu-title="Coarchy Services"><pre-actions><set field="baseLinkUrl" from="!'production'.equals(System.getProperty('instance_purpose')) ? 'http://localhost:8080' : 'https://coarchy.com'"/><set field="imageUrl" value="/cstatic/background.jpg"/><set field="html_keywords" value="coarchy services"/><set field="html_title" value="Coarchy Services: Checkout all of our service offerings"/><set field="html_description" value="Coarchy offers training, personalized coaching, monthly support contracts, and business analyst consulting to guide development in documenting your organization"/><set field="html_image" from="baseLinkUrl + imageUrl"/><set field="html_url" from="baseLinkUrl+'/Newsletter'"/><set field="html_type" value="website"/><set field="html_site_name" value="Coarchy"/></pre-actions><widgets><render-mode><text type="html"><![CDATA[<div class="row"><div class="col-lg-6 offset-lg-3 col-md-8 offset-md-2 col-sm-10 offset-sm-1 col-xs-12 offset-xs-0"><div class="column justify-center"><div class="col-4"><h1 class="text-h2">Coarchy Services</h1><q-card flat bordered class="q-mb-md"><q-card-section><div class="text-h4">Introduction to Software and Concepts Training</div><div class="text-subtitle2">Train your team on the general concepts and overview of Coarchy in 2 hours.</div></q-card-section><q-card-section>
                                        - $200 total for 2 Hours
                                        <br/>- Meet Virtually over Google Meet
                                        <br/>- Go over each feature
                                        <br/>- Generic demo data
                                    </q-card-section><q-btn no-caps href="mailto:sales@coarchy.com?subject=Introduction to Coarchy Software and Concepts Training" label="Contact Sales" push color="primary" class="q-ma-sm" size="md"/></q-card><!-- Personalized Training Section --><q-card flat bordered class="q-mb-md"><q-card-section><div class="text-h4">Personalized Training</div><div class="text-subtitle2">Train your team on how to gather requirements, and when to use Process Stories and Statements.</div></q-card-section><q-card-section>
                                        - $600 total for 4 Hours
                                        <br/>- Meet Virtually over Google Meet
                                        <br/>- Interactive Training
                                        <br/>- Personalized High Level Process Creation
                                    </q-card-section><q-btn no-caps href="mailto:sales@coarchy.com?subject=Coarchy Personalized Training" label="Contact Sales" push color="primary" class="q-ma-sm" size="md"/></q-card><!-- Support Monthly Contract Section --><q-card flat bordered class="q-mb-md"><q-card-section><div class="text-h4">Support Monthly Contract</div><div class="text-subtitle2">Comprehensive support package to ensure you are using Coarchy to its fullest potential.</div></q-card-section><q-card-section>
                                        - $750/month
                                        <br/>Includes:
                                        <br/>    - Priority email support
                                        <br/>    - Weekly 1 Hour Meeting
                                        <br/>       - Process story review and feedback
                                        <br/>       - Statements improvement
                                        <br/>       - Resolve issues
                                    </q-card-section><q-btn no-caps href="mailto:sales@coarchy.com?subject=Coarchy Support Monthly Contract" label="Contact Sales" push color="primary" class="q-ma-sm" size="md"/></q-card><!-- Business Analyst Consulting Section --><q-card flat bordered class="q-mb-md"><q-card-section><div class="text-h4">Business Analyst Consulting</div><div class="text-subtitle2">Get a pair of expert Business Analysts to help you with your process documentation.</div></q-card-section><q-card-section>
                                        - $250/hour for 1 senior analyst and 1 analyst
                                        <br/>- Minimum 10 hours
                                    </q-card-section><q-btn no-caps href="mailto:sales@coarchy.com?subject=Coarchy Business Analyst Consulting" label="Contact Sales" push color="primary" class="q-ma-sm" size="md"/></q-card></div></div></div></div>]]></text></render-mode></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy-com/c/Templates.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="false" allow-extra-path="true" default-menu-title="Coarchy Templates"><pre-actions><set field="baseLinkUrl" from="!'production'.equals(System.getProperty('instance_purpose')) ? 'http://localhost:8080' : 'https://coarchy.com'"/><set field="imageUrl" value="/cstatic/background.jpg"/><set field="html_keywords" value="coarchy services"/><set field="html_title" value="Coarchy Templates: Quickstart documenting your organization"/><set field="html_description" value="Each template is an example an Organization with Actors, Process Stories, Statements, and Products. The template is a jumpstart to document your processes."/><set field="html_image" from="baseLinkUrl + imageUrl"/><set field="html_url" from="baseLinkUrl+'/Templates'"/><set field="html_type" value="website"/><set field="html_site_name" value="Coarchy"/></pre-actions><actions><set field="templateOrgList" from="[]"/><script><![CDATA[publicOrgList = ec.entity.find('mantle.party.PartyDetail').condition('visibilityEnumId', 'PvPublic').selectField('partyId,visibilityEnumId,organizationName').orderBy('-organizationName').disableAuthz().list();
                for (Integer i = 0; i < publicOrgList.size(); i++) {
                    EntityValue publicOrg = publicOrgList.get(i);
                    
                    originStoryList = ec.entity.find('mantle.party.PartyContent').condition('partyId', publicOrg['partyId']).condition('partyContentTypeEnumId','PcntOriginStory').selectField('description').orderBy('-contentDate').disableAuthz().limit(1).list();
                    missionList = ec.entity.find('mantle.party.PartyContent').condition('partyId', publicOrg['partyId']).condition('partyContentTypeEnumId','PcntMission').selectField('description').orderBy('-contentDate').disableAuthz().limit(1).list();
                    visionList = ec.entity.find('mantle.party.PartyContent').condition('partyId', publicOrg['partyId']).condition('partyContentTypeEnumId','PcntVision').selectField('description').orderBy('-contentDate').disableAuthz().limit(1).list();
                    
                    templateOrgList.add([
                        partyId: publicOrg['partyId'],
                        organizationName: publicOrg['organizationName'],
                        originStory: originStoryList.size() > 0 ? originStoryList?.get(0)['description']?:'' : '',
                        mission: missionList.size() > 0 ? missionList?.get(0)['description']?:'' : '',
                        vision: visionList.size() > 0 ? visionList?.get(0)['description']?:'' : ''
                    ]);
                }]]></script></actions><widgets><render-mode><text type="html,vuet,qvt"><![CDATA[<div class="row"><div class="col-lg-6 offset-lg-3 col-md-8 offset-md-2 col-sm-10 offset-sm-1 col-xs-12 offset-xs-0"><div class="column justify-center"><div class="col-12"><h1 class="text-h2">Coarchy Templates</h1><p class="text-subtitle1">Each template is an example an Organization with Actors, Process Stories, Statements, and Products. The template is a jumpstart to document your processes so that your organization can become more of what you want your organization to be; whether that's consistency, resilient, or other values you may have.</p></div><div class="row"><div class="col-12 q-pa-sm" v-for="publicOrg in ${Static["org.moqui.util.WebUtilities"].encodeHtmlJsSafeCollection(templateOrgList)}" :key="publicOrg.partyId"><q-card flat bordered><q-card-section class="text-grey-8 q-py-xs"><div class="text-h4 text-black">{{publicOrg.organizationName}}</div><q-icon class="q-mr-sm" name="auto_stories"></q-icon><span class="text-bold">
                                                Description
                                            </span><div class="text-bold text-black">
                                                {{publicOrg.mission}}
                                            </div></q-card-section><q-card-section class="text-grey-8 q-py-xs" v-if="publicOrg.originStory"><q-icon class="q-mr-sm" name="track_changes"></q-icon><span class="text-bold">
                                                Origin Story
                                            </span><div class="text-black">
                                                {{publicOrg.originStory}}
                                            </div></q-card-section><q-card-section class="text-grey-8 q-py-xs" v-if="publicOrg.vision"><q-icon class="q-mr-sm" name="visibility"></q-icon><span class="text-bold">
                                                Vision
                                            </span><div class="text-black">
                                                {{publicOrg.vision}}
                                            </div></q-card-section><q-separator inset class="q-mt-sm"></q-separator><q-card-actions class="row justify-end q-my-xs"><q-btn no-caps :href="'/Template?templateOrgId='+publicOrg.partyId" label="See what's included" push color="secondary" class="q-ma-xs" size="md"></q-btn><#if ec.user.userId??><c-create-org-from-template :template-org-id="publicOrg.partyId"></c-create-org-from-template><#else><q-btn no-caps :href="'/SignUp?templateOrgId='+publicOrg.partyId" label="Use Template" push color="primary" class="q-ml-xs" size="md"></q-btn></#if></q-card-actions></q-card></div></div></div></div></div>]]></text></render-mode></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy-com/c/Template.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="false" allow-extra-path="true" default-menu-title="Coarchy Templates"><parameter name="templateOrgId"/><always-actions><script><![CDATA[organization = ec.entity.find('mantle.party.PartyDetail').condition('partyId', templateOrgId).disableAuthz().one();
                if (organization?.visibilityEnumId != 'PvPublic'){                
                    sri.sendRedirectAndStopRender('/Templates')
                }

                // Query this here so we use it in html_description 
                originStoryList = ec.entity.find('mantle.party.PartyContent').condition('partyId', templateOrgId).condition('partyContentTypeEnumId','PcntOriginStory').selectField('description').orderBy('-contentDate').limit(1).disableAuthz().list();
                originStory = originStoryList.size() > 0 ? originStoryList?.get(0)['description']?:'' : '';]]></script></always-actions><pre-actions><script><![CDATA[import org.moqui.entity.EntityCondition

            def condFactory = ec.entity.getConditionFactory()

            // Get Value Statements
            valueStatementList = ec.entity.find('coarchy.ValueStatementAndType').condition(condFactory.makeCondition('disabled', EntityCondition.EQUALS, 'N', true)).condition('organizationId', templateOrgId).condition('replacedByValueStatementId',null).selectField('valueStatementId,value,typeEnumId,sequenceNum,typeDescription').orderBy('sequenceNum').disableAuthz().list();

            // Get actors
            actorList = ec.entity.find('coarchy.Actor').condition('organizationId', templateOrgId).selectField('actorId,name,description').orderBy('name').disableAuthz().list();

            // Get Process Stories
            processStoryList = ec.entity.find('coarchy.ProcessStoryActivityAndDetail').condition(condFactory.makeCondition('disabled', EntityCondition.EQUALS, 'N', true)).condition('organizationId', templateOrgId).selectField('processStoryId,detailProcessStoryId,detail2ProcessStoryId,detail3ProcessStoryId,name,detailName,detail2Name,detail3Name').distinct(true).disableAuthz().list();

            // Get Origin story, mission and vision
            originStoryList = ec.entity.find('mantle.party.PartyContent').condition('partyId', templateOrgId).condition('partyContentTypeEnumId','PcntOriginStory').selectField('description').orderBy('-contentDate').limit(1).disableAuthz().list();
            missionList = ec.entity.find('mantle.party.PartyContent').condition('partyId', templateOrgId).condition('partyContentTypeEnumId','PcntMission').selectField('description').orderBy('-contentDate').limit(1).disableAuthz().list();
            visionList = ec.entity.find('mantle.party.PartyContent').condition('partyId', templateOrgId).condition('partyContentTypeEnumId','PcntVision').selectField('description').orderBy('-contentDate').limit(1).disableAuthz().list();

            // Get product list
            productList = ec.entity.find('mantle.product.Product').condition('ownerPartyId', templateOrgId).condition('hidden',EntityCondition.ComparisonOperator.NOT_EQUAL,'Y').condition('productClassEnumId','PclsCoarchy').selectField('productId,productName').orderBy('productName').disableAuthz().list();]]></script><set field="originStory" from="originStoryList.size() > 0 ? originStoryList?.get(0)['description']?:'' : ''"/><set field="mission" from="missionList.size() > 0 ? missionList?.get(0)['description']?:'' : ''"/><set field="vision" from="visionList.size() > 0 ? visionList?.get(0)['description']?:'' : ''"/><set field="showSubstoriesActual" from="true"/><set field="activitiesByStoryMap" from="[:]"/><iterate list="processStoryList" entry="processStory"><service-call name="coarchy.CoarchyServices.find#ProcessStoryActivityList" in-map="[processStoryId:processStory.processStoryId,showSubstories:'Y',organizationId:templateOrgId]" out-map="storyActivityOut" out-map-add-to-existing="false"/><script><![CDATA[activitiesByStoryMap.put(processStory.processStoryId, storyActivityOut.processStoryActivityList?:[])]]></script></iterate><set field="baseLinkUrl" from="!'production'.equals(System.getProperty('instance_purpose')) ? 'http://localhost:8080' : 'https://coarchy.com'"/><set field="imageUrl" value="/cstatic/background.jpg"/><set field="html_keywords" value="coarchy services"/><set field="html_title" value="Template for ${organization.organizationName} to get a Headstart on Documentation!"/><set field="html_description" value="${mission}"/><set field="html_image" from="baseLinkUrl + imageUrl"/><set field="html_url" from="baseLinkUrl+'/Template?templateOrgId='+templateOrgId"/><set field="html_type" value="website"/><set field="html_site_name" value="Coarchy"/></pre-actions><widgets><render-mode><text type="html,qvt,js"><![CDATA[<div class="row q-gutter-sm"><div id="org-template-content" class="col-lg-6 offset-lg-3 col-md-6 offset-md-2 col-sm-8 offset-sm-1 col-xs-12 offset-xs-0"><q-card flat bordered><q-card-section class="text-grey-8 bg-grey-2"><div class="row items-start justify-between"><div class="text-h5 text-bold text-black">
                                        ${organization.organizationName!''}
                                        <q-badge color="info">Template</q-badge></div><div><#if ec.user.userId??><c-create-org-from-template template-org-id="${templateOrgId!''}"></c-create-org-from-template><#else><q-btn no-caps href="/SignUp?templateOrgId=${templateOrgId!''}" label="Use Template" push color="primary" class="q-ml-xs" size="md"></q-btn></#if></div></div></q-card-section><q-separator></q-separator><q-card-section class="text-grey-8"><div class="text-subtitle2"><span id="Mission" class="template-header text-bold text-grey-6">
                                        Description
                                    </span><div class="text-black">
                                        ${mission!''}
                                    </div></div></q-card-section><#if originStory?has_content><q-card-section class="text-grey-8"><div class="text-subtitle2"><span id="OriginStory" class="template-header text-bold text-grey-6">
                                        Origin Story
                                    </span><div class="text-black">
                                        ${originStory!''}
                                    </div></div></q-card-section></#if><#if vision?has_content><q-card-section class="text-grey-8"><div class="text-subtitle2"><span id="Vision" class="template-header text-bold text-grey-6">
                                        Vision
                                    </span><div class="text-black">
                                        ${vision!''}
                                    </div></div></q-card-section></#if><#if valueStatementList?has_content><q-card-section class="text-grey-8"><div class="text-subtitle2"><span id="Statement" class="template-header text-bold text-grey-6">
                                        Statements
                                    </span><ul><#list valueStatementList as statement><li class="text-black">
                                                ${statement.value!''}
                                                <q-badge>${statement.typeDescription!''}</q-badge></li></#list></ul></div></q-card-section></#if><q-card-section class="text-grey-8"><div class="text-subtitle2"><span id="Actor" class="template-header text-bold text-grey-6">
                                        Actors
                                    </span><ul><#list actorList as actor><li class="text-black">
                                                ${actor.name!''}
                                                <#if actor.description?has_content><span class="text-grey-8">
                                                    – ${actor.description!''}
                                                    </span></#if></li></#list></ul></div></q-card-section><q-card-section class="text-grey-8"><div class="text-subtitle2"><span id="ProcessStory" class="template-header text-bold text-grey-6">
                                        Process Stories
                                    </span><div class="numbered-list text-black"><ol><#list processStoryList as story><li id="Story${story.processStoryId!''}" class="">
                                                    ${story.name!''}
                                                </li><#assign processStoryActivityList= activitiesByStoryMap[story.processStoryId]/><#include "component://coarchy/template/ProcessStoryOutline.html.ftl"/><br/></#list></ol></div></div></q-card-section><#if productList?has_content><q-card-section class="text-grey-8"><div class="text-subtitle2"><span id="Product" class="template-header text-bold text-grey-6">
                                        Products
                                    </span><ul><#list productList as product><li class="text-black">
                                                ${product.productName!''}
                                            </li></#list></ul></div></q-card-section></#if></q-card></div><div v-if="!$q.screen.lt.sm" id="org-template-nav" class="col" style="
                        position: sticky;
                        top: 60px;
                        height: calc(100vh - 60px);
                    "><q-scroll-area
                        class="absolute fit"
                      ><q-card flat bordered class="bg-transparent"><q-list dense class="text-caption text-grey-8 q-py-md bg-grey-2"><q-item clickable v-ripple @click="scrollToAnchor('OriginStory')">
                                    Origin Story
                                </q-item><q-item clickable v-ripple @click="scrollToAnchor('Mission')">
                                    Description
                                </q-item><q-item clickable v-ripple @click="scrollToAnchor('Vision')">
                                    Vision
                                </q-item><q-item clickable v-ripple @click="scrollToAnchor('Actor')">
                                    Actors
                                </q-item><#if valueStatementList?has_content><q-item clickable v-ripple  @click="scrollToAnchor('Statement')">
                                    Statements
                                </q-item></#if><q-item clickable v-ripple  @click="scrollToAnchor('ProcessStory')">
                                    Process Stories
                                </q-item><#list processStoryList as story><q-item clickable v-ripple :inset-level="1" @click="scrollToAnchor('Story${story.processStoryId!''}')">
                                        ${story?counter!''}. ${story.name!''}
                                    </q-item></#list><#if productList?has_content><q-item clickable v-ripple @click="scrollToAnchor('Product')">
                                    Products
                                </q-item></#if></q-list></q-card></q-scroll-area></div></div><q-drawer v-model="drawerRightOpen" side="right"><q-scroll-area
                        class="absolute fit"
                      ><q-card flat bordered class="bg-transparent"><q-list dense class="text-caption text-grey-8 q-py-md bg-grey-2"><q-item clickable v-ripple @click="scrollToAnchor('OriginStory')">
                                    Origin Story
                                </q-item><q-item clickable v-ripple @click="scrollToAnchor('Mission')">
                                    Description
                                </q-item><q-item clickable v-ripple @click="scrollToAnchor('Vision')">
                                    Vision
                                </q-item><q-item clickable v-ripple @click="scrollToAnchor('Actor')">
                                    Actors
                                </q-item><#if valueStatementList?has_content><q-item clickable v-ripple  @click="scrollToAnchor('Statement')">
                                    Statements
                                </q-item></#if><q-item clickable v-ripple  @click="scrollToAnchor('ProcessStory')">
                                    Process Stories
                                </q-item><#list processStoryList as story><q-item clickable v-ripple :inset-level="1" @click="scrollToAnchor('Story${story.processStoryId!''}')">
                                        ${story?counter!''}. ${story.name!''}
                                    </q-item></#list><#if productList?has_content><q-item clickable v-ripple  @click="scrollToAnchor('Product')">
                                    Products
                                </q-item></#if></q-list></q-card></q-scroll-area></q-drawer>]]></text></render-mode></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy-com/c/content.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="anonymous-view" allow-extra-path="true" default-menu-include="false"><transition name="attachment"><actions><set field="extraPathNameList" from="new ArrayList(sri.screenUrlInfo.extraPathNameList)"/><if condition="!extraPathNameList"><script><![CDATA[ec.web.sendError(404, null, null)]]></script></if><set field="filename" from="extraPathNameList.remove(extraPathNameList.size()-1)"/><service-call name="org.moqui.impl.WikiServices.get#WikiPageAttachment" out-map="context" in-map="[wikiSpaceId:'Agreement', pagePath:extraPathNameList?.join('/'), filename:filename]"/><script><![CDATA[ec.web.sendResourceResponse(attachmentReference.location, true)]]></script></actions><default-response type="none"/></transition><transition name="downloadSmallImage" read-only="true"><parameter name="wikiBlogId" required="true"/><actions><entity-find-one entity-name="moqui.resource.wiki.WikiBlog" value-field="wikiBlog" auto-field-map="[wikiBlogId:wikiBlogId]"/><entity-find-one entity-name="moqui.resource.wiki.WikiPage" value-field="wikiPage" auto-field-map="[wikiPageId:wikiBlog.wikiPageId]"/><if condition="wikiPage?.publishedVersionName != null"><script><![CDATA[ec.web.sendResourceResponse(wikiBlog?.smallImageLocation)]]></script><else><log level="warn" message="No published version for blog post ${wikiPageId}"/></else></if></actions><default-response type="none"/></transition><actions><set field="extraPathNameList" from="sri.screenUrlInfo.extraPathNameList"/><service-call name="org.moqui.impl.WikiServices.get#PublishedWikiPageText" out-map="context" in-map="[wikiSpaceId:'Agreement', pagePath:extraPathNameList?.join('/'), getPageText:false]"/></actions><widgets><section name="PageTextSection" condition="pageLocation"><widgets><container-row><row-col xs="1" md="2"/><row-col xs="10" md="8"><render-mode><text type="html,vuet,qvt" template="true" location="${pageLocation?:''}${versionName && currentVersionName != versionName ? '#' + versionName.take(12) : ''}"/></render-mode></row-col><row-col xs="1" md="2"/></container-row></widgets><fail-widgets><label text="Sorry, we couldn't find that page!" type="h2" style="text-center"/></fail-widgets></section></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy-com/c/HempExcerpts.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="false"><always-actions><set field="baseLinkUrl" from="!'production'.equals(System.getProperty('instance_purpose')) ? 'http://localhost:8080' : 'https://coarchy.com'"/><set field="imageUrl" value="/cstatic/background.jpg"/><set field="html_keywords" value="coarchy hemp"/><set field="html_title" value="Coarchy HEMP Excerpts: An agile approach to analysis and design"/><set field="html_description" value="HEMP Excerpts detail agile analysis/design for software, focusing on distinguishing business requirements from system designs."/><set field="html_image" from="baseLinkUrl + imageUrl"/><set field="html_url" from="baseLinkUrl+'/HempExcerpts'"/><set field="html_type" value="article"/><set field="html_site_name" value="Coarchy"/></always-actions><widgets><text location="component://coarchy/screen/coarchy-com/c/HempExcerpts.html"/></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy-com/c/Home.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="false" allow-extra-path="true"><pre-actions><set field="baseLinkUrl" from="!'production'.equals(System.getProperty('instance_purpose')) ? 'http://localhost:8080' : 'https://coarchy.com'"/><set field="imageUrl" value="/cstatic/background.jpg"/><set field="html_keywords" value="coarchy software organization"/><set field="html_title" value="Coarchy: YOUR Software for YOUR Organization (and more)"/><set field="html_description" value="Explore Coarchy.com for organizational design through process stories, streamlining team roles and collaboration for improved team collaboration."/><set field="html_image" from="baseLinkUrl + imageUrl"/><set field="html_url" from="baseLinkUrl+'/'"/><set field="html_type" value="website"/><set field="html_site_name" value="Coarchy"/></pre-actions><widgets><render-mode><text type="html"><![CDATA[<div style="background: linear-gradient(#eeeeee, #cccccc);"><q-card class="my-card"><q-parallax src="/cstatic/background.jpg" :height="500"/><q-card-section class="text-center q-pa-md shadow-10" data-aos="fade-in" data-aos-easing="ease-in-out-cubic" style="background: rgba(100,100,100,.75)"><h1 class="text-h1 text-white">Coarchy</h1><div class="text-h2 text-white q-mt-md">YOUR Software for YOUR Organization</div><q-btn no-caps href="/SignUp" label="Sign Up" push color="primary" class="q-mt-lg" size="xl"/></q-card-section></q-card><section data-aos="fade-in" data-aos-easing="ease-in-out-cubic"><q-card class="desktop-only text-h6 bg-grey-9 q-mt-xl q-mb-xl" dark bordered style="min-width:1000px;" flat bordered><q-card-section horizontal><q-card-section class="q-mt-md desktop-only" style="max-width:300px"><div class="text-h4" data-aos="fade-in" data-aos-easing="ease-in-out-cubic">View Your Process Stories</div><ul><li class="q-mt-sm" data-aos="fade-in" data-aos-easing="ease-in-out-cubic">Easily read the process stories you write</li><li class="q-mt-sm" data-aos="fade-in" data-aos-easing="ease-in-out-cubic">Admire your work</li><li class="q-mt-sm" data-aos="fade-in" data-aos-easing="ease-in-out-cubic">Export your process stories to csv or copy & paste</li></ul></q-card-section><q-img data-aos="fade-in" data-aos-easing="ease-in-out-cubic" src="/cstatic/ViewProcessStoryScreenshot.png"/></q-card-section></q-card><q-card class="mobile-only text-h6 bg-grey-9 q-mt-xl q-mb-xl" dark bordered style="min-width:400px;" flat bordered><q-card-section><q-card-section class="q-mt-md" style="max-width:300px"><div class="text-h4" data-aos="fade-in" data-aos-easing="ease-in-out-cubic">View Your Process Stories</div><ul><li class="q-mt-sm" data-aos="fade-in" data-aos-easing="ease-in-out-cubic">Easily read the process stories you write</li><li class="q-mt-sm" data-aos="fade-in" data-aos-easing="ease-in-out-cubic">Admire your work</li><li class="q-mt-sm" data-aos="fade-in" data-aos-easing="ease-in-out-cubic">Export your process stories to csv or copy & paste</li></ul></q-card-section><q-img data-aos="fade-in" data-aos-easing="ease-in-out-cubic" src="/cstatic/ViewProcessStoryScreenshot.png"/></q-card-section></q-card></section><section><q-card class="desktop-only text-h6 bg-grey-9 q-mt-xl q-mb-xl" dark bordered style="min-width:1000px;" flat bordered><q-card-section horizontal><q-card-section class="q-mt-md" style="max-width:300px"><div class="text-h4" data-aos="fade-in" data-aos-easing="ease-in-out-cubic">Write Your Process Stories</div><ul><li class="q-mt-sm" data-aos="fade-in" data-aos-easing="ease-in-out-cubic">Create activities and actors to <a href="https://coarchy.com/Article?wikiBlogId=100102">write a process story</a></li><li class="q-mt-sm" data-aos="fade-in" data-aos-easing="ease-in-out-cubic">Search for text or actors to find what you need</li><li class="q-mt-sm" data-aos="fade-in" data-aos-easing="ease-in-out-cubic">Attach substories for managing large process stories</li></ul></q-card-section><q-img data-aos="fade-in" data-aos-easing="ease-in-out-cubic" src="/cstatic/EditProcessStoryScreenshot.png"/></q-card-section></q-card><q-card class="mobile-only text-h6 bg-grey-9 q-mt-xl q-mb-xl" dark bordered style="min-width:300px;" flat bordered><q-card-section><q-card-section class="q-mt-md" style="max-width:300px"><div class="text-h4" data-aos="fade-in" data-aos-easing="ease-in-out-cubic">Write Your Process Stories</div><ul><li class="q-mt-sm" data-aos="fade-in" data-aos-easing="ease-in-out-cubic">Create activities and actors to <a href="https://coarchy.com/Article?wikiBlogId=100102">write a process story</a></li><li class="q-mt-sm" data-aos="fade-in" data-aos-easing="ease-in-out-cubic">Search for text or actors to find what you need</li><li class="q-mt-sm" data-aos="fade-in" data-aos-easing="ease-in-out-cubic">Attach substories for managing large process stories</li></ul></q-card-section><q-img data-aos="fade-in" data-aos-easing="ease-in-out-cubic" src="/cstatic/EditProcessStoryScreenshot.png"/></q-card-section></q-card></section><section><q-card class="desktop-only text-h6 bg-grey-9 q-mt-xl q-mb-xl" dark bordered style="min-width:1000px;" flat bordered><q-card-section horizontal><q-card-section class="q-mt-md" style="max-width:300px"><div class="text-h4" data-aos="fade-in" data-aos-easing="ease-in-out-cubic">Manage Your Organizations</div><ul><li class="q-mt-sm" data-aos="fade-in" data-aos-easing="ease-in-out-cubic">Clone new organization from existing Organizations</li><li class="q-mt-sm" data-aos="fade-in" data-aos-easing="ease-in-out-cubic">Invite your team members to join your Organization</li></ul></q-card-section><q-img data-aos="fade-in" data-aos-easing="ease-in-out-cubic" src="/cstatic/EditOrganizationScreenshot.png"/></q-card-section></q-card><q-card class="mobile-only text-h6 bg-grey-9 q-mt-xl q-mb-xl" dark bordered style="min-width:300px;" flat bordered><q-card-section><q-card-section class="q-mt-md" style="max-width:300px"><div class="text-h4" data-aos="fade-in" data-aos-easing="ease-in-out-cubic">Manage Your Organizations</div><ul><li class="q-mt-sm" data-aos="fade-in" data-aos-easing="ease-in-out-cubic">Clone new organization from existing Organizations</li><li class="q-mt-sm" data-aos="fade-in" data-aos-easing="ease-in-out-cubic">Invite your team members to join your Organization</li></ul></q-card-section><q-img data-aos="fade-in" data-aos-easing="ease-in-out-cubic" src="/cstatic/EditOrganizationScreenshot.png"/></q-card-section></q-card></section><section><!--                        <div class="text-h2 q-mt-xl">Design</div>--><q-card dark bordered class="text-h4 bg-grey-9 q-mt-xl q-mb-xl" style="max-width:600px;"><q-card-section>The core principle of Coarchy is <strong>design</strong> based on <strong>requirements</strong>.</q-card-section></q-card><q-card dark bordered class="text-h4 bg-grey-9 q-mt-xl q-mb-xl" style="max-width:600px;"><q-card-section>The <i>requirements</i> for an organization are its <strong>origin, vision, and <a href="https://www.jimcollins.com/media_topics/ItReallyMatters.html">values</a></strong></q-card-section></q-card><q-card dark bordered class="text-h4 bg-grey-9 q-mt-xl q-mb-xl" style="max-width:600px;"><q-card-section>The <i>design</i> based on these are <strong>process stories</strong> with <u>activities</u> that organize roles and responsibilities.</q-card-section></q-card></section><section><q-card dark bordered class="text-h4 bg-grey-9 q-mt-xl q-mb-xl" style="max-width:600px;"><q-card-section data-aos="fade-in" data-aos-easing="ease-in-out-cubic"><div class="text-h2">Implement</div></q-card-section><q-separator class="q-mt-md" dark inset data-aos="fade-in" data-aos-easing="ease-in-out-cubic"></q-separator><q-card-section class="q-mt-md" data-aos="fade-in" data-aos-easing="ease-in-out-cubic">The <i>design</i> of your organization is used as <i>requirements</i> for implementing your organization, for:</q-card-section><q-separator class="q-mt-md" dark inset data-aos="fade-in" data-aos-easing="ease-in-out-cubic"></q-separator><q-card-section><ul><li class="q-mt-xl" data-aos="fade-in" data-aos-easing="ease-in-out-cubic">people in their roles</li><li class="q-mt-xl" data-aos="fade-in" data-aos-easing="ease-in-out-cubic">software to manage and track</li><li class="q-mt-xl" data-aos="fade-in" data-aos-easing="ease-in-out-cubic">mechanization</li></ul></q-card-section></q-card></section><section><q-card dark bordered class="text-h4 bg-grey-9 q-mt-xl q-mb-xl" style="max-width:600px;"><q-card-section data-aos="fade-in" data-aos-easing="ease-in-out-cubic"><div class="text-h2">Concepts</div></q-card-section><q-separator class="q-mt-md" dark inset data-aos="fade-in" data-aos-easing="ease-in-out-cubic"></q-separator><q-card-section class="q-mt-md" data-aos="fade-in" data-aos-easing="ease-in-out-cubic">Coarchy is based on concepts from designing and building business automation software as described
                                in the book <i>HEMP: An agile approach to analysis and design</i>. To help users of Coarchy get started
                                some excerpts from the book are available here.</q-card-section><q-separator class="q-mt-md" dark inset data-aos="fade-in" data-aos-easing="ease-in-out-cubic"></q-separator><q-card-section class="q-mt-md q-mb-md" data-aos="fade-in" data-aos-easing="ease-in-out-cubic" align="center"><q-btn no-caps href="/HempExcerpts" push color="primary" size="xl"><a href="/HempExcerpts"></a>HEMP Excerpts</q-btn></q-card-section></q-card></section></div>]]></text></render-mode></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy-com/c/Login.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="anonymous-view" allow-extra-path="true"><transition name="login" method="post" require-session-token="false"><parameter name="username" required="true"/><parameter name="password" required="true"/><parameter name="code"/><parameter name="templateOrgId"/><parameter name="organizationName"/><actions><set field="loggedIn" from="ec.user.loginUser(username, password)"/><if condition="ec.message.hasError()"><script><![CDATA[ec.web.sendJsonResponse([loggedIn:false])]]></script></if><if condition="ec.web.sessionAttributes.moquiAuthcFactorRequired"><then><if condition="code"><then><service-call name="org.moqui.impl.UserServices.validate#ExternalUserAuthcCode" in-map="[code:code]" out-map="validateOut"/><if condition="validateOut.verified"><then><script><![CDATA[ec.user.internalLoginUser(validateOut.username)]]></script><return/></then><else><message type="danger" public="true"><![CDATA[Authentication code is not valid]]></message></else></if></then></if><service-call name="org.moqui.impl.UserServices.get#ExternalUserAuthcFactorInfo" out-map="factorInfoOut"/><script><![CDATA[ec.web.sendJsonResponse(factorInfoOut)]]></script></then><else><script><![CDATA[ec.web.sendJsonResponse([loggedIn:loggedIn])]]></script></else></if><if condition="loggedIn"><entity-find-count entity-name="mantle.party.PartyClassificationAppl" count-field="partyClassificationCount"><econdition field-name="partyId" from="ec.user.userAccount.partyId"/></entity-find-count><entity-find entity-name="mantle.party.PartyClassificationAppl" list="partyClassificationList"><econdition field-name="partyId" from="ec.user.userAccount.partyId"/><econdition field-name="partyClassificationId" operator="in" from="['ColdLead','Prospect']"/><date-filter/></entity-find><if condition="partyClassificationList.size() > 0 || (partyClassificationCount == 0 && partyClassificationList.size() == 0)"><service-call name="coarchy.CoarchyServices.set#PartyClassification" in-map="[partyClassificationId:'HotLead']" out-map="context"/></if><if condition="templateOrgId?.length()"><entity-find-one entity-name="mantle.party.Party" value-field="templateOrg"><field-map field-name="partyId" from="templateOrgId"/></entity-find-one><if condition="!templateOrg || (templateOrg.visibilityEnumId!='PvPublic')"><return error="true" message="Invalid template"/></if><if condition="!organizationName.strip()"><return error="true" message="Please specify an organization name"/></if><service-call name="coarchy.CoarchyServices.create#Organization" in-map="[organizationId:templateOrgId,organizationName:organizationName,copyProducts:'copy']" disable-authz="true"/></if></if></actions><default-response type="none"/></transition><transition name="logout"><actions><script><![CDATA[ec.user.logoutUser()]]></script></actions><default-response url="/"/><error-response url="."/></transition><transition name="createInitialAdminAccount"><condition><expression><![CDATA[ec.entity.find('moqui.security.UserAccount').disableAuthz().count() == 1]]></expression></condition><service-call name="org.moqui.impl.UserServices.create#InitialAdminAccount" in-map="true" out-map="context" multi="parameter"/><default-response url="../Login"/><error-response url="."/></transition><pre-actions><script><![CDATA[// if user already logged in redirect to application
        if (ec.user.userId) sri.sendRedirectAndStopRender('/settings')]]></script><set field="baseLinkUrl" from="!'production'.equals(System.getProperty('instance_purpose')) ? 'http://localhost:8080' : 'https://coarchy.com'"/><set field="imageUrl" value="/cstatic/background.jpg"/><set field="html_keywords" value="coarchy log in"/><set field="html_title" value="Coarchy Log In: Log In to Coarchy to Achieve Greatness"/><set field="html_description" value="Log In to Coarchy to Achieve Greatness"/><set field="html_image" from="baseLinkUrl + imageUrl"/><set field="html_url" from="baseLinkUrl+'/Login'"/><set field="html_type" value="website"/><set field="html_site_name" value="Coarchy"/></pre-actions><widgets><section name="NeedsSetupSection" condition="ec.entity.find('moqui.security.UserAccount').disableAuthz().count() > 1"><widgets><render-mode><text type="html"><![CDATA[<div style=""><div class="row"><div class="col-md-4 offset-md-4 col-xs-12 offset-xs-0"><div class="column justify-center" style="height: 150px"><div class="col-4"><q-card flat bordered style="width: 100%;" class="col-4 bg-grey-1" data-aos="fade-in" data-aos-easing="ease-in-out-cubic"><q-card-section><div class="text-h2">Log In</div></q-card-section><q-card-section><c-login></c-login></q-card-section></q-card></div></div></div></div></div>]]></text></render-mode></widgets><fail-widgets><render-mode><text type="html"><![CDATA[<div class="text-center"><h3>Welcome to your new system</h3><form method="post" action="${sri.buildUrl("createInitialAdminAccount").url}" class="qa-ma-lg" id="InitialAdminForm"><p class="text-muted text-center">There are no user accounts, get started by creating an initial administrator account</p><input type="hidden" name="moquiSessionToken" value="${ec.web.sessionToken}"><input type="text" name="username" value="${(ec.getWeb().getErrorParameters().get("username"))!""}" placeholder="Username" required="required" class="form-control top"><input type="password" name="newPassword" placeholder="New Password" required="required" class="form-control middle"><input type="password" name="newPasswordVerify" placeholder="New Password Verify" required="required" class="form-control middle"><input type="text" name="userFullName" value="${(ec.getWeb().getErrorParameters().get("userFullName"))!""}" placeholder="User Full Name" required="required" class="form-control middle"><input type="text" name="emailAddress" value="${(ec.getWeb().getErrorParameters().get("emailAddress"))!""}" placeholder="Email Address" required="required" class="form-control bottom"><button class="btn btn-lg btn-primary btn-block" type="submit">Create Initial Admin Account</button></form></div>]]></text></render-mode></fail-widgets></section></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy-com/c/Newsletter.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Newsletter" require-authentication="anonymous-view"><pre-actions><set field="baseLinkUrl" from="!'production'.equals(System.getProperty('instance_purpose')) ? 'http://localhost:8080' : 'https://coarchy.com'"/><set field="imageUrl" value="/cstatic/background.jpg"/><set field="html_keywords" value="coarchy newsletter"/><set field="html_title" value="Coarchy Newsletter: The greatest source of Coarchy news"/><set field="html_description" value="Subscribe to Coarchy's Newsletter for the latest updates on requirements and product innovations. Stay informed and ahead with our news directly in your inbox."/><set field="html_image" from="baseLinkUrl + imageUrl"/><set field="html_url" from="baseLinkUrl+'/Newsletter'"/><set field="html_type" value="website"/><set field="html_site_name" value="Coarchy"/></pre-actions><actions><set field="baseLinkUrl" from="!'production'.equals(System.getProperty('instance_purpose')) ? 'http://localhost:8080' : 'https://coarchy.com'"/><entity-find entity-name="moqui.resource.wiki.WikiBlogFindView" list="blogListOut"><econdition field-name="wikiPageCategoryId" value="Newsletter"/><econdition field-name="publishedVersionName" operator="is-not-null"/><order-by field-name="publishDate"/></entity-find><set field="blogList" from="[]"/><iterate list="blogListOut" entry="blog"><script><![CDATA[blogList.push([wikiBlogId:blog.wikiBlogId,title:blog.title,author:blog.author,
                imageUrl:baseLinkUrl+'/content/downloadSmallImage?wikiBlogId='+blog.wikiBlogId,
                blogUrl:baseLinkUrl+'/Article?wikiBlogId='+blog.wikiBlogId,
                publishDate:ec.l10n.format(blog.publishDate, 'MMM dd, yyyy'),summary:blog.summary]);]]></script></iterate></actions><widgets><render-mode><text type="html,vuet,qvt" location="component://coarchy/template/BlogList.html.ftl"/></render-mode><render-mode><text type="html"><![CDATA[<div class="row"><div class="col-lg-6 offset-lg-3 col-md-8 offset-md-2 col-sm-10 offset-sm-1 col-xs-12 offset-xs-0"><div class="column justify-center" style="height: 150px"><div class="col-4"><q-card flat bordered style="width: 100%;" class="col-4 bg-grey-1" data-aos="fade-in" data-aos-easing="ease-in-out-cubic"><q-card-section><h1 class="text-h2">Newsletter</h1></q-card-section><q-card-section><div class="flex flex-center justify-center items-center text-h4 q-mt-md">Sign up for our Newsletter</div><div class="flex flex-center justify-center items-center text-h6 q-mt-xs">Learn about requirements and get product updates</div><div class="flex flex-center justify-center items-center q-mt-lg q-mb-md"><c-newsletter-signup></c-newsletter-signup></div></q-card-section><q-card-section><c-blog-list></c-blog-list></q-card-section></q-card></div></div></div></div>]]></text></render-mode></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy-com/c/Organizations.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" require-authentication="true"><widgets><render-mode><text type="html"><![CDATA[<div class="row"><div class="col-md-4 offset-md-4 col-xs-12 offset-xs-0"><div class="column justify-top" style="height: 150px"><div class="col-4"><div class="text-h4 q-pb-lg">Organizations and People</div><!--                                <c-create-organization></c-create-organization>--><!--                                <c-list-organizations></c-list-organizations>--></div></div></div></div>]]></text></render-mode></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy-com/c/SignUp.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="anonymous-all" allow-extra-path="true"><parameter name="templateOrgId"/><transition name="createAccount" require-session-token="false"><service-call name="coarchy.CoarchyServices.signUp#User" in-map="context" out-map="context" multi="parameter"/><conditional-response url="/coapp/Home"><condition><expression><![CDATA[newOrganizationId != null]]></expression></condition></conditional-response><default-response url="/settings"/><error-response url="." save-parameters="true"/></transition><pre-actions><script><![CDATA[// if user already logged in redirect to application
        if (ec.user.userId) sri.sendRedirectAndStopRender('/settings')]]></script><set field="baseLinkUrl" from="!'production'.equals(System.getProperty('instance_purpose')) ? 'http://localhost:8080' : 'https://coarchy.com'"/><set field="imageUrl" value="/cstatic/background.jpg"/><set field="html_keywords" value="coarchy sign up"/><set field="html_title" value="Coarchy Sign Up: Sign Up to Coarchy to Achieve Greatness"/><set field="html_description" value="Sign Up to Coarchy to Achieve Greatness"/><set field="html_image" from="baseLinkUrl + imageUrl"/><set field="html_url" from="baseLinkUrl+'/SignUp'"/><set field="html_type" value="website"/><set field="html_site_name" value="Coarchy"/></pre-actions><actions><entity-find entity-name="mantle.party.agreement.AgreementAndContent" list="agreementList"><econdition field-name="agreementAgreementTypeEnumId" operator="in" from="['AgrPrivacyPolicy','AgrTermsOfUse']" ignore-if-empty="true"/><econdition field-name="agreementIsTemplate" value="Y" ignore-if-empty="true"/><econdition field-name="contentContentTypeEnumId" value="AcntDocument"/><date-filter from-field-name="agreementFromDate" thru-field-name="agreementThruDate"/><select-field field-name="contentContentLocation, typeDescription"/><order-by field-name="-contentContentDate, -agreementAgreementDate"/></entity-find></actions><widgets><render-mode><text type="html"><![CDATA[<div class="row"><div class="col-md-4 offset-md-4 col-xs-12 offset-xs-0"><div class="column justify-center" style="height: 150px"><div class="col-4"><q-card flat bordered style="width: 100%;" class="col-4 bg-grey-1" data-aos="fade-in" data-aos-easing="ease-in-out-cubic"><q-card-section><div class="text-h2">Sign Up</div></q-card-section><q-card-section><c-sign-up></c-sign-up></q-card-section></q-card></div></div></div></div>]]></text></render-mode></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy-com/c/Unsubscribe.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" require-authentication="anonymous-all" history="false"><always-actions><entity-find entity-name="mantle.marketing.contact.ContactListParty" list="contactListPartyList" limit="1"><econdition field-name="optInVerifyCode" operator="is-not-null"/><econdition field-name="optInVerifyCode"/><order-by field-name="-fromDate"/></entity-find><set field="contactListPartyExists" from="contactListPartyList.size() > 0" type="Boolean"/></always-actions><transition name="unsubscribe"><condition><expression><![CDATA[contactListPartyExists]]></expression></condition><service-call name="coarchy.CoarchyServices.unsubscribe#ContactList" in-map="[optInVerifyCode:optInVerifyCode]" out-map="context" multi="parameter"/><default-response url="." parameter-map="[statusId:statusId]"/><error-response url="." save-parameters="true"/></transition><actions><entity-find-one entity-name="mantle.marketing.contact.ContactList" value-field="contactList" auto-field-map="[contactListId:contactListPartyList?.getFirst()?.contactListId]"/><set field="contact_list_name_label" from="contactList?.contactListName"/><set field="contact_list_party_exists" from="contactListPartyExists?'true':'false'"/><set field="contact_list_status" from="contactListPartyList?.getFirst()?.statusId"/><log level="warn" message="Unsubscribe context.toString(): ${context.toString()}"/></actions><widgets><render-mode><text type="html"><![CDATA[<div class="row"><div class="col-md-4 offset-md-4 col-xs-12 offset-xs-0"><div class="column justify-center" style="height: 150px"><div class="col-4"><q-card flat bordered style="width: 100%;" class="col-4 bg-grey-1"><q-card-section><div class="text-h2">Unsubscribe</div></q-card-section><q-card-section><c-unsubscribe contact_list_party_exists="${contact_list_party_exists}" contact_list_status="${contact_list_status!}" contact_list_name_label="${contact_list_name_label!}"></c-unsubscribe></q-card-section></q-card></div></div></div></div>]]></text></render-mode></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy-com/c.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="false" standalone="true" allow-extra-path="true"><transition name="robots.txt" read-only="true"><actions><script><![CDATA[List disallowList = ['settings','coapp','apps', 'vapps', 'qapps', 'rest', 'rpc', 'status', 'menuData']
            def outWriter = new StringWriter()
            outWriter.append("user-agent: *\n")
            for (disPath in disallowList) outWriter.append("disallow: /${disPath}\n")
            outWriter.append("\nSiteMap: /sitemap.xml\n")
            ec.web.sendTextResponse(outWriter.toString())]]></script></actions><default-response type="none"/></transition><transition name="sitemap.xml" read-only="true" require-session-token="false"><service-call name="coarchy.CoarchyServices.generate#Sitemap" out-map="context" in-map="true" multi="parameter"/><actions><script><![CDATA[ec.web.sendTextResponse(sitemapXml)]]></script></actions><default-response type="none"/></transition><subscreens default-item="Home" always-use-full-path="true"/><pre-actions><set field="baseLinkUrl" from="!'production'.equals(System.getProperty('instance_purpose')) ? 'http://localhost:8080' : 'https://coarchy.com'"/><set field="imageUrl" value="/cstatic/background.jpg"/><set field="html_keywords" value="coarchy software organization"/><set field="html_title" value="Coarchy: YOUR Software for YOUR Organization (and more)"/><set field="html_description" value="Explore Coarchy.com for organizational design through process stories, streamlining team roles and collaboration for improved team collaboration."/><set field="html_image" from="baseLinkUrl + imageUrl"/><set field="html_type" value="website"/><set field="html_site_name" value="Coarchy"/><script><![CDATA[// if user not logged in save current path and params then redirect to Login
//        html_scripts.add('/libs/moment.js/moment-with-locales.min.js')
//        html_scripts.add('/libs/jquery/jquery.min.js')

        html_stylesheets.add('/libs/quasar/quasar.min.css')
        html_stylesheets.add('/cstatic/style.css')
        html_stylesheets.add('/cstatic/aos.css')

        String instancePurpose = System.getProperty("instance_purpose")
        if (!instancePurpose || instancePurpose == 'production') {
            /* ========== Production Mode ========== */
//            // jQuery
            html_scripts.add('/libs/jquery/jquery.min.js')
//            // Bootstrap
//            html_scripts.add('/libs/twitter-bootstrap/js/bootstrap.min.js')
//            // Form Validation and AJAX (jquery-validation, jquery-form)
//            html_scripts.add('/libs/jquery-validate/jquery.validate.min.js')

            // Vue JS
            footer_scripts.add('/libs/vue/vue.min.js')
            // http-vue-loader
//            footer_scripts.add('/js/http-vue-loader/httpVueLoader.js')
            // Quasar
            footer_scripts.add("/libs/quasar/quasar.umd.min.js")

            html_scripts.add('/js/MoquiLib.min.js')
            // Webroot Quasar-Vue instance, in footer so runs after page loaded
            footer_scripts.add('/cstatic/CoarchyComVue.qvt.js')
            footer_scripts.add('/cstatic/aos.js')

        } else {
            /* ========== Dev Mode ========== */
//            // jQuery
            html_scripts.add('/libs/jquery/jquery.min.js')
//            // Bootstrap
//            html_scripts.add('/libs/twitter-bootstrap/js/bootstrap.min.js')
//            // Form Validation and AJAX (jquery-validation, jquery-form)
//            html_scripts.add('/libs/jquery-validate/jquery.validate.min.js')

            // Vue JS
            footer_scripts.add('/libs/vue/vue.js')
            // http-vue-loader
//            footer_scripts.add('/js/http-vue-loader/httpVueLoader.js')
            // Quasar
            footer_scripts.add("/libs/quasar/quasar.umd.min.js")

            html_scripts.add('/js/MoquiLib.js')
            // Webroot Quasar-Vue instance, in footer so runs after page loaded
            footer_scripts.add('/cstatic/CoarchyComVue.qvt.js')
            footer_scripts.add('/cstatic/aos.js')
        }]]></script></pre-actions><widgets><render-mode><text type="html" location="component://coarchy/screen/coarchy-com/includes/CoarchyComHeader.html.ftl"/></render-mode><subscreens-active/><render-mode><text type="html" location="component://coarchy/screen/coarchy-com/includes/CoarchyComFooter.html.ftl"/></render-mode></widgets></screen>
<!-- Screen Location component://webroot/screen/webroot/ChangePassword.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" require-authentication="false"><transition name="changePassword"><service-call name="org.moqui.impl.UserServices.update#Password" in-map="true" out-map="context" multi="parameter"/><default-response url="../Login"/><error-response url="."/></transition><widgets><container-panel id="apps-container"><panel-header><container id="header-logo"><label text="Welcome" type="h1"/></container></panel-header><panel-center><section-iterate name="headerMessages" list="ec.message.messages" entry="message"><widgets><container style="message"><label text="${message}"/></container></widgets></section-iterate><section-iterate name="headerErrors" list="ec.message.errors" entry="errorMessage"><widgets><container style="message error"><label text="${errorMessage}"/></container></widgets></section-iterate><container id="login-box"><form-single name="ChangePassword" transition="changePassword"><field name="username"><default-field><text-line size="20"/></default-field></field><field name="oldPassword"><default-field><password size="20"/></default-field></field><field name="newPassword"><default-field><password size="20"/></default-field></field><field name="newPasswordVerify"><default-field><password size="20"/></default-field></field><field name="submitButton"><default-field title="Login"><submit/></default-field></field></form-single></container></panel-center></container-panel></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy/cointernal/Home.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Home" default-menu-index="1" menu-image="/ssstatic/images/Facility.png"><always-actions><if condition="!activeOrgId"><message type="info"><![CDATA[Select an Organization before moving forward.]]></message><script><![CDATA[sri.sendRedirectAndStopRender('/settings/Organizations')]]></script></if><entity-find-count entity-name="mantle.party.PartyRelationship" count-field="partyRelationshipCount"><date-filter/><econdition field-name="relationshipTypeEnumId" value="PrtMember"/><econdition field-name="toRoleTypeId" value="OrgInternal"/><econdition field-name="fromPartyId" from="ec.user.userAccount.partyId"/><econdition field-name="toPartyId" from="activeOrgId"/></entity-find-count><entity-find-count entity-name="mantle.party.PartyActivation" count-field="partyActivationCount"><date-filter/><econdition field-name="partyId" from="activeOrgId"/></entity-find-count></always-actions><transition name="viewProcessStory"><default-response url="../Process/ViewProcessStory" parameter-map="[processStoryId:processStoryId]"/></transition><transition name="viewEvaluationReports"><default-response url="../Products/EvalReports"/></transition><transition name="getCloneOrganizationList"><condition><expression><![CDATA[partyRelationshipCount > 0]]></expression></condition><service-call name="coarchy.CoarchyServices.get#CloneOrganizationList" in-map="[term:term]" out-map="context" multi="parameter"/><actions><script><![CDATA[ec.web.sendJsonResponse(outList)]]></script></actions><default-response type="none" save-current-screen="true"/></transition><transition name="upgradeParty"><condition><expression><![CDATA[partyRelationshipCount > 0]]></expression></condition><service-call name="coarchy.CoarchyServices.activateOrDeactivate#Organization" in-map="[organizationPartyId:activeOrgId]" out-map="context" multi="parameter"/><actions><if condition="needsCredits"><set field="ec.web.sessionAttributes.beforeCheckoutUrl" from="ec.web.screenHistory.getAt(0)?.pathWithParams?.replace('cointernal','coapp')?:null"/><set field="ec.web.sessionAttributes.checkoutOrganizationId" from="activeOrgId"/></if></actions><conditional-response url="/settings/BuyPremium" url-type="plain" parameter-map="[creditsNeeded:creditsNeeded]"><condition><expression><![CDATA[needsCredits]]></expression></condition></conditional-response><default-response/></transition><actions><entity-find entity-name="coarchy.ValueStatement" list="valueStatementList" limit="20"><econdition field-name="disabled" value="N" or-null="true"/><econdition field-name="replacedByValueStatementId" operator="is-null"/><order-by field-name="-lastUpdatedStamp"/></entity-find><entity-find entity-name="coarchy.Actor" list="actorList" limit="20"><order-by field-name="-lastUpdatedStamp"/></entity-find><entity-find entity-name="coarchy.ProcessStoryActivityDetail" list="processStoryList" limit="20" distinct="true"><date-filter/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="-activityLastUpdatedStamp"/></entity-find><entity-find entity-name="mantle.work.effort.WorkEffort" list="checklistList" limit="20"><econdition field-name="workEffortTypeEnumId" value="WetProject"/><econdition field-name="actualCompletionDate" operator="is-not-null"/><order-by field-name="-actualCompletionDate"/></entity-find><entity-find-count entity-name="coarchy.product.ProductEvaluation" count-field="evalCount"><econdition field-name="organizationId" from="activeOrgId"/><econdition field-name="statusId" value="PeCompleted"/></entity-find-count><set field="activityFeedList" from="[]"/><set field="baseLinkUrl" from="!'production'.equals(System.getProperty('instance_purpose')) ? 'http://localhost:8080' : 'https://coarchy.com'"/><iterate list="valueStatementList" entry="item"><script><![CDATA[activityFeedList.add(['date':item.lastUpdatedStamp,'updateType':'Updated','entityType':'Value','name':item.value,'identifier':'Value#'+item.valueStatementId,'link':'/coapp/ValueStatements?valueStatementId='+item.valueStatementId])]]></script></iterate><iterate list="actorList" entry="item"><script><![CDATA[activityFeedList.add(['date':item.lastUpdatedStamp,'updateType':'Updated','entityType':'Actor','name':item.name,'identifier':'Actor#'+item.actorId,'link':'/coapp/Actor?actorId='+item.actorId])]]></script></iterate><iterate list="processStoryList" entry="item"><if condition="!activityFeedList.find{it.identifier == 'ProcessStory#'+item.processStoryId}"><script><![CDATA[activityFeedList.add(['date':item.activityLastUpdatedStamp,'updateType':'Updated','entityType':'Process Story','name':item.name,'identifier':'ProcessStory#'+item.processStoryId,'link':'/coapp/Process/EditProcessStoryV3?processStoryId='+item.processStoryId])]]></script></if></iterate><iterate list="checklistList" entry="item"><script><![CDATA[activityFeedList.add(['date':item.actualCompletionDate,'updateType':'Completed','entityType':'Checklist','name':item.workEffortName,'identifier':'Checklist#'+item.workEffortId,'link':'/coapp/Checklist?checklistId='+item.workEffortId])]]></script></iterate><script><![CDATA[activityFeedList.sort({m1, m2 -> m2.date <=> m1.date})]]></script><set field="valueStatementCount" from="valueStatementList?.size()"/><set field="actorCount" from="actorList?.size()"/><entity-find-count entity-name="coarchy.ProcessStory" count-field="processStoryCount"/></actions><widgets><section name="FreemiumBanner" condition="partyActivationCount == 0"><widgets><container type="q-banner inline-actions rounded dense" style="bg-grey-3 text-black q-mb-md"><label text="To enable all the features upgrade organization '${activeOrg.organizationName}' to Premium" type="b"/><container type="template v-slot:action"><form-single name="UpgradeForm" transition="upgradeParty"><field name="upgrade"><default-field><submit text="Upgrade" type="success" confirmation="Activating will cost 1 Organization-Month Credit per month while ${activeOrg.organizationName} is upgraded. Are you sure?"/></default-field></field></form-single></container></container></widgets></section><label text="Home" type="h4"/><container-row><row-col md="6"><label text="Screens" type="h5" style="q-pt-sm"/><link url="../Vision" text="Vision"/><link url="../ValueStatements" text="Statements"/><link url="../Actor" text="Actors"/><link url="../Process/FindProcessStory" text="Process Stories"/><link url="../FindChecklist" text="Checklists"/></row-col><row-col md="6"><label text="Reports" type="h5" style="q-pt-sm" condition="valueStatementCount > 0 || actorCount > 0 || processStoryCount > 0"/><link url="../ViewValueStatements" text="View Statements" condition="valueStatementCount > 0" btn-type="info"/><link url="../ViewActors" text="View Actors" condition="actorCount > 0" btn-type="info"/><container-dialog id="ViewProcessStoryDialog" button-text="View Process Story" condition="processStoryCount > 0" type="info"><form-single name="ViewProcessStoryForm" transition="viewProcessStory"><field name="processStoryId"><default-field title="Process Story"><drop-down required-manual-select="true" submit-on-select="true" allow-empty="true"><entity-options key="${processStoryId}" text="${name}"><entity-find entity-name="coarchy.ProcessStory" list="processStoryList"><econdition field-name="disabled" value="N"/><order-by field-name="name"/></entity-find></entity-options></drop-down></default-field></field></form-single></container-dialog><link url="viewEvaluationReports" text="View Evaluations" condition="evalCount > 0" btn-type="info"/></row-col><row-col md="8"><label text="Feed" type="h5" style="q-pt-sm"/><section-iterate name="FeedSection" list="activityFeedList" entry="item"><widgets><container type="q-card" style="q-pa-sm q-mb-xs"><render-mode><text><![CDATA[<h6>${item.entityType}: <m-link href="${item.link}"><span v-pre>${item.name!""}</span></m-link></h6>]]></text></render-mode><label text="${item.updateType} on ${ec.l10n.format(item.date,'MMMM dd, HH:mm')}"/></container></widgets></section-iterate></row-col></container-row></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy/cointernal/Vision.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Vision" default-menu-index="05" menu-image="fa fa-eye" menu-image-type="icon"><always-actions><if condition="!activeOrgId"><message type="info"><![CDATA[Select an Organization before moving forward.]]></message><script><![CDATA[sri.sendRedirectAndStopRender('/settings/Organizations')]]></script></if><entity-find-count entity-name="mantle.party.PartyRelationship" count-field="partyRelationshipCount"><date-filter/><econdition field-name="relationshipTypeEnumId" value="PrtMember"/><econdition field-name="toRoleTypeId" value="OrgInternal"/><econdition field-name="fromPartyId" from="ec.user.userAccount.partyId"/><econdition field-name="toPartyId" from="activeOrgId"/></entity-find-count></always-actions><transition name="updateVision"><condition><expression><![CDATA[partyRelationshipCount > 0]]></expression></condition><service-call name="coarchy.CoarchyServices.update#Vision" in-map="[partyId:activeOrgId,originStoryDescription:originStoryDescription,missionDescription:missionDescription,visionDescription:visionDescription]" out-map="context" multi="parameter"/><default-response/><error-response url="." save-parameters="true"/></transition><actions><entity-find entity-name="mantle.party.PartyContent" list="originStoryList" limit="1"><econdition field-name="partyId" from="activeOrgId"/><econdition field-name="partyContentTypeEnumId" value="PcntOriginStory"/><order-by field-name="-contentDate"/></entity-find><entity-find entity-name="mantle.party.PartyContent" list="missionList" limit="1"><econdition field-name="partyId" from="activeOrgId"/><econdition field-name="partyContentTypeEnumId" value="PcntMission"/><order-by field-name="-contentDate"/></entity-find><entity-find entity-name="mantle.party.PartyContent" list="visionList" limit="1"><econdition field-name="partyId" from="activeOrgId"/><econdition field-name="partyContentTypeEnumId" value="PcntVision"/><order-by field-name="-contentDate"/></entity-find></actions><widgets><container-row><row-col md="8" lg="6"><label text="Vision" type="h4" style="q-pl-sm"/><form-single name="UpdateVision" transition="updateVision"><field name="originStoryLabel"><default-field><label text="Origin Story is the relevant history from the founders that led to the organization being created" type="h5"/></default-field></field><field name="originStoryDescription" from="originStoryList.getFirst()?.description"><default-field title="Origin Story"><text-area autogrow="true"/></default-field></field><field name="missionLabel"><default-field><label text="A mission describes the purpose behind what organization currently does to guide values and strategy" type="h5" style="q-pt-sm"/></default-field></field><field name="missionDescription" from="missionList.getFirst()?.description"><default-field title="Mission"><text-area autogrow="true"/></default-field></field><field name="visionLabel"><default-field><label text="Vision describes the future outcomes or goals of the organization" type="h5" style="q-pt-sm"/></default-field></field><field name="visionDescription" from="visionList.getFirst()?.description"><default-field title="Vision"><text-area autogrow="true"/></default-field></field><field name="submit"><default-field title="Update"><submit/></default-field></field></form-single></row-col></container-row></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy/cointernal/ValueStatements.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Statements" default-menu-index="10" menu-image="/ssstatic/images/Vendor.png"><parameter name="processStoryId"/><parameter name="pageIndex" from="pageIndex?:0"/><parameter name="pageSize"/><parameter name="orderByField" value="value"/><always-actions><if condition="!activeOrgId"><message type="info"><![CDATA[Select an Organization before moving forward.]]></message><script><![CDATA[sri.sendRedirectAndStopRender('/settings/Organizations')]]></script></if><entity-find-count entity-name="mantle.party.PartyRelationship" count-field="partyRelationshipCount"><date-filter/><econdition field-name="relationshipTypeEnumId" value="PrtMember"/><econdition field-name="toRoleTypeId" value="OrgInternal"/><econdition field-name="fromPartyId" from="ec.user.userAccount.partyId"/><econdition field-name="toPartyId" from="activeOrgId"/></entity-find-count><entity-find-count entity-name="mantle.party.PartyActivation" count-field="partyActivationCount"><date-filter/><econdition field-name="partyId" from="activeOrgId"/></entity-find-count></always-actions><transition name="createValue"><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><service-call name="coarchy.CoarchyServices.create#ValueStatement" in-map="[value:value,typeEnumId:typeEnumId,tagIdList:tagIdList,organizationId:activeOrgId]" out-map="context" multi="parameter"/><default-response/><error-response url="." save-parameters="true"/></transition><transition name="updateValue"><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><service-call name="coarchy.CoarchyServices.update#ValueStatement" in-map="[valueStatementId:valueStatementId,activityIdList:activityIdList,tagIdList:tagIdList,value:value,typeEnumId:typeEnumId,sequenceNum:sequenceNum,ignoreCopyOnWrite:ignoreCopyOnWrite,organizationId:activeOrgId]" out-map="context" multi="parameter"/><default-response/><error-response url="." save-parameters="true"/></transition><transition name="deleteValue"><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><service-call name="coarchy.CoarchyServices.delete#ValueStatement" in-map="[valueStatementId:valueStatementId,organizationId:activeOrgId]" out-map="context" multi="parameter"/><default-response/><error-response url="." save-parameters="true"/></transition><transition name="showValueActivityDialog"><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><actions><message type="warning"><![CDATA[${ec.resource.expand("CoarchyProcessValueStatementDeleteWithActivities", null)}]]></message></actions><default-response parameter-map="[_openDialog:_openDialog]"/><error-response url="." save-parameters="true"/></transition><transition name="refreshPageWithFilters"><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><default-response url="." parameter-map="[_openDialog:_openDialog, processStoryIds:processStoryIds, actorIds:actorIds]"/><error-response url="." save-parameters="true"/></transition><transition name="deleteValueActivity"><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><service-call name="update#coarchy.ValueStatementActivity" in-map="[valueStatementActivityId:valueStatementActivityId,thruDate:ec.user.nowTimestamp, organizationId:activeOrgId]" out-map="context" multi="parameter"/><default-response parameter-map="[_openDialog:_openDialog]"/><error-response url="." save-parameters="true"/></transition><transition name="deleteAllValueActivities"><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><actions><entity-find entity-name="coarchy.ValueStatementActivity" list="valueActivities"><date-filter/><econdition field-name="valueStatementId" from="valueStatementId"/><econdition field-name="organizationId" from="activeOrgId"/></entity-find><iterate list="valueActivities" entry="valueActivity"><service-call name="update#coarchy.ValueStatementActivity" in-map="[valueStatementActivityId:valueActivity.valueStatementActivityId, thruDate:ec.user.nowTimestamp]"/></iterate></actions><default-response parameter-map="[_openDialog:_openDialog]"/><error-response url="." save-parameters="true"/></transition><transition name="createTag"><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><service-call name="coarchy.CoarchyServices.getOrCreate#Tag" in-map="[description:description,organizationId:activeOrgId]" out-map="context" multi="parameter"/><default-response/><error-response url="." save-parameters="true"/></transition><transition name="createStatementTag"><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><service-call name="coarchy.CoarchyServices.create#ValueStatementTag" in-map="[tagId:tagId,description:description,organizationId:activeOrgId]" out-map="context" multi="parameter"/><default-response/><error-response url="." save-parameters="true"/></transition><transition name="addActivityToValueStatement"><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><service-call name="coarchy.CoarchyServices.create#ValueStatementActivity" in-map="[valueStatementId:valueStatementId,activityIdList:activityIds,organizationId:activeOrgId]" out-map="context" multi="parameter"/><default-response parameter-map="[_openDialog:_openDialog]"/><error-response url="." save-parameters="true"/></transition><transition name="getActorList"><parameter name="processStoryIds"/><actions><set field="processStoryIds" from="ec.web.getParameters().get('processStoryIds[]')?:[]"/><set field="actorList" from="[]"/><set field="allStoryActorIdSet" from="new TreeSet()"/><if condition="processStoryIds?.size() > 0"><entity-find entity-name="coarchy.ProcessStoryActivityDetail" list="psadList"><date-filter/><econdition field-name="replacedByActivityId" operator="is-null"/><econdition field-name="processStoryId" operator="in" from="processStoryIds"/><econdition field-name="storyActivityOrganizationId" from="activeOrgId"/><econdition field-name="actorId" operator="is-not-null"/><select-field field-name="processStoryId,actorId"/></entity-find><script><![CDATA[allStoryActorIdSet.addAll(psadList*.actorId)]]></script></if><entity-find entity-name="coarchy.Actor" list="actorList" limit="50"><econdition field-name="actorId" operator="in" from="allStoryActorIdSet" ignore="!processStoryIds"/><econdition field-name="name" operator="like" value="%${term}%" ignore-case="true" ignore="!term"/><order-by field-name="name"/></entity-find><script><![CDATA[def outList = []
                for (def actor in actorList)
                    outList.add([value:actor?.actorId, label:"${actor?.name}".toString()])
                ec.web.sendJsonResponse(outList)]]></script></actions><default-response type="none"/></transition><transition name="getTagList"><actions><set field="tagList" from="[]"/><if condition="term == null && tagIdList ? tagIdList?.size() > 0 : false"><then><entity-find entity-name="coarchy.Tag" list="tagList" limit="50"><econdition field-name="organizationId" from="activeOrgId"/><econdition field-name="tagId" operator="in" from="tagIdList"/><order-by field-name="description"/></entity-find></then><else><entity-find entity-name="coarchy.Tag" list="tagList" limit="50"><econdition field-name="organizationId" from="activeOrgId"/><econdition field-name="description" operator="like" value="%${term}%" ignore-case="true"/><order-by field-name="description"/></entity-find></else></if><set field="outList" from="[]"/><iterate list="tagList" entry="tag"><script><![CDATA[outList.add([value:tag.tagId, label:"${tag.description.size()>97?tag.description.take(97)+'...':tag.description}"])]]></script></iterate><script><![CDATA[ec.web.sendJsonResponse(outList)]]></script></actions><default-response type="none"/></transition><transition name="getActivityList"><parameter name="maxLabelLength"/><parameter name="excludeActivityIds"/><actions><set field="maxLabelLength" from="maxLabelLength?:97" type="Integer"/><set field="activityList" from="[]"/><if condition="term == null && activityIdList ? activityIdList?.size() > 0 : false"><then><entity-find entity-name="coarchy.Activity" list="activityList" limit="50"><econdition field-name="replacedByActivityId" operator="is-null"/><econdition field-name="activityId" operator="in" from="activityIdList"/><econdition field-name="activityId" operator="not-in" from="excludeActivityIds" ignore-if-empty="true"/><order-by field-name="action"/></entity-find></then><else><entity-find entity-name="coarchy.Activity" list="activityList" limit="50"><econdition field-name="replacedByActivityId" operator="is-null"/><econdition field-name="activityId" operator="not-in" from="excludeActivityIds" ignore-if-empty="true"/><econditions combine="or"><econdition field-name="condition" operator="like" value="%${term}%" ignore-case="true"/><econdition field-name="action" operator="like" value="%${term}%" ignore-case="true"/></econditions><order-by field-name="action"/></entity-find></else></if><set field="outList" from="[]"/><iterate list="activityList" entry="activity"><entity-find entity-name="coarchy.ActivityActorDetail" list="activityActorList"><econdition field-name="activityId" from="activity.activityId"/><order-by field-name="name"/></entity-find><set field="processStoryActivity" from="activity.getMap() + [actorNames:activityActorList*.name]"/><set field="label" from="ec.resource.template('component://coarchy/template/Activity.html.ftl', '.ftl')"/><script><![CDATA[outList.add([value:activity?.activityId, label:"${label.size()>maxLabelLength?label.take(maxLabelLength)+'...':label}"])]]></script></iterate><script><![CDATA[ec.web.sendJsonResponse(outList)]]></script></actions><default-response type="none"/></transition><transition-include name="getCloneOrganizationList" location="component://coarchy/screen/coarchy/cointernal/Home.xml"/><transition-include name="upgradeParty" location="component://coarchy/screen/coarchy/cointernal/Home.xml"/><actions><if condition="activityIdList"><entity-find entity-name="coarchy.Activity" list="headerActivityList"><econdition field-name="activityId" operator="in" from="activityIdList"/><econdition field-name="replacedByActivityId" operator="is-null"/><order-by field-name="action"/></entity-find></if><if condition="tagIdList"><entity-find entity-name="coarchy.Tag" list="headerTagList"><econdition field-name="tagId" operator="in" from="tagIdList"/><econdition field-name="organizationId" from="activeOrgId"/><order-by field-name="description"/></entity-find></if><entity-find-count entity-name="coarchy.ValueStatement" count-field="valueStatementCount"><econdition field-name="replacedByValueStatementId" operator="is-null"/></entity-find-count><entity-find-one entity-name="coarchy.ProcessStory" value-field="processStory"/></actions><widgets><section name="FreemiumBanner" condition="partyActivationCount == 0"><widgets><container type="q-banner inline-actions rounded dense" style="bg-grey-3 text-black q-mb-md"><label text="To enable all the features upgrade organization '${activeOrg.organizationName}' to Premium" type="b"/><container type="template v-slot:action"><form-single name="UpgradeForm" transition="upgradeParty"><field name="upgrade"><default-field><submit text="Upgrade" type="success" confirmation="Activating will cost 1 Organization-Month Credit per month while ${activeOrg.organizationName} is upgraded. Are you sure?"/></default-field></field></form-single></container></container></widgets></section><label text="Statements" type="h4"/><container-dialog id="CreateValueDialog" button-text="Add Statement" type="success"><form-single name="CreateValueForm" transition="createValue"><field name="value"><default-field title="Statement"><text-line/></default-field></field><field name="typeEnumId"><default-field title="Statement Type"><drop-down allow-empty="true"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="ValueType"/><order-by field-name="sequenceNum"/></entity-find></entity-options></drop-down></default-field></field><field name="tagIdList"><default-field title="Tags"><drop-down allow-empty="true" allow-multiple="true"><list-options list="statementTagList" key="${tagId}" text="${description}"/><dynamic-options server-search="true" transition="getTagList" min-length="0"/></drop-down></default-field></field><field name="submit"><default-field><submit text="Add Statement"/></default-field></field></form-single></container-dialog><container-dialog id="CreateTagDialog" button-text="New Tag" type="success"><form-single name="CreateTagForm" transition="createTag"><field name="description"><default-field title="Tag"><text-line/></default-field></field><field name="submit"><default-field><submit text="Add Tag"/></default-field></field></form-single></container-dialog><link url="../ViewValueStatements" text="View/Print Statements" tooltip="View Statements Text" btn-type="info" condition="valueStatementCount > 0"/><form-list name="ValueStatement" header-dialog="true" show-page-size="true" show-csv-button="true" list-entry="valueStatementEntry" list="valueStatementList" transition="updateValue" transition-last-row="createValue" map-last-row="[value:null,typeEnumId:null,tagIdList:null,sequenceNum:null]" select-columns="true"><entity-find entity-name="coarchy.ValueStatementAndTag" list="valueStatementList" distinct="true"><search-form-inputs default-order-by="sequenceNum,value"/><econdition field-name="disabled" value="N" or-null="true"/><econdition field-name="organizationId" from="activeOrgId"/><econdition field-name="replacedByValueStatementId" operator="is-null"/><econdition field-name="tagId" operator="in" from="tagIdList" ignore-if-empty="true"/></entity-find><row-actions><entity-find entity-name="coarchy.ValueStatementActivityDetail" list="prepValueActivityList"><date-filter/><econdition field-name="valueStatementId"/><econdition field-name="replacedByActivityId" operator="is-null"/><select-field field-name="valueStatementActivityId,activityId,name,condition,action"/><order-by field-name="action"/></entity-find><set field="activityIdList" from="prepValueActivityList*.activityId"/><entity-find entity-name="coarchy.ProcessStoryActivityDetail" list="allProcessStoryActivityList"><date-filter/><econdition field-name="activityId" operator="in" from="activityIdList"/><econdition field-name="storyOrganizationId" from="activeOrgId"/><select-field field-name="processStoryId,activityId,storyOrganizationId,name"/></entity-find><set field="valueActivityList" from="[]"/><set field="filterValueActivityList" from="[]"/><iterate list="prepValueActivityList" entry="valueActivity"><entity-find entity-name="coarchy.ActivityActorDetail" list="activityActorList"><econdition field-name="activityId" from="valueActivity.activityId"/><order-by field-name="name"/></entity-find><set field="processStoryActivity" from="valueActivity.getMap() + [actorNames:activityActorList*.name]"/><set field="label" from="ec.resource.template('component://coarchy/template/Activity.html.ftl', '.ftl')"/><script><![CDATA[valueActivityList.add([valueStatementActivityId:valueActivity.valueStatementActivityId, activityId:valueActivity?.activityId, label:"${label.size()>97?label.take(97)+'...':label}", processStoryActivity:processStoryActivity])]]></script><set field="isProcessMatch" type="Boolean" from="processStoryIds == null"/><set field="isActorMatch" type="Boolean" from="actorIds == null"/><set field="isMatch" type="Boolean" from="false"/><if condition="actorIds"><if condition="(activityActorList*.actorId).any(it->actorIds.contains(it))"><set field="isActorMatch" from="true"/></if></if><if condition="processStoryIds"><filter-map-list list="allProcessStoryActivityList" to-list="activityProcessStoryList"><field-map field-name="activityId" from="valueActivity.activityId"/></filter-map-list><if condition="activityProcessStoryList && (activityProcessStoryList*.processStoryId).any(it -> processStoryIds.split(',').contains(it))"><set field="isProcessMatch" from="true"/></if></if><set field="isMatch" from="isProcessMatch && isActorMatch"/><if condition="isMatch"><script><![CDATA[filterValueActivityList.add([valueStatementActivityId:valueActivity.valueStatementActivityId, activityId:valueActivity?.activityId, label:"${label.size()>97?label.take(97)+'...':label}", processStoryActivity:processStoryActivity])]]></script></if></iterate><entity-find entity-name="coarchy.ValueStatementTagDetail" list="statementTagList"><date-filter/><econdition field-name="valueStatementId"/><econdition field-name="organizationId" from="activeOrgId"/></entity-find><set field="tagIdList" from="statementTagList*.tagId"/><entity-find-count entity-name="coarchy.product.ProductEvaluationStatementAndDetail" count-field="existingEvaluationRecordCount"><econdition field-name="statusId" operator="not-equals" value="PeRequirementsSelection"/><econdition field-name="statementId" from="valueStatementId"/><econdition field-name="organizationId" from="activeOrgId"/></entity-find-count><set field="canCopyOnWrite" from="existingEvaluationRecordCount > 0"/></row-actions><field name="value"><header-field title="Statement" show-order-by="case-insensitive"><text-find size="30"/></header-field><default-field title="Statement"><text-area autogrow="true"/></default-field><last-row-field title="Statement"><text-area autogrow="true"/></last-row-field></field><field name="activityIdList"><default-field title="Connected Activities"><hidden/></default-field></field><field name="tagIdList"><header-field><drop-down allow-empty="true" allow-multiple="true"><list-options list="headerTagList" key="${tagId}" text="${description}"/><dynamic-options server-search="true" transition="getTagList" min-length="0"/></drop-down></header-field><default-field title="Tags"><drop-down submit-on-select="true" allow-empty="true" allow-multiple="true"><list-options list="statementTagList" key="${tagId}" text="${description}"/><dynamic-options server-search="true" transition="getTagList" min-length="0"/></drop-down></default-field><last-row-field title="Tags"><drop-down allow-empty="true" allow-multiple="true"><list-options list="statementTagList" key="${tagId}" text="${description}"/><dynamic-options server-search="true" transition="getTagList" min-length="0"/></drop-down></last-row-field></field><field name="typeEnumId"><header-field title="Statement Type" show-order-by="case-insensitive"><drop-down allow-empty="true"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="ValueType"/><order-by field-name="sequenceNum"/></entity-find></entity-options></drop-down></header-field><default-field title="Statement Type"><drop-down submit-on-select="false"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="ValueType"/><order-by field-name="sequenceNum"/></entity-find></entity-options></drop-down></default-field><last-row-field title="Statement Type"><drop-down required-manual-select="true"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="ValueType"/><order-by field-name="sequenceNum"/></entity-find></entity-options></drop-down></last-row-field></field><field name="sequenceNum"><default-field title="Priority"><text-line input-type="number" maxlength="3"/></default-field></field><field name="valueStatementId"><default-field><hidden/></default-field></field><field name="ignoreCopyOnWrite"><conditional-field title="" condition="canCopyOnWrite"><check no-current-selected-key="false"><option key="true" text="Save the changes to all existing product evaluations."/></check></conditional-field><default-field title=""><hidden/></default-field></field><field name="submit"><header-field><submit text="Submit"/></header-field><default-field><submit text="Update"/></default-field><last-row-field><submit text="Add Statement" type="success"/></last-row-field></field><field name="actions"><default-field title=""><section name="ConnectedActivitiesSection"><widgets><container-dialog id="ConnectedActivitiesDialog_${valueStatementEntry_index}" button-text="Activities"><form-single name="ConnectActivityForm" transition="addActivityToValueStatement"><field name="valueStatementId"><default-field><hidden/></default-field></field><field name="_openDialog" from="'ConnectedActivitiesDialog_'+valueStatementEntry_index"><default-field><display/></default-field></field><field name="activityIds" from="[]"><default-field title="Add An Activity"><drop-down submit-on-select="false" allow-empty="false" allow-multiple="true"><dynamic-options server-search="true" transition="getActivityList" min-length="0" parameter-map="[excludeActivityIds:valueActivityList*.activityId, maxLabelLength:80]"/></drop-down></default-field></field><field name="submit"><default-field title="Add"><submit/></default-field></field><field-layout><field-col-row><field-col sm="11"><field-ref name="activityIds"/></field-col><field-col sm="1"><field-ref name="submit"/></field-col></field-col-row></field-layout></form-single><section name="ConnectedActivitiesListSection" condition="valueActivityList"><widgets><form-single name="FilterActivityByStoryForm_${valueStatementEntry_index}" transition="refreshPageWithFilters"><field name="valueStatementId"><default-field><hidden/></default-field></field><field name="_openDialog" from="'ConnectedActivitiesDialog_'+valueStatementEntry_index"><default-field><display/></default-field></field><field name="processStoryIds" from="processStoryIds"><default-field title="Filter By Process Story"><drop-down allow-empty="true" allow-multiple="true"><list-options list="allProcessStoryActivityList" key="${processStoryId}" text="${name}"/></drop-down></default-field></field><field name="actorIds" from="actorIds"><default-field title="Filter By Actor"><drop-down allow-empty="true" allow-multiple="true"><dynamic-options transition="getActorList" min-length="0" depends-optional="true"><depends-on field="processStoryIds"/></dynamic-options></drop-down></default-field></field><field name="submit"><default-field title="Filter"><submit/></default-field></field><field-layout><field-col-row><field-col sm="6"><field-ref name="processStoryIds"/></field-col></field-col-row><field-col-row><field-col sm="6"><field-ref name="actorIds"/></field-col><field-col sm="2"><field-ref name="submit"/></field-col></field-col-row></field-layout></form-single><form-list name="ConnectedActivitiesFormList_${valueStatementEntry_index}" list="(processStoryIds||actorIds)?filterValueActivityList:valueActivityList" list-entry="valueActivityEntry"><field name="valueStatementActivityId"><default-field><hidden/></default-field></field><field name="processStoryActivity"><default-field title="Connected Activities"><render-mode><text type="html,vuet,qvt" location="component://coarchy/template/ActivityStyled.html.ftl"/></render-mode></default-field></field><field name="delete"><header-field><link url="deleteAllValueActivities" btn-type="danger" text="Remove All" tooltip="Remove all associated acitivites" parameter-map="[valueStatementId:valueStatementId, _openDialog:'ConnectedActivitiesDialog_'+valueStatementEntry_index]"/></header-field><default-field title=""><link url="deleteValueActivity" parameter-map="[valueStatementActivityId:valueStatementActivityId,_openDialog:'ConnectedActivitiesDialog_'+valueStatementEntry_index]" icon="fa fa-trash" btn-type="danger" text=" " tooltip="Remove Activity" confirmation="Remove Activity '${label}'?"/></default-field></field></form-list></widgets></section></container-dialog><link url="showValueActivityDialog" parameter-map="[valueStatementId:valueStatementId, _openDialog:'ConnectedActivitiesDialog_'+valueStatementEntry_index]" icon="fa fa-trash" btn-type="warning" text=" " tooltip="To delete this statement, you have to remove any associated activities." condition="valueActivityList?.size()>0"/><link url="deleteValue" parameter-map="[valueStatementId:valueStatementId]" icon="fa fa-trash" btn-type="danger" text=" " confirmation="Delete Statement '${value}'?" condition="!valueActivityList?.size()"/></widgets></section></default-field></field><columns><column><field-ref name="value"/><field-ref name="tagIdList"/></column><column><field-ref name="typeEnumId"/><field-ref name="ignoreCopyOnWrite"/></column><column><field-ref name="submit"/></column><column><field-ref name="actions"/></column></columns></form-list></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy/cointernal/ViewValueStatements.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="View Statements" default-menu-index="12" menu-image="/ssstatic/images/Reports.png" default-menu-include="false"><parameter name="processStoryId"/><always-actions><if condition="!activeOrgId"><message><![CDATA[Select an Organization before moving forward.]]></message><script><![CDATA[sri.sendRedirectAndStopRender('/settings/Organizations')]]></script></if><entity-find-count entity-name="mantle.party.PartyActivation" count-field="partyActivationCount"><date-filter/><econdition field-name="partyId" from="activeOrgId"/></entity-find-count></always-actions><transition-include name="getCloneOrganizationList" location="component://coarchy/screen/coarchy/cointernal/Home.xml"/><transition-include name="upgradeParty" location="component://coarchy/screen/coarchy/cointernal/Home.xml"/><actions><entity-find-one entity-name="coarchy.ProcessStory" value-field="processStory"/><entity-find entity-name="coarchy.ValueStatement" list="prepPrepValueStatementList"><econdition field-name="disabled" value="N" or-null="true"/><econdition field-name="replacedByValueStatementId" operator="is-null"/><order-by field-name="value"/></entity-find><set field="valueStatementList" from="[]"/><iterate list="prepPrepValueStatementList" entry="valueStatement"><entity-find entity-name="coarchy.ValueStatementActivityDetail" list="prepValueActivityList"><date-filter/><econdition field-name="replacedByActivityId" operator="is-null"/><econdition field-name="valueStatementId" from="valueStatement.valueStatementId"/><select-field field-name="activityId,name,condition,action"/><order-by field-name="action"/></entity-find><set field="activityIdList" from="prepValueActivityList*.activityId"/><set field="processStoryActivityList" from="[]"/><iterate list="prepValueActivityList" entry="valueActivity"><entity-find entity-name="coarchy.ActivityActorDetail" list="activityActorList"><econdition field-name="activityId" from="valueActivity.activityId"/><order-by field-name="name"/></entity-find><set field="processStoryActivity" from="valueActivity.getMap() + [actorNames:activityActorList*.name]"/><script><![CDATA[processStoryActivityList.add(processStoryActivity)]]></script></iterate><script><![CDATA[valueStatementList.add([valueStatementId:valueStatement.valueStatementId, value:valueStatement.value, processStoryActivityList:processStoryActivityList])]]></script></iterate></actions><widgets><section name="FreemiumBanner" condition="partyActivationCount == 0"><widgets><container type="q-banner inline-actions rounded dense" style="bg-grey-3 text-black q-mb-md"><label text="To enable all the features upgrade organization '${activeOrg.organizationName}' to Premium" type="b"/><container type="template v-slot:action"><form-single name="UpgradeForm" transition="upgradeParty"><field name="upgrade"><default-field><submit text="Upgrade" type="success" confirmation="Activating will cost 1 Organization-Month Credit per month while ${activeOrg.organizationName} is upgraded. Are you sure?"/></default-field></field></form-single></container></container></widgets></section><container-row><row-col md="2"/><row-col md="8"><section name="FreemiumValueStatements" condition="partyActivationCount == 0"><widgets><label text="Statements" type="h4" style="q-pb-sm"/><label text="You've found a premium feature!"/></widgets></section><section name="ViewValueStatements" condition="partyActivationCount > 0"><widgets><render-mode><text><![CDATA[<h5 v-pre>]]></text></render-mode><render-mode><text type="html,vuet,qvt" location="component://coarchy/template/Values.html.ftl"/></render-mode><render-mode><text><![CDATA[</h5>]]></text></render-mode></widgets></section></row-col><row-col md="2"/></container-row></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy/cointernal/Actor.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Actors" default-menu-index="20" menu-image="/ssstatic/images/Parties.png"><parameter name="processStoryId"/><parameter name="pageIndex" from="pageIndex?:0"/><parameter name="pageSize"/><parameter name="orderByField" value="name"/><always-actions><if condition="!activeOrgId"><message type="info"><![CDATA[Select an Organization before moving forward.]]></message><script><![CDATA[sri.sendRedirectAndStopRender('/settings/Organizations')]]></script></if><entity-find-count entity-name="mantle.party.PartyRelationship" count-field="partyRelationshipCount"><date-filter/><econdition field-name="relationshipTypeEnumId" value="PrtMember"/><econdition field-name="toRoleTypeId" value="OrgInternal"/><econdition field-name="fromPartyId" from="ec.user.userAccount.partyId"/><econdition field-name="toPartyId" from="activeOrgId"/></entity-find-count><entity-find-count entity-name="mantle.party.PartyActivation" count-field="partyActivationCount"><date-filter/><econdition field-name="partyId" from="activeOrgId"/></entity-find-count></always-actions><transition name="createActor"><condition><expression><![CDATA[partyRelationshipCount > 0]]></expression></condition><service-call name="coarchy.CoarchyServices.create#Actor" in-map="[name:name,description:description,partyIdList:partyIdList,organizationId:activeOrgId,isOwner:activeOrg.ownerPartyId==ec.user.userAccount.partyId]" out-map="context" multi="parameter"/><default-response/><error-response url="." save-parameters="true"/></transition><transition name="updateActor"><condition><expression><![CDATA[partyRelationshipCount > 0]]></expression></condition><service-call name="coarchy.CoarchyServices.update#Actor" in-map="[actorId:actorId,name:name,description:description,partyIdList:partyIdList,organizationId:activeOrgId,isOwner:activeOrg.ownerPartyId==ec.user.userAccount.partyId]" out-map="context" multi="parameter"/><default-response/><error-response url="." save-parameters="true"/></transition><transition name="deleteActor"><condition><expression><![CDATA[partyRelationshipCount > 0]]></expression></condition><actions><entity-find-count entity-name="coarchy.ActivityActor" count-field="activityActorCount"><econdition field-name="actorId"/></entity-find-count><if condition="activityActorCount > 0"><return type="warning" message="Cannot delete an Actor with Process Story Activities"/></if><service-call name="delete#coarchy.Actor" in-map="[actorId:actorId]"/></actions><default-response/></transition><transition name="getUserList"><actions><set field="userList" from="[]"/><if condition="term == null && partyIdList ? partyIdList?.size() > 0 : false"><then><entity-find entity-name="mantle.party.PartyFromAndRelationship" list="userList" distinct="true" limit="50"><econdition field-name="fromPartyId" operator="in" from="partyIdList"/><econdition field-name="toPartyId" from="activeOrgId"/><select-field field-name="fromPartyId,firstName,lastName"/><order-by field-name="-lastUpdatedStamp"/></entity-find></then><else><entity-find entity-name="mantle.party.PartyFromAndRelationship" list="userList" distinct="true" limit="50"><econditions combine="or"><econdition field-name="firstName" operator="like" value="%${term}%" ignore-case="true"/><econdition field-name="lastName" operator="like" value="%${term}%" ignore-case="true"/></econditions><econdition field-name="toPartyId" from="activeOrgId"/><select-field field-name="fromPartyId,firstName,lastName"/><order-by field-name="-lastUpdatedStamp"/></entity-find></else></if><set field="outList" from="[]"/><iterate list="userList" entry="user"><script><![CDATA[outList.add([value:user.fromPartyId, label:"${user.firstName} ${user.lastName}"])]]></script></iterate><script><![CDATA[ec.web.sendJsonResponse(outList)]]></script></actions><default-response type="none"/></transition><transition-include name="getCloneOrganizationList" location="component://coarchy/screen/coarchy/cointernal/Home.xml"/><transition-include name="upgradeParty" location="component://coarchy/screen/coarchy/cointernal/Home.xml"/><actions><entity-find-one entity-name="coarchy.ProcessStory" value-field="processStory"/><entity-find-count entity-name="coarchy.Actor" count-field="actorCount"/><entity-find entity-name="coarchy.Actor" list="preActorList"><search-form-inputs default-order-by="name"/></entity-find><set field="actorList" from="[]"/><iterate list="preActorList" entry="actor"><entity-find-count entity-name="coarchy.ActivityActor" count-field="activityCount"><econdition field-name="actorId" from="actor.actorId"/></entity-find-count><if condition="(activityCount_from==null && activityCount_thru==null)             || ((activityCount_from==null && activityCount<=activityCount_thru?.toInteger())                 || (activityCount_thru==null && activityCount_from?.toInteger()<=activityCount)                 || (activityCount<=activityCount_thru?.toInteger() && activityCount_from?.toInteger()<=activityCount))"><script><![CDATA[actorList.add(actor.getMap()+[activityCount:activityCount])]]></script></if></iterate></actions><widgets><section name="FreemiumBanner" condition="partyActivationCount == 0"><widgets><container type="q-banner inline-actions rounded dense" style="bg-grey-3 text-black q-mb-md"><label text="To enable all the features upgrade organization '${activeOrg.organizationName}' to Premium" type="b"/><container type="template v-slot:action"><form-single name="UpgradeForm" transition="upgradeParty"><field name="upgrade"><default-field><submit text="Upgrade" type="success" confirmation="Activating will cost 1 Organization-Month Credit per month while ${activeOrg.organizationName} is upgraded. Are you sure?"/></default-field></field></form-single></container></container></widgets></section><label text="Actors" type="h4"/><container-dialog id="CreateActorDialog" button-text="Add Actor" type="success"><form-single name="CreateActorForm" transition="createActor"><field name="name"><default-field><text-line/></default-field></field><field name="description"><default-field><text-area rows="2" cols="80" autogrow="true"/></default-field></field><field name="submit"><default-field><submit text="Add Actor"/></default-field></field></form-single></container-dialog><link url="../ViewActors" text="View/Print Actors" tooltip="View Actors Text" btn-type="info" condition="actorCount > 0"/><form-list name="ActorForm" header-dialog="true" show-page-size="true" select-columns="true" saved-finds="true" show-csv-button="true" list="actorList" transition="updateActor" transition-last-row="createActor" map-last-row="[name:null,description:null]"><row-actions><entity-find entity-name="coarchy.ActorParty" list="prepActorPartyList"><econdition field-name="actorId"/><order-by field-name="actorId"/></entity-find><entity-find entity-name="mantle.party.PartyFromAndRelationship" list="actorPartyList" distinct="true"><econdition field-name="fromPartyId" operator="in" from="prepActorPartyList*.partyId"/><econdition field-name="toPartyId" from="activeOrgId"/><select-field field-name="fromPartyId,firstName,lastName"/><order-by field-name="-lastUpdatedStamp"/></entity-find><set field="partyIdList" from="actorPartyList*.fromPartyId"/></row-actions><field name="name"><header-field show-order-by="case-insensitive"><text-find/></header-field><default-field><text-line/></default-field><last-row-field><text-line/></last-row-field></field><field name="description"><header-field><text-find/></header-field><default-field><text-area rows="2" cols="80" autogrow="true"/></default-field><last-row-field><text-area rows="2" cols="80" autogrow="true"/></last-row-field></field><field name="partyIdList"><header-field title="Parties"/><conditional-field condition="(partyActivationCount == 0 && activeOrg.ownerPartyId==ec.user.userAccount.partyId) || activeOrg.ownerPartyId!=ec.user.userAccount.partyId" title="${(partyActivationCount == 0 && activeOrg.ownerPartyId==ec.user.userAccount.partyId)||activeOrg.ownerPartyId!=ec.user.userAccount.partyId?'Assigned Users':''}"><render-mode><text type="html,vuet,qvt" location="component://coarchy/template/UserLinkList.html.ftl"/></render-mode></conditional-field><conditional-field condition="partyActivationCount > 0 && activeOrg.ownerPartyId==ec.user.userAccount.partyId" title="${activeOrg.ownerPartyId==ec.user.userAccount.partyId?'Assigned Users':''}"><drop-down submit-on-select="true" allow-multiple="true" allow-empty="true"><list-options list="actorPartyList" key="${fromPartyId}" text="${firstName} ${lastName}"/><dynamic-options server-search="true" transition="getUserList" min-length="0"/></drop-down></conditional-field></field><field name="actorId"><header-field title="Id"><text-find size="30"/></header-field><default-field><hidden/></default-field></field><field name="activityCount"><header-field show-order-by="true"><range-find/></header-field><default-field><display/></default-field></field><field name="submit"><header-field><submit text="Submit"/></header-field><default-field><submit text="Update"/></default-field><last-row-field><submit text="Add Actor" type="success"/></last-row-field></field><field name="delete"><default-field title=""><link url="deleteActor" parameter-map="[actorId:actorId]" icon="fa fa-trash" btn-type="danger" text=" " tooltip="Delete Actor" confirmation="Delete Actor '${name}'?"/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy/cointernal/ViewActors.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="View Actors" default-menu-index="22" menu-image="/ssstatic/images/Sales.png" default-menu-include="false"><parameter name="showActivities" from="showActivities?:'Y'"/><always-actions><if condition="!activeOrgId"><message><![CDATA[Select an Organization before moving forward.]]></message><script><![CDATA[sri.sendRedirectAndStopRender('/settings/Organizations')]]></script></if><entity-find-count entity-name="mantle.party.PartyActivation" count-field="partyActivationCount"><date-filter/><econdition field-name="partyId" from="activeOrgId"/></entity-find-count></always-actions><transition-include name="getCloneOrganizationList" location="component://coarchy/screen/coarchy/cointernal/Home.xml"/><transition-include name="upgradeParty" location="component://coarchy/screen/coarchy/cointernal/Home.xml"/><actions><entity-find-one entity-name="coarchy.ProcessStory" value-field="processStory"/><entity-find entity-name="coarchy.Actor" list="prepPrepActorList"><order-by field-name="name"/></entity-find><set field="actorList" from="[]"/><set field="hasActivities" from="false"/><iterate list="prepPrepActorList" entry="actor"><entity-find entity-name="coarchy.ActivityActorDetail" list="actorActivityList" distinct="true"><econdition field-name="actorId" from="actor.actorId"/><select-field field-name="actorId,name,description,activityId,condition,action,implementationId,"/><order-by field-name="sequenceNum"/></entity-find><set field="processStoryActivityList" from="[]"/><iterate list="actorActivityList" entry="actorActivity"><entity-find entity-name="coarchy.ActivityActorDetail" list="activityActorList"><econdition field-name="activityId" from="actorActivity.activityId"/><order-by field-name="name"/></entity-find><entity-find-one entity-name="coarchy.Activity" value-field="activity" auto-field-map="[activityId:actorActivity.activityId]"/><set field="actorActivity" from="activity.getMap() + [actorNames:activityActorList*.name]"/><script><![CDATA[processStoryActivityList.add(actorActivity)]]></script></iterate><if condition="!hasActivities && processStoryActivityList?.size() > 0"><set field="hasActivities" from="true"/></if><script><![CDATA[actorList.add([actorId:actor.actorId, name:actor.name, description:actor.description, processStoryActivityList:processStoryActivityList])]]></script></iterate></actions><widgets><section name="FreemiumBanner" condition="partyActivationCount == 0"><widgets><container type="q-banner inline-actions rounded dense" style="bg-grey-3 text-black q-mb-md"><label text="To enable all the features upgrade organization '${activeOrg.organizationName}' to Premium" type="b"/><container type="template v-slot:action"><form-single name="UpgradeForm" transition="upgradeParty"><field name="upgrade"><default-field><submit text="Upgrade" type="success" confirmation="Activating will cost 1 Organization-Month Credit per month while ${activeOrg.organizationName} is upgraded. Are you sure?"/></default-field></field></form-single></container></container></widgets></section><container-row><row-col md="2"/><row-col md="8"><label text="View Actors" type="h4" style="q-pb-md"/><link url="." text="Hide Activities" parameter-map="[showActivities:'N']" btn-type="success" condition="showActivities == 'Y' && partyActivationCount > 0 && hasActivities"/><link url="." text="Show Activities" parameter-map="[showActivities:'Y']" btn-type="success" condition="showActivities != 'Y' && partyActivationCount > 0 && hasActivities"/><render-mode><text><![CDATA[<h5 v-pre>]]></text></render-mode><render-mode><text type="html,vuet,qvt" location="component://coarchy/template/Actors.html.ftl"/></render-mode><render-mode><text><![CDATA[</h5>]]></text></render-mode></row-col><row-col md="2"/></container-row></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy/cointernal/Process/FindProcessStory.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Find" default-menu-index="10" menu-image="fa fa-search" menu-image-type="icon" default-menu-include="false"><always-actions><if condition="!activeOrgId"><message><![CDATA[${ec.resource.expand('CoarchySelectAnOrg', null)}]]></message><script><![CDATA[sri.sendRedirectAndStopRender('/settings/Organizations')]]></script></if><entity-find-count entity-name="mantle.party.PartyRelationship" count-field="partyRelationshipCount"><date-filter/><econdition field-name="relationshipTypeEnumId" value="PrtMember"/><econdition field-name="toRoleTypeId" value="OrgInternal"/><econdition field-name="fromPartyId" from="ec.user.userAccount.partyId"/><econdition field-name="toPartyId" from="activeOrgId"/></entity-find-count></always-actions><transition name="createProcessStory"><condition><expression><![CDATA[partyRelationshipCount > 0]]></expression></condition><service-call name="coarchy.CoarchyServices.create#ProcessStory" in-map="[name:name,organizationId:activeOrgId]" out-map="context" multi="parameter"/><default-response/></transition><actions><if condition="disabled==null"><set field="disabled" from="'N'"/></if><entity-find entity-name="coarchy.ProcessStoryActivityAndDetail" list="processStoryInputList" distinct="true"><econdition field-name="name" operator="like" value="%${name}%" ignore-case="true" ignore="!name"/><econdition field-name="organizationId" from="activeOrgId"/><select-field field-name="processStoryId,detailProcessStoryId,detail2ProcessStoryId,detail3ProcessStoryId,                 name,detailName,detail2Name,detail3Name,disabled"/></entity-find><script><![CDATA[// Function to validate parent hierarchy before adding to sorted list
            def isValidParentHierarchy(story, currentBranch) {
                if (story.detailProcessStoryId != currentBranch.processStoryId) return false
                if (story.detail2ProcessStoryId != null &&
                        story.detail2ProcessStoryId != currentBranch.detailProcessStoryId) return false
                if (story.detail3ProcessStoryId != null &&
                        story.detail3ProcessStoryId != currentBranch.detail2ProcessStoryId) return false
                return true
            }

            // Function to find and sort children recursively
            def sortProcessStories(processStories, currentBranch) {
                def sortedStories = []
                processStories.findAll { isValidParentHierarchy(it, currentBranch) }.sort { it.name }.each { story ->
//                    ec.logger.warn("story: ${story}")
                    if (story.disabled == disabled) sortedStories.add(story)
                    sortedStories.addAll(sortProcessStories(processStories, story))
                }
                return sortedStories
            }
            def rootBranch = [processStoryId: null, detailProcessStoryId: null, detail2ProcessStoryId: null, detail3ProcessStoryId: null]]]></script><set field="processStoryList" from="sortProcessStories(processStoryInputList, rootBranch)"/></actions><widgets><label text="Find Process Story" type="h4"/><container-dialog id="CreateProcessStoryDialogue" button-text="Add Process Story" type="success" condition="partyRelationshipCount > 0"><form-single name="CreateProcessStory" transition="createProcessStory"><field name="name"><default-field><text-line/></default-field></field><field name="submit"><default-field><submit text="Add Process Story"/></default-field></field></form-single></container-dialog><form-list name="ProcessStory" header-dialog="true" show-page-size="true" list="processStoryList" transition-last-row="createProcessStory"><field name="name"><header-field><text-line/></header-field><default-field title="Process Story Name"><link url="../EditProcessStoryV3" link-type="anchor" parameter-map="[processStoryId:processStoryId]" text="${detail3ProcessStoryId?detail3Name+' - ':''}${detail2ProcessStoryId?detail2Name+' - ':''}${detailProcessStoryId?detailName+' - ':''}${name}"/></default-field></field><field name="disabled"><header-field title="Hidden"><drop-down><option key="Y"/><option key="N"/></drop-down></header-field><default-field><hidden/></default-field></field><field name="submit"><header-field><submit/></header-field></field></form-list></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy/cointernal/Process/EditProcessStoryV3.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Edit" default-menu-index="20" menu-image="fa fa-file" menu-image-type="icon" render-modes="vue,qvue"><parameter name="processStoryId"/><parameter name="pageIndex" from="pageIndex?:0"/><parameter name="pageSize" from="pageSize?:50"/><always-actions><if condition="!activeOrgId"><message><![CDATA[${ec.resource.expand('CoarchySelectAnOrg', null)}]]></message><script><![CDATA[sri.sendRedirectAndStopRender('/settings/Organizations')]]></script></if><entity-find-count entity-name="mantle.party.PartyRelationship" count-field="partyRelationshipCount"><date-filter/><econdition field-name="relationshipTypeEnumId" value="PrtMember"/><econdition field-name="toRoleTypeId" value="OrgInternal"/><econdition field-name="fromPartyId" from="ec.user.userAccount.partyId"/><econdition field-name="toPartyId" from="activeOrgId"/></entity-find-count><entity-find-count entity-name="mantle.party.PartyActivation" count-field="partyActivationCount"><date-filter/><econdition field-name="partyId" from="activeOrgId"/></entity-find-count></always-actions><transition-include name="getCloneOrganizationList" location="component://coarchy/screen/coarchy/cointernal/Process/ProcessStory.xml"/><transition-include name="getProcessStoryList" location="component://coarchy/screen/coarchy/cointernal/Process/ProcessStory.xml"/><transition-include name="getActivityList" location="component://coarchy/screen/coarchy/cointernal/Process/ProcessStory.xml"/><transition-include name="createActivity" location="component://coarchy/screen/coarchy/cointernal/Process/ProcessStory.xml"/><transition-include name="updateActivity" location="component://coarchy/screen/coarchy/cointernal/Process/ProcessStory.xml"/><transition-include name="deleteActivity" location="component://coarchy/screen/coarchy/cointernal/Process/ProcessStory.xml"/><transition-include name="copyActivities" location="component://coarchy/screen/coarchy/cointernal/Process/ProcessStory.xml"/><transition-include name="deleteActivities" location="component://coarchy/screen/coarchy/cointernal/Process/ProcessStory.xml"/><transition-include name="getActorList" location="component://coarchy/screen/coarchy/cointernal/Process/ProcessStory.xml"/><transition-include name="updateProcessStory" location="component://coarchy/screen/coarchy/cointernal/Process/ProcessStory.xml"/><transition-include name="enableProcessStory" location="component://coarchy/screen/coarchy/cointernal/Process/ProcessStory.xml"/><transition-include name="disableProcessStory" location="component://coarchy/screen/coarchy/cointernal/Process/ProcessStory.xml"/><transition-include name="createChecklist" location="component://coarchy/screen/coarchy/cointernal/Process/ProcessStory.xml"/><transition-include name="getValueList" location="component://coarchy/screen/coarchy/cointernal/Process/ProcessStory/ManageValues.xml"/><transition name="goProcessStory"><default-response url="../EditProcessStoryV3" parameter-map="[processStoryId:processStoryId]"/></transition><transition-include name="createActor" location="component://coarchy/screen/coarchy/cointernal/Actor.xml"/><transition-include name="getCloneOrganizationList" location="component://coarchy/screen/coarchy/cointernal/Home.xml"/><transition-include name="upgradeParty" location="component://coarchy/screen/coarchy/cointernal/Home.xml"/><transition name="getUserOrgMembership"><actions><script><![CDATA[ec.web.sendJsonResponse([organizationName:activeOrg.organizationName, isUserOrgMember:partyRelationshipCount > 0, isOrgPremium:partyActivationCount > 0])]]></script></actions><default-response type="none"/></transition><transition name="getClipboard"><actions><if condition="!partyRelationshipCount"><script><![CDATA[ec.web.sendJsonResponse([])]]></script></if><entity-find entity-name="coarchy.ClipboardEntry" list="clipboardEntryList"><econdition field-name="partyId" from="ec.user.userAccount?.partyId"/><order-by field-name="-entryDate"/></entity-find><set field="outList" from="[]"/><iterate list="clipboardEntryList" entry="clipboardEntry"><service-call name="coarchy.CoarchyServices.get#ClipboardActivityAndCount" in-map="[clipboardEntryId:clipboardEntry.clipboardEntryId]" out-map="clipboardOut" out-map-add-to-existing="false"/><script><![CDATA[outList.add(clipboardEntry.getMap()+clipboardOut)]]></script></iterate><script><![CDATA[ec.web.sendJsonResponse(outList)]]></script></actions><default-response type="none"/></transition><transition name="newParagraph"><condition><expression><![CDATA[partyRelationshipCount > 0]]></expression></condition><actions><service-call name="create#coarchy.Activity" in-map="[organizationId:activeOrgId]" out-map="newActivity"/><entity-find entity-name="coarchy.ProcessStoryActivity" limit="1" list="processStoryInitialActivityList"><date-filter/><econdition field-name="sequenceNum" from="insertSequenceNum.toInteger()"/><order-by field-name="-sequenceNum"/></entity-find><if condition="processStoryInitialActivityList?.size() > 0"><entity-find entity-name="coarchy.ProcessStoryActivityDetail" list="processStoryActivityList"><date-filter/><econdition field-name="replacedByActivityId" operator="is-null"/><econdition field-name="sequenceNum" operator="greater-equals" from="insertSequenceNum.toInteger()"/><select-field field-name="processStoryActivityId,sequenceNum"/><order-by field-name="-sequenceNum"/></entity-find><iterate list="processStoryActivityList" entry="processStoryActivity"><service-call name="update#coarchy.ProcessStoryActivity" in-map="[processStoryActivityId:processStoryActivity.processStoryActivityId,sequenceNum:processStoryActivity.sequenceNum+1]"/></iterate></if><service-call name="create#coarchy.ProcessStoryActivity" in-map="[processStoryId:processStoryId,activityId:newActivity.activityId, sequenceNum:insertSequenceNum, organizationId:activeOrgId]"/><script><![CDATA[ec.web.sendJsonResponse([activityId:newActivity.activityId])]]></script></actions><default-response type="none"/></transition><transition name="pasteActivity"><condition><expression><![CDATA[partyRelationshipCount > 0]]></expression></condition><service-call name="coarchy.CoarchyServices.paste#Activities" in-map="context+[organizationId:activeOrgId]" out-map="context" multi="parameter"/><default-response url=".." parameter-map="[pageIndex:pageIndex]"/></transition><transition name="moveActivityTo"><parameter name="processStoryActivityId"/><parameter name="newSequenceNum"/><condition><expression><![CDATA[partyRelationshipCount > 0]]></expression></condition><actions><entity-find-one entity-name="coarchy.ProcessStoryActivity" value-field="processStoryActivity"><field-map field-name="processStoryActivityId"/></entity-find-one><set field="processStoryId" from="processStoryActivity?.processStoryId"/><if condition="!processStoryId"><return error="true" message="${ec.resource.expand('CoarchyProcessActivityMoveError', null)}"/></if><entity-find entity-name="coarchy.ProcessStoryActivityDetail" list="processStoryActivityList" distinct="true"><date-filter/><econdition field-name="processStoryId"/><econdition field-name="replacedByActivityId" operator="is-null"/><select-field field-name="processStoryActivityId,activityId,sequenceNum"/><order-by field-name="sequenceNum"/></entity-find><set field="newSequenceNum" type="Integer" from="newSequenceNum?:1"/><set field="sequenceNumIdx" from="1"/><iterate list="processStoryActivityList" entry="pSA"><if condition="(sequenceNumIdx == newSequenceNum) && (pSA.processStoryActivityId != processStoryActivityId)"><set field="sequenceNumIdx" from="sequenceNumIdx + 1"/></if><if condition="(pSA.processStoryActivityId == processStoryActivityId)"><service-call name="update#coarchy.ProcessStoryActivity" in-map="[processStoryActivityId:pSA.processStoryActivityId,sequenceNum:newSequenceNum]"/><continue/></if><service-call name="update#coarchy.ProcessStoryActivity" in-map="[processStoryActivityId:pSA.processStoryActivityId,sequenceNum:sequenceNumIdx]"/><set field="sequenceNumIdx" from="sequenceNumIdx + 1"/></iterate></actions><default-response url="." parameter-map="[pageIndex:pageIndex]"/></transition><transition name="getProcessStoryDetail" read-only="true"><parameter name="processStoryId"/><parameter name="pageSize"/><parameter name="pageIndex"/><actions><entity-find-one entity-name="coarchy.ProcessStory" value-field="processStory"><field-map field-name="processStoryId"/></entity-find-one><if condition="!processStory"><return error="true" message="Process story not found"/></if><entity-find entity-name="coarchy.ProcessStoryActivityDetail" list="detailActivityList"><date-filter/><econdition field-name="replacedByActivityId" operator="is-null"/><econdition field-name="detailProcessStoryId" from="processStoryId"/><select-field field-name="processStoryId,name"/><order-by field-name="-lastUpdatedStamp"/></entity-find><entity-find entity-name="coarchy.ProcessStoryActivityDetail" list="processStoryActivityList" distinct="true"><search-form-inputs default-order-by="sequenceNum,action"/><date-filter/><econdition field-name="replacedByActivityId" operator="is-null"/><econdition field-name="processStoryId"/><econdition field-name="actorId" operator="in" from="actorIdList" ignore-if-empty="true"/><select-field field-name="processStoryActivityId,sequenceNum,detailProcessStoryId,action,condition,activityId,implementationId"/></entity-find><set field="processStoryActivityWithActors" from="[]"/><iterate list="processStoryActivityList" entry="processStoryActivity"><entity-find entity-name="coarchy.ActivityActorDetail" list="activityActorList"><econdition field-name="activityId" from="processStoryActivity.activityId"/><order-by field-name="name"/></entity-find><entity-find-count entity-name="coarchy.product.ProductEvaluationActivityAndDetail" count-field="existingEvaluationRecordCount"><econdition field-name="statusId" operator="not-equals" value="PeRequirementsSelection"/><econdition field-name="activityId" from="processStoryActivity.activityId"/><econdition field-name="excludeFlag" value="N" or-null="true"/><econdition field-name="organizationId" from="activeOrgId"/></entity-find-count><script><![CDATA[processStoryActivityWithActors.add(processStoryActivity.getMap()+[actors:activityActorList,actorNames:activityActorList*.name,willCopyOnWrite:existingEvaluationRecordCount>0])]]></script></iterate><script><![CDATA[ec.web.sendJsonResponse([
                    processStory: processStory,
                    detailActivityList:detailActivityList,
                    processStoryActivityList:processStoryActivityWithActors
                ])]]></script></actions><default-response type="none"/><error-response url=".."/></transition><transition name="getDeletedActivities" read-only="true"><parameter name="processStoryId"/><actions><if condition="!partyRelationshipCount || !partyActivationCount"><script><![CDATA[ec.web.sendJsonResponse([
                        processStory: null,
                        processStoryActivityList: []
                    ])]]></script></if><entity-find-one entity-name="coarchy.ProcessStory" value-field="processStory"><field-map field-name="processStoryId"/></entity-find-one><entity-find entity-name="coarchy.ProcessStoryActivityDetail" list="processStoryActivityList" distinct="true"><search-form-inputs default-order-by="sequenceNum,action"/><econdition field-name="thruDate" operator="less-equals" from="ec.user.nowTimestamp"/><econdition field-name="replacedByActivityId" operator="is-null"/><econdition field-name="processStoryId"/><econdition field-name="actorId" operator="in" from="actorIdList" ignore-if-empty="true"/><econditions combine="or"><econdition field-name="condition" operator="is-not-null"/><econdition field-name="action" operator="is-not-null"/><econdition field-name="actorId" operator="is-not-null"/></econditions><select-field field-name="processStoryActivityId,sequenceNum,detailProcessStoryId,action,condition,activityId,implementationId"/></entity-find><set field="processStoryActivityWithActors" from="[]"/><iterate list="processStoryActivityList" entry="processStoryActivity"><entity-find entity-name="coarchy.ActivityActorDetail" list="activityActorList"><econdition field-name="activityId" from="processStoryActivity.activityId"/><order-by field-name="name"/></entity-find><script><![CDATA[processStoryActivityWithActors.add(processStoryActivity.getMap()+[actors:activityActorList,actorNames:activityActorList*.name])]]></script></iterate><script><![CDATA[ec.web.sendJsonResponse([
                    processStory: processStory,
                    processStoryActivityList:processStoryActivityWithActors
                ])]]></script></actions><default-response type="none"/></transition><transition name="restoreActivity"><parameter name="processStoryActivityId"/><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><actions><entity-find entity-name="coarchy.ProcessStoryActivityDetail" list="processStoryActivityList" distinct="true"><search-form-inputs default-order-by="sequenceNum,action"/><econdition field-name="processStoryActivityId"/><econdition field-name="thruDate" operator="less-equals" from="ec.user.nowTimestamp"/><econdition field-name="replacedByActivityId" operator="is-null"/><select-field field-name="processStoryActivityId,sequenceNum,detailProcessStoryId,action,condition,activityId,implementationId"/><order-by field-name="-thruDate"/></entity-find><if condition="processStoryActivityList"><set field="processStoryActivity" from="processStoryActivityList[0]"/><service-call name="update#coarchy.ProcessStoryActivity" in-map="[processStoryActivityId:processStoryActivity.processStoryActivityId, thruDate:null]"/></if><script><![CDATA[ec.web.sendJsonResponse([
                    success: processStoryActivityList.size() > 0
                ])]]></script></actions><default-response type="none"/></transition><transition name="createActivityValue"><parameter name="activityId"/><parameter name="valueIdList"/><condition><expression><![CDATA[partyRelationshipCount > 0]]></expression></condition><actions><set field="valueIdList" from="valueIdList?:ec.web.getParameters().get('valueIdList[]')?:[]"/><service-call name="coarchy.CoarchyServices.create#ActivityValue" in-map="[activityId:activityId,valueIdList:valueIdList,organizationId:activeOrgId]"/><script><![CDATA[ec.web.sendJsonResponse([
                    success: true
                ])]]></script></actions><default-response type="none"/></transition><transition name="deleteValueStatementActivity"><parameter name="valueStatementActivityId"/><condition><expression><![CDATA[partyRelationshipCount > 0]]></expression></condition><actions><service-call name="update#coarchy.ValueStatementActivity" in-map="[valueStatementActivityId:valueStatementActivityId, thruDate:ec.user.nowTimestamp, organizationId:activeOrgId]"/><script><![CDATA[ec.web.sendJsonResponse([
                    success: true
                ])]]></script></actions><default-response type="none"/></transition><transition name="deleteAllValueStatementActivities"><parameter name="activityId"/><condition><expression><![CDATA[partyRelationshipCount > 0]]></expression></condition><actions><entity-find entity-name="coarchy.ValueStatementActivity" list="valueActivities"><date-filter/><econdition field-name="activityId" from="activityId"/><econdition field-name="organizationId" from="activeOrgId"/></entity-find><iterate list="valueActivities" entry="valueActivity"><service-call name="update#coarchy.ValueStatementActivity" in-map="[valueStatementActivityId:valueActivity.valueStatementActivityId, thruDate:ec.user.nowTimestamp, organizationId:activeOrgId]"/></iterate><script><![CDATA[ec.web.sendJsonResponse([
                    success: true
                ])]]></script></actions><default-response type="none"/></transition><transition name="getActivityStatementList" read-only="true"><parameter name="activityId"/><condition><expression><![CDATA[partyRelationshipCount > 0]]></expression></condition><actions><entity-find entity-name="coarchy.ValueStatementActivityDetail" list="prepValueActivityList"><date-filter/><econdition field-name="disabled" value="N" or-null="true"/><econdition field-name="activityId" from="activityId"/><select-field field-name="valueStatementActivityId,valueStatementId,value"/><order-by field-name="^value"/></entity-find><set field="valueIdList" from="prepValueActivityList*.valueStatementId"/><set field="valueActivityList" from="[]"/><iterate list="prepValueActivityList" entry="valueActivity"><script><![CDATA[valueActivityList.add([valueStatementId:valueActivity?.valueStatementId, valueStatementActivityId:valueActivity?.valueStatementActivityId, value:(valueActivity?.value&&valueActivity.value.size()>79)?valueActivity.value.take(79)+"...":valueActivity.value, valueFull:valueActivity.value])]]></script></iterate><script><![CDATA[ec.web.sendJsonResponse(valueActivityList)]]></script></actions><default-response type="none"/></transition><actions/><widgets><render-mode><text type="qvue,js" location="component://coarchy/template/EditProcessStory.qvue"/></render-mode></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy/cointernal/Process/ViewProcessStory.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="View" default-menu-index="30" menu-image="fa fa-align-left" menu-image-type="icon"><parameter name="processStoryId" required="true"/><parameter name="showSubstories" from="showSubstories?:'Y'"/><always-actions><if condition="!activeOrgId"><message><![CDATA[${ec.resource.expand('CoarchySelectAnOrg', null)}]]></message><script><![CDATA[sri.sendRedirectAndStopRender('/settings/Organizations')]]></script></if><entity-find-count entity-name="mantle.party.PartyRelationship" count-field="partyRelationshipCount"><date-filter/><econdition field-name="relationshipTypeEnumId" value="PrtMember"/><econdition field-name="toRoleTypeId" value="OrgInternal"/><econdition field-name="fromPartyId" from="ec.user.userAccount.partyId"/><econdition field-name="toPartyId" from="activeOrgId"/></entity-find-count><entity-find-count entity-name="mantle.party.PartyActivation" count-field="partyActivationCount"><date-filter/><econdition field-name="partyId" from="activeOrgId"/></entity-find-count></always-actions><transition-include name="getCloneOrganizationList" location="component://coarchy/screen/coarchy/cointernal/Home.xml"/><transition-include name="upgradeParty" location="component://coarchy/screen/coarchy/cointernal/Home.xml"/><actions><entity-find-one entity-name="coarchy.ProcessStory" value-field="processStory" auto-field-map="[processStoryId:processStoryId]"/><service-call name="coarchy.CoarchyServices.find#ProcessStoryActivityList" in-map="[processStoryId:processStoryId,             showSubstories:partyActivationCount==0?'N':showSubstories,organizationId:activeOrgId]" out-map="context"/><set field="hasSubstories" from="processStoryActivityList*.detailProcessStoryId.any{ it != null }"/><set field="showSubstoriesActual" from="partyActivationCount!=0 && showSubstories=='Y' && hasSubstories"/></actions><widgets><section name="FreemiumBanner" condition="partyActivationCount == 0"><widgets><container type="q-banner inline-actions rounded dense" style="bg-grey-3 text-black q-mb-md"><label text="To enable all the features upgrade organization '${activeOrg.organizationName}' to Premium" type="b"/><container type="template v-slot:action"><form-single name="UpgradeForm" transition="upgradeParty"><field name="upgrade"><default-field><submit text="Upgrade" type="success" confirmation="Activating will cost 1 Organization-Month Credit per month while ${activeOrg.organizationName} is upgraded. Are you sure?"/></default-field></field></form-single></container></container></widgets></section><container-row><row-col md="2"/><row-col md="8"><label text="${processStory?.name?processStory?.name+' Story':'View Process Story'}" type="h4"/><link url="." text="Hide Substories" parameter-map="[showSubstories:'N']" btn-type="success" condition="showSubstories == 'Y' && partyActivationCount > 0 && hasSubstories"/><link url="." text="Show Substories" parameter-map="[showSubstories:'Y']" btn-type="success" condition="showSubstories != 'Y' && partyActivationCount > 0 && hasSubstories"/><link url="../EditProcessStoryV3" text="Go Back to Process Story" parameter-map="[processStoryId:processStoryId]"/><render-mode><text><![CDATA[<h5 v-pre>]]></text></render-mode><render-mode><text type="html,vuet,qvt" location="component://coarchy/template/ProcessStory.html.ftl"/></render-mode><render-mode><text><![CDATA[</h5>]]></text></render-mode></row-col><row-col md="2"/></container-row></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy/cointernal/Process/ViewProcessStoryOutline.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Outline View" default-menu-index="35" menu-image="fa fa-align-left" menu-image-type="icon"><parameter name="processStoryId" required="true"/><parameter name="showSubstories" from="showSubstories?:'Y'"/><always-actions><if condition="!activeOrgId"><message><![CDATA[${ec.resource.expand('CoarchySelectAnOrg', null)}]]></message><script><![CDATA[sri.sendRedirectAndStopRender('/settings/Organizations')]]></script></if><entity-find-count entity-name="mantle.party.PartyRelationship" count-field="partyRelationshipCount"><date-filter/><econdition field-name="relationshipTypeEnumId" value="PrtMember"/><econdition field-name="toRoleTypeId" value="OrgInternal"/><econdition field-name="fromPartyId" from="ec.user.userAccount.partyId"/><econdition field-name="toPartyId" from="activeOrgId"/></entity-find-count><entity-find-count entity-name="mantle.party.PartyActivation" count-field="partyActivationCount"><date-filter/><econdition field-name="partyId" from="activeOrgId"/></entity-find-count></always-actions><transition-include name="getCloneOrganizationList" location="component://coarchy/screen/coarchy/cointernal/Home.xml"/><transition-include name="upgradeParty" location="component://coarchy/screen/coarchy/cointernal/Home.xml"/><actions><entity-find-one entity-name="coarchy.ProcessStory" value-field="processStory" auto-field-map="[processStoryId:processStoryId]"/><service-call name="coarchy.CoarchyServices.find#ProcessStoryActivityList" in-map="[processStoryId:processStoryId,             showSubstories:partyActivationCount==0?'N':showSubstories,organizationId:activeOrgId]" out-map="context"/><set field="hasSubstories" from="processStoryActivityList*.detailProcessStoryId.any{ it != null }"/><set field="showSubstoriesActual" from="partyActivationCount!=0 && showSubstories=='Y' && hasSubstories"/></actions><widgets><section name="FreemiumBanner" condition="partyActivationCount == 0"><widgets><container type="q-banner inline-actions rounded dense" style="bg-grey-3 text-black q-mb-md"><label text="To enable all the features upgrade organization '${activeOrg.organizationName}' to Premium" type="b"/><container type="template v-slot:action"><form-single name="UpgradeForm" transition="upgradeParty"><field name="upgrade"><default-field><submit text="Upgrade" type="success" confirmation="Activating will cost 1 Organization-Month Credit per month while ${activeOrg.organizationName} is upgraded. Are you sure?"/></default-field></field></form-single></container></container></widgets></section><container-row><row-col md="2"/><row-col md="8"><label text="${processStory?.name?processStory?.name+' Story':'View Process Story'}" type="h4"/><link url="." text="Hide Substories" parameter-map="[showSubstories:'N']" btn-type="success" condition="showSubstories == 'Y' && partyActivationCount > 0 && hasSubstories"/><link url="." text="Show Substories" parameter-map="[showSubstories:'Y']" btn-type="success" condition="showSubstories != 'Y' && partyActivationCount > 0 && hasSubstories"/><link url="../EditProcessStoryV3" text="Go Back to Process Story" parameter-map="[processStoryId:processStoryId]"/><render-mode><text><![CDATA[<h5 v-pre>]]></text></render-mode><render-mode><text type="html,vuet,qvt" location="component://coarchy/template/ProcessStoryOutline.html.ftl"/></render-mode><render-mode><text><![CDATA[</h5>]]></text></render-mode></row-col><row-col md="2"/></container-row></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy/cointernal/Process/ProcessStory/CreateOrSelectSubstory.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><transition name="createSubstory"><condition><expression><![CDATA[partyRelationshipCount > 0]]></expression></condition><actions><service-call name="coarchy.CoarchyServices.create#ProcessStory" in-map="[name:name,organizationId:activeOrgId]" out-map="newStory"/><service-call name="update#coarchy.ProcessStoryActivity" in-map="[processStoryActivityId:processStoryActivityId,detailProcessStoryId:newStory.processStoryId]"/></actions><default-response url="../../ProcessStory" parameter-map="[processStoryId:newStory.processStoryId]"/><error-response url="."/></transition><transition name="selectSubstory"><condition><expression><![CDATA[partyRelationshipCount > 0]]></expression></condition><actions><service-call name="update#coarchy.ProcessStoryActivity" in-map="[processStoryActivityId:processStoryActivityId,detailProcessStoryId:detailProcessStoryId]"/></actions><default-response url="../../ProcessStory" parameter-map="[processStoryId:detailProcessStoryId]"/><error-response url="."/></transition><actions><entity-find-one entity-name="coarchy.ProcessStoryActivityDetail" value-field="processStoryActivityEntity" auto-field-map="[processStoryActivityId:processStoryActivityId]"/><entity-find entity-name="coarchy.ActivityActorDetail" list="activityActorList"><econdition field-name="activityId" from="processStoryActivityEntity.activityId"/><order-by field-name="name"/></entity-find><set field="processStoryActivity" from="processStoryActivityEntity.getMap() + [actorNames:activityActorList*.name]"/><entity-find entity-name="coarchy.ProcessStoryActivityDetail" list="processStoryList" distinct="true"><date-filter/><econdition field-name="detailProcessStoryId" operator="is-not-null"/><econdition field-name="disabled" value="N"/><select-field field-name="processStoryId"/></entity-find><set field="processStoryIdList" from="processStoryList*.processStoryId" type="List"/></actions><widgets><container-box><box-header title="Create New Substory"/><box-body><form-single name="CreateSubstory" transition="createSubstory"><field name="processStoryActivityId"><default-field><hidden/></default-field></field><field name="name"><default-field title="New Substory Name"><text-line default-value="${ec.resource.template('component://coarchy/template/Activity.html.ftl', '.ftl')}"/></default-field></field><field name="create"><default-field><submit/></default-field></field></form-single></box-body></container-box><container-box><box-header title="Select Existing Substory"/><box-body><form-single name="SelectSubstory" transition="selectSubstory"><field name="processStoryActivityId"><default-field><hidden/></default-field></field><field name="detailProcessStoryId"><default-field title="Select Story"><drop-down submit-on-select="true" required-manual-select="true"><entity-options text="${name}" key="${processStoryId}"><entity-find entity-name="coarchy.ProcessStory" list="processStoryList" limit="20"><econdition field-name="disabled" value="N"/><econdition field-name="processStoryId" operator="not-in" from="processStoryIdList + [processStoryId]"/><select-field field-name="name,processStoryId"/><order-by field-name="name"/></entity-find></entity-options></drop-down></default-field></field></form-single></box-body></container-box></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy/cointernal/Process/ProcessStory/InsertActivity.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="pageIndex"/><parameter name="pageSize"/><parameter name="orderByField"/><parameter name="isEmptyStory"/><transition-include name="getActorList" location="component://coarchy/screen/coarchy/cointernal/Process/ProcessStory.xml"/><transition name="insertActivity"><service-call name="coarchy.CoarchyServices.insert#Activity" in-map="context + [organizationId:activeOrgId]" out-map="context" multi="parameter"/><default-response url=".." parameter-map="[pageIndex:pageIndex]"/><error-response type="none"/></transition><transition name="insertParagraphBreak"><actions><set field="insertSequenceNum" from="sequenceNum"/><if condition="insertType=='below'"><set field="pageIndex" from="downPageIndex"/><entity-find entity-name="coarchy.ProcessStoryActivityDetail" list="processStoryActivityMaxList" limit="1"><date-filter/><econdition field-name="replacedByActivityId" operator="is-null"/><econdition field-name="sequenceNum" operator="greater" from="sequenceNum.toInteger()"/><select-field field-name="processStoryActivityId,sequenceNum"/><order-by field-name="sequenceNum"/></entity-find><set field="insertSequenceNum" from="processStoryActivityMaxList?.getFirst()?.sequenceNum?:insertSequenceNum.toInteger()+1"/></if><entity-find entity-name="coarchy.ProcessStoryActivityDetail" list="processStoryActivityList"><date-filter/><econdition field-name="replacedByActivityId" operator="is-null"/><econdition field-name="sequenceNum" operator="greater-equals" from="insertSequenceNum.toInteger()"/><select-field field-name="processStoryActivityId,sequenceNum"/><order-by field-name="-sequenceNum"/></entity-find><iterate list="processStoryActivityList" entry="processStoryActivity"><service-call name="update#coarchy.ProcessStoryActivity" in-map="[processStoryActivityId:processStoryActivity.processStoryActivityId,sequenceNum:processStoryActivity.sequenceNum+1]"/></iterate><service-call name="create#coarchy.Activity" in-map="[organizationId:activeOrgId]" out-map="newActivity"/><service-call name="create#coarchy.ProcessStoryActivity" in-map="[processStoryId:processStoryId,activityId:newActivity.activityId, sequenceNum:insertSequenceNum, fromDate:ec.user.nowTimestamp, organizationId:activeOrgId]"/></actions><default-response url=".." parameter-map="[pageIndex:pageIndex]"/><error-response type="none"/></transition><transition name="pasteActivities"><service-call name="coarchy.CoarchyServices.paste#Activities" in-map="[pageIndex:pageIndex,insertType:insertType,             downPageIndex:downPageIndex,processStoryId:processStoryId,sequenceNum:sequenceNum,organizationId:activeOrgId,             clipboardEntryId:clipboardEntryId]" out-map="context" multi="parameter"/><default-response url=".." parameter-map="[pageIndex:pageIndex]"/></transition><actions><entity-find entity-name="coarchy.ClipboardEntry" list="entryList" limit="5"><econdition field-name="partyId" from="ec.user.userAccount?.partyId"/><order-by field-name="-entryDate"/></entity-find></actions><widgets><container-box><box-header title="Insert New Activity"/><box-body><form-single name="InsertActivity" transition="insertActivity"><field name="pageIndex"><default-field><hidden/></default-field></field><field name="downPageIndex"><default-field><hidden/></default-field></field><field name="processStoryId"><default-field><hidden/></default-field></field><field name="sequenceNum"><default-field><hidden/></default-field></field><field name="implementationId"><default-field title="Implementation Status"><drop-down allow-empty="true"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="ActivityImplementation"/><order-by field-name="sequenceNum"/></entity-find></entity-options></drop-down></default-field></field><field name="condition"><default-field title="Condition (optional)"><text-area rows="2" autogrow="true"/></default-field></field><field name="actorIdList"><default-field title="Actor"><drop-down allow-empty="true" allow-multiple="true"><list-options list="activityActorList" key="${actorId}" text="${name}"/><dynamic-options server-search="true" transition="getActorList" min-length="0"/></drop-down></default-field></field><field name="action"><default-field title="Action"><text-area rows="2" autogrow="true"/></default-field></field><field name="insertType" from="'below'"><default-field><radio><option key="above" text="Above"/><option key="below" text="Below"/></radio></default-field></field><field name="submit"><default-field><submit text="Add Activity" type="success"/></default-field></field></form-single></box-body></container-box><container-box><box-header title="Insert Paragraph Break"/><box-body><form-single name="InsertParagraphBreak" transition="insertParagraphBreak"><field name="pageIndex"><default-field><hidden/></default-field></field><field name="downPageIndex"><default-field><hidden/></default-field></field><field name="processStoryId"><default-field><hidden/></default-field></field><field name="sequenceNum"><default-field><hidden/></default-field></field><field name="insertType" from="'below'"><default-field><radio><option key="above" text="Above"/><option key="below" text="Below"/></radio></default-field></field><field name="submit"><default-field><submit text="Add Paragraph Break ⏎"/></default-field></field></form-single></box-body></container-box><section-include name="PasteActivitiesSection" location="component://coarchy/screen/coarchy/cointernal/Process/EditProcessStory/PasteActivity.xml"/></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy/cointernal/Process/ProcessStory/ManageValues.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true" default-menu-title="Manage Statements"><parameter name="activityId" required="true"/><parameter name="dialogIndex"/><parameter name="pageIndex"/><parameter name="pageSize"/><parameter name="orderByField"/><transition name="getValueList"><parameter name="excludeValueIds"/><actions><set field="valueList" from="[]"/><if condition="term == null && valueIdList ? valueIdList?.size() > 0 : false"><then><entity-find entity-name="coarchy.ValueStatement" list="valueList" limit="50"><econdition field-name="disabled" value="N" or-null="true"/><econdition field-name="replacedByValueStatementId" operator="is-null"/><econdition field-name="valueStatementId" operator="in" from="valueIdList"/><econdition field-name="valueStatementId" operator="not-in" from="excludeValueIds" ignore-if-empty="true"/><order-by field-name="value"/></entity-find></then><else><entity-find entity-name="coarchy.ValueStatement" list="valueList" limit="50"><econdition field-name="disabled" value="N" or-null="true"/><econdition field-name="replacedByValueStatementId" operator="is-null"/><econdition field-name="value" operator="like" value="%${term}%" ignore-case="true"/><econdition field-name="valueStatementId" operator="not-in" from="excludeValueIds" ignore-if-empty="true"/><order-by field-name="value"/></entity-find></else></if><set field="outList" from="[]"/><iterate list="valueList" entry="value"><script><![CDATA[outList.add([value:value.valueStatementId, label:(value?.value&&value.value.size()>79)?value.value.take(79)+"...":value.value])]]></script></iterate><script><![CDATA[ec.web.sendJsonResponse(outList)]]></script></actions><default-response type="none"/></transition><transition name="createActivityValue"><service-call name="coarchy.CoarchyServices.create#ActivityValue" in-map="[activityId:activityId,valueIdList:valueIdList,organizationId:activeOrgId]" out-map="context" multi="parameter"/><default-response url=".." parameter-map="[_openDialog:_openDialog, processStoryId:processStoryId, activityId:null]"/><error-response url="." save-parameters="true"/></transition><transition name="deleteValueStatementActivity"><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><service-call name="update#coarchy.ValueStatementActivity" in-map="[valueStatementActivityId:valueStatementActivityId, thruDate:ec.user.nowTimestamp, organizationId:activeOrgId]" out-map="context" multi="parameter"/><default-response url=".." parameter-map="[_openDialog:_openDialog, processStoryId:processStoryId, activityId:null]"/><error-response url="." save-parameters="true"/></transition><transition name="deleteAllValueStatementActivities"><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><actions><entity-find entity-name="coarchy.ValueStatementActivity" list="valueActivities"><date-filter/><econdition field-name="activityId" from="activityId"/><econdition field-name="organizationId" from="activeOrgId"/></entity-find><iterate list="valueActivities" entry="valueActivity"><service-call name="update#coarchy.ValueStatementActivity" in-map="[valueStatementActivityId:valueActivity.valueStatementActivityId, thruDate:ec.user.nowTimestamp, organizationId:activeOrgId]"/></iterate></actions><default-response url=".." parameter-map="[_openDialog:_openDialog, processStoryId:processStoryId, activityId:null]"/><error-response url="." save-parameters="true"/></transition><actions><entity-find entity-name="coarchy.ValueStatementActivityDetail" list="prepValueActivityList"><date-filter/><econdition field-name="disabled" value="N" or-null="true"/><econdition field-name="activityId" from="activityId"/><select-field field-name="valueStatementActivityId,valueStatementId,value"/><order-by field-name="^value"/></entity-find><set field="valueIdList" from="prepValueActivityList*.valueStatementId"/><set field="valueActivityList" from="[]"/><iterate list="prepValueActivityList" entry="valueActivity"><script><![CDATA[valueActivityList.add([valueStatementId:valueActivity?.valueStatementId, valueStatementActivityId:valueActivity?.valueStatementActivityId, value:(valueActivity?.value&&valueActivity.value.size()>79)?valueActivity.value.take(79)+"...":valueActivity.value, valueFull:valueActivity.value])]]></script></iterate></actions><widgets><form-single name="ManageValues" transition="createActivityValue"><field name="activityId"><default-field><hidden/></default-field></field><field name="processStoryId"><default-field><hidden/></default-field></field><field name="_openDialog" from="'ManageValuesDialog_'+(dialogIndex?:0)"><default-field><display/></default-field></field><field name="valueIdList" from="[]"><default-field title="Connect Statements"><drop-down submit-on-select="false" allow-empty="false" allow-multiple="true"><dynamic-options server-search="true" transition="getValueList" min-length="0" parameter-map="[excludeValueIds:valueActivityList*.valueStatementId, maxLabelLength:80]"/></drop-down></default-field></field><field name="submit"><default-field title="Add"><submit/></default-field></field><field-layout><field-col-row><field-col sm="11"><field-ref name="valueIdList"/></field-col><field-col sm="1"><field-ref name="submit"/></field-col></field-col-row></field-layout></form-single><section name="ProcessStoryStatementListSection" condition="valueActivityList"><widgets><form-list name="ProcessStoryStatementList" list="valueActivityList" list-entry="valueActivityEntry"><field name="valueStatementActivityId"><default-field><hidden/></default-field></field><field name="valueFull"><default-field title="Connected Statements"><display/></default-field></field><field name="delete"><header-field><link url="deleteAllValueStatementActivities" btn-type="danger" text="Remove All" tooltip="Remove all associated statements" parameter-map="[_openDialog:'ManageValuesDialog_'+dialogIndex]"/></header-field><default-field title=""><link url="deleteValueStatementActivity" parameter-map="[valueStatementActivityId:valueStatementActivityId,_openDialog:'ManageValuesDialog_'+dialogIndex]" icon="fa fa-trash" btn-type="danger" text=" " tooltip="Remove Statement" confirmation="Remove Statement '${valueFull}'?"/></default-field></field></form-list></widgets></section></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy/cointernal/Process/ProcessStory.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Full Edit" default-menu-index="40" menu-image="fa fa-file" menu-image-type="icon" default-menu-include="false"><parameter name="processStoryId" required="true"/><parameter name="pageIndex" from="pageIndex?:0"/><parameter name="pageSize" from="pageSize?:50"/><parameter name="orderByField" value="sequenceNum"/><always-actions><if condition="!activeOrgId"><message><![CDATA[${ec.resource.expand('CoarchySelectAnOrg', null)}]]></message><script><![CDATA[sri.sendRedirectAndStopRender('/settings/Organizations')]]></script></if><entity-find-count entity-name="mantle.party.PartyRelationship" count-field="partyRelationshipCount"><date-filter/><econdition field-name="relationshipTypeEnumId" value="PrtMember"/><econdition field-name="toRoleTypeId" value="OrgInternal"/><econdition field-name="fromPartyId" from="ec.user.userAccount.partyId"/><econdition field-name="toPartyId" from="activeOrgId"/></entity-find-count><entity-find-count entity-name="mantle.party.PartyActivation" count-field="partyActivationCount"><date-filter/><econdition field-name="partyId" from="activeOrgId"/></entity-find-count></always-actions><transition name="getActorList"><actions><set field="actorList" from="[]"/><if condition="term == null && actorIdList ? actorIdList?.size() > 0 : false"><then><entity-find entity-name="coarchy.Actor" list="actorList" limit="50"><econdition field-name="actorId" operator="in" from="actorIdList"/><order-by field-name="name"/></entity-find></then><else><entity-find entity-name="coarchy.Actor" list="actorList" limit="50"><econdition field-name="name" operator="like" value="%${term}%" ignore-case="true"/><order-by field-name="name"/></entity-find></else></if><script><![CDATA[def outList = []
            for (def actor in actorList)
                outList.add([value:actor?.actorId, label:"${actor?.name}".toString()])
            ec.web.sendJsonResponse(outList)]]></script></actions><default-response type="none"/></transition><transition name="getCloneOrganizationList"><condition><expression><![CDATA[partyRelationshipCount > 0]]></expression></condition><service-call name="coarchy.CoarchyServices.get#CloneOrganizationList" in-map="[term:term]" out-map="context" multi="parameter"/><actions><script><![CDATA[ec.web.sendJsonResponse(outList)]]></script></actions><default-response type="none"/></transition><transition name="getProcessStoryList"><condition><expression><![CDATA[partyRelationshipCount > 0]]></expression></condition><service-call name="coarchy.CoarchyServices.get#ProcessStoryList" in-map="[organizationId:organizationId,term:term]" out-map="context" multi="parameter"/><actions><script><![CDATA[ec.web.sendJsonResponse(outList)]]></script></actions><default-response type="none"/></transition><transition name="getActivityList"><condition><expression><![CDATA[partyRelationshipCount > 0]]></expression></condition><service-call name="coarchy.CoarchyServices.get#ActivityList" in-map="[processStoryId:processStoryId,organizationId:organizationId,term:term]" out-map="context" multi="parameter"/><actions><script><![CDATA[ec.web.sendJsonResponse(outList)]]></script></actions><default-response type="none"/></transition><transition name="newParagraph"><condition><expression><![CDATA[partyRelationshipCount > 0]]></expression></condition><service-call name="coarchy.CoarchyServices.new#Paragraph" in-map="[processStoryId:processStoryId,organizationId:activeOrgId,insertSequenceNum:insertSequenceNum]" out-map="context" multi="parameter"/><default-response url="." parameter-map="[pageIndex:newPageIndex]"/></transition><transition name="importText"><condition><expression><![CDATA[partyRelationshipCount > 0 && ec.user.isInGroup('ADMIN')]]></expression></condition><actions><set field="paragraphTextList" from="text.split('(?:\\r\\n|\\r|\\n){2}').toList()"/><set field="activityMapList" from="[]"/><iterate list="paragraphTextList" entry="paragraphText"><set field="intermediateActivityMapList" from="paragraphText.trim().split('\\.').toList()"/><iterate list="intermediateActivityMapList" entry="intermediateActivityText"><set field="intermediateActivityText" from="intermediateActivityText.trim()"/><set field="condition" value=""/><if condition="intermediateActivityText.contains(',')"><set field="intermediateActivityTextCondition" from="intermediateActivityText.split(',')"/><set field="condition" from="intermediateActivityTextCondition[0]"/><set field="intermediateActivityText" from="intermediateActivityText.replace(intermediateActivityTextCondition[0]+',','').trim()"/></if><set field="intermediateActivityTextActor" from="intermediateActivityText.split(' ')"/><set field="actorList" value=""/><if condition="java.lang.Character.isUpperCase(intermediateActivityText.charAt(0))"><set field="actorList" from="intermediateActivityTextActor[0]"/><set field="intermediateActivityText" from="intermediateActivityText.replace(actorList+' ','').trim()"/></if><set field="action" from="intermediateActivityText"/><set field="activityMapList" from="activityMapList + ['condition':condition, 'actorList':actorList, 'action':action]"/></iterate><set field="activityMapList" from="activityMapList + ['condition':null, 'actorList':null, 'action':null]"/></iterate><entity-find entity-name="coarchy.ProcessStoryActivityDetail" list="processStoryActivityList" distinct="true"><search-form-inputs default-order-by="sequenceNum,action"/><date-filter/><econdition field-name="replacedByActivityId" operator="is-null"/><econdition field-name="processStoryId"/><econdition field-name="actorId" operator="in" from="actorIdList" ignore-if-empty="true"/><select-field field-name="processStoryActivityId,sequenceNum,detailProcessStoryId,action,condition,activityId,implementationId"/></entity-find><set field="insertSequenceNum" from="processStoryActivityList?.size()>0?processStoryActivityList?.last()?.sequenceNum+1:0"/><iterate list="activityMapList" entry="activityMap"><if condition="activityMap.action"><if condition="activityMap.actorList"><entity-find entity-name="coarchy.Actor" list="insideActorList" distinct="true" limit="1"><econdition field-name="name" from="activityMap.actorList"/><select-field field-name="actorId,name"/><order-by field-name="name"/></entity-find><set field="actorIdList" from="[]"/><if condition="!insideActorList"><then><service-call name="create#coarchy.Actor" in-map="[name:activityMap.actorList,                             organizationId:activeOrgId]" out-map="actorContext"/><script><![CDATA[actorIdList.add(actorContext?.actorId)]]></script></then><else><script><![CDATA[actorIdList.add(insideActorList.getFirst().actorId)]]></script></else></if></if><service-call name="coarchy.CoarchyServices.create#Activity" in-map="[processStoryId:processStoryId,organizationId:activeOrgId,                         condition:activityMap.condition,actorIdList:actorIdList,action:activityMap.action,insertSequenceNum:insertSequenceNum]"/><else><service-call name="coarchy.CoarchyServices.new#Paragraph" in-map="[processStoryId:processStoryId,organizationId:activeOrgId,insertSequenceNum:insertSequenceNum]"/></else></if><set field="insertSequenceNum" from="insertSequenceNum+1"/></iterate></actions><default-response url="." parameter-map="[pageIndex:newPageIndex]"/></transition><transition name="createActivity"><condition><expression><![CDATA[partyRelationshipCount > 0]]></expression></condition><actions><set field="actorIdList" from="actorIdList?:ec.web.getParameters().get('actorIdList[]')?:[]"/><service-call name="coarchy.CoarchyServices.create#ActivityPublic" in-map="[processStoryId:processStoryId,organizationId:activeOrgId,         condition:condition,actorIdList:actorIdList,action:action,insertSequenceNum:insertSequenceNum,implementationId:implementationId]" out-map="newActivity"/></actions><default-response url="." parameter-map="[pageIndex:newPageIndex]"/></transition><transition name="updateActivity"><condition><expression><![CDATA[partyRelationshipCount > 0]]></expression></condition><actions><set field="actorIdList" from="actorIdList?:ec.web.getParameters().get('actorIdList[]')?:[]"/><service-call name="coarchy.CoarchyServices.update#Activity" in-map="context + [organizationId:activeOrgId]"/></actions><default-response url="."/></transition><transition name="deleteActivity"><condition><expression><![CDATA[partyRelationshipCount > 0]]></expression></condition><actions><service-call name="coarchy.CoarchyServices.delete#Activity" in-map="context"/></actions><default-response url="."/></transition><transition name="activityMoveUp"><condition><expression><![CDATA[partyRelationshipCount > 0]]></expression></condition><actions><entity-find entity-name="coarchy.ProcessStoryActivityDetail" list="processStoryActivityList" limit="1"><date-filter/><econdition field-name="replacedByActivityId" operator="is-null"/><econdition field-name="sequenceNum" operator="less" from="sequenceNum.toInteger()"/><select-field field-name="processStoryActivityId,sequenceNum"/><order-by field-name="-sequenceNum"/></entity-find><set field="processStoryActivity" from="processStoryActivityList?.getFirst()"/><if condition="processStoryActivity?.sequenceNum != null"><then><service-call name="update#coarchy.ProcessStoryActivity" in-map="[processStoryActivityId:processStoryActivity.processStoryActivityId,sequenceNum:sequenceNum]"/><service-call name="update#coarchy.ProcessStoryActivity" in-map="[processStoryActivityId:processStoryActivityId,sequenceNum:processStoryActivity.sequenceNum]"/></then><else><return type="warning" message="${ec.resource.expand('CoarchyProcessActivityMoveError', null)}"/></else></if></actions><default-response url="." parameter-map="[pageIndex:pageIndex]"/></transition><transition name="activityMoveDown"><condition><expression><![CDATA[partyRelationshipCount > 0]]></expression></condition><actions><entity-find entity-name="coarchy.ProcessStoryActivityDetail" list="processStoryActivityList" limit="1"><date-filter/><econdition field-name="replacedByActivityId" operator="is-null"/><econdition field-name="sequenceNum" operator="greater" from="sequenceNum.toInteger()"/><select-field field-name="processStoryActivityId,sequenceNum"/><order-by field-name="sequenceNum"/></entity-find><set field="processStoryActivity" from="processStoryActivityList?.getFirst()"/><if condition="processStoryActivity?.sequenceNum != null"><then><service-call name="update#coarchy.ProcessStoryActivity" in-map="[processStoryActivityId:processStoryActivity.processStoryActivityId,sequenceNum:sequenceNum]"/><service-call name="update#coarchy.ProcessStoryActivity" in-map="[processStoryActivityId:processStoryActivityId,sequenceNum:processStoryActivity.sequenceNum]"/></then><else><return type="warning" message="${ec.resource.expand('CoarchyProcessActivityMoveError', null)}"/></else></if></actions><default-response url="." parameter-map="[pageIndex:pageIndex]"/></transition><transition name="moveActivities"><condition><expression><![CDATA[partyRelationshipCount > 0]]></expression></condition><service-call name="coarchy.CoarchyServices.move#Activities" in-map="context + [activityIdNum:context.keySet().count { key -> key.startsWith('activityId_') }]" multi="true" out-map="context"/><actions><set field="ec.user.context.activityIdList" from="null"/></actions><default-response url="."/></transition><transition name="copyActivities"><condition><expression><![CDATA[partyRelationshipCount > 0]]></expression></condition><service-call name="coarchy.CoarchyServices.copy#Activities" in-map="context +             [activityIdNum:context.keySet().count { key -> key.startsWith('activityId_') }]" multi="true" out-map="context"/><actions><set field="ec.user.context.clipboardEntryId" from="null"/><set field="ec.user.context.activityIdList" from="null"/></actions><default-response url="."/></transition><transition name="deleteActivities"><condition><expression><![CDATA[partyRelationshipCount > 0]]></expression></condition><actions><service-call name="coarchy.CoarchyServices.delete#Activity" in-map="context" multi="true"/></actions><default-response url="."/></transition><transition name="updateProcessStory"><condition><expression><![CDATA[partyRelationshipCount > 0]]></expression></condition><service-call name="coarchy.CoarchyServices.update#ProcessStory" in-map="[processStoryId:processStoryId,name:name,             organizationId:activeOrgId]" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="enableProcessStory"><service-call name="coarchy.CoarchyServices.enable#ProcessStory" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="disableProcessStory"><service-call name="coarchy.CoarchyServices.disable#ProcessStory" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="createChecklist"><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><service-call name="coarchy.CoarchyServices.create#ChecklistProcessStory" in-map="[processStoryId:processStoryId,name:name,organizationId:activeOrgId]" out-map="checklist" multi="parameter"/><default-response url="../Checklist" parameter-map="[checklistId:checklist.rootWorkEffortId]"/></transition><transition name="goProcessStory"><default-response url="../ProcessStory" parameter-map="[processStoryId:processStoryId]"/></transition><transition-include name="createActor" location="component://coarchy/screen/coarchy/cointernal/Actor.xml"/><transition-include name="getCloneOrganizationList" location="component://coarchy/screen/coarchy/cointernal/Home.xml"/><transition-include name="upgradeParty" location="component://coarchy/screen/coarchy/cointernal/Home.xml"/><actions><entity-find-one entity-name="coarchy.ProcessStory" value-field="processStory"/><if condition="!processStory"><script><![CDATA[sri.sendRedirectAndStopRender('/coapp/Process/FindProcessStory')]]></script></if><if condition="pageIndex==null"><set field="pageIndex" from="0"/></if><if condition="actorIdList"><entity-find entity-name="coarchy.Actor" list="headerActorList"><econdition field-name="actorId" operator="in" from="actorIdList"/><order-by field-name="name"/></entity-find></if><entity-find-count entity-name="coarchy.ProcessStoryActivity" count-field="activityCount"><date-filter/><econdition field-name="processStoryId"/></entity-find-count><entity-find entity-name="coarchy.ProcessStoryActivityDetail" list="detailActivityList"><date-filter/><econdition field-name="replacedByActivityId" operator="is-null"/><econdition field-name="detailProcessStoryId" from="processStoryId"/><select-field field-name="processStoryId,name"/><order-by field-name="-lastUpdatedStamp"/></entity-find><set field="showMoveUpDown" from="(!orderByField || orderByField == 'sequenceNum') && !actorIdList && !condition && !action"/><entity-find entity-name="coarchy.ProcessStoryActivityDetail" list="processStoryActivityList" distinct="true"><search-form-inputs default-order-by="sequenceNum,action"/><date-filter/><econdition field-name="replacedByActivityId" operator="is-null"/><econdition field-name="processStoryId"/><econdition field-name="actorId" operator="in" from="actorIdList" ignore-if-empty="true"/><select-field field-name="processStoryActivityId,sequenceNum,detailProcessStoryId,action,condition,activityId,implementationId"/></entity-find></actions><widgets><section name="FreemiumBanner" condition="partyActivationCount == 0"><widgets><container type="q-banner inline-actions rounded dense" style="bg-grey-3 text-black q-mb-md"><label text="To enable all the features upgrade organization '${activeOrg.organizationName}' to Premium" type="b"/><container type="template v-slot:action"><form-single name="UpgradeForm" transition="upgradeParty"><field name="upgrade"><default-field><submit text="Upgrade" type="success" confirmation="Activating will cost 1 Organization-Month Credit per month while ${activeOrg.organizationName} is upgraded. Are you sure?"/></default-field></field></form-single></container></container></widgets></section><label text="Process Story${processStory?.name?' - '+processStory.name:''}" type="h4"/><container-dialog id="AddChecklistDialog" button-text="Add Checklist" type="success" condition="partyRelationshipCount > 0"><form-single name="AddChecklistForm" transition="createChecklist"><field name="pageIndex"><default-field><hidden/></default-field></field><field name="processStoryId"><default-field><hidden/></default-field></field><field name="name" from="processStory.name"><default-field><text-line/></default-field></field><field name="submit"><default-field><submit text="Add"/></default-field></field></form-single></container-dialog><link url="../ProcessStory" parameter-map="[processStoryId:detailActivityList?.getFirst()?.processStoryId]" text="Go to Parent Story: ${detailActivityList?.getFirst()?.name}" condition="detailActivityList.size() == 1 && detailActivityList?.getFirst()?.processStoryId"/><container-dialog id="GoProcessStoryDialogue" button-text="Go to Parent Story" condition="detailActivityList.size() > 1"><form-single name="GoProcessStoryForm" transition="goProcessStory"><field name="pageIndex"><default-field><hidden/></default-field></field><field name="processStoryId" from="null"><default-field title="Process Story"><drop-down allow-empty="true" required-manual-select="true" submit-on-select="true"><list-options list="detailActivityList" key="${processStoryId}" text="${name}"/></drop-down></default-field></field></form-single></container-dialog><container-dialog id="AddActorDialogue" button-text="Add Actor" type="success" condition="partyRelationshipCount > 0"><form-single name="AddActor" transition="createActor"><field name="pageIndex"><default-field><hidden/></default-field></field><field name="processStoryId"><default-field><hidden/></default-field></field><field name="name"><default-field><text-line/></default-field></field><field name="description"><default-field><text-area autogrow="true"/></default-field></field><field name="submit"><default-field><submit text="Add"/></default-field></field></form-single></container-dialog><container-dialog id="UpdateStoryDialog" button-text="Edit Story Name"><form-single name="UpdateProcessStory" transition="updateProcessStory"><field name="pageIndex"><default-field><hidden/></default-field></field><field name="processStoryId"><default-field><hidden/></default-field></field><field name="name" from="processStory?.name"><default-field title="Process Story Name"><text-line size="50"/></default-field></field><field name="submit"><default-field><submit text="Edit"/></default-field></field></form-single></container-dialog><link url="enableProcessStory" text="Show Process Story" parameter-map="[processStoryId:processStoryId]" condition="processStory.disabled == 'Y'"/><link url="disableProcessStory" text="Hide Process Story" parameter-map="[processStoryId:processStoryId]" condition="processStory.disabled != 'Y'"/><form-list name="ProcessStory" header-dialog="true" list="processStoryActivityList" show-csv-button="true" show-page-size="true" select-columns="true" transition="updateActivity" transition-last-row="createActivity" map-last-row="[actorIdList:null,condition:null,action:null,implementationId:null]"><row-actions><set field="activityActorList" from="[]"/><entity-find entity-name="coarchy.ActivityActorDetail" list="activityActorList"><econdition field-name="activityId"/><order-by field-name="name"/></entity-find><set field="actorIdList" from="activityActorList*.actorId"/><entity-find-count entity-name="coarchy.product.ProductEvaluationActivityAndDetail" count-field="existingEvaluationRecordCount"><econdition field-name="statusId" operator="not-equals" value="PeRequirementsSelection"/><econdition field-name="activityId"/><econdition field-name="excludeFlag" value="N" or-null="true"/><econdition field-name="organizationId" from="activeOrgId"/></entity-find-count><set field="canCopyOnWrite" from="existingEvaluationRecordCount > 0"/></row-actions><row-selection id-field="activityId"><action><dialog button-text="Copy To" title="Copy activities to another organization or process story"/><form-single name="CopyToActivities" transition="moveActivities" pass-through-parameters="true"><field name="moveType" from="'copy'"><default-field><hidden/></default-field></field><field name="organizationId"><default-field title="Organization"><label text="Enable premium features to copy to your organizations"/><drop-down allow-empty="true" required-manual-select="true"><dynamic-options transition="getCloneOrganizationList" min-length="0"/></drop-down></default-field></field><field name="processStoryId" from="null"><default-field title="Process Story"><drop-down allow-empty="true" required-manual-select="true"><dynamic-options transition="getProcessStoryList" min-length="0"><depends-on field="organizationId"/></dynamic-options></drop-down></default-field></field><field name="insertActivityId"><default-field title="Activity"><drop-down allow-empty="true" required-manual-select="true"><dynamic-options transition="getActivityList" min-length="0"><depends-on field="organizationId"/><depends-on field="processStoryId"/></dynamic-options></drop-down></default-field></field><field name="insertType" from="'below'"><default-field><radio><option key="above" text="Above"/><option key="below" text="Below"/></radio></default-field></field><field name="submitBtn"><default-field><submit text="Copy"/></default-field></field></form-single></action><action><dialog button-text="Move To" title="Cut activities to another organization or process story"/><form-single name="MoveToActivities" transition="moveActivities" pass-through-parameters="true"><field name="moveType" from="'cut'"><default-field><hidden/></default-field></field><field name="organizationId"><default-field title="Organization"><label text="Enable premium features to copy to your organizations"/><drop-down allow-empty="true" required-manual-select="true"><dynamic-options transition="getCloneOrganizationList" min-length="0"/></drop-down></default-field></field><field name="processStoryId" from="null"><default-field title="Process Story"><drop-down allow-empty="true" required-manual-select="true"><dynamic-options transition="getProcessStoryList" min-length="0"><depends-on field="organizationId"/></dynamic-options></drop-down></default-field></field><field name="insertActivityId"><default-field title="Activity"><drop-down allow-empty="true" required-manual-select="true"><dynamic-options transition="getActivityList" min-length="0"><depends-on field="organizationId"/><depends-on field="processStoryId"/></dynamic-options></drop-down></default-field></field><field name="insertType" from="'below'"><default-field><radio><option key="above" text="Above"/><option key="below" text="Below"/></radio></default-field></field><field name="submitBtn"><default-field><submit text="Cut"/></default-field></field></form-single></action><action><form-single name="CopyActivities" transition="copyActivities"><field name="moveTypeEnumId" from="'CbmtCopy'"><default-field><hidden/></default-field></field><field name="processStoryId"><default-field><hidden/></default-field></field><field name="pageIndex"><default-field><hidden/></default-field></field><field name="pageSize"><default-field><hidden/></default-field></field><field name="orderByField"><default-field><hidden/></default-field></field><field name="activityId"><default-field><hidden/></default-field></field><field name="submitBtn"><default-field><submit text="Copy"/></default-field></field><field-layout><field-row-big><field-ref name="submitBtn"/></field-row-big></field-layout></form-single></action><action><form-single name="CutActivities" transition="copyActivities"><field name="moveTypeEnumId" from="'CbmtCut'"><default-field><hidden/></default-field></field><field name="processStoryId"><default-field><hidden/></default-field></field><field name="pageIndex"><default-field><hidden/></default-field></field><field name="pageSize"><default-field><hidden/></default-field></field><field name="orderByField"><default-field><hidden/></default-field></field><field name="activityId"><default-field><hidden/></default-field></field><field name="submitBtn"><default-field><submit text="Cut"/></default-field></field><field-layout><field-row-big><field-ref name="submitBtn"/></field-row-big></field-layout></form-single></action><action><form-single name="DeleteActivities" transition="deleteActivities"><field name="processStoryId"><default-field><hidden/></default-field></field><field name="pageIndex"><default-field><hidden/></default-field></field><field name="pageSize"><default-field><hidden/></default-field></field><field name="orderByField"><default-field><hidden/></default-field></field><field name="submitBtn"><default-field><submit text="Delete" confirmation="Are you sure? You can't undo deleting an activity."/></default-field></field><field-layout><field-row><field-ref name="submitBtn"/></field-row></field-layout></form-single></action></row-selection><hidden-parameters><parameter name="processStoryId"/></hidden-parameters><field name="activityId"><default-field><hidden/></default-field></field><field name="pageIndex"><default-field><hidden/></default-field></field><field name="pageSize"><default-field><hidden/></default-field></field><field name="insertSequenceNum"><last-row-field><hidden default-value="${processStoryActivityList?.size() > 0 ?processStoryActivityList?.last()?.sequenceNum+1:0}"/></last-row-field></field><field name="newPageIndex"><last-row-field><hidden default-value="${(processStoryActivityListPageRangeHigh < processStoryActivityListCount) || (processStoryActivityListPageRangeHigh == processStoryActivityListCount && processStoryActivityListCount == pageSize.toInteger()*(processStoryActivityListPageMaxIndex.toInteger()+1))?pageIndex?.toInteger()+1:pageIndex}"/></last-row-field></field><field name="move"><default-field title="Move"><link url="activityMoveUp" parameter-map="[processStoryActivityId:processStoryActivityId,sequenceNum:sequenceNum,pageIndex:processStoryActivityListPageRangeLow==(processStoryActivityListPageRangeLow+processStoryActivityList_index)?pageIndex.toInteger()-1:pageIndex]" condition="showMoveUpDown && (processStoryActivityListPageRangeLow!=1 || processStoryActivityListPageRangeLow!=(processStoryActivityListPageRangeLow+processStoryActivityList_index))" icon="fa fa-angle-up" text=""/><container condition="showMoveUpDown"/><link url="activityMoveDown" parameter-map="[processStoryActivityId:processStoryActivityId,sequenceNum:sequenceNum,pageIndex:processStoryActivityListPageRangeLow+processStoryActivityList_index==processStoryActivityListPageRangeHigh?pageIndex.toInteger()+1:pageIndex]" condition="showMoveUpDown && (processStoryActivityListPageRangeHigh < processStoryActivityListCount || processStoryActivityListPageRangeLow+processStoryActivityList_index!=processStoryActivityListPageRangeHigh)" icon="fa fa-angle-down" text=""/></default-field></field><field name="sequenceNum"><default-field><display/></default-field></field><field name="implementationId"><header-field title="Implementation Status" show-order-by="case-insensitive"><drop-down allow-empty="true"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="ActivityImplementation"/><order-by field-name="sequenceNum"/></entity-find></entity-options></drop-down></header-field><conditional-field condition="action"><drop-down allow-empty="true" submit-on-select="false"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="ActivityImplementation"/><order-by field-name="sequenceNum"/></entity-find></entity-options></drop-down></conditional-field><last-row-field title="Implementation Status"><drop-down allow-empty="true"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="ActivityImplementation"/><order-by field-name="sequenceNum"/></entity-find></entity-options></drop-down></last-row-field></field><field name="condition"><header-field title="Condition (optional)" show-order-by="case-insensitive"><text-find size="25"/></header-field><conditional-field condition="action"><text-area rows="4" cols="40" autogrow="true"/></conditional-field><last-row-field><text-area rows="4" cols="40"/></last-row-field></field><field name="actorIdList"><header-field title="Actor"><drop-down allow-empty="true" allow-multiple="true"><list-options list="headerActorList" key="${actorId}" text="${name}"/><dynamic-options server-search="true" transition="getActorList" min-length="0"/></drop-down></header-field><conditional-field condition="action" title="Actor"><drop-down allow-empty="true" allow-multiple="true" submit-on-select="false"><list-options list="activityActorList" key="${actorId}" text="${name}"/><dynamic-options server-search="true" transition="getActorList" min-length="0"/></drop-down></conditional-field><last-row-field title="Actor"><drop-down allow-empty="true" allow-multiple="true"><dynamic-options server-search="true" transition="getActorList" min-length="0"/></drop-down></last-row-field></field><field name="action"><header-field title="Action" show-order-by="case-insensitive"><text-find size="25"/></header-field><conditional-field condition="action"><text-area rows="2" cols="80" autogrow="true"/></conditional-field><last-row-field><text-area rows="2" cols="80"/></last-row-field></field><field name="ignoreCopyOnWrite"><conditional-field title="" condition="canCopyOnWrite"><check no-current-selected-key="false"><option key="true" text="Save the changes to all existing product evaluations."/></check></conditional-field><default-field title=""><hidden/></default-field></field><field name="submit"><header-field title="Update"><submit/></header-field><conditional-field condition="action"><submit text="Update"/></conditional-field><last-row-field><submit text="Add Activity" type="success"/></last-row-field></field><field name="actionMenu"><default-field title="Actions"><button-menu text="Actions"><dynamic-dialog id="InsertActivity" button-text="Insert" transition="InsertActivity" parameter-map="[processStoryId:processStory?.processStoryId?:processStoryId,sequenceNum:sequenceNum,pageIndex:pageIndex,downPageIndex:processStoryActivityListPageRangeLow-1+processStoryActivityListPageSize==processStoryActivityListPageRangeLow+processStoryActivityList_index?pageIndex.toInteger()+1:pageIndex]" condition="partyRelationshipCount > 0 && showMoveUpDown"/><dynamic-dialog id="ManageValuesDialog" button-text="Statements" transition="ManageValues" parameter-map="[activityId:activityId, dialogIndex: processStoryActivityList_index]" condition="partyRelationshipCount > 0 && action"/><dynamic-dialog id="SubstoryDialogue" transition="CreateOrSelectSubstory" button-text="Substory" parameter-map="[processStoryActivityId:processStoryActivityId,parentProcessStoryIdList:detailActivityList*.processStoryId]" condition="action && !detailProcessStoryId && partyRelationshipCount > 0"/><link url="../EditProcessStory" parameter-map="[processStoryId:detailProcessStoryId]" text="Substory" condition="detailProcessStoryId"/><link url="deleteActivity" confirmation="Are you sure? You can't undo deleting an activity." parameter-map="[processStoryActivityId:processStoryActivityId,activityId:activityId,actorIdList:actorIdList,pageIndex:pageIndex]" icon="fa fa-trash" btn-type="danger" text="Delete" tooltip="Delete Activity"/></button-menu></default-field></field><field name="newParagraph"><header-field title="New Paragraph"/><default-field/><last-row-field><link url="newParagraph" text="⏎ Paragraph" tooltip="Add Paragraph Break" parameter-map="[insertSequenceNum:processStoryActivityList?.size()>0?processStoryActivityList?.last()?.sequenceNum+1:0,                         newPageIndex:((processStoryActivityListPageRangeHigh < processStoryActivityListCount) || (processStoryActivityListPageRangeHigh == processStoryActivityListCount &&                         processStoryActivityListCount == pageSize.toInteger()*(processStoryActivityListPageMaxIndex.toInteger()+1))?pageIndex.toInteger()+1:pageIndex)]"/></last-row-field></field><columns><column><field-ref name="move"/></column><column><field-ref name="condition"/><field-ref name="implementationId"/></column><column><field-ref name="actorIdList"/><field-ref name="action"/></column><column><field-ref name="ignoreCopyOnWrite"/><field-ref name="submit"/></column><column><field-ref name="actionMenu"/><field-ref name="newParagraph"/></column></columns></form-list></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy/cointernal/Process/EditProcessStory/CopyActivitiesTo.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><transition-include name="getCloneOrganizationList" location="component://coarchy/screen/coarchy/cointernal/Process/ProcessStory.xml"/><transition-include name="getProcessStoryList" location="component://coarchy/screen/coarchy/cointernal/Process/ProcessStory.xml"/><transition-include name="getActivityList" location="component://coarchy/screen/coarchy/cointernal/Process/ProcessStory.xml"/><transition name="moveActivities"><condition><expression><![CDATA[partyRelationshipCount > 0]]></expression></condition><service-call name="coarchy.CoarchyServices.move#Activities" in-map="context + [activityIdNum:context.keySet().count { key -> key.startsWith('activityId_') }]" multi="true" out-map="context"/><actions><set field="ec.user.context.activityIdList" from="null"/><set field="activityId" from="null"/></actions><default-response url="../../EditProcessStoryV3"/></transition><widgets><form-single name="CopyToActivities" transition="moveActivities" pass-through-parameters="true"><field name="moveType" from="'copy'"><default-field><hidden/></default-field></field><field name="organizationId" from="activeOrgId"><default-field title="Organization"><drop-down allow-empty="true" required-manual-select="true"><dynamic-options transition="getCloneOrganizationList" min-length="0"/></drop-down></default-field></field><field name="processStoryId" from="null"><default-field title="Process Story"><drop-down allow-empty="true" required-manual-select="true"><dynamic-options transition="getProcessStoryList" min-length="0"><depends-on field="organizationId"/></dynamic-options></drop-down></default-field></field><field name="insertActivityId"><default-field title="Activity"><drop-down allow-empty="true" required-manual-select="true"><dynamic-options transition="getActivityList" min-length="0"><depends-on field="organizationId"/><depends-on field="processStoryId"/></dynamic-options></drop-down></default-field></field><field name="insertType" from="'below'"><default-field><radio><option key="above" text="Above"/><option key="below" text="Below"/></radio></default-field></field><field name="submitBtn"><default-field><submit text="Copy"/></default-field></field></form-single></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy/cointernal/Process/EditProcessStory/CreateOrSelectSubstory.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><transition name="createSubstory"><condition><expression><![CDATA[partyRelationshipCount > 0]]></expression></condition><actions><service-call name="coarchy.CoarchyServices.create#ProcessStory" in-map="[name:name,organizationId:activeOrgId]" out-map="newStory"/><service-call name="update#coarchy.ProcessStoryActivity" in-map="[processStoryActivityId:processStoryActivityId,detailProcessStoryId:newStory.processStoryId]"/></actions><default-response url="../../EditProcessStoryV3" parameter-map="[processStoryId:newStory.processStoryId]"/><error-response url="."/></transition><transition name="selectSubstory"><condition><expression><![CDATA[partyRelationshipCount > 0]]></expression></condition><actions><service-call name="update#coarchy.ProcessStoryActivity" in-map="[processStoryActivityId:processStoryActivityId,detailProcessStoryId:detailProcessStoryId]"/></actions><default-response url="../../EditProcessStoryV3" parameter-map="[processStoryId:detailProcessStoryId]"/><error-response url="."/></transition><actions><entity-find-one entity-name="coarchy.ProcessStoryActivityDetail" value-field="processStoryActivityEntity" auto-field-map="[processStoryActivityId:processStoryActivityId]"/><entity-find entity-name="coarchy.ActivityActorDetail" list="activityActorList"><econdition field-name="activityId" from="processStoryActivityEntity.activityId"/><order-by field-name="name"/></entity-find><set field="processStoryActivity" from="processStoryActivityEntity.getMap() + [actorNames:activityActorList*.name]"/><entity-find entity-name="coarchy.ProcessStoryActivityDetail" list="processStoryList" distinct="true"><date-filter/><econdition field-name="replacedByActivityId" operator="is-null"/><econdition field-name="detailProcessStoryId" operator="is-not-null"/><econdition field-name="disabled" value="N"/><select-field field-name="processStoryId"/></entity-find><set field="processStoryIdList" from="processStoryList*.processStoryId" type="List"/></actions><widgets><container-box><box-header title="Create New Substory"/><box-body><form-single name="CreateSubstory" transition="createSubstory"><field name="processStoryActivityId"><default-field><hidden/></default-field></field><field name="name"><default-field title="New Substory Name"><text-line default-value="${ec.resource.template('component://coarchy/template/Activity.html.ftl', '.ftl')}"/></default-field></field><field name="create"><default-field><submit/></default-field></field></form-single></box-body></container-box><container-box><box-header title="Select Existing Substory"/><box-body><form-single name="SelectSubstory" transition="selectSubstory"><field name="processStoryActivityId"><default-field><hidden/></default-field></field><field name="detailProcessStoryId"><default-field title="Select Story"><drop-down submit-on-select="true" required-manual-select="true"><entity-options text="${name}" key="${processStoryId}"><entity-find entity-name="coarchy.ProcessStory" list="processStoryList" limit="20"><econdition field-name="disabled" value="N"/><econdition field-name="processStoryId" operator="not-in" from="processStoryIdList + [processStoryId]"/><select-field field-name="name,processStoryId"/><order-by field-name="name"/></entity-find></entity-options></drop-down></default-field></field></form-single></box-body></container-box></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy/cointernal/Process/EditProcessStory/InsertActivity.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="pageIndex"/><parameter name="pageSize"/><parameter name="orderByField"/><parameter name="isEmptyStory"/><transition-include name="getActorList" location="component://coarchy/screen/coarchy/cointernal/Process/EditProcessStory.xml"/><transition name="insertActivity"><service-call name="coarchy.CoarchyServices.insert#Activity" in-map="context + [organizationId:activeOrgId]" out-map="context" multi="parameter"/><default-response url=".." parameter-map="[pageIndex:pageIndex]"/></transition><transition name="insertParagraphBreak"><actions><set field="insertSequenceNum" from="sequenceNum"/><if condition="insertType=='below'"><set field="pageIndex" from="downPageIndex"/><entity-find entity-name="coarchy.ProcessStoryActivityDetail" list="processStoryActivityMaxList" limit="1"><date-filter/><econdition field-name="replacedByActivityId" operator="is-null"/><econdition field-name="sequenceNum" operator="greater" from="sequenceNum.toInteger()"/><select-field field-name="processStoryActivityId,sequenceNum"/><order-by field-name="sequenceNum"/></entity-find><set field="insertSequenceNum" from="processStoryActivityMaxList?.getFirst()?.sequenceNum?:insertSequenceNum.toInteger()+1"/></if><entity-find entity-name="coarchy.ProcessStoryActivityDetail" list="processStoryActivityList"><date-filter/><econdition field-name="replacedByActivityId" operator="is-null"/><econdition field-name="sequenceNum" operator="greater-equals" from="insertSequenceNum.toInteger()"/><select-field field-name="processStoryActivityId,sequenceNum"/><order-by field-name="-sequenceNum"/></entity-find><iterate list="processStoryActivityList" entry="processStoryActivity"><service-call name="update#coarchy.ProcessStoryActivity" in-map="[processStoryActivityId:processStoryActivity.processStoryActivityId,sequenceNum:processStoryActivity.sequenceNum+1]"/></iterate><service-call name="create#coarchy.Activity" in-map="[organizationId:activeOrgId]" out-map="newActivity"/><service-call name="create#coarchy.ProcessStoryActivity" in-map="[processStoryId:processStoryId,activityId:newActivity.activityId, sequenceNum:insertSequenceNum, fromDate:ec.user.nowTimestamp, organizationId:activeOrgId]"/></actions><default-response url=".." parameter-map="[pageIndex:pageIndex]"/><error-response type="none"/></transition><transition name="pasteActivities"><service-call name="coarchy.CoarchyServices.paste#Activities" in-map="[pageIndex:pageIndex,insertType:insertType,             downPageIndex:downPageIndex,processStoryId:processStoryId,sequenceNum:sequenceNum,organizationId:activeOrgId,             clipboardEntryId:clipboardEntryId]" out-map="context" multi="parameter"/><default-response url=".." parameter-map="[pageIndex:pageIndex]"/></transition><actions><entity-find entity-name="coarchy.ClipboardEntry" list="entryList" limit="5"><econdition field-name="partyId" from="ec.user.userAccount?.partyId"/><order-by field-name="-entryDate"/></entity-find></actions><widgets><container-box><box-header title="Insert New Activity"/><box-body><form-single name="InsertActivity" transition="insertActivity"><field name="pageIndex"><default-field><hidden/></default-field></field><field name="downPageIndex"><default-field><hidden/></default-field></field><field name="processStoryId"><default-field><hidden/></default-field></field><field name="sequenceNum"><default-field><hidden/></default-field></field><field name="condition"><default-field title="Condition (optional)"><text-area rows="2" autogrow="true"/></default-field></field><field name="actorIdList"><default-field title="Actor"><drop-down allow-empty="true" allow-multiple="true"><list-options list="activityActorList" key="${actorId}" text="${name}"/><dynamic-options server-search="true" transition="getActorList" min-length="0"/></drop-down></default-field></field><field name="action"><default-field title="Action"><text-area rows="2" autogrow="true"/></default-field></field><field name="implementationId"><default-field title="Implementation Status"><drop-down allow-empty="true"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="ActivityImplementation"/><order-by field-name="sequenceNum"/></entity-find></entity-options></drop-down></default-field></field><field name="insertType" from="'below'"><default-field><radio><option key="above" text="Above"/><option key="below" text="Below"/></radio></default-field></field><field name="submit"><default-field><submit text="Add Activity" type="success"/></default-field></field></form-single></box-body></container-box><container-box><box-header title="Insert Paragraph Break"/><box-body><form-single name="InsertParagraphBreak" transition="insertParagraphBreak"><field name="pageIndex"><default-field><hidden/></default-field></field><field name="downPageIndex"><default-field><hidden/></default-field></field><field name="processStoryId"><default-field><hidden/></default-field></field><field name="sequenceNum"><default-field><hidden/></default-field></field><field name="insertType" from="'below'"><default-field><radio><option key="above" text="Above"/><option key="below" text="Below"/></radio></default-field></field><field name="submit"><default-field><submit text="Add Paragraph Break ⏎"/></default-field></field></form-single></box-body></container-box><section-include name="PasteActivitiesSection" location="component://coarchy/screen/coarchy/cointernal/Process/EditProcessStory/PasteActivity.xml"/></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy/cointernal/Process/EditProcessStory/ManageValues.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true" default-menu-title="Manage Statements"><parameter name="activityId" required="true"/><parameter name="dialogIndex"/><parameter name="pageIndex"/><parameter name="pageSize"/><parameter name="orderByField"/><transition name="getValueList"><parameter name="excludeValueIds"/><actions><set field="valueList" from="[]"/><if condition="term == null && valueIdList ? valueIdList?.size() > 0 : false"><then><entity-find entity-name="coarchy.ValueStatement" list="valueList" limit="50"><econdition field-name="disabled" value="N" or-null="true"/><econdition field-name="replacedByValueStatementId" operator="is-null"/><econdition field-name="valueStatementId" operator="in" from="valueIdList"/><econdition field-name="valueStatementId" operator="not-in" from="excludeValueIds" ignore-if-empty="true"/><order-by field-name="value"/></entity-find></then><else><entity-find entity-name="coarchy.ValueStatement" list="valueList" limit="50"><econdition field-name="disabled" value="N" or-null="true"/><econdition field-name="replacedByValueStatementId" operator="is-null"/><econdition field-name="value" operator="like" value="%${term}%" ignore-case="true"/><econdition field-name="valueStatementId" operator="not-in" from="excludeValueIds" ignore-if-empty="true"/><order-by field-name="value"/></entity-find></else></if><set field="outList" from="[]"/><iterate list="valueList" entry="value"><script><![CDATA[outList.add([value:value.valueStatementId, label:(value?.value&&value.value.size()>79)?value.value.take(79)+"...":value.value])]]></script></iterate><script><![CDATA[ec.web.sendJsonResponse(outList)]]></script></actions><default-response type="none"/></transition><transition name="createActivityValue"><service-call name="coarchy.CoarchyServices.create#ActivityValue" in-map="[activityId:activityId,valueIdList:valueIdList,organizationId:activeOrgId]" out-map="context" multi="parameter"/><default-response url=".." parameter-map="[_openDialog:_openDialog, processStoryId:processStoryId, activityId:null]"/><error-response url="." save-parameters="true"/></transition><transition name="deleteValueStatementActivity"><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><service-call name="update#coarchy.ValueStatementActivity" in-map="[valueStatementActivityId:valueStatementActivityId,thruDate:ec.user.nowTimestamp, organizationId:activeOrgId]" out-map="context" multi="parameter"/><default-response url=".." parameter-map="[_openDialog:_openDialog, processStoryId:processStoryId, activityId:null]"/><error-response url="." save-parameters="true"/></transition><transition name="deleteAllValueStatementActivities"><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><actions><entity-find entity-name="coarchy.ValueStatementActivity" list="valueActivities"><date-filter/><econdition field-name="activityId" from="activityId"/><econdition field-name="organizationId" from="activeOrgId"/></entity-find><iterate list="valueActivities" entry="valueActivity"><service-call name="update#coarchy.ValueStatementActivity" in-map="[valueStatementActivityId:valueActivity.valueStatementActivityId, thruDate:ec.user.nowTimestamp]"/></iterate></actions><default-response url=".." parameter-map="[_openDialog:_openDialog, processStoryId:processStoryId, activityId:null]"/><error-response url="." save-parameters="true"/></transition><actions><entity-find entity-name="coarchy.ValueStatementActivityDetail" list="prepValueActivityList"><date-filter/><econdition field-name="disabled" value="N" or-null="true"/><econdition field-name="activityId" from="activityId"/><select-field field-name="valueStatementActivityId,valueStatementId,value"/><order-by field-name="^value"/></entity-find><set field="valueIdList" from="prepValueActivityList*.valueStatementId"/><set field="valueActivityList" from="[]"/><iterate list="prepValueActivityList" entry="valueActivity"><script><![CDATA[valueActivityList.add([valueStatementId:valueActivity?.valueStatementId, valueStatementActivityId:valueActivity?.valueStatementActivityId, value:(valueActivity?.value&&valueActivity.value.size()>79)?valueActivity.value.take(79)+"...":valueActivity.value, valueFull:valueActivity.value])]]></script></iterate></actions><widgets><form-single name="ManageValues" transition="createActivityValue"><field name="activityId"><default-field><hidden/></default-field></field><field name="processStoryId"><default-field><hidden/></default-field></field><field name="_openDialog" from="'ManageValuesDialog_'+(dialogIndex?:0)"><default-field><display/></default-field></field><field name="valueIdList" from="[]"><default-field title="Connect Statements"><drop-down submit-on-select="false" allow-empty="false" allow-multiple="true"><dynamic-options server-search="true" transition="getValueList" min-length="0" parameter-map="[excludeValueIds:valueActivityList*.valueStatementId, maxLabelLength:80]"/></drop-down></default-field></field><field name="submit"><default-field title="Add"><submit/></default-field></field><field-layout><field-col-row><field-col sm="11"><field-ref name="valueIdList"/></field-col><field-col sm="1"><field-ref name="submit"/></field-col></field-col-row></field-layout></form-single><section name="ProcessStoryStatementListSection" condition="valueActivityList"><widgets><form-list name="ProcessStoryStatementList" list="valueActivityList" list-entry="valueActivityEntry"><field name="valueStatementActivityId"><default-field><hidden/></default-field></field><field name="valueFull"><default-field title="Connected Statements"><display/></default-field></field><field name="delete"><header-field><link url="deleteAllValueStatementActivities" btn-type="danger" text="Remove All" tooltip="Remove all associated statements" parameter-map="[_openDialog:'ManageValuesDialog_'+dialogIndex]"/></header-field><default-field title=""><link url="deleteValueStatementActivity" parameter-map="[valueStatementActivityId:valueStatementActivityId,_openDialog:'ManageValuesDialog_'+dialogIndex]" icon="fa fa-trash" btn-type="danger" text=" " tooltip="Remove Statement" confirmation="Remove Statement '${valueFull}'?"/></default-field></field></form-list></widgets></section></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy/cointernal/Process/EditProcessStory/MoveActivitiesTo.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><transition-include name="getCloneOrganizationList" location="component://coarchy/screen/coarchy/cointernal/Process/ProcessStory.xml"/><transition-include name="getProcessStoryList" location="component://coarchy/screen/coarchy/cointernal/Process/ProcessStory.xml"/><transition-include name="getActivityList" location="component://coarchy/screen/coarchy/cointernal/Process/ProcessStory.xml"/><transition name="moveActivities"><condition><expression><![CDATA[partyRelationshipCount > 0]]></expression></condition><service-call name="coarchy.CoarchyServices.move#Activities" in-map="context + [activityIdNum:context.keySet().count { key -> key.startsWith('activityId_') }]" multi="true" out-map="context"/><actions><set field="ec.user.context.activityIdList" from="null"/><set field="activityId" from="null"/></actions><default-response url="../../EditProcessStoryV3"/></transition><widgets><form-single name="MoveToActivities" transition="moveActivities" pass-through-parameters="true"><field name="moveType" from="'cut'"><default-field><hidden/></default-field></field><field name="organizationId" from="activeOrgId"><default-field title="Organization"><drop-down allow-empty="true" required-manual-select="true"><dynamic-options transition="getCloneOrganizationList" min-length="0"/></drop-down></default-field></field><field name="processStoryId" from="null"><default-field title="Process Story"><drop-down allow-empty="true" required-manual-select="true"><dynamic-options transition="getProcessStoryList" min-length="0"><depends-on field="organizationId"/></dynamic-options></drop-down></default-field></field><field name="insertActivityId"><default-field title="Activity"><drop-down allow-empty="true" required-manual-select="true"><dynamic-options transition="getActivityList" min-length="0"><depends-on field="organizationId"/><depends-on field="processStoryId"/></dynamic-options></drop-down></default-field></field><field name="insertType" from="'below'"><default-field><radio><option key="above" text="Above"/><option key="below" text="Below"/></radio></default-field></field><field name="submitBtn"><default-field><submit text="Cut"/></default-field></field></form-single></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy/cointernal/Process/EditProcessStory/PasteActivity.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="processStoryId"/><parameter name="sequenceNum"/><parameter name="isEmptyStory"/><parameter name="pageIndex"/><parameter name="pageSize"/><parameter name="orderByField"/><transition-include name="getActorList" location="component://coarchy/screen/coarchy/cointernal/Process/EditProcessStory.xml"/><transition name="pasteActivities"><service-call name="coarchy.CoarchyServices.paste#Activities" in-map="[pageIndex:pageIndex,insertType:insertType,             downPageIndex:downPageIndex,processStoryId:processStoryId,sequenceNum:sequenceNum,organizationId:activeOrgId,             clipboardEntryId:clipboardEntryId]" out-map="context" multi="parameter"/><default-response url=".." parameter-map="[pageIndex:pageIndex]"/></transition><actions><entity-find entity-name="coarchy.ClipboardEntry" list="entryList" limit="5"><econdition field-name="partyId" from="ec.user.userAccount?.partyId"/><order-by field-name="-entryDate"/></entity-find></actions><widgets><section name="PasteActivitiesSection" condition="entryList.size() > 0"><widgets><container-box><box-header title="Paste Activities"/><box-body><section name="PasteActivitiesNotEmptyProcess" condition="!(isEmptyStory.toBoolean())"><widgets><form-list name="PasteActivitiesNotEmptyFormList" list="entryList" transition="pasteActivities"><row-actions><service-call name="coarchy.CoarchyServices.get#ClipboardActivityAndCount" in-map="[clipboardEntryId:clipboardEntryId]" out-map="context"/></row-actions><field name="activityText"><default-field title=""><display/></default-field></field><field name="insertAbove"><default-field><link url="pasteActivities" text="Above ${activityCount}" btn-type="success" parameter-map="[pageIndex:pageIndex,downPageIndex:downPageIndex,                                                 processStoryId:processStoryId,sequenceNum:sequenceNum,insertType:'above', isEmptyStory:false,                                                 clipboardEntryId:clipboardEntryId,pageSize:pageSize]"/></default-field></field><field name="insertBelow"><default-field><link url="pasteActivities" text="Below ${activityCount}" btn-type="success" parameter-map="                                         [pageIndex:pageIndex,downPageIndex:downPageIndex, processStoryId:processStoryId,sequenceNum:sequenceNum,insertType:'below', isEmptyStory:false,                                         clipboardEntryId:clipboardEntryId,pageSize:pageSize]"/></default-field></field></form-list></widgets></section><section name="PasteActivitiesEmptyProcess" condition="(isEmptyStory.toBoolean())"><widgets><form-list name="PasteActivitiesEmptyFormList" list="entryList" transition="pasteActivities"><row-actions><service-call name="coarchy.CoarchyServices.get#ClipboardActivityAndCount" in-map="[clipboardEntryId:clipboardEntryId]" out-map="context"/></row-actions><field name="activityText"><default-field title=""><display/></default-field></field><field name="insertFirst"><default-field title=""><link url="pasteActivities" text="Paste ${activityCount}" btn-type="success" parameter-map="                                         [pageIndex:pageIndex,downPageIndex:downPageIndex, processStoryId:processStoryId,sequenceNum:sequenceNum, isEmptyStory:true,                                         clipboardEntryId:clipboardEntryId,pageSize:pageSize]"/></default-field></field></form-list></widgets></section></box-body></container-box></widgets></section></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy/cointernal/Process/EditProcessStory/UpdateActivity.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="pageIndex"/><parameter name="pageSize"/><parameter name="orderByField"/><parameter name="processStoryId"/><parameter name="activityId"/><parameter name="condition"/><parameter name="actorIdList"/><parameter name="action"/><transition-include name="getActorList" location="component://coarchy/screen/coarchy/cointernal/Process/EditProcessStory.xml"/><transition name="updateActivity"><condition><expression><![CDATA[partyRelationshipCount > 0]]></expression></condition><service-call name="coarchy.CoarchyServices.update#Activity" in-map="context + [organizationId:activeOrgId]" out-map="context" multi="parameter"/><actions><set field="activityId" from="null"/><set field="condition" from="null"/><set field="actorIdList" from="null"/><set field="action" from="null"/></actions><default-response url=".."/></transition><actions><set field="activityActorList" from="[]"/><entity-find entity-name="coarchy.ActivityActorDetail" list="activityActorList"><econdition field-name="activityId"/><order-by field-name="name"/></entity-find><set field="actorIdList" from="activityActorList*.actorId"/><entity-find-count entity-name="coarchy.product.ProductEvaluationActivityAndDetail" count-field="existingEvaluationRecordCount"><econdition field-name="statusId" operator="not-equals" value="PeRequirementsSelection"/><econdition field-name="activityId"/><econdition field-name="excludeFlag" value="N" or-null="true"/><econdition field-name="organizationId" from="activeOrgId"/></entity-find-count><set field="canCopyOnWrite" from="existingEvaluationRecordCount > 0"/></actions><widgets><form-single name="UpdateActivityForm" transition="updateActivity" map="[condition:condition,                 actorIdList:actorIdList,action:action]"><field name="processStoryId"><default-field><hidden/></default-field></field><field name="activityId"><default-field><hidden/></default-field></field><field name="condition"><default-field><text-area rows="4" cols="40" autogrow="true"/></default-field></field><field name="actorIdList"><default-field title="Actor"><drop-down allow-empty="true" allow-multiple="true"><list-options list="activityActorList" key="${actorId}" text="${name}"/><dynamic-options server-search="true" transition="getActorList" min-length="0"/></drop-down></default-field></field><field name="action"><default-field><text-area rows="2" cols="80" autogrow="true"/></default-field></field><field name="implementationId"><default-field><drop-down allow-empty="true"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="ActivityImplementation"/><order-by field-name="sequenceNum"/></entity-find></entity-options></drop-down></default-field></field><field name="ignoreCopyOnWrite"><conditional-field title="" condition="canCopyOnWrite"><label text="This activity was used in at least one Product Evaluation. Do you also want these changes applied to any product evaluation? Warning! This is irreversible." style="text-negative"/><check no-current-selected-key="false"><option key="true" text="Yes, save the changes to all existing product evaluations."/></check></conditional-field><default-field title=""><hidden/></default-field></field><field name="submit"><default-field><submit text="Update"/></default-field></field></form-single></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy/cointernal/Process/EditProcessStory.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Full Edit" default-menu-index="40" menu-image="fa fa-file" menu-image-type="icon"><parameter name="processStoryId" required="true"/><parameter name="pageIndex" from="pageIndex?:0"/><parameter name="pageSize" from="pageSize?:50"/><parameter name="orderByField" value="sequenceNum"/><always-actions><if condition="!activeOrgId"><message><![CDATA[${ec.resource.expand('CoarchySelectAnOrg', null)}]]></message><script><![CDATA[sri.sendRedirectAndStopRender('/settings/Organizations')]]></script></if><entity-find-count entity-name="mantle.party.PartyRelationship" count-field="partyRelationshipCount"><date-filter/><econdition field-name="relationshipTypeEnumId" value="PrtMember"/><econdition field-name="toRoleTypeId" value="OrgInternal"/><econdition field-name="fromPartyId" from="ec.user.userAccount.partyId"/><econdition field-name="toPartyId" from="activeOrgId"/></entity-find-count><entity-find-count entity-name="mantle.party.PartyActivation" count-field="partyActivationCount"><date-filter/><econdition field-name="partyId" from="activeOrgId"/></entity-find-count></always-actions><transition-include name="getCloneOrganizationList" location="component://coarchy/screen/coarchy/cointernal/Process/ProcessStory.xml"/><transition-include name="getProcessStoryList" location="component://coarchy/screen/coarchy/cointernal/Process/ProcessStory.xml"/><transition-include name="getActivityList" location="component://coarchy/screen/coarchy/cointernal/Process/ProcessStory.xml"/><transition-include name="newParagraph" location="component://coarchy/screen/coarchy/cointernal/Process/ProcessStory.xml"/><transition-include name="createActivity" location="component://coarchy/screen/coarchy/cointernal/Process/ProcessStory.xml"/><transition-include name="updateActivity" location="component://coarchy/screen/coarchy/cointernal/Process/ProcessStory.xml"/><transition-include name="deleteActivity" location="component://coarchy/screen/coarchy/cointernal/Process/ProcessStory.xml"/><transition-include name="activityMoveUp" location="component://coarchy/screen/coarchy/cointernal/Process/ProcessStory.xml"/><transition-include name="activityMoveDown" location="component://coarchy/screen/coarchy/cointernal/Process/ProcessStory.xml"/><transition-include name="moveActivities" location="component://coarchy/screen/coarchy/cointernal/Process/ProcessStory.xml"/><transition-include name="copyActivities" location="component://coarchy/screen/coarchy/cointernal/Process/ProcessStory.xml"/><transition-include name="deleteActivities" location="component://coarchy/screen/coarchy/cointernal/Process/ProcessStory.xml"/><transition-include name="getActorList" location="component://coarchy/screen/coarchy/cointernal/Process/ProcessStory.xml"/><transition-include name="updateProcessStory" location="component://coarchy/screen/coarchy/cointernal/Process/ProcessStory.xml"/><transition-include name="enableProcessStory" location="component://coarchy/screen/coarchy/cointernal/Process/ProcessStory.xml"/><transition-include name="disableProcessStory" location="component://coarchy/screen/coarchy/cointernal/Process/ProcessStory.xml"/><transition-include name="createChecklist" location="component://coarchy/screen/coarchy/cointernal/Process/ProcessStory.xml"/><transition name="goProcessStory"><default-response url="../EditProcessStory" parameter-map="[processStoryId:processStoryId]"/></transition><transition-include name="createActor" location="component://coarchy/screen/coarchy/cointernal/Actor.xml"/><transition-include name="importText" location="component://coarchy/screen/coarchy/cointernal/Process/ProcessStory.xml"/><transition-include name="getCloneOrganizationList" location="component://coarchy/screen/coarchy/cointernal/Home.xml"/><transition-include name="upgradeParty" location="component://coarchy/screen/coarchy/cointernal/Home.xml"/><actions><entity-find-one entity-name="coarchy.ProcessStory" value-field="processStory"/><if condition="!processStory"><script><![CDATA[sri.sendRedirectAndStopRender('/coapp/Process/FindProcessStory')]]></script></if><if condition="pageIndex==null"><set field="pageIndex" from="0"/></if><if condition="actorIdList"><entity-find entity-name="coarchy.Actor" list="headerActorList"><econdition field-name="actorId" operator="in" from="actorIdList"/><order-by field-name="name"/></entity-find></if><entity-find-count entity-name="coarchy.ProcessStoryActivity" count-field="activityCount"><date-filter/><econdition field-name="processStoryId"/></entity-find-count><entity-find entity-name="coarchy.ProcessStoryActivityDetail" list="detailActivityList"><date-filter/><econdition field-name="replacedByActivityId" operator="is-null"/><econdition field-name="detailProcessStoryId" from="processStoryId"/><select-field field-name="processStoryId,name"/><order-by field-name="-lastUpdatedStamp"/></entity-find><set field="showMoveUpDown" from="(!orderByField || orderByField == 'sequenceNum') && !actorIdList && !condition && !action"/><entity-find entity-name="coarchy.ProcessStoryActivityDetail" list="processStoryActivityList" distinct="true"><search-form-inputs default-order-by="sequenceNum,action"/><date-filter/><econdition field-name="replacedByActivityId" operator="is-null"/><econdition field-name="processStoryId"/><econdition field-name="actorId" operator="in" from="actorIdList" ignore-if-empty="true"/><select-field field-name="processStoryActivityId,sequenceNum,detailProcessStoryId,action,condition,activityId,implementationId"/></entity-find><entity-find-count entity-name="coarchy.ClipboardEntry" count-field="clipboardEntryCount"><econdition field-name="partyId" from="ec.user.userAccount?.partyId"/></entity-find-count></actions><widgets><section name="FreemiumBanner" condition="partyActivationCount == 0"><widgets><container type="q-banner inline-actions rounded dense" style="bg-grey-3 text-black q-mb-md"><label text="To enable all the features upgrade organization '${activeOrg.organizationName}' to Premium" type="b"/><container type="template v-slot:action"><form-single name="UpgradeForm" transition="upgradeParty"><field name="upgrade"><default-field><submit text="Upgrade" type="success" confirmation="Activating will cost 1 Organization-Month Credit per month while ${activeOrg.organizationName} is upgraded. Are you sure?"/></default-field></field></form-single></container></container></widgets></section><label text="Process Story${processStory?.name?' - '+processStory.name:''}" type="h4"/><container-dialog id="AddActivityDialog" button-text="Add Activity" type="success"><form-single name="AddActivity" transition="createActivity"><field name="insertSequenceNum" from="processStoryActivityList?.size() > 0 ?                             processStoryActivityList?.last()?.sequenceNum+1:0"><default-field><hidden/></default-field></field><field name="newPageIndex" from="(processStoryActivityListPageRangeHigh <                             processStoryActivityListCount) || (processStoryActivityListPageRangeHigh == processStoryActivityListCount                             && processStoryActivityListCount == pageSize.toInteger()*(processStoryActivityListPageMaxIndex.toInteger()+1))?pageIndex?.toInteger()+1:pageIndex"><default-field><hidden/></default-field></field><field name="processStoryId"><default-field><hidden/></default-field></field><field name="sequenceNum"><default-field><hidden/></default-field></field><field name="condition"><default-field title="Condition (optional)"><text-area rows="2" autogrow="true"/></default-field></field><field name="actorIdList"><default-field title="Actor"><drop-down allow-empty="true" allow-multiple="true"><list-options list="activityActorList" key="${actorId}" text="${name}"/><dynamic-options server-search="true" transition="getActorList" min-length="0"/></drop-down></default-field></field><field name="action"><default-field title="Action"><text-area rows="2" autogrow="true"/></default-field></field><field name="implementationId"><default-field title="Implementation Status"><drop-down allow-empty="true"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="ActivityImplementation"/><order-by field-name="sequenceNum"/></entity-find></entity-options></drop-down></default-field></field><field name="submit"><default-field><submit text="Add Activity" type="success"/></default-field></field></form-single></container-dialog><container-dialog id="AddChecklistDialog" button-text="New Checklist" type="success" condition="partyRelationshipCount > 0"><form-single name="AddChecklistForm" transition="createChecklist"><field name="pageIndex"><default-field><hidden/></default-field></field><field name="processStoryId"><default-field><hidden/></default-field></field><field name="name" from="processStory?.name"><default-field><text-line/></default-field></field><field name="submit"><default-field><submit text="Add"/></default-field></field></form-single></container-dialog><link url="../EditProcessStory" parameter-map="[processStoryId:detailActivityList?.getFirst()?.processStoryId]" text="Go to Parent Story: ${detailActivityList?.getFirst()?.name}" condition="detailActivityList.size() == 1 && detailActivityList?.getFirst()?.processStoryId"/><container-dialog id="GoProcessStoryDialogue" button-text="Go to Parent Story" condition="detailActivityList.size() > 1"><form-single name="GoProcessStoryForm" transition="goProcessStory"><field name="pageIndex"><default-field><hidden/></default-field></field><field name="processStoryId" from="null"><default-field title="Process Story"><drop-down allow-empty="true" required-manual-select="true" submit-on-select="true"><list-options list="detailActivityList" key="${processStoryId}" text="${name}"/></drop-down></default-field></field></form-single></container-dialog><container-dialog id="AddActorDialogue" button-text="Add Actor" type="success" condition="partyRelationshipCount > 0"><form-single name="AddActor" transition="createActor"><field name="pageIndex"><default-field><hidden/></default-field></field><field name="processStoryId"><default-field><hidden/></default-field></field><field name="name"><default-field><text-line/></default-field></field><field name="description"><default-field><text-area autogrow="true"/></default-field></field><field name="submit"><default-field><submit text="Add"/></default-field></field></form-single></container-dialog><container-dialog id="ImportTextDialogue" button-text="Import Text" type="success" condition="partyRelationshipCount > 0 && ec.user.isInGroup('ADMIN')"><form-single name="ImportText" transition="importText"><field name="pageIndex"><default-field><hidden/></default-field></field><field name="processStoryId"><default-field><hidden/></default-field></field><field name="text"><default-field><label text="This will add each sentence as an activity with paragraph breaks."/><text-area autogrow="true"/></default-field></field><field name="submit"><default-field><submit text="Add"/></default-field></field></form-single></container-dialog><container-dialog id="UpdateStoryDialog" button-text="Story Name"><form-single name="UpdateProcessStory" transition="updateProcessStory"><field name="pageIndex"><default-field><hidden/></default-field></field><field name="processStoryId"><default-field><hidden/></default-field></field><field name="name" from="processStory?.name"><default-field title="Process Story Name"><text-line size="50"/></default-field></field><field name="submit"><default-field><submit text="Submit"/></default-field></field></form-single></container-dialog><link url="enableProcessStory" text="Show Process Story" parameter-map="[processStoryId:processStoryId]" condition="partyRelationshipCount > 0 && processStory?.disabled == 'Y'"/><link url="disableProcessStory" text="Hide Process Story" parameter-map="[processStoryId:processStoryId]" condition="partyRelationshipCount > 0 && processStory?.disabled != 'Y'"/><form-list name="ProcessStory" header-dialog="true" list="processStoryActivityList" show-csv-button="true" show-page-size="true" select-columns="true" map-last-row="[actorIdList:null,condition:null,action:null,implementationId:null]"><row-actions><set field="activityActorList" from="[]"/><entity-find entity-name="coarchy.ActivityActorDetail" list="activityActorList"><econdition field-name="activityId"/><order-by field-name="name"/></entity-find><set field="actorIdList" from="activityActorList*.actorId"/><set field="actors" from="activityActorList*.name?.join(', ')"/><set field="processStoryActivity" from="[condition:condition,action:action,actorNames:activityActorList*.name]"/><set field="activity" from="ec.resource.template('component://coarchy/template/ActivityStyled.html.ftl', '.ftl')"/><entity-find-one entity-name="moqui.basic.Enumeration" value-field="implementation" cache="true" auto-field-map="[enumId:implementationId]"/></row-actions><row-selection id-field="activityId"><action><dialog button-text="Copy To" title="Copy activities to another organization or process story"/><form-single name="CopyToActivities" transition="moveActivities" pass-through-parameters="true"><field name="moveType" from="'copy'"><default-field><hidden/></default-field></field><field name="organizationId" from="activeOrgId"><default-field title="Organization"><drop-down allow-empty="true" required-manual-select="true"><dynamic-options transition="getCloneOrganizationList" min-length="0"/></drop-down></default-field></field><field name="processStoryId" from="null"><default-field title="Process Story"><drop-down allow-empty="true" required-manual-select="true"><dynamic-options transition="getProcessStoryList" min-length="0"><depends-on field="organizationId"/></dynamic-options></drop-down></default-field></field><field name="insertActivityId"><default-field title="Activity"><drop-down allow-empty="true" required-manual-select="true"><dynamic-options transition="getActivityList" min-length="0"><depends-on field="organizationId"/><depends-on field="processStoryId"/></dynamic-options></drop-down></default-field></field><field name="insertType" from="'below'"><default-field><radio><option key="above" text="Above"/><option key="below" text="Below"/></radio></default-field></field><field name="submitBtn"><default-field><submit text="Copy"/></default-field></field></form-single></action><action><dialog button-text="Move To" title="Cut activities to another organization or process story"/><form-single name="MoveToActivities" transition="moveActivities" pass-through-parameters="true"><field name="moveType" from="'cut'"><default-field><hidden/></default-field></field><field name="organizationId" from="activeOrgId"><default-field title="Organization"><drop-down allow-empty="true" required-manual-select="true"><dynamic-options transition="getCloneOrganizationList" min-length="0"/></drop-down></default-field></field><field name="processStoryId" from="null"><default-field title="Process Story"><drop-down allow-empty="true" required-manual-select="true"><dynamic-options transition="getProcessStoryList" min-length="0"><depends-on field="organizationId"/></dynamic-options></drop-down></default-field></field><field name="insertActivityId"><default-field title="Activity"><drop-down allow-empty="true" required-manual-select="true"><dynamic-options transition="getActivityList" min-length="0"><depends-on field="organizationId"/><depends-on field="processStoryId"/></dynamic-options></drop-down></default-field></field><field name="insertType" from="'below'"><default-field><radio><option key="above" text="Above"/><option key="below" text="Below"/></radio></default-field></field><field name="submitBtn"><default-field><submit text="Cut"/></default-field></field></form-single></action><action><form-single name="CopyActivities" transition="copyActivities"><field name="moveTypeEnumId" from="'CbmtCopy'"><default-field><hidden/></default-field></field><field name="processStoryId"><default-field><hidden/></default-field></field><field name="pageIndex"><default-field><hidden/></default-field></field><field name="pageSize"><default-field><hidden/></default-field></field><field name="orderByField"><default-field><hidden/></default-field></field><field name="activityId"><default-field><hidden/></default-field></field><field name="submitBtn"><default-field><submit text="Copy"/></default-field></field><field-layout><field-row-big><field-ref name="submitBtn"/></field-row-big></field-layout></form-single></action><action><form-single name="CutActivities" transition="copyActivities"><field name="moveTypeEnumId" from="'CbmtCut'"><default-field><hidden/></default-field></field><field name="processStoryId"><default-field><hidden/></default-field></field><field name="pageIndex"><default-field><hidden/></default-field></field><field name="pageSize"><default-field><hidden/></default-field></field><field name="orderByField"><default-field><hidden/></default-field></field><field name="activityId"><default-field><hidden/></default-field></field><field name="submitBtn"><default-field><submit text="Cut"/></default-field></field><field-layout><field-row-big><field-ref name="submitBtn"/></field-row-big></field-layout></form-single></action><action><form-single name="DeleteActivities" transition="deleteActivities"><field name="processStoryId"><default-field><hidden/></default-field></field><field name="pageIndex"><default-field><hidden/></default-field></field><field name="pageSize"><default-field><hidden/></default-field></field><field name="orderByField"><default-field><hidden/></default-field></field><field name="submitBtn"><default-field><submit text="Delete" confirmation="Are you sure? You can't undo deleting an activity."/></default-field></field><field-layout><field-row><field-ref name="submitBtn"/></field-row></field-layout></form-single></action></row-selection><hidden-parameters><parameter name="processStoryId"/></hidden-parameters><field name="activityId"><default-field><hidden/></default-field></field><field name="pageIndex"><default-field><hidden/></default-field></field><field name="pageSize"><default-field><hidden/></default-field></field><field name="insertSequenceNum"><last-row-field><hidden default-value="${processStoryActivityList?.size() > 0 ?processStoryActivityList?.last()?.sequenceNum+1:0}"/></last-row-field></field><field name="newPageIndex"><last-row-field><hidden default-value="${(processStoryActivityListPageRangeHigh < processStoryActivityListCount) || (processStoryActivityListPageRangeHigh == processStoryActivityListCount && processStoryActivityListCount == pageSize.toInteger()*(processStoryActivityListPageMaxIndex.toInteger()+1))?pageIndex?.toInteger()+1:pageIndex}"/></last-row-field></field><field name="move"><default-field title="Move"><link url="activityMoveUp" parameter-map="[processStoryActivityId:processStoryActivityId,sequenceNum:sequenceNum,pageIndex:processStoryActivityListPageRangeLow==(processStoryActivityListPageRangeLow+processStoryActivityList_index)?pageIndex.toInteger()-1:pageIndex]" condition="showMoveUpDown && (processStoryActivityListPageRangeLow!=1 || processStoryActivityListPageRangeLow!=(processStoryActivityListPageRangeLow+processStoryActivityList_index))" icon="fa fa-angle-up" text=""/><link url="activityMoveDown" parameter-map="[processStoryActivityId:processStoryActivityId,sequenceNum:sequenceNum,pageIndex:processStoryActivityListPageRangeLow+processStoryActivityList_index==processStoryActivityListPageRangeHigh?pageIndex.toInteger()+1:pageIndex]" condition="showMoveUpDown && (processStoryActivityListPageRangeHigh < processStoryActivityListCount || processStoryActivityListPageRangeLow+processStoryActivityList_index!=processStoryActivityListPageRangeHigh)" icon="fa fa-angle-down" text=""/></default-field></field><field name="sequenceNum"><default-field><display/></default-field></field><field name="implementationId"><header-field title="Implementation Status" show-order-by="case-insensitive"><drop-down allow-empty="true"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="ActivityImplementation"/><order-by field-name="sequenceNum"/></entity-find></entity-options></drop-down></header-field><default-field><label text="${implementation?.description?:'No Status'}"/></default-field></field><field name="activity"><default-field><render-mode><text type="html,vuet,qvt" location="component://coarchy/template/ActivityStyled.html.ftl"/></render-mode></default-field></field><field name="condition"><header-field title="Condition (optional)" show-order-by="case-insensitive"><text-find size="25"/></header-field><default-field><display/></default-field></field><field name="actorIdList"><header-field title="Actor"><drop-down allow-empty="true" allow-multiple="true"><list-options list="headerActorList" key="${actorId}" text="${name}"/><dynamic-options server-search="true" transition="getActorList" min-length="0"/></drop-down></header-field><default-field><label text="${actors}"/></default-field></field><field name="action"><header-field title="Action" show-order-by="case-insensitive"><text-find size="25"/></header-field><default-field><display/></default-field></field><field name="submit"><header-field title="Find"><submit/></header-field><conditional-field condition="action"><dynamic-dialog id="UpdateDialogue" button-text="Edit" transition="UpdateActivity" parameter-map="[activityId:activityId,condition:condition,actorIdList:actorIdList,action:action,                         processStoryId:processStory?.processStoryId?:processStoryId,implementationId:implementationId]"/></conditional-field><last-row-field><container-dialog id="AddActivityDialog" button-text="Add Activity" type="success"><form-single name="AddActivity" transition="createActivity"><field name="insertSequenceNum" from="processStoryActivityList?.size() > 0 ?                             processStoryActivityList?.last()?.sequenceNum+1:0"><default-field><hidden/></default-field></field><field name="newPageIndex" from="(processStoryActivityListPageRangeHigh <                             processStoryActivityListCount) || (processStoryActivityListPageRangeHigh == processStoryActivityListCount                             && processStoryActivityListCount == pageSize.toInteger()*(processStoryActivityListPageMaxIndex.toInteger()+1))?pageIndex?.toInteger()+1:pageIndex"><default-field><hidden/></default-field></field><field name="processStoryId"><default-field><hidden/></default-field></field><field name="sequenceNum"><default-field><hidden/></default-field></field><field name="condition"><default-field title="Condition (optional)"><text-area rows="2" autogrow="true"/></default-field></field><field name="actorIdList"><default-field title="Actor"><drop-down allow-empty="true" allow-multiple="true"><list-options list="activityActorList" key="${actorId}" text="${name}"/><dynamic-options server-search="true" transition="getActorList" min-length="0"/></drop-down></default-field></field><field name="action"><default-field title="Action"><text-area rows="2" autogrow="true"/></default-field></field><field name="implementationId"><default-field title="Implementation Status"><drop-down allow-empty="true"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="ActivityImplementation"/><order-by field-name="sequenceNum"/></entity-find></entity-options></drop-down></default-field></field><field name="submit"><default-field><submit text="Add Activity" type="success"/></default-field></field></form-single></container-dialog></last-row-field></field><field name="actionMenu"><default-field title="Actions"><button-menu text="Actions"><dynamic-dialog id="InsertActivity" button-text="Insert" transition="InsertActivity" parameter-map="[processStoryId:processStory?.processStoryId?:processStoryId,isEmptyStory:!processStoryActivityList,sequenceNum:sequenceNum,pageIndex:pageIndex,downPageIndex:processStoryActivityListPageRangeLow-1+processStoryActivityListPageSize==processStoryActivityListPageRangeLow+processStoryActivityList_index?pageIndex.toInteger()+1:pageIndex]" condition="partyRelationshipCount > 0 && showMoveUpDown"/><dynamic-dialog id="ManageValuesDialog" button-text="Statements" transition="ManageValues" parameter-map="[activityId:activityId, dialogIndex: processStoryActivityList_index]" condition="partyRelationshipCount > 0 && action"/><dynamic-dialog id="SubstoryDialogue" transition="CreateOrSelectSubstory" button-text="Substory" parameter-map="[processStoryActivityId:processStoryActivityId]" condition="action && !detailProcessStoryId && partyRelationshipCount > 0"/><link url="../EditProcessStory" parameter-map="[processStoryId:detailProcessStoryId]" text="Substory" condition="detailProcessStoryId"/><link url="deleteActivity" confirmation="Are you sure? You can't undo deleting an activity." icon="fa fa-trash" btn-type="danger" text="Delete" tooltip="Delete Activity" parameter-map="[processStoryActivityId:processStoryActivityId,activityId:activityId,actorIdList:actorIdList,pageIndex:pageIndex]"/></button-menu></default-field><last-row-field><button-menu text="Actions" condition="!processStoryActivityList"><dynamic-dialog id="PasteActivity" button-text="Paste" transition="PasteActivity" parameter-map="[processStoryId:processStory?.processStoryId?:processStoryId, isEmptyStory:!processStoryActivityList]" condition="clipboardEntryCount > 0 && !processStoryActivityList"/><link url="newParagraph" text="⏎ Paragraph" tooltip="Add Paragraph Break" parameter-map="[insertSequenceNum:processStoryActivityList?.size()>0?processStoryActivityList?.last()?.sequenceNum+1:0,                         newPageIndex:((processStoryActivityListPageRangeHigh < processStoryActivityListCount) || (processStoryActivityListPageRangeHigh == processStoryActivityListCount &&                         processStoryActivityListCount == pageSize.toInteger()*(processStoryActivityListPageMaxIndex.toInteger()+1))?pageIndex.toInteger()+1:pageIndex)]"/></button-menu><link url="newParagraph" text="⏎ Paragraph" tooltip="Add Paragraph Break" condition="processStoryActivityList" parameter-map="[insertSequenceNum:processStoryActivityList?.size()>0?processStoryActivityList?.last()?.sequenceNum+1:0,                     newPageIndex:((processStoryActivityListPageRangeHigh < processStoryActivityListCount) || (processStoryActivityListPageRangeHigh == processStoryActivityListCount &&                     processStoryActivityListCount == pageSize.toInteger()*(processStoryActivityListPageMaxIndex.toInteger()+1))?pageIndex.toInteger()+1:pageIndex)]"/></last-row-field></field><columns><column><field-ref name="move"/></column><column><field-ref name="activity"/></column><column><field-ref name="submit"/></column><column><field-ref name="actionMenu"/></column></columns></form-list></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy/cointernal/Process.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Process Stories" default-menu-index="30" menu-image="/ssstatic/images/Wiki.png"><subscreens default-item="FindProcessStory"/><widgets><subscreens-panel id="user-panel" type="tab"/></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy/cointernal/Products/EvalReports.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Summary"><transition name="generateEvaluationReport" begin-transaction="false" read-only="true"><actions><entity-find-one entity-name="mantle.party.Organization" value-field="activeOrg"><field-map field-name="partyId" from="activeOrgId"/></entity-find-one><service-call name="coarchy.ReportServices.prepare#EvaluationStatementReport" in-map="context+[organizationId:activeOrgId]" out-map="statementsOut"/><service-call name="coarchy.ReportServices.prepare#EvaluationStoryReport" in-map="context+[organizationId:activeOrgId]" out-map="storyOut"/><service-call name="coarchy.ReportServices.prepare#EvaluationSummary" in-map="context+[organizationId:activeOrgId]" out-map="summaryOut"/><script><![CDATA[import java.io.OutputStream;

                import org.apache.poi.ss.usermodel.*;
                import org.apache.poi.xssf.usermodel.XSSFSheet;
                import org.apache.poi.xssf.usermodel.XSSFWorkbook;

                import org.moqui.context.ExecutionContext
                ExecutionContext ec = context.ec

                def response = ec.web.response
                def filename = "EvaluationReport_${activeOrg?.organizationName}_${ec.l10n.format(ec.user.nowTimestamp, 'yyyyMMdd_HHmm')}"

                response.setCharacterEncoding("UTF-8")
                response.setContentType('application/vnd.ms-excel')
                response.setHeader("Cache-Control", "no-cache, must-revalidate, private")
                response.setHeader("Content-Disposition", "attachment; filename=\"${filename}.xlsx\";")

                CellStyle makeHeaderStyle(Workbook wb) {
                    Font headerFont = wb.createFont()
                    headerFont.setBold(true)
                    headerFont.setFontHeight(9);
            
                    CellStyle style = createNoBorderStyle(wb)
                    style.setAlignment(HorizontalAlignment.LEFT)
                    style.setFillForegroundColor(IndexedColors.GREY_25_PERCENT.getIndex())
                    style.setFillPattern(FillPatternType.SOLID_FOREGROUND)
                    style.setFont(headerFont)
            
                    return style
                }        
                CellStyle makeRowDefaultStyle(Workbook wb) {
                    Font rowFont = wb.createFont()
                    rowFont.setBold(false)
                    rowFont.setFontHeight(9);

                    CellStyle style = createNoBorderStyle(wb)
                    style.setAlignment(HorizontalAlignment.LEFT)
                    style.setFont(rowFont)
                    style.setWrapText(true)
            
                    return style
                }
                CellStyle createBorderedStyle(Workbook wb){
                    BorderStyle thin = BorderStyle.THIN
                    short black = IndexedColors.BLACK.getIndex()
            
                    CellStyle style = wb.createCellStyle()
                    style.setBorderRight(thin)
                    style.setRightBorderColor(black)
                    style.setBorderBottom(thin)
                    style.setBottomBorderColor(black)
                    style.setBorderLeft(thin)
                    style.setLeftBorderColor(black)
                    style.setBorderTop(thin)
                    style.setTopBorderColor(black)
                    return style
                }
                CellStyle createNoBorderStyle(Workbook wb) {
                    BorderStyle noBorder = BorderStyle.NONE
                    CellStyle style = wb.createCellStyle()
                    style.setBorderRight(noBorder)
                    style.setBorderBottom(noBorder)
                    style.setBorderLeft(noBorder)
                    style.setBorderTop(noBorder)
                    style.setVerticalAlignment(VerticalAlignment.TOP)
                    // logger.warn("created no border style ${style.properties}")
                    return style
                }
                
                XSSFWorkbook workbook = new XSSFWorkbook();
                CellStyle headerStyle = makeHeaderStyle(workbook)
                CellStyle rowDefaultStyle = makeRowDefaultStyle(workbook)
        
                // Prepare summary sheet
                XSSFSheet summary = workbook.createSheet("Summary");
                def summaryFieldMapList = [
                    [key:'productName', 'label':'Product', sequenceNum:1],
                    [key:'evalCount', 'label':'Evaluations (ct.)', sequenceNum:2],
                    [key:'avgInternalRating', 'label':'Internal Rating (avg)', sequenceNum:3],
                    [key:'avgVendorRating', 'label':'Vendor Rating (avg)', sequenceNum:4],
                    [key:'internalFullGapCount', 'label':'Internal Full Gap (ct.)', sequenceNum:5],
                    [key:'vendorFullGapCount', 'label':'Vendor Full Gap (ct.)', sequenceNum:6],
                    [key:'internalPartialOverlapCount', 'label':'Internal Partial Overlap (ct.)', sequenceNum:7],
                    [key:'vendorPartialOverlapCount', 'label':'Vendor Partial Overlap (ct.)', sequenceNum:8],
                    [key:'internalFullOverlapCount', 'label':'Internal Full Overlap (ct.)', sequenceNum:9],
                    [key:'vendorFullOverlapCount', 'label':'Vendor Full Overlap (ct.)', sequenceNum:10],
                ];

                int rowIndex = 0;
                int columnIndex = 0;
                Row row = summary.createRow(rowIndex++);

                // Create headers
                for (def fieldMap : summaryFieldMapList) {
                    Cell cell = row.createCell(columnIndex++);
                    cell.setCellStyle(headerStyle)                    
                    cell.setCellValue(fieldMap.label);
                }

                // Create data
                for (Map dataRow : summaryOut.outList) {
                    row = summary.createRow(rowIndex++);
                    columnIndex = 0;
                    
                    for (Map fieldMap : summaryFieldMapList) {
                        Cell cell = row.createCell(columnIndex++);
                        cell.setCellStyle(rowDefaultStyle)
                        def val = dataRow[fieldMap.key];     
                        if (val instanceof String) {
                            cell.setCellValue((String) val);
                        } else if (val instanceof Integer) {
                            cell.setCellValue((Integer) val);
                        } else if (val instanceof ArrayList) {
                            cell.setCellValue(val.join(', '));
                        } else {
                            cell.setCellValue((String) val);
                        }
                    }                        
                }

                for (int c = 0; c <= columnIndex; c++) summary.autoSizeColumn(c)
                for (int r = 0; r <= rowIndex; r++) if (r!=1) row.setHeight((short)-1);

                // Prepare statements sheet
                XSSFSheet statements = workbook.createSheet("Statements");                
                def statementsFieldMapList = [
                    [key:'_index_', 'label':'Seq', sequenceNum:1],
                    [key:'statementValue', 'label':'Statement', sequenceNum:2],
                    [key:'typeEnumId', 'label':'Type', sequenceNum:3],
                    [key:'tags', 'label':'Tags', sequenceNum:4],
                    [key:'evaluationName', 'label':'Evaluation Name', sequenceNum:5],
                    [key:'productName', 'label':'Product', sequenceNum:6],
                    [key:'evaluationByEnumId', 'label':'Response Type', sequenceNum:7],
                    [key:'rating', 'label':'Rating', sequenceNum:8],
                    [key:'implementationStatusEnumId', 'label':'Status', sequenceNum:9],
                    [key:'comments', 'label':'Comments', sequenceNum:10]
                ];

                rowIndex = 0;
                columnIndex = 0;
                row = statements.createRow(rowIndex++);
                
                // Create header
                for (def fieldMap : statementsFieldMapList) {
                    Cell cell = row.createCell(columnIndex++);
                    cell.setCellStyle(headerStyle)
                    cell.setCellValue(fieldMap.label);
                }

                // Create data
                for (Map dataRow : statementsOut.outList) {
                    row = statements.createRow(rowIndex++);                        
                    columnIndex = 0;
                    
                    for (Map fieldMap : statementsFieldMapList) {
                        Cell cell = row.createCell(columnIndex++);
                        cell.setCellStyle(rowDefaultStyle)
                        def val = dataRow[fieldMap.key];
                        if (fieldMap.key == '_index_'){
                            cell.setCellValue(rowIndex-1);
                            continue
                        }
                        if (val instanceof String) {
                            cell.setCellValue((String) val);
                        } else if (val instanceof Integer) {
                            cell.setCellValue((Integer) val);
                        } else if (val instanceof ArrayList) {
                            cell.setCellValue(val.join(', '));
                        } else {
                            cell.setCellValue((String) val);
                        }
                    }
                }

                for (int c = 0; c <= columnIndex; c++) if (c!=1) statements.autoSizeColumn(c) else statements.setColumnWidth(c, 80 * 256);
                for (int r = 0; r <= rowIndex; r++) if (r!=1) row.setHeight((short)-1);

                // Prepare prcess story sheets
                ArrayList<XSSFSheet> processStorySheets = new ArrayList<XSSFSheet>();
                def storyFieldMapList = [
                    [key:'sequence', 'label':'Sequence', sequenceNum:1],
                    [key:'activityText', 'label':'Activity', sequenceNum:1],
                    [key:'evaluationName', 'label':'Evaluation Name', sequenceNum:4],
                    [key:'productName', 'label':'Product', sequenceNum:5],
                    [key:'evaluationByEnumId', 'label':'Response Type', sequenceNum:6],
                    [key:'rating', 'label':'Rating', sequenceNum:7],
                    [key:'implementationStatusEnumId', 'label':'Status', sequenceNum:8],
                    [key:'comments', 'label':'Comments', sequenceNum:9]
                ];
                
                for (Map story: storyOut.outList) {
                    XSSFSheet curSheet = workbook.createSheet('Process Story - ' + story.processStoryName)
                    processStorySheets.add(curSheet);
                 
                    rowIndex = 0;
                    columnIndex = 0;
                    row = curSheet.createRow(rowIndex++);
                    
                    // Create header
                    for (def fieldMap : storyFieldMapList) {
                        Cell cell = row.createCell(columnIndex++);
                        cell.setCellStyle(headerStyle)
                        cell.setCellValue(fieldMap.label);
                    }

                    // Create data
                    for (Map activity : story.activityList) {
                        if (!activity.activityResponses){
                            columnIndex = 0;
                            row = curSheet.createRow(rowIndex++);
                            row.setHeight((short)-1);

                            for (int c = 0; c <= 3; c++) {
                                Cell cell = row.createCell(columnIndex++);
                                cell.setCellStyle(rowDefaultStyle)
                                cell.setCellValue(activity[storyFieldMapList[c].key]);
                            }
                            for (int c = 4; c <= 7; c++) {
                                cell = row.createCell(columnIndex++);
                                cell.setCellStyle(rowDefaultStyle)
                                cell.setCellValue('');
                            }                                                    

                            continue;
                        }

                        for (Map activityResponse : activity.activityResponses) {
                            row = curSheet.createRow(rowIndex++);
                                
                            columnIndex = 0;
                            
                            for (Map field : storyFieldMapList) {
                                Cell cell = row.createCell(columnIndex++);
                                cell.setCellStyle(rowDefaultStyle);
                                def val = activity[field.key]?:activityResponse[field.key];

                                if (val instanceof String) {
                                    cell.setCellValue((String) val);
                                } else if (val instanceof Integer) {
                                    cell.setCellValue((Integer) val);
                                } else if (val instanceof ArrayList) {
                                    cell.setCellValue(val.join(', '));
                                } else {
                                    cell.setCellValue((String) val);
                                }
                            }     
                        }
                    }
                    for (int c = 0; c <= columnIndex; c++) if (c!=1) curSheet.autoSizeColumn(c) else curSheet.setColumnWidth(c, 80 * 256);
                }

                OutputStream os = response.outputStream
                workbook.write(os);
                os.close();]]></script></actions><default-response type="none"/></transition><actions><service-call name="coarchy.ReportServices.prepare#EvaluationSummary" in-map="[organizationId:activeOrgId]" out-map="summaryOut"/></actions><widgets><container-dialog id="GenerateReportDialog" button-text="Export Report"><label text="You can select a subset of evaluations to report on. By default, the report runs on all completed evaluations." style="q-mb-lg" type="div"/><form-single name="ExportData" transition="generateEvaluationReport"><field name="filterProductEvaluationIds"><default-field title="Limit evaluations"><drop-down allow-multiple="true"><entity-options text="${productName}: ${evaluationName?:'Unnamed'}"><entity-find entity-name="coarchy.product.ProductEvaluationAndProduct"><econdition field-name="organizationId" from="activeOrgId"/><econdition field-name="statusId" value="PeCompleted"/></entity-find></entity-options></drop-down></default-field></field><field name="filterProductIds"><default-field title="Limit products"><drop-down allow-multiple="true"><entity-options text="${productName}"><entity-find entity-name="mantle.product.Product"><econdition field-name="hidden" value="N" or-null="true"/><econdition field-name="ownerPartyId" from="activeOrgId"/><econdition field-name="productClassEnumId" value="PclsCoarchy"/></entity-find></entity-options></drop-down></default-field></field><field name="thruDate"><default-field title="Until Date"><date-time/></default-field></field><field name="submit"><default-field title="Generate Report"><submit/></default-field></field><field-layout><field-ref name="filterProductEvaluationIds"/><field-ref name="filterProductIds"/><field-ref name="thruDate"/><field-ref name="submit"/></field-layout></form-single></container-dialog><label text="Summary" type="h4" style="q-mt-md"/><label text="This is a summary of all evaluations that have been completed." type="div"/><label text="For a detailed breakdown, use generate a report." type="div"/><form-list name="SummaryFormList" list="summaryOut.outList"><field name="productName"><default-field><display/></default-field></field><field name="evalCount"><default-field title="# of Evaluations"><display/></default-field></field><field name="avgInternalRating"><default-field><display/></default-field></field><field name="avgVendorRating"><default-field><display/></default-field></field><field name="internalFullGapCount"><default-field><display/></default-field></field><field name="vendorFullGapCount"><default-field><display/></default-field></field><field name="internalPartialOverlapCount"><default-field><display/></default-field></field><field name="vendorPartialOverlapCount"><default-field><display/></default-field></field><field name="internalFullOverlapCount"><default-field><display/></default-field></field><field name="vendorFullOverlapCount"><default-field><display/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy/cointernal/Products/EditProductEval/EvalInviteVendor.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true" default-menu-title="Invite Vendor"><widgets><section name="ProductVendorInviteListSection"><widgets><container-box><box-header><container-dialog id="ProductVendorInviteDialog" button-text="${(statusId=='PeAwaitingVendorResponse'?'Invite':'Add')}" button-style="float-right" condition="canInviteVendors"><container><label text="Send invitations to product vendor representatives with a request for information about the applicability of their product to your requirement statements and process story activities." condition="!isVendorView"/><label text="Invite your team members by adding their email address below." condition="isVendorView"/></container><form-single name="ProductVendorInviteForm" transition="inviteVendor"><field name="productEvaluationId"><default-field><hidden/></default-field></field><field name="emailAddress"><default-field><text-line input-type="email"/></default-field></field><field name="submit"><default-field><submit text="Invite"/></default-field></field><field-layout><field-col-row><field-col sm="9"><field-ref name="emailAddress"/></field-col><field-col sm="3"><field-ref name="submit"/></field-col></field-col-row></field-layout></form-single></container-dialog><label text="Vendor Representatives" style="text-bold q-mx-md"/></box-header><box-body><label text="Add as many vendor representatives you would like to evaluate the product, against these requirements. Invitations will only be sent when you click 'Finalize Invitations'." style="text-caption text-grey-8" condition="!isVendorView && ['PeRequirementsSelection','PeInviteVendors'].contains(statusId)"/><label text="You have invited the following vendors representatives to evaluate this product. You can either invite more representatives to collaborate, or let the invited representatives add more of their team members." style="text-caption text-grey-8" condition="!isVendorView && ['PeAwaitingVendorResponse'].contains(statusId)"/><label text="The following users are part of this evaluation. You can add team members to assist you with this evaluation by clicking on the 'Invite' button." style="text-caption text-grey-8" condition="isVendorView && ['PeAwaitingVendorResponse'].contains(statusId)"/><label text="The following users are part of this evaluation." style="text-caption text-grey-8" condition="isVendorView && !['PeAwaitingVendorResponse'].contains(statusId)"/><section name="VendorListSection" condition="vendorRepList"><widgets><form-list name="ProductVendorInviteList" list="vendorRepList"><row-actions><entity-find-one entity-name="mantle.party.PersonAndUserAccount" value-field="personAndAccount"><field-map field-name="partyId"/></entity-find-one></row-actions><field name="partyId"><default-field><hidden/></default-field></field><field name="combinedName"><default-field title="Representative Name"><display text="${personAndAccount?.firstName} ${personAndAccount?.lastName}" parameter-map="personAndAccount"/></default-field></field><field name="emailAddress"><default-field><display text="${personAndAccount.emailAddress}"/></default-field></field><field name="statusId"><conditional-field condition="statusId=='PepPlanned'"><display text="Pending" style="text-grey-8"/></conditional-field><conditional-field condition="['PepInvited','PepAccepted'].contains(statusId)"><display text="Invited" style="text-grey-8"/></conditional-field><default-field title="Status"><label text="N/A"/></default-field></field></form-list></widgets></section><section name="NoVendorListSection" condition="!vendorRepList"><widgets><container style="text-center"><label text="Please add at least one vendor representative to evaluate this product." style="text-bold text-negative"/></container></widgets></section></box-body></container-box></widgets></section></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy/cointernal/Products/EditProductEval/EvalList.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true" default-menu-title="Manage Statements"><parameter name="productEvaluationId" required="true"/><parameter name="activityId"/><parameter name="valueStatementId"/><parameter name="pageIndex"/><parameter name="pageSize"/><parameter name="orderByField"/><actions><if condition="valueStatementId"><entity-find-one entity-name="coarchy.ValueStatement" value-field="valueStatement"><field-map field-name="valueStatementId"/></entity-find-one></if><if condition="activityId"><entity-find-one entity-name="coarchy.Activity" value-field="activity"><field-map field-name="activityId"/></entity-find-one><set field="activityActorList" from="[]"/><entity-find entity-name="coarchy.ActivityActorDetail" list="activityActorList"><econdition field-name="activityId"/><order-by field-name="name"/></entity-find><set field="actorIdList" from="activityActorList*.actorId"/><set field="actors" from="activityActorList*.name?.join(', ')"/><set field="processStoryActivity" from="[condition:activity.condition,action:activity.action,actorNames:activityActorList*.name]"/><set field="activity" from="ec.resource.template('component://coarchy/template/ActivityStyled.html.ftl', '.ftl')"/></if><entity-find-count entity-name="mantle.party.PartyRelationship" count-field="partyRelationshipCount"><date-filter/><econdition field-name="relationshipTypeEnumId" value="PrtMember"/><econdition field-name="toRoleTypeId" value="OrgInternal"/><econdition field-name="fromPartyId" from="ec.user.userAccount.partyId"/><econdition field-name="toPartyId" from="activeOrgId"/></entity-find-count><set field="isUserInternalOrgMember" from="partyRelationshipCount > 0"/><entity-find entity-name="coarchy.product.ProductEvaluationResponse" list="productEvaluationResponseList"><econdition field-name="productEvaluationId"/><econdition field-name="organizationId" from="activeOrgId"/><econdition field-name="activityId" ignore="!activityId"/><econdition field-name="statementId" from="valueStatementId" ignore="!valueStatementId"/><econdition field-name="evaluationByEnumId" operator="in" value="EbInternal,EbVendor" ignore="isVendorView"/><econdition field-name="evaluationByEnumId" operator="in" value="EbVendor" ignore="!isVendorView"/><econdition field-name="evaluationByEnumId" operator="not-equals" value="EbInternal" ignore="isUserInternalOrgMember"/></entity-find></actions><widgets><section name="ShowActivityDescription" condition="activityId"><widgets><label text="The evaluations for the following activity are displayed below." type="div" style="text-grey-8"/><container style="q-pa-md"><render-mode><text type="html,vuet,qvt" location="component://coarchy/template/ActivityStyledSpan.html.ftl"/></render-mode></container></widgets></section><section name="ShowStatementDescription" condition="valueStatementId"><widgets><label text="The evaluations for the following statement are displayed below." type="div" style="text-grey-8"/><container style="q-pa-md"><label text="${valueStatement?.value}"/></container></widgets></section><form-list name="ProductEvalResponseFormList" list="productEvaluationResponseList" list-entry="responseEntry"><row-actions><entity-find-one entity-name="mantle.party.PersonWithUserAccount" value-field="userAccount"><field-map field-name="userId" from="responseEntry.lastEditedByUserId"/></entity-find-one></row-actions><field name="productEvaluationId"><default-field><hidden/></default-field></field><field name="activityId"><default-field><hidden/></default-field></field><field name="statementId"><default-field><hidden/></default-field></field><field name="evaluationByEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="lastEditedByUserId"><default-field title="Last updated by"><label text="${ec.resource.expand('UsernameTemplate','',userAccount)}" condition="userAccount"/></default-field></field><field name="implementationStatusEnumId"><default-field title="Implementation Status"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="rating"><default-field title="Quality Rating"><display/></default-field></field><field name="comments"><default-field title="Comments"><display/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy/cointernal/Products/EditProductEval/EvalResponse.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true" default-menu-title="Manage Statements"><parameter name="productEvaluationId" required="true"/><parameter name="activityId"/><parameter name="valueStatementId "/><parameter name="processStoryIds "/><parameter name="typeEnumIds"/><parameter name="pageIndex"/><parameter name="pageSize"/><parameter name="orderByField"/><transition name="addEvalResponse"><service-call name="coarchy.ProductEvaluationServices.add#ProductEvaluationResponse" in-map="[productEvaluationId:productEvaluationId, activityId:activityId, statementId:statementId, implementationStatusEnumId:implementationStatusEnumId, rating:rating, comments:comments,organizationId:activeOrgId, isVendor:isVendor,  _openDialog:_openDialog]" out-map="context" multi="parameter"/><conditional-response url="../EvalProcessStories" parameter-map="[_openDialog:_openDialog, productEvaluationId:productEvaluationId, activityId:null,statementId:null, processStoryIds:processStoryIds]"><condition><expression><![CDATA[activityId]]></expression></condition></conditional-response><conditional-response url="../EvalStatements" parameter-map="[_openDialog:_openDialog, productEvaluationId:productEvaluationId, activityId:null,statementId:null,typeEnumIds:typeEnumIds]"><condition><expression><![CDATA[statementId]]></expression></condition></conditional-response><default-response url="../EvalStatements" parameter-map="[_openDialog:_openDialog, productEvaluationId:productEvaluationId, activityId:null,statementId:null,typeEnumIds:typeEnumIds]"/></transition><actions><entity-find-one entity-name="coarchy.product.ProductEvaluation" value-field="productEvaluation"/><entity-find-count entity-name="mantle.party.PartyRelationship" count-field="partyRelationshipCount"><date-filter/><econdition field-name="relationshipTypeEnumId" value="PrtMember"/><econdition field-name="toRoleTypeId" value="OrgInternal"/><econdition field-name="fromPartyId" from="ec.user.userAccount.partyId"/><econdition field-name="toPartyId" from="productEvaluation.organizationId"/></entity-find-count><set field="isUserInternalOrgMember" from="partyRelationshipCount > 0"/><if condition="valueStatementId"><entity-find-one entity-name="coarchy.ValueStatement" value-field="valueStatement"><field-map field-name="valueStatementId"/></entity-find-one></if><if condition="activityId"><entity-find-one entity-name="coarchy.Activity" value-field="activity"><field-map field-name="activityId"/></entity-find-one><set field="activityActorList" from="[]"/><entity-find entity-name="coarchy.ActivityActorDetail" list="activityActorList"><econdition field-name="activityId"/><order-by field-name="name"/></entity-find><set field="actorIdList" from="activityActorList*.actorId"/><set field="actors" from="activityActorList*.name?.join(', ')"/><set field="processStoryActivity" from="[condition:activity.condition,action:activity.action,actorNames:activityActorList*.name]"/><set field="activity" from="ec.resource.template('component://coarchy/template/ActivityStyled.html.ftl', '.ftl')"/></if><entity-find entity-name="coarchy.product.ProductEvaluationResponse" list="productEvaluationResponseList"><econdition field-name="productEvaluationId"/><econdition field-name="activityId" ignore="!activityId"/><econdition field-name="statementId" from="valueStatementId" ignore="!valueStatementId"/><econdition field-name="evaluationByEnumId" value="EbInternal" ignore="isVendorView"/><econdition field-name="evaluationByEnumId" value="EbVendor" ignore="!isVendorView"/><econdition field-name="evaluationByEnumId" operator="not-equals" value="EbInternal" ignore="isUserInternalOrgMember"/></entity-find><if condition="productEvaluationResponseList.size() > 0"><set field="productEvaluationResponse" from="productEvaluationResponseList[0]"/></if><if condition="activityId"><entity-find entity-name="coarchy.ValueStatementActivityDetail" list="valueStatementActivityList"><econditions><econdition field-name="fromDate" operator="less-equals" from="productEvaluation.requirementsSetDate" or-null="true"/><econdition field-name="thruDate" operator="greater-equals" from="productEvaluation.requirementsSetDate" or-null="true"/></econditions><date-filter valid-date="productEvaluation.requirementsSetDate"/><econdition field-name="activityId"/><select-field field-name="activityId,value,typeEnumId"/></entity-find></if></actions><widgets><section name="ShowActivityDescription" condition="activityId"><widgets><label text="Evaluate the following activity against the product." type="div" style="text-grey-8"/><container style="q-pa-md"><render-mode><text type="html,vuet,qvt" location="component://coarchy/template/ActivityStyledSpan.html.ftl"/></render-mode></container></widgets></section><section name="ShowStatementDescription" condition="valueStatementId"><widgets><label text="Evaluate the following statement against the product." type="div" style="text-grey-8"/><container style="q-pa-md"><label text="${valueStatement?.value}"/></container></widgets></section><label text="Please consider following statements when evaluating this activity. " type="div" style="q-mt-xs text-grey-8" condition="valueStatementActivityList"/><section name="ValueStatementListContainer" condition="valueStatementActivityList"><widgets><container style="q-pa-md"><section-iterate name="ValueStatementList" list="valueStatementActivityList" entry="valueStatementActivity"><actions><entity-find-one entity-name="moqui.basic.Enumeration" value-field="typeEnum" auto-field-map="[enumId:valueStatementActivity.typeEnumId]"/></actions><widgets><label text="${valueStatementActivity_index+1}. ${valueStatementActivity.value} (${typeEnum.description})" type="div" style="text-bold"/></widgets></section-iterate></container></widgets></section><form-single name="AddProductEvalResponseForm" transition="addEvalResponse" map="productEvaluationResponse"><field name="productEvaluationId"><default-field><hidden/></default-field></field><field name="activityId"><default-field><hidden/></default-field></field><field name="statementId" from="valueStatementId"><default-field><hidden/></default-field></field><field name="typeEnumIds" from="typeEnumIds"><default-field><hidden/></default-field></field><field name="processStoryIds" from="processStoryIds"><default-field><hidden/></default-field></field><field name="isVendor" from="isVendorView"><default-field><hidden/></default-field></field><field name="implementationStatusEnumId"><default-field title="Implementation Status"><drop-down submit-on-select="false" allow-empty="false" allow-multiple="false" no-current-selected-key="IsPartialOverlap"><entity-options><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="ImplementationStatus"/></entity-find></entity-options></drop-down></default-field></field><field name="rating"><default-field title="Quality Rating"><radio no-current-selected-key="5"><option key="1" text="1"/><option key="2" text="2"/><option key="3" text="3"/><option key="4" text="4"/><option key="5" text="5"/><option key="6" text="6"/><option key="7" text="7"/><option key="8" text="8"/><option key="9" text="9"/></radio></default-field></field><field name="comments"><default-field title="Comments"><text-area/></default-field></field><field name="submit"><default-field title="${productEvaluationResponse?'Update Evaluation':'Add Evaluation'}"><submit/></default-field></field><field-layout><field-ref name="implementationStatusEnumId"/><field-ref name="rating"/><field-ref name="comments"/><field-ref name="submit"/></field-layout></form-single></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy/cointernal/Products/EditProductEval/EvalHeader.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true" default-menu-title="Product Evaluation Header"><widgets><section name="FreemiumBanner" condition="partyActivationCount == 0"><widgets><container type="q-banner inline-actions rounded dense" style="bg-grey-3 text-black q-mb-md"><label text="To enable all the features upgrade organization '${activeOrg.organizationName}' to Premium" type="b"/><container type="template v-slot:action"><form-single name="UpgradeForm" transition="upgradeParty"><field name="upgrade"><default-field><submit text="Upgrade" type="success" confirmation="Activating will cost 1 Organization-Month Credit per month while ${activeOrg.organizationName} is upgraded. Are you sure?"/></default-field></field></form-single></container></container></widgets></section><section name="TitleStatusSection"><widgets><container><container-row style="q-mt-md"><row-col sm="8" xs="6"><label text="Product Evaluation on ${productEvaluation?.productName}" style="text-h4"/><container style="q-mb-md"><label text="In the Requirements Selection step, add the requirements you want the product to be evaluated against." style="text-subtitle2 text-grey-8" condition="!isVendorView && (statusId == 'PeRequirementsSelection')"/><label text="Send invitations to product vendor representatives with a request for information about the applicability of their product to your requirement statements and process story activities." style="text-subtitle2 text-grey-8" condition="!isVendorView && (statusId == 'PeInviteVendors')"/><label text="You are waiting for vendor evaluations. You can track their responses below." style="text-subtitle2 text-grey-8" condition="!isVendorView && (statusId == 'PeAwaitingVendorResponse')"/><label text="This Product Evaluation is awaiting your responses. Please review the statements and stories below." style="text-subtitle2 text-grey-8" condition="isVendorView && (statusId == 'PeAwaitingVendorResponse')"/></container><section name="EvalActionsSection" condition="!isVendorView"><widgets><link url="finalizeActivitySelection" text="Finalize Requirements Selection" confirmation="Are you sure you want to finalize the requirements selection?" btn-type="success" tooltip="Finalize Requirements Selection" parameter-map="[productEvaluationId:productEvaluationId]" condition="statusId=='PeRequirementsSelection'"/><link url="reopenActivitySelection" text="Modify Requirements" parameter-map="[productEvaluationId:productEvaluationId]" condition="statusId=='PeInviteVendors'"/><link url="finalizeVendorInvitations" text="Finalize Invitations" confirmation="Are you sure you want to finalize the vendor invitations?" btn-type="success" tooltip="Finalize Vendor Invitations" parameter-map="[productEvaluationId:productEvaluationId]" condition="statusId=='PeInviteVendors'"/><link url="cancelProductEvaluation" text="Cancel Evaluation" confirmation="Are you sure you want to cancel this product evaluation?" btn-type="danger" tooltip="Cancel Product Evaluation" parameter-map="[productEvaluationId:productEvaluationId]" condition="['PeRequirementsSelection','PeInviteVendors'].contains(statusId)"/><link url="reopenProductEvaluation" text="Re-open Evaluation" parameter-map="[productEvaluationId:productEvaluationId]" condition="statusId=='PeCompleted'"/><section name="CompleteSection" condition="['PeAwaitingVendorResponse'].contains(statusId)"><widgets><link url="completeProductEvaluation" text="Complete Evaluation" confirmation="Are you sure you want to complete this product evaluation?" btn-type="success" tooltip="Complete Product Evaluation" parameter-map="[productEvaluationId:productEvaluationId]" condition="!hasWarnings"/><container-dialog id="CompleteEvaluationDialog" button-text="Complete Warnings" condition="hasWarnings" type="success"><label text="Not all Statements have internal evaluations" style="q-mx-sm text-danger" type="p" condition="!internalRespondedToAllStatements"/><label text="Not all Statements have vendor evaluations" style="q-mx-sm text-danger" type="p" condition="!vendorRespondedToAllStatements"/><label text="Not all Process Stories have internal evaluations" style="q-mx-sm text-danger" type="p" condition="!internalRespondedToAllStories"/><label text="Not all Process Stories have vendor evaluations" style="q-mx-sm text-danger" type="p" condition="!vendorRespondedToAllStories"/><link url="completeProductEvaluation" text="Complete Evaluation Anyway" link-type="hidden-form"/></container-dialog></widgets></section></widgets></section></row-col><row-col sm="4" xs="6" style="float-right"><container><label text="Status" style="text-bold"/></container><container style="text-subtitle1"><section name="StatusInteralSection" condition="!isVendorView"><widgets><label text="Requirements Selection" style="${(statusId == 'PeRequirementsSelection')?'text-primary':'text-grey-8'}"/><label text=" / "/><label text="Vendor Invitations" style="${(statusId == 'PeInviteVendors')?'text-primary':'text-grey-8'}"/><label text=" / "/><label text="Awaiting Responses" style="${(statusId == 'PeAwaitingVendorResponse')?'text-primary':'text-grey-8'}"/><label text=" / "/></widgets><fail-widgets><label text="Awaiting Response" style="${(statusId == 'PeAwaitingVendorResponse')?'text-primary':'text-grey-8'}"/><label text=" / "/></fail-widgets></section><label text="Complete" style="${(statusId == 'PeCompleted')?'text-primary':'text-grey-8'}" condition="statusId != 'PeCancelled'"/><label text="Cancelled" style="text-negative text-bold" condition="(statusId == 'PeCancelled')"/></container></row-col></container-row></container></widgets></section></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy/cointernal/Products/EditProductEval/EvalStatements.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Statements" default-menu-index="10" menu-image="fa fa-file" menu-image-type="icon" default-menu-include="false"><parameter name="productEvaluationId" required="true"/><parameter name="typeEnumIds"/><transition name="filterStatementType"><default-response url="." parameter-map="[productEvaluationId:productEvaluationId,typeEnumIds:typeEnumIds]"/></transition><transition name="includeStatement"><parameter name="productEvaluationId" required="true"/><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><actions><service-call name="coarchy.ProductEvaluationServices.include#ProductEvaluationStatement" in-map="[productEvaluationId:productEvaluationId,statementId:statementId,organizationId:activeOrgId]"/></actions><default-response url="." parameter-map="[productEvaluationId:productEvaluationId,typeEnumIds:typeEnumIds]"/></transition><transition name="excludeStatement"><parameter name="productEvaluationId" required="true"/><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><actions><service-call name="coarchy.ProductEvaluationServices.exclude#ProductEvaluationStatement" in-map="[productEvaluationId:productEvaluationId,statementId:statementId,organizationId:activeOrgId]"/></actions><default-response url="." parameter-map="[productEvaluationId:productEvaluationId,typeEnumIds:typeEnumIds]"/></transition><transition-include name="upgradeParty" location="component://coarchy/screen/coarchy/cointernal/Home.xml"/><transition-include name="inviteVendor" location="component://coarchy/screen/coarchy/cointernal/Products/EditProductEval.xml"/><transition-include name="reopenProductEvaluation" location="component://coarchy/screen/coarchy/cointernal/Products/EditProductEval.xml"/><transition-include name="finalizeActivitySelection" location="component://coarchy/screen/coarchy/cointernal/Products/EditProductEval.xml"/><transition-include name="finalizeVendorInvitations" location="component://coarchy/screen/coarchy/cointernal/Products/EditProductEval.xml"/><transition-include name="reopenActivitySelection" location="component://coarchy/screen/coarchy/cointernal/Products/EditProductEval.xml"/><transition-include name="cancelProductEvaluation" location="component://coarchy/screen/coarchy/cointernal/Products/EditProductEval.xml"/><transition-include name="completeProductEvaluation" location="component://coarchy/screen/coarchy/cointernal/Products/EditProductEval.xml"/><actions><entity-find-one entity-name="coarchy.product.ProductEvaluationAndProduct" value-field="productEvaluation"/><set field="statusId" from="productEvaluation.statusId"/><service-call name="coarchy.ProductEvaluationServices.get#ProductEvaluationStatements" in-map="[productEvaluationId:productEvaluationId]" out-map="productEvalStatements"/><service-call name="coarchy.ProductEvaluationServices.get#ProductEvaluationResponseStats" in-map="[productEvaluationId:productEvaluationId]" out-map="context"/><set field="canModifyStatements" from="statusId == 'PeRequirementsSelection'"/></actions><widgets><section-include name="FreemiumBanner" location="component://coarchy/screen/coarchy/cointernal/Products/EditProductEval/EvalHeader.xml"/><section-include name="TitleStatusSection" location="component://coarchy/screen/coarchy/cointernal/Products/EditProductEval/EvalHeader.xml"/><container-row style="q-mt-lg"><row-col style="${showInviteVendorsSection?'col-8':'col-12'}"><container-row><row-col sm="12"><label text="Statements" style="text-bold" type="div"/><container type="div"><label text="By default, all statements in your organization will be evaluated by the vendors. You can choose to Include/Exclude them by clicking on the buttons below." style="text-caption text-grey-8" condition="!isVendorView && (statusId=='PeRequirementsSelection')"/><label text="The following statements will be evaluated by vendors." style="text-caption text-grey-8" condition="!isVendorView && (statusId!='PeRequirementsSelection')"/><label text="Evaluate the following statements." style="text-caption text-grey-8" condition="isVendorView && (statusId!='PeRequirementsSelection')"/></container></row-col></container-row><container-row style="overflow-hidden"><row-col sm="12"><form-single name="FilterStatementType" transition="filterStatementType"><field name="productEvaluationId"><default-field><hidden/></default-field></field><field name="typeEnumIds"><default-field title="Filter By Statement Type"><drop-down allow-empty="true" allow-multiple="true"><entity-options><entity-find entity-name="moqui.basic.Enumeration"><econdition field-name="enumTypeId" value="ValueType"/></entity-find></entity-options></drop-down></default-field></field><field name="submit"><default-field title="Filter"><submit/></default-field></field><field-layout><field-col-row><field-col xs="10"><field-ref name="typeEnumIds"/></field-col><field-col xs="2"><field-ref name="submit"/></field-col></field-col-row></field-layout></form-single></row-col></container-row><container-row style="overflow-hidden"><row-col sm="12"><form-list name="EvalStatementsList" list="allValueStatementList"><entity-find entity-name="coarchy.ValueStatement" list="allValueStatementList"><search-form-inputs default-order-by="typeEnumId"/><econditions combine="or"><econdition field-name="valueStatementId" operator="in" from="productEvalStatements.valueStatementIds"/><econditions combine="and"><econdition field-name="replacedByValueStatementId" operator="is-null"/><econdition field-name="disabled" value="N" or-null="true"/></econditions></econditions><econdition field-name="typeEnumId" operator="in" from="typeEnumIds" ignore-if-empty="true"/><econdition field-name="organizationId" operator="in" from="productEvaluation.organizationId"/><econdition field-name="valueStatementId" operator="in" from="productEvalStatements.valueStatementIds" ignore="canModifyStatements"/></entity-find><row-actions><set field="isStatementIncluded" from="productEvalStatements.valueStatementIds.contains(valueStatementId)"/><set field="responseCount" from="vendorResponseByStatement[valueStatementId]"/><set field="internalResponseCount" from="internalResponseByStatement[valueStatementId]"/><set field="vendorResponseComplete" from="responseCount > 0"/><set field="internalResponseComplete" from="internalResponseCount > 0"/></row-actions><field name="toggleInclusion"><conditional-field condition="canModifyStatements && isStatementIncluded" title=""><link url="excludeStatement" text="Included" btn-type="success" condition="isStatementIncluded" icon="fa fa-check" style="text-caption" parameter-map="[productEvaluationId:productEvaluationId, statementId:valueStatementId, typeEnumIds:typeEnumIds]"/></conditional-field><conditional-field condition="canModifyStatements && !isStatementIncluded" title=""><link url="includeStatement" text="Excluded" btn-type="danger" condition="!isStatementIncluded" icon="fa fa-close" style="text-caption" parameter-map="[productEvaluationId:productEvaluationId, statementId:valueStatementId, typeEnumIds:typeEnumIds]"/></conditional-field><default-field title=""><hidden/></default-field></field><field name="valueStatementId"><default-field><hidden/></default-field></field><field name="productEvaluationId" from="productEvaluationId"><default-field><hidden/></default-field></field><field name="value"><conditional-field title="Statement" condition="isStatementIncluded"><render-mode><text><![CDATA[${value}]]></text></render-mode></conditional-field><conditional-field title="Statement" condition="!isStatementIncluded"><render-mode><text><![CDATA[<s class="text-grey-8">${value}</s>]]></text></render-mode></conditional-field></field><field name="typeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="actions"><conditional-field condition="isVendorView" title=""><dynamic-dialog id="StatementResponseDialog" title="Evaluate Statement" button-text="${vendorResponseComplete?'Update':'Evaluate'}" transition="../EvalResponse" parameter-map="[valueStatementId:valueStatementId,typeEnumIds:typeEnumIds]" button-style="text-caption" type="${vendorResponseComplete?'success':'danger'}" condition="showVendorRespondButton"/><dynamic-dialog id="StatementResponseListDialog" title="Statement Evaluations" button-text="View (${responseCount})" transition="../EvalList" parameter-map="[valueStatementId:valueStatementId]" button-style="text-caption" condition="showReponseListButton"/></conditional-field><conditional-field condition="!isVendorView" title=""><dynamic-dialog id="StatementResponseDialog" title="Add Internal Evaluation on Statement" button-text="${internalResponseComplete?'Update Internal':'Internal Evaluation'}" transition="../EvalResponse" parameter-map="[valueStatementId:valueStatementId,typeEnumIds:typeEnumIds]" button-style="text-caption" type="${internalResponseComplete?'success':'danger'}" condition="showInternalRespondButton"/><dynamic-dialog id="StatementResponseListDialog" title="Statement Evaluations" button-text="View (${responseCount+internalResponseCount})" transition="../EvalList" parameter-map="[valueStatementId:valueStatementId]" button-style="text-caption" condition="showReponseListButton"/></conditional-field><default-field title=""><hidden/></default-field></field></form-list></row-col></container-row></row-col><row-col style="${showInviteVendorsSection?'col-4':'hidden'}"><section name="ProductVendorInviteContainerSection" condition="showInviteVendorsSection"><widgets><section-include name="ProductVendorInviteListSection" location="component://coarchy/screen/coarchy/cointernal/Products/EditProductEval/EvalInviteVendor.xml"/></widgets></section></row-col></container-row></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy/cointernal/Products/EditProductEval/EvalProcessStories.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Process Stories" default-menu-index="20" menu-image="fa fa-file" menu-image-type="icon" default-menu-include="false"><parameter name="productEvaluationId" required="true"/><parameter name="processStoryIds"/><parameter name="anchor"/><transition name="filterProcessStories"><default-response url="." parameter-map="[productEvaluationId:productEvaluationId,processStoryIds:processStoryIds]"/></transition><transition name="addProcessStory"><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><service-call name="coarchy.ProductEvaluationServices.add#ProductEvaluationProcessStory" in-map="[productEvaluationId:productEvaluationId,processStoryIds:processStoryIds,organizationId:activeOrgId]" out-map="context" multi="parameter"/><default-response parameter-map="[productEvaluationId:productEvaluationId,processStoryIds:null]"/></transition><transition name="removeProcessStory"><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><service-call name="coarchy.ProductEvaluationServices.remove#ProductEvaluationProcessStory" in-map="[productEvaluationId:productEvaluationId,processStoryId:processStoryId,organizationId:activeOrgId]" out-map="context" multi="parameter"/><default-response parameter-map="[productEvaluationId:productEvaluationId,processStoryIds:null]"/></transition><transition name="includeActivity" method="post"><parameter name="productEvaluationId" required="true"/><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><actions><service-call name="coarchy.ProductEvaluationServices.include#ProductEvaluationActivity" in-map="[productEvaluationId:productEvaluationId,processStoryId:processStoryId,activityId:activityId,organizationId:activeOrgId]"/></actions><default-response url="/coapp/Products/EditProductEval/EvalProcessStories" parameter-map="[productEvaluationId:productEvaluationId, processStoryIds:processStoryIds?:[],anchor:activityId]"/></transition><transition name="excludeActivity" method="post"><parameter name="productEvaluationId" required="true"/><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><actions><service-call name="coarchy.ProductEvaluationServices.exclude#ProductEvaluationActivity" in-map="[productEvaluationId:productEvaluationId,processStoryId:processStoryId,activityId:activityId,organizationId:activeOrgId]"/></actions><default-response url="/coapp/Products/EditProductEval/EvalProcessStories" parameter-map="[productEvaluationId:productEvaluationId, processStoryIds:processStoryIds?:[],anchor:activityId]"/></transition><transition-include name="upgradeParty" location="component://coarchy/screen/coarchy/cointernal/Home.xml"/><transition-include name="inviteVendor" location="component://coarchy/screen/coarchy/cointernal/Products/EditProductEval.xml"/><transition-include name="reopenProductEvaluation" location="component://coarchy/screen/coarchy/cointernal/Products/EditProductEval.xml"/><transition-include name="finalizeActivitySelection" location="component://coarchy/screen/coarchy/cointernal/Products/EditProductEval.xml"/><transition-include name="finalizeVendorInvitations" location="component://coarchy/screen/coarchy/cointernal/Products/EditProductEval.xml"/><transition-include name="reopenActivitySelection" location="component://coarchy/screen/coarchy/cointernal/Products/EditProductEval.xml"/><transition-include name="cancelProductEvaluation" location="component://coarchy/screen/coarchy/cointernal/Products/EditProductEval.xml"/><transition-include name="completeProductEvaluation" location="component://coarchy/screen/coarchy/cointernal/Products/EditProductEval.xml"/><actions><entity-find-one entity-name="coarchy.product.ProductEvaluationAndProduct" value-field="productEvaluation"/><set field="statusId" from="productEvaluation.statusId"/><entity-find entity-name="coarchy.product.ProductEvaluationStoryDetail" list="productEvalStoryList"><econdition field-name="productEvaluationId"/></entity-find><set field="processStoryIdList" from="productEvalStoryList*.processStoryId"/><entity-find entity-name="coarchy.product.ProductEvaluationStoryDetail" list="filterProductEvalStoryList"><econdition field-name="productEvaluationId"/><econdition field-name="processStoryId" operator="in" from="processStoryIds" ignore-if-empty="true"/></entity-find><service-call name="coarchy.ProductEvaluationServices.get#ProductEvaluationActivites" in-map="[productEvaluationId:productEvaluationId]" out-map="productEvalActivities"/><service-call name="coarchy.ProductEvaluationServices.get#ProductEvaluationResponseStats" in-map="[productEvaluationId:productEvaluationId]" out-map="context"/><set field="canModifyProcessStory" from="statusId == 'PeRequirementsSelection'"/><set field="showExcludedActivities" from="statusId == 'PeRequirementsSelection'"/></actions><widgets><section-include name="FreemiumBanner" location="component://coarchy/screen/coarchy/cointernal/Products/EditProductEval/EvalHeader.xml"/><section-include name="TitleStatusSection" location="component://coarchy/screen/coarchy/cointernal/Products/EditProductEval/EvalHeader.xml"/><container-row style="q-mt-lg"><row-col style="${showInviteVendorsSection?'col-8':'col-12'}"><container type="div"><label text="Process Stories" style="text-bold"/><container-dialog id="AddProcessStoryDialog" icon="add" button-text="Add Process Story to Evaluation" button-style="text-caption float-right" type="info" condition="canModifyProcessStory"><form-single name="AddProcessStoryForm" transition="addProcessStory"><field name="productEvaluationId"><default-field><hidden/></default-field></field><field name="processStoryIds"><default-field title="Process Stories"><drop-down allow-empty="false" allow-multiple="true"><entity-options key="${processStoryId}" text="${name}"><entity-find entity-name="coarchy.ProcessStory"><econdition field-name="organizationId" from="activeOrgId"/></entity-find></entity-options></drop-down></default-field></field><field name="submit"><default-field><submit text="Add"/></default-field></field></form-single></container-dialog></container><container type="div"><label text="Add the process stories you would like to be evaluated by vendors. You can include/exclude specific activities by clicking on the buttons below." style="text-caption text-grey-8" condition="!isVendorView && (statusId=='PeRequirementsSelection')"/><label text="The following process story activities will be evaluated by vendors." style="text-caption text-grey-8" condition="!isVendorView && (statusId!='PeRequirementsSelection')"/><label text="Evaluate the following process stories and activites." style="text-caption text-grey-8" condition="isVendorView && (statusId!='PeRequirementsSelection')"/></container><container-row style="overflow-hidden"><row-col sm="12"><form-single name="FilterProcessStory" transition="filterProcessStories"><field name="productEvaluationId"><default-field><hidden/></default-field></field><field name="processStoryIds"><default-field title="Filter By Process Story"><drop-down allow-empty="true" allow-multiple="true" submit-on-select="false"><list-options list="productEvalStoryList" key="${processStoryId}" text="${name}"/></drop-down></default-field></field><field name="submit"><default-field title="Filter"><submit/></default-field></field><field-layout><field-col-row><field-col xs="10"><field-ref name="processStoryIds"/></field-col><field-col xs="2"><field-ref name="submit"/></field-col></field-col-row></field-layout></form-single></row-col><row-col sm="12"><label text="Showing ${filterProductEvalStoryList.size()} of ${processStoryIdList.size()} process stories" style="text-bold"/><section-iterate name="ProcessStorySection" list="filterProductEvalStoryList" entry="filterProductEvalStory"><actions><set field="processStoryId" from="filterProductEvalStory.processStoryId"/><set field="showSubstories" value="Y"/><service-call name="coarchy.ProductEvaluationServices.find#ProcessStoryActivityList" in-map="[productEvaluationId:productEvaluationId,processStoryId:processStoryId,                                     showSubstories:showSubstories,organizationId:productEvaluation.organizationId]" out-map="context"/><set field="hasSubstories" from="processStoryActivityList*.detailProcessStoryId.any{ it != null }"/><set field="showSubstoriesActual" from="showSubstories=='Y' && hasSubstories"/></actions><widgets><container-box><box-header><container type="span" style="q-mr-xs"><link url="removeProcessStory" parameter-map="[processStoryId:processStoryId]" text="Remove" style="text-caption text-negative" condition="canModifyProcessStory"/></container><label text="Process Story (${filterProductEvalStory_index+1} of ${processStoryIdList.size()})" style="q-pr-sm"/><label text="${filterProductEvalStory?.name?' - '+filterProductEvalStory.name:''}" style="text-bold"/></box-header><box-body><render-mode><text type="html,vuet,qvt" location="component://coarchy/template/ProcessStoryEvalOutline.html.ftl"/></render-mode></box-body></container-box></widgets></section-iterate></row-col></container-row></row-col><row-col style="${showInviteVendorsSection?'col-4':'hidden'}"><section name="ProductVendorInviteContainerSection" condition="showInviteVendorsSection"><widgets><section-include name="ProductVendorInviteListSection" location="component://coarchy/screen/coarchy/cointernal/Products/EditProductEval/EvalInviteVendor.xml"/></widgets></section></row-col></container-row><text type="html,vuet,qvt"><![CDATA[<script>
                let anchorId = '${anchor!''}';
                if (anchorId){
                    const elements = $('#'+anchorId)
                    if (elements.length){
                        const element = elements[0];
                        const topPos = element.getBoundingClientRect().top + window.pageYOffset

                        window.scrollTo({
                        top: topPos - 60, // Account for q-header (~58px in height)
                        behavior: 'smooth' // smooth scroll
                        })
                    }
                }
            </script>]]></text></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy/cointernal/Products/EditProductEval.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Evaluate Product" default-menu-index="20" menu-image="fa fa-file" menu-image-type="icon" default-menu-include="false"><parameter name="productEvaluationId" required="true"/><always-actions><if condition="!activeOrgId"><message><![CDATA[${ec.resource.expand('CoarchySelectAnOrg', null)}]]></message><script><![CDATA[sri.sendRedirectAndStopRender('/settings/Organizations')]]></script></if><entity-find-count entity-name="mantle.party.PartyRelationship" count-field="partyRelationshipCount"><date-filter/><econdition field-name="relationshipTypeEnumId" value="PrtMember"/><econdition field-name="toRoleTypeId" value="OrgInternal"/><econdition field-name="fromPartyId" from="ec.user.userAccount.partyId"/><econdition field-name="toPartyId" from="activeOrgId"/></entity-find-count><entity-find-count entity-name="mantle.party.PartyActivation" count-field="partyActivationCount"><date-filter/><econdition field-name="partyId" from="activeOrgId"/></entity-find-count><entity-find-one entity-name="coarchy.product.ProductEvaluation" value-field="productEvaluation"/><if condition="!productEvaluation"><if condition="isVendorView"><script><![CDATA[sri.sendRedirectAndStopRender('/vendor')]]></script><else><script><![CDATA[sri.sendRedirectAndStopRender('/settings/Organizations')]]></script></else></if></if><set field="statusId" from="productEvaluation?.statusId"/><if condition="isVendorView && ['PeRequirementsSelection','PeInviteVendors'].contains(statusId)"><return error="true" message="Not allowed"/></if><set field="showReponseListButton" from="['PeAwaitingVendorResponse','PeCompleted','PeCancelled'].contains(statusId)"/><set field="showVendorRespondButton" from="isVendorView && (statusId == 'PeAwaitingVendorResponse')"/><set field="showInternalRespondButton" from="!isVendorView && (statusId == 'PeAwaitingVendorResponse')"/><entity-find entity-name="coarchy.product.ProductEvaluationParty" list="vendorRepList"><date-filter/><econdition field-name="productEvaluationId"/><econdition field-name="roleTypeId" value="VendorRepresentative"/></entity-find><set field="canInviteVendors" from="['PeRequirementsSelection','PeInviteVendors','PeAwaitingVendorResponse'].contains(statusId)"/><set field="showInviteVendorsSection" from="['PeInviteVendors','PeAwaitingVendorResponse','PeCompleted','PeCancelled'].contains(statusId)"/><service-call name="coarchy.ProductEvaluationServices.get#ProductEvaluationCompleteWarnings" in-map="[productEvaluationId:productEvaluationId]" out-map="context"/></always-actions><transition name="inviteVendor"><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><service-call name="coarchy.ProductEvaluationServices.add#ProductEvaluationParty" in-map="[productEvaluationId:productEvaluationId,emailAddress:emailAddress,firstName:firstName,lastName:lastName,organizationId:activeOrgId]" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="finalizeActivitySelection"><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><service-call name="coarchy.ProductEvaluationServices.finalize#ProductEvaluationActivitySelection" in-map="[productEvaluationId:productEvaluationId]" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="finalizeVendorInvitations"><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><service-call name="coarchy.ProductEvaluationServices.finalize#ProductEvaluationVendorInvitations" in-map="[productEvaluationId:productEvaluationId]" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="reopenActivitySelection"><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><service-call name="coarchy.ProductEvaluationServices.reopen#ProductEvaluationActivitySelection" in-map="[productEvaluationId:productEvaluationId]" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="cancelProductEvaluation"><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><service-call name="coarchy.ProductEvaluationServices.cancel#ProductEvaluation" in-map="[productEvaluationId:productEvaluationId]" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="completeProductEvaluation"><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><service-call name="coarchy.ProductEvaluationServices.complete#ProductEvaluation" in-map="[productEvaluationId:productEvaluationId]" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="reopenProductEvaluation"><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><service-call name="coarchy.ProductEvaluationServices.uncomplete#ProductEvaluation" in-map="[productEvaluationId:productEvaluationId]" out-map="context" multi="parameter"/><default-response url="."/></transition><subscreens default-item="EvalStatements"><subscreens-item name="EvalStatements" menu-include="true" menu-index="10" location="component://coarchy/screen/coarchy/cointernal/Products/EditProductEval/EvalStatements.xml"/><subscreens-item name="EvalProcessStories" menu-include="true" menu-index="20" location="component://coarchy/screen/coarchy/cointernal/Products/EditProductEval/EvalProcessStories.xml"/></subscreens><widgets><subscreens-panel id="ProductEvalPanel" type="tab"/></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy/cointernal/Products/FindProducts.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Find" default-menu-index="60" menu-image="fa fa-search" menu-image-type="icon"><parameter name="pageIndex" from="pageIndex?:0"/><parameter name="pageSize"/><parameter name="orderByField" value="productName"/><always-actions><if condition="!activeOrgId"><message type="info"><![CDATA[Select an Organization before moving forward.]]></message><script><![CDATA[sri.sendRedirectAndStopRender('/settings/Organizations')]]></script></if><entity-find-count entity-name="mantle.party.PartyRelationship" count-field="partyRelationshipCount"><date-filter/><econdition field-name="relationshipTypeEnumId" value="PrtMember"/><econdition field-name="toRoleTypeId" value="OrgInternal"/><econdition field-name="fromPartyId" from="ec.user.userAccount.partyId"/><econdition field-name="toPartyId" from="activeOrgId"/></entity-find-count><entity-find-count entity-name="mantle.party.PartyActivation" count-field="partyActivationCount"><date-filter/><econdition field-name="partyId" from="activeOrgId"/></entity-find-count></always-actions><transition name="createProduct"><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><service-call name="coarchy.CoarchyServices.create#Product" in-map="[productName:productName,description:description,organizationId:activeOrgId]" out-map="context" multi="parameter"/><default-response/><error-response url="." save-parameters="true"/></transition><transition name="updateProduct"><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><service-call name="coarchy.CoarchyServices.update#Product" in-map="[productId:productId,productName:productName,description:description,organizationId:activeOrgId]" out-map="context" multi="parameter"/><default-response/><error-response url="." save-parameters="true"/></transition><transition name="hideProduct"><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><actions><service-call name="update#mantle.product.Product" in-map="[productId:productId, ownerPartyId:activeOrgId, hidden:'Y']"/></actions><default-response/></transition><transition name="unhideProduct"><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><actions><service-call name="update#mantle.product.Product" in-map="[productId:productId, ownerPartyId:activeOrgId, hidden:'N']"/></actions><default-response/></transition><transition name="createProductEvaluation"><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><service-call name="coarchy.ProductEvaluationServices.create#ProductEvaluation" in-map="[productId:productId,processStoryIds:processStoryIds,evaluationName:evaluationName,emailAddress:emailAddress,organizationId:activeOrgId]" out-map="context" multi="parameter"/><default-response/><error-response url="." save-parameters="true"/></transition><transition name="cancelProductEvaluation"><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><service-call name="coarchy.ProductEvaluationServices.cancel#ProductEvaluation" in-map="[productEvaluationId:productEvaluationId]" out-map="context" multi="parameter"/><default-response/><error-response url="."/></transition><transition name="goToProductEvaluation"><default-response url="../EditProductEval" parameter-map="[productEvaluationId:productEvaluationId]"/></transition><transition-include name="upgradeParty" location="component://coarchy/screen/coarchy/cointernal/Home.xml"/><widgets><section name="FreemiumBanner" condition="partyActivationCount == 0"><widgets><container type="q-banner inline-actions rounded dense" style="bg-grey-3 text-black q-mb-md"><label text="To enable all the features upgrade organization '${activeOrg.organizationName}' to Premium" type="b"/><container type="template v-slot:action"><form-single name="UpgradeForm" transition="upgradeParty"><field name="upgrade"><default-field><submit text="Upgrade" type="success" confirmation="Activating will cost 1 Organization-Month Credit per month while ${activeOrg.organizationName} is upgraded. Are you sure?"/></default-field></field></form-single></container></container></widgets></section><label text="Products" type="h4"/><container-dialog id="CreateProductDialog" button-text="Add Product" type="success"><form-single name="CreateProductForm" transition="createProduct"><field name="productName"><default-field><text-line/></default-field></field><field name="description"><default-field><text-area rows="2" cols="80" autogrow="true"/></default-field></field><field name="submit"><default-field><submit text="Add Product"/></default-field></field></form-single></container-dialog><form-list name="ProductListForm" header-dialog="true" show-page-size="true" select-columns="true" saved-finds="true" show-csv-button="true" list="productList" transition="updateProduct" transition-last-row="createProduct" map-last-row="[productName:null,description:null]"><entity-find entity-name="mantle.product.Product" list="productList"><search-form-inputs><default-parameters hidden="N"/></search-form-inputs><econdition field-name="productClassEnumId" value="PclsCoarchy"/><econdition field-name="ownerPartyId" from="activeOrgId"/></entity-find><row-actions><entity-find entity-name="mantle.product.ProductParty" list="vendorRepList"><date-filter/><econdition field-name="productId"/><econdition field-name="roleTypeId" value="VendorRepresentative"/></entity-find></row-actions><field name="productId"><default-field><hidden/></default-field></field><field name="hidden"><header-field><drop-down><option key="Y" text="Y"/><option key="N" text="N"/></drop-down></header-field><default-field><hidden/></default-field></field><field name="productName"><header-field show-order-by="case-insensitive"><text-find/></header-field><conditional-field condition="hidden=='Y'"><display/></conditional-field><default-field><text-line/></default-field><last-row-field><text-line/></last-row-field></field><field name="description"><header-field><text-find/></header-field><conditional-field condition="hidden=='Y'"><display/></conditional-field><default-field><text-area rows="2" cols="80" autogrow="true"/></default-field><last-row-field><text-area rows="2" cols="80" autogrow="true"/></last-row-field></field><field name="submit"><header-field><submit text="Submit"/></header-field><conditional-field condition="hidden=='Y'"/><default-field><submit text="Update"/></default-field><last-row-field><submit text="Add Product" type="success"/></last-row-field></field><field name="hide"><conditional-field condition="hidden=='Y'"><link url="unhideProduct" parameter-map="[productId:productId]" icon="fa fa-eye" btn-type="success" text=" " tooltip="Unhide" confirmation="Unhide product '${productName}'?"/></conditional-field><default-field title=""><link url="hideProduct" parameter-map="[productId:productId]" icon="fa fa-eye-slash" btn-type="danger" text=" " tooltip="Hide Product" confirmation="Hide Product '${productName}'?"/></default-field></field></form-list><container-dialog id="CreateProductEvaluationDialog" button-text="Evaluate Product" type="success"><form-single name="CreateProductEvaluationForm" transition="createProductEvaluation"><field name="productId"><default-field title="Product To Evaluate"><label text="Product Selection" style="text-bold q-mt-md"/><label text="Select the product you want to evaluate" style="text-caption text-grey-8 q-pb-sm" type="div"/><drop-down allow-empty="false"><entity-options key="${productId}" text="${productName}"><entity-find entity-name="mantle.product.Product"><econdition field-name="hidden" value="N" or-null="true"/><econdition field-name="ownerPartyId" from="activeOrgId"/><econdition field-name="productClassEnumId" value="PclsCoarchy"/></entity-find></entity-options></drop-down></default-field></field><field name="evaluationName"><default-field title="Evaluation Name"><label text="Name this evaluation" style="text-bold q-mt-md"/><label text="Giving this evaluation a unique name allows you to easily refer to it in the future. This could be the name of the vendor performing the evaluation." style="text-caption text-grey-8 q-pb-sm" type="div"/><text-line/></default-field></field><field name="processStoryIds"><default-field title="Process Stories"><label text="Process Story Selection" style="text-bold q-mt-md"/><label text="Select the process stories you would like to evaluate. You will get the change to include/exclude activities next." style="text-caption text-grey-8 q-pb-sm" type="div"/><drop-down allow-empty="false" allow-multiple="true"><entity-options key="${processStoryId}" text="${name}"><entity-find entity-name="coarchy.ProcessStory"><econdition field-name="organizationId" from="activeOrgId"/></entity-find></entity-options></drop-down></default-field></field><field name="emailAddress"><default-field><label text="Vendor Invitation" style="text-bold q-mt-md"/><label text="Specify the email address of the vendor you want to evaluate this product against" style="text-caption text-grey-8 q-pb-sm" type="div"/><text-line input-type="email"/></default-field></field><field name="submit"><default-field><submit text="Start Evaluation"/></default-field></field></form-single></container-dialog><link url="../EvalReports" text="Summary & Reporting"/><form-list name="ProductEvalListForm" header-dialog="true" show-page-size="true" select-columns="true" saved-finds="true" show-csv-button="true" list="productEvalList"><entity-find entity-name="coarchy.product.ProductEvaluation" list="productEvalList"><search-form-inputs/><econdition field-name="organizationId" from="activeOrgId"/></entity-find><row-actions><entity-find-one entity-name="mantle.product.Product" value-field="product"/><entity-find entity-name="coarchy.product.ProductEvaluationParty" list="vendorRepList"><date-filter/><econdition field-name="productEvaluationId"/><econdition field-name="roleTypeId" value="VendorRepresentative"/><order-by field-name="fromDate"/></entity-find><if condition="vendorRepList"><entity-find-one entity-name="mantle.party.PersonAndUserAccount" value-field="personAndAccount"><field-map field-name="partyId" from="vendorRepList[0].partyId"/></entity-find-one></if></row-actions><field name="productId"><default-field><hidden/></default-field></field><field name="productEvaluationId"><default-field title="Evaluation ID"><link url="../EditProductEval" link-type="anchor" text="${productEvaluationId}"/></default-field></field><field name="evaluationName"><default-field><display/></default-field></field><field name="productName" from="product.productName"><default-field><display/></default-field></field><field name="combinedName"><default-field title="Representative Name"><display text="${personAndAccount?.firstName?:''} ${personAndAccount?.lastName?:''} ${personAndAccount?.emailAddress?('('+personAndAccount.emailAddress+')'):''}"/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="actions"><default-field title=""><link url="goToProductEvaluation" text="View" parameter-map="[productEvaluationId:productEvaluationId]"/><link url="cancelProductEvaluation" text="Cancel" confirmation="Are you sure you want to cancel this product evaluation?" btn-type="danger" tooltip="Cancel Product Evaluation" parameter-map="[productEvaluationId:productEvaluationId]" condition="['PeRequirementsSelection','PeInviteVendors'].contains(statusId)"/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy/cointernal/Products.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Products" default-menu-index="30" menu-image="/ssstatic/images/Catalog.png"><subscreens default-item="FindProducts"/><widgets><subscreens-active id="products-active"/></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy/cointernal/FindChecklist.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Checklists" default-menu-index="50" menu-image="/ssstatic/images/Picking.png"><parameter name="pageIndex" from="pageIndex?:0"/><always-actions><if condition="!activeOrgId"><message><![CDATA[Select an Organization before moving forward.]]></message><script><![CDATA[sri.sendRedirectAndStopRender('/settings/Organizations')]]></script></if><entity-find-count entity-name="mantle.party.PartyRelationship" count-field="partyRelationshipCount"><date-filter/><econdition field-name="relationshipTypeEnumId" value="PrtMember"/><econdition field-name="toRoleTypeId" value="OrgInternal"/><econdition field-name="fromPartyId" from="ec.user.userAccount.partyId"/><econdition field-name="toPartyId" from="activeOrgId"/></entity-find-count><entity-find-count entity-name="mantle.party.PartyActivation" count-field="partyActivationCount"><date-filter/><econdition field-name="partyId" from="activeOrgId"/></entity-find-count></always-actions><transition name="createChecklist"><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><service-call name="coarchy.CoarchyServices.create#Checklist" in-map="[processStoryId:processStoryId,name:name,organizationId:activeOrgId]" out-map="checklist" multi="parameter"/><default-response url="../Checklist" parameter-map="[checklistId:checklist.rootWorkEffortId]"/><error-response url="../Process/ProcessStory" parameter-map="[processStoryId:processStoryId]"/></transition><transition-include name="getCloneOrganizationList" location="component://coarchy/screen/coarchy/cointernal/Home.xml"/><transition-include name="upgradeParty" location="component://coarchy/screen/coarchy/cointernal/Home.xml"/><widgets><section name="FreemiumBanner" condition="partyActivationCount == 0"><widgets><container type="q-banner inline-actions rounded dense" style="bg-grey-3 text-black q-mb-md"><label text="To enable all the features upgrade organization '${activeOrg.organizationName}' to Premium" type="b"/><container type="template v-slot:action"><form-single name="UpgradeForm" transition="upgradeParty"><field name="upgrade"><default-field><submit text="Upgrade" type="success" confirmation="Activating will cost 1 Organization-Month Credit per month while ${activeOrg.organizationName} is upgraded. Are you sure?"/></default-field></field></form-single></container></container></widgets></section><label text="Find Checklist" type="h4"/><container-dialog id="CreateChecklistDialogue" button-text="Add Checklist" type="success" condition="partyRelationshipCount > 0"><form-single name="CreateChecklist" transition="createChecklist"><field name="processStoryId"><default-field title="Process Story"><drop-down required-manual-select="true" submit-on-select="true"><entity-options key="${processStoryId}" text="${name}"><entity-find entity-name="coarchy.ProcessStory" list="processStoryList"><econdition field-name="disabled" value="N"/><order-by field-name="name"/></entity-find></entity-options></drop-down></default-field></field></form-single></container-dialog><form-list name="Checklist" header-dialog="true" show-page-size="true" show-csv-button="true" list="checklistList"><entity-find entity-name="mantle.work.effort.WorkEffort" list="checklistList"><search-form-inputs default-order-by="-actualStartDate"/><econdition field-name="workEffortTypeEnumId" value="WetChecklist"/></entity-find><field name="workEffortId"><default-field><hidden/></default-field></field><field name="workEffortName"><header-field title="Checklist Name"><text-find size="25"/></header-field><default-field title="Checklists"><link url="../Checklist" parameter-map="[checklistId:workEffortId]" text="${workEffortName}"/></default-field></field><field name="actualStartDate"><header-field><date-find type="date"/></header-field><default-field title="Started"><label text="${actualStartDate?ec.l10n.format(actualStartDate,'MMMM dd, HH:mm'):'Not started'}"/></default-field></field><field name="actualCompletionDate"><header-field><date-find type="date"/></header-field><default-field title="Completed"><label text="${actualCompletionDate?ec.l10n.format(actualCompletionDate,'MMMM dd, HH:mm'):'Not completed'}"/></default-field></field><field name="submit"><header-field><submit/></header-field></field></form-list></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy/cointernal/Checklist.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Checklist" default-menu-index="53" menu-image="/ssstatic/images/task-homework.png"><parameter name="checklistId" required="true"/><parameter name="pageIndex" from="pageIndex?:0"/><parameter name="pageSize"/><parameter name="orderByField" value="workEffortId"/><always-actions><if condition="!activeOrgId"><message type="info"><![CDATA[Select an Organization before moving forward.]]></message><script><![CDATA[sri.sendRedirectAndStopRender('/settings/Organizations')]]></script></if><entity-find-count entity-name="mantle.party.PartyRelationship" count-field="partyRelationshipCount"><date-filter/><econdition field-name="relationshipTypeEnumId" value="PrtMember"/><econdition field-name="toRoleTypeId" value="OrgInternal"/><econdition field-name="fromPartyId" from="ec.user.userAccount.partyId"/><econdition field-name="toPartyId" from="activeOrgId"/></entity-find-count><entity-find-count entity-name="mantle.party.PartyActivation" count-field="partyActivationCount"><date-filter/><econdition field-name="partyId" from="activeOrgId"/></entity-find-count></always-actions><transition name="updateChecklist"><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><service-call name="coarchy.CoarchyServices.update#Checklist" in-map="[workEffortId:workEffortId,workEffortName:workEffortName,organizationId:activeOrgId]" out-map="checklist" multi="parameter"/><default-response url="." parameter-map="[pageIndex:pageIndex,checklistId:workEffortId]"/></transition><transition name="updateTask"><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><service-call name="coarchy.CoarchyServices.update#Task" in-map="[workEffortId:workEffortId,assignedPartyIdList:assignedPartyIdList,resolutionEnumId:resolutionEnumId,organizationId:activeOrgId]" out-map="context" multi="parameter"/><default-response/><error-response url="." save-parameters="true"/></transition><transition name="assignAll"><condition><expression><![CDATA[partyRelationshipCount > 0 && partyActivationCount > 0]]></expression></condition><service-call name="coarchy.CoarchyServices.assign#AllTasks" out-map="context" in-map="[workEffortId:checklistId,partyId:partyId,actorId:actorId,organizationId:activeOrgId]" multi="parameter"/><conditional-response url="." save-current-screen="true"><condition><expression><![CDATA[returnToScreen]]></expression></condition></conditional-response><default-response type="none"/></transition><transition name="getAssignedPartyList"><actions><set field="assignedPartyList" from="[]"/><if condition="term == null && assignedPartyIdList ? assignedPartyIdList?.size() > 0 : false"><then><entity-find entity-name="mantle.work.effort.WorkEffortPartyAndPerson" list="assignedPartyList" limit="50" distinct="true"><date-filter/><econdition field-name="workEffortId"/><econdition field-name="roleTypeId" value="Assignee"/><econdition field-name="partyId" operator="in" from="assignedPartyIdList"/><select-field field-name="partyId,firstName,lastName"/><order-by field-name="firstName"/></entity-find></then><else-if condition="actorIdList"><entity-find entity-name="coarchy.ActorPartyAndPerson" list="assignedPartyList" distinct="true"><econdition field-name="actorId" operator="in" from="actorIdList"/><select-field field-name="partyId,firstName,lastName"/><order-by field-name="actorId"/></entity-find></else-if></if><set field="outList" from="[]"/><iterate list="assignedPartyList" entry="assignedParty"><if condition="outList.find{it.value == assignedParty.partyId} == null"><script><![CDATA[outList.add([value:assignedParty.partyId, label:"${assignedParty.firstName} ${assignedParty.lastName}"])]]></script></if></iterate><script><![CDATA[ec.web.sendJsonResponse(outList)]]></script></actions><default-response type="none"/></transition><transition name="getActorPartyList"><actions><set field="assignedPartyList" from="[]"/><entity-find entity-name="coarchy.ActorPartyAndPerson" list="actorPartyList" distinct="true"><econdition field-name="actorId"/><econditions combine="or"><econdition field-name="firstName" operator="like" value="%${term}%" ignore-case="true"/><econdition field-name="lastName" operator="like" value="%${term}%" ignore-case="true"/></econditions><order-by field-name="actorId"/></entity-find><set field="outList" from="[]"/><iterate list="actorPartyList" entry="actorParty"><script><![CDATA[outList.add([value:actorParty.partyId, label:"${actorParty.firstName} ${actorParty.lastName}"])]]></script></iterate><script><![CDATA[ec.web.sendJsonResponse(outList)]]></script></actions><default-response type="none"/></transition><transition-include name="getCloneOrganizationList" location="component://coarchy/screen/coarchy/cointernal/Home.xml"/><transition-include name="upgradeParty" location="component://coarchy/screen/coarchy/cointernal/Home.xml"/><actions><entity-find-one entity-name="mantle.work.effort.WorkEffort" value-field="project" auto-field-map="[workEffortId:checklistId]"/><if condition="!project"><message type="warning" error="true"><![CDATA[Checklist not found. Returning to find Checklist]]></message><script><![CDATA[sri.sendRedirectAndStopRender('/coapp/FindChecklist')]]></script></if><entity-find-count entity-name="mantle.work.effort.WorkEffortParty" count-field="ownerCount"><date-filter/><econdition field-name="workEffortId" from="checklistId"/><econdition field-name="partyId" from="ec.user.userAccount.partyId"/><econdition field-name="roleTypeId" value="Owner"/></entity-find-count><entity-find-count entity-name="WorkEffort" count-field="workEffortCount" distinct="true"><econdition field-name="rootWorkEffortId" from="checklistId"/><econdition field-name="workEffortTypeEnumId" value="WetChecklistItem"/><select-field field-name="workEffortId"/></entity-find-count><entity-find-count entity-name="WorkEffortAndParty" count-field="workEffortPartyCount" distinct="true"><date-filter/><econdition field-name="rootWorkEffortId" from="checklistId"/><econdition field-name="roleTypeId" value="Assignee"/><select-field field-name="workEffortId,roleTypeId"/></entity-find-count><set field="assignAll" from="workEffortCount!=workEffortPartyCount"/><if condition="assignAll"><entity-find entity-name="coarchy.WorkEffortActivityDetail" list="taskPartyList" distinct="true"><date-filter/><econdition field-name="rootWorkEffortId" from="checklistId"/><econdition field-name="workEffortTypeEnumId" value="WetChecklistItem"/><econdition field-name="roleTypeId" operator="is-null"/><econdition field-name="resolutionEnumId" operator="is-null"/><select-field field-name="actorId,name"/><order-by field-name="name"/></entity-find></if></actions><widgets><section name="FreemiumBanner" condition="partyActivationCount == 0"><widgets><container type="q-banner inline-actions rounded dense" style="bg-grey-3 text-black q-mb-md"><label text="To enable all the features upgrade organization '${activeOrg.organizationName}' to Premium" type="b"/><container type="template v-slot:action"><form-single name="UpgradeForm" transition="upgradeParty"><field name="upgrade"><default-field><submit text="Upgrade" type="success" confirmation="Activating will cost 1 Organization-Month Credit per month while ${activeOrg.organizationName} is upgraded. Are you sure?"/></default-field></field></form-single></container></container></widgets></section><label text="Checklist${project?.workEffortName?' - '+project?.workEffortName:''}" type="h4"/><label text="Completed ${ec.l10n.format(project.actualCompletionDate,'MMMM dd, HH:mm')}" type="h5" condition="project.actualCompletionDate" style="q-pt-sm"/><container-dialog id="AssignAllDialog" button-text="Assign All" type="success" condition="assignAll"><label text="Assign a User to each Task that has the Actor assigned to it." type="h5" style="q-pb-sm"/><form-list name="AssignAllFormList" list="taskPartyList" transition="assignAll"><field name="actorId"><default-field><hidden/></default-field></field><field name="name"><default-field><display/></default-field></field><field name="partyId"><default-field title="User"><drop-down required-manual-select="true"><dynamic-options server-search="true" transition="getActorPartyList" min-length="0" parameter-map="[workEffortId:checklistId,actorId:actorId]"/></drop-down></default-field></field><field name="submit"><default-field><submit text="Assign All"/></default-field></field></form-list></container-dialog><container-dialog id="UpdateChecklistDialog" button-text="Edit Checklist Name"><form-single name="UpdateChecklist" transition="updateChecklist"><field name="pageIndex"><default-field><hidden/></default-field></field><field name="workEffortId" from="project.workEffortId"><default-field><hidden/></default-field></field><field name="workEffortName" from="project.workEffortName"><default-field title="Checklist Name"><text-line size="50"/></default-field></field><field name="submit"><default-field><submit text="Edit"/></default-field></field></form-single></container-dialog><form-list name="ChecklistFormList" header-dialog="true" show-page-size="true" show-csv-button="true" list="taskList" transition="updateTask"><entity-find entity-name="mantle.work.effort.WorkEffort" list="taskList"><econdition field-name="rootWorkEffortId" from="project.workEffortId"/><econdition field-name="workEffortTypeEnumId" value="WetChecklistItem"/><select-field field-name="workEffortId,workEffortName,resolutionEnumId,actualCompletionDate,activityId"/><order-by field-name="workEffortId"/></entity-find><row-actions><entity-find-count entity-name="mantle.work.effort.WorkEffortParty" count-field="thisUserAssignedCount"><date-filter/><econdition field-name="workEffortId"/><econdition field-name="roleTypeId" value="Assignee"/><econdition field-name="partyId" from="ec.user.userAccount.partyId"/></entity-find-count><set field="canEditResolved" from="thisUserAssignedCount > 0 && (taskList_index!=0?taskList.get(taskList_index-1).resolutionEnumId!=null:true)"/><entity-find entity-name="mantle.work.effort.WorkEffortPartyAndPerson" list="actorPartyList" limit="50" distinct="true"><date-filter/><econdition field-name="workEffortId"/><econdition field-name="roleTypeId" value="Assignee"/><select-field field-name="partyId,firstName,lastName"/><order-by field-name="firstName"/></entity-find><set field="assignedPartyIdList" from="actorPartyList*.partyId"/><set field="canEditAssignedParties" from="(ownerCount > 0 || activeOrg.ownerPartyId == ec.user.userAccount.partyId)"/><if condition="canEditAssignedParties"><entity-find entity-name="coarchy.ActivityActorDetail" list="activityActorList"><econdition field-name="activityId"/></entity-find><set field="actorIdList" from="activityActorList*.actorId"/></if><if condition="!canEditResolved&&resolutionEnumId"><entity-find-one entity-name="moqui.basic.Enumeration" value-field="resolution" auto-field-map="[enumId:resolutionEnumId]"/></if></row-actions><field name="workEffortId"><default-field><hidden/></default-field></field><field name="workEffortName"><default-field title="Task"><label text="${workEffortName}" type="h5"/></default-field></field><field name="assignedPartyIdList"><conditional-field condition="canEditAssignedParties" title="${canEditAssignedParties?'Assigned Users':''}"><drop-down submit-on-select="true" required-manual-select="true"><list-options list="actorPartyList" key="${partyId}" text="${firstName} ${lastName}"/><dynamic-options server-search="true" transition="getAssignedPartyList" min-length="0" parameter-map="[workEffortId:workEffortId,actorIdList:actorIdList]"/></drop-down></conditional-field><conditional-field condition="!canEditAssignedParties" title="${!canEditAssignedParties?'Assigned Users':''}"><label text="${actorPartyList?.size()>0 ? (actorPartyList?.getFirst()?.firstName+' '+actorPartyList?.getFirst()?.lastName) : 'None Assigned'}"/></conditional-field></field><field name="resolutionEnumId"><conditional-field condition="canEditResolved" title="${canEditResolved?'Resolution':''}"><drop-down submit-on-select="true" required-manual-select="true"><entity-options key="${enumId}" text="${description}"><entity-find entity-name="moqui.basic.EnumAndGroup"><econdition field-name="enumGroupEnumId" value="EngTaskResolution"/><order-by field-name="sequenceNum"/></entity-find></entity-options></drop-down></conditional-field><conditional-field condition="!canEditResolved&&resolutionEnumId" title="Resolution"><label text="${resolution?.description}"/></conditional-field></field><field name="actualCompletionDate"><default-field title="Completed"><label text="${actualCompletionDate?ec.l10n.format(actualCompletionDate,'MMMM dd, HH:mm'):'Not completed'}"/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy/cointernal.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="anonymous-view" default-menu-title="Coarchy" menu-image="fa fa-building" menu-image-type="icon" allow-extra-path="true"><always-actions><service-call name="mantle.party.PartyServices.setup#UserOrganizationInfo" out-map="context"/></always-actions><subscreens default-item="Home"/><widgets><label text="Go to /coapp" type="strong"/></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy/coapp.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="false" screen-theme-type-enum-id="STT_INTERNAL_QUASAR" default-menu-title="Coarchy App" allow-extra-path="true"><transition name="manifest.webmanifest" read-only="true"><actions><script><![CDATA[def manifestOut = [
                    name: "Coarchy",
                    short_name: "Coarchy",
                    icons: [
                            [
                                    src: '/costatic/images/CoarchySquareBlack200.png',
                                    type: "image/png",
                                    sizes: "200x200"
                            ],
                            [
                                    src: '/costatic/images/CoarchySquareBlack500.png',
                                    type: "image/png",
                                    sizes: "500x500"
                            ]
                    ],
                    start_url: "/coapp",
                    display: "minimal-ui",
                    prefer_related_applications: true
            ];
            ec.web.sendJsonResponse(manifestOut)]]></script></actions><default-response type="none"/></transition><pre-actions><script><![CDATA[// if user not logged in save current path and params then redirect to Login
        if (!ec.user.userId) { ec.web.saveScreenLastInfo(null, null); sri.sendRedirectAndStopRender('/Login') }

        html_scripts.add('/libs/moment.js/moment-with-locales.min.js')
        html_scripts.add('/libs/jquery/jquery.min.js')

        html_stylesheets.add('/costatic/style.css')

        String instancePurpose = System.getProperty("instance_purpose")
        if (!instancePurpose || instancePurpose == 'production') {
            /* ========== Production Mode ========== */
            html_scripts.add('/js/MoquiLib.min.js')
            // Vue JS
            footer_scripts.add('/libs/vue/vue.min.js')
            // http-vue-loader
            footer_scripts.add('/js/http-vue-loader/httpVueLoader.js')
            // Quasar
            footer_scripts.add("/libs/quasar/quasar.umd.min.js")
            // Vue Components for Coarchy
            footer_scripts.add('/costatic/js/CoarchyVue.js')
            footer_scripts.add('/costatic/js/ProcessStoryVue.js')
            // Webroot Quasar-Vue instance, in footer so runs after page loaded
            footer_scripts.add('/js/WebrootVue.qvt.js')
        } else {
            /* ========== Dev Mode ========== */
            html_scripts.add('/js/MoquiLib.js')
            // Vue JS
            footer_scripts.add('/libs/vue/vue.js')
            // http-vue-loader
            footer_scripts.add('/js/http-vue-loader/httpVueLoader.js')
            // Quasar
            footer_scripts.add("/libs/quasar/quasar.umd.min.js")
            // Vue Components for Coarchy
            footer_scripts.add('/costatic/js/CoarchyVue.js')
            footer_scripts.add('/costatic/js/ProcessStoryVue.js')
            // Webroot Quasar-Vue instance, in footer so runs after page loaded
            footer_scripts.add('/js/WebrootVue.qvt.js')
        }
        
        // Add vue-draggable 
        footer_scripts.add('/costatic/js/Sortable.min.js')
        footer_scripts.add('/costatic/js/vuedraggable.umd.min.js')

        // conditional QZ Tray scripts, only include if enabled
        if (ec.user.getPreference("qz.print.enabled") == "true") {
            footer_scripts.add('/js/qz-tray/sha-256.min.js')
            footer_scripts.add('/js/qz-tray/qz-tray.min.js')
            // TODO migrate MoquiQzComponent.js to MoquiQzComponent.qvt.js
            footer_scripts.add('/js/qz-tray/MoquiQzComponent.js')
        }]]></script></pre-actions><actions><service-call name="mantle.party.PartyServices.setup#UserOrganizationInfo" out-map="context"/></actions><widgets><render-mode><text type="html" location="component://coarchy/screen/coarchy/includes/CoarchyVue.qvt.ftl"/></render-mode></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy/costatic.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="anonymous-view"><widgets><subscreens-active/></widgets></screen>
<!-- Screen Location component://coarchy/screen/coarchy-com/cstatic.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="anonymous-view"><widgets><subscreens-active/></widgets></screen>
<!-- Screen Location component://webroot/screen/webroot/echopath.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="false" screen-theme-type-enum-id="STT_INTERNAL" track-artifact-hit="false" standalone="true" allow-extra-path="true" default-menu-include="false"><widgets><label text="Extra path: ${sri.screenUrlInfo.extraPathNameList}" type="span"/></widgets></screen>
<!-- Screen Location component://webroot/screen/webroot/error/Forbidden.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="false"><widgets><render-mode><text type="html"><![CDATA[<p>&nbsp;</p><div class="jumbotron"><h1><i class="fa fa-ban text-danger"></i> Access Forbidden (${errorCode})</h1><#if errorThrowable?? && (errorThrowable.getArtifactInfo())??><#-- should always be a ArtifactAuthorizationException, may not alway have getArtifactInfo() --><#assign aeii = errorThrowable.getArtifactInfo()><p class="text-danger">User <code>${(ec.user.username)!ec.l10n.localize("N/A")}</code> is not authorized for ${aeii.getActionDescription()} on ${aeii.getTypeDescription()} <code>${aeii.getName()}</code></p><#else><p class="text-danger">${(errorMessage!"")?html}</p></#if><a href="${sri.buildUrl("/").url}" class="btn btn-primary btn-lg" role="button">Go Home</a><a href="javascript:window.history.back();" class="btn btn-primary btn-lg" role="button">Go Back</a><#if errorThrowable??><button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#ErrorDetailModal">See Detail</button></#if></div><#if errorThrowable??><#assign aeii = (errorThrowable.getArtifactInfo())!><#assign artifactStack = (errorThrowable.getArtifactStack())!><#assign stackList = errorThrowable.getStackTrace()><div id="ErrorDetailModal" class="modal fade" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title">Error Detail</h4></div><div class="modal-body"><#if aeii??><p>Current:</p><p>${(aeii.toString())!}</p></#if><#if artifactStack??><p>Stack:</p><#list artifactStack as curInfo><p>${curInfo.toString()}</p></#list></#if><pre>
${errorThrowable.message?html}

<#list stackList as stackElement>
at ${stackElement.toString()?html}
</#list></pre></div></div></div></div></#if>]]></text></render-mode></widgets></screen>
<!-- Screen Location component://webroot/screen/webroot/error/InternalError.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="false"><widgets><render-mode><text type="html"><![CDATA[<p>&nbsp;</p><div class="jumbotron"><h1><i class="fa fa-exclamation-circle text-danger"></i> Internal Server Error (${errorCode})</h1><p class="text-danger">${errorMessage!""}</p><a href="${sri.buildUrl("/").url}" class="btn btn-primary btn-lg" role="button">Go Home</a><a href="javascript:window.history.back();" class="btn btn-primary btn-lg" role="button">Go Back</a><#if errorThrowable??><button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#ErrorDetailModal">See Detail</button></#if></div><#if errorThrowable??><#assign stackList = errorThrowable.getStackTrace()><div id="ErrorDetailModal" class="modal fade" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title">Error Detail</h4></div><div class="modal-body"><pre>
${(errorThrowable.message!"No Message")?html}
<#list stackList as stackElement>
at ${stackElement.toString()}
</#list></pre></div></div><!-- /.modal-content --></div><!-- /.modal-dialog --></div><!-- /.modal --></#if>]]></text></render-mode></widgets></screen>
<!-- Screen Location component://webroot/screen/webroot/error/NotFound.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="false"><widgets><render-mode><text type="html"><![CDATA[<p>&nbsp;</p><div class="jumbotron"><h1><i class="fa fa-link text-danger"></i> Page Not Found (${errorCode})</h1><#if errorThrowable??><#-- should always be a ScreenResourceNotFoundException --><p class="text-danger">Could not find <code>${(errorThrowable.pathFromLastScreen!"")?html}</code><#if errorThrowable.lastSd??>under ${errorThrowable.lastSd.getDefaultMenuName()}</#if>.</p><p class="text-danger">The full path was: <#list errorThrowable.fullPathNameList as pathName><code>${pathName?html}</code><#if pathName_has_next>/</#if></#list></p><#if errorThrowable.resourceLocation??><p class="text-danger">Resource not found at: ${errorThrowable.resourceLocation?html}</p></#if><#else><p class="text-danger">${errorMessage!""}</p></#if><a href="${sri.buildUrl("/").url}" class="btn btn-primary btn-lg" role="button">Go Home</a><a href="javascript:window.history.back();" class="btn btn-primary btn-lg" role="button">Go Back</a></div>]]></text></render-mode></widgets></screen>
<!-- Screen Location component://webroot/screen/webroot/error/TooMany.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="false"><widgets><render-mode><text type="html"><![CDATA[<p>&nbsp;</p><div class="jumbotron"><h1><i class="fa fa-clock-o text-danger"></i> Too Many Requests (${errorCode})</h1><p class="text-danger">${errorMessage!""}</p><a href="${sri.buildUrl("/").url}" class="btn btn-primary btn-lg" role="button">Go Home</a><a href="javascript:window.history.back();" class="btn btn-primary btn-lg" role="button">Go Back</a></div>]]></text></render-mode></widgets></screen>
<!-- Screen Location component://webroot/screen/webroot/error/Unauthorized.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="false"><widgets><render-mode><text type="html"><![CDATA[<p>&nbsp;</p><div class="jumbotron"><h1><i class="fa fa-user text-danger"></i> Login Required (${errorCode})</h1><p class="text-danger">${(errorMessage!"")?html}</p><a href="${sri.buildUrl("/").url}" class="btn btn-primary btn-lg" role="button">Go Home</a><a href="javascript:window.history.back();" class="btn btn-primary btn-lg" role="button">Go Back</a><a href="${sri.buildUrl("/Login").url}" class="btn btn-primary btn-lg" role="button">Login</a></div>]]></text></render-mode></widgets></screen>
<!-- Screen Location component://webroot/screen/webroot/error.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="false" screen-theme-type-enum-id="STT_ERROR" default-menu-include="false"><pre-actions><script><![CDATA[html_stylesheets.add('/libs/twitter-bootstrap/css/bootstrap.min.css')

        html_scripts.add('/libs/jquery/jquery.min.js')
        html_scripts.add('/libs/twitter-bootstrap/js/bootstrap.min.js')]]></script></pre-actions><widgets><container style="container-fluid"><subscreens-active/></container></widgets></screen>
<!-- Screen Location component://example/screen/ExampleSite/home.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="false"><widgets><render-mode><text type="html" location="component://example/screen/ExampleSite/home.html.ftl"/></render-mode></widgets></screen>
<!-- Screen Location component://example/screen/ExampleSite.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" include-child-content="true" require-authentication="false" standalone="true" screen-theme-type-enum-id="STT_POP_COMMERCE"><subscreens default-item="home"/><widgets><render-mode><text type="html" location="component://example/screen/ExampleSite/includes/Header.html.ftl"/></render-mode><subscreens-active/><render-mode><text type="html" location="component://example/screen/ExampleSite/includes/Footer.html.ftl"/></render-mode></widgets></screen>
<!-- Screen Location component://HiveMind/screen/hmstatic.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="anonymous-view"><widgets><subscreens-active/></widgets></screen>
<!-- Screen Location component://webroot/screen/webroot/Login.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" require-authentication="false" history="false"><parameter name="initialTab"/><parameter name="returnTo"/><transition name="login" require-session-token="false"><actions><if condition="ec.web?.sessionAttributes?.moquiPreAuthcUsername"><then><set field="username" from="ec.web?.sessionAttributes?.moquiPreAuthcUsername"/></then><else><set field="loggedIn" from="ec.user.loginUser(username, password)"/></else></if><if condition="ec.web.sessionAttributes.moquiAuthcFactorRequired"><if condition="code"><then><service-call name="org.moqui.impl.UserServices.validate#ExternalUserAuthcCode" in-map="[code:code]" out-map="validateOut"/><if condition="validateOut.verified"><then><script><![CDATA[ec.user.internalLoginUser(validateOut.username)]]></script><return/></then><else><message error="true" public="true"><![CDATA[Authentication code is not valid]]></message></else></if></then><else><message error="true" public="true"><![CDATA[Authentication code required for user ${username}]]></message></else></if></if></actions><default-response type="screen-last"/><error-response url="."/></transition><transition name="logout"><actions><script><![CDATA[ec.user.logoutUser()]]></script></actions><default-response url="/"/><error-response url="."/></transition><transition name="removePreAuth"><actions><script><![CDATA[ec.web.sessionAttributes.remove("moquiPreAuthcUsername")
            ec.web.sessionAttributes.remove("moquiAuthcFactorRequired")
            ec.web.sessionAttributes.remove("moquiPasswordChangeRequired")
            ec.web.sessionAttributes.remove("moquiExpiredCredentials")]]></script></actions><default-response url="."/></transition><transition name="resetPassword"><parameter name="username" from="ec.web?.sessionAttributes?.moquiPreAuthcUsername ?: username"/><service-call name="org.moqui.impl.UserServices.reset#Password" in-map="[username:username]" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="changePassword"><parameter name="username" from="ec.web?.sessionAttributes?.moquiPreAuthcUsername ?: username"/><service-call name="org.moqui.impl.UserServices.update#Password" in-map="true" out-map="context" multi="parameter"/><actions><if condition="updateSuccessful"><set field="loginSuccess" from="ec.user.internalLoginUser(username)"/></if></actions><conditional-response type="screen-last"><condition><expression><![CDATA[updateSuccessful]]></expression></condition></conditional-response><default-response url="." parameter-map="[initialTab:'#change']"/></transition><transition name="createInitialAdminAccount"><service-call name="org.moqui.impl.UserServices.create#InitialAdminAccount" in-map="true" out-map="context" multi="parameter"/><default-response url="../Login"/><error-response url="."/></transition><transition name="sendOtp"><service-call name="org.moqui.impl.UserServices.send#ExternalAuthcCode" in-map="[factorId:factorId]" out-map="context" multi="parameter"/><default-response url="."/></transition><pre-actions><script><![CDATA[// if user already logged in redirect to root
        if (ec.user.userId) sri.sendRedirectAndStopRender('/')

        // jQuery/UI
        html_scripts.add('/libs/jquery/jquery.min.js')
        // Bootstrap
        html_scripts.add('/libs/twitter-bootstrap/js/bootstrap.min.js')
        // Moqui webroot layout
        html_stylesheets.add('/css/webroot-layout.css')]]></script></pre-actions><actions><if condition="returnTo"><then><log message="setting last path to ${returnTo}"/><script><![CDATA[ec.web.session.setAttribute('moqui.screen.last.path', returnTo)]]></script></then><else><if condition="!ec.web.session.getAttribute('moqui.screen.last.path')"><set field="referrer" from="ec.web.request.getHeader('Referer')"/><if condition="referrer"><script><![CDATA[ec.web.session.setAttribute('moqui.screen.last.path', referrer)]]></script></if></if></else></if><set field="passwordChangeRequired" from="ec.web.sessionAttributes.moquiPasswordChangeRequired ?: 'false'" type="Boolean"/><set field="expiredCredentials" from="ec.web.sessionAttributes.moquiExpiredCredentials ?: 'false'" type="Boolean"/><if condition="passwordChangeRequired || expiredCredentials"><set field="initialTab" value="#change"/></if><if condition="initialTab && !initialTab.startsWith('#')"><set field="initialTab" from="'#' + initialTab"/></if><set field="secondFactorRequired" from="false"/><if condition="ec.web.sessionAttributes.moquiPreAuthcUsername"><then><set field="username" from="ec.web.sessionAttributes.moquiPreAuthcUsername"/><service-call name="org.moqui.impl.UserServices.get#ExternalUserAuthcFactorInfo" out-map="context"/></then><else><set field="username" from="ec.web.errorParameters?.username ?: ''"/></else></if><set field="passwordNode" from="ec.ecfi.confXmlRoot.first('user-facade').first('password')"/><set field="minLength" from="passwordNode.attribute('min-length')" default-value="8" type="Integer"/><set field="minDigits" from="passwordNode.attribute('min-digits')" default-value="1" type="Integer"/><set field="minOthers" from="passwordNode.attribute('min-others')" default-value="1" type="Integer"/></actions><widgets><container id="content" style="Login"><container style="inner"><container style="container-fluid"><section-iterate name="headerSavedMessages" list="ec.web?.savedMessages" entry="message"><widgets><render-mode><text type="html"><![CDATA[<div class="alert alert-success fade in" role="alert"><button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>]]></text></render-mode><label text="${message}" type="h4"/><render-mode><text type="html"><![CDATA[</div>]]></text></render-mode></widgets></section-iterate><section-iterate name="headerSavedErrors" list="ec.web?.savedErrors" entry="errorMessage"><widgets><render-mode><text type="html"><![CDATA[<div class="alert alert-danger fade in" role="alert"><button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>]]></text></render-mode><label text="${errorMessage}" type="h4"/><render-mode><text type="html"><![CDATA[</div>]]></text></render-mode></widgets></section-iterate><section-iterate name="headerSavedValidationErrors" list="ec.web?.savedValidationErrors" entry="validationError"><widgets><render-mode><text type="html"><![CDATA[<div class="alert alert-danger fade in" role="alert"><button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>]]></text></render-mode><label text="${validationError.message} (for field ${validationError.field})" type="h4"/><render-mode><text type="html"><![CDATA[</div>]]></text></render-mode></widgets></section-iterate><section name="NeedsSetupSection" condition="ec.entity.find('moqui.security.UserAccount').disableAuthz().count() > 1"><widgets><render-mode><text type="html" template="true" location="component://webroot/screen/webroot/Login.ftl"/></render-mode></widgets><fail-widgets><render-mode><text type="html"><![CDATA[<div class="text-center"><h3>Welcome to your new system</h3><form method="post" action="${sri.buildUrl("createInitialAdminAccount").url}" class="form-signin" id="InitialAdminForm"><p class="text-muted text-center">There are no user accounts, get started by creating an initial administrator account</p><input type="hidden" name="moquiSessionToken" value="${ec.web.sessionToken}"><input type="text" name="username" value="${(ec.getWeb().getErrorParameters().get("username"))!""}" placeholder="Username" required="required" class="form-control top"><input type="password" name="newPassword" placeholder="New Password" required="required" class="form-control middle"><input type="password" name="newPasswordVerify" placeholder="New Password Verify" required="required" class="form-control middle"><input type="text" name="userFullName" value="${(ec.getWeb().getErrorParameters().get("userFullName"))!""}" placeholder="User Full Name" required="required" class="form-control middle"><input type="text" name="emailAddress" value="${(ec.getWeb().getErrorParameters().get("emailAddress"))!""}" placeholder="Email Address" required="required" class="form-control bottom"><button class="btn btn-lg btn-primary btn-block" type="submit">Create Initial Admin Account</button></form></div>]]></text></render-mode></fail-widgets></section><section name="TestLoginSection"><condition><expression><![CDATA[ec.entity.find('moqui.security.UserAccount').condition('userId', 'EX_JOHN_DOE')
                    .condition('currentPassword', '16ac58bbfa332c1c55bd98b53e60720bfa90d394').disableAuthz().count()]]></expression></condition><widgets><render-mode><text type="html"><![CDATA[<form method="post" action="${sri.buildUrl("login").url}" id="TestLoginLink"><input type="hidden" name="username" value="john.doe"><input type="hidden" name="password" value="moqui"><button class="btn btn-sm btn-primary" type="submit" id="TestLoginLink_button">Test Login (John Doe)</button></form><script>$("#TestLoginLink_button").focus();</script>]]></text></render-mode></widgets></section></container></container></container></widgets></screen>
<!-- Screen Location component://PopCommerce/screen/PopCommerceRoot/content.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="anonymous-view" allow-extra-path="true" default-menu-include="false"><transition name="attachment"><actions><set field="extraPathNameList" from="new ArrayList(sri.screenUrlInfo.extraPathNameList)"/><if condition="!extraPathNameList"><script><![CDATA[ec.web.sendError(404, null, null)]]></script></if><set field="filename" from="extraPathNameList.remove(extraPathNameList.size()-1)"/><service-call name="org.moqui.impl.WikiServices.get#WikiPageAttachment" out-map="context" in-map="[wikiSpaceId:wikiSpaceId, pagePath:extraPathNameList?.join('/'), filename:filename]"/><script><![CDATA[ec.web.sendResourceResponse(attachmentReference.location, true)]]></script></actions><default-response type="none"/></transition><actions><set field="extraPathNameList" from="sri.screenUrlInfo.extraPathNameList"/><service-call name="org.moqui.impl.WikiServices.get#PublishedWikiPageText" out-map="context" in-map="[wikiSpaceId:wikiSpaceId, pagePath:extraPathNameList?.join('/'), versionName:ver]"/></actions><widgets><section name="PageTextSection" condition="pageText"><widgets><label text="${pageText}" type="div" style="content-page" encode="false"/></widgets><fail-widgets><label text="Sorry, we couldn't find that page!" type="h2" style="text-center"/></fail-widgets></section></widgets></screen>
<!-- Screen Location component://PopCommerce/screen/PopCommerceRoot/Customer/OrderDetail.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="true"><parameter name="orderId" required="true"/><actions><service-call name="mantle.order.OrderInfoServices.get#OrderDisplayInfo" in-map="[orderId:orderId]" out-map="context"/><set field="isCustomer" from="false"/><iterate list="orderPartInfoList" entry="orderPartInfo"><if condition="orderPartInfo.orderPart.customerPartyId == ec.user.userAccount?.partyId"><set field="isCustomer" from="true"/></if></iterate></actions><widgets><section name="CheckCustomerSection"><condition><expression><![CDATA[isCustomer]]></expression></condition><widgets><label text="Order #${orderId}, placed ${ec.l10n.format(orderHeader.placedDate ?: orderHeader.entryDate, 'd MMM yyyy')}" type="h2"/><section-iterate name="OrderPartSection" list="orderPartInfoList" entry="orderPartInfo"><actions><set field="contactInfo" from="orderPartInfo"/></actions><widgets><container style="row shaded-area"><container style="col-lg-4"><label text="Order Part ${orderPartInfo.orderPart.orderPartSeqId}" type="strong"/><label text="Part Total ${ec.l10n.formatCurrency(orderPartInfo.orderPart.partTotal ?: 0, orderHeader?.currencyUomId)}" type="p"/><label text="${orderPartInfo.shipmentMethodEnum?.description ?: ''}" type="p"/><widgets><render-mode><text type="html" location="component://SimpleScreens/template/party/ContactInfo.html.gstring"/></render-mode></widgets></container><container style="col-lg-4"><section-iterate name="PaymentInfoSection" list="orderPartInfo.partPaymentInfoList" entry="partPaymentInfo"><actions><set field="methodInfo" from="partPaymentInfo"/></actions><widgets><render-mode><text type="html" location="component://SimpleScreens/template/party/PaymentMethodInfo.html.gstring"/></render-mode></widgets></section-iterate></container></container><form-list name="OrderItems" list="orderPartInfo.partOrderItemList" list-entry="orderItem" skip-form="true"><row-actions><service-call name="mantle.order.OrderServices.get#OrderItemTotal" in-map="[orderItem:orderItem]" out-map="orderItemTotalOut"/><script><![CDATA[context.putAll(orderItem)]]></script></row-actions><field name="itemTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration" key-field-name="enumId" text="${description}"/></default-field></field><field name="description"><conditional-field condition="productId"><link text="${itemDescription} [${productId}]" url="/popc/Product/Detail/${productId}/${itemDescription?.replace(' ', '-')}" link-type="anchor"/></conditional-field><default-field title="Description"><display text="${itemDescription}"/></default-field></field><field name="unitAmount"><default-field><display currency-unit-field="orderHeader.currencyUomId"/></default-field></field><field name="quantity"><default-field><display/></default-field></field><field name="itemTotal" from="orderItemTotalOut.itemTotal"><default-field><display currency-unit-field="orderHeader.currencyUomId" also-hidden="false"/></default-field></field></form-list></widgets></section-iterate></widgets><fail-widgets><label text="You cannot view Order #${orderId}" type="h3"/></fail-widgets></section></widgets></screen>
<!-- Screen Location component://PopCommerce/screen/PopCommerceRoot/Customer/OrderHistory.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="true"><transition name="orderDetail"><default-response url="../OrderDetail"/></transition><actions><entity-find entity-name="mantle.order.OrderHeaderAndPart" list="orderList"><econdition field-name="customerPartyId" from="ec.user.userAccount.partyId"/><order-by field-name="-entryDate"/></entity-find></actions><widgets><form-list name="OrderHistoryList" list="orderList"><field name="orderId"><default-field><link text="${orderId}" url="orderDetail"/></default-field></field><field name="entryDate"><default-field><display format="d MMM yyyy"/></default-field></field><field name="statusId"><default-field title="Status"><display-entity entity-name="StatusItem"/></default-field></field><field name="grandTotal"><default-field><display currency-unit-field="currencyUomId"/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://PopCommerce/screen/PopCommerceRoot/Customer/Profile/UpdateContactInfo.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="partyId"/><parameter name="postalContactMechId"/><parameter name="postalContactMechPurposeId"/><parameter name="telecomContactMechId"/><parameter name="telecomContactMechPurposeId"/><parameter name="emailContactMechId"/><parameter name="emailContactMechPurposeId"/><transition name="storeContactInfo"><service-call name="mantle.party.ContactServices.store#PartyContactInfo" in-map="true" out-map="context" multi="parameter"/><default-response url=".."/></transition><transition-include name="getGeoCountryStates" location="component://SimpleScreens/template/party/PartyForms.xml"/><actions><if condition="postalContactMechId || telecomContactMechId || emailContactMechId"><service-call name="mantle.party.ContactServices.get#PartyContactInfo" out-map="contactInfo" in-map="context"/><set field="contactInfoFlat" from="flattenNestedMap(contactInfo)"/><else><set field="contactInfoFlat" from="[postalContactMechPurposeId:postalContactMechPurposeId,                         telecomContactMechPurposeId:telecomContactMechPurposeId, emailContactMechPurposeId:emailContactMechPurposeId]"/></else></if></actions><widgets><form-single name="ShippingInfo" transition="storeContactInfo" map="contactInfoFlat" extends="component://SimpleScreens/template/party/PartyForms.xml#ContactInfo"/></widgets></screen>
<!-- Screen Location component://PopCommerce/screen/PopCommerceRoot/Customer/Profile/UpdatePaymentMethodInfo.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" standalone="true"><parameter name="partyId"/><parameter name="paymentMethodId"/><parameter name="paymentMethodTypeEnumId"/><transition name="storePaymentMethodInfo"><service-call name="mantle.account.PaymentMethodServices.store#PaymentMethodInfo" in-map="true" out-map="context" multi="parameter"/><default-response url=".."/></transition><transition-include name="getGeoCountryStates" location="component://SimpleScreens/template/party/PartyForms.xml"/><actions><service-call name="mantle.account.PaymentMethodServices.get#PartyPaymentMethodInfo" out-map="methodInfo" in-map="context"/><set field="methodInfoFlat" from="flattenNestedMap(methodInfo)"/><entity-find entity-name="mantle.party.contact.PartyContactMechPostalAddress" list="partyPostalAddressList"><date-filter/><econdition field-name="partyId"/></entity-find><entity-find entity-name="mantle.party.contact.PartyContactMechTelecomNumber" list="partyTelecomNumberList"><date-filter/><econdition field-name="partyId"/></entity-find></actions><widgets><form-single name="PaymentMethodInfoForm" transition="storePaymentMethodInfo" map="methodInfoFlat" extends="component://SimpleScreens/template/party/PartyForms.xml#PaymentMethodInfo"/></widgets></screen>
<!-- Screen Location component://PopCommerce/screen/PopCommerceRoot/Customer/Profile.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="true"><transition name="updateUser"><service-call name="mantle.party.PartyServices.update#Account" in-map="context" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="changePassword"><service-call name="org.moqui.impl.UserServices.update#Password" in-map="true" out-map="context" multi="parameter"/><default-response url="."/><error-response url="."/></transition><transition name="updateContactInfo"><default-response url="UpdateContactInfo"/></transition><transition name="removeContactInfo"><service-call name="mantle.party.ContactServices.delete#PartyContactMech" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="updatePaymentMethodInfo"><default-response url="UpdatePaymentMethodInfo"/></transition><transition name="removePaymentMethod"><service-call name="mantle.account.PaymentMethodServices.delete#PaymentMethod" in-map="true" out-map="context" multi="parameter"/><default-response url="."/></transition><actions><set field="partyId" from="ec.user.userAccount.partyId"/><entity-find-one entity-name="mantle.party.PersonAndUserAccount" value-field="personAndUserAccount"/><service-call name="mantle.party.ContactServices.get#PrimaryEmailAddress" out-map="primaryEmail" in-map="[partyId:partyId]"/><set field="localeStringList" from="[]"/><iterate list="Locale.getAvailableLocales()" entry="lcl"><script><![CDATA[localeStringList.add([locale:lcl.toString(), name:lcl.getDisplayName(ec.user.locale)])]]></script></iterate><order-map-list list="localeStringList"><order-by field-name="name"/></order-map-list></actions><widgets><container style="row"><container style="col-lg-5"><container-dialog id="change-password" button-text="Change Password"><form-single name="ChangePasswordForm" transition="changePassword"><field name="oldPassword"><default-field><password size="20"/></default-field></field><field name="newPassword"><default-field><password size="20"/></default-field></field><field name="newPasswordVerify"><default-field><password size="20"/></default-field></field><field name="submitButton"><default-field title="Update"><submit/></default-field></field></form-single></container-dialog><form-single name="EditUser" transition="updateUser" map="personAndUserAccount"><field name="partyId"><default-field><hidden/></default-field></field><field name="userId"><default-field><hidden/></default-field></field><field name="username"><default-field><text-line size="20"/></default-field></field><field name="firstName"><default-field><text-line size="15"/></default-field></field><field name="middleName"><default-field><text-line size="15"/></default-field></field><field name="lastName"><default-field><text-line size="15"/></default-field></field><field name="emailAddress" from="primaryEmail.emailAddress"><default-field><text-line size="40"/></default-field></field><field name="locale"><default-field><drop-down allow-empty="true"><list-options list="localeStringList" key="${locale}" text="${name}"/></drop-down></default-field></field><field name="timeZone"><default-field><drop-down allow-empty="true"><list-options list="new TreeSet(TimeZone.getAvailableIDs().collect())"/></drop-down></default-field></field><field name="submitButton"><default-field title="Save"><submit/></default-field></field></form-single></container><container style="col-lg-7"><section name="BillingSection"><actions><service-call name="mantle.account.PaymentMethodServices.get#PartyPaymentMethodInfoList" in-map="[partyId:partyId]" out-map="cciOut"/></actions><widgets><container-box><box-header title="Billing Information"/><box-toolbar><dynamic-dialog id="CreateCreditCardDialog" button-text="Create Credit Card" transition="updatePaymentMethodInfo" width="800" parameter-map="[partyId:partyId, paymentMethodTypeEnumId:'PmtCreditCard']"/></box-toolbar><box-body><container style="float-box" type="ul"><section-iterate name="BillingInfoSection" list="cciOut.methodInfoList" entry="methodInfo"><widgets><container type="li"><render-mode><text type="html" location="component://SimpleScreens/template/party/PaymentMethodInfo.html.gstring"/></render-mode><dynamic-dialog id="UpdatePaymentMethodDialog" button-text="Update" transition="updatePaymentMethodInfo" width="800" parameter-map="[partyId:partyId, paymentMethodId:methodInfo.paymentMethodId]"/><link url="removePaymentMethod" text="Remove" parameter-map="[paymentMethodId:methodInfo.paymentMethodId]"/></container></widgets></section-iterate></container></box-body></container-box></widgets></section><section name="ShippingSection"><actions><service-call name="mantle.party.ContactServices.get#PartyContactInfoList" out-map="shippingContactListInfo" in-map="[partyId:partyId, postalContactMechPurposeId:'PostalShippingDest',                                     telecomContactMechPurposeId:'PhoneShippingDest']"/></actions><widgets><container-box><box-header title="Shipping Information"/><box-toolbar><dynamic-dialog id="UpdatePostalInfo" button-text="Add Shipping Info" transition="updateContactInfo" width="800" parameter-map="[partyId:partyId, postalContactMechPurposeId:'PostalShippingDest',                                             telecomContactMechPurposeId:'PhoneShippingDest']"/></box-toolbar><box-body><container style="float-box" type="ul"><section-iterate name="ShippingAddressList" list="shippingContactListInfo.postalAddressList" entry="postalAddressInfo"><actions><set field="contactInfo" from="postalAddressInfo"/></actions><widgets><container type="li"><render-mode><text type="html" location="component://SimpleScreens/template/party/ContactInfo.html.gstring"/></render-mode><dynamic-dialog id="UpdatePostalInfo" button-text="Update" transition="updateContactInfo" width="800" parameter-map="[partyId:partyId, postalContactMechId:contactInfo.postalContactMechId,                                                                 postalContactMechPurposeId:contactInfo.postalContactMechPurposeId]"/><link url="removeContactInfo" text="Remove" parameter-map="[partyId:partyId, contactMechId:contactInfo.postalContactMechId,                                                             contactMechPurposeId:contactInfo.postalContactMechPurposeId]"/></container></widgets></section-iterate></container></box-body></container-box></widgets></section></container></container></widgets></screen>
<!-- Screen Location component://PopCommerce/screen/PopCommerceRoot/Customer.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd"><subscreens default-item="Profile"/><widgets><subscreens-active id="customer"/></widgets></screen>
<!-- Screen Location component://PopCommerce/screen/PopCommerceRoot/Home.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="false"><transition name="addToCart"><actions><service-call name="mantle.order.OrderServices.add#OrderProductQuantity" out-map="addOut" in-map="defaultOrderParameters + [productId:productId, quantity:quantity]"/><set field="ec.web.sessionAttributes.cartOrderId" from="addOut.orderId"/></actions><default-response url="../Order/Cart"/><error-response url="."/></transition><actions><entity-find entity-name="ProductStoreCategory" list="pscList" cache="true"><date-filter/><econdition field-name="productStoreId"/><econdition field-name="storeCategoryTypeEnumId" value="PsctHomePage"/></entity-find><set field="productCategoryId" from="pscList?.getAt(0)?.productCategoryId"/><entity-find entity-name="ProductCategoryMemberProduct" list="pcmpList" cache="true"><date-filter/><econdition field-name="productCategoryId" from="productCategoryId"/><order-by field-name="sequenceNum"/><order-by field-name="productName"/></entity-find></actions><widgets><form-list name="HomeProductList" list="pcmpList" transition="addToCart"><row-actions><service-call name="mantle.product.PriceServices.get#ProductPrice" out-map="priceMap" in-map="[productId:productId, priceUomId:priceUomId, productStoreId:productStoreId,                                 vendorPartyId:vendorPartyId, customerPartyId:customerPartyId]"/><set field="price" from="priceMap?.price"/><set field="priceUomId" from="priceMap?.priceUomId"/></row-actions><field name="productId"><default-field><hidden/></default-field></field><field name="productName"><default-field title=""><link text="${productName}" url="/popc/Product/Detail/${productId}/${productName?.replace(' ', '-')}" url-noparam="true" link-type="anchor"/></default-field></field><field name="price"><default-field title=""><display also-hidden="false" currency-unit-field="priceUomId"/></default-field></field><field name="quantity"><default-field title=""><text-line size="2" default-value="1"/></default-field></field><field name="add"><default-field title="Add to Cart"><submit/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://PopCommerce/screen/PopCommerceRoot/Login.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" require-authentication="anonymous-all" history="false"><transition name="login" require-session-token="false"><actions><script><![CDATA[ec.user.loginUser(username, password)]]></script><if condition="ec.user.userAccount"><entity-find entity-name="mantle.order.OrderHeaderAndPart" list="existingOrderList"><econdition field-name="statusId" value="OrderOpen"/><econdition field-name="customerPartyId" from="ec.user.userAccount.partyId"/><select-field field-name="orderId"/><select-field field-name="orderPartSeqId"/><order-by field-name="-entryDate"/></entity-find><if condition="existingOrderList"><if condition="ec.web.sessionAttributes.cartOrderId"><service-call name="mantle.order.OrderServices.merge#OrderItems" in-map="[orderId:existingOrderList[0].orderId, fromOrderId:ec.web.sessionAttributes.cartOrderId]"/></if><set field="ec.web.sessionAttributes.cartOrderId" from="existingOrderList[0].orderId"/><else><if condition="ec.web.sessionAttributes.cartOrderId"><entity-find entity-name="OrderPart" list="orderPartList"><econdition field-name="orderId" from="ec.web.sessionAttributes.cartOrderId"/></entity-find><if condition="orderPartList"><set field="orderPart" from="orderPartList[0]"/><set field="orderPart.customerPartyId" from="ec.user.userAccount.partyId"/><entity-update value-field="orderPart"/></if></if></else></if></if></actions><default-response type="screen-last"/><error-response url="."/></transition><transition name="logout"><actions><script><![CDATA[ec.user.logoutUser()]]></script></actions><default-response url="/popc"/><error-response url="."/></transition><transition name="resetPassword" require-session-token="false"><service-call name="org.moqui.impl.UserServices.reset#Password" in-map="[username:username]" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="changePassword" require-session-token="false"><service-call name="org.moqui.impl.UserServices.update#Password" in-map="true" out-map="context" multi="parameter"/><default-response url="../Login"/><error-response url="."/></transition><transition name="createAccount" require-session-token="false"><service-call name="mantle.party.PartyServices.create#Account" in-map="context + [roleTypeId:'Customer']" out-map="context" multi="parameter"/><default-response type="screen-last"/><error-response url="."/></transition><widgets><container style="login"><container style="container"><render-mode><text type="html" template="true" location="component://PopCommerce/screen/PopCommerceRoot/Login.ftl"/></render-mode></container></container><link url="login" text="Test Login (Joe Q Public)"><parameter name="username" value="joe@public.com"/><parameter name="password" value="moqui"/></link></widgets></screen>
<!-- Screen Location component://PopCommerce/screen/PopCommerceRoot/Order/Cart.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="false"><transition name="updateCartItems"><service-call name="mantle.order.OrderServices.update#OrderProductQuantity" multi="true" in-map="context + [orderId:cartOrderId]" out-map="context"/><default-response url="."/></transition><pre-actions><set field="html_title" value="Shopping Cart${cartOrderId ? ' for Order #' + cartOrderId : ''}"/></pre-actions><actions><if condition="cartOrderId"><service-call name="mantle.order.OrderInfoServices.get#OrderDisplayInfo" in-map="[orderId:cartOrderId]" out-map="context"/></if><entity-find entity-name="moqui.basic.EnumGroupMember" list="productItemTypeEgms" cache="true"><econdition field-name="enumGroupEnumId" value="EngItemsProduct"/></entity-find><set field="productItemTypes" from="productItemTypeEgms*.enumId"/></actions><widgets><form-list name="CartItems" list="orderItemList" list-entry="orderItem" multi="true" transition="updateCartItems"><row-actions><service-call name="mantle.order.OrderServices.get#OrderItemTotal" in-map="[orderItem:orderItem]" out-map="orderItemTotalOut"/><script><![CDATA[context.putAll(orderItem)]]></script></row-actions><field name="orderItemSeqId"><conditional-field condition="productId"><hidden/></conditional-field><default-field><ignored/></default-field></field><field name="itemTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration" key-field-name="enumId" text="${description}" also-hidden="false"/></default-field></field><field name="description"><conditional-field condition="productId"><link text="${itemDescription} [${productId}]" url="/popc/Product/Detail/${productId}/${itemDescription?.replace(' ', '-')}" link-type="anchor"/></conditional-field><default-field title="Description"><display text="${itemDescription}"/></default-field></field><field name="unitAmount"><default-field><display currency-unit-field="orderHeader.currencyUomId" also-hidden="false"/></default-field></field><field name="quantity"><conditional-field condition="orderItem?.itemTypeEnumId in productItemTypes"><text-line size="4"/></conditional-field><default-field><display also-hidden="false"/></default-field></field><field name="itemTotal" from="orderItemTotalOut.itemTotal"><default-field><display currency-unit-field="orderHeader.currencyUomId" also-hidden="false"/></default-field></field><field name="updateCartButton"><default-field title="Update Cart"><submit/></default-field></field></form-list><label text="Order Total: ${ec.l10n.formatCurrency(orderHeader?.grandTotal ?: 0, orderHeader?.currencyUomId)}" type="h3"/></widgets></screen>
<!-- Screen Location component://PopCommerce/screen/PopCommerceRoot/Order/Checkout.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="true"><transition name="setOrderBillingShippingInfo"><service-call name="mantle.order.OrderServices.set#OrderBillingShippingInfo" in-map="context + [orderId:cartOrderId]" out-map="context" multi="parameter"/><default-response url="../Review"/></transition><transition name="updateContactInfo"><default-response url="UpdateContactInfo"/></transition><transition name="updatePaymentMethodInfo"><default-response url="UpdatePaymentMethodInfo"/></transition><subscreens><subscreens-item name="UpdateContactInfo" location="component://PopCommerce/screen/PopCommerceRoot/Customer/Profile/UpdateContactInfo.xml"/><subscreens-item name="UpdatePaymentMethodInfo" location="component://PopCommerce/screen/PopCommerceRoot/Customer/Profile/UpdatePaymentMethodInfo.xml"/></subscreens><actions><entity-find-one entity-name="mantle.order.OrderHeader" value-field="orderHeader"><field-map field-name="orderId" from="cartOrderId"/></entity-find-one><entity-find-one entity-name="mantle.order.OrderPart" value-field="orderPart"><field-map field-name="orderId" from="cartOrderId"/></entity-find-one><set field="partyId" from="ec.user.userAccount.partyId"/><service-call name="mantle.account.PaymentMethodServices.get#PartyPaymentMethodInfoList" in-map="[partyId:partyId]" out-map="cciOut"/><service-call name="mantle.party.ContactServices.get#PartyContactInfoList" out-map="shippingContactListInfo" in-map="[partyId:partyId, postalContactMechPurposeId:'PostalShippingDest',                     telecomContactMechPurposeId:'PhoneShippingDest']"/><service-call name="mantle.product.StoreServices.get#StoreShippingOptions" out-map="context" in-map="[productStoreId:productStoreId, orderId:cartOrderId, orderPartSeqId:orderPart.orderPartSeqId,                     postalContactMechId:shippingContactListInfo.postalAddressList?.first?.postalContactMechId, getRates:true]"/><entity-find entity-name="mantle.account.payment.Payment" list="paymentList"><econdition field-name="orderId" from="orderPart.orderId"/><econdition field-name="orderPartSeqId" from="orderPart.orderPartSeqId"/><order-by field-name="paymentId"/></entity-find><set field="payment" from="paymentList.first"/></actions><widgets><container-box><box-header title="Choose a Credit Card"/><box-toolbar><dynamic-dialog id="CreateCreditCardDialog" button-text="Add Credit Card" transition="updatePaymentMethodInfo" width="800" parameter-map="[partyId:partyId, paymentMethodTypeEnumId:'PmtCreditCard']"/></box-toolbar><box-body><container style="float-box" type="ul"><section-iterate name="BillingInfoSection" list="cciOut.methodInfoList" entry="methodInfo"><actions><set field="checkRadio" from="(payment?.paymentMethodId && payment?.paymentMethodId == methodInfo.paymentMethodId) || (!payment?.paymentMethodId && methodInfo_index == 0)"/></actions><widgets><container type="li"><render-mode><text type="html"><![CDATA[<div class="text-center"><input type="radio" name="paymentMethodId" value="${methodInfo.paymentMethodId}"<#if checkRadio> checked="checked"</#if>></div>]]></text></render-mode><render-mode><text type="html" location="component://SimpleScreens/template/party/PaymentMethodInfo.html.gstring"/></render-mode><dynamic-dialog id="UpdatePaymentMethodDialog" button-text="Update" transition="updatePaymentMethodInfo" width="800" parameter-map="[partyId:partyId, paymentMethodId:methodInfo.paymentMethodId]"/></container></widgets></section-iterate></container></box-body></container-box><container-box><box-header title="Choose a Shipping Address"/><box-toolbar><dynamic-dialog id="UpdatePostalInfo" button-text="Add Shipping Address" transition="updateContactInfo" width="800" parameter-map="[partyId:partyId, postalContactMechPurposeId:'PostalShippingDest']"/></box-toolbar><box-body><container style="float-box" type="ul"><section-iterate name="ShippingAddressList" list="shippingContactListInfo.postalAddressList" entry="postalAddressInfo"><actions><set field="contactInfo" from="postalAddressInfo"/><set field="checkRadio" from="(orderPart.postalContactMechId && orderPart.postalContactMechId == contactInfo.postalContactMechId) || (!orderPart.postalContactMechId && postalAddressInfo_index == 0)"/></actions><widgets><container type="li"><render-mode><text type="html"><![CDATA[<div class="text-center"><input type="radio" name="shippingPostalContactMechId" value="${contactInfo.postalContactMechId}"<#if checkRadio> checked="checked"</#if>></div>]]></text></render-mode><render-mode><text type="html" location="component://SimpleScreens/template/party/ContactInfo.html.gstring"/></render-mode><dynamic-dialog id="UpdatePostalInfo" button-text="Update" transition="updateContactInfo" width="800" parameter-map="[partyId:partyId, postalContactMechId:contactInfo.postalContactMechId,                                                         postalContactMechPurposeId:contactInfo.postalContactMechPurposeId]"/></container></widgets></section-iterate></container></box-body></container-box><form-single name="SetOrderInfoForm" transition="setOrderBillingShippingInfo"><field name="paymentMethodId"><default-field><hidden/></default-field></field><field name="shippingPostalContactMechId"><default-field><hidden/></default-field></field><field name="shippingTelecomContactMechId"><default-field><hidden/></default-field></field><field name="carrierAndShipmentMethod"><default-field title="Shipment Method"><drop-down no-current-selected-key="${orderPart.carrierPartyId ? orderPart.carrierPartyId + ':' + orderPart.shipmentMethodEnumId : ''}"><list-options list="shippingOptions" key="${carrierPartyId}:${shipmentMethodEnumId}" text="${carrierPartyId == '_NA_' ? '' : (carrierName + ' - ') }${shipmentMethodDescription} ${shippingTotal != null ? ec.l10n.formatCurrency(shippingTotal, orderHeader.currencyUomId) : ''}"/></drop-down></default-field></field><field name="submitButton"><conditional-field condition="cciOut.methodInfoList && shippingContactListInfo.postalAddressList" title="Set Info and Review Order"><submit/></conditional-field><default-field><ignored/></default-field></field></form-single><render-mode><text type="html"><![CDATA[<script>
                $("#SetOrderInfoForm_paymentMethodId").val($("input[name=paymentMethodId]:checked").val());
                $("input[name=paymentMethodId]:radio").change( function() { $("#SetOrderInfoForm_paymentMethodId").val($("input[name=paymentMethodId]:checked").val()); })

                $("#SetOrderInfoForm_shippingPostalContactMechId").val($("input[name=shippingPostalContactMechId]:checked").val());
                $("input[name=shippingPostalContactMechId]:radio").change( function() { $("#SetOrderInfoForm_shippingPostalContactMechId").val($("input[name=shippingPostalContactMechId]:checked").val()); })
            </script>]]></text></render-mode></widgets></screen>
<!-- Screen Location component://PopCommerce/screen/PopCommerceRoot/Order/Review.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="true"><transition name="placeOrder"><actions><service-call name="mantle.order.OrderServices.place#Order" in-map="[orderId:cartOrderId]"/><script><![CDATA[ec.web.sessionAttributes.remove("cartOrderId")]]></script></actions><default-response url="../../Customer/OrderDetail"><parameter name="orderId" from="cartOrderId"/></default-response></transition><pre-actions><set field="html_title" value="Review Order #${cartOrderId}"/></pre-actions><actions><service-call name="mantle.order.OrderInfoServices.get#OrderDisplayInfo" in-map="[orderId:cartOrderId]" out-map="context"/></actions><widgets><section-iterate name="OrderPartSection" list="orderPartInfoList" entry="orderPartInfo"><actions><set field="contactInfo" from="orderPartInfo"/></actions><widgets><container-panel id="order-panel-${orderPartInfo.orderPart.orderPartSeqId}"><panel-left><label text="Order Part ${orderPartInfo.orderPart.orderPartSeqId}" type="strong"/><label text="Part Total ${ec.l10n.formatCurrency(orderHeader?.grandTotal ?: 0, orderHeader?.currencyUomId)}" type="p"/><label text="${orderPartInfo.shipmentMethodEnum?.description ?: ''}" type="p"/><widgets><render-mode><text type="html" location="component://SimpleScreens/template/party/ContactInfo.html.gstring"/></render-mode></widgets></panel-left><panel-center><section-iterate name="PaymentInfo" list="orderPartInfo.partPaymentInfoList" entry="partPaymentInfo"><actions><set field="contactInfo" from="partPaymentInfo"/><set field="cardNumber" from="partPaymentInfo.creditCard?.cardNumber"/><set field="cardNumber" from="cardNumber ? (partPaymentInfo.creditCard.creditCardTypeEnumId == 'CctAmericanExpress' ? '***********' : '************') + cardNumber.substring(cardNumber.length() - 4, cardNumber.length()) : ''"/></actions><widgets><label text="${partPaymentInfo.paymentMethodTypeEnum?.description}" type="p"/><label text="${ec.l10n.formatCurrency(partPaymentInfo.partPayment.amount, partPaymentInfo.partPayment.amountUomId)}" type="p"/><label text="${partPaymentInfo.paymentMethod?.firstNameOnAccount} ${partPaymentInfo.paymentMethod?.lastNameOnAccount}" type="p"/><label text="${partPaymentInfo.creditCardTypeEnum?.description} ${cardNumber} ${partPaymentInfo.creditCard?.expireDate}" type="p"/><widgets><render-mode><text type="html" location="component://SimpleScreens/template/party/ContactInfo.html.gstring"/></render-mode></widgets></widgets></section-iterate></panel-center><panel-footer><form-list name="OrderItems" list="orderPartInfo.partOrderItemList" list-entry="orderItem" skip-form="true"><row-actions><service-call name="mantle.order.OrderServices.get#OrderItemTotal" in-map="[orderItem:orderItem]" out-map="orderItemTotalOut"/><script><![CDATA[context.putAll(orderItem)]]></script></row-actions><field name="itemTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration" key-field-name="enumId" text="${description}"/></default-field></field><field name="description"><default-field title="Description"><display text="${itemDescription} ${productId ? '[' + productId + ']' : ''}"/></default-field></field><field name="unitAmount"><default-field><display currency-unit-field="orderHeader.currencyUomId"/></default-field></field><field name="quantity"><default-field><display/></default-field></field><field name="itemTotal" from="orderItemTotalOut.itemTotal"><default-field><display currency-unit-field="orderHeader.currencyUomId" also-hidden="false"/></default-field></field></form-list></panel-footer></container-panel></widgets></section-iterate><label text="Order Total: ${ec.l10n.formatCurrency(orderHeader?.grandTotal ?: 0, orderHeader?.currencyUomId)}" type="h3"/><container><link text="Place Order" link-type="hidden-form" url="placeOrder"/></container></widgets></screen>
<!-- Screen Location component://PopCommerce/screen/PopCommerceRoot/Order.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="false"><subscreens default-item="Cart"/><widgets><subscreens-active id="order"/></widgets></screen>
<!-- Screen Location component://PopCommerce/screen/PopCommerceRoot/Product/Category.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="false" allow-extra-path="true"><parameter name="productCategoryId" required="true"/><transition name="addToCart"><actions><service-call name="mantle.order.OrderServices.add#OrderProductQuantity" out-map="addOut" in-map="defaultOrderParameters + [productId:productId, quantity:quantity]"/><set field="ec.web.sessionAttributes.cartOrderId" from="addOut.orderId"/></actions><default-response url="../../Order/Cart"/><error-response url="."/></transition><pre-actions><set field="extraPathNameList" from="sri.screenUrlInfo.extraPathNameList"/><if condition="extraPathNameList && !productCategoryId"><set field="productCategoryId" from="extraPathNameList[0]"/></if><entity-find-one entity-name="mantle.product.category.ProductCategory" value-field="productCategory"/><set field="html_title" from="productCategory?.categoryName ?: ''"/></pre-actions><actions><entity-find entity-name="ProductCategoryMemberProduct" list="pcmpList" cache="true"><date-filter/><econdition field-name="productCategoryId" from="productCategoryId"/><order-by field-name="sequenceNum"/><order-by field-name="productName"/></entity-find></actions><widgets><label text="${productCategory.description ?: ''}" type="p"/><form-list name="CategoryProductList" list="pcmpList" transition="addToCart"><row-actions><service-call name="mantle.product.PriceServices.get#ProductPrice" out-map="priceMap" in-map="[productId:productId, priceUomId:priceUomId, productStoreId:productStoreId,                                 vendorPartyId:vendorPartyId, customerPartyId:customerPartyId]"/><set field="price" from="priceMap?.price"/><set field="priceUomId" from="priceMap?.priceUomId"/></row-actions><field name="productId"><default-field><hidden/></default-field></field><field name="productName"><default-field title=""><link text="${productName}" url="/popc/Product/Detail/${productId}/${productName?.replace(' ', '-')}" url-noparam="true" link-type="anchor"/></default-field></field><field name="price"><default-field title=""><display also-hidden="false" currency-unit-field="priceUomId"/></default-field></field><field name="quantity"><default-field title=""><text-line size="2" default-value="1"/></default-field></field><field name="add"><default-field title="Add to Cart"><submit/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://PopCommerce/screen/PopCommerceRoot/Product/Detail/ProductReviewList.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" require-authentication="false" standalone="true"><parameter name="productId"/><actions><entity-find entity-name="mantle.product.ProductReview" list="productReviewList"><econdition field-name="productStoreId"/><econdition field-name="productId"/><econdition field-name="statusId" value="PrvwApproved"/></entity-find></actions><widgets><render-mode><text type="html"><![CDATA[<br/><br/>]]></text></render-mode><section name="reviews" condition="productReviewList"><widgets><section-iterate name="ProductReviewList" list="productReviewList" entry="review"><widgets><render-mode><text type="html"><![CDATA[<input id="productRating${review_index}" value="${review.productRating}" type="number" class="rating" data-min=0 data-max=5 data-step=1 data-size="xs" data-stars=5 data-show-clear="false" data-readonly="true"><script>$("#productRating${review_index}").rating();</script><span>${review.productReview}</span><br/><br/><hr/>]]></text></render-mode></widgets></section-iterate></widgets><fail-widgets><label text="No reviews yet, be the first to review!" type="h5"/></fail-widgets></section></widgets></screen>
<!-- Screen Location component://PopCommerce/screen/PopCommerceRoot/Product/Detail.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Product Detail" require-authentication="false" allow-extra-path="true"><parameter name="productId" required="true"/><transition name="image" read-only="true"><parameter name="productContentId"/><actions><set field="extraPathNameList" from="sri.screenUrlInfo.extraPathNameList"/><if condition="extraPathNameList && !productContentId"><set field="productContentId" from="extraPathNameList[0]"/></if><entity-find-one entity-name="mantle.product.ProductContent" value-field="productContent" cache="true"><field-map field-name="productContentId"/></entity-find-one><if condition="productContent == null"><then><script><![CDATA[ec.web.sendError(404, null, null)]]></script></then><else><script><![CDATA[ec.web.sendResourceResponse(productContent.contentLocation, true)]]></script></else></if></actions><default-response type="none"/></transition><transition name="addToCart"><actions><service-call name="mantle.order.OrderServices.add#OrderProductQuantity" out-map="addOut" in-map="defaultOrderParameters + [productId:productId, quantity:quantity]"/><set field="ec.web.sessionAttributes.cartOrderId" from="addOut.orderId"/></actions><default-response url="../../Order/Cart"/><error-response url="."/></transition><transition name="createProductReview"><service-call name="create#mantle.product.ProductReview" web-send-json-response="true" in-map="context + [userId:(ec.user.userId ?: '_NA_'), statusId:'PrvwPending',                     postedAnonymous:(ec.user.userId ? 'N' : 'Y'), postedDateTime:ec.user.nowTimestamp]" out-map="context" multi="parameter"/><default-response type="none"/></transition><pre-actions><set field="extraPathNameList" from="sri.screenUrlInfo.extraPathNameList"/><if condition="extraPathNameList && !productId"><set field="productId" from="extraPathNameList[0]"/></if><entity-find-one entity-name="mantle.product.Product" value-field="product"/><set field="html_title" from="product?.productName ?: ''"/><script><![CDATA[html_stylesheets.add("static/rating/star-rating.min.css")]]></script><script><![CDATA[footer_scripts.add("static/rating/star-rating.min.js")]]></script></pre-actions><actions><service-call name="mantle.product.PriceServices.get#ProductPrice" out-map="priceMap" in-map="[productId:productId, priceUomId:priceUomId, productStoreId:productStoreId,                     vendorPartyId:vendorPartyId, customerPartyId:customerPartyId]"/><set field="price" from="priceMap?.price"/><set field="priceUomId" from="priceMap?.priceUomId"/><entity-find-one entity-name="moqui.basic.Enumeration" value-field="productClassEnum"><field-map field-name="enumId" from="product.productClassEnumId"/></entity-find-one><entity-find entity-name="mantle.product.feature.ProductFeatureAndAppl" list="pfaaList" cache="true"><date-filter/><econdition field-name="productId"/><econdition field-name="applTypeEnumId" value="PfatStandard"/><order-by field-name="productFeatureTypeEnumId"/><order-by field-name="description"/></entity-find><entity-find entity-name="mantle.product.ProductDimensionAndType" list="dimensionList" cache="true"><econdition field-name="productId"/><order-by field-name="description"/></entity-find><entity-find entity-name="mantle.product.ProductContent" list="contentList" cache="true"><date-filter/><econdition field-name="productId"/><order-by field-name="sequenceNum,-fromDate"/></entity-find><set field="descLongLocation" from="contentList.find({ 'PcntDescriptionLong' == it.productContentTypeEnumId })?.contentLocation"/><if condition="descLongLocation"><set field="descriptionLong" from="ec.resource.getLocationText(descLongLocation, true)"/></if><set field="imageSmallList" from="contentList.findAll({ 'PcntImageSmall' == it.productContentTypeEnumId })"/></actions><widgets><label text="${product.description ?: ''}" type="p"/><container-row><row-col md="6"><form-single name="ProductAddToCartForm" transition="addToCart"><field name="productId"><default-field><hidden/></default-field></field><field name="price"><default-field title=""><display also-hidden="false" currency-unit-field="priceUomId"/></default-field></field><field name="quantity"><default-field title=""><text-line size="2" default-value="1"/></default-field></field><field name="add"><default-field title="Add to Cart"><submit/></default-field></field><field-layout><field-row-big><field-ref name="price"/><field-ref name="quantity"/><field-ref name="add"/></field-row-big></field-layout></form-single><label text="Class: ${productClassEnum.description}" condition="productClassEnum" type="strong"/></row-col><row-col md="6"><section-iterate name="ImageSmallSection" list="imageSmallList" entry="imageSmall"><widgets><image url="image/${imageSmall.productContentId}" url-type="transition" alt="${imageSmall.description}" width="64" parameter-map="[productId:null]"/></widgets></section-iterate></row-col></container-row><label text="${descriptionLong}" encode="false" type="div" condition="descriptionLong"/><container-row><row-col lg="6" md="6"><container-box><box-header title="Features"/><box-body><form-list name="FeaturesForm" list="pfaaList" skip-form="true" skip-header="true"><field name="productFeatureTypeEnumId"><default-field title="Type"><display-entity entity-name="moqui.basic.Enumeration"/></default-field></field><field name="description"><default-field title="Feature"><display/></default-field></field></form-list></box-body></container-box></row-col><row-col lg="6" md="6"><container-box><box-header title="Dimensions"/><box-body><form-list name="DimensionsForm" list="dimensionList" skip-form="true" skip-header="true"><field name="description"><default-field title="Type"><display/></default-field></field><field name="value"><default-field><display/></default-field></field><field name="valueUomId"><default-field title="Unit"><display-entity entity-name="moqui.basic.Uom"/></default-field></field></form-list></box-body></container-box></row-col></container-row><container-dialog id="AddProductReviewDialog" button-text="Add Review" width="800"><form-single name="AddProductReview" transition="createProductReview" background-submit="true" background-reload-id="ProductReviewListContainer" background-message="Thanks for submitting review" background-hide-id="AddProductReviewDialog"><field name="productId"><default-field><hidden/></default-field></field><field name="productRating"><default-field title="Rating"><render-mode><text type="html"><![CDATA[<input name="productRating" id="productRating" value="0" type="number" class="rating" data-min=0 data-max=5 data-step=1 data-size="xs" data-stars=5 data-show-clear="false"><script language="javascript">$("#productRating").rating();</script>]]></text></render-mode></default-field></field><field name="productReview"><default-field title="Comments"><text-area cols="80" rows="10"/></default-field></field><field name="submitButton"><default-field title="Add"><submit/></default-field></field></form-single></container-dialog><dynamic-container id="ProductReviewListContainer" transition="ProductReviewList"/></widgets></screen>
<!-- Screen Location component://PopCommerce/screen/PopCommerceRoot/Product/Search.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Search Results" require-authentication="false"><parameter name="category"/><parameter name="keywords"/><transition name="addToCart"><actions><service-call name="mantle.order.OrderServices.add#OrderProductQuantity" out-map="addOut" in-map="defaultOrderParameters + [productId:productId, quantity:quantity]"/><set field="ec.web.sessionAttributes.cartOrderId" from="addOut.orderId"/></actions><default-response url="../../Order/Cart"/><error-response url="."/></transition><actions><if condition="category || keywords"><set field="queryString" from="elasticQueryAutoWildcard(keywords, false)"/><if condition="category"><set field="queryString" from="(queryString ? queryString + ' AND ' : '') + 'categories.productCategoryId:' + category"/></if><service-call name="org.moqui.search.SearchServices.search#DataDocuments" out-map="context" in-map="[queryString:queryString, indexName:'popc', documentType:'PopcProduct']"/></if></actions><widgets><form-single name="HeaderSearch" focus-field="keywords" transition="."><field name="category"><default-field title=""><drop-down allow-empty="true"><entity-options key="${productCategoryId}" text="${categoryName}"><entity-find entity-name="ProductCategoryChildren" cache="true"><date-filter/><econdition field-name="parentProductCategoryId" value="PopcBrowseRoot"/><order-by field-name="sequenceNum"/><order-by field-name="categoryName"/></entity-find></entity-options></drop-down></default-field></field><field name="keywords"><default-field title=""><text-line size="25"/></default-field></field><field name="submitButton"><default-field title="Search"><submit/></default-field></field><field-layout><field-row-big><field-ref name="category"/><field-ref name="keywords"/><field-ref name="submitButton"/></field-row-big></field-layout></form-single><form-list name="SearchProductList" list="documentList" list-entry="document" transition="addToCart"><row-actions><set field="productId" from="document._id"/><entity-find-one entity-name="mantle.product.Product" value-field="product" cache="true"/><service-call name="mantle.product.PriceServices.get#ProductPrice" out-map="priceMap" in-map="[productId:productId, priceUomId:priceUomId, productStoreId:productStoreId,                                 vendorPartyId:vendorPartyId, customerPartyId:customerPartyId]"/><set field="price" from="priceMap?.price"/><set field="priceUomId" from="priceMap?.priceUomId"/></row-actions><field name="productId"><default-field><hidden/></default-field></field><field name="productName" from="product.productName"><default-field title=""><link text="${product.productName}" url="/popc/Product/Detail/${productId}/${product.productName?.replace(' ', '-')}" url-noparam="true" link-type="anchor"/></default-field></field><field name="price"><default-field title=""><display also-hidden="false" currency-unit-field="priceUomId"/></default-field></field><field name="quantity"><default-field title=""><text-line size="2" default-value="1"/></default-field></field><field name="add"><default-field title="Add to Cart"><submit/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://PopCommerce/screen/PopCommerceRoot/Product.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="false"><subscreens default-item="Category"/><widgets><subscreens-active id="product"/></widgets></screen>
<!-- Screen Location component://PopCommerce/screen/PopCommerceRoot/TestOrders.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" begin-transaction="false" require-authentication="false"><parameter name="numOrders"/><actions><script><![CDATA[import org.moqui.context.ExecutionContext
            import org.moqui.context.TransactionFacade
            import org.moqui.impl.context.ArtifactExecutionInfoImpl
            import org.moqui.impl.context.TransactionCache
            ExecutionContext ec = context.ec
            TransactionFacade tf = ec.getTransaction()

            resultMessages = []

            numOrders = (numOrders ?: 10) as int

            ec.user.loginUser("joe@public.com", "moqui")

            long startTime = System.currentTimeMillis()
            for (int i = 0; i < numOrders; i++) {
                if (ec.message.hasError()) break
                boolean beganTransaction = false

                // boolean beganTransaction = tf.begin()
                // ec.transaction.initTransactionCache()
                try {
                    // ec.user.loginUser("joe@public.com", "moqui")

                    Map addOut1 = ec.service.sync().name("mantle.order.OrderServices.add#OrderProductQuantity")
                            .parameters([productId:'DEMO_1_1', quantity:1, customerPartyId:customerPartyId,
                            currencyUomId:currencyUomId, productStoreId:productStoreId]).call()

                    cartOrderId = addOut1.orderId
                    orderPartSeqId = addOut1.orderPartSeqId

                    ec.service.sync().name("mantle.order.OrderServices.add#OrderProductQuantity")
                            .parameters([orderId:cartOrderId, orderPartSeqId:orderPartSeqId, productId:'DEMO_3_1',
                                quantity:1, customerPartyId:customerPartyId, currencyUomId:currencyUomId,
                                productStoreId:productStoreId]).call()
                    ec.service.sync().name("mantle.order.OrderServices.add#OrderProductQuantity")
                            .parameters([orderId:cartOrderId, orderPartSeqId:orderPartSeqId, productId:'DEMO_2_1',
                                quantity:1, customerPartyId:customerPartyId, currencyUomId:currencyUomId,
                                productStoreId:productStoreId]).call()

                    ec.service.sync().name("mantle.order.OrderServices.set#OrderBillingShippingInfo")
                            .parameters([orderId:cartOrderId, paymentMethodId:'CustJqpCc', shippingPostalContactMechId:'CustJqpAddr',
                                shippingTelecomContactMechId:'CustJqpTeln', shipmentMethodEnumId:'ShMthNoShipping',
                                carrierPartyId:'_NA_']).call()

                    ec.service.sync().name("mantle.order.OrderServices.place#Order").parameters([orderId:cartOrderId]).call()

                    // ec.user.logoutUser()
                    // ec.user.loginUser("john.doe", "moqui")

                    ec.service.sync().name("mantle.shipment.ShipmentServices.ship#OrderPart")
                            .parameters([orderId:cartOrderId, orderPartSeqId:orderPartSeqId]).call()

                    // ec.user.logoutUser()

                    resultMessages.add("[${i+1}/${numOrders} - ${System.currentTimeMillis() - startTime}] Created order ${cartOrderId}")
                    ec.logger.info("[${i+1}/${numOrders} - ${System.currentTimeMillis() - startTime}] Created order ${cartOrderId}")
                } catch (Throwable t) {
                    tf.rollback(beganTransaction, "Error running test", t)
                    ec.logger.warn("Error running test" + t.toString())
                } finally {
                    if (beganTransaction && tf.isTransactionInPlace()) {
                        tf.commit()
                    }
                }
            }
            long endTime = System.currentTimeMillis()
            double seconds = (endTime - startTime)/1000
            resultMessages.add("Created and placed ${numOrders} in ${seconds} seconds, ${numOrders/seconds} orders per second")

            def artifactHistory = ec.artifactExecution.history
            ownHotSpotList = ArtifactExecutionInfoImpl.hotSpotByTime(artifactHistory, true, "-time")
            totalHotSpotList = ArtifactExecutionInfoImpl.hotSpotByTime(artifactHistory, false, "-time")

            List<Map> consolidatedList = ArtifactExecutionInfoImpl.consolidateArtifactInfo(artifactHistory)
            printedArtifactInfo = ArtifactExecutionInfoImpl.printArtifactInfoList(consolidatedList)]]></script></actions><widgets><section-iterate name="ResultSection" list="resultMessages" entry="resultMessage"><widgets><label text="${resultMessage}" type="p"/></widgets></section-iterate><label text="Artifacts by Own Time" type="h3"/><form-list name="OwnHotSpots" list="ownHotSpotList" skip-form="true"><field name="time"><default-field><display/></default-field></field><field name="timeMin"><default-field><display/></default-field></field><field name="timeAvg"><default-field><display text="${time/count}" format="0.##"/></default-field></field><field name="timeMax"><default-field><display/></default-field></field><field name="count"><default-field><display/></default-field></field><field name="name"><default-field><display/></default-field></field><field name="type"><default-field><display/></default-field></field><field name="action"><default-field><display/></default-field></field><field name="actionDetail"><default-field><display/></default-field></field></form-list><label text="Artifacts by Own plus Children Time" type="h3"/><form-list name="TotalHotSpots" list="totalHotSpotList" skip-form="true"><field name="time"><default-field><display/></default-field></field><field name="timeMin"><default-field><display/></default-field></field><field name="timeAvg"><default-field><display text="${time/count}" format="0.##"/></default-field></field><field name="timeMax"><default-field><display/></default-field></field><field name="count"><default-field><display/></default-field></field><field name="name"><default-field><display/></default-field></field><field name="type"><default-field><display/></default-field></field><field name="action"><default-field><display/></default-field></field><field name="actionDetail"><default-field><display/></default-field></field></form-list><label text="Consolidated Artifacts Tree" type="h3"/><label text="${printedArtifactInfo}" encode="true" type="pre"/></widgets></screen>
<!-- Screen Location component://PopCommerce/screen/PopCommerceRoot.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" screen-theme-type-enum-id="STT_POP_COMMERCE" standalone="true" require-authentication="anonymous-view" login-path="/popc/Login"><always-actions><set field="productStoreId" value="POPC_DEFAULT"/><entity-find-one entity-name="mantle.product.store.ProductStore" value-field="productStore"/><set field="currencyUomId" from="productStore?.defaultCurrencyUomId"/><set field="priceUomId" from="productStore?.defaultCurrencyUomId"/><set field="defaultLocale" from="productStore?.defaultLocale"/><set field="organizationPartyId" from="productStore?.organizationPartyId"/><set field="vendorPartyId" from="productStore?.organizationPartyId"/><set field="wikiSpaceId" from="productStore?.wikiSpaceId"/><set field="cartOrderId" from="ec.web.sessionAttributes.cartOrderId" set-if-empty="false"/><set field="customerPartyId" from="ec.user.userAccount?.partyId"/><set field="defaultOrderParameters" from="[orderId:cartOrderId, customerPartyId:customerPartyId, currencyUomId:currencyUomId,                 productStoreId:productStoreId, salesChannelEnumId:'ScWeb']"/></always-actions><transition name="search"><default-response url="/popc/Product/Search"/></transition><subscreens default-item="Home"/><pre-actions><script><![CDATA[// jQuery
        html_scripts.add('/libs/jquery/jquery.min.js')
        // Font Awesome
        html_stylesheets.add('/libs/font-awesome/css/font-awesome.min.css')
        // Bootstrap
        html_scripts.add('/libs/twitter-bootstrap/js/bootstrap.min.js')
        html_stylesheets.add('/libs/twitter-bootstrap/css/bootstrap.min.css')
        // Twitter TypeAhead
        html_scripts.add('/libs/typeahead.js/typeahead.jquery.min.js')

        // Form Validation and AJAX (jquery-validation, jquery-form)
        html_scripts.add('/libs/jquery-validate/jquery.validate.min.js')
        html_scripts.add('/libs/jquery-validate/additional-methods.min.js')
        html_scripts.add('/libs/jquery.form/jquery.form.min.js')
        // Date/Time (Moment, bootstrap-datetimepicker)
        html_scripts.add('/libs/moment.js/moment-with-locales.min.js')
        html_scripts.add('/js/bootstrap-datetimepicker.min.js')
        html_stylesheets.add('/libs/bootstrap-datetimepicker/css/bootstrap-datetimepicker.min.css')
        // Drop-down (Select2)
        html_scripts.add('/js/select2.min.js')
        html_stylesheets.add('/libs/select2/select2.min.css')
        html_stylesheets.add('/libs/select2-bootstrap-theme/select2-bootstrap.min.css')
        // Tree (JSTree)
        html_scripts.add('/libs/jstree/jstree.min.js')
        html_stylesheets.add('/libs/jstree/themes/default/style.min.css')
        // Inline Editable
        html_scripts.add('/libs/jeditable.js/jeditable.min.js')

        // Moqui webroot layout
        html_stylesheets.add('/css/webroot-layout.css')]]></script></pre-actions><actions><if condition="productStore == null"><return error="true" message="No ProductStore found so application is disabled, tried ID ${productStoreId}"/></if><if condition="cartOrderId"><service-call name="mantle.order.OrderInfoServices.get#OrderItemsTotalCount" in-map="[orderId:cartOrderId]" out-map="context"/></if></actions><widgets><render-mode><text type="html" location="component://webroot/screen/includes/Header.html.ftl"/></render-mode><container id="top"><render-mode><text type="html"><![CDATA[<nav class="navbar navbar-inverse"><#-- navbar-fixed-top, navbar-static-top --><div class="container-fluid"><!-- Brand and toggle get grouped for better mobile display --><header class="navbar-header"><button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><#assign headerLogoList = sri.getThemeValues("STRT_HEADER_LOGO")><#if headerLogoList?has_content><a href="/popc/" class="navbar-brand"><img src="${headerLogoList?first}" alt="Home" height="50"></a></#if><#assign headerTitleList = sri.getThemeValues("STRT_HEADER_TITLE")><#if headerTitleList?has_content><a href="/popc" class="navbar-title">${headerTitleList?first}</a></#if></header><div class="collapse navbar-collapse navbar-ex1-collapse">]]></text></render-mode><section name="CheckoutLink"><condition><expression><![CDATA[itemCount]]></expression></condition><widgets><link text="Checkout" url="/popc/Order/Checkout" link-type="anchor-button" icon="glyphicon glyphicon-circle-arrow-right" style="btn-success navbar-btn navbar-right"/></widgets></section><link text="Cart${itemCount ? ' (' + ec.l10n.format(itemCount, null) + (itemCount > 1 ? ' items)' : ' item)') : ''}" url="/popc/Order/Cart" link-type="anchor-button" icon="glyphicon glyphicon-shopping-cart" style="btn-success navbar-btn navbar-right"/><link text="Orders" url="/popc/Customer/OrderHistory" link-type="anchor-button" icon="glyphicon glyphicon-folder-open" style="navbar-btn navbar-right"/><link text="Profile" url="/popc/Customer/Profile" link-type="anchor-button" icon="glyphicon glyphicon-user" style="navbar-btn navbar-right"/><section name="HeaderUser"><condition><expression><![CDATA[ec.user.userId]]></expression></condition><widgets><render-mode><text type="html"><![CDATA[<a href="${sri.buildUrl("/popc/Login/logout").url}" data-toggle="tooltip" data-original-title="Logout ${(ec.getUser().getUserAccount().userFullName)!!}" data-placement="bottom" class="btn btn-danger btn-sm navbar-btn navbar-right"><i class="glyphicon glyphicon-off"></i></a>]]></text></render-mode><label text="Welcome ${ec.user.userAccount?.userFullName}!" style="navbar-text navbar-right"/></widgets></section><render-mode><text type="html"><![CDATA[</div></div><!-- container-fluid --></nav><!-- /.navbar -->]]></text></render-mode></container><container id="content"><render-mode><text type="html"><![CDATA[<header class="head bg-dark"><div class="search-bar"><form class="main-search" action="${sri.buildUrl('search').url}"><div class="input-group"><input type="text" name="keywords" class="form-control" placeholder="Search products..."><span class="input-group-btn"><button class="btn btn-primary text-muted" type="submit"><i class="fa fa-search"></i></button></span></div></form></div><div class="main-bar"><h3>${html_title!((sri.screenUrlInfo.targetScreen.getDefaultMenuName())!"Page")}</h3></div></header>]]></text></render-mode><container style="inner"><container style="container-fluid"><section-iterate name="headerMessageInfos" list="ec.message.publicMessageInfos" entry="messageInfo"><widgets><render-mode><text type="html"><![CDATA[<div class="alert alert-${messageInfo.typeString} fade in" role="alert"><button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>]]></text></render-mode><label text="${messageInfo.message}" type="h4"/><render-mode><text type="html"><![CDATA[</div>]]></text></render-mode></widgets></section-iterate><section-iterate name="headerSavedMessages" list="ec.web?.savedPublicMessages" entry="messageInfo"><widgets><render-mode><text type="html"><![CDATA[<div class="alert alert-${messageInfo.typeString} fade in" role="alert"><button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>]]></text></render-mode><label text="${messageInfo.message}" type="h4"/><render-mode><text type="html"><![CDATA[</div>]]></text></render-mode></widgets></section-iterate><section-iterate name="headerErrors" list="ec.message.errors" entry="errorMessage"><widgets><container style="message error"><label text="${errorMessage}"/></container></widgets></section-iterate><section-iterate name="headerValidationErrors" list="ec.message.validationErrors" entry="validationError"><widgets><container style="message error"><label text="${validationError.message} (for field ${validationError.field})"/></container></widgets></section-iterate><section-iterate name="headerSavedErrors" list="ec.web?.savedErrors" entry="errorMessage"><widgets><container style="message error"><label text="${errorMessage}"/></container></widgets></section-iterate><section-iterate name="headerSavedValidationErrors" list="ec.web?.savedValidationErrors" entry="validationError"><widgets><container style="message error"><label text="${validationError.message} (for field ${validationError.field})"/></container></widgets></section-iterate><subscreens-active/></container></container></container><container id="footer" style="bg-dark"><render-mode><text type="html" template="true"><![CDATA[<#assign footerItemList = sri.getThemeValues("STRT_FOOTER_ITEM")><div id="apps-footer-content"><#list footerItemList! as footerItem><#assign footerItemTemplate = footerItem?interpret><@footerItemTemplate/></#list></div><!-- productStoreId=${productStoreId}, currencyUomId=${currencyUomId}, priceUomId=${priceUomId}, defaultLocale=${defaultLocale} --><!-- organizationPartyId=${organizationPartyId!!}, vendorPartyId=${vendorPartyId!!}, cartOrderId=${cartOrderId!!}, customerPartyId=${customerPartyId!!} -->]]></text></render-mode></container><render-mode><text type="html" location="component://webroot/screen/includes/Footer.html.ftl"/></render-mode></widgets></screen>
<!-- Screen Location component://webroot/screen/webroot/rest.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="false" track-artifact-hit="false" default-menu-include="false"><transition name="login" method="post" require-session-token="false"><parameter name="username" required="true"/><parameter name="password" required="true"/><parameter name="code"/><actions><set field="loggedIn" from="ec.user.loginUser(username, password)"/><if condition="ec.message.hasError()"><script><![CDATA[ec.web.sendJsonResponse([loggedIn:false])]]></script></if><if condition="ec.web.sessionAttributes.moquiAuthcFactorRequired"><then><if condition="code"><then><service-call name="org.moqui.impl.UserServices.validate#ExternalUserAuthcCode" in-map="[code:code]" out-map="validateOut"/><if condition="validateOut.verified"><then><script><![CDATA[ec.user.internalLoginUser(validateOut.username)]]></script><return/></then><else><message type="danger" public="true"><![CDATA[Authentication code is not valid]]></message></else></if></then></if><service-call name="org.moqui.impl.UserServices.get#ExternalUserAuthcFactorInfo" out-map="factorInfoOut"/><script><![CDATA[ec.web.sendJsonResponse(factorInfoOut)]]></script></then><else><script><![CDATA[ec.web.sendJsonResponse([loggedIn:loggedIn])]]></script></else></if></actions><default-response type="none"/></transition><transition name="sendOtp" method="post"><parameter name="factorId" required="true"/><service-call name="org.moqui.impl.UserServices.send#ExternalAuthcCode" in-map="[factorId:factorId]" web-send-json-response="true" out-map="context" multi="parameter"/><default-response type="none"/></transition><transition name="verifyOtp" method="post"><parameter name="code" required="true"/><actions><service-call name="org.moqui.impl.UserServices.validate#ExternalUserAuthcCode" in-map="[code:code]" out-map="validateOut"/><if condition="validateOut.verified"><then><set field="loggedIn" from="ec.user.internalLoginUser(validateOut.username)"/><script><![CDATA[ec.web.sendJsonResponse([loggedIn:loggedIn])]]></script></then><else><script><![CDATA[ec.web.sendError(403, ec.l10n.localize("Authentication code is not valid"))]]></script></else></if></actions><default-response type="none"/></transition><transition name="logout" begin-transaction="false"><actions><script><![CDATA[if (ec.user.username) { ec.user.logoutUser(); ec.web.sendTextResponse("successful") }
            else { ec.web.sendTextResponse("no_user") }]]></script></actions><default-response type="none"/></transition><transition name="e1" read-only="true"><actions><script><![CDATA[ec.web.handleEntityRestCall(sri.screenUrlInfo.extraPathNameList, false)]]></script></actions><default-response type="none"/></transition><transition name="m1" read-only="true"><actions><script><![CDATA[ec.web.handleEntityRestCall(sri.screenUrlInfo.extraPathNameList, true)]]></script></actions><default-response type="none"/></transition><transition name="v1" read-only="true"><actions><script><![CDATA[ec.web.handleEntityRestCall(sri.screenUrlInfo.extraPathNameList, false)]]></script></actions><default-response type="none"/></transition><transition name="entity.json" read-only="true" method="get"><actions><script><![CDATA[org.moqui.impl.util.RestSchemaUtil.handleEntityRestSchema(ec, sri.screenUrlInfo.extraPathNameList,
                sri.buildUrl("entity.json").getUrl(), sri.buildUrl("e1").getUrl(), sri.buildUrl("entity.json").getUrl(), false)]]></script></actions><default-response type="none"/></transition><transition name="entity.raml" read-only="true" method="get"><actions><script><![CDATA[org.moqui.impl.util.RestSchemaUtil.handleEntityRestRaml(ec, sri.screenUrlInfo.extraPathNameList,
                sri.buildUrl("e1").getUrl(), sri.buildUrl("entity.json").getUrl(), false)]]></script></actions><default-response type="none"/></transition><transition name="entity.swagger" read-only="true" method="get"><actions><script><![CDATA[org.moqui.impl.util.RestSchemaUtil.handleEntityRestSwagger(ec, sri.screenUrlInfo.extraPathNameList, "/rest/e1", false)]]></script></actions><default-response type="none"/></transition><transition name="master.json" read-only="true" method="get"><actions><script><![CDATA[org.moqui.impl.util.RestSchemaUtil.handleEntityRestSchema(ec, sri.screenUrlInfo.extraPathNameList,
                sri.buildUrl("master.json").getUrl(), sri.buildUrl("m1").getUrl(), sri.buildUrl("master.json").getUrl(), true)]]></script></actions><default-response type="none"/></transition><transition name="master.raml" read-only="true" method="get"><actions><script><![CDATA[org.moqui.impl.util.RestSchemaUtil.handleEntityRestRaml(ec, sri.screenUrlInfo.extraPathNameList,
                sri.buildUrl("m1").getUrl(), sri.buildUrl("master.raml").getUrl(), true)]]></script></actions><default-response type="none"/></transition><transition name="master.swagger" read-only="true" method="get"><actions><script><![CDATA[org.moqui.impl.util.RestSchemaUtil.handleEntityRestSwagger(ec, sri.screenUrlInfo.extraPathNameList, "/rest/m1", true)]]></script></actions><default-response type="none"/></transition><transition name="s1" read-only="true"><actions><script><![CDATA[ec.web.handleServiceRestCall(sri.screenUrlInfo.extraPathNameList)]]></script></actions><default-response type="none"/></transition><transition name="service.swagger" read-only="true" method="get"><actions><script><![CDATA[org.moqui.impl.util.RestSchemaUtil.handleServiceRestSwagger(ec, sri.screenUrlInfo.extraPathNameList, "/rest/s1")]]></script></actions><default-response type="none"/></transition><transition name="service.raml" read-only="true" method="get"><actions><script><![CDATA[org.moqui.impl.util.RestSchemaUtil.handleServiceRestRaml(ec, sri.screenUrlInfo.extraPathNameList, sri.buildUrl("s1").getUrl())]]></script></actions><default-response type="none"/></transition><transition name="sm" read-only="true" require-session-token="false" begin-transaction="false"><actions><script><![CDATA[ec.web.handleSystemMessage(sri.screenUrlInfo.extraPathNameList)]]></script></actions><default-response type="none"/></transition><widgets/></screen>
<!-- Screen Location component://webroot/screen/webroot/rpc.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="false" track-artifact-hit="false" default-menu-include="false"><transition name="json"><actions><script><![CDATA[ec.web.handleJsonRpcServiceCall()]]></script></actions><default-response type="none"/></transition><widgets/></screen>
<!-- Screen Location component://webroot/screen/webroot/SecondFactor.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-include="false" require-authentication="anonymous-all" history="false"><transition name="sendOtp"><service-call name="org.moqui.impl.UserServices.send#ExternalAuthcCode" in-map="[factorId:factorId]" out-map="context" multi="parameter"/><default-response url="."/></transition><transition name="verifyUserAuthcFactor"><actions><set field="username" from="ec.web.sessionAttributes.moquiPreAuthcUsername"/><service-call name="org.moqui.impl.UserServices.validate#ExternalUserAuthcCode" in-map="[code:code]" out-map="validateOut"/><if condition="validateOut.verified"><then><script><![CDATA[ec.user.internalLoginUser(validateOut.username)]]></script></then><else><message type="danger" public="true"><![CDATA[Authentication code not valid]]></message></else></if></actions><conditional-response url="/"><condition><expression><![CDATA[verified]]></expression></condition></conditional-response><default-response url="."/></transition><pre-actions><script><![CDATA[if (ec.user.userId || !ec.web.sessionAttributes.moquiAuthcFactorRequired) { sri.sendRedirectAndStopRender('/') }]]></script></pre-actions><actions><service-call name="org.moqui.impl.UserServices.get#ExternalUserAuthcFactorInfo" out-map="context"/></actions><widgets><container id="content" style="Login"><container style="inner"><container style="container-fluid"><section-iterate name="headerSavedMessages" list="ec.web?.savedMessages" entry="message"><widgets><render-mode><text type="html"><![CDATA[<div class="alert alert-success fade in" role="alert"><button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>]]></text></render-mode><label text="${message}" type="h4"/><render-mode><text type="html"><![CDATA[</div>]]></text></render-mode></widgets></section-iterate><section-iterate name="headerSavedErrors" list="ec.web?.savedErrors" entry="errorMessage"><widgets><render-mode><text type="html"><![CDATA[<div class="alert alert-danger fade in" role="alert"><button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>]]></text></render-mode><label text="${errorMessage}" type="h4"/><render-mode><text type="html"><![CDATA[</div>]]></text></render-mode></widgets></section-iterate><section-iterate name="headerSavedValidationErrors" list="ec.web?.savedValidationErrors" entry="validationError"><widgets><render-mode><text type="html"><![CDATA[<div class="alert alert-danger fade in" role="alert"><button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>]]></text></render-mode><label text="${validationError.message} (for field ${validationError.field})" type="h4"/><render-mode><text type="html"><![CDATA[</div>]]></text></render-mode></widgets></section-iterate><section name="UserHasAuthcFactors" condition="factorTypeEnumIds"><widgets><render-mode><text type="html" location="component://webroot/screen/webroot/SecondFactor.html.ftl"/></render-mode></widgets><fail-widgets><label type="h1" text="Your account requires a code to login and you do not have any setup. Contact an Administrator."/><link url="/Login" text="Back to Login"/></fail-widgets></section></container></container></container></widgets></screen>
<!-- Screen Location component://coarchy/screen/settings/settingsinternal/BuyPremium.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Buy Premium" default-menu-index="20" menu-image="fa fa-star" menu-image-type="icon"><transition name="buyOrganizationMonthCredits"><service-call name="coarchy.CoarchyServices.buy#OrganizationMonthCredits" in-map="[quantity:quantity]" out-map="context" multi="parameter"/><default-response url="../Checkout" parameter-map="[orderId:orderId]"/></transition><actions><entity-find-one entity-name="mantle.product.Product" value-field="product" auto-field-map="[productId:'c100000']"/><entity-find entity-name="mantle.product.ProductPrice" list="priceList"><econdition field-name="productId" value="c100000"/><econdition field-name="pricePurposeEnumId" value="PppPurchase"/><date-filter/><order-by field-name="minQuantity"/></entity-find><set field="featureList" from="[             [featureName:'Unlimited Users',free:'X',premium:'X'],             [featureName:'Copy Public Organization',free:'X',premium:'X'],             [featureName:'Vision Story',free:'X',premium:'X'],             [featureName:'Actors',free:'X',premium:'X'],             [featureName:'Unlimited Actors',free:'X',premium:'X'],             [featureName:'Actors Report',free:'X',premium:'X'],             [featureName:'Process Story',free:'X',premium:'X'],             [featureName:'Unlimited Process Stories',free:'X',premium:'X'],             [featureName:'Unlimited Activities per Process Story',free:'X',premium:'X'],             [featureName:'Process Story Report',free:'X',premium:'X'],             [featureName:'Copy Private Organization',free:'',premium:'X'],             [featureName:'Statements',free:'',premium:'X'],             [featureName:'Unlimited Statements',free:'',premium:'X'],             [featureName:'Statements Report',free:'',premium:'X'],             [featureName:'Actors Report with Process Activities',free:'',premium:'X'],             [featureName:'Process Story Report with Substories',free:'',premium:'X'],             [featureName:'Process Task Checklist',free:'',premium:'X'],             [featureName:'Unlimited Checklists per Process Story',free:'',premium:'X'],             [featureName:'Product',free:'',premium:'X'],             [featureName:'Unlimited Products',free:'',premium:'X'],         ]"/><if condition="!creditsNeeded && ec.web.sessionAttributes.checkoutOrganizationId"><script><![CDATA[ec.web.sessionAttributes.remove('checkoutOrganizationId')]]></script></if><if condition="!creditsNeeded && ec.web.sessionAttributes.beforeCheckoutUrl"><script><![CDATA[ec.web.sessionAttributes.remove('beforeCheckoutUrl')]]></script></if></actions><widgets><container-row><row-col md="2"/><row-col md="8"><label text="Upgrade to Premium Features" type="h4" style="q-pb-sm"/><form-single name="BuyOrganizationMonthCredits" transition="buyOrganizationMonthCredits"><field name="description"><default-field><render-mode><text><![CDATA[<div style="max-width:500px">]]></text></render-mode><label text="Organization-Month Credits" type="h5"/><label text="${product.description}"/><render-mode><text><![CDATA[</div>]]></text></render-mode></default-field></field><field name="quantity" from="creditsNeeded"><default-field title="Organization-Month Quantity"><text-line/></default-field></field><field name="submit"><default-field><submit text="Buy"/></default-field></field><field-layout><field-row-big><field-ref name="description"/><field-ref name="quantity"/><field-ref name="submit"/></field-row-big></field-layout></form-single><label text="Price Matrix" type="h5" style="q-pl-sm q-pb-sm"/><render-mode><text><![CDATA[<div style="max-width:600px">]]></text></render-mode><form-list name="QuantityBreakMatrix" list="priceList" list-entry="priceEntry"><row-actions><set field="nextPriceQuantity" from="priceEntry_has_next?priceList.get(priceEntry_index+1).minQuantity:null"/></row-actions><field name="minQuantity"><default-field title="Organization-Month Quantity"><label text="${minQuantity}${nextPriceQuantity?' - '+(String) (nextPriceQuantity.toInteger()-1):'+'}"/></default-field></field><field name="price"><default-field><label text="${ec.l10n.formatCurrency(price,priceUomId,2)}"/></default-field></field></form-list><render-mode><text><![CDATA[</div>]]></text></render-mode><label text="Feature Matrix" type="h5" style="q-pl-sm q-pb-sm"/><render-mode><text><![CDATA[<div style="max-width:600px">]]></text></render-mode><form-list name="FeatureMatrix" list="featureList" list-entry="featureEntry"><field name="featureName"><default-field><display/></default-field></field><field name="free"><default-field><display/></default-field></field><field name="premium"><default-field><display/></default-field></field></form-list><render-mode><text><![CDATA[</div>]]></text></render-mode></row-col><row-col md="2"/></container-row></widgets></screen>
<!-- Screen Location component://coarchy/screen/settings/settingsinternal/Checkout.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Checkout" default-menu-index="25" menu-image="fa fa-shopping-cart" menu-image-type="icon" default-menu-include="false"><parameter name="orderId" required="true"/><always-actions><entity-find entity-name="mantle.order.OrderHeaderAndPart" list="existingOrderList" limit="1"><econdition field-name="orderId"/><econdition field-name="statusId" value="OrderOpen"/><econdition field-name="customerPartyId" from="ec.user.userAccount.partyId"/><select-field field-name="orderId,orderPartSeqId,grandTotal,currencyUomId,productStoreId"/><order-by field-name="-entryDate"/></entity-find><if condition="existingOrderList.size() == 0"><message type="danger" public="true" error="true"><![CDATA[${ec.resource.expand('CoarchyInvalidOrder',null)}]]></message><script><![CDATA[sri.sendRedirectAndStopRender('/settings/BuyPremium')]]></script><return/></if><set field="headerAndPart" from="existingOrderList.getFirst()"/></always-actions><actions><set field="orderPartSeqId" from="existingOrderList[0].orderPartSeqId"/><entity-find entity-name="mantle.order.OrderItem" list="orderItemList" limit="1"><econdition field-name="orderId"/><econdition field-name="orderPartSeqId"/><econdition field-name="productId" value="c100000"/><econdition field-name="itemTypeEnumId" value="ItemProduct"/><econdition field-name="fromAssetId" operator="is-null"/><econdition field-name="selectedAmount" operator="is-null"/><select-field field-name="orderItemSeqId,unitAmount,itemDescription,quantity"/><order-by field-name="orderItemSeqId"/></entity-find><set field="orderItem" from="orderItemList.getFirst()"/><if condition="orderItemList.size() < 1"><log level="warn" message="No order items found for user."/><message type="danger" public="true" error="true"><![CDATA[${ec.resource.expand('CoarchyInvalidOrder',null)}]]></message><script><![CDATA[sri.sendRedirectAndStopRender('/settings/BuyPremium')]]></script></if><entity-find entity-name="mantle.product.store.ProductStorePaymentGateway" list="productStorePaymentGatewayList" limit="1"><econdition field-name="productStoreId" from="existingOrderList.getFirst().productStoreId"/><econdition field-name="paymentInstrumentEnumId" value="PiStripe"/><econdition field-name="paymentGatewayConfigId" operator="is-not-null"/><select-field field-name="paymentGatewayConfigId"/><order-by field-name="-lastUpdatedStamp"/></entity-find><entity-find-one entity-name="mantle.account.method.PaymentGatewayConfig" value-field="paymentGateway" auto-field-map="[paymentGatewayConfigId:productStorePaymentGatewayList.getFirst().paymentGatewayConfigId]"/><set field="stripeRemote" from="paymentGateway.remote"/><set field="public_key" from="stripeRemote.publicKey"/><set field="return_url" from="sri.buildUrl('/settings/ThankYou').url+'?orderId='+orderId"/></actions><widgets><container-row><row-col md="3"/><row-col md="6"><label text="Checkout" type="h4" style="q-pb-sm"/><label text="Buying ${ec.l10n.formatNumber((Number)orderItem.quantity,null,null)} ${orderItem.itemDescription} at ${ec.l10n.formatCurrency(orderItem.unitAmount,headerAndPart.currencyUomId,2)} each for a total of ${ec.l10n.formatCurrency(headerAndPart.grandTotal,headerAndPart.currencyUomId,2)}" type="h6" style="q-pb-sm"/><render-mode><text type="qvt"><![CDATA[<m-stripe return_url="${return_url}" public_key="${public_key}"></m-stripe>]]></text></render-mode></row-col><row-col md="3"/></container-row></widgets></screen>
<!-- Screen Location component://coarchy/screen/settings/settingsinternal/ThankYou.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Thank You!" default-menu-index="25" menu-image="fa fa-heart" menu-image-type="icon" default-menu-include="false"><parameter name="orderId" required="true"/><always-actions><entity-find entity-name="mantle.order.OrderHeaderAndPart" list="existingOrderList" limit="1"><econdition field-name="orderId"/><econdition field-name="customerPartyId" from="ec.user.userAccount.partyId"/><select-field field-name="orderId,orderPartSeqId,grandTotal,currencyUomId,productStoreId"/><order-by field-name="-entryDate"/></entity-find><if condition="existingOrderList.size() == 0"><message type="danger" public="true" error="true"><![CDATA[${ec.resource.expand('CoarchyInvalidOrder', null)}]]></message><script><![CDATA[sri.sendRedirectAndStopRender('/settings/BuyPremium')]]></script><return/></if><set field="headerAndPart" from="existingOrderList.getFirst()"/></always-actions><actions><set field="return_url" from="ec.web.sessionAttributes.beforeCheckoutUrl?:null"/><script><![CDATA[ec.web.sessionAttributes.remove('beforeCheckoutUrl')]]></script><set field="progress_url" from="sri.buildUrl('/settings/orderStatus').url"/><entity-find-one entity-name="mantle.party.Organization" value-field="organization" auto-field-map="[partyId:ec.user.getPreference('ACTIVE_ORGANIZATION')]"/><set field="organizationName" from="organization?.organizationName"/></actions><widgets><container-row><row-col md="3"/><row-col md="6"><label text="Thank You for your Order!" type="h4" style="q-pb-md"/><render-mode><text type="qvt"><![CDATA[<m-order-progress progress_url="${progress_url!}" order_id="${orderId!}"
                            return_url="${return_url!}" organization_name="${organizationName!}"></m-order-progress>]]></text></render-mode></row-col><row-col md="3"/></container-row></widgets></screen>
<!-- Screen Location component://coarchy/screen/settings/settingsinternal/Organizations.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Organizations" default-menu-index="40" menu-image="fa fa-building" menu-image-type="icon"><always-actions><entity-find entity-name="mantle.party.PartyToAndRelationship" list="organizationList" distinct="true"><date-filter/><econdition field-name="relationshipTypeEnumId" value="PrtMember"/><econditions combine="or"><econdition field-name="fromPartyId" from="ec.user.userAccount.partyId"/><econdition field-name="visibilityEnumId" value="PvPublic"/></econditions><select-field field-name="toPartyId,ownerPartyId,organizationName,visibilityEnumId"/><order-by field-name="-visibilityEnumId"/></entity-find><entity-find entity-name="mantle.party.PartyToAndRelationship" list="vendorOrganizationList" distinct="true"><date-filter/><econdition field-name="relationshipTypeEnumId" value="PrtVendorRepresentative"/><econdition field-name="toRoleTypeId" value="VendorRepresentative"/><econdition field-name="fromPartyId" from="ec.user.userAccount.partyId"/><select-field field-name="toPartyId,ownerPartyId,organizationName,visibilityEnumId"/><order-by field-name="-visibilityEnumId"/></entity-find><set field="ownerOfAnyOrganization" from="organizationList*.ownerPartyId.contains(ec.user.userAccount.partyId)"/></always-actions><transition name="createOrganization"><actions><service-call name="coarchy.CoarchyServices.create#Organization" in-map="context" out-map="createOrgOut"/></actions><conditional-response url="../EditOrganization" parameter-map="[organizationId:createOrgOut.newOrganizationId]"><condition><expression><![CDATA[!ownerOfAnyOrganization]]></expression></condition></conditional-response><default-response url="."/></transition><transition name="inviteUser"><service-call name="coarchy.CoarchyServices.invite#User" in-map="[partyId:organizationId,emailAddress:emailAddress]" out-map="context" multi="parameter"/><default-response url="../EditOrganization" parameter-map="[organizationId:partyId]"/></transition><transition name="activateOrDeactivateOrganization"><service-call name="coarchy.CoarchyServices.activateOrDeactivate#Organization" in-map="[organizationPartyId:toPartyId]" out-map="context" multi="parameter"/><actions><if condition="needsCredits"><set field="ec.web.sessionAttributes.checkoutOrganizationId" from="toPartyId"/><script><![CDATA[ec.user.setPreference('ACTIVE_ORGANIZATION', toPartyId)]]></script></if></actions><conditional-response url="../BuyPremium" parameter-map="[creditsNeeded:creditsNeeded]"><condition><expression><![CDATA[needsCredits]]></expression></condition></conditional-response><default-response/></transition><transition name="getCloneOrganizationList"><actions><entity-find entity-name="mantle.party.PartyDetail" list="organizationList" distinct="true"><econdition field-name="partyTypeEnumId" value="PtyOrganization"/><econditions combine="or"><econdition field-name="ownerPartyId" from="ec.user.userAccount.partyId"/><econdition field-name="visibilityEnumId" value="PvPublic"/><econdition field-name="partyId" operator="in" from="organizationList*.toPartyId"/></econditions><select-field field-name="partyId,organizationName,visibilityEnumId"/><order-by field-name="-visibilityEnumId,organizationName"/></entity-find><set field="cloneOrganizationList" from="[]"/><iterate list="organizationList" entry="organization"><if condition="organization.visibilityEnumId == 'PvPublic'"><script><![CDATA[cloneOrganizationList.add([value:organization.partyId, label:"${organization.visibilityEnumId=='PvPublic'?organization.organizationName+' - Template':organization.organizationName}"])]]></script><continue/></if><entity-find-count entity-name="mantle.party.PartyActivation" count-field="partyActivationCount"><econdition field-name="partyId" from="organization.partyId"/><date-filter/></entity-find-count><if condition="partyActivationCount > 0"><script><![CDATA[cloneOrganizationList.add([value:organization.partyId, label:"${organization.visibilityEnumId=='PvPublic'?organization.organizationName+' - Template':organization.organizationName}"])]]></script></if></iterate><script><![CDATA[ec.web.sendJsonResponse(cloneOrganizationList)]]></script></actions><default-response type="none"/></transition><transition name="goToApplication"><actions><entity-find-one entity-name="moqui.security.UserPreference" value-field="userPreference" auto-field-map="[userId:ec.user.userId,preferenceKey:'ACTIVE_ORGANIZATION']"/><if condition="partyId && userPreference?.preferenceValue != partyId"><entity-find-count entity-name="mantle.party.PartyToAndRelationship" count-field="partyRelationshipCount"><date-filter/><econdition field-name="relationshipTypeEnumId" value="PrtMember"/><econdition field-name="toRoleTypeId" value="OrgInternal"/><econditions combine="or"><econdition field-name="fromPartyId" from="ec.user.userAccount.partyId"/><econdition field-name="visibilityEnumId" value="PvPublic"/></econditions><econdition field-name="toPartyId" from="partyId"/></entity-find-count><if condition="partyRelationshipCount > 0"><service-call name="org.moqui.impl.UserServices.set#Preference" in-map="[preferenceKey:'ACTIVE_ORGANIZATION',preferenceValue:partyId]"/></if></if></actions><default-response url="/coapp/Home" url-type="plain"/></transition><transition name="goToProductEvaluation"><actions><entity-find-one entity-name="moqui.security.UserPreference" value-field="userPreference" auto-field-map="[userId:ec.user.userId,preferenceKey:'ACTIVE_ORGANIZATION']"/><if condition="organizationId && userPreference?.preferenceValue != organizationId"><entity-find-count entity-name="mantle.party.PartyRelationship" count-field="partyRelationshipCount"><date-filter/><econdition field-name="relationshipTypeEnumId" value="PrtVendorRepresentative"/><econdition field-name="toRoleTypeId" value="VendorRepresentative"/><econdition field-name="fromPartyId" from="ec.user.userAccount.partyId"/><econdition field-name="toPartyId" from="organizationId"/></entity-find-count><if condition="partyRelationshipCount > 0"><service-call name="org.moqui.impl.UserServices.set#Preference" in-map="[preferenceKey:'ACTIVE_ORGANIZATION',preferenceValue:organizationId]"/></if></if></actions><default-response url="/vendor/ProductEval/EditProductEval" parameter-map="[productEvaluationId:productEvaluationId]" url-type="plain"/></transition><transition name="goToVendorHome"><actions><entity-find-one entity-name="moqui.security.UserPreference" value-field="userPreference" auto-field-map="[userId:ec.user.userId,preferenceKey:'ACTIVE_ORGANIZATION']"/><if condition="organizationId && userPreference?.preferenceValue != organizationId"><entity-find-count entity-name="mantle.party.PartyRelationship" count-field="partyRelationshipCount"><date-filter/><econdition field-name="relationshipTypeEnumId" value="PrtVendorRepresentative"/><econdition field-name="toRoleTypeId" value="VendorRepresentative"/><econdition field-name="fromPartyId" from="ec.user.userAccount.partyId"/><econdition field-name="toPartyId" from="organizationId"/></entity-find-count><if condition="partyRelationshipCount > 0"><service-call name="org.moqui.impl.UserServices.set#Preference" in-map="[preferenceKey:'ACTIVE_ORGANIZATION',preferenceValue:organizationId]"/></if></if></actions><default-response url="/vendor" url-type="plain"/></transition><actions><entity-find entity-name="mantle.account.financial.FinancialAccountAndTrans" list="finAccountAndTrans" limit="1"><search-form-inputs/><econdition field-name="ownerPartyId" from="ec.user.userAccount.partyId"/><econdition field-name="finAccountTypeId" value="OrganizationMonthCredit"/><econdition field-name="organizationPartyId" value="coarchy"/><econdition field-name="statusId" value="FaActive"/><date-filter/><order-by field-name="-transactionDate"/></entity-find><if condition="ec.user.userAccount?.partyId"><service-call name="coarchy.CoarchyServices.check#PartyActivation" in-map="[userPartyId:ec.user.userAccount?.partyId, finAccountTypeId:'OrganizationMonthCredit']" out-map="partyActivationOut"/></if><set field="totalCreditsUsed" type="BigDecimal" from="partyActivationOut?.totalCreditsUsed?:0.0"/></actions><widgets><container-row><row-col md="2"/><row-col md="8"><label text="Organizations" type="h4"/><label condition="finAccountAndTrans.getFirst() != null&&finAccountAndTrans.getFirst().availableBalance>0" text="Used ${ec.l10n.formatNumber((Number)(totalCreditsUsed.setScale(2, BigDecimal.ROUND_HALF_UP)),null,null)} / ${ec.l10n.formatNumber((Number)finAccountAndTrans.getFirst().availableBalance,null,null)} Organization-Month Credits this month\n"/><container-dialog id="InviteUser" button-text="Invite User" condition="ownerOfAnyOrganization" type="success"><form-single name="InviteUser" transition="inviteUser"><field name="organizationId"><default-field title="Organization"><drop-down><entity-options text="${organizationName}" key="${partyId}"><entity-find entity-name="mantle.party.PartyDetail"><econdition field-name="partyTypeEnumId" value="PtyOrganization"/><econdition field-name="ownerPartyId" from="ec.user.userAccount.partyId"/></entity-find></entity-options></drop-down></default-field></field><field name="emailAddress"><default-field><text-line input-type="email"/></default-field></field><field name="submit"><default-field><submit/></default-field></field></form-single></container-dialog><container-dialog id="CreateOrganization" button-text="Create Organization" type="success"><form-single name="CreateOrganization" transition="createOrganization"><field name="organizationName"><default-field><text-line/></default-field></field><field name="create"><default-field><submit/></default-field></field></form-single></container-dialog><container-dialog id="CloneOrganization" button-text="Clone Organization" type="success" icon="fa fa-clone"><form-single name="CloneOrganization" transition="createOrganization"><field name="organizationId"><default-field title="Copy from Organization"><label text="Enable premium features to copy from your organizations"/><drop-down allow-empty="false" required-manual-select="true"><dynamic-options server-search="true" transition="getCloneOrganizationList" min-length="0"/></drop-down></default-field></field><field name="organizationName"><default-field><text-line/></default-field></field><field name="copyChecklists"><default-field title="Clone Checklists?"><radio no-current-selected-key="none"><option key="none" text="Do nothing"/><option key="copy" text="Copy checklists"/><option key="move" text="Move checklists"/></radio></default-field></field><field name="copyUsers"><default-field title="Clone Users?"><radio no-current-selected-key="none"><option key="none" text="Do nothing"/><option key="copy" text="Copy users"/><option key="move" text="Move users"/></radio></default-field></field><field name="copyProducts"><default-field title="Clone Products?"><radio no-current-selected-key="none"><option key="none" text="Do nothing"/><option key="copy" text="Copy products"/><option key="move" text="Move products"/></radio></default-field></field><field name="copyEvaluations"><default-field title="Clone Product Evaluations?"><radio no-current-selected-key="none"><option key="none" text="Do nothing"/><option key="copy" text="Copy evaluations"/><option key="move" text="Move evaluations"/></radio></default-field></field><field name="copyEvaluationResponses"><default-field title="Clone Evaluation Responses?"><radio no-current-selected-key="false"><option key="false" text="Do not copy responses"/><option key="true" text="Copy responses"/></radio></default-field></field><field name="copyEvaluationVendors"><default-field title="Clone Vendor Representatives?"><radio no-current-selected-key="false"><option key="false" text="Do not copy vendor reps"/><option key="true" text="Copy vendor reps"/></radio></default-field></field><field name="create"><default-field><submit/></default-field></field></form-single></container-dialog><form-list name="Organization" header-dialog="true" list="organizationFormList" list-entry="organizationFormEntry" transition="activateOrDeactivateOrganization"><entity-find entity-name="mantle.party.PartyToAndRelationship" list="organizationFormList" distinct="true"><search-form-inputs default-order-by="-visibilityEnumId"/><date-filter/><econditions combine="or"><econdition field-name="fromPartyId" from="ec.user.userAccount.partyId"/><econdition field-name="visibilityEnumId" value="PvPublic"/></econditions><select-field field-name="toPartyId,ownerPartyId,organizationName,visibilityEnumId"/></entity-find><row-actions><entity-find-count entity-name="mantle.party.PartyActivation" count-field="partyActivationCount"><econdition field-name="partyId" from="toPartyId"/><date-filter/></entity-find-count><entity-find entity-name="mantle.party.PartyToAndRelationship" list="partyRelList"><date-filter/><econdition field-name="toPartyId"/><econditions combine="or"><econdition field-name="fromPartyId" from="ec.user.userAccount.partyId"/><econdition field-name="visibilityEnumId" value="PvPublic"/></econditions><select-field field-name="fromPartyId,toPartyId,visibilityEnumId,relationshipTypeEnumId,ownerPartyId"/></entity-find><set field="orgRelTypeList" from="partyRelList*.relationshipTypeEnumId"/><set field="isMember" from="orgRelTypeList.contains('PrtMember')"/><set field="isRep" from="orgRelTypeList.contains('PrtVendorRepresentative')"/></row-actions><field name="toPartyId"><header-field><text-find size="25"/></header-field><default-field><hidden/></default-field></field><field name="application"><conditional-field title="View Organization" condition="visibilityEnumId=='PvPublic'&&                                 ownerPartyId != ec.user.userAccount.partyId"><link url="goToApplication" text="${organizationName}" parameter-map="[partyId:toPartyId]" tooltip="View ${organizationName} Home"/><render-mode><text type="qvt"><![CDATA[<q-chip color="red-11" text-color="black">Public</q-chip><q-chip>Read Only</q-chip>]]></text></render-mode></conditional-field><conditional-field title="View Organization" condition="visibilityEnumId=='PvPublic'&&                                 ownerPartyId == ec.user.userAccount.partyId"><link url="goToApplication" text="${organizationName}" parameter-map="[partyId:toPartyId]" tooltip="View ${organizationName} Home"/><render-mode><text type="qvt"><![CDATA[<q-chip color="red-11" text-color="black">Public</q-chip>]]></text></render-mode></conditional-field><default-field title="View Organization"><link url="goToApplication" text="${organizationName}" parameter-map="[partyId:toPartyId]" tooltip="View ${organizationName} Home" condition="isMember"/></default-field></field><field name="organizationName"><conditional-field title="Organization Settings" condition="                         !(isRep && !isMember) && visibilityEnumId!='PvPublic' || ownerPartyId == ec.user.userAccount.partyId"><link url="/settings/EditOrganization" text="${organizationName}" parameter-map="[                         organizationId:toPartyId]" tooltip="Edit ${organizationName}"/></conditional-field></field><field name="activation"><header-field title="Premium"><hidden/></header-field><conditional-field title="Premium" condition="ownerPartyId == ec.user.userAccount.partyId                                 && partyActivationCount == 0"><submit text="Upgrade" type="success" confirmation="Activating will cost 1 Organization-Month                              Credit per month while ${organizationName} is upgraded. Are you sure?"/></conditional-field><conditional-field title="Premium" condition="ownerPartyId == ec.user.userAccount.partyId                                 && partyActivationCount != 0"><submit text="Downgrade" type="danger"/></conditional-field></field><field name="submit"><header-field><submit/></header-field></field></form-list></row-col><row-col md="2"/></container-row><section name="VendorProductEvalSummary" condition="vendorOrganizationList.size()"><widgets><container-row><row-col md="2"/><row-col md="8"><label text="Outstanding Product Evaluations" type="h4"/><form-list name="ProductEvaluationSummaryList" header-dialog="true" list="evalPartyAndEvalList"><entity-find entity-name="coarchy.product.ProductEvaluationPartyAndEval" list="evalPartyAndEvalList" distinct="true"><date-filter/><econdition field-name="organizationId" operator="in" from="vendorOrganizationList*.toPartyId"/><econdition field-name="partyId" from="ec.user.userAccount.partyId"/><econdition field-name="roleTypeId" value="VendorRepresentative"/><econdition field-name="statusId" operator="not-in" value="PepPlanned,PepCancelled,PepRejected"/><econdition field-name="evaluationStatusId" value="PeAwaitingVendorResponse"/></entity-find><row-actions><entity-find-one entity-name="coarchy.product.ProductEvaluationAndProduct" value-field="productEvaluation"/></row-actions><field name="partyId"><default-field><hidden/></default-field></field><field name="productEvaluationId"><default-field title="Evaluation Request #"><display/></default-field></field><field name="productId" from="productEvaluation?.productId"><default-field title="Product"><display-entity entity-name="mantle.product.Product" text="${productName}"/></default-field></field><field name="organizationPartyId" from="productEvaluation?.organizationId"><default-field title="Organization"><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameOnlyTemplate"/></default-field></field><field name="evaluationStatusId"><conditional-field condition="evaluationStatusId=='PeAwaitingVendorResponse'"><display text="Awaiting Response"/></conditional-field><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="actions"><default-field title=""><link url="goToProductEvaluation" text="Complete Evaluation" condition="evaluationStatusId=='PeAwaitingVendorResponse'" parameter-map="[productEvaluationId:productEvaluationId, organizationId:organizationPartyId]"/></default-field></field></form-list></row-col><row-col md="2"/></container-row></widgets></section></widgets></screen>
<!-- Screen Location component://coarchy/screen/settings/settingsinternal/EditOrganization.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Edit Organization" default-menu-index="41" menu-image="fa fa-users" menu-image-type="icon" default-menu-include="false"><parameter name="organizationId" required="true"/><always-actions><entity-find-count entity-name="mantle.party.PartyRelationship" count-field="partyRelationshipCount"><date-filter/><econdition field-name="relationshipTypeEnumId" value="PrtMember"/><econdition field-name="toRoleTypeId" value="OrgInternal"/><econdition field-name="fromPartyId" from="ec.user.userAccount.partyId"/><econdition field-name="toPartyId" from="organizationId"/></entity-find-count><if condition="partyRelationshipCount == null || partyRelationshipCount == 0"><message type="warning"><![CDATA[${ec.resource.expand('CoarchyOrgUnauthorizedUser',null)}]]></message><script><![CDATA[sri.sendRedirectAndStopRender('/settings/Organizations')]]></script></if><entity-find-one entity-name="mantle.party.PartyDetail" value-field="organization" auto-field-map="[partyId:organizationId]"/><entity-find-count entity-name="mantle.party.PartyActivation" count-field="partyActivationCount"><date-filter/><econdition field-name="partyId" from="organizationId"/></entity-find-count></always-actions><transition name="upgradeParty"><condition><expression><![CDATA[partyRelationshipCount > 0]]></expression></condition><service-call name="coarchy.CoarchyServices.activateOrDeactivate#Organization" in-map="[organizationPartyId:organizationId]" out-map="context" multi="parameter"/><actions><if condition="needsCredits"><set field="ec.web.sessionAttributes.beforeCheckoutUrl" from="ec.web.screenHistory.getAt(0)?.pathWithParams?.replace('cointernal','coapp')?:null"/><set field="ec.web.sessionAttributes.checkoutOrganizationId" from="organizationId"/></if></actions><conditional-response url="/settings/BuyPremium" url-type="plain" parameter-map="[creditsNeeded:creditsNeeded]"><condition><expression><![CDATA[needsCredits]]></expression></condition></conditional-response><default-response/></transition><transition name="updateUser"><condition><expression><![CDATA[organization.ownerPartyId==ec.user.userAccount.partyId]]></expression></condition><service-call name="coarchy.CoarchyServices.update#User" in-map="[partyId:partyId,actorIdList:actorIdList,organizationId:organizationId]" out-map="context" multi="parameter"/><default-response/></transition><transition name="removeUser"><actions><entity-find-one entity-name="mantle.party.Party" value-field="organization" auto-field-map="[partyId:organizationId]"/><if condition="fromPartyId == ec.user.userAccount.partyId || organization.ownerPartyId != ec.user.userAccount.partyId"><return message="${ec.resource.expand('CoarchyUserNotRemovable',null)}" type="warning"/></if><entity-find entity-name="mantle.party.PartyRelationship" list="partyRelationshipList"><date-filter/><econdition field-name="toPartyId"/><econdition field-name="fromPartyId"/><econdition field-name="toRoleTypeId" value="OrgInternal"/><select-field field-name="partyRelationshipId"/></entity-find><iterate list="partyRelationshipList" entry="partyRelationship"><service-call name="update#mantle.party.PartyRelationship" in-map="[partyRelationshipId:partyRelationship.partyRelationshipId, thruDate:ec.user.nowTimestamp]"/></iterate></actions><default-response/></transition><transition name="updateOrganization"><actions><entity-find-one entity-name="mantle.party.Party" value-field="organization" auto-field-map="[partyId:organizationId]"/><if condition="!(organizationName?.trim())"><return error="true" message="${ec.resource.expand('CoarchyOrgNameInvalid',null)}"/></if><if condition="!organization || organization.ownerPartyId != ec.user.userAccount.partyId"><return error="true" message="${ec.resource.expand('CoarchyOrgNotEditable',null)}"/></if><if condition="organization.ownerPartyId == ec.user.userAccount.partyId"><service-call name="update#mantle.party.Organization" in-map="[partyId:organizationId,organizationName:organizationName]"/></if></actions><default-response url="." parameter-map="[organizationId:organizationId]"/></transition><transition name="getActorList"><actions><set field="actorList" from="[]"/><if condition="term == null && actorIdList ? actorIdList?.size() > 0 : false"><then><entity-find entity-name="coarchy.Actor" list="actorList" limit="50"><econdition field-name="actorId" operator="in" from="actorIdList"/><econdition field-name="organizationId"/><order-by field-name="actorId"/></entity-find></then><else><entity-find entity-name="coarchy.Actor" list="actorList" limit="50"><econdition field-name="name" operator="like" value="%${term}%" ignore-case="true"/><econdition field-name="organizationId"/><order-by field-name="actorId"/></entity-find></else></if><script><![CDATA[def outList = []
            for (def actor in actorList)
                outList.add([value:actor?.actorId, label:"${actor?.name}".toString()])
            ec.web.sendJsonResponse(outList)]]></script></actions><default-response type="none"/></transition><transition name="inviteUser"><service-call name="coarchy.CoarchyServices.invite#User" in-map="[partyId:organizationId,emailAddress:emailAddress]" out-map="context" multi="parameter"/><default-response url="." parameter-map="[organizationId:organizationId]"/></transition><transition-include name="goToApplication" location="component://coarchy/screen/settings/settingsinternal/Organizations.xml"/><transition-include name="createOrganization" location="component://coarchy/screen/settings/settingsinternal/Organizations.xml"/><widgets><section name="FreemiumBanner" condition="partyActivationCount == 0"><widgets><container type="q-banner inline-actions rounded dense" style="bg-grey-3 text-black q-mb-md"><label text="To enable all the features upgrade organization '${organization.organizationName}' to Premium" type="b"/><container type="template v-slot:action"><form-single name="UpgradeForm" transition="upgradeParty"><field name="organizationId" from="organizationId"><default-field><hidden/></default-field></field><field name="upgrade"><default-field><submit text="Upgrade" type="success" confirmation="Activating will cost 1 Organization-Month Credit per month while ${organization.organizationName} is upgraded. Are you sure?"/></default-field></field></form-single></container></container></widgets></section><container-row><row-col md="2"/><row-col md="8"><label text="${organization?.organizationName?:' Organization'} Settings" type="h4"/><link url="goToApplication" text="View ${organization.organizationName}" parameter-map="[partyId:organizationId]" tooltip="View ${organization.organizationName} Home"/><link url="../Organizations" text="Find Organizations"/><container-dialog id="InviteUser" type="success" button-text="Invite User"><form-single name="InviteUser" transition="inviteUser"><field name="organizationId"><default-field><hidden/></default-field></field><field name="emailAddress"><default-field><text-line input-type="email"/></default-field></field><field name="submit"><default-field><submit/></default-field></field></form-single></container-dialog><container-dialog id="CloneFrom" button-text="Copy"><label text="This will create a New Organization from a copy of ${organization.organizationName}" type="h6"/><form-single name="CloneFromOrganization" transition="createOrganization"><field name="organizationId"><default-field><hidden/></default-field></field><field name="organizationName" from="null"><default-field title="New Organization Name"><text-line/></default-field></field><field name="copyChecklists"><default-field title="Clone Checklists?"><radio no-current-selected-key="none"><option key="none" text="Do nothing"/><option key="copy" text="Copy checklists"/><option key="move" text="Move checklists"/></radio></default-field></field><field name="copyUsers"><default-field title="Clone Users?"><radio no-current-selected-key="none"><option key="none" text="Do nothing"/><option key="copy" text="Copy users"/><option key="move" text="Move users"/></radio></default-field></field><field name="copyProducts"><default-field title="Clone Products?"><radio no-current-selected-key="none"><option key="none" text="Do nothing"/><option key="copy" text="Copy products"/><option key="move" text="Move products"/></radio></default-field></field><field name="copyEvaluations"><default-field title="Clone Product Evaluations?"><radio no-current-selected-key="none"><option key="none" text="Do nothing"/><option key="copy" text="Copy evaluations"/><option key="move" text="Move evaluations"/></radio></default-field></field><field name="copyEvaluationResponses"><default-field title="Clone Evaluation Responses?"><radio no-current-selected-key="false"><option key="false" text="Do not copy responses"/><option key="true" text="Copy responses"/></radio></default-field></field><field name="copyEvaluationVendors"><default-field title="Clone Vendor Representatives?"><radio no-current-selected-key="false"><option key="false" text="Do not copy vendor reps"/><option key="true" text="Copy vendor reps"/></radio></default-field></field><field name="clone"><default-field><submit/></default-field></field></form-single></container-dialog><container-dialog id="UpdateOrganizationDialog" button-text="Edit Organization Name" condition="organization.ownerPartyId==ec.user.userAccount.partyId"><form-single name="UpdateOrganization" transition="updateOrganization"><field name="organizationId" from="organizationId"><default-field><hidden/></default-field></field><field name="organizationName" from="organization.organizationName"><default-field title="Organization Name"><text-line size="50"/></default-field></field><field name="submit"><default-field><submit text="Update"/></default-field></field></form-single></container-dialog><label text="Users" type="h5" style="q-pt-sm"/><form-list name="Users" list="usersList" header-dialog="true" show-csv-button="false" transition="updateUser"><entity-find entity-name="mantle.party.PartyFromAndRelationship" list="usersList" distinct="true"><search-form-inputs default-order-by="-lastUpdatedStamp"/><date-filter/><econdition field-name="toPartyId" from="organizationId"/><select-field field-name="fromPartyId,firstName,lastName"/></entity-find><row-actions><if condition="fromPartyId == ec.user.userAccount.partyId || (fromPartyId != ec.user.userAccount.partyId && organization.ownerPartyId == ec.user.userAccount.partyId)"><entity-find entity-name="moqui.security.UserAccount" list="userAccountList" limit="1"><econdition field-name="partyId" from="fromPartyId"/><select-field field-name="emailAddress"/><order-by field-name="-lastUpdatedStamp"/></entity-find><set field="userAccount" from="userAccountList?.getFirst()"/></if><entity-find entity-name="coarchy.ActorPartyDetail" list="actorPartyList"><econdition field-name="partyId" from="fromPartyId"/><econdition field-name="activityActorOrganizationId" from="organizationId"/><econdition field-name="actorOrganizationId" from="organizationId"/><order-by field-name="actorId"/></entity-find><set field="actorIdList" from="actorPartyList*.actorId"/></row-actions><hidden-parameters><parameter name="organizationId"/></hidden-parameters><field name="firstName"><header-field show-order-by="case-insensitive"><text-find size="25"/></header-field></field><field name="lastName"><header-field show-order-by="case-insensitive"><text-find size="25"/></header-field></field><field name="partyId" from="fromPartyId"><default-field><hidden/></default-field></field><field name="name"><default-field><label text="${firstName} ${lastName}"/></default-field></field><field name="emailAddress" from="userAccount?.emailAddress ?: 'Not Authorized'"><default-field><display/></default-field></field><field name="actorIdList"><conditional-field condition="(partyActivationCount == 0 && organization.ownerPartyId==ec.user.userAccount.partyId)||organization.ownerPartyId!=ec.user.userAccount.partyId" title="${(partyActivationCount == 0 && organization.ownerPartyId==ec.user.userAccount.partyId)||organization.ownerPartyId!=ec.user.userAccount.partyId?'Assigned Actor Roles':''}"><render-mode><text type="html,vuet,qvt" location="component://coarchy/template/ActorLinkList.html.ftl"/></render-mode></conditional-field><conditional-field condition="organization.ownerPartyId==ec.user.userAccount.partyId" title="${organization.ownerPartyId==ec.user.userAccount.partyId?'Assigned Actor Roles':''}"><drop-down submit-on-select="true" allow-multiple="true" allow-empty="true"><list-options list="actorPartyList" key="${actorId}" text="${name}"/><dynamic-options server-search="true" transition="getActorList" min-length="0"/></drop-down></conditional-field></field><field name="remove"><conditional-field condition="fromPartyId != ec.user.userAccount.partyId && organization.ownerPartyId == ec.user.userAccount.partyId" title=""><link url="removeUser" parameter-map="[fromPartyId:fromPartyId,toPartyId:organizationId]" icon="fa fa-trash" btn-type="danger" text=" " tooltip="Remove ${firstName} ${lastName} from ${organization?.organizationName?:' Organization'}" confirmation="Are you sure you want to remove ${firstName} ${lastName} from ${organization?.organizationName?:' Organization'}"/></conditional-field></field><field name="search"><header-field><submit/></header-field></field></form-list></row-col><row-col md="2"/></container-row></widgets></screen>
<!-- Screen Location component://coarchy/screen/settings/settingsinternal/OrderHistory.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Order History" default-menu-index="60" menu-image="fa fa-history" menu-image-type="icon"><actions><entity-find entity-name="mantle.order.OrderHeaderAndPart" list="existingOrder1List" limit="1"><econdition field-name="customerPartyId" from="ec.user.userAccount.partyId"/><select-field field-name="orderId,placedDate,completedDate,entryDate,statusId"/><order-by field-name="-entryDate"/></entity-find><set field="firstOrder" from="existingOrder1List.getFirst()"/><set field="shouldReload" from="firstOrder?.statusId == 'OrderOpen'&&Duration.between(firstOrder?.entryDate.toInstant(),ec.user.nowTimestamp.toInstant()).toMillis()<5000"/></actions><widgets><container-row><row-col md="2"/><row-col md="8"><label text="Orders" type="h4"/><link url="../BuyPremium" text="Buy Again" btn-type="success"/><form-list name="OrderItemPartForm" list="existingOrderList" header-dialog="true" show-csv-button="false"><entity-find entity-name="mantle.order.OrderHeaderAndPart" list="existingOrderList"><search-form-inputs/><econdition field-name="customerPartyId" from="ec.user.userAccount.partyId"/><select-field field-name="orderId,placedDate,entryDate,orderPartSeqId,currencyUomId,grandTotal"/><order-by field-name="-entryDate"/></entity-find><row-actions><entity-find entity-name="mantle.order.OrderItem" list="orderItemList" limit="1"><econdition field-name="orderId"/><econdition field-name="orderPartSeqId"/><order-by field-name="orderItemSeqId"/></entity-find><set field="orderItem" from="orderItemList.getFirst()"/><entity-find-one entity-name="moqui.basic.StatusItem" value-field="status" auto-field-map="[statusId:statusId]" cache="true"/><entity-find-count entity-name="mantle.account.financial.FinancialAccountAndTrans" count-field="finAccountAndTransCount"><econdition field-name="orderId"/><econdition field-name="ownerPartyId" from="ec.user.userAccount.partyId"/><econdition field-name="finAccountTypeId" value="OrganizationMonthCredit"/><econdition field-name="organizationPartyId" value="coarchy"/><econdition field-name="statusId" value="FaActive"/></entity-find-count></row-actions><field name="orderId"><header-field><text-find/></header-field><default-field><display/></default-field></field><field name="placedDate"><header-field><date-find type="date-time"/></header-field><default-field title="Date"><label text="${ec.l10n.format(placedDate ?: entryDate, 'dd MMM yyyy hh:mm a')}"/></default-field></field><field name="statusId"><default-field title="Status"><label text="${shouldReload&&                         existingOrderList_index==0?'Payment Processing...':status.description}"/></default-field></field><field name="quantity"><default-field title="Quantity"><label text="${ec.l10n.formatNumber((Number)orderItem.quantity,null,null)} ${orderItem.itemDescription}"/></default-field></field><field name="total"><default-field title="Total"><label text="${ec.l10n.formatCurrency(grandTotal,currencyUomId,2)}"/></default-field></field><field name="transaction"><conditional-field condition="finAccountAndTransCount"><link url="../TransactionHistory?orderId=${orderId}" text="Transaction"/></conditional-field></field><field name="submit"><header-field><submit text="Find"/></header-field></field></form-list></row-col><row-col md="2"/></container-row></widgets></screen>
<!-- Screen Location component://coarchy/screen/settings/settingsinternal/TransactionHistory.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Transactions" default-menu-index="70" menu-image="fa fa-university" menu-image-type="icon"><actions><entity-find entity-name="mantle.account.financial.FinancialAccountAndTrans" list="finAccountAndTrans"><search-form-inputs/><econdition field-name="ownerPartyId" from="ec.user.userAccount.partyId"/><econdition field-name="finAccountTypeId" value="OrganizationMonthCredit"/><econdition field-name="organizationPartyId" value="coarchy"/><econdition field-name="statusId" value="FaActive"/><date-filter/><order-by field-name="-transactionDate"/></entity-find><if condition="ec.user.userAccount?.partyId"><service-call name="coarchy.CoarchyServices.check#PartyActivation" in-map="[userPartyId:ec.user.userAccount?.partyId, finAccountTypeId:'OrganizationMonthCredit']" out-map="partyActivationOut"/></if><set field="totalCreditsUsed" type="BigDecimal" from="partyActivationOut?.totalCreditsUsed?:0.0"/></actions><widgets><container-row><row-col md="2"/><row-col md="8"><label text="Transaction History" type="h4"/><label condition="finAccountAndTrans.getFirst() != null&&finAccountAndTrans.getFirst().availableBalance>0" text="Used ${ec.l10n.formatNumber((Number)(totalCreditsUsed.setScale(2, BigDecimal.ROUND_HALF_UP)),null,null)} / ${ec.l10n.formatNumber((Number)finAccountAndTrans.getFirst().availableBalance,null,null)} Organization-Month Credits this month"/><form-list name="OrderItemPartForm" list="finAccountAndTrans" header-dialog="true" show-csv-button="true"><row-actions><entity-find-one entity-name="mantle.party.Person" value-field="person" auto-field-map="[partyId:ownerPartyId]" cache="true"/><set field="partyName" from="person.firstName + ' ' + person.lastName"/><entity-find-one entity-name="moqui.basic.Enumeration" value-field="finAccountTransTypeEnum" auto-field-map="[enumId:finAccountTransTypeEnumId]" cache="true"/></row-actions><field name="finAccountTransId"><default-field><hidden/></default-field></field><field name="partyName"><default-field title="Name"><label text="${partyName}"/></default-field></field><field name="finAccountTransTypeEnumId"><default-field title="Type"><label text="${finAccountTransTypeEnum.description}"/></default-field></field><field name="amount"><default-field title="Amount"><label text="${ec.l10n.formatNumber((Number)amount,null,null)} Organization-Month Credits"/></default-field></field><field name="transactionDate"><header-field title="Date"><date-find type="date-time"/></header-field><default-field title="Date"><label text="${ec.l10n.format(transactionDate, 'dd MMM yyyy hh:mm a')}"/></default-field></field><field name="orderId"><header-field title="Order"><text-find/></header-field><conditional-field condition="orderId != null" title="Order"><link url="../OrderHistory?orderId=${orderId}" text="Order"/></conditional-field></field><field name="submit"><header-field><submit text="Find"/></header-field></field></form-list></row-col><row-col md="2"/></container-row></widgets></screen>
<!-- Screen Location component://coarchy/screen/settings/settingsinternal.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="anonymous-view" default-menu-title="Settings" allow-extra-path="true" menu-image="fa fa-cog" menu-image-type="icon"><subscreens default-item="Organizations"/><widgets><label text="Go to /settings" type="strong"/></widgets></screen>
<!-- Screen Location component://coarchy/screen/settings/settings.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="false" screen-theme-type-enum-id="STT_INTERNAL_QUASAR" default-menu-title="Settings" allow-extra-path="true"><transition name="manifest.webmanifest" read-only="true"><actions><script><![CDATA[def manifestOut = [
                    name: "Coarchy",
                    short_name: "Coarchy",
                    icons: [
                            [
                                    src: '/costatic/images/CoarchySquareBlack200.png',
                                    type: "image/png",
                                    sizes: "200x200"
                            ],
                            [
                                    src: '/costatic/images/CoarchySquareBlack500.png',
                                    type: "image/png",
                                    sizes: "500x500"
                            ]
                    ],
                    start_url: "/coapp",
                    display: "minimal-ui",
                    prefer_related_applications: true
            ];
            ec.web.sendJsonResponse(manifestOut)]]></script></actions><default-response type="none"/></transition><transition name="createPaymentIntent"><service-call name="coarchy.StripeServices.create#PaymentIntent" out-map="context" in-map="true" multi="parameter"/><actions><script><![CDATA[ec.web.sendJsonResponse([clientSecret:clientSecret])]]></script></actions><default-response type="none" save-parameters="true"/></transition><transition name="orderStatus"><service-call name="coarchy.CoarchyServices.get#OrderProgress" in-map="[orderId:orderId]" out-map="orderOut" multi="parameter"/><actions><script><![CDATA[ec.web.sendJsonResponse(orderOut)]]></script></actions><default-response type="none" save-parameters="true"/></transition><pre-actions><script><![CDATA[// if user not logged in save current path and params then redirect to Login
        if (!ec.user.userId) { ec.web.saveScreenLastInfo(null, null); sri.sendRedirectAndStopRender('/Login') }

        html_scripts.add('/libs/moment.js/moment-with-locales.min.js')
        html_scripts.add('/libs/jquery/jquery.min.js')

        String instancePurpose = System.getProperty("instance_purpose")
        if (!instancePurpose || instancePurpose == 'production') {
            /* ========== Production Mode ========== */
            html_scripts.add('/js/MoquiLib.min.js')
            // Vue JS
            footer_scripts.add('/libs/vue/vue.min.js')
            // http-vue-loader
            footer_scripts.add('/js/http-vue-loader/httpVueLoader.js')
            // Quasar
            footer_scripts.add("/libs/quasar/quasar.umd.min.js")
            // Vue Components for Coarchy
            footer_scripts.add('/costatic/js/CoarchyVue.js')
            // Webroot Quasar-Vue instance, in footer so runs after page loaded
            footer_scripts.add('/js/WebrootVue.qvt.js')
        } else {
            /* ========== Dev Mode ========== */
            html_scripts.add('/js/MoquiLib.js')
            // Vue JS
            footer_scripts.add('/libs/vue/vue.js')
            // http-vue-loader
            footer_scripts.add('/js/http-vue-loader/httpVueLoader.js')
            // Quasar
            footer_scripts.add("/libs/quasar/quasar.umd.min.js")
            // Vue Components for Coarchy
            footer_scripts.add('/costatic/js/CoarchyVue.js')
            // Webroot Quasar-Vue instance, in footer so runs after page loaded
            footer_scripts.add('/js/WebrootVue.qvt.js')
        }

        // conditional QZ Tray scripts, only include if enabled
        if (ec.user.getPreference("qz.print.enabled") == "true") {
            footer_scripts.add('/js/qz-tray/sha-256.min.js')
            footer_scripts.add('/js/qz-tray/qz-tray.min.js')
            // TODO migrate MoquiQzComponent.js to MoquiQzComponent.qvt.js
            footer_scripts.add('/js/qz-tray/MoquiQzComponent.js')
        }

        // Vue Components for Coarchy Settings
        footer_scripts.add('/settingsstatic/js/SettingsVue.qvt.js')
        html_stylesheets.add('/settingsstatic/css/checkout.css')]]></script></pre-actions><actions><entity-find-one entity-name="mantle.party.Organization" value-field="organization" auto-field-map="[partyId:ec.user.getPreference('ACTIVE_ORGANIZATION')]"/><set field="organizationName" from="organization?.organizationName"/></actions><widgets><render-mode><text type="html" location="component://coarchy/screen/settings/includes/SettingsVue.qvt.ftl"/></render-mode></widgets></screen>
<!-- Screen Location component://coarchy/screen/settings/settingsstatic.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="anonymous-view"><widgets><subscreens-active/></widgets></screen>
<!-- Screen Location component://SimpleScreens/screen/ssstatic.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="anonymous-view"><widgets><subscreens-active/></widgets></screen>
<!-- Screen Location component://tools/screen/toolstatic.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="anonymous-view"><widgets><subscreens-active/></widgets></screen>
<!-- Screen Location component://webroot/screen/webroot/up.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="false" default-menu-include="false"><widgets><container style="background-color: green; width: 100vw; height: 100vh;"><label text="yes"/></container></widgets></screen>
<!-- Screen Location component://coarchy/screen/vendor/vendor.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="false" screen-theme-type-enum-id="STT_INTERNAL_QUASAR" default-menu-title="Vendor" allow-extra-path="true"><transition name="manifest.webmanifest" read-only="true"><actions><script><![CDATA[def manifestOut = [
                        name: "Coarchy Vendor",
                        short_name: "Coarchy Vendor",
                        icons: [
                                [
                                    src: '/vendorstatic/images/CoarchySquareBlack200.png',
                                    type: "image/png",
                                    sizes: "200x200"
                                ],
                                [
                                    src: '/vendorstatic/images/CoarchySquareBlack500.png',
                                    type: "image/png",
                                    sizes: "500x500"
                                ]
                        ],
                        start_url: "/vendor",
                        display: "minimal-ui",
                        prefer_related_applications: true
                ];
                ec.web.sendJsonResponse(manifestOut)]]></script></actions><default-response type="none"/></transition><pre-actions><script><![CDATA[// if user not logged in save current path and params then redirect to Login
        if (!ec.user.userId) { ec.web.saveScreenLastInfo(null, null); sri.sendRedirectAndStopRender('/Login') }

        html_scripts.add('/libs/moment.js/moment-with-locales.min.js')
        html_scripts.add('/libs/jquery/jquery.min.js')

        String instancePurpose = System.getProperty("instance_purpose")
        if (!instancePurpose || instancePurpose == 'production') {
            /* ========== Production Mode ========== */
            html_scripts.add('/js/MoquiLib.min.js')
            // Vue JS
            footer_scripts.add('/libs/vue/vue.min.js')
            // http-vue-loader
            footer_scripts.add('/js/http-vue-loader/httpVueLoader.js')
            // Quasar
            footer_scripts.add("/libs/quasar/quasar.umd.min.js")
            // Vue Components for Coarchy Vendor App
            footer_scripts.add('/vendorstatic/js/CoarchyVue.js')
            // Webroot Quasar-Vue instance, in footer so runs after page loaded
            footer_scripts.add('/js/WebrootVue.qvt.js')
        } else {
            /* ========== Dev Mode ========== */
            html_scripts.add('/js/MoquiLib.js')
            // Vue JS
            footer_scripts.add('/libs/vue/vue.js')
            // http-vue-loader
            footer_scripts.add('/js/http-vue-loader/httpVueLoader.js')
            // Quasar
            footer_scripts.add("/libs/quasar/quasar.umd.min.js")
            // Vue Components for Coarchy Vendor App
            footer_scripts.add('/vendorstatic/js/CoarchyVue.js')
            // Webroot Quasar-Vue instance, in footer so runs after page loaded
            footer_scripts.add('/js/WebrootVue.qvt.js')
        }

        // conditional QZ Tray scripts, only include if enabled
        if (ec.user.getPreference("qz.print.enabled") == "true") {
            footer_scripts.add('/js/qz-tray/sha-256.min.js')
            footer_scripts.add('/js/qz-tray/qz-tray.min.js')
            // TODO migrate MoquiQzComponent.js to MoquiQzComponent.qvt.js
            footer_scripts.add('/js/qz-tray/MoquiQzComponent.js')
        }

        // Custom CSS
        html_stylesheets.add('/vendorstatic/css/style.css')]]></script></pre-actions><actions/><widgets><render-mode><text type="html" location="component://coarchy/screen/vendor/includes/VendorVue.qvt.ftl"/></render-mode></widgets></screen>
<!-- Screen Location component://coarchy/screen/vendor/vendorinternal/ProductEval/FindProductEval.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Find" default-menu-index="60" menu-image="fa fa-search" menu-image-type="icon"><parameter name="pageIndex" from="pageIndex?:0"/><parameter name="pageSize"/><parameter name="orderByField" value="productName"/><always-actions/><transition name="goToProductEvaluation"><default-response url="../EditProductEval" parameter-map="[productEvaluationId:productEvaluationId]"/></transition><widgets><label text="Product Evaluations" type="h4"/><label text="showing evaluations for organization ${organizationName}. You can switch organizations from the organization picker." style="text-grey-9"/><form-list name="ProductEvalListForm" header-dialog="true" show-page-size="true" select-columns="true" saved-finds="true" show-csv-button="true" list="evalPartyAndEvalList"><entity-find entity-name="coarchy.product.ProductEvaluationPartyAndEval" list="evalPartyAndEvalList" distinct="true"><date-filter/><econdition field-name="organizationId" from="activeOrgId"/><econdition field-name="partyId" from="ec.user.userAccount.partyId"/><econdition field-name="roleTypeId" value="VendorRepresentative"/><econdition field-name="statusId" operator="not-in" value="PepPlanned,PepCancelled,PepRejected"/><econdition field-name="evaluationStatusId" operator="in" value="PeAwaitingVendorResponse,PeCompleted"/></entity-find><row-actions><entity-find-one entity-name="coarchy.product.ProductEvaluationAndProduct" value-field="productEvaluation"/></row-actions><field name="productEvaluationId"><default-field title="Evaluation ID"><link url="../EditProductEval" link-type="anchor" text="${productEvaluationId}"/></default-field></field><field name="productName" from="productEvaluation?.productName"><default-field><display/></default-field></field><field name="organizationPartyId" from="productEvaluation?.organizationId"><default-field title="Organization"><display-entity entity-name="mantle.party.PartyDetail" text="PartyNameOnlyTemplate"/></default-field></field><field name="evaluationStatusId"><conditional-field condition="evaluationStatusId=='PeAwaitingVendorResponse'"><display text="Awaiting Response"/></conditional-field><default-field title="Status"><display-entity entity-name="moqui.basic.StatusItem"/></default-field></field><field name="actions"><default-field title=""><link url="goToProductEvaluation" text="View" parameter-map="[productEvaluationId:productEvaluationId]"/></default-field></field></form-list></widgets></screen>
<!-- Screen Location component://coarchy/screen/vendor/vendorinternal/ProductEval.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" default-menu-title="Product Evaluations" default-menu-index="20" menu-image="/ssstatic/images/Catalog.png" default-menu-include="true"><subscreens default-item="FindProductEval"><subscreens-item name="FindProductEval" menu-include="true" menu-index="10" location="component://coarchy/screen/vendor/vendorinternal/ProductEval/FindProductEval.xml"/><subscreens-item name="EditProductEval" menu-include="true" menu-index="20" location="component://coarchy/screen/coarchy/cointernal/Products/EditProductEval.xml"/></subscreens><widgets><subscreens-active id="product-eval-active"/></widgets></screen>
<!-- Screen Location component://coarchy/screen/vendor/vendorinternal.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="anonymous-view" default-menu-title="Vendors" allow-extra-path="true" menu-image="fa fa-cog" menu-image-type="icon"><always-actions><service-call name="mantle.party.PartyServices.setup#UserVendorOrganizationInfo" out-map="context"/><if condition="activeOrgId"><entity-find-one entity-name="mantle.party.Organization" value-field="organization" auto-field-map="[partyId:activeOrgId]"/><set field="organizationName" from="organization?.organizationName"/></if><script><![CDATA[context.isVendorView = true]]></script></always-actions><subscreens default-item="ProductEval"/><widgets><label text="Go to /vendor" type="strong"/></widgets></screen>
<!-- Screen Location component://coarchy/screen/vendor/vendorstatic.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="anonymous-view"><widgets><subscreens-active/></widgets></screen>
<!-- Screen Location component://webroot/screen/webroot.xml  --><screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd" require-authentication="false"><always-actions><set field="html_scripts" from="new LinkedHashSet()"/><set field="footer_scripts" from="new LinkedHashSet()"/><set field="html_stylesheets" from="new LinkedHashSet()"/></always-actions><transition name="status"><actions><set field="allowed_ips" from="System.getProperty('webapp_status_ips')? System.getProperty('webapp_status_ips').replaceAll('\\s', '').split(',')+['127.0.0.1','0:0:0:0:0:0:0:1']: ['127.0.0.1','0:0:0:0:0:0:0:1']"/><if condition="ec.user.getClientIp() in allowed_ips"><then><script><![CDATA[ec.web.sendJsonResponse(ec.factory.getStatusMap())]]></script></then><else><log message="Rejecting /status from ${ec.web.getRequest().getRemoteAddr()}"/></else></if></actions><default-response type="none"/></transition><transition name="menuData" read-only="true" begin-transaction="false"><actions><script><![CDATA[List menuDataList = sri.getMenuData(sri.screenUrlInfo.extraPathNameList)
            if (menuDataList != null) ec.web.sendJsonResponse(menuDataList)]]></script></actions><default-response type="none" save-parameters="true"/></transition><transition name="email"><path-parameter name="emailMessageId"/><actions><script><![CDATA[ec.web.viewEmailMessage()]]></script></actions><default-response type="none"/></transition><transition name="robots.txt" read-only="true"><actions><script><![CDATA[List disallowList = ['apps', 'vapps', 'qapps', 'rest', 'rpc', 'status', 'menuData']
            def outWriter = new StringWriter()
            outWriter.append("user-agent: *\n")
            for (disPath in disallowList) outWriter.append("disallow: /${disPath}\n")
            ec.web.sendTextResponse(outWriter.toString())]]></script></actions><default-response type="none"/></transition><transition name="favicon.ico"><actions><script><![CDATA[iconList = sri.getThemeValues("STRT_SHORTCUT_ICON")
                if (!iconList || iconList[0] == "") iconList = ["/favicon.ico"]
                ec.web.sendResourceResponse("component://webroot/screen/webroot" + iconList[0])]]></script></actions><default-response type="none"/></transition><subscreens default-item="qapps"><subscreens-item name="toolstatic" location="component://tools/screen/toolstatic.xml" menu-include="false"/></subscreens><widgets><render-mode><text type="html" location="component://webroot/screen/includes/Header.html.ftl" no-boundary-comment="true"/><text type="xsl-fo" location="component://webroot/screen/includes/Header.xsl-fo.ftl" no-boundary-comment="true"/></render-mode><render-mode><text template="true"><![CDATA[${sri.renderSubscreen()}]]></text></render-mode><render-mode><text type="html" location="component://webroot/screen/includes/Footer.html.ftl"/><text type="xsl-fo"><![CDATA[${sri.getAfterScreenWriterText()}</fo:flow></fo:page-sequence></fo:root>]]></text></render-mode></widgets></screen>