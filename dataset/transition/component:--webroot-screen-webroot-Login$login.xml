<!--Transition Screen Location component://webroot/screen/webroot/Login.xml Transition Name login--><transition name="login"><parameter name="initialTab"/><parameter name="returnTo"/><parameter name="username" from="ec.web?.sessionAttributes?.moquiPreAuthcUsername ?: username"/><actions><!--always-actions at component://webroot/screen/webroot.xml--><set field="html_scripts" from="new LinkedHashSet()"/><set field="footer_scripts" from="new LinkedHashSet()"/><set field="html_stylesheets" from="new LinkedHashSet()"/><!--transition actions--><if condition="ec.web?.sessionAttributes?.moquiPreAuthcUsername"><then><set field="username" from="ec.web?.sessionAttributes?.moquiPreAuthcUsername"/></then><else><set field="loggedIn" from="ec.user.loginUser(username, password)"/></else></if><if condition="ec.web.sessionAttributes.moquiAuthcFactorRequired"><if condition="code"><then><service-call name="org.moqui.impl.UserServices.validate#ExternalUserAuthcCode" in-map="[code:code]" out-map="validateOut"/><if condition="validateOut.verified"><then><script><![CDATA[ec.user.internalLoginUser(validateOut.username)]]></script><return/></then><else><message error="true" public="true"><![CDATA[Authentication code is not valid]]></message></else></if></then><else><message error="true" public="true"><![CDATA[Authentication code required for user ${username}]]></message></else></if></if></actions></transition>