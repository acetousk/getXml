<!--Transition Screen Location component://SimpleScreens/screen/SimpleScreens/Asset/Asset/SelectAsset.xml Transition Name getAssetList--><transition name="getAssetList"><parameter name="facilityId"/><parameter name="locationSeqId"/><parameter name="containerId"/><parameter name="productId"/><parameter name="assetPoolId"/><parameter name="lotId"/><parameter name="quantity"/><parameter name="toScanLocation"/><parameter name="term"/><parameter name="mfgPartyId"/><parameter name="term"/><parameter name="ownerPartyId"/><parameter name="partyId"/><parameter name="productStoreId"/><parameter name="term"/><parameter name="facilityTypeEnumId"/><parameter name="parentFacilityId"/><parameter name="ownerPartyId"/><parameter name="term"/><parameter name="facilityId"/><parameter name="locationSeqId"/><parameter name="term"/><parameter name="productId"/><parameter name="facilityId"/><parameter name="ownerPartyId"/><parameter name="assetTypeEnumId"/><parameter name="classEnumId"/><parameter name="assetOrderBy"/><parameter name="excludeZeroQoh"/><actions><!--always-actions at component://webroot/screen/webroot.xml--><set field="html_scripts" from="new LinkedHashSet()"/><set field="footer_scripts" from="new LinkedHashSet()"/><set field="html_stylesheets" from="new LinkedHashSet()"/><!--always-actions at component://PopCommerce/screen/PopCommerceAdmin.xml--><set field="appRoot" value="PopcAdmin"/><set field="searchIndexName" value="mantle"/><set field="searchLinkSets" value="PopcAdmin"/><set field="searchProductDocType" value="MantleProduct"/><set field="searchPartyDocType" value="MantleParty"/><set field="appUserGroupTypeEnumId" value="UgtPopcAdmin"/><service-call name="mantle.party.PartyServices.setup#UserOrganizationInfo" out-map="context"/><!--transition actions--><entity-find-one entity-name="mantle.product.asset.AssetFindView" value-field="asset"><field-map field-name="assetId" from="term"/></entity-find-one><if condition="asset != null"><then><script><![CDATA[def outList = [[value:asset.assetId, label:"${ec.resource.expand('AssetNameTemplate','',asset)} - ${ec.resource.expand('ProductNameTemplate','',asset)} ATP ${ec.l10n.format(asset.availableToPromiseTotal, '#,##0.###')}${asset.lotId || asset.lotNumber ? ' Lot ' + (asset.lotNumber ?: asset.lotId) : ''}".toString()]]
                    ec.web.sendJsonResponse(outList)]]></script></then><else><set field="excludeZeroQohBool" from="'true'.equals(excludeZeroQoh)"/><entity-find entity-name="mantle.product.asset.AssetFindView" list="assetList" limit="20"><econdition field-name="productId" ignore-if-empty="true"/><econdition field-name="facilityId" ignore-if-empty="true"/><econdition field-name="ownerPartyId" ignore-if-empty="true"/><econdition field-name="assetTypeEnumId" ignore-if-empty="true"/><econdition field-name="classEnumId" ignore-if-empty="true"/><econdition field-name="quantityOnHandTotal" operator="not-equals" from="0.0" ignore="!excludeZeroQohBool"/><econditions combine="or"><econdition field-name="assetId" operator="like" value="%${term}%"/><econdition field-name="assetName" operator="like" value="%${term}%" ignore-case="true"/><econdition field-name="lotId" operator="like" value="%${term}%"/><econdition field-name="lotNumber" operator="like" value="%${term}%" ignore-case="true"/><econdition field-name="serialNumber" operator="like" value="%${term}%" ignore-case="true"/><econdition field-name="pseudoId" operator="like" value="%${term}%" ignore-case="true" ignore="productId"/><econdition field-name="productName" operator="like" value="%${term}%" ignore-case="true" ignore="productId"/></econditions><select-field field-name="assetId,assetName,availableToPromiseTotal,quantityOnHandTotal,lotId,lotNumber,serialNumber,pseudoId,productName"/><order-by field-name="${assetOrderBy ?: '-receivedDate'}"/></entity-find><script><![CDATA[def outList = []
                    for (asset in assetList) outList.add([value:asset.assetId, label:"${ec.resource.expand('AssetNameTemplate','',asset)} - ${ec.resource.expand('ProductNameTemplate','',asset)} ATP ${ec.l10n.format(asset.availableToPromiseTotal, '#,##0.###')} QOH ${ec.l10n.format(asset.quantityOnHandTotal, '#,##0.###')}${asset.lotId || asset.lotNumber ? ' Lot ' + (asset.lotNumber ?: asset.lotId) : ''}${asset.serialNumber ? ' SN ' + asset.serialNumber : ''}".toString()])
                    ec.web.sendJsonResponse(outList)]]></script></else></if></actions></transition>