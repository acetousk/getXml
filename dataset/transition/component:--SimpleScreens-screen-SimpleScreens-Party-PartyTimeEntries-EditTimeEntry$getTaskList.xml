<!--Transition Screen Location component://SimpleScreens/screen/SimpleScreens/Party/PartyTimeEntries/EditTimeEntry.xml Transition Name getTaskList--><transition name="getTaskList"><parameter name="timeEntryId"/><parameter name="partyId" from="partyId ?: ec.user.userAccount?.partyId"/><parameter name="clockInMode"/><parameter name="term"/><parameter name="facilityTypeEnumId"/><parameter name="parentFacilityId"/><parameter name="ownerPartyId"/><parameter name="term"/><parameter name="rootWorkEffortId"/><parameter name="assignedPartyId"/><parameter name="indexName"/><parameter name="documentType"/><actions><!--always-actions at component://webroot/screen/webroot.xml--><set field="html_scripts" from="new LinkedHashSet()"/><set field="footer_scripts" from="new LinkedHashSet()"/><set field="html_stylesheets" from="new LinkedHashSet()"/><!--transition actions--><set field="indexName" from="searchIndexName ?: 'mantle'"/><set field="documentType" from="searchTaskDocType ?: 'MantleTask'"/><entity-find-one entity-name="mantle.work.effort.WorkEffort" value-field="workEffort"><field-map field-name="workEffortId" from="term"/></entity-find-one><if condition="workEffort"><then><script><![CDATA[def outList = [[value:workEffort.workEffortId, label:ec.resource.expand("WorkEffortNameTemplate", "", workEffort)]]
                    ec.web.sendJsonResponse(outList)]]></script></then><else><script><![CDATA[StringBuilder termSb = new StringBuilder()
                    termSb.append(term).append('*')
                    if (rootWorkEffortId) termSb.append(' AND project:').append(rootWorkEffortId)
                    if (assignedPartyId) termSb.append(' AND parties.partyId:').append(assignedPartyId)]]></script><service-call name="org.moqui.search.SearchServices.search#DataDocuments" out-map="context" in-map="[queryString:termSb.toString(), indexName:indexName, documentType:documentType]"/><script><![CDATA[def outList = []
                    for (def document in documentList)
                        outList.add([value:document._id, label:ec.resource.expand("WorkEffortNameTemplate", "", [workEffortName:document.name,workEffortId:document._id])])
                    ec.web.sendJsonResponse(outList)]]></script></else></if></actions></transition>