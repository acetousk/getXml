<!--Transition Screen Location component://coarchy/screen/coarchy/cointernal/Process/EditProcessStoryV3.xml Transition Name getProcessStoryDetail--><transition name="getProcessStoryDetail"><parameter name="processStoryId"/><parameter name="pageIndex" from="pageIndex?:0"/><parameter name="pageSize" from="pageSize?:50"/><parameter name="processStoryActivityId"/><parameter name="newSequenceNum"/><parameter name="activityId"/><parameter name="processStoryId"/><parameter name="activityId"/><parameter name="valueIdList"/><parameter name="valueStatementActivityId"/><parameter name="processStoryActivityId"/><parameter name="activityId"/><parameter name="processStoryId"/><parameter name="pageSize"/><parameter name="pageIndex"/><actions><!--always-actions at component://webroot/screen/webroot.xml--><set field="html_scripts" from="new LinkedHashSet()"/><set field="footer_scripts" from="new LinkedHashSet()"/><set field="html_stylesheets" from="new LinkedHashSet()"/><!--always-actions at component://coarchy/screen/coarchy/cointernal.xml--><service-call name="mantle.party.PartyServices.setup#UserOrganizationInfo" out-map="context"/><!--always-actions at component://coarchy/screen/coarchy/cointernal/Process/EditProcessStoryV3.xml--><if condition="!activeOrgId"><message><![CDATA[${ec.resource.expand('CoarchySelectAnOrg', null)}]]></message><script><![CDATA[sri.sendRedirectAndStopRender('/settings/Organizations')]]></script></if><entity-find-count entity-name="mantle.party.PartyRelationship" count-field="partyRelationshipCount"><date-filter/><econdition field-name="relationshipTypeEnumId" value="PrtMember"/><econdition field-name="toRoleTypeId" value="OrgInternal"/><econdition field-name="fromPartyId" from="ec.user.userAccount.partyId"/><econdition field-name="toPartyId" from="activeOrgId"/></entity-find-count><entity-find-count entity-name="mantle.party.PartyActivation" count-field="partyActivationCount"><date-filter/><econdition field-name="partyId" from="activeOrgId"/></entity-find-count><!--transition actions--><entity-find-one entity-name="coarchy.ProcessStory" value-field="processStory"><field-map field-name="processStoryId"/></entity-find-one><if condition="!processStory"><return error="true" message="Process story not found"/></if><entity-find entity-name="coarchy.ProcessStoryActivityDetail" list="detailActivityList"><date-filter/><econdition field-name="replacedByActivityId" operator="is-null"/><econdition field-name="detailProcessStoryId" from="processStoryId"/><select-field field-name="processStoryId,name"/><order-by field-name="-lastUpdatedStamp"/></entity-find><entity-find entity-name="coarchy.ProcessStoryActivityDetail" list="processStoryActivityList" distinct="true"><search-form-inputs default-order-by="sequenceNum,action"/><date-filter/><econdition field-name="replacedByActivityId" operator="is-null"/><econdition field-name="processStoryId"/><econdition field-name="actorId" operator="in" from="actorIdList" ignore-if-empty="true"/><select-field field-name="processStoryActivityId,sequenceNum,detailProcessStoryId,action,condition,activityId,implementationId"/></entity-find><set field="processStoryActivityWithActors" from="[]"/><iterate list="processStoryActivityList" entry="processStoryActivity"><entity-find entity-name="coarchy.ActivityActorDetail" list="activityActorList"><econdition field-name="activityId" from="processStoryActivity.activityId"/><order-by field-name="name"/></entity-find><entity-find-count entity-name="coarchy.product.ProductEvaluationActivityAndDetail" count-field="existingEvaluationRecordCount"><econdition field-name="statusId" operator="not-equals" value="PeRequirementsSelection"/><econdition field-name="activityId" from="processStoryActivity.activityId"/><econdition field-name="excludeFlag" value="N" or-null="true"/><econdition field-name="organizationId" from="activeOrgId"/></entity-find-count><script><![CDATA[processStoryActivityWithActors.add(processStoryActivity.getMap()+[actors:activityActorList,actorNames:activityActorList*.name,willCopyOnWrite:existingEvaluationRecordCount>0])]]></script></iterate><script><![CDATA[ec.web.sendJsonResponse([
                    processStory: processStory,
                    detailActivityList:detailActivityList,
                    processStoryActivityList:processStoryActivityWithActors
                ])]]></script></actions></transition>