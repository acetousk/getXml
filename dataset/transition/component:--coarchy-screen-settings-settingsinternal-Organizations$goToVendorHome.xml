<!--Transition Screen Location component://coarchy/screen/settings/settingsinternal/Organizations.xml Transition Name goToVendorHome--><transition name="goToVendorHome"><actions><!--always-actions at component://webroot/screen/webroot.xml--><set field="html_scripts" from="new LinkedHashSet()"/><set field="footer_scripts" from="new LinkedHashSet()"/><set field="html_stylesheets" from="new LinkedHashSet()"/><!--always-actions at component://coarchy/screen/settings/settingsinternal/Organizations.xml--><entity-find entity-name="mantle.party.PartyToAndRelationship" list="organizationList" distinct="true"><date-filter/><econdition field-name="relationshipTypeEnumId" value="PrtMember"/><econditions combine="or"><econdition field-name="fromPartyId" from="ec.user.userAccount.partyId"/><econdition field-name="visibilityEnumId" value="PvPublic"/></econditions><select-field field-name="toPartyId,ownerPartyId,organizationName,visibilityEnumId"/><order-by field-name="-visibilityEnumId"/></entity-find><entity-find entity-name="mantle.party.PartyToAndRelationship" list="vendorOrganizationList" distinct="true"><date-filter/><econdition field-name="relationshipTypeEnumId" value="PrtVendorRepresentative"/><econdition field-name="toRoleTypeId" value="VendorRepresentative"/><econdition field-name="fromPartyId" from="ec.user.userAccount.partyId"/><select-field field-name="toPartyId,ownerPartyId,organizationName,visibilityEnumId"/><order-by field-name="-visibilityEnumId"/></entity-find><set field="ownerOfAnyOrganization" from="organizationList*.ownerPartyId.contains(ec.user.userAccount.partyId)"/><!--transition actions--><entity-find-one entity-name="moqui.security.UserPreference" value-field="userPreference" auto-field-map="[userId:ec.user.userId,preferenceKey:'ACTIVE_ORGANIZATION']"/><if condition="organizationId && userPreference?.preferenceValue != organizationId"><entity-find-count entity-name="mantle.party.PartyRelationship" count-field="partyRelationshipCount"><date-filter/><econdition field-name="relationshipTypeEnumId" value="PrtVendorRepresentative"/><econdition field-name="toRoleTypeId" value="VendorRepresentative"/><econdition field-name="fromPartyId" from="ec.user.userAccount.partyId"/><econdition field-name="toPartyId" from="organizationId"/></entity-find-count><if condition="partyRelationshipCount > 0"><service-call name="org.moqui.impl.UserServices.set#Preference" in-map="[preferenceKey:'ACTIVE_ORGANIZATION',preferenceValue:organizationId]"/></if></if></actions></transition>