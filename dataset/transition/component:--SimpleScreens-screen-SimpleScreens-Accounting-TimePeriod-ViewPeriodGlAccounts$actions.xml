<!--Transition Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/TimePeriod/ViewPeriodGlAccounts.xml Transition Name actions--><transition name="actions"><parameter name="timePeriodId" required="true"/><actions><!--always-actions at component://webroot/screen/webroot.xml--><set field="html_scripts" from="new LinkedHashSet()"/><set field="footer_scripts" from="new LinkedHashSet()"/><set field="html_stylesheets" from="new LinkedHashSet()"/><!--always-actions at component://PopCommerce/screen/PopCommerceAdmin.xml--><set field="appRoot" value="PopcAdmin"/><set field="searchIndexName" value="mantle"/><set field="searchLinkSets" value="PopcAdmin"/><set field="searchProductDocType" value="MantleProduct"/><set field="searchPartyDocType" value="MantleParty"/><set field="appUserGroupTypeEnumId" value="UgtPopcAdmin"/><service-call name="mantle.party.PartyServices.setup#UserOrganizationInfo" out-map="context"/><!--actions--><entity-find-one entity-name="mantle.party.time.TimePeriod" value-field="timePeriod"/><set field="timePeriodType" from="timePeriod.type"/><if condition="timePeriodType?.periodPurposeEnumId != 'Fiscal'"><return error="true" message="This screen is for Fiscal periods only"/></if><set field="organizationPartyId" from="timePeriod.partyId"/><service-call name="mantle.ledger.LedgerServices.find#PartyAcctgPreference" in-map="[organizationPartyId:timePeriod.partyId]" out-map="context"/><set field="glAccountCodeMask" from="partyAcctgPreference?.glAccountCodeMask ?: ec.user.getPreference('GlAccountCodeMask')"/><set field="accountCodeFormatter" from="masker(glAccountCodeMask, '0')"/><set field="incomeStmtTopIds" from="['REVENUE', 'COST_OF_SALES', 'INCOME', 'EXPENSE', 'NON_OP_EXPENSE']"/><set field="incomeStmtClassIds" from="new HashSet()"/><iterate list="incomeStmtTopIds" entry="incomeStmtTopId"><service-call name="org.moqui.impl.BasicServices.find#EnumerationByParent" out-map="incStmtClassOut" out-map-add-to-existing="false" in-map="[parentEnumId:incomeStmtTopId, includeParent:true, includeNested:true]"/><script><![CDATA[if (incStmtClassOut.enumIdSet) incomeStmtClassIds.addAll(incStmtClassOut.enumIdSet)]]></script></iterate></actions></transition>