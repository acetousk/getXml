<!--Transition Screen Location component://webroot/screen/webroot/rest.xml Transition Name verifyOtp--><transition name="verifyOtp"><parameter name="factorId" required="true"/><parameter name="code" required="true"/><actions><!--always-actions at component://webroot/screen/webroot.xml--><set field="html_scripts" from="new LinkedHashSet()"/><set field="footer_scripts" from="new LinkedHashSet()"/><set field="html_stylesheets" from="new LinkedHashSet()"/><!--transition actions--><service-call name="org.moqui.impl.UserServices.validate#ExternalUserAuthcCode" in-map="[code:code]" out-map="validateOut"/><if condition="validateOut.verified"><then><set field="loggedIn" from="ec.user.internalLoginUser(validateOut.username)"/><script><![CDATA[ec.web.sendJsonResponse([loggedIn:loggedIn])]]></script></then><else><script><![CDATA[ec.web.sendError(403, ec.l10n.localize("Authentication code is not valid"))]]></script></else></if></actions></transition>