<!--Transition Screen Location component://SimpleScreens/screen/MyAccount/User/TimeEntries.xml Transition Name getFacilityList--><transition name="getFacilityList"><parameter name="term"/><parameter name="facilityTypeEnumId"/><parameter name="parentFacilityId"/><parameter name="ownerPartyId"/><actions><!--always-actions at component://webroot/screen/webroot.xml--><set field="html_scripts" from="new LinkedHashSet()"/><set field="footer_scripts" from="new LinkedHashSet()"/><set field="html_stylesheets" from="new LinkedHashSet()"/><!--transition actions--><entity-find-one entity-name="mantle.facility.Facility" value-field="facility"><field-map field-name="facilityId" from="term"/></entity-find-one><if condition="facility != null"><script><![CDATA[ec.web.sendJsonResponse([[value:facility.facilityId, label:"${ec.resource.expand('FacilityNameTemplate','',facility)}".toString()]])]]></script><return/></if><entity-find entity-name="mantle.facility.Facility" list="facilityList" limit="20"><econdition field-name="facilityTypeEnumId" operator="in" ignore-if-empty="true"/><econdition field-name="parentFacilityId" ignore-if-empty="true"/><econdition field-name="ownerPartyId" ignore-if-empty="true"/><econditions combine="or"><econdition field-name="pseudoId" operator="like" value="%${term}%" ignore-case="true"/><econdition field-name="facilityName" operator="like" value="%${term}%" ignore-case="true"/></econditions><select-field field-name="facilityId,pseudoId,facilityName"/><order-by field-name="pseudoId,facilityName"/></entity-find><script><![CDATA[def outList = []
                for (def facility in facilityList)
                    outList.add([value:facility.facilityId, label:"${ec.resource.expand('FacilityNameTemplate','',facility)}".toString()])
                ec.web.sendJsonResponse(outList)]]></script></actions></transition>