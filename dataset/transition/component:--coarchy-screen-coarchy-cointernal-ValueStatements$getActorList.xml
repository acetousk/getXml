<!--Transition Screen Location component://coarchy/screen/coarchy/cointernal/ValueStatements.xml Transition Name getActorList--><transition name="getActorList"><parameter name="processStoryId"/><parameter name="pageIndex" from="pageIndex?:0"/><parameter name="pageSize"/><parameter name="orderByField" value="value"/><parameter name="maxLabelLength"/><parameter name="excludeActivityIds"/><parameter name="processStoryIds"/><actions><!--always-actions at component://webroot/screen/webroot.xml--><set field="html_scripts" from="new LinkedHashSet()"/><set field="footer_scripts" from="new LinkedHashSet()"/><set field="html_stylesheets" from="new LinkedHashSet()"/><!--always-actions at component://coarchy/screen/coarchy/cointernal.xml--><service-call name="mantle.party.PartyServices.setup#UserOrganizationInfo" out-map="context"/><!--always-actions at component://coarchy/screen/coarchy/cointernal/ValueStatements.xml--><if condition="!activeOrgId"><message type="info"><![CDATA[Select an Organization before moving forward.]]></message><script><![CDATA[sri.sendRedirectAndStopRender('/settings/Organizations')]]></script></if><entity-find-count entity-name="mantle.party.PartyRelationship" count-field="partyRelationshipCount"><date-filter/><econdition field-name="relationshipTypeEnumId" value="PrtMember"/><econdition field-name="toRoleTypeId" value="OrgInternal"/><econdition field-name="fromPartyId" from="ec.user.userAccount.partyId"/><econdition field-name="toPartyId" from="activeOrgId"/></entity-find-count><entity-find-count entity-name="mantle.party.PartyActivation" count-field="partyActivationCount"><date-filter/><econdition field-name="partyId" from="activeOrgId"/></entity-find-count><!--transition actions--><set field="processStoryIds" from="ec.web.getParameters().get('processStoryIds[]')?:[]"/><set field="actorList" from="[]"/><set field="allStoryActorIdSet" from="new TreeSet()"/><if condition="processStoryIds?.size() > 0"><entity-find entity-name="coarchy.ProcessStoryActivityDetail" list="psadList"><date-filter/><econdition field-name="replacedByActivityId" operator="is-null"/><econdition field-name="processStoryId" operator="in" from="processStoryIds"/><econdition field-name="storyActivityOrganizationId" from="activeOrgId"/><econdition field-name="actorId" operator="is-not-null"/><select-field field-name="processStoryId,actorId"/></entity-find><script><![CDATA[allStoryActorIdSet.addAll(psadList*.actorId)]]></script></if><entity-find entity-name="coarchy.Actor" list="actorList" limit="50"><econdition field-name="actorId" operator="in" from="allStoryActorIdSet" ignore="!processStoryIds"/><econdition field-name="name" operator="like" value="%${term}%" ignore-case="true" ignore="!term"/><order-by field-name="name"/></entity-find><script><![CDATA[def outList = []
                for (def actor in actorList)
                    outList.add([value:actor?.actorId, label:"${actor?.name}".toString()])
                ec.web.sendJsonResponse(outList)]]></script></actions></transition>