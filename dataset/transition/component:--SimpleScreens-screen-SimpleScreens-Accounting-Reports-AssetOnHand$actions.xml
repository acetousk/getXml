<!--Transition Screen Location component://SimpleScreens/screen/SimpleScreens/Accounting/Reports/AssetOnHand.xml Transition Name actions--><transition name="actions"><parameter name="term"/><parameter name="roleTypeId"/><parameter name="indexName"/><parameter name="documentType"/><parameter name="partyTypeEnumId"/><parameter name="includeDisabled"/><parameter name="restrictActiveOrg"/><parameter name="pageIndex"/><parameter name="term"/><parameter name="facilityId"/><parameter name="locationTypeEnumId"/><parameter name="term"/><parameter name="productFeatureIds"/><parameter name="productTypeEnumId"/><parameter name="productClassEnumId"/><parameter name="productCategoryIds"/><parameter name="assetTypeEnumId"/><parameter name="assetClassEnumId"/><parameter name="indexName"/><parameter name="documentType"/><parameter name="pageIndex"/><actions><!--always-actions at component://webroot/screen/webroot.xml--><set field="html_scripts" from="new LinkedHashSet()"/><set field="footer_scripts" from="new LinkedHashSet()"/><set field="html_stylesheets" from="new LinkedHashSet()"/><!--always-actions at component://PopCommerce/screen/PopCommerceAdmin.xml--><set field="appRoot" value="PopcAdmin"/><set field="searchIndexName" value="mantle"/><set field="searchLinkSets" value="PopcAdmin"/><set field="searchProductDocType" value="MantleProduct"/><set field="searchPartyDocType" value="MantleParty"/><set field="appUserGroupTypeEnumId" value="UgtPopcAdmin"/><service-call name="mantle.party.PartyServices.setup#UserOrganizationInfo" out-map="context"/><!--actions--><set field="hasDetails" from="showDetails == 'true'"/><if condition="facilityId && (dateRange_period || dateRange_from)"><then><set field="rangeList" from="ec.user.getPeriodRange('dateRange', context)"/><set field="fromDate" from="rangeList[0]"/><set field="thruDate" from="rangeList[1]"/><entity-find entity-name="mantle.product.asset.AssetOnHandSummary" list="summaryList" use-clone="true"><search-form-inputs default-order-by="pseudoId" paginate="false"/><econdition field-name="effectiveDate" operator="less-equals" from="thruDate"/><econdition field-name="quantityOnHandDiff" operator="not-equals" from="0.0"/><having-econditions><econditions combine="or"><econdition field-name="startingOnHand" operator="not-equals" from="0.0"/><econdition field-name="onHandChange" operator="not-equals" from="0.0"/></econditions></having-econditions><select-field field-name="productId,pseudoId,productName,facilityId,startingOnHand,onHandChange"/></entity-find><if condition="hasDetails"><set field="origList" from="summaryList"/><set field="summaryList" from="[]"/><iterate list="origList" entry="orig"><entity-find entity-name="mantle.product.asset.AssetOnHandDetail" list="detailList" use-clone="true"><econdition field-name="productId" from="orig.productId"/><econdition field-name="facilityId" from="orig.facilityId"/><econdition field-name="effectiveDate" operator="greater-equals" from="fromDate"/><econdition field-name="effectiveDate" operator="less-equals" from="thruDate"/><econdition field-name="quantityOnHandDiff" operator="not-equals" from="0.0"/><select-field field-name="assetId,effectiveDate,shipmentId,issOrderId,issInvoiceId,recOrderId,recInvoiceId,quantityOnHandDiff"/><order-by field-name="effectiveDate"/></entity-find><script><![CDATA[summaryList.add(orig.getMap())
                        for (det in detailList) summaryList.add([assetId:det.assetId, effectiveDate:det.effectiveDate,
                                orderId:(det.issOrderId ?: det.recOrderId), invoiceId:(det.issInvoiceId ?: det.recInvoiceId),
                                shipmentId:det.shipmentId, onHandChange:det.quantityOnHandDiff])]]></script></iterate></if></then><else><set field="dateRange_period" from="dateRange_period ?: 'week'"/><set field="dateRange_poffset" from="dateRange_poffset ?: '-1'"/></else></if><set field="sharedMap" from="[startingOnHand:null, prevStarting:null]"/></actions></transition>