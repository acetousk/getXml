<!--Transition Screen Location component://SimpleScreens/screen/SimpleScreens/Shipment/ShipmentDetail.xml Transition Name getShipmentLabel--><transition name="getShipmentLabel"><parameter name="shipmentId" required="true"/><parameter name="term"/><parameter name="facilityId"/><parameter name="locationSeqId"/><parameter name="shipmentId" required="true"/><parameter name="shipmentPackageSeqId" required="true"/><parameter name="shipmentBoxTypeId"/><parameter name="weightUomId"/><parameter name="weightFormat"/><parameter name="shipmentContentId"/><parameter name="term"/><parameter name="productFeatureIds"/><parameter name="productTypeEnumId"/><parameter name="productClassEnumId"/><parameter name="productCategoryIds"/><parameter name="assetTypeEnumId"/><parameter name="assetClassEnumId"/><parameter name="indexName"/><parameter name="documentType"/><parameter name="pageIndex"/><parameter name="emailMessageId"/><parameter name="term"/><parameter name="productId"/><parameter name="facilityId"/><parameter name="ownerPartyId"/><parameter name="assetTypeEnumId"/><parameter name="classEnumId"/><parameter name="assetOrderBy"/><parameter name="excludeZeroQoh"/><parameter name="term"/><parameter name="roleTypeId"/><parameter name="indexName"/><parameter name="documentType"/><parameter name="partyTypeEnumId"/><parameter name="includeDisabled"/><parameter name="restrictActiveOrg"/><parameter name="pageIndex"/><parameter name="shipmentId"/><parameter name="shipmentPackageSeqId"/><parameter name="shipmentRouteSegmentSeqId"/><parameter name="retLabel"/><parameter name="intlInvoiceLabel"/><actions><!--always-actions at component://webroot/screen/webroot.xml--><set field="html_scripts" from="new LinkedHashSet()"/><set field="footer_scripts" from="new LinkedHashSet()"/><set field="html_stylesheets" from="new LinkedHashSet()"/><!--always-actions at component://PopCommerce/screen/PopCommerceAdmin.xml--><set field="appRoot" value="PopcAdmin"/><set field="searchIndexName" value="mantle"/><set field="searchLinkSets" value="PopcAdmin"/><set field="searchProductDocType" value="MantleProduct"/><set field="searchPartyDocType" value="MantleParty"/><set field="appUserGroupTypeEnumId" value="UgtPopcAdmin"/><service-call name="mantle.party.PartyServices.setup#UserOrganizationInfo" out-map="context"/><!--transition actions--><if condition="!shipmentId || !shipmentPackageSeqId || !shipmentRouteSegmentSeqId"><script><![CDATA[ec.web.sendError(404, 'ID not specified', null)]]></script><return/></if><entity-find-one entity-name="mantle.shipment.ShipmentPackageRouteSeg" value-field="sprs"/><if condition="retLabel == 'true'"><then><if condition="intlInvoiceLabel == 'true'"><then><if condition="sprs?.returnIntlInvoiceUrl"><then><script><![CDATA[ec.web.sendResourceResponse(sprs.returnIntlInvoiceUrl)]]></script></then><else><script><![CDATA[ec.web.sendError(404, 'No returnIntlInvoiceUrl', null)]]></script></else></if></then><else><if condition="sprs?.returnLabelUrl"><then><script><![CDATA[ec.web.sendResourceResponse(sprs.returnLabelUrl)]]></script></then><else-if condition="sprs?.returnLabelImage"><script><![CDATA[byte[] returnLabelImage = sprs.getBytes("returnLabelImage")
                            ec.web.response.setHeader("Content-Disposition", "inline")
                            OutputStream os = ec.web.response.outputStream
                            try { os.write(returnLabelImage) } finally { os.close() }]]></script></else-if><else><script><![CDATA[ec.web.sendError(404, 'No returnLabelUrl or returnLabelImage', null)]]></script></else></if></else></if></then><else><if condition="intlInvoiceLabel == 'true'"><then><if condition="sprs?.internationalInvoiceUrl"><then><script><![CDATA[ec.web.sendResourceResponse(sprs.internationalInvoiceUrl)]]></script></then><else-if condition="sprs?.internationalInvoice"><script><![CDATA[byte[] internationalInvoice = sprs.getBytes("internationalInvoice")
                            // handle content type somehow, really needed? ec.web.response.setContentType("application/pdf")
                            ec.web.response.setHeader("Content-Disposition", "inline")
                            OutputStream os = ec.web.response.outputStream
                            try { os.write(internationalInvoice) } finally { os.close() }]]></script></else-if><else><script><![CDATA[ec.web.sendError(404, 'No internationalInvoiceUrl or internationalInvoice', null)]]></script></else></if></then><else><if condition="sprs?.labelUrl"><then><script><![CDATA[ec.web.sendResourceResponse(sprs.labelUrl)]]></script></then><else-if condition="sprs?.labelImage"><script><![CDATA[byte[] labelImage = sprs.getBytes("labelImage")
                            // handle content type somehow, really needed? ec.web.response.setContentType("application/pdf")
                            ec.web.response.setHeader("Content-Disposition", "inline")
                            OutputStream os = ec.web.response.outputStream
                            try { os.write(labelImage) } finally { os.close() }]]></script></else-if><else><script><![CDATA[ec.web.sendError(404, 'No labelUrl or labelImage', null)]]></script></else></if></else></if></else></if></actions></transition>