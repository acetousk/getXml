<!--Transition Screen Location component://SimpleScreens/screen/SimpleScreens/Wiki/WikiBlogs.xml Transition Name getSpacePages--><transition name="getSpacePages"><parameter name="wikiSpaceId"/><parameter name="term"/><parameter name="currentPagePath"/><parameter name="valueUsePath"/><parameter name="includeRoot"/><actions><!--always-actions at component://webroot/screen/webroot.xml--><set field="html_scripts" from="new LinkedHashSet()"/><set field="footer_scripts" from="new LinkedHashSet()"/><set field="html_stylesheets" from="new LinkedHashSet()"/><!--transition actions--><set field="pageIndex" from="pageIndex ?: 0"/><set field="pageSize" from="pageSize ?: 20"/><set field="term" from="term ?: ''"/><set field="valueUsePathBool" from="valueUsePath == 'true'"/><entity-find-one entity-name="moqui.resource.wiki.WikiPage" value-field="wikiPage"><field-map field-name="wikiPageId" from="term"/></entity-find-one><if condition="wikiPage == null"><entity-find entity-name="moqui.resource.wiki.WikiPage" list="byPathPageList"><econdition field-name="wikiSpaceId"/><econdition field-name="pagePath" from="term"/></entity-find><if condition="byPathPageList"><set field="wikiPage" from="byPathPageList[0]"/></if></if><if condition="wikiPage != null"><then><set field="wikiPageList" from="[wikiPage]"/></then><else><entity-find entity-name="moqui.resource.wiki.WikiPage" list="wikiPageList"><search-form-inputs default-order-by="pagePath"/><econdition field-name="wikiSpaceId"/><econdition field-name="pagePath" operator="like" value="%${term}%" ignore="!term"/><econdition field-name="pagePath" operator="not-like" value="${currentPagePath}%" ignore="!currentPagePath"/></entity-find></else></if><script><![CDATA[def outList = []
                if (wikiPage == null && wikiPageList && includeRoot == 'true') outList.add([value:wikiSpaceId, label:'Root Page'])
                for (wikiPage in wikiPageList) outList.add([value:(valueUsePathBool ? wikiPage.pagePath : wikiPage.wikiPageId), label:wikiPage.pagePath])
                ec.web.sendJsonResponse([options:outList, pageSize:pageSize, count:(wikiPageListCount?:wikiPageList.size())])
                // ec.logger.warn("term ${term} outList ${outList}")]]></script></actions></transition>