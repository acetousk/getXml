<!--Transition Screen Location component://coarchy/screen/coarchy/cointernal/Products/EditProductEval/EvalResponse.xml Transition Name actions--><transition name="actions"><parameter name="productEvaluationId" required="true"/><parameter name="activityId"/><parameter name="valueStatementId "/><parameter name="processStoryIds "/><parameter name="typeEnumIds"/><parameter name="pageIndex"/><parameter name="pageSize"/><parameter name="orderByField"/><actions><!--always-actions at component://webroot/screen/webroot.xml--><set field="html_scripts" from="new LinkedHashSet()"/><set field="footer_scripts" from="new LinkedHashSet()"/><set field="html_stylesheets" from="new LinkedHashSet()"/><!--always-actions at component://coarchy/screen/vendor/vendorinternal.xml--><service-call name="mantle.party.PartyServices.setup#UserVendorOrganizationInfo" out-map="context"/><if condition="activeOrgId"><entity-find-one entity-name="mantle.party.Organization" value-field="organization" auto-field-map="[partyId:activeOrgId]"/><set field="organizationName" from="organization?.organizationName"/></if><script><![CDATA[context.isVendorView = true]]></script><!--always-actions at component://coarchy/screen/coarchy/cointernal/Products/EditProductEval.xml--><if condition="!activeOrgId"><message><![CDATA[${ec.resource.expand('CoarchySelectAnOrg', null)}]]></message><script><![CDATA[sri.sendRedirectAndStopRender('/settings/Organizations')]]></script></if><entity-find-count entity-name="mantle.party.PartyRelationship" count-field="partyRelationshipCount"><date-filter/><econdition field-name="relationshipTypeEnumId" value="PrtMember"/><econdition field-name="toRoleTypeId" value="OrgInternal"/><econdition field-name="fromPartyId" from="ec.user.userAccount.partyId"/><econdition field-name="toPartyId" from="activeOrgId"/></entity-find-count><entity-find-count entity-name="mantle.party.PartyActivation" count-field="partyActivationCount"><date-filter/><econdition field-name="partyId" from="activeOrgId"/></entity-find-count><entity-find-one entity-name="coarchy.product.ProductEvaluation" value-field="productEvaluation"/><if condition="!productEvaluation"><if condition="isVendorView"><script><![CDATA[sri.sendRedirectAndStopRender('/vendor')]]></script><else><script><![CDATA[sri.sendRedirectAndStopRender('/settings/Organizations')]]></script></else></if></if><set field="statusId" from="productEvaluation?.statusId"/><if condition="isVendorView && ['PeRequirementsSelection','PeInviteVendors'].contains(statusId)"><return error="true" message="Not allowed"/></if><set field="showReponseListButton" from="['PeAwaitingVendorResponse','PeCompleted','PeCancelled'].contains(statusId)"/><set field="showVendorRespondButton" from="isVendorView && (statusId == 'PeAwaitingVendorResponse')"/><set field="showInternalRespondButton" from="!isVendorView && (statusId == 'PeAwaitingVendorResponse')"/><entity-find entity-name="coarchy.product.ProductEvaluationParty" list="vendorRepList"><date-filter/><econdition field-name="productEvaluationId"/><econdition field-name="roleTypeId" value="VendorRepresentative"/></entity-find><set field="canInviteVendors" from="['PeRequirementsSelection','PeInviteVendors','PeAwaitingVendorResponse'].contains(statusId)"/><set field="showInviteVendorsSection" from="['PeInviteVendors','PeAwaitingVendorResponse','PeCompleted','PeCancelled'].contains(statusId)"/><service-call name="coarchy.ProductEvaluationServices.get#ProductEvaluationCompleteWarnings" in-map="[productEvaluationId:productEvaluationId]" out-map="context"/><!--actions--><entity-find-one entity-name="coarchy.product.ProductEvaluation" value-field="productEvaluation"/><entity-find-count entity-name="mantle.party.PartyRelationship" count-field="partyRelationshipCount"><date-filter/><econdition field-name="relationshipTypeEnumId" value="PrtMember"/><econdition field-name="toRoleTypeId" value="OrgInternal"/><econdition field-name="fromPartyId" from="ec.user.userAccount.partyId"/><econdition field-name="toPartyId" from="productEvaluation.organizationId"/></entity-find-count><set field="isUserInternalOrgMember" from="partyRelationshipCount > 0"/><if condition="valueStatementId"><entity-find-one entity-name="coarchy.ValueStatement" value-field="valueStatement"><field-map field-name="valueStatementId"/></entity-find-one></if><if condition="activityId"><entity-find-one entity-name="coarchy.Activity" value-field="activity"><field-map field-name="activityId"/></entity-find-one><set field="activityActorList" from="[]"/><entity-find entity-name="coarchy.ActivityActorDetail" list="activityActorList"><econdition field-name="activityId"/><order-by field-name="name"/></entity-find><set field="actorIdList" from="activityActorList*.actorId"/><set field="actors" from="activityActorList*.name?.join(', ')"/><set field="processStoryActivity" from="[condition:activity.condition,action:activity.action,actorNames:activityActorList*.name]"/><set field="activity" from="ec.resource.template('component://coarchy/template/ActivityStyled.html.ftl', '.ftl')"/></if><entity-find entity-name="coarchy.product.ProductEvaluationResponse" list="productEvaluationResponseList"><econdition field-name="productEvaluationId"/><econdition field-name="activityId" ignore="!activityId"/><econdition field-name="statementId" from="valueStatementId" ignore="!valueStatementId"/><econdition field-name="evaluationByEnumId" value="EbInternal" ignore="isVendorView"/><econdition field-name="evaluationByEnumId" value="EbVendor" ignore="!isVendorView"/><econdition field-name="evaluationByEnumId" operator="not-equals" value="EbInternal" ignore="isUserInternalOrgMember"/></entity-find><if condition="productEvaluationResponseList.size() > 0"><set field="productEvaluationResponse" from="productEvaluationResponseList[0]"/></if><if condition="activityId"><entity-find entity-name="coarchy.ValueStatementActivityDetail" list="valueStatementActivityList"><econditions><econdition field-name="fromDate" operator="less-equals" from="productEvaluation.requirementsSetDate" or-null="true"/><econdition field-name="thruDate" operator="greater-equals" from="productEvaluation.requirementsSetDate" or-null="true"/></econditions><date-filter valid-date="productEvaluation.requirementsSetDate"/><econdition field-name="activityId"/><select-field field-name="activityId,value,typeEnumId"/></entity-find></if></actions></transition>