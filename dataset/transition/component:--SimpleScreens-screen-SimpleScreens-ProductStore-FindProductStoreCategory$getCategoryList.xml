<!--Transition Screen Location component://SimpleScreens/screen/SimpleScreens/ProductStore/FindProductStoreCategory.xml Transition Name getCategoryList--><transition name="getCategoryList"><parameter name="productStoreId" required="true"/><parameter name="term"/><parameter name="productCategoryTypeEnumId"/><actions><!--always-actions at component://webroot/screen/webroot.xml--><set field="html_scripts" from="new LinkedHashSet()"/><set field="footer_scripts" from="new LinkedHashSet()"/><set field="html_stylesheets" from="new LinkedHashSet()"/><!--always-actions at component://PopCommerce/screen/PopCommerceAdmin.xml--><set field="appRoot" value="PopcAdmin"/><set field="searchIndexName" value="mantle"/><set field="searchLinkSets" value="PopcAdmin"/><set field="searchProductDocType" value="MantleProduct"/><set field="searchPartyDocType" value="MantleParty"/><set field="appUserGroupTypeEnumId" value="UgtPopcAdmin"/><service-call name="mantle.party.PartyServices.setup#UserOrganizationInfo" out-map="context"/><!--transition actions--><entity-find-one entity-name="mantle.product.category.ProductCategoryAndType" value-field="productCategory"><field-map field-name="productCategoryId" from="term"/></entity-find-one><if condition="productCategory != null"><then><script><![CDATA[def outList = [[value:productCategory.productCategoryId, label:ec.resource.expand('ProductCategoryNameTemplate','',productCategory)]]
                    ec.web.sendJsonResponse(outList)]]></script></then><else><entity-find entity-name="mantle.product.category.ProductCategoryAndType" list="productCategoryList" limit="40"><econdition field-name="productCategoryTypeEnumId" ignore-if-empty="true"/><econditions combine="or"><econdition field-name="productCategoryId" operator="like" value="%${term}%"/><econdition field-name="pseudoId" operator="like" value="%${term}%" ignore-case="true"/><econdition field-name="categoryName" operator="like" value="%${term}%" ignore-case="true"/><econdition field-name="description" operator="like" value="%${term}%" ignore-case="true"/></econditions><select-field field-name="productCategoryId,productCategoryTypeEnumId,typeDescription,pseudoId,categoryName"/><order-by field-name="typeDescription,pseudoId,categoryName"/></entity-find><script><![CDATA[def outList = []
                    for (productCategory in productCategoryList)
                        outList.add([value:productCategory.productCategoryId, label:ec.resource.expand('ProductCategoryNameTemplate','',productCategory)])
                    ec.web.sendJsonResponse(outList)]]></script></else></if></actions></transition>