<!--Transition Screen Location component://SimpleScreens/screen/SimpleScreens/Catalog/Search.xml Transition Name actions--><transition name="actions"><parameter name="queryString"/><parameter name="term"/><parameter name="productFeatureTypeEnumId"/><parameter name="term"/><parameter name="productCategoryTypeEnumId"/><actions><!--always-actions at component://webroot/screen/webroot.xml--><set field="html_scripts" from="new LinkedHashSet()"/><set field="footer_scripts" from="new LinkedHashSet()"/><set field="html_stylesheets" from="new LinkedHashSet()"/><!--always-actions at component://PopCommerce/screen/PopCommerceAdmin.xml--><set field="appRoot" value="PopcAdmin"/><set field="searchIndexName" value="mantle"/><set field="searchLinkSets" value="PopcAdmin"/><set field="searchProductDocType" value="MantleProduct"/><set field="searchPartyDocType" value="MantleParty"/><set field="appUserGroupTypeEnumId" value="UgtPopcAdmin"/><service-call name="mantle.party.PartyServices.setup#UserOrganizationInfo" out-map="context"/><!--actions--><set field="pageSize" from="pageSize ?: 50"/><set field="indexName" from="searchIndexName ?: 'mantle'"/><set field="documentType" from="searchProductDocType ?: 'MantleProduct'"/><set field="originalQueryString" from="queryString"/><set field="queryString" from="queryString ? elasticQueryAutoWildcard(queryString, false) : ''"/><if condition="pseudoId"><set field="queryString" from="(queryString ? queryString + ' AND ' : '' ) + 'pseudoId:' + pseudoId"/></if><if condition="name"><set field="queryString" from="(queryString ? queryString + ' AND ' : '' ) + 'name:\"' + name + '*\"'"/></if><if condition="idValue"><set field="queryString" from="(queryString ? queryString + ' AND ' : '' ) + 'idValue:' + idValue"/></if><if condition="productTypeEnumId"><set field="queryString" from="(queryString ? queryString + ' AND ' : '' ) + 'productTypeEnumId:' + productTypeEnumId"/></if><if condition="assetTypeEnumId"><set field="queryString" from="(queryString ? queryString + ' AND ' : '' ) + 'assetTypeEnumId:' + assetTypeEnumId"/></if><if condition="assetClassEnumId"><set field="queryString" from="(queryString ? queryString + ' AND ' : '' ) + 'assetClassEnumId:' + assetClassEnumId"/></if><if condition="amountUomId"><set field="queryString" from="(queryString ? queryString + ' AND ' : '' ) + 'amountUomId:' + amountUomId"/></if><if condition="ownerPartyId"><set field="queryString" from="(queryString ? queryString + ' AND ' : '' ) + 'ownerPartyId:' + ownerPartyId"/></if><if condition="productFeatureId"><set field="queryString" from="(queryString ? queryString + ' AND ' : '' ) + 'features.productFeatureId:' + productFeatureId"/></if><if condition="productFeatureId2"><set field="queryString" from="(queryString ? queryString + ' AND ' : '' ) + 'features.productFeatureId:' + productFeatureId2"/></if><if condition="productCategoryId"><set field="queryString" from="(queryString ? queryString + ' AND ' : '' ) + 'categories.productCategoryId:' + productCategoryId"/></if><set field="activeOrgId" from="ec.user.context?.activeOrgId"/><set field="filterOrgIds" from="ec.user.context?.filterOrgIds"/><set field="findFilters" from="ec.artifactExecution.getFindFiltersForUser('mantle.product.Product')"/><if condition="findFilters"><set field="entityFilterSetId" from="findFilters[0].entityFilterSetId"/></if><script><![CDATA[if ('MANTLE_USER_ORG'.equals(entityFilterSetId)) {
                queryString = (queryString ? queryString + ' AND ' : '' ) + 'ownerPartyId:(' + filterOrgIds.join(' OR ') + ')'
            } else if ('MANTLE_ACTIVE_ORG'.equals(entityFilterSetId) && activeOrgId) {
                queryString = (queryString ? queryString + ' AND ' : '' ) + 'ownerPartyId:(' + activeOrgId + ' OR _NA_)'
            }]]></script><if condition="orderByField"><set field="orderByFields" from="[orderByField]"/></if><if condition="queryString"><service-call name="org.moqui.search.SearchServices.search#DataDocuments" out-map="context" in-map="context + [indexName:indexName, documentType:documentType]"/></if><set field="productIds" from="documentList ? documentList*._id : null"/><entity-find entity-name="mantle.product.Product" list="amountUomList" distinct="true"><select-field field-name="amountUomId"/></entity-find><set field="amountUomIds" from="amountUomList.amountUomId"/></actions></transition>