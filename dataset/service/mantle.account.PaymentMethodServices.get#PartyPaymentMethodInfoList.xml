<!--Service Location mantle.account.PaymentMethodServices.get#PartyPaymentMethodInfoList--><service verb="get" noun="PartyPaymentMethodInfoList"><in-parameters><parameter name="partyId" required="true"/><parameter name="paymentMethodTypeEnumId"/></in-parameters><out-parameters><parameter name="methodInfoList" type="List"><parameter name="infoMap" type="Map"><parameter name="paymentMethodId"/><parameter name="paymentMethodTypeEnumId"/><parameter name="paymentMethod" type="Map"/><parameter name="bankAccount" type="Map"/><parameter name="bankAccountTypeEnum" type="Map"/><parameter name="isBankAccount" type="Boolean"/><parameter name="creditCard" type="Map"/><parameter name="creditCardTypeEnum" type="Map"/><parameter name="expireMonth"/><parameter name="expireYear"/><parameter name="maskedCardNumber"/><parameter name="isCreditCard" type="Boolean"/><parameter name="postalContactMechId"/><parameter name="postalAddress" type="Map"/><parameter name="postalAddressStateGeo" type="Map"/><parameter name="telecomContactMechId"/><parameter name="telecomNumber" type="Map"/><parameter name="emailContactMechId"/><parameter name="emailAddress"/></parameter></parameter></out-parameters><actions><entity-find entity-name="PaymentMethod" list="paymentMethodList"><date-filter/><econdition field-name="ownerPartyId" from="partyId"/><econdition field-name="paymentMethodTypeEnumId" ignore-if-empty="true"/><order-by field-name="-fromDate"/></entity-find><set field="methodInfoList" from="[]"/><iterate list="paymentMethodList" entry="paymentMethod"><set field="infoMap" from="[paymentMethodId:paymentMethod.paymentMethodId, paymentMethod:paymentMethod,                         paymentMethodTypeEnumId:paymentMethod.paymentMethodTypeEnumId]"/><set field="infoMap.bankAccount" from="paymentMethod.'mantle.account.method.BankAccount'"/><set field="infoMap.bankAccountTypeEnum" from="infoMap.bankAccount?.'BankAccountType#moqui.basic.Enumeration'"/><set field="infoMap.isBankAccount" from="paymentMethod.paymentMethodTypeEnumId == 'PmtBankAccount'"/><set field="creditCard" from="paymentMethod.'mantle.account.method.CreditCard'"/><set field="infoMap.creditCard" from="creditCard"/><set field="infoMap.creditCardTypeEnum" from="creditCard?.'CreditCardType#moqui.basic.Enumeration'"/><set field="infoMap.expireMonth" from="creditCard?.expireDate ? creditCard.expireDate.substring(0, creditCard.expireDate.indexOf('/')) : null"/><set field="infoMap.expireYear" from="creditCard?.expireDate ? creditCard.expireDate.substring(creditCard.expireDate.indexOf('/')+1) : null"/><set field="cardNumber" from="creditCard?.cardNumber"/><set field="infoMap.maskedCardNumber" from="cardNumber ? '*'.padRight(cardNumber.length() - 4, '*') + cardNumber.substring(cardNumber.length() - 4, cardNumber.length()) : ''"/><set field="infoMap.isCreditCard" from="paymentMethod.paymentMethodTypeEnumId == 'PmtCreditCard'"/><set field="infoMap.postalAddress" from="paymentMethod.'mantle.party.contact.PostalAddress'"/><set field="infoMap.postalAddressStateGeo" from="infoMap.postalAddress?.'StateProvince#moqui.basic.Geo'"/><set field="infoMap.postalContactMechId" from="paymentMethod.postalContactMechId"/><set field="infoMap.telecomNumber" from="paymentMethod.'mantle.party.contact.TelecomNumber'"/><set field="infoMap.telecomContactMechId" from="paymentMethod.telecomContactMechId"/><set field="infoMap.emailContactMech" from="paymentMethod.'Email#mantle.party.contact.ContactMech'"/><set field="infoMap.emailContactMechId" from="paymentMethod.emailContactMechId"/><set field="infoMap.emailAddress" from="infoMap.emailContactMech?.infoString"/><script><![CDATA[methodInfoList.add(infoMap)]]></script></iterate></actions></service>