<!--Service Location mantle.account.InvoiceServices.create#ProjectExpenseInvoice--><service verb="create" noun="ProjectExpenseInvoice"><in-parameters><parameter name="invoiceTypeEnumId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.account.invoice.Invoice" field-name="invoiceTypeEnumId" default-value="InvoiceSales"/><parameter name="fromPartyId" type="java.lang.String" required="true" allow-html="none" entity-name="mantle.account.invoice.Invoice" field-name="fromPartyId"/><parameter name="toPartyId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.account.invoice.Invoice" field-name="toPartyId"/><parameter name="statusId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.account.invoice.Invoice" field-name="statusId"/><parameter name="billingAccountId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.account.invoice.Invoice" field-name="billingAccountId"/><parameter name="invoiceDate" type="Timestamp" required="false" allow-html="none" entity-name="mantle.account.invoice.Invoice" field-name="invoiceDate" default="ec.user.nowTimestamp"/><parameter name="dueDate" type="java.sql.Timestamp" required="false" allow-html="none" entity-name="mantle.account.invoice.Invoice" field-name="dueDate"/><parameter name="settlementTermId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.account.invoice.Invoice" field-name="settlementTermId"/><parameter name="paidDate" type="java.sql.Timestamp" required="false" allow-html="none" entity-name="mantle.account.invoice.Invoice" field-name="paidDate"/><parameter name="invoiceMessage" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.account.invoice.Invoice" field-name="invoiceMessage"/><parameter name="referenceNumber" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.account.invoice.Invoice" field-name="referenceNumber"/><parameter name="otherPartyOrderId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.account.invoice.Invoice" field-name="otherPartyOrderId"/><parameter name="description" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.account.invoice.Invoice" field-name="description"/><parameter name="currencyUomId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.account.invoice.Invoice" field-name="currencyUomId"/><parameter name="overrideOrgPartyId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.account.invoice.Invoice" field-name="overrideOrgPartyId"/><parameter name="productStoreId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.account.invoice.Invoice" field-name="productStoreId"/><parameter name="partyRelationshipId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.account.invoice.Invoice" field-name="partyRelationshipId"/><parameter name="timePeriodId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.account.invoice.Invoice" field-name="timePeriodId"/><parameter name="acctgTransResultEnumId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.account.invoice.Invoice" field-name="acctgTransResultEnumId"/><parameter name="systemMessageRemoteId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.account.invoice.Invoice" field-name="systemMessageRemoteId"/><parameter name="externalId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.account.invoice.Invoice" field-name="externalId"/><parameter name="originId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.account.invoice.Invoice" field-name="originId"/><parameter name="invoiceTotal" type="java.math.BigDecimal" required="false" allow-html="none" entity-name="mantle.account.invoice.Invoice" field-name="invoiceTotal"/><parameter name="appliedPaymentsTotal" type="java.math.BigDecimal" required="false" allow-html="none" entity-name="mantle.account.invoice.Invoice" field-name="appliedPaymentsTotal"/><parameter name="unpaidTotal" type="java.math.BigDecimal" required="false" allow-html="none" entity-name="mantle.account.invoice.Invoice" field-name="unpaidTotal"/><parameter name="lastUpdatedStamp" type="java.sql.Timestamp" required="false" allow-html="none" entity-name="mantle.account.invoice.Invoice" field-name="lastUpdatedStamp"/><parameter name="workEffortId"/></in-parameters><out-parameters><parameter name="invoiceId"/></out-parameters><actions><if condition="!workEffortId && !toPartyId"><return error="true" message="Must specify either Project (workEffortId) or To Party (toPartyId)"/></if><if condition="!toPartyId"><entity-find entity-name="mantle.work.effort.WorkEffortParty" list="vendorWepList"><date-filter/><econdition field-name="workEffortId"/><econdition field-name="roleTypeId" operator="in" value="Vendor,VendorBillFrom"/></entity-find><set field="vendorWep" from="vendorWepList?.first"/><set field="toPartyId" from="vendorWep.partyId"/></if><service-call name="mantle.account.InvoiceServices.create#Invoice" in-map="context" out-map="[invoiceId:context.invoiceId]"/><if condition="workEffortId"><service-call name="create#mantle.work.effort.WorkEffortInvoice" in-map="context" out-map="[invoiceId:context.invoiceId,workEffortId:context.workEffortId,lastUpdatedStamp:context.lastUpdatedStamp]"/></if></actions></service>