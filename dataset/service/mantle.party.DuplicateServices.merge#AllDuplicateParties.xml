<!--Service Location mantle.party.DuplicateServices.merge#AllDuplicateParties--><service verb="merge" noun="AllDuplicateParties"><in-parameters/><out-parameters/><actions><entity-find entity-name="mantle.party.Party" list="partyList" limit="100"><econdition field-name="disabled" value="N" or-null="true"/><econdition field-name="hasDuplicates" value="Y"/></entity-find><iterate list="partyList" entry="party"><script><![CDATA[party.refresh()]]></script><if condition="party.mergedToPartyId || party.disabled == 'Y'"><continue/></if><service-call name="mantle.party.DuplicateServices.find#PartyDuplicates" in-map="[partyId:party.partyId]" out-map="[matchingInfoByPartyId:dupOut.matchingInfoByPartyId]" out-map-add-to-existing="false"/><if condition="dupOut?.matchingInfoByPartyId"><iterate list="dupOut.matchingInfoByPartyId.keySet()" entry="dupPartyId"><service-call name="mantle.party.DuplicateServices.merge#Parties" in-map="[toPartyId:party.partyId, fromPartyId:dupPartyId]"/></iterate></if></iterate></actions></service>