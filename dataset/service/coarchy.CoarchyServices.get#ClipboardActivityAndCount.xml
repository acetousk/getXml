<!--Service Location coarchy.CoarchyServices.get#ClipboardActivityAndCount--><service verb="get" noun="ClipboardActivityAndCount"><in-parameters><parameter name="clipboardEntryId" required="true"/></in-parameters><out-parameters><parameter name="activityText"/><parameter name="activityCount"/></out-parameters><actions><entity-find-one entity-name="coarchy.ClipboardEntry" value-field="clipboardEntry" auto-field-map="[clipboardEntryId:clipboardEntryId,partyId:ec.user.userAccount.partyId]"/><if condition="clipboardEntry==null"><return type="danger" error="true" message="${ec.resource.expand('CoarchyProcessClipboardEmpty', null)}"/></if><entity-find entity-name="coarchy.ClipboardActivity" list="activityList" limit="1"><econdition field-name="clipboardEntryId"/></entity-find><if condition="activityList.size() == 0"><return type="danger" error="true" message="${ec.resource.expand('CoarchyProcessClipboardActivityEmpty', null)}"/></if><set field="processStoryActivity" from="activityList.getFirst().getMap()"/><if condition="processStoryActivity.action"><then><entity-find entity-name="coarchy.ClipboardActor" list="actorList"><econdition field-name="clipboardEntryId"/><econdition field-name="activitySeqId" from="processStoryActivity.activitySeqId"/><order-by field-name="name"/></entity-find><set field="processStoryActivity" from="processStoryActivity + [actorNames:actorList*.name]"/><set field="activityText" from="ec.resource.template('component://coarchy/template/Activity.html.ftl', '.ftl')"/></then><else><set field="activityText" value="⏎ Paragraph"/></else></if><entity-find-count entity-name="coarchy.ClipboardActivity" count-field="activityCount"><econdition field-name="clipboardEntryId"/></entity-find-count></actions></service>