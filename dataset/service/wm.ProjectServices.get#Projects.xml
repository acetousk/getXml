<!--Service Location wm.ProjectServices.get#Projects--><service verb="get" noun="Projects"><in-parameters><parameter name="partyId"/><parameter name="roleTypeId"/><parameter name="statusId"/><parameter name="pageOffset" default-value="" type="Integer"/><parameter name="pageLimit" default-value="" type="Integer"/><parameter name="orderByField" default-value="-workEffortId"/></in-parameters><out-parameters><parameter name="projectList" type="List"/><parameter name="count" type="Integer"/></out-parameters><actions><entity-find-count entity-name="mantle.work.effort.WorkEffortAndParty" count-field="count" distinct="true"><econdition field-name="partyId" ignore-if-empty="true"/><econdition field-name="roleTypeId" ignore-if-empty="true"/><date-filter/><econdition field-name="workEffortTypeEnumId" value="WetProject"/><econdition field-name="statusId" operator="in" from="statusId" ignore-if-empty="true"/><econditions combine="or"><econditions><date-filter/><econdition field-name="partyId" from="ec.user.userAccount.partyId"/></econditions><econdition field-name="visibilityEnumId" operator="in" value="WevAllUsers"/></econditions><select-field field-name="workEffortId,workEffortName,statusId,estimatedCompletionDate"/></entity-find-count><entity-find offset="pageOffset" limit="pageLimit" entity-name="mantle.work.effort.WorkEffortAndParty" list="weapList" distinct="true"><econdition field-name="partyId" ignore-if-empty="true"/><econdition field-name="roleTypeId" ignore-if-empty="true"/><date-filter/><econdition field-name="workEffortTypeEnumId" value="WetProject"/><econdition field-name="statusId" operator="in" from="statusId" ignore-if-empty="true"/><econditions combine="or"><econditions><date-filter/><econdition field-name="partyId" from="ec.user.userAccount.partyId"/></econditions><econdition field-name="visibilityEnumId" operator="in" value="WevAllUsers"/></econditions><select-field field-name="workEffortId,workEffortName,statusId,estimatedCompletionDate"/><order-by field-name="${orderByField}"/></entity-find><set field="projectList" from="[]"/><if condition="weapList"><iterate list="weapList" entry="weap"><set field="project" from="new HashMap()"/><script><![CDATA[project.putAll(weap)
                        projectList.add(project)]]></script><entity-find entity-name="mantle.work.effort.WorkEffortParty" list="managerList"><econdition field-name="workEffortId" from="weap.workEffortId"/><econdition field-name="roleTypeId" value="Manager"/><date-filter/></entity-find><if condition="managerList"><set field="managerPartyId" from="managerList[0].partyId"/><script><![CDATA[project.put("managerPartyId",managerPartyId)]]></script><entity-find-one entity-name="mantle.party.PartyDetail" value-field="partyDetail"><field-map field-name="partyId" from="managerPartyId"/></entity-find-one><if condition="partyDetail"><set field="managerFirstName" from="partyDetail.firstName"/><set field="managerLastName" from="partyDetail.lastName"/><script><![CDATA[project.put("managerFirstName",managerFirstName)
                                project.put("managerLastName",managerLastName)]]></script></if></if></iterate></if></actions></service>