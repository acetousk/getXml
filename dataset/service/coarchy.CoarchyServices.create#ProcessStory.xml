<!--Service Location coarchy.CoarchyServices.create#ProcessStory--><service verb="create" noun="ProcessStory"><in-parameters><parameter name="name" required="true" entity-name="coarchy.ProcessStory" field-name="name"/><parameter name="organizationId" required="true" entity-name="coarchy.ProcessStory" field-name="organizationId"/></in-parameters><out-parameters><parameter name="processStoryId" entity-name="coarchy.ProcessStory" field-name="processStoryId"/></out-parameters><actions><set field="name" from="name?.trim()"/><entity-find entity-name="coarchy.ProcessStory" list="processStoryList" limit="20"><econdition field-name="name" ignore-case="true"/><order-by field-name="^name"/></entity-find><if condition="processStoryList?.size() > 0"><return type="danger" error="true" message="${ec.resource.expand('CoarchyProcessStoryNameExists', null, [name:processStoryList?.getFirst()?.name])}"/></if><service-call name="create#coarchy.ProcessStory" in-map="[name:name,organizationId:organizationId]" out-map="[processStoryId:context.processStoryId,name:context.name,disabled:context.disabled,organizationId:context.organizationId,lastUpdatedStamp:context.lastUpdatedStamp]"/></actions></service>