<!--Service Location mantle.account.FinancialAccountServices.getOrCreate#FinancialAccount--><service verb="getOrCreate" noun="FinancialAccount"><in-parameters><parameter name="finAccountTypeId" required="true" entity-name="mantle.account.financial.FinancialAccount" field-name="finAccountTypeId"/><parameter name="organizationPartyId" required="true" entity-name="mantle.account.financial.FinancialAccount" field-name="organizationPartyId"/><parameter name="ownerPartyId" required="true" entity-name="mantle.account.financial.FinancialAccount" field-name="ownerPartyId"/></in-parameters><out-parameters><parameter name="finAccountId" entity-name="mantle.account.financial.FinancialAccount" field-name="finAccountId"/></out-parameters><actions><entity-find entity-name="mantle.account.financial.FinancialAccount" list="finAccountList"><econdition field-name="ownerPartyId"/><econdition field-name="finAccountTypeId"/></entity-find><if condition="finAccountList"><then><set field="finAccountId" from="finAccountList[0].finAccountId"/></then><else><entity-find-one entity-name="mantle.account.financial.FinancialAccountType" value-field="financialAccountType"/><entity-find-one entity-name="mantle.party.PartyDetail" value-field="owner"><field-map field-name="partyId" from="ownerPartyId"/></entity-find-one><set field="finAccountName" value="${owner.organizationName?:''}${owner.firstName?:''}${owner.lastName ? ' ' + owner.lastName : ''} ${financialAccountType.description}"/><service-call name="mantle.account.FinancialAccountServices.create#FinancialAccount" in-map="context" out-map="[finAccountId:context.finAccountId]"/></else></if></actions></service>