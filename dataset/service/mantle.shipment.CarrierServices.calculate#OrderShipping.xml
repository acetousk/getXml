<!--Service Location mantle.shipment.CarrierServices.calculate#OrderShipping--><service verb="calculate" noun="OrderShipping"><in-parameters><parameter name="orderId" required="true"/><parameter name="shippingGatewayConfigId"><description><![CDATA[Optional if OrderHeader.productStoreId is populated
                and a corresponding ProductStoreShippingGateway record exists.]]></description></parameter><parameter name="createOrderItem" type="Boolean" default="true"/><parameter name="shipmentMethodEnumId"><description><![CDATA[Overrides the OrderPart.shipmentMethodEnumId if specified.]]></description></parameter><parameter name="carrierPartyId"><description><![CDATA[Overrides the OrderPart.carrierPartyId if specified.]]></description></parameter><parameter name="postalContactMechId"><description><![CDATA[Overrides the OrderPart.postalContactMechId if specified.]]></description></parameter></in-parameters><out-parameters><parameter name="shippingTotal" required="true"/></out-parameters><actions><entity-find entity-name="mantle.order.OrderPart" list="orderPartList"><econdition field-name="orderId"/></entity-find><set field="shippingTotal" from="0" type="BigDecimal"/><iterate list="orderPartList" entry="orderPart"><service-call name="mantle.shipment.CarrierServices.calculate#OrderPartShipping" in-map="context + [orderPartSeqId:orderPart.orderPartSeqId]" out-map="[shippingTotal:copsOut.shippingTotal,orderItemSeqId:copsOut.orderItemSeqId]"/><set field="shippingTotal" from="shippingTotal + (copsOut.shippingTotal ?: 0)"/></iterate></actions></service>