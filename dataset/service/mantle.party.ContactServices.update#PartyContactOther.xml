<!--Service Location mantle.party.ContactServices.update#PartyContactOther--><service verb="update" noun="PartyContactOther"><in-parameters><parameter name="infoString" required="true"/><parameter name="thruDate" type="java.sql.Timestamp" required="false" allow-html="none" entity-name="mantle.party.contact.PartyContactMech" field-name="thruDate"/><parameter name="extension" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.party.contact.PartyContactMech" field-name="extension"/><parameter name="comments" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.party.contact.PartyContactMech" field-name="comments"/><parameter name="allowSolicitation" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.party.contact.PartyContactMech" field-name="allowSolicitation"/><parameter name="usedSince" type="java.sql.Date" required="false" allow-html="none" entity-name="mantle.party.contact.PartyContactMech" field-name="usedSince"/><parameter name="usedUntil" type="java.sql.Date" required="false" allow-html="none" entity-name="mantle.party.contact.PartyContactMech" field-name="usedUntil"/><parameter name="verifyCode" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.party.contact.PartyContactMech" field-name="verifyCode"/><parameter name="verifyCodeDate" type="java.sql.Timestamp" required="false" allow-html="none" entity-name="mantle.party.contact.PartyContactMech" field-name="verifyCodeDate"/><parameter name="verifyCodeAttempts" type="java.lang.Long" required="false" allow-html="none" entity-name="mantle.party.contact.PartyContactMech" field-name="verifyCodeAttempts"/><parameter name="lastUpdatedStamp" type="java.sql.Timestamp" required="false" allow-html="none" entity-name="mantle.party.contact.PartyContactMech" field-name="lastUpdatedStamp"/><parameter name="partyId" required="true"/><parameter name="contactMechId" required="true"/><parameter name="contactMechPurposeId"/></in-parameters><out-parameters><parameter name="contactMechId" required="true"/></out-parameters><actions><entity-find-one entity-name="mantle.party.contact.ContactMech" value-field="origContactMech"/><script><![CDATA[newContactMech = origContactMech.cloneValue()]]></script><set field="newContactMech.infoString" from="infoString"/><if condition="newContactMech == origContactMech"><log message="No fields were different for contact info ${contactMechId}, not updating."/><return/></if><if condition="contactMechPurposeId"><entity-find entity-name="mantle.party.contact.PartyContactMech" list="origPcmList"><econdition field-name="partyId"/><econdition field-name="contactMechId"/></entity-find><if condition="!origPcmList"><entity-find entity-name="mantle.account.method.PaymentMethod" list="payMethList"><econdition field-name="ownerPartyId" from="partyId"/><econdition field-name="emailContactMechId" from="contactMechId"/></entity-find><if condition="!payMethList"><return error="true" message="Contact Info with ID ${contactMechId} is not associated with party ${partyId}, not updating."/></if></if><filter-map-list list="origPcmList"><date-filter/></filter-map-list><filter-map-list list="origPcmList"><field-map field-name="contactMechPurposeId"/></filter-map-list></if><set field="newContactMech.replacesContactMechId" from="newContactMech.contactMechId"/><set field="newContactMech.contactMechId" from="null"/><set field="newContactMech.gatewayCimId" from="null"/><set field="newContactMech.trustLevelEnumId" value="CmtlNew"/><set field="newContactMech.validateMessage" from="null"/><set field="newContactMech.paymentFraudEvidenceId" from="null"/><entity-sequenced-id-primary value-field="newContactMech"/><entity-create value-field="newContactMech"/><if condition="contactMechPurposeId"><iterate list="origPcmList" entry="origPcm"><set field="origPcm.thruDate" from="ec.user.nowTimestamp"/><entity-update value-field="origPcm"/><entity-make-value entity-name="mantle.party.contact.PartyContactMech" value-field="newPcm" map="[partyId:partyId, contactMechId:newContactMech.contactMechId, fromDate:ec.user.nowTimestamp]"/><set field="newPcm.contactMechPurposeId" from="origPcm.contactMechPurposeId"/><set field="newPcm.extension" from="extension ?: origPcm.extension"/><set field="newPcm.comments" from="comments ?: origPcm.comments"/><set field="newPcm.allowSolicitation" from="allowSolicitation ?: origPcm.allowSolicitation"/><entity-create value-field="newPcm"/></iterate></if><set field="contactMechId" from="newContactMech.contactMechId"/></actions></service>