<!--Service Location mantle.order.OrderServices.create#Order--><service verb="create" noun="Order"><in-parameters><parameter name="orderName" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderHeader" field-name="orderName"/><parameter name="entryDate" type="Timestamp" required="false" allow-html="none" entity-name="mantle.order.OrderHeader" field-name="entryDate" default="ec.user.nowTimestamp"/><parameter name="placedDate" type="java.sql.Timestamp" required="false" allow-html="none" entity-name="mantle.order.OrderHeader" field-name="placedDate"/><parameter name="approvedDate" type="java.sql.Timestamp" required="false" allow-html="none" entity-name="mantle.order.OrderHeader" field-name="approvedDate"/><parameter name="completedDate" type="java.sql.Timestamp" required="false" allow-html="none" entity-name="mantle.order.OrderHeader" field-name="completedDate"/><parameter name="statusId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderPart" field-name="statusId" default-value="OrderOpen"><description><![CDATA[The initial statusId for both header and part.]]></description></parameter><parameter name="processingStatusId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderHeader" field-name="processingStatusId"/><parameter name="orderRevision" type="Integer" required="false" allow-html="none" entity-name="mantle.order.OrderHeader" field-name="orderRevision" default="1"/><parameter name="currencyUomId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderHeader" field-name="currencyUomId"><description><![CDATA[Defaults to PartyAcctgPreference.baseCurrencyUomId for whichever
                Party (customer or vendor) is an internal organization with an accounting preference record.]]></description></parameter><parameter name="billingAccountId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderHeader" field-name="billingAccountId"/><parameter name="productStoreId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderHeader" field-name="productStoreId"/><parameter name="salesChannelEnumId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderHeader" field-name="salesChannelEnumId"/><parameter name="terminalId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderHeader" field-name="terminalId"/><parameter name="displayId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderHeader" field-name="displayId"/><parameter name="externalId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderHeader" field-name="externalId"/><parameter name="externalRevision" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderHeader" field-name="externalRevision"/><parameter name="originId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderHeader" field-name="originId"/><parameter name="originUrl" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderHeader" field-name="originUrl"/><parameter name="syncStatusId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderHeader" field-name="syncStatusId"/><parameter name="systemMessageRemoteId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderHeader" field-name="systemMessageRemoteId"/><parameter name="visitId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderHeader" field-name="visitId" default="ec.user.visitId"/><parameter name="enteredByPartyId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderHeader" field-name="enteredByPartyId" default="ec.user.userAccount?.partyId"/><parameter name="parentOrderId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderHeader" field-name="parentOrderId"/><parameter name="recurCronExpression" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderHeader" field-name="recurCronExpression"/><parameter name="lastOrderedDate" type="java.sql.Timestamp" required="false" allow-html="none" entity-name="mantle.order.OrderHeader" field-name="lastOrderedDate"/><parameter name="recurAutoInvoice" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderHeader" field-name="recurAutoInvoice"/><parameter name="lastUpdatedStamp" type="java.sql.Timestamp" required="false" allow-html="none" entity-name="mantle.order.OrderPart" field-name="lastUpdatedStamp"/><parameter name="parentPartSeqId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderPart" field-name="parentPartSeqId"/><parameter name="partName" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderPart" field-name="partName"/><parameter name="vendorPartyId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderPart" field-name="vendorPartyId"/><parameter name="customerPartyId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderPart" field-name="customerPartyId"/><parameter name="otherPartyOrderId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderPart" field-name="otherPartyOrderId"/><parameter name="otherPartyOrderDate" type="java.sql.Timestamp" required="false" allow-html="none" entity-name="mantle.order.OrderPart" field-name="otherPartyOrderDate"/><parameter name="facilityId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderPart" field-name="facilityId"/><parameter name="carrierPartyId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderPart" field-name="carrierPartyId"/><parameter name="shipmentMethodEnumId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderPart" field-name="shipmentMethodEnumId"/><parameter name="tradeTermEnumId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderPart" field-name="tradeTermEnumId"/><parameter name="settlementTermId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderPart" field-name="settlementTermId"/><parameter name="postalContactMechId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderPart" field-name="postalContactMechId"/><parameter name="telecomContactMechId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderPart" field-name="telecomContactMechId"/><parameter name="trackingNumber" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderPart" field-name="trackingNumber"/><parameter name="shippingInstructions" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderPart" field-name="shippingInstructions"/><parameter name="maySplit" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderPart" field-name="maySplit"/><parameter name="signatureRequiredEnumId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderPart" field-name="signatureRequiredEnumId"/><parameter name="giftMessage" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderPart" field-name="giftMessage"/><parameter name="isGift" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderPart" field-name="isGift"/><parameter name="isNewCustomer" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderPart" field-name="isNewCustomer"/><parameter name="partTotal" type="java.math.BigDecimal" required="false" allow-html="none" entity-name="mantle.order.OrderPart" field-name="partTotal"/><parameter name="priority" type="java.lang.Long" required="false" allow-html="none" entity-name="mantle.order.OrderPart" field-name="priority"/><parameter name="shipAfterDate" type="java.sql.Timestamp" required="false" allow-html="none" entity-name="mantle.order.OrderPart" field-name="shipAfterDate"/><parameter name="shipBeforeDate" type="java.sql.Timestamp" required="false" allow-html="none" entity-name="mantle.order.OrderPart" field-name="shipBeforeDate"/><parameter name="estimatedShipDate" type="java.sql.Timestamp" required="false" allow-html="none" entity-name="mantle.order.OrderPart" field-name="estimatedShipDate"/><parameter name="estimatedDeliveryDate" type="java.sql.Timestamp" required="false" allow-html="none" entity-name="mantle.order.OrderPart" field-name="estimatedDeliveryDate"/><parameter name="estimatedPickUpDate" type="java.sql.Timestamp" required="false" allow-html="none" entity-name="mantle.order.OrderPart" field-name="estimatedPickUpDate"/><parameter name="validFromDate" type="java.sql.Timestamp" required="false" allow-html="none" entity-name="mantle.order.OrderPart" field-name="validFromDate"/><parameter name="validThruDate" type="java.sql.Timestamp" required="false" allow-html="none" entity-name="mantle.order.OrderPart" field-name="validThruDate"/><parameter name="autoCancelDate" type="java.sql.Timestamp" required="false" allow-html="none" entity-name="mantle.order.OrderPart" field-name="autoCancelDate"/><parameter name="dontCancelSetDate" type="java.sql.Timestamp" required="false" allow-html="none" entity-name="mantle.order.OrderPart" field-name="dontCancelSetDate"/><parameter name="dontCancelSetUserId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderPart" field-name="dontCancelSetUserId"/><parameter name="disablePromotions" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderPart" field-name="disablePromotions"/><parameter name="disableShippingCalc" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderPart" field-name="disableShippingCalc"/><parameter name="disableTaxCalc" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderPart" field-name="disableTaxCalc"/><parameter name="reservationAutoEnumId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderPart" field-name="reservationAutoEnumId"/><parameter name="checkoutId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderPart" field-name="checkoutId"/><parameter name="checkoutUrl" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.order.OrderPart" field-name="checkoutUrl"/></in-parameters><out-parameters><parameter name="orderId" required="true"/><parameter name="orderPartSeqId" required="true"/></out-parameters><actions><if condition="productStoreId"><entity-find-one entity-name="mantle.product.store.ProductStore" value-field="productStore"/><set field="vendorPartyId" from="vendorPartyId ?: productStore?.organizationPartyId"/><set field="currencyUomId" from="currencyUomId ?: productStore?.defaultCurrencyUomId"/><set field="salesChannelEnumId" from="salesChannelEnumId ?: productStore?.defaultSalesChannelEnumId"/><set field="facilityId" from="facilityId ?: productStore?.inventoryFacilityId"/><set field="reservationAutoEnumId" from="reservationAutoEnumId ?: productStore?.reservationAutoEnumId"/><set field="disablePromotions" from="disablePromotions ?: productStore?.defaultDisablePromotions"/><set field="disableShippingCalc" from="disableShippingCalc ?: productStore?.defaultDisableShippingCalc"/><set field="disableTaxCalc" from="disableTaxCalc ?: productStore?.defaultDisableTaxCalc"/><entity-find entity-name="mantle.product.store.ProductStoreParty" list="storeBillToList"><date-filter/><econdition field-name="productStoreId"/><econdition field-name="roleTypeId" value="CustomerBillTo"/><order-by field-name="-fromDate"/></entity-find><if condition="storeBillToList"><set field="billToPartyId" from="storeBillToList[0].partyId"/></if></if><if condition="!currencyUomId"><if condition="customerPartyId"><service-call name="mantle.ledger.LedgerServices.find#PartyAcctgPreference" out-map="[partyAcctgPreference:context.partyAcctgPreference]" in-map="[organizationPartyId:customerPartyId]"/></if><if condition="!partyAcctgPreference && vendorPartyId"><service-call name="mantle.ledger.LedgerServices.find#PartyAcctgPreference" out-map="[partyAcctgPreference:context.partyAcctgPreference]" in-map="[organizationPartyId:vendorPartyId]"/></if><set field="currencyUomId" from="partyAcctgPreference?.baseCurrencyUomId"/></if><if condition="!currencyUomId"><set field="currencyUomId" value="USD"/></if><service-call name="create#mantle.order.OrderHeader" in-map="context" out-map="[orderId:context.orderId,orderName:context.orderName,entryDate:context.entryDate,placedDate:context.placedDate,approvedDate:context.approvedDate,completedDate:context.completedDate,statusId:context.statusId,processingStatusId:context.processingStatusId,orderRevision:context.orderRevision,currencyUomId:context.currencyUomId,billingAccountId:context.billingAccountId,productStoreId:context.productStoreId,salesChannelEnumId:context.salesChannelEnumId,terminalId:context.terminalId,displayId:context.displayId,externalId:context.externalId,externalRevision:context.externalRevision,originId:context.originId,originUrl:context.originUrl,syncStatusId:context.syncStatusId,systemMessageRemoteId:context.systemMessageRemoteId,visitId:context.visitId,enteredByPartyId:context.enteredByPartyId,parentOrderId:context.parentOrderId,recurCronExpression:context.recurCronExpression,lastOrderedDate:context.lastOrderedDate,recurAutoInvoice:context.recurAutoInvoice,remainingSubTotal:context.remainingSubTotal,grandTotal:context.grandTotal,lastUpdatedStamp:context.lastUpdatedStamp]"/><if condition="customerPartyId"><entity-find entity-name="mantle.party.PartyRole" list="custOrgInternalList"><econdition field-name="partyId" from="customerPartyId"/><econdition field-name="roleTypeId" value="OrgInternal"/></entity-find><if condition="custOrgInternalList"><service-call name="mantle.facility.ContactServices.get#FacilityDefaultShipDest" in-map="context" out-map="[postalContactMechId:context.postalContactMechId,telecomContactMechId:context.telecomContactMechId]"/></if><if condition="!shippingInstructions"><entity-find-one entity-name="mantle.party.Party" value-field="customerParty"><field-map field-name="partyId" from="customerPartyId"/></entity-find-one><set field="shippingInstructions" from="customerParty?.shippingInstructions"/></if><if condition="!signatureRequiredEnumId"><set field="signReqSettingValue" from="ec.service.sync().name('mantle.party.PartyServices.get#PartySettingValue')                         .parameter('partySettingTypeId', 'CustomerRequireSign').parameter('partyId', customerPartyId).call()?.get('settingValue')"/><if condition="signReqSettingValue && signReqSettingValue != 'PsrNone'"><set field="signatureRequiredEnumId" from="signReqSettingValue"/></if></if></if><service-call name="create#mantle.order.OrderPart" in-map="context" out-map="[orderId:context.orderId,orderPartSeqId:context.orderPartSeqId,parentPartSeqId:context.parentPartSeqId,partName:context.partName,statusId:context.statusId,vendorPartyId:context.vendorPartyId,customerPartyId:context.customerPartyId,otherPartyOrderId:context.otherPartyOrderId,otherPartyOrderDate:context.otherPartyOrderDate,facilityId:context.facilityId,carrierPartyId:context.carrierPartyId,shipmentMethodEnumId:context.shipmentMethodEnumId,tradeTermEnumId:context.tradeTermEnumId,settlementTermId:context.settlementTermId,postalContactMechId:context.postalContactMechId,telecomContactMechId:context.telecomContactMechId,trackingNumber:context.trackingNumber,shippingInstructions:context.shippingInstructions,maySplit:context.maySplit,signatureRequiredEnumId:context.signatureRequiredEnumId,giftMessage:context.giftMessage,isGift:context.isGift,isNewCustomer:context.isNewCustomer,partTotal:context.partTotal,priority:context.priority,shipAfterDate:context.shipAfterDate,shipBeforeDate:context.shipBeforeDate,estimatedShipDate:context.estimatedShipDate,estimatedDeliveryDate:context.estimatedDeliveryDate,estimatedPickUpDate:context.estimatedPickUpDate,validFromDate:context.validFromDate,validThruDate:context.validThruDate,autoCancelDate:context.autoCancelDate,dontCancelSetDate:context.dontCancelSetDate,dontCancelSetUserId:context.dontCancelSetUserId,disablePromotions:context.disablePromotions,disableShippingCalc:context.disableShippingCalc,disableTaxCalc:context.disableTaxCalc,reservationAutoEnumId:context.reservationAutoEnumId,checkoutId:context.checkoutId,checkoutUrl:context.checkoutUrl,lastUpdatedStamp:context.lastUpdatedStamp]"/><if condition="billToPartyId"><service-call name="create#mantle.order.OrderPartParty" in-map="[orderId:orderId, orderPartSeqId:orderPartSeqId, partyId:billToPartyId, roleTypeId:'CustomerBillTo']"/></if></actions></service>