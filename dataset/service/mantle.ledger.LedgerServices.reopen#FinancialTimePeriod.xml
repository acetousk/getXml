<!--Service Location mantle.ledger.LedgerServices.reopen#FinancialTimePeriod--><service verb="reopen" noun="FinancialTimePeriod"><in-parameters><parameter name="timePeriodId" required="true"/></in-parameters><out-parameters/><actions><if condition="!ec.user.hasPermission('FISCAL_REOPEN')"><return error="true" message="Fiscal Period Reopen permission required"/></if><entity-find-one entity-name="mantle.party.time.TimePeriod" value-field="timePeriod" for-update="true"/><if condition="timePeriod.isClosed != 'Y'"><message error="true"><![CDATA[Period ${ec.resource.expand('TimePeriodNameTemplate','',timePeriod)} is not closed, not reopening.]]></message></if><entity-find entity-name="mantle.party.time.TimePeriod" list="nextPeriodList"><econdition field-name="previousPeriodId" from="timePeriodId"/></entity-find><iterate list="nextPeriodList" entry="nextPeriod"><if condition="nextPeriod.isClosed == 'Y'"><message error="true"><![CDATA[Not reopening period ${ec.resource.expand('TimePeriodNameTemplate','',timePeriod)}, next period ${ec.resource.expand('TimePeriodNameTemplate','',nextPeriod)} is closed.]]></message></if></iterate><check-errors/><set field="timePeriod.isClosed" value="N"/><entity-update value-field="timePeriod"/></actions></service>