<!--Service Location mantle.work.WorkEffortServices.replace#WorkEffortParty--><service verb="replace" noun="WorkEffortParty"><in-parameters><parameter name="workEffortId" required="true" entity-name="mantle.work.effort.WorkEffortParty" field-name="workEffortId"/><parameter name="roleTypeId" required="true" entity-name="mantle.work.effort.WorkEffortParty" field-name="roleTypeId"/><parameter name="newPartyId" required="true"/><parameter name="statusId" entity-name="mantle.work.effort.WorkEffortParty" field-name="statusId"/></in-parameters><out-parameters/><actions><entity-find entity-name="mantle.work.effort.WorkEffortParty" list="wepList"><date-filter/><econdition field-name="workEffortId"/><econdition field-name="roleTypeId"/></entity-find><set field="foundExisting" from="false"/><iterate list="wepList" entry="wepValue"><if condition="wepValue.partyId != newPartyId"><set field="wepValue.thruDate" from="ec.user.nowTimestamp"/><entity-update value-field="wepValue"/><else><set field="foundExisting" from="true"/></else></if></iterate><if condition="!foundExisting"><service-call name="create#mantle.work.effort.WorkEffortParty" in-map="[workEffortId:workEffortId,                     partyId:newPartyId, roleTypeId:roleTypeId, fromDate:ec.user.nowTimestamp, statusId:statusId]"/></if></actions></service>