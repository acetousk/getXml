<!--Service Location mantle.facility.FacilityServices.update#FacilityCertification--><service verb="update" noun="FacilityCertification"><in-parameters><parameter name="facilityCertificationId" required="true" entity-name="mantle.facility.FacilityCertification" field-name="facilityCertificationId"/><parameter name="facilityId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.facility.FacilityCertification" field-name="facilityId"/><parameter name="certificationTypeEnumId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.facility.FacilityCertification" field-name="certificationTypeEnumId"/><parameter name="fromDate" type="java.sql.Date" required="false" allow-html="none" entity-name="mantle.facility.FacilityCertification" field-name="fromDate"/><parameter name="thruDate" type="java.sql.Date" required="false" allow-html="none" entity-name="mantle.facility.FacilityCertification" field-name="thruDate"/><parameter name="contactPartyId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.facility.FacilityCertification" field-name="contactPartyId"/><parameter name="auditorPartyId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.facility.FacilityCertification" field-name="auditorPartyId"/><parameter name="auditorOrgPartyId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.facility.FacilityCertification" field-name="auditorOrgPartyId"/><parameter name="auditStartDate" type="java.sql.Timestamp" required="false" allow-html="none" entity-name="mantle.facility.FacilityCertification" field-name="auditStartDate"/><parameter name="auditEndDate" type="java.sql.Timestamp" required="false" allow-html="none" entity-name="mantle.facility.FacilityCertification" field-name="auditEndDate"/><parameter name="auditScore" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.facility.FacilityCertification" field-name="auditScore"/><parameter name="certRegistrationId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.facility.FacilityCertification" field-name="certRegistrationId"/><parameter name="otherCertId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.facility.FacilityCertification" field-name="otherCertId"/><parameter name="documentLocation" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.facility.FacilityCertification" field-name="documentLocation"/><parameter name="lastUpdatedStamp" type="java.sql.Timestamp" required="false" allow-html="none" entity-name="mantle.facility.FacilityCertification" field-name="lastUpdatedStamp"/><parameter name="documentFile" type="org.apache.commons.fileupload.FileItem"/></in-parameters><out-parameters/><actions><entity-find-one entity-name="mantle.facility.FacilityCertification" value-field="facilityCertification"/><set field="facilityId" from="facilityCertification.facilityId"/><if condition="documentFile != null && documentFile.size > 0"><if condition="!documentLocation"><set field="filename" from="documentFile.getName()"/><if condition="org.moqui.resource.ResourceReference.isTextFilename(filename)"><then><set field="contentRoot" from="ec.user.getPreference('mantle.content.root') ?: 'dbresource://mantle/content'"/></then><else><set field="contentRoot" from="ec.user.getPreference('mantle.content.large.root') ?: 'dbresource://mantle/content'"/></else></if><set field="documentLocation" value="${contentRoot}/facility/${facilityId?:'_NA_'}/certification/${facilityCertificationId}/${filename}"/></if><set field="docRr" from="ec.resource.getLocationReference(documentLocation)"/><script><![CDATA[fileStream = documentFile.getInputStream()
                    try { docRr.putStream(fileStream) } finally { fileStream.close() }]]></script></if><service-call name="update#mantle.facility.FacilityCertification" in-map="context"/></actions></service>