<!--Service Location mantle.product.AssetServices.check#ScanLocation--><service verb="check" noun="ScanLocation"><in-parameters><parameter name="facilityId"/><parameter name="locationSeqId"/><parameter name="containerId"><description><![CDATA[May be actual containerId or serialNumber]]></description></parameter><parameter name="scanLocation"><description><![CDATA[May be locationSeqId within facility, containerId, or container serialNumber]]></description></parameter></in-parameters><out-parameters><parameter name="facilityId"/><parameter name="locationSeqId"/><parameter name="checkFacLoc" type="Map"/><parameter name="containerId"/><parameter name="container" type="Map"/></out-parameters><actions><if condition="scanLocation && facilityId"><entity-find-one entity-name="mantle.facility.FacilityLocation" value-field="checkFacLoc"><field-map field-name="facilityId"/><field-map field-name="locationSeqId" from="scanLocation"/></entity-find-one><if condition="checkFacLoc != null"><then><set field="locationSeqId" from="checkFacLoc.locationSeqId"/><set field="scanLocation" from="null"/></then><else><entity-find-one entity-name="mantle.facility.FacilityLocation" value-field="checkFacLoc"><field-map field-name="facilityId"/><field-map field-name="description" from="scanLocation"/></entity-find-one><if condition="checkFacLoc != null"><set field="locationSeqId" from="checkFacLoc.locationSeqId"/><set field="scanLocation" from="null"/></if></else></if></if><if condition="scanLocation"><entity-find-one entity-name="mantle.product.asset.Container" value-field="container"><field-map field-name="containerId" from="scanLocation"/></entity-find-one><if condition="container != null"><set field="containerId" from="container.containerId"/><set field="scanLocation" from="null"/></if></if><if condition="scanLocation"><entity-find-one entity-name="mantle.product.asset.Container" value-field="container"><field-map field-name="serialNumber" from="scanLocation"/></entity-find-one><if condition="container != null"><set field="containerId" from="container.containerId"/><set field="scanLocation" from="null"/></if></if><if condition="containerId"><if condition="container == null"><entity-find-one entity-name="mantle.product.asset.Container" value-field="container"/></if><if condition="container == null"><entity-find-one entity-name="mantle.product.asset.Container" value-field="container"><field-map field-name="serialNumber" from="containerId"/></entity-find-one><if condition="container == null"><return error="true" message="Container not found with ID or serial number ${containerId}"/></if><set field="containerId" from="container.containerId"/></if><set field="facilityId" from="container.facilityId"/><set field="locationSeqId" from="container.locationSeqId"/></if><if condition="facilityId && locationSeqId"><entity-find-one entity-name="mantle.facility.FacilityLocation" value-field="checkFacLoc"><field-map field-name="facilityId"/><field-map field-name="locationSeqId"/></entity-find-one><entity-find-one entity-name="mantle.facility.Facility" value-field="facility"/><if condition="checkFacLoc == null"><return error="true" message="Location [${locationSeqId}] is not valid in facility ${ec.resource.expand('FacilityNameTemplate', '', facility)}"/></if></if></actions></service>