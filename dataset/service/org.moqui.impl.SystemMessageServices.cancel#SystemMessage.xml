<!--Service Location org.moqui.impl.SystemMessageServices.cancel#SystemMessage--><service verb="cancel" noun="SystemMessage"><in-parameters><parameter name="systemMessageId" required="true" entity-name="moqui.service.message.SystemMessage" field-name="systemMessageId"/></in-parameters><out-parameters/><actions><entity-find-one entity-name="moqui.service.message.SystemMessage" value-field="systemMessage" for-update="true"/><if condition="systemMessage.statusId == 'SmsgCancelled'"><return/></if><if condition="systemMessage.statusId in ['SmsgSending', 'SmsgSent', 'SmsgConsuming', 'SmsgConsumed', 'SmsgConfirmed']"><return error="true" message="Cannot cancel SystemMessage ${systemMessageId} in status ${systemMessage.statusId}"/></if><set field="systemMessage.statusId" value="SmsgCancelled"/><entity-update value-field="systemMessage"/></actions></service>