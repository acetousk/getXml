<!--Service Location org.moqui.impl.WikiServices.get#WikiPageChildren--><service verb="get" noun="WikiPageChildren"><in-parameters><parameter name="wikiSpaceId"/><parameter name="pagePath"/><parameter name="wikiPageId"/><parameter name="extraPathNameList" type="List"/></in-parameters><out-parameters><parameter name="wikiSpaceId"/><parameter name="pagePath"/><parameter name="wikiPageId"/><parameter name="wikiSpace" type="org.moqui.entity.EntityValue"/><parameter name="wikiPage" type="org.moqui.entity.EntityValue"/><parameter name="rootPageLocation"/><parameter name="rootPageRef" type="org.moqui.resource.ResourceReference"/><parameter name="spaceRootName"/><parameter name="pageReference" type="org.moqui.resource.ResourceReference"/><parameter name="childPageInfoList" type="List"><parameter name="childPageInfo" type="Map"/></parameter></out-parameters><actions><service-call name="org.moqui.impl.WikiServices.get#WikiPageReference" in-map="context" out-map="[wikiSpaceId:context.wikiSpaceId,pagePath:context.pagePath,wikiPageId:context.wikiPageId,wikiSpace:context.wikiSpace,wikiPage:context.wikiPage,rootPageLocation:context.rootPageLocation,rootPageRef:context.rootPageRef,spaceRootName:context.spaceRootName,pageReference:context.pageReference]"/><if condition="pageReference == null"><return/></if><set field="childPageRefList" from="pageReference.getChildren()"/><set field="childPageInfoList" from="[]"/><iterate list="childPageRefList" entry="childPageRef"><set field="childFilename" from="childPageRef.getFileName()"/><set field="childDotIdx" from="childFilename.lastIndexOf('.')"/><set field="childPageName" from="childDotIdx > 0 ? childFilename.substring(0, childDotIdx) : childFilename"/><set field="childPagePath" from="(pagePath ? pagePath + '/' : '') + childPageName"/><set field="sequenceNum" from="50"/><service-call name="org.moqui.impl.WikiServices.get#WikiPageId" out-map="[wikiPageId:pageIdOut.wikiPageId,wikiPage:pageIdOut.wikiPage,createdRecord:pageIdOut.createdRecord]" out-map-add-to-existing="false" in-map="[wikiSpaceId:wikiSpaceId, pagePath:childPagePath]"/><if condition="pageIdOut.wikiPage != null"><set field="sequenceNum" from="pageIdOut.wikiPage.sequenceNum ?: 50"/></if><script><![CDATA[childPageInfoList.add([filename:childFilename, pagePath:childPagePath, pageName:childPageName, sequenceNum:sequenceNum])]]></script></iterate><order-map-list list="childPageInfoList"><order-by field-name="sequenceNum"/><order-by field-name="childPageName"/></order-map-list></actions></service>