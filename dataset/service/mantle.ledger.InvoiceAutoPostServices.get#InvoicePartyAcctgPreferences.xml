<!--Service Location mantle.ledger.InvoiceAutoPostServices.get#InvoicePartyAcctgPreferences--><service verb="get" noun="InvoicePartyAcctgPreferences"><in-parameters><parameter name="invoice" type="EntityValue" required="true"/></in-parameters><out-parameters><parameter name="fromPartyAcctgPreference" type="EntityValue"/><parameter name="toPartyAcctgPreference" type="EntityValue"/></out-parameters><actions><entity-find-one entity-name="mantle.party.PartyRole" value-field="fromPartyRole"><field-map field-name="partyId" from="invoice.overrideOrgPartyId ?: invoice.fromPartyId"/><field-map field-name="roleTypeId" value="OrgInternal"/></entity-find-one><if condition="fromPartyRole"><service-call name="mantle.ledger.LedgerServices.find#PartyAcctgPreference" out-map="[partyAcctgPreference:fromPapOut.partyAcctgPreference]" in-map="[organizationPartyId:fromPartyRole.partyId]"/><set field="fromPartyAcctgPreference" from="fromPapOut.partyAcctgPreference"/></if><entity-find-one entity-name="mantle.party.PartyRole" value-field="toPartyRole"><field-map field-name="partyId" from="invoice.overrideOrgPartyId ?: invoice.toPartyId"/><field-map field-name="roleTypeId" value="OrgInternal"/></entity-find-one><if condition="toPartyRole"><service-call name="mantle.ledger.LedgerServices.find#PartyAcctgPreference" out-map="[partyAcctgPreference:toPapOut.partyAcctgPreference]" in-map="[organizationPartyId:toPartyRole.partyId]"/><set field="toPartyAcctgPreference" from="toPapOut.partyAcctgPreference"/></if></actions></service>