<!--Service Location mantle.order.ReturnServices.delete#ReturnItem--><service verb="delete" noun="ReturnItem"><in-parameters><parameter name="returnId" required="true" entity-name="mantle.order.return.ReturnItem" field-name="returnId"/><parameter name="returnItemSeqId" required="true" entity-name="mantle.order.return.ReturnItem" field-name="returnItemSeqId"/></in-parameters><out-parameters/><actions><entity-find-one entity-name="mantle.order.return.ReturnItem" value-field="returnItem"/><if condition="returnItem == null"><return error="true" message="Return item ${returnId}:${returnItemSeqId} not found"/></if><if condition="!(returnItem.statusId in ['ReturnCreated', 'ReturnRequested', 'ReturnCancelled'])"><return error="true" message="Items may be deleted only when item is in Created, Requested, and Cancelled statuses"/></if><entity-find-one entity-name="mantle.order.return.ReturnHeader" value-field="returnHeader"/><if condition="!(returnHeader.statusId in ['ReturnCreated', 'ReturnRequested', 'ReturnCancelled'])"><return error="true" message="Items may be deleted only when return is in Created, Requested, and Cancelled statuses"/></if><entity-find entity-name="mantle.order.return.ReturnItem" list="childItemList"><econdition field-name="returnId"/><econdition field-name="parentItemSeqId" from="returnItemSeqId"/></entity-find><iterate list="childItemList" entry="childItem"><service-call name="mantle.order.ReturnServices.delete#ReturnItem" in-map="[returnId:returnId, returnItemSeqId:childItem.returnItemSeqId]"/></iterate><service-call name="delete#mantle.order.return.ReturnItem" in-map="[returnId:returnId, returnItemSeqId:returnItemSeqId]"/></actions></service>