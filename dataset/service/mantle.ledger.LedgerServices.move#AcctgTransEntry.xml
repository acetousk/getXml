<!--Service Location mantle.ledger.LedgerServices.move#AcctgTransEntry--><service verb="move" noun="AcctgTransEntry"><in-parameters><parameter name="acctgTransId" required="true" entity-name="mantle.ledger.transaction.AcctgTransEntry" field-name="acctgTransId"/><parameter name="acctgTransEntrySeqId" required="true" entity-name="mantle.ledger.transaction.AcctgTransEntry" field-name="acctgTransEntrySeqId"/><parameter name="glAccountId" required="true" entity-name="mantle.ledger.transaction.AcctgTransEntry" field-name="glAccountId"/></in-parameters><out-parameters><parameter name="acctgTransId" required="true" entity-name="mantle.ledger.transaction.AcctgTransEntry" field-name="acctgTransId"/></out-parameters><actions><entity-find-one entity-name="mantle.ledger.transaction.AcctgTrans" value-field="acctgTrans"/><entity-find-one entity-name="mantle.ledger.transaction.AcctgTransEntry" value-field="acctgTransEntry"/><if condition="acctgTrans.isPosted != 'Y'"><return error="true" message="Not moving transaction entry [${acctgTransId}:${acctgTransEntrySeqId}], transaction is not posted"/></if><if condition="acctgTransEntry.glAccountId == glAccountId"><return message="Not moving transaction entry [${acctgTransId}:${acctgTransEntrySeqId}], entry is already posted to account ${glAccountId}"/></if><set field="reverseAcctgTrans" from="acctgTrans.clone()"/><set field="reverseAcctgTrans.acctgTransId" from="null"/><entity-sequenced-id-primary value-field="reverseAcctgTrans"/><set field="reverseAcctgTrans.isPosted" value="N"/><entity-create value-field="reverseAcctgTrans"/><set field="reverseAcctgTransId" from="reverseAcctgTrans.acctgTransId"/><set field="reverseAcctgTransEntry" from="acctgTransEntry.clone()"/><set field="reverseAcctgTransEntry.acctgTransId" from="reverseAcctgTransId"/><set field="reverseAcctgTransEntry.reconcileStatusId" value="AterNot"/><set field="reverseAcctgTransEntry.debitCreditFlag" from="reverseAcctgTransEntry.debitCreditFlag == 'C' ? 'D' : 'C'"/><entity-create value-field="reverseAcctgTransEntry"/><set field="newAcctgTransEntry" from="acctgTransEntry.clone()"/><set field="newAcctgTransEntry.acctgTransId" from="reverseAcctgTransId"/><set field="newAcctgTransEntry.reconcileStatusId" value="AterNot"/><set field="newAcctgTransEntry.glAccountId" from="glAccountId"/><set field="newAcctgTransEntry.acctgTransEntrySeqId" from="null"/><entity-sequenced-id-secondary value-field="newAcctgTransEntry"/><entity-create value-field="newAcctgTransEntry"/><service-call name="mantle.ledger.LedgerServices.post#AcctgTrans" in-map="[acctgTransId:reverseAcctgTransId]"/><set field="acctgTransId" from="reverseAcctgTransId"/></actions></service>