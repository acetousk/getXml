<!--Service Location mantle.work.TimeServices.get#TimeEntryRiskClassInfo--><service verb="get" noun="TimeEntryRiskClassInfo"><in-parameters><parameter name="timeEntryId"/><parameter name="timeEntry" type="Map"/><parameter name="employment" type="Map"/><parameter name="employee" type="Map"/><parameter name="dftRiskClassEnumId"/><parameter name="dftRiskClassOverride" type="Boolean"/></in-parameters><out-parameters><parameter name="timeEntryId"/><parameter name="timeEntry" type="Map"/><parameter name="facilityId"/><parameter name="facility"/><parameter name="rateTypeEnumId"/><parameter name="workTypeEnumId"/><parameter name="riskClassEnumId"/><parameter name="stateGeoId"/><parameter name="dftRiskClassEnumId"/><parameter name="dftRiskClassOverride" type="Boolean"/></out-parameters><actions><service-call name="mantle.work.TimeServices.get#TimeEntryFacility" in-map="context" out-map="[timeEntryId:context.timeEntryId,timeEntry:context.timeEntry,facilityId:context.facilityId,facility:context.facility]"/><if condition="!dftRiskClassEnumId"><service-call name="mantle.party.PartyServices.get#PartySettingValue" out-map="[settingValue:getPsvOut.settingValue]" in-map="[partySettingTypeId:'PayrollWcRiskClass',partyId:partyId,partyRelationshipId:partyRelationshipId]"/><set field="dftRiskClassEnumId" from="getPsvOut.settingValue"/><service-call name="mantle.party.PartyServices.get#PartySettingValue" out-map="[settingValue:getPsvOut.settingValue]" in-map="[partySettingTypeId:'PayrollWcDftOvrWrkTp',partyId:partyId,partyRelationshipId:partyRelationshipId]"/><set field="dftRiskClassOverride" from="getPsvOut.settingValue=='BlY'" type="Boolean"/></if><set field="rateTypeEnumId" from="timeEntry.rateTypeEnumId?:'RatpStandard'"/><set field="workTypeEnumId" from="timeEntry.workTypeEnumId?:(timeEntry.workEffort?.workTypeEnumId)"/><if condition="rateTypeEnumId in ['RatpVacation', 'RatpHoliday', 'RatpSick', 'RatpPtoOther']"><then><return/></then><else-if condition="rateTypeEnumId in ['RatpPaidBreakStd', 'RatpPaidBreakRrp']"><if condition="timeEntry.parentEntryId"><set field="workTypeEnumId" from="timeEntry.parentEntry.workTypeEnumId?:workTypeEnumId"/></if></else-if><else-if condition="!(rateTypeEnumId in ['RatpStandard',                                                                'RatpPieceMinWageAdj',                                                                'RatpPaidNptStd',                                                                'RatpPaidNptRrp',                                                                'RatpEvening',                                                                'RatpNight',                                                                'RatpWeekend',                                                                'RatpShHoliday'])"><log level="warn" message="Unhandled rate type '${rateTypeEnumId}' in get#TimeEntryInfo"/><return/></else-if></if><set field="stateGeoId" from="facility?.stateGeoId"/><if condition="!stateGeoId"><if condition="employment?.taxWorkContactMechId"><entity-find-one entity-name="mantle.party.contact.PostalAddress" value-field="taxWorkContactMech"><field-map field-name="contactMechId" from="employment.taxWorkContactMechId"/></entity-find-one><set field="stateGeoId" from="taxWorkContactMech?.stateProvinceGeoId"/></if><if condition="!stateGeoId"><set field="stateGeoId" from="employee?:taxHomeContectMech?.stateProvinceGeoId"/></if></if><if condition="!workTypeEnumId ||                            (dftRiskClassOverride && dftRiskClassEnumId)"><set field="riskClassEnumId" from="dftRiskClassEnumId"/><return/></if><entity-find-one entity-name="mantle.humanres.employment.WorkTypeRiskClass" value-field="riskClass"><field-map field-name="geoId" from="stateGeoId"/><field-map field-name="workTypeEnumId"/><select-field field-name="riskClassEnumId"/></entity-find-one><set field="riskClassEnumId" from="riskClass?.riskClassEnumId"/></actions></service>