<!--Service Location mantle.product.ProductServices.apply#ProductFeatures--><service verb="apply" noun="ProductFeatures"><in-parameters><parameter name="productId" required="true"/><parameter name="applTypeEnumId" default-value="PfatStandard"/><parameter name="productFeatureIdList" type="List"><parameter name="productFeatureId"/></parameter><parameter name="fromDate" type="Timestamp" default="ec.user.nowTimestamp"/><parameter name="sequenceNum" type="Long"/><parameter name="amount" type="BigDecimal"/></in-parameters><out-parameters/><actions><iterate list="productFeatureIdList" entry="productFeatureId"><entity-find entity-name="mantle.product.feature.ProductFeatureAppl" list="existingAppls"><date-filter/><econdition field-name="productId"/><econdition field-name="productFeatureId"/><econdition field-name="applTypeEnumId"/></entity-find><if condition="existingAppls"><then><entity-find-one entity-name="mantle.product.feature.ProductFeature" value-field="productFeature"/><message type="warning"><![CDATA[Feature ${ec.resource.expand('ProductFeatureNameTemplate','',productFeature)} already applied]]></message></then><else><service-call name="create#mantle.product.feature.ProductFeatureAppl" in-map="context"/></else></if></iterate></actions></service>