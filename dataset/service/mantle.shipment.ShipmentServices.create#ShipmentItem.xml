<!--Service Location mantle.shipment.ShipmentServices.create#ShipmentItem--><service verb="create" noun="ShipmentItem"><in-parameters><parameter name="shipmentId" required="false" entity-name="mantle.shipment.ShipmentItemSource" field-name="shipmentId" type="java.lang.String" allow-html="none"/><parameter name="productId" required="false" entity-name="mantle.shipment.ShipmentItemSource" field-name="productId" type="java.lang.String" allow-html="none"/><parameter name="quantity" type="BigDecimal" required="true" allow-html="none" entity-name="mantle.shipment.ShipmentItemSource" field-name="quantity"/><parameter name="lastUpdatedStamp" type="java.sql.Timestamp" required="false" allow-html="none" entity-name="mantle.shipment.ShipmentItemSource" field-name="lastUpdatedStamp"/><parameter name="binLocationNumber" type="java.lang.Long" required="false" allow-html="none" entity-name="mantle.shipment.ShipmentItemSource" field-name="binLocationNumber"/><parameter name="orderId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.shipment.ShipmentItemSource" field-name="orderId"/><parameter name="orderItemSeqId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.shipment.ShipmentItemSource" field-name="orderItemSeqId"/><parameter name="returnId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.shipment.ShipmentItemSource" field-name="returnId"/><parameter name="returnItemSeqId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.shipment.ShipmentItemSource" field-name="returnItemSeqId"/><parameter name="statusId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.shipment.ShipmentItemSource" field-name="statusId" default="SisPending"/><parameter name="quantityNotHandled" type="java.math.BigDecimal" required="false" allow-html="none" entity-name="mantle.shipment.ShipmentItemSource" field-name="quantityNotHandled"/><parameter name="quantityPicked" type="java.math.BigDecimal" required="false" allow-html="none" entity-name="mantle.shipment.ShipmentItemSource" field-name="quantityPicked"/><parameter name="invoiceId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.shipment.ShipmentItemSource" field-name="invoiceId"/><parameter name="invoiceItemSeqId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.shipment.ShipmentItemSource" field-name="invoiceItemSeqId"/></in-parameters><out-parameters><parameter name="shipmentItemSourceId"/></out-parameters><actions><entity-find-one entity-name="mantle.shipment.ShipmentItem" value-field="shipmentItem"><field-map field-name="shipmentId"/><field-map field-name="productId"/></entity-find-one><if condition="shipmentItem != null"><then><set field="shipmentItem.quantity" from="shipmentItem.quantity + quantity"/><entity-update value-field="shipmentItem"/></then><else><service-call name="create#mantle.shipment.ShipmentItem" in-map="[shipmentId:shipmentId, productId:productId, quantity:quantity]"/></else></if><set field="quantityNotHandled" from="quantityNotHandled != null ? quantityNotHandled : quantity"/><service-call name="create#mantle.shipment.ShipmentItemSource" in-map="context" out-map="[shipmentItemSourceId:context.shipmentItemSourceId,shipmentId:context.shipmentId,productId:context.productId,binLocationNumber:context.binLocationNumber,orderId:context.orderId,orderItemSeqId:context.orderItemSeqId,returnId:context.returnId,returnItemSeqId:context.returnItemSeqId,statusId:context.statusId,quantity:context.quantity,quantityNotHandled:context.quantityNotHandled,quantityPicked:context.quantityPicked,invoiceId:context.invoiceId,invoiceItemSeqId:context.invoiceItemSeqId,lastUpdatedStamp:context.lastUpdatedStamp]"/></actions></service>