<!--Service Location org.moqui.impl.WikiServices.get#PublishedWikiPageText--><service verb="get" noun="PublishedWikiPageText"><in-parameters><parameter name="wikiSpaceId" required="true"/><parameter name="pagePath"/><parameter name="pagePathList" type="List"><description><![CDATA[Alternative to pagePath when caller has a list of path elements (instead of forward slash separated string)]]></description><parameter name="pathElement" type="String"/></parameter><parameter name="versionName"><description><![CDATA[Meant for testing, get this version instead of published.
                To eliminate exposure of non-published versions explicitly set this to null.]]></description></parameter><parameter name="getPageText" type="Boolean" default="true"/></in-parameters><out-parameters><parameter name="wikiPageId"/><parameter name="publishedVersionName"/><parameter name="versionName"/><parameter name="pageReference" type="org.moqui.resource.ResourceReference"/><parameter name="pageLocation"/><parameter name="pageText"/></out-parameters><actions><entity-find-one entity-name="moqui.resource.wiki.WikiSpace" value-field="wikiSpace" cache="true"><field-map field-name="wikiSpaceId"/></entity-find-one><if condition="wikiSpace == null"><return message="No space found with ID ${wikiSpaceId}"/></if><if condition="pagePathList && !pagePath"><set field="pagePath" from="pagePathList.join('/')"/></if><entity-find entity-name="moqui.resource.wiki.WikiPage" list="wikiPageList" cache="true"><econdition field-name="wikiSpaceId"/><econdition field-name="pagePath" from="pagePath ?: null"/></entity-find><set field="wikiPage" from="wikiPageList ? wikiPageList[0] : null"/><if condition="wikiPage == null"><entity-find-one entity-name="moqui.resource.wiki.WikiPageAlias" value-field="wikiPageAlias" cache="true"><field-map field-name="wikiSpaceId"/><field-map field-name="aliasPath" from="pagePath ?: null"/></entity-find-one><if condition="wikiPageAlias?.wikiPageId"><entity-find-one entity-name="moqui.resource.wiki.WikiPage" value-field="wikiPage"><field-map field-name="wikiPageId" from="wikiPageAlias.wikiPageId"/></entity-find-one></if></if><if condition="wikiPage == null"><return message="No page found at path ${pagePath} in space ${wikiSpaceId}"/></if><set field="publishedVersionName" from="wikiPage.publishedVersionName"/><set field="versionName" from="versionName ?: publishedVersionName"/><if condition="!versionName"><return message="No page version found at path ${pagePath} in space ${wikiSpaceId}"/></if><set field="rootPageRef" from="ec.resource.getLocationReference(wikiSpace.rootPageLocation)"/><set field="pageReference" from="rootPageRef.findChildFile(wikiPage.pagePath)"/><set field="pageLocation" from="pageReference.location"/><set field="wikiPageId" from="wikiPage.wikiPageId"/><if condition="getPageText"><set field="pageText" from="pageReference.getText(versionName)"/></if></actions></service>