<!--Service Location mantle.humanres.EmploymentServices.create#Employment--><service verb="create" noun="Employment"><in-parameters><parameter name="relationshipTypeEnumId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.party.PartyRelationship" field-name="relationshipTypeEnumId" default-value="PrtEmployee"/><parameter name="fromPartyId" type="java.lang.String" required="true" allow-html="none" entity-name="mantle.party.PartyRelationship" field-name="fromPartyId"/><parameter name="fromRoleTypeId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.party.PartyRelationship" field-name="fromRoleTypeId" default-value="Employee"/><parameter name="toPartyId" type="java.lang.String" required="true" allow-html="none" entity-name="mantle.party.PartyRelationship" field-name="toPartyId"/><parameter name="toRoleTypeId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.party.PartyRelationship" field-name="toRoleTypeId" default-value="OrgEmployer"/><parameter name="fromDate" type="java.sql.Timestamp" required="false" allow-html="none" entity-name="mantle.party.PartyRelationship" field-name="fromDate" default="ec.user.nowTimestamp"/><parameter name="thruDate" type="java.sql.Timestamp" required="false" allow-html="none" entity-name="mantle.party.PartyRelationship" field-name="thruDate"/><parameter name="statusId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.party.PartyRelationship" field-name="statusId"/><parameter name="comments" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.party.PartyRelationship" field-name="comments"/><parameter name="relationshipName" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.party.PartyRelationship" field-name="relationshipName"/><parameter name="lastUpdatedStamp" type="java.sql.Timestamp" required="false" allow-html="none" entity-name="mantle.humanres.employment.Employment" field-name="lastUpdatedStamp"/><parameter name="emplPositionId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.humanres.employment.Employment" field-name="emplPositionId"/><parameter name="terminationReasonEnumId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.humanres.employment.Employment" field-name="terminationReasonEnumId"/><parameter name="terminationTypeEnumId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.humanres.employment.Employment" field-name="terminationTypeEnumId"/><parameter name="identityTypeEnumId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.humanres.employment.Employment" field-name="identityTypeEnumId"/><parameter name="emplAuthzTypeEnumId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.humanres.employment.Employment" field-name="emplAuthzTypeEnumId"/><parameter name="timePeriodTypeId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.humanres.employment.Employment" field-name="timePeriodTypeId"/><parameter name="taxWorkContactMechId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.humanres.employment.Employment" field-name="taxWorkContactMechId"/><parameter name="taxFederalAllowances" type="java.lang.Long" required="false" allow-html="none" entity-name="mantle.humanres.employment.Employment" field-name="taxFederalAllowances"/><parameter name="taxStateAllowances" type="java.lang.Long" required="false" allow-html="none" entity-name="mantle.humanres.employment.Employment" field-name="taxStateAllowances"/><parameter name="taxFormId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.humanres.employment.Employment" field-name="taxFormId"/><parameter name="taxClassificationEnumId" type="java.lang.String" required="false" allow-html="none" entity-name="mantle.humanres.employment.Employment" field-name="taxClassificationEnumId"/></in-parameters><out-parameters><parameter name="partyRelationshipId" entity-name="mantle.humanres.employment.Employment" field-name="partyRelationshipId"/></out-parameters><actions><entity-find entity-name="mantle.party.PartyRelationship" list="partyRelList"><econdition field-name="fromPartyId" from="fromPartyId"/><econdition field-name="toPartyId" from="toPartyId"/><econditions combine="or"><econdition field-name="fromDate" operator="greater-equals" from="fromDate"/><econdition field-name="thruDate" operator="greater" from="fromDate"/><econditions><econdition field-name="fromDate" operator="less" from="fromDate"/><econdition field-name="thruDate" operator="is-null"/></econditions></econditions></entity-find><if condition="partyRelList"><return error="true" message="Cannot have overlapping employments."/></if><if condition="emplPositionId"><entity-find-one entity-name="mantle.humanres.position.EmplPosition" value-field="emplPosition"><field-map field-name="emplPositionId"/></entity-find-one><if condition="!emplPosition || (emplPosition.organizationPartyId && toPartyId != emplPosition.organizationPartyId)"><entity-find-one entity-name="mantle.party.PartyDetail" value-field="toParty"><field-map field-name="partyId" from="toPartyId"/></entity-find-one><set field="orgName" from="ec.resource.expand('PartyNameTemplate','',toParty)"/><return error="true" message="Position ${emplPosition.description} is not valid for ${orgName}"/></if></if><service-call name="create#mantle.party.PartyRelationship" in-map="context" out-map="[partyRelationshipId:context.partyRelationshipId,relationshipTypeEnumId:context.relationshipTypeEnumId,fromPartyId:context.fromPartyId,fromRoleTypeId:context.fromRoleTypeId,toPartyId:context.toPartyId,toRoleTypeId:context.toRoleTypeId,fromDate:context.fromDate,thruDate:context.thruDate,statusId:context.statusId,comments:context.comments,relationshipName:context.relationshipName,lastUpdatedStamp:context.lastUpdatedStamp]"/><service-call name="create#mantle.humanres.employment.Employment" in-map="context"/></actions></service>