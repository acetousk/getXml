<!--Service Location coarchy.CoarchyServices.create#ValueStatement--><service verb="create" noun="ValueStatement"><in-parameters><parameter name="value" required="true" entity-name="coarchy.ValueStatement" field-name="value"/><parameter name="typeEnumId" required="true" entity-name="coarchy.ValueStatement" field-name="typeEnumId"/><parameter name="organizationId" required="true" entity-name="coarchy.ValueStatement" field-name="organizationId"/><parameter name="tagIdList" type="List" default="[]"/></in-parameters><out-parameters><parameter name="valueStatementId" entity-name="coarchy.ValueStatement" field-name="valueStatementId"/></out-parameters><actions><set field="value" from="value.trim()"/><entity-find entity-name="coarchy.ValueStatement" list="valueStatementList" limit="20"><econdition field-name="replacedByValueStatementId" operator="is-null"/><econdition field-name="disabled" value="N" or-null="true"/><econdition field-name="value" from="value" ignore-case="true"/></entity-find><if condition="valueStatementList"><return type="danger" message="Statement '${valueStatementList?.getFirst()?.value}' already exists"/></if><entity-find entity-name="coarchy.ValueStatement" list="valueStatementList" limit="1"><econdition field-name="replacedByValueStatementId" operator="is-null"/><econdition field-name="disabled" value="N" or-null="true"/><order-by field-name="-sequenceNum,value"/></entity-find><service-call name="create#coarchy.ValueStatement" in-map="[value:value,typeEnumId:typeEnumId,                 sequenceNum:valueStatementList.getFirst()?.sequenceNum?valueStatementList.getFirst()?.sequenceNum+1:1,organizationId:organizationId]" out-map="[valueStatementId:context.valueStatementId,value:context.value,sequenceNum:context.sequenceNum,typeEnumId:context.typeEnumId,disabled:context.disabled,replacedByValueStatementId:context.replacedByValueStatementId,organizationId:context.organizationId,lastUpdatedStamp:context.lastUpdatedStamp]"/><iterate list="tagIdList" entry="tagId"><service-call name="coarchy.CoarchyServices.create#ValueStatementTag" in-map="[tagId:tagId,organizationId:organizationId,valueStatementId:valueStatementId]"/></iterate></actions></service>