<!--Service Location mantle.facility.ContactServices.update#FacilityContactOther--><service verb="update" noun="FacilityContactOther"><in-parameters><parameter name="infoString" required="true"/><parameter name="facilityId" required="true"/><parameter name="contactMechId"/><parameter name="contactMechPurposeId"/></in-parameters><out-parameters><parameter name="contactMechId" required="true"/></out-parameters><actions><if condition="!contactMechId && !contactMechPurposeId"><return error="false" message="Must specify either a contactMechId or contactMechPurposeId (or both)."/></if><entity-find entity-name="mantle.facility.FacilityContactMech" list="origFcmList"><date-filter/><econdition field-name="facilityId"/><econdition field-name="contactMechId" from="contactMechId" ignore-if-empty="true"/><econdition field-name="contactMechPurposeId" from="contactMechPurposeId" ignore-if-empty="true"/></entity-find><if condition="!origFcmList"><log message="Contact Info with ID [${contactMechId}] is not associated with Facility ID [${facilityId}] and purpose [${contactMechPurposeId?:'N/A'}], not updating."/><return/></if><set field="contactMechId" from="contactMechId ?: origFcmList[0].contactMechId"/><entity-find-one entity-name="mantle.party.contact.ContactMech" value-field="origContactMech"/><script><![CDATA[newContactMech = origContactMech.cloneValue()]]></script><set field="newContactMech.infoString" from="infoString"/><if condition="newContactMech == origContactMech"><log message="No fields were different for Postal Address with ID [${contactMechId}], not updating."/><return/></if><set field="newContactMech.replacesContactMechId" from="newContactMech.contactMechId"/><set field="newContactMech.contactMechId" from="null"/><set field="newContactMech.gatewayCimId" from="null"/><set field="newContactMech.trustLevelEnumId" value="CmtlNew"/><set field="newContactMech.validateMessage" from="null"/><set field="newContactMech.paymentFraudEvidenceId" from="null"/><entity-sequenced-id-primary value-field="newContactMech"/><entity-create value-field="newContactMech"/><iterate list="origFcmList" entry="origFcm"><set field="origFcm.thruDate" from="ec.user.nowTimestamp"/><entity-update value-field="origFcm"/><entity-make-value entity-name="mantle.facility.FacilityContactMech" value-field="newFcm" map="[facilityId:facilityId, contactMechId:newContactMech.contactMechId, fromDate:ec.user.nowTimestamp]"/><set field="newFcm.contactMechPurposeId" from="origFcm.contactMechPurposeId"/><set field="newFcm.extension" from="origFcm.extension"/><set field="newFcm.comments" from="origFcm.comments"/><entity-create value-field="newFcm"/></iterate><set field="result.contactMechId" from="newContactMech.contactMechId"/></actions></service>