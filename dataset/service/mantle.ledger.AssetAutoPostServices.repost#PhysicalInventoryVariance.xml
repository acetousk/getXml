<!--Service Location mantle.ledger.AssetAutoPostServices.repost#PhysicalInventoryVariance--><service verb="repost" noun="PhysicalInventoryVariance"><in-parameters><parameter name="assetDetailId" required="true"/></in-parameters><out-parameters><parameter name="acctgTransId"/></out-parameters><actions><entity-find-one entity-name="mantle.product.asset.AssetDetail" value-field="assetDetail" for-update="true"/><if condition="!assetDetail.physicalInventoryId"><return/></if><if condition="!assetDetail.quantityOnHandDiff"><return/></if><entity-find entity-name="mantle.ledger.transaction.AcctgTrans" list="existingTransList"><econdition field-name="physicalInventoryId" from="assetDetail.physicalInventoryId"/><econdition field-name="acctgTransTypeEnumId" operator="in" from="['AttInventoryVariance', 'AttAssetVariance']"/><econdition field-name="reversedByAcctgTransId" from="null"/><econdition field-name="reverseOfAcctgTransId" from="null"/></entity-find><if condition="!existingTransList"><log level="warn" message="In repost#PhysicalInventoryVariance ${assetDetailId} no existing AcctgTrans records found"/></if><iterate list="existingTransList" entry="acctgTrans"><service-call name="mantle.ledger.LedgerServices.unpost#AcctgTrans" in-map="[acctgTransId:acctgTrans.acctgTransId]"/><service-call name="mantle.ledger.LedgerServices.delete#AcctgTrans" in-map="[acctgTransId:acctgTrans.acctgTransId]"/></iterate><entity-find-one entity-name="mantle.product.asset.Asset" value-field="asset"><field-map field-name="assetId" from="assetDetail.assetId"/></entity-find-one><if condition="asset?.acquireCost && asset?.ownerPartyId"><service-call name="mantle.ledger.AssetAutoPostServices.post#PhysicalInventoryVariance" in-map="[assetDetailId:assetDetailId]"/></if></actions></service>