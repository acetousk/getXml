<!--Service Location mantle.shipment.ShipmentServices.ship#OrderPart--><service verb="ship" noun="OrderPart"><in-parameters><parameter name="orderId" required="true" entity-name="mantle.order.OrderPart" field-name="orderId"/><parameter name="orderPartSeqId" required="true" entity-name="mantle.order.OrderPart" field-name="orderPartSeqId"/><parameter name="tryAutoPackage" type="Boolean" default="true"/><parameter name="shipDate" type="Timestamp" default="ec.user.nowTimestamp"/></in-parameters><out-parameters><parameter name="shipmentId"/></out-parameters><actions><service-call name="mantle.shipment.ShipmentServices.create#OrderPartShipment" out-map="[shipmentId:context.shipmentId,shipmentPackageSeqId:context.shipmentPackageSeqId]" in-map="[orderId:orderId, orderPartSeqId:orderPartSeqId, entryDate:shipDate, tryAutoPackage:tryAutoPackage]"/><entity-find entity-name="moqui.basic.EnumGroupMember" list="productItemTypeEgms" cache="true"><econdition field-name="enumGroupEnumId" value="EngItemsProduct"/></entity-find><set field="productItemTypes" from="productItemTypeEgms*.enumId"/><entity-find entity-name="mantle.order.OrderItem" list="orderItemList"><econdition field-name="orderId"/><econdition field-name="orderPartSeqId"/><econdition field-name="itemTypeEnumId" operator="in" from="productItemTypes"/><order-by field-name="productId"/></entity-find><iterate list="orderItemList" entry="orderItem"><if condition="orderItem.productId && productItemTypes.contains(orderItem.itemTypeEnumId)"><service-call name="mantle.shipment.ShipmentServices.pack#ShipmentProduct" in-map="[productId:orderItem.productId, quantity:orderItem.quantity, shipmentId:shipmentId,                                 shipmentPackageSeqId:shipmentPackageSeqId]"/></if></iterate><service-call name="mantle.shipment.ShipmentServices.pack#Shipment" in-map="[shipmentId:shipmentId, packedDate:shipDate]"/><service-call name="mantle.shipment.ShipmentServices.ship#Shipment" in-map="[shipmentId:shipmentId]"/></actions></service>