<!--Service Location mantle.party.TimeServices.getOrCreate#PreviousTimePeriod--><service verb="getOrCreate" noun="PreviousTimePeriod"><in-parameters><parameter name="timePeriodId" required="true"/></in-parameters><out-parameters><parameter name="previousTimePeriodId"/><parameter name="previousTimePeriod" type="EntityValue"/></out-parameters><actions><entity-find-one entity-name="mantle.party.time.TimePeriod" value-field="currentPeriod"><field-map field-name="timePeriodId"/></entity-find-one><if condition="currentPeriod.previousPeriodId"><then><entity-find-one entity-name="mantle.party.time.TimePeriod" value-field="previousTimePeriod"><field-map field-name="timePeriodId" from="currentPeriod.previousPeriodId"/></entity-find-one></then><else><service-call name="mantle.party.TimeServices.create#TimePeriod" out-map="[timePeriodId:createTpOut.timePeriodId]" in-map="[nextPeriodId:timePeriodId]"/><entity-find-one entity-name="mantle.party.time.TimePeriod" value-field="previousTimePeriod"><field-map field-name="timePeriodId" from="createTpOut.timePeriodId"/></entity-find-one></else></if><set field="previousTimePeriodId" from="previousTimePeriod.timePeriodId"/></actions></service>