<!--Service Location org.moqui.impl.ScreenServices.update#FormResponse--><service verb="update" noun="FormResponse"><in-parameters><parameter name="formResponseId" required="true" entity-name="moqui.screen.form.FormResponse" field-name="formResponseId"/><parameter name="responseMap" type="Map" required="true"/></in-parameters><out-parameters><parameter name="formResponseId" entity-name="moqui.screen.form.FormResponse" field-name="formResponseId"/></out-parameters><actions><entity-find-one entity-name="moqui.screen.form.FormResponse" value-field="formResponse"/><set field="formNode" from="ec.screen.getFormNode(formResponse.formLocation)"/><iterate list="formNode.children('field')" entry="fieldNode"><set field="fieldName" from="fieldNode.attribute('name')"/><if condition="responseMap.containsKey(fieldName)"><entity-find-one entity-name="moqui.screen.form.FormResponseAnswer" value-field="answer"><field-map field-name="formResponseId"/><field-map field-name="fieldName"/></entity-find-one><if condition="answer"><service-call name="update#moqui.screen.form.FormResponseAnswer" in-map="[formResponseAnswerId:answer.formResponseAnswerId,                                     valueText:org.moqui.util.ObjectUtilities.toPlainString(responseMap.get(fieldName))]"/><else><service-call name="create#moqui.screen.form.FormResponseAnswer" in-map="[formResponseId:formResponseId, fieldName:fieldName,                                         valueText:org.moqui.util.ObjectUtilities.toPlainString(responseMap.get(fieldName))]"/></else></if></if></iterate></actions></service>