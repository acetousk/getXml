<!--Service Location coarchy.CoarchyServices.getOrCreate#Tag--><service verb="getOrCreate" noun="Tag"><in-parameters><parameter name="description" required="true" entity-name="coarchy.Tag" field-name="description"><text-length min="1"/><matches regexp="(?<=\s|^)(\w*[A-Za-z_]+\w*)" message="CoarchyTagInvalidFormat"/></parameter><parameter name="organizationId" required="true" entity-name="coarchy.Tag" field-name="organizationId"/></in-parameters><out-parameters><parameter name="tagId" entity-name="coarchy.Tag" field-name="tagId"/></out-parameters><actions><set field="description" from="description.trim()"/><entity-find entity-name="coarchy.Tag" list="tagList"><econdition field-name="description" ignore-case="true"/><econdition field-name="organizationId"/></entity-find><if condition="tagList?.size()"><set field="tagId" from="tagList[0].tagId"/><else><service-call name="create#coarchy.Tag" in-map="[description:description, organizationId:organizationId]" out-map="[tagId:context.tagId,description:context.description,organizationId:context.organizationId,lastUpdatedStamp:context.lastUpdatedStamp]"/></else></if></actions></service>