<!--Service Location mantle.work.TimeServices.get#TeamTimesheetInfo--><service verb="get" noun="TeamTimesheetInfo"><in-parameters><parameter name="partyId" required="true"><description><![CDATA[The team partyId]]></description></parameter><parameter name="workEffortId"><description><![CDATA[Optional, used when the timesheet is for a particular WorkEffort]]></description></parameter></in-parameters><out-parameters><parameter name="teamDetail" type="Map"/><parameter name="teamMemberInfoList" type="List"><parameter name="teamMemberInfo" type="Map"/></parameter><parameter name="workEffort" type="Map"/><parameter name="childWorkEffort" type="Map"/><parameter name="clientDetail" type="Map"/><parameter name="facility" type="Map"/><parameter name="workTypeEnum" type="Map"/></out-parameters><actions><entity-find-one entity-name="mantle.party.PartyDetail" value-field="teamDetail"/><if condition="workEffortId"><entity-find-one entity-name="mantle.work.effort.WorkEffort" value-field="workEffort"/></if><if condition="workEffort != null"><entity-find entity-name="mantle.work.effort.WorkEffortParty" list="clientWepList"><date-filter/><econdition field-name="workEffortId"/><econdition field-name="roleTypeId" operator="in" value="Customer,CustomerBillTo"/><order-by field-name="-fromDate"/></entity-find><if condition="clientWepList"><entity-find-one entity-name="mantle.party.PartyDetail" value-field="clientDetail"><field-map field-name="partyId" from="clientWepList[0].partyId"/></entity-find-one></if><entity-find-one entity-name="mantle.work.effort.WorkEffort" value-field="childWorkEffort"><field-map field-name="parentWorkEffortId" from="workEffortId"/></entity-find-one><set field="workTypeEnum" from="workEffort.workType"/><set field="facility" from="workEffort.facility"/></if><set field="teamMemberInfoList" from="[]"/><set field="memberIds" from="new HashSet()"/><if condition="workEffort != null"><entity-find entity-name="mantle.work.time.TimeEntry" list="teamTimeEntryList"><econdition field-name="teamPartyId" from="partyId"/><econdition field-name="workEffortId"/><econdition field-name="parentEntryId" operator="is-null"/></entity-find><iterate list="teamTimeEntryList" entry="timeEntry"><script><![CDATA[memberIds.add(timeEntry.partyId)]]></script><entity-find-one entity-name="mantle.party.PartyDetail" value-field="memberDetail"><field-map field-name="partyId" from="timeEntry.partyId"/></entity-find-one><entity-find-one entity-name="mantle.work.time.TimeEntry" value-field="childTimeEntry"><field-map field-name="parentEntryId" from="timeEntry.timeEntryId"/></entity-find-one><set field="teamMemberInfo" from="memberDetail.getMap()"/><set field="teamMemberInfo.fromPartyId" from="timeEntry.partyId"/><set field="teamMemberInfo.timeEntry" from="timeEntry"/><set field="teamMemberInfo.childTimeEntry" from="childTimeEntry"/><set field="teamMemberInfo.teWorkTypeEnum" from="timeEntry.workType"/><entity-find-count entity-name="mantle.party.PartyRelationship" count-field="memberRelCount"><date-filter valid-date="workEffort?.actualStartDate"/><econdition field-name="fromPartyId" from="timeEntry.partyId"/><econdition field-name="toPartyId" from="partyId"/><econdition field-name="toRoleTypeId" value="OrgTeam"/><econdition field-name="relationshipTypeEnumId" value="PrtMember"/></entity-find-count><set field="teamMemberInfo.teamMember" from="memberRelCount ? 'Y' : 'N'"/><script><![CDATA[teamMemberInfoList.add(teamMemberInfo)]]></script></iterate></if><entity-find entity-name="mantle.party.PartyFromAndRelationship" list="teamMemberList"><date-filter valid-date="workEffort?.actualStartDate"/><econdition field-name="fromPartyId" operator="not-in" from="memberIds" ignore-if-empty="true"/><econdition field-name="toPartyId" from="partyId"/><econdition field-name="toRoleTypeId" value="OrgTeam"/><econdition field-name="relationshipTypeEnumId" value="PrtMember"/></entity-find><iterate list="teamMemberList" entry="teamMember"><set field="teamMemberInfo" from="teamMember.getMap()"/><set field="teamMemberInfo.teamMember" value="Y"/><script><![CDATA[teamMemberInfoList.add(teamMemberInfo)]]></script></iterate><order-map-list list="teamMemberInfoList"><order-by field-name="firstName,lastName,organizationName"/></order-map-list></actions></service>