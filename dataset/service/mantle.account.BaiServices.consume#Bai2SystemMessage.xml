<!--Service Location mantle.account.BaiServices.consume#Bai2SystemMessage--><service verb="consume" noun="Bai2SystemMessage"><in-parameters><parameter name="systemMessageId" required="true" entity-name="moqui.service.message.SystemMessage" field-name="systemMessageId"/></in-parameters><out-parameters><parameter name="noStatusUpdate" type="Boolean"/></out-parameters><actions><entity-find-one entity-name="moqui.service.message.SystemMessage" value-field="systemMessage"/><set field="baiString" from="systemMessage.messageText"/><entity-find entity-name="mantle.account.method.PaymentMethodFileType" list="pmftList"><econdition field-name="fileTypeEnumId" value="PmftBai2"/><econdition field-name="systemMessageTypeId" from="systemMessage.systemMessageTypeId"/><econdition field-name="systemMessageRemoteId" from="systemMessage.systemMessageRemoteId"/></entity-find><if condition="pmftList.size() == 0"><return error="true" message="Could not find paymentMethodId from PaymentMethodFileType record for file type PmftBai2 message type ${systemMessage.systemMessageTypeId} remote ${systemMessage.systemMessageRemoteId}"/></if><iterate list="pmftList" entry="pmft"><set field="paymentMethodId" from="pmft.paymentMethodId"/><service-call name="mantle.account.BaiServices.import#BaiVersion2" in-map="context"/></iterate></actions></service>