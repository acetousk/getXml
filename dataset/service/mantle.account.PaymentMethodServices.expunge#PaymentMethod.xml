<!--Service Location mantle.account.PaymentMethodServices.expunge#PaymentMethod--><service verb="expunge" noun="PaymentMethod"><in-parameters><parameter name="paymentMethodId" entity-name="mantle.account.method.PaymentMethod" field-name="paymentMethodId"/></in-parameters><out-parameters/><actions><entity-find-one entity-name="mantle.account.method.PaymentMethod" value-field="paymentMethod"/><if condition="paymentMethod.originalPaymentMethodId != null"><then><entity-find entity-name="mantle.account.method.PaymentMethod" list="pmList"><econdition field-name="originalPaymentMethodId" from="paymentMethod.originalPaymentMethodId"/></entity-find><iterate list="pmList" entry="pmValue"><service-call name="delete#mantle.account.method.BankAccount" in-map="[paymentMethodId:pmValue.paymentMethodId]"/><service-call name="delete#mantle.account.method.CreditCard" in-map="[paymentMethodId:pmValue.paymentMethodId]"/><service-call name="delete#mantle.account.method.PaymentMethod" in-map="[paymentMethodId:pmValue.paymentMethodId]"/></iterate><entity-find-one entity-name="mantle.account.method.PaymentMethod" value-field="origPm"><field-map field-name="paymentMethodId" from="paymentMethod.originalPaymentMethodId"/></entity-find-one><if condition="origPm"><service-call name="delete#mantle.account.method.BankAccount" in-map="[paymentMethodId:origPm.paymentMethodId]"/><service-call name="delete#mantle.account.method.CreditCard" in-map="[paymentMethodId:origPm.paymentMethodId]"/><service-call name="delete#mantle.account.method.PaymentMethod" in-map="[paymentMethodId:origPm.paymentMethodId]"/></if></then><else><service-call name="delete#mantle.account.method.BankAccount" in-map="[paymentMethodId:paymentMethodId]"/><service-call name="delete#mantle.account.method.CreditCard" in-map="[paymentMethodId:paymentMethodId]"/><service-call name="delete#mantle.account.method.PaymentMethod" in-map="[paymentMethodId:paymentMethodId]"/></else></if></actions></service>