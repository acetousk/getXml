<!--Service Location mantle.work.ManufacturingServices.get#ProducedProductComplete--><service verb="get" noun="ProducedProductComplete"><in-parameters><parameter name="workEffortId" required="true"/></in-parameters><out-parameters><parameter name="estimatedQtyByProduct" type="Map"/><parameter name="producedQtyByProduct" type="Map"/><parameter name="allEstimatedProduced" type="Boolean"/></out-parameters><actions><set field="producedQtyByProduct" from="[:]"/><entity-find entity-name="mantle.product.receipt.AssetReceipt" list="receiptList"><econdition field-name="workEffortId"/></entity-find><iterate list="receiptList" entry="receipt"><script><![CDATA[addToBigDecimalInMap(receipt.productId, receipt.quantityAccepted, producedQtyByProduct)]]></script></iterate><set field="estimatedQtyByProduct" from="[:]"/><entity-find entity-name="mantle.work.effort.WorkEffortProduct" list="produceProductList"><date-filter/><econdition field-name="workEffortId"/><econdition field-name="typeEnumId" value="WeptProduce"/></entity-find><iterate list="produceProductList" entry="produceProduct"><script><![CDATA[addToBigDecimalInMap(produceProduct.productId, produceProduct.estimatedQuantity, estimatedQtyByProduct)]]></script></iterate><set field="allEstimatedProduced" from="true"/><iterate list="estimatedQtyByProduct" key="productId" entry="estQuantity"><if condition="estQuantity > (producedQtyByProduct.get(productId) ?: 0.0)"><set field="allEstimatedProduced" from="false"/><break/></if></iterate></actions></service>