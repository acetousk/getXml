<!--Service Location XmlServices.fillIn#ServiceDefinitionXmlVariables--><service verb="fillIn" noun="ServiceDefinitionXmlVariables"><in-parameters><parameter name="actionsNode" type="MNode" required="true"/></in-parameters><out-parameters><parameter name="actionsNode" type="MNode"/><parameter name="actions"/></out-parameters><actions><iterate list="actionsNode.descendants('service-call')" entry="action"><if condition="action.attribute('out-map')?.contains(',') || action.attribute('out-map')?.contains('[')"/><if condition="action.attribute('out-map')"><set field="outMap" value="["/><set field="sd" from="ec.service.getServiceDefinition(action.attribute('name'))"/><if condition="!sd"><then><if condition="!action.attribute('name').contains('#') && !org.moqui.impl.service.runner.EntityAutoServiceRunner.verbSet.any { action.attribute('name').startsWith(it) }"><log level="warn" message="No service or entity definition found for name ${action.attribute('name')}"/><continue/></if><set field="entityName" from="action.attribute('name').split('#')[1]"/><set field="entityDefinition" from="ec.entity.getEntityDefinition(entityName)"/><if condition="!entityDefinition"><log level="warn" message="No entity definition found for name ${action.attribute('name')}"/><continue/></if><iterate list="entityDefinition.allFieldNames" entry="fieldName"><if condition="!entityDefinition.isField(fieldName)"><log level="warn" message="Field ${fieldName} is not a field of entity ${entityDefinition.entityName}"/><continue/></if><set field="fieldInfo" from="entityDefinition.getFieldInfo(fieldName)"/><set field="outMap" from="outMap+fieldInfo.name+':'+action.attribute('out-map')+'.'+fieldInfo.name"/><if condition="_fieldNameIterator.hasNext()"><set field="outMap" from="outMap+','"/></if></iterate></then><else><iterate list="sd.outParameterInfoMap" entry="outParameterInfoMap"><set field="outMap" from="outMap+outParameterInfoMap.key+':'+action.attribute('out-map')+'.'+outParameterInfoMap.value.name"/><if condition="_outParameterInfoMapIterator.hasNext()"><set field="outMap" from="outMap+','"/></if></iterate></else></if><set field="outMap" value="${outMap}]"/><script><![CDATA[action.getAttributes().put("out-map", outMap as String);]]></script></if></iterate><set field="actions" from="actionsNode.toString()"/></actions></service>