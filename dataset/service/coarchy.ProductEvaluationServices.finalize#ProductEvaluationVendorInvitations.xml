<!--Service Location coarchy.ProductEvaluationServices.finalize#ProductEvaluationVendorInvitations--><service verb="finalize" noun="ProductEvaluationVendorInvitations"><in-parameters><parameter name="productEvaluationId" required="true"/></in-parameters><out-parameters/><actions><entity-find-one entity-name="coarchy.product.ProductEvaluation" value-field="productEvaluation" for-update="true"/><if condition="productEvaluation.statusId != 'PeInviteVendors'"><return error="true" message="Cannot complete vendor invitations in this status."/></if><entity-find entity-name="coarchy.product.ProductEvaluationParty" list="productEvalPartyList"><date-filter/><econdition field-name="productEvaluationId"/><econdition field-name="roleTypeId" value="VendorRepresentative"/><econdition field-name="statusId" operator="not-in" value="PepRejected,PepWithdrew"/></entity-find><if condition="productEvalPartyList.size() == 0"><return error="true" message="Please invite at least one vendor."/></if><service-call name="coarchy.ProductEvaluationServices.send#ProductEvaluationInvitations" in-map="[productEvaluationId:productEvaluationId]"/><set field="productEvaluation.statusId" value="PeAwaitingVendorResponse"/><entity-update value-field="productEvaluation"/></actions></service>