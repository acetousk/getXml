<!--Service Location mantle.ledger.PaymentAutoPostServices.revert#PaymentPost--><service verb="revert" noun="PaymentPost"><in-parameters><parameter name="paymentId" required="true"/></in-parameters><out-parameters/><actions><entity-find entity-name="mantle.ledger.transaction.AcctgTrans" list="acctgTransList"><econdition field-name="paymentId"/><econdition field-name="acctgTransTypeEnumId" operator="in" value="AttOutgoingPayment,AttIncomingPayment"/><econdition field-name="reversedByAcctgTransId" from="null"/><econdition field-name="reverseOfAcctgTransId" from="null"/></entity-find><if condition="acctgTransList"><then><iterate list="acctgTransList" entry="acctgTrans"><service-call name="mantle.ledger.LedgerServices.post#ReverseAcctgTrans" out-map="[acctgTransId:revOut.acctgTransId]" out-map-add-to-existing="false" in-map="[acctgTransId:acctgTrans.acctgTransId, deleteIfNotPosted:true]"/><if condition="revOut.acctgTransId"><message><![CDATA[Created reverse transaction ${revOut.acctgTransId} from tx ${acctgTrans.acctgTransId} for payment ${paymentId}]]></message></if></iterate></then><else><return message="No accounting transaction found for Payment ${paymentId}, not posting reverse transaction."/></else></if></actions></service>